<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    </head>

    <body>
        <svg id="map"></svg>
        <script src="../../build/eurostatmap.js"></script>
        <script>
            const url = 'https://raw.githubusercontent.com/eurostat/eurostat-map/master/examples/ur/pop_change.csv'
            const n2jURL = 'https://raw.githubusercontent.com/eurostat/Nuts2json/master/pub/v2/'

            let data1 = {
                BE10: 702.2,
                BE21: 539.3,
                BE22: 475.4,
                BE23: 586.3,
                BE24: 393.6,
                BE25: 650.0,
                BE31: 228.1,
                BE32: 606.0,
                BE33: 565.9,
                BE34: 398.6,
                BE35: 508.8,
                BG31: 858.5,
                BG32: 722.6,
                BG33: 527.7,
                BG34: 689.7,
                BG41: 753.9,
                BG42: 843.8,
                CZ01: 844.6,
                CZ02: 486.9,
                CZ03: 682.6,
                CZ04: 627.4,
                CZ05: 644.0,
                CZ06: 702.1,
                CZ07: 636.6,
                CZ08: 703.6,
                DK01: 292.0,
                DK02: 268.0,
                DK03: 237.5,
                DK04: 216.5,
                DK05: 206.4,
                DE: 776.0,
                EE00: 439.4,
                IE: 289.4,
                EL30: 488.3,
                EL41: 307.7,
                EL42: 349.7,
                EL43: 398.8,
                EL51: 439.2,
                EL52: 448.8,
                EL53: 425.6,
                EL54: 485.4,
                EL61: 575.9,
                EL62: 327.7,
                EL63: 316.1,
                EL64: 186.7,
                EL65: 219.4,
                ES11: 321.8,
                ES12: 351.6,
                ES13: 333.4,
                ES21: 331.6,
                ES22: 334.4,
                ES23: 324.3,
                ES24: 367.1,
                ES30: 268.6,
                ES41: 359.3,
                ES42: 246.4,
                ES43: 354.4,
                ES51: 378.4,
                ES52: 238.4,
                ES53: 269.0,
                ES61: 229.9,
                ES62: 314.3,
                ES63: 204.8,
                ES64: 199.7,
                ES70: 282.3,
                FR10: 514.3,
                FRB0: 589.1,
                FRC1: 660.0,
                FRC2: 543.9,
                FRD1: 602.8,
                FRD2: 548.8,
                FRE1: 573.8,
                FRE2: 568.0,
                FRF1: 553.9,
                FRF2: 564.8,
                FRF3: 588.4,
                FRG0: 480.3,
                FRH0: 574.7,
                FRI1: 581.4,
                FRI2: 779.3,
                FRI3: 522.3,
                FRJ1: 642.0,
                FRJ2: 587.8,
                FRK1: 693.8,
                FRK2: 540.4,
                FRL0: 663.3,
                FRM0: 584.4,
                FRY1: 566.7,
                FRY2: 539.4,
                FRY3: 343.0,
                FRY4: 410.7,
                FRY5: 127.4,
                HR02: 546.8,
                HR03: 528.9,
                HR05: 767.6,
                HR06: 461.4,
                ITC1: 350.2,
                ITC2: 375.8,
                ITC3: 331.9,
                ITC4: 328.5,
                ITF1: 318.7,
                ITF2: 315.1,
                ITF3: 250.4,
                ITF4: 289.1,
                ITF5: 319.8,
                ITF6: 220.1,
                ITG1: 291.5,
                ITG2: 304.5,
                ITH1: 341.2,
                ITH2: 368.0,
                ITH3: 307.8,
                ITH4: 327.9,
                ITH5: 362.6,
                ITI1: 288.8,
                ITI2: 292.2,
                ITI3: 273.9,
                ITI4: 356.1,
                CY00: 312.4,
                LV00: 516.4,
                LT01: 629.3,
                LT02: 595.5,
                LU00: 414.3,
                HU11: 992.3,
                HU12: 220.1,
                HU21: 645.5,
                HU22: 711.2,
                HU23: 740.0,
                HU31: 736.2,
                HU32: 641.9,
                HU33: 681.3,
                MT00: 414.4,
                NL: 295.2,
                AT11: 549.5,
                AT12: 662.0,
                AT13: 701.4,
                AT21: 774.2,
                AT22: 780.6,
                AT31: 655.6,
                AT32: 797.6,
                AT33: 655.3,
                AT34: 533.9,
                PL21: 618.4,
                PL22: 607.0,
                PL41: 428.6,
                PL42: 1195.7,
                PL43: 493.3,
                PL51: 745.2,
                PL52: 558.4,
                PL61: 886.9,
                PL62: 576.1,
                PL63: 502.3,
                PL71: 540.7,
                PL72: 785.7,
                PL81: 630.7,
                PL82: 680.0,
                PL84: 615.0,
                PL91: 611.1,
                PL92: 420.1,
                PT11: 340.3,
                PT15: 272.7,
                PT16: 305.4,
                PT17: 378.6,
                PT18: 210.3,
                PT20: 672.3,
                PT30: 822.4,
                RO11: 744.5,
                RO12: 748.3,
                RO21: 655.5,
                RO22: 634.9,
                RO31: 534.8,
                RO32: 1047.8,
                RO41: 704.1,
                RO42: 776.8,
                SI03: 347.1,
                SI04: 510.6,
                SK01: 668.5,
                SK02: 460.6,
                SK03: 592.5,
                SK04: 623.5,
                FI19: 286.6,
                FI1B: 249.9,
                FI1C: 259.7,
                FI1D: 315.2,
                FI20: 211.7,
                SE11: 209.5,
                SE12: 204.4,
                SE21: 209.6,
                SE22: 191.5,
                SE23: 184.7,
                SE31: 192.7,
                SE32: 203.3,
                SE33: 223.0,
                IS00: 283.5,
                LI00: 227.2,
                NO02: 431.1,
                NO06: 349.1,
                NO07: 430.1,
                NO08: 343.9,
                NO09: 269.7,
                NO0A: 313.0,
                NO0B: ':',
                CH01: 463.0,
                CH02: 407.4,
                CH03: 539.7,
                CH04: 384.1,
                CH05: 494.3,
                CH06: 335.9,
                CH07: 561.7,
                BA: ':',
                ME00: 381.8,
                MD: ':',
                MK00: 449.0,
                GE: ':',
                AL: ':',
                RS11: 627.2,
                RS12: 577.1,
                RS21: 497.2,
                RS22: 619.1,
                TR10: 300.0,
                TR21: 329.8,
                TR22: 287.7,
                TR31: 279.6,
                TR32: 281.8,
                TR33: 329.1,
                TR41: 297.8,
                TR42: 254.0,
                TR51: 337.4,
                TR52: 371.2,
                TR61: 318.7,
                TR62: 304.0,
                TR63: 266.0,
                TR71: 293.2,
                TR72: 365.3,
                TR81: 334.5,
                TR82: 302.2,
                TR83: 359.5,
                TR90: 346.8,
                TRA1: 433.5,
                TRA2: 199.9,
                TRB1: 413.8,
                TRB2: 242.3,
                TRC1: 289.3,
                TRC2: 233.0,
                TRC3: 203.1,
                UA: ':',
            }

            let data2 = {
                BE10: 399.8,
                BE21: 278.9,
                BE22: 264.1,
                BE23: 300.2,
                BE24: 416.3,
                BE25: 267.5,
                BE31: 543.6,
                BE32: 259.6,
                BE33: 372.7,
                BE34: 240.2,
                BE35: 360.8,
                BG31: 462.1,
                BG32: 331.7,
                BG33: 395.8,
                BG34: 351.9,
                BG41: 464.6,
                BG42: 407.0,
                CZ01: 795.2,
                CZ02: 274.4,
                CZ03: 394.5,
                CZ04: 337.6,
                CZ05: 366.7,
                CZ06: 445.3,
                CZ07: 399.0,
                CZ08: 391.7,
                DK01: 513.9,
                DK02: 373.2,
                DK03: 415.2,
                DK04: 418.8,
                DK05: 376.8,
                DE: 453.0,
                EE00: 343.2,
                IE: 402.5,
                EL30: 804.3,
                EL41: 361.9,
                EL42: 389.7,
                EL43: 615.0,
                EL51: 533.7,
                EL52: 654.4,
                EL53: 309.3,
                EL54: 732.7,
                EL61: 531.8,
                EL62: 510.8,
                EL63: 508.3,
                EL64: 332.2,
                EL65: 398.6,
                ES11: 451.3,
                ES12: 448.7,
                ES13: 621.7,
                ES21: 523.8,
                ES22: 667.8,
                ES23: 347.7,
                ES24: 549.1,
                ES30: 555.7,
                ES41: 391.6,
                ES42: 276.3,
                ES43: 416.5,
                ES51: 423.2,
                ES52: 430.6,
                ES53: 572.6,
                ES61: 381.3,
                ES62: 370.9,
                ES63: 762.5,
                ES64: ':',
                ES70: 502.3,
                FR10: 358.9,
                FRB0: 241.5,
                FRC1: 283.4,
                FRC2: 289.4,
                FRD1: 293.4,
                FRD2: 261.4,
                FRE1: 302.7,
                FRE2: 240.6,
                FRF1: 346.4,
                FRF2: 276.9,
                FRF3: 285.7,
                FRG0: 277.9,
                FRH0: 315.7,
                FRI1: 352.9,
                FRI2: 312.8,
                FRI3: 279.5,
                FRJ1: 346.9,
                FRJ2: 317.7,
                FRK1: 299.2,
                FRK2: 327.1,
                FRL0: 383.5,
                FRM0: 296.2,
                FRY1: 271.8,
                FRY2: 311.8,
                FRY3: 223.3,
                FRY4: 335.2,
                FRY5: 85.8,
                HR02: 328.2,
                HR03: 346.2,
                HR05: 617.0,
                HR06: 225.4,
                ITC1: 373.3,
                ITC2: 368.6,
                ITC3: 469.3,
                ITC4: 380.6,
                ITF1: 442.3,
                ITF2: 416.4,
                ITF3: 392.9,
                ITF4: 388.8,
                ITF5: 338.4,
                ITF6: 371.0,
                ITG1: 443.1,
                ITG2: 483.4,
                ITH1: 342.7,
                ITH2: 330.0,
                ITH3: 357.1,
                ITH4: 400.5,
                ITH5: 439.3,
                ITI1: 452.9,
                ITI2: 456.2,
                ITI3: 386.8,
                ITI4: 483.2,
                CY00: 490.8,
                LV00: 335.8,
                LT01: 562.5,
                LT02: 399.5,
                LU00: ':',
                HU11: 548.1,
                HU12: 246.2,
                HU21: 233.4,
                HU22: 264.1,
                HU23: 346.2,
                HU31: 216.2,
                HU32: 319.4,
                HU33: 328.0,
                MT00: 434.3,
                NL: 389.9,
                AT11: 447.4,
                AT12: 480.9,
                AT13: 703.8,
                AT21: 497.4,
                AT22: 524.4,
                AT31: 438.4,
                AT32: 589.3,
                AT33: 577.7,
                AT34: 439.3,
                PL21: 350.1,
                PL22: 351.8,
                PL41: 289.8,
                PL42: 320.6,
                PL43: 231.1,
                PL51: 370.4,
                PL52: 248.5,
                PL61: 290.9,
                PL62: 248.6,
                PL63: 350.0,
                PL71: 401.5,
                PL72: 297.0,
                PL81: 360.0,
                PL82: 267.3,
                PL84: 379.2,
                PL91: 618.4,
                PL92: 205.1,
                PT11: 570.6,
                PT15: 430.7,
                PT16: 533.9,
                PT17: 672.7,
                PT18: 323.2,
                PT20: 383.1,
                PT30: 501.3,
                RO11: 361.2,
                RO12: 358.1,
                RO21: 269.3,
                RO22: 237.9,
                RO31: 165.0,
                RO32: 711.9,
                RO41: 329.6,
                RO42: 483.0,
                SI03: 286.3,
                SI04: 387.3,
                SK01: 679.4,
                SK02: 280.4,
                SK03: 346.3,
                SK04: 349.3,
                FI19: 336.3,
                FI1B: 384.9,
                FI1C: 342.5,
                FI1D: 374.7,
                FI20: 303.3,
                SE11: 459.2,
                SE12: 455.5,
                SE21: 391.8,
                SE22: 437.2,
                SE23: 423.9,
                SE31: 360.6,
                SE32: 397.9,
                SE33: 453.8,
                IS00: 437.8,
                LI00: 342.0,
                NO02: 460.5,
                NO06: 526.2,
                NO07: 617.8,
                NO08: 544.4,
                NO09: 444.0,
                NO0A: 490.2,
                NO0B: ':',
                CH01: 503.8,
                CH02: 400.4,
                CH03: 468.6,
                CH04: 523.5,
                CH05: 359.9,
                CH06: 335.6,
                CH07: 491.8,
                BA: ':',
                ME00: 280.7,
                MD: ':',
                MK00: 323.4,
                GE: ':',
                AL: ':',
                RS11: 351.6,
                RS12: 272.1,
                RS21: 276.3,
                RS22: 319.3,
                TR10: 270.1,
                TR21: 195.7,
                TR22: 185.4,
                TR31: 277.2,
                TR32: 203.1,
                TR33: 178.4,
                TR41: 198.1,
                TR42: 187.5,
                TR51: 367.2,
                TR52: 207.7,
                TR61: 233.2,
                TR62: 196.1,
                TR63: 158.6,
                TR71: 161.4,
                TR72: 207.5,
                TR81: 186.2,
                TR82: 155.9,
                TR83: 197.7,
                TR90: 205.0,
                TRA1: 228.1,
                TRA2: 137.2,
                TRB1: 216.2,
                TRB2: 145.5,
                TRC1: 166.3,
                TRC2: 145.6,
                TRC3: 133.0,
                UA: ':',
            }

            const COLORS = [
                'rgb(230,184,0)',

                'rgb(139,137,0)',

                'rgb(51,100,0)',

                'rgb(239,213,119)',

                'rgb(154,190,119)',

                'rgb(56,138,119)',

                'rgb(246,239,224)',

                'rgb(154,190,224)',

                'rgb(56,138,224)',
            ]
            const map = eurostatmap
                .map('bivariateChoropleth')
                .nutsLevel('mixed')
                .classToFillStyle((class1, class2) => {
                    if (class1 == 0 && class2 == 2) return COLORS[0]
                    if (class1 == 1 && class2 == 2) return COLORS[1]
                    if (class1 == 2 && class2 == 2) return COLORS[2]
                    if (class1 == 0 && class2 == 1) return COLORS[3]
                    if (class1 == 1 && class2 == 1) return COLORS[4]
                    if (class1 == 2 && class2 == 1) return COLORS[5]
                    if (class1 == 0 && class2 == 0) return COLORS[6]
                    if (class1 == 1 && class2 == 0) return COLORS[7]
                    if (class1 == 2 && class2 == 0) return COLORS[8]
                    return 'gray'
                })
                .legend({
                    boxFill: 'none',
                    label1: 'Medical doctors',
                    label2: 'Hospital beds',
                    breaks1: [345.0, 585.0],
                    breaks2: [340.0, 415.0],
                    x: 0,
                    y: 125,
                    squareSize: 100,
                    labelFontSize: 12,
                    noDataYOffset: 10,
                })
                .hoverColor('yellow')
                .showSourceLink(false)
                .coastalMarginColor('lightgray')
                .insets('default')
                .callback(() => console.log('callback fired'))
            // .tooltip({
            //     textFunction: function (rg, map) {
            //         const buf = []
            //         //region name
            //         if (rg.properties.id) {
            //             //name and code
            //             buf.push('<b>' + rg.properties.na + '</b> (' + rg.properties.id + ') <br>')
            //         } else {
            //             //region name
            //             buf.push('<b>' + rg.properties.na + '</b><br>')
            //         }

            //         //URT value
            //         if (countriesToShow.includes(rg.properties.id[0] + rg.properties.id[1])) {
            //             const data2 = map.statData('v2')
            //             const sv2 = data2.get(rg.properties.id)
            //             if (!sv2 || (sv2.value != 0 && !sv2.value)) buf.push(map.noDataText_)
            //             else {
            //                 buf.push(
            //                     sv2.value == 1
            //                         ? 'Predominantly urban region'
            //                         : sv2.value == 2
            //                         ? 'Intermediate region'
            //                         : 'Predominantly rural region'
            //                 )
            //             }

            //             buf.push('<br>')

            //             //stat value
            //             const sv1 = map.statData('v1').get(rg.properties.id)
            //             if (!sv1 || (sv1.value != 0 && !sv1.value)) buf.push(map.noDataText_)
            //             else {
            //                 buf.push(sv1.value)
            //                 //unit 1
            //                 const unit1 = map.statData('v1').unitText()
            //                 if (unit1) buf.push(' ' + unit1)
            //             }
            //         }

            //         return buf.join('')
            //     },
            // })
            //.countriesToShow(countriesToShow)
            //.bordersToShow(['efta', 'eu', 'cc', 'co'])

            map.statData().setData(data1).unitText('doctors')
            map.statData('v2').setData(data2).unitText('beds')
            map.updateClassification()
            map.updateStyle()

            map.build()
        </script>
    </body>
</html>
