{"version":3,"file":"eurostatmap.min.js","mappings":";CAAA,SAAUA,iCAAiCC,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAqB,YAAID,IAEzBD,EAAkB,YAAIC,GACvB,CATD,CASGK,KAAM,I,sFCNLC,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,g8EAqHd,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,0CAA0C,MAAQ,GAAG,SAAW,w/BAAw/B,eAAiB,CAAC,2qFAA2qF,WAAa,MAExzH,S,4BCnHAN,EAAOD,QANP,SAASQ,+BAA+BC,GACtC,IAAIC,EAAmD,KACnDA,GACFD,EAAaE,aAAa,QAASD,EAEvC,C,sBCNA,IAAIE,EAAc,GAClB,SAASC,qBAAqBC,GAE5B,IADA,IAAIC,GAAU,EACLC,EAAI,EAAGA,EAAIJ,EAAYK,OAAQD,IACtC,GAAIJ,EAAYI,GAAGF,aAAeA,EAAY,CAC5CC,EAASC,EACT,KACF,CAEF,OAAOD,CACT,CACA,SAASG,aAAaC,EAAMC,GAG1B,IAFA,IAAIC,EAAa,CAAC,EACdC,EAAc,GACTN,EAAI,EAAGA,EAAIG,EAAKF,OAAQD,IAAK,CACpC,IAAIO,EAAOJ,EAAKH,GACZT,EAAKa,EAAQI,KAAOD,EAAK,GAAKH,EAAQI,KAAOD,EAAK,GAClDE,EAAQJ,EAAWd,IAAO,EAC1BO,EAAa,GAAGY,OAAOnB,EAAI,KAAKmB,OAAOD,GAC3CJ,EAAWd,GAAMkB,EAAQ,EACzB,IAAIE,EAAoBd,qBAAqBC,GACzCc,EAAM,CACRC,IAAKN,EAAK,GACVO,MAAOP,EAAK,GACZQ,UAAWR,EAAK,GAChBS,SAAUT,EAAK,GACfU,MAAOV,EAAK,IAEd,IAA2B,IAAvBI,EACFf,EAAYe,GAAmBO,aAC/BtB,EAAYe,GAAmBQ,QAAQP,OAClC,CACL,IAAIO,EAAUC,gBAAgBR,EAAKR,GACnCA,EAAQiB,QAAUrB,EAClBJ,EAAY0B,OAAOtB,EAAG,EAAG,CACvBF,WAAYA,EACZqB,QAASA,EACTD,WAAY,GAEhB,CACAZ,EAAYhB,KAAKQ,EACnB,CACA,OAAOQ,CACT,CACA,SAASc,gBAAgBR,EAAKR,GAC5B,IAAImB,EAAMnB,EAAQoB,OAAOpB,GACzBmB,EAAIE,OAAOb,GAWX,OAVc,SAASO,QAAQO,GAC7B,GAAIA,EAAQ,CACV,GAAIA,EAAOb,MAAQD,EAAIC,KAAOa,EAAOZ,QAAUF,EAAIE,OAASY,EAAOX,YAAcH,EAAIG,WAAaW,EAAOV,WAAaJ,EAAII,UAAYU,EAAOT,QAAUL,EAAIK,MACzJ,OAEFM,EAAIE,OAAOb,EAAMc,EACnB,MACEH,EAAII,QAER,CAEF,CACA1C,EAAOD,QAAU,SAAUmB,EAAMC,GAG/B,IAAIwB,EAAkB1B,aADtBC,EAAOA,GAAQ,GADfC,EAAUA,GAAW,CAAC,GAGtB,OAAO,SAASqB,OAAOI,GACrBA,EAAUA,GAAW,GACrB,IAAK,IAAI7B,EAAI,EAAGA,EAAI4B,EAAgB3B,OAAQD,IAAK,CAC/C,IACI8B,EAAQjC,qBADK+B,EAAgB5B,IAEjCJ,EAAYkC,GAAOZ,YACrB,CAEA,IADA,IAAIa,EAAqB7B,aAAa2B,EAASzB,GACtC4B,EAAK,EAAGA,EAAKJ,EAAgB3B,OAAQ+B,IAAM,CAClD,IACIC,EAASpC,qBADK+B,EAAgBI,IAEK,IAAnCpC,EAAYqC,GAAQf,aACtBtB,EAAYqC,GAAQd,UACpBvB,EAAY0B,OAAOW,EAAQ,GAE/B,CACAL,EAAkBG,CACpB,CACF,C,uBCtEA9C,EAAOD,QAVP,SAASkD,kBAAkBrB,EAAKpB,GAC9B,GAAIA,EAAa0C,WACf1C,EAAa0C,WAAWC,QAAUvB,MAC7B,CACL,KAAOpB,EAAa4C,YAClB5C,EAAa6C,YAAY7C,EAAa4C,YAExC5C,EAAa8C,YAAYC,SAASC,eAAe5B,GACnD,CACF,C,6ECTIxB,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,4hCA+CtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,mCAAmC,MAAQ,GAAG,SAAW,mbAAmb,eAAiB,CAAC,2nCAA2nC,WAAa,MAEpqD,S,UCnDAN,EAAOD,QAHP,SAAS0D,eAAeC,EAAGC,GACzBC,KAAKC,EAAIH,EAAGE,KAAKE,EAAIH,CACvB,EACiC3D,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,6ECAlGK,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,01BA0CrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,0CAA0C,MAAQ,GAAG,SAAW,gVAAgV,eAAiB,CAAC,+6BAA+6B,WAAa,MAE73C,S,6EC9CIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,gHAIrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,uCAAuC,MAAQ,GAAG,SAAW,gDAAgD,eAAiB,CAAC,yHAAyH,WAAa,MAEpS,S,yLCGIF,EAA0B,IAA4B,KAC1DA,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAE1BX,EAAwBC,KAAK,CAACL,EAAOM,GAAI,KACtC,GAAG,CAAC,QAAU,EAAE,QAAU,GAAG,MAAQ,GAAG,SAAW,GAAG,WAAa,MAEtE,S,gBC9BA,IAAI0D,EAAsB,EAAQ,KAOlChE,EAAOD,QANP,SAASkE,kBAAkBC,EAAGR,EAAGS,EAAGC,EAAGC,GACrC,IAAIC,EAAIN,EAAoBE,EAAGR,EAAGS,EAAGC,EAAGC,GACxC,OAAOC,EAAEC,OAAOC,KAAK,SAAUN,GAC7B,OAAOA,EAAEO,KAAOP,EAAEQ,MAAQJ,EAAEC,MAC9B,EACF,EACoCvE,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,6ECJrGK,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,i8BAqCrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,yDAAyD,MAAQ,GAAG,SAAW,2OAA2O,eAAiB,CAAC,4gCAA4gC,WAAa,MAEp4C,S,6ECzCIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,mEAErC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,wCAAwC,MAAQ,GAAG,SAAW,uBAAuB,eAAiB,CAAC,wEAAwE,WAAa,MAE3N,S,4ICAIF,EAA0B,IAA4B,KAC1DA,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAE1BX,EAAwBC,KAAK,CAACL,EAAOM,GAAI,w9CA6FrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,yCAAyC,MAAQ,GAAG,SAAW,goBAAgoB,eAAiB,CAAC,uzDAAuzD,WAAa,MAEpjF,S,uBC1GAN,EAAOD,QAAU,SAAU4E,GACzB,IAAIzD,EAAO,GA4EX,OAzEAA,EAAK0D,SAAW,SAASA,WACvB,OAAOhB,KAAKiB,IAAI,SAAUvD,GACxB,IAAIwD,EAAU,GACVC,OAA+B,IAAZzD,EAAK,GAoB5B,OAnBIA,EAAK,KACPwD,GAAW,cAAcrD,OAAOH,EAAK,GAAI,QAEvCA,EAAK,KACPwD,GAAW,UAAUrD,OAAOH,EAAK,GAAI,OAEnCyD,IACFD,GAAW,SAASrD,OAAOH,EAAK,GAAGN,OAAS,EAAI,IAAIS,OAAOH,EAAK,IAAM,GAAI,OAE5EwD,GAAWH,EAAuBrD,GAC9ByD,IACFD,GAAW,KAETxD,EAAK,KACPwD,GAAW,KAETxD,EAAK,KACPwD,GAAW,KAENA,CACT,GAAGE,KAAK,GACV,EAGA9D,EAAKH,EAAI,SAASA,EAAEkE,EAASpD,EAAOqD,EAAQnD,EAAUC,GAC7B,iBAAZiD,IACTA,EAAU,CAAC,CAAC,KAAMA,OAASE,KAE7B,IAAIC,EAAyB,CAAC,EAC9B,GAAIF,EACF,IAAK,IAAIpB,EAAI,EAAGA,EAAIF,KAAK5C,OAAQ8C,IAAK,CACpC,IAAIxD,EAAKsD,KAAKE,GAAG,GACP,MAANxD,IACF8E,EAAuB9E,IAAM,EAEjC,CAEF,IAAK,IAAI+E,EAAK,EAAGA,EAAKJ,EAAQjE,OAAQqE,IAAM,CAC1C,IAAI/D,EAAO,GAAGG,OAAOwD,EAAQI,IACzBH,GAAUE,EAAuB9D,EAAK,WAGrB,IAAVU,SACc,IAAZV,EAAK,KAGdA,EAAK,GAAK,SAASG,OAAOH,EAAK,GAAGN,OAAS,EAAI,IAAIS,OAAOH,EAAK,IAAM,GAAI,MAAMG,OAAOH,EAAK,GAAI,MAF/FA,EAAK,GAAKU,GAMVH,IACGP,EAAK,IAGRA,EAAK,GAAK,UAAUG,OAAOH,EAAK,GAAI,MAAMG,OAAOH,EAAK,GAAI,KAC1DA,EAAK,GAAKO,GAHVP,EAAK,GAAKO,GAMVE,IACGT,EAAK,IAGRA,EAAK,GAAK,cAAcG,OAAOH,EAAK,GAAI,OAAOG,OAAOH,EAAK,GAAI,KAC/DA,EAAK,GAAKS,GAHVT,EAAK,GAAK,GAAGG,OAAOM,IAMxBb,EAAKb,KAAKiB,GACZ,CACF,EACOJ,CACT,C,uBClFAlB,EAAOD,QAAU,SAAUuB,GACzB,IAAIwD,EAAUxD,EAAK,GACfgE,EAAahE,EAAK,GACtB,IAAKgE,EACH,OAAOR,EAET,GAAoB,mBAATS,KAAqB,CAC9B,IAAIC,EAASD,KAAKE,SAASC,mBAAmBC,KAAKC,UAAUN,MACzDO,EAAO,+DAA+DpE,OAAO+D,GAC7EM,EAAgB,OAAOrE,OAAOoE,EAAM,OACxC,MAAO,CAACf,GAASrD,OAAO,CAACqE,IAAgBd,KAAK,KAChD,CACA,MAAO,CAACF,GAASE,KAAK,KACxB,C,6ECZI5E,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,qMAStC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,mCAAmC,MAAQ,GAAG,SAAW,0CAA0C,eAAiB,CAAC,wNAAwN,WAAa,MAExX,S,UCPAN,EAAOD,QATP,SAASgG,iBAAiBrC,GACxB,IAAIQ,EAAI8B,OAAOtC,GACbS,EAAI,GACN,IAAK,IAAIC,KAAKF,EAAGC,EAAE8B,QAAQ7B,GAC3B,OAAO,SAASV,IACd,KAAOS,EAAEnD,QAAS,IAAKoD,EAAID,EAAE+B,SAAUhC,EAAG,OAAOR,EAAEgB,MAAQN,EAAGV,EAAEe,MAAO,EAAIf,EAC3E,OAAOA,EAAEe,MAAO,EAAIf,CACtB,CACF,EACmC1D,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,6ECNpGK,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,6EAGrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,sCAAsC,MAAQ,GAAG,SAAW,oCAAoC,eAAiB,CAAC,oFAAoF,WAAa,MAElP,S,6ECPIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,sgBAsBrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,6CAA6C,MAAQ,GAAG,SAAW,uKAAuK,eAAiB,CAAC,mjBAAqjB,WAAa,MAE71B,S,6EC1BIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,oqDAuGtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,kCAAkC,MAAQ,GAAG,SAAW,qwBAAqwB,eAAiB,CAAC,m3DAAm3D,WAAa,MAE7uF,S,6EC3GIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,qLAUrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,sCAAsC,MAAQ,GAAG,SAAW,4FAA4F,eAAiB,CAAC,0MAA0M,WAAa,MAEha,S,6ECdIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,icAuBrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,uDAAuD,MAAQ,GAAG,SAAW,oMAAoM,eAAiB,CAAC,gfAAgf,WAAa,MAE/zB,S,0ICrBIF,EAA0B,IAA4B,KAC1DA,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAC1BX,EAAwBW,EAAE,KAE1BX,EAAwBC,KAAK,CAACL,EAAOM,GAAI,0/FA0LrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,+BAA+B,MAAQ,GAAG,SAAW,ozCAAozC,eAAiB,CAAC,4lHAA4lH,WAAa,MAEngK,S,uBCpMAN,EAAOD,QANP,SAASoG,mBAAmBhF,GAC1B,IAAIiF,EAAU7C,SAAS8C,cAAc,SAGrC,OAFAlF,EAAQmF,cAAcF,EAASjF,EAAQoF,YACvCpF,EAAQqF,OAAOJ,EAASjF,EAAQA,SACzBiF,CACT,C,UCRA,SAASK,mBAAmB/C,EAAGS,EAAGD,EAAGE,GACnC,IAAIrD,EAAIiF,OAAOU,eACf,IACE3F,EAAE,CAAC,EAAG,GAAI,CAAC,EACb,CAAE,MAAO2C,GACP3C,EAAI,CACN,CACAf,EAAOD,QAAU0G,mBAAqB,SAASE,kBAAkBjD,EAAGS,EAAGD,EAAGE,GACxE,SAASC,EAAEF,EAAGD,GACZuC,mBAAmB/C,EAAGS,EAAG,SAAUT,GACjC,OAAOE,KAAKgD,QAAQzC,EAAGD,EAAGR,EAC5B,EACF,CACAS,EAAIpD,EAAIA,EAAE2C,EAAGS,EAAG,CACdO,MAAOR,EACP2C,YAAazC,EACb0C,cAAe1C,EACf2C,UAAW3C,IACRV,EAAES,GAAKD,GAAKG,EAAE,OAAQ,GAAIA,EAAE,QAAS,GAAIA,EAAE,SAAU,GAC5D,EAAGrE,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,QAAS0G,mBAAmB/C,EAAGS,EAAGD,EAAGE,EAC/G,CACApE,EAAOD,QAAU0G,mBAAoBzG,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,6EClBtGK,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,wpCA6CrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,+CAA+C,MAAQ,GAAG,SAAW,+TAA+T,eAAiB,CAAC,mvCAAmvC,WAAa,MAErrD,S,gBCpDA,IAAI0G,EAAU,eAkBdhH,EAAOD,QAjBP,SAASkH,mBAAmBvD,GAC1B,GAAI,MAAQA,EAAG,CACb,IAAIU,EAAIV,EAAE,mBAAqBwD,QAAUA,OAAOC,UAAY,cAC1DhD,EAAI,EACN,GAAIC,EAAG,OAAOA,EAAEgD,KAAK1D,GACrB,GAAI,mBAAqBA,EAAEa,KAAM,OAAOb,EACxC,IAAK2D,MAAM3D,EAAE1C,QAAS,MAAO,CAC3BuD,KAAM,SAASA,OACb,OAAOb,GAAKS,GAAKT,EAAE1C,SAAW0C,OAAI,GAAS,CACzCgB,MAAOhB,GAAKA,EAAES,KACdM,MAAOf,EAEX,EAEJ,CACA,MAAM,IAAI4D,UAAUN,EAAQtD,GAAK,mBACnC,EACqC1D,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,gBClB1G,IAAIwH,EAAgB,EAAQ,KACxBC,EAAc,EAAQ,KACtBC,EAAmB,EAAQ,KAC3BzD,EAAsB,EAAQ,KAC9B0D,EAA2B,EAAQ,KACnCC,EAAkB,EAAQ,KAC1BC,EAAoB,EAAQ,KAChC,SAASC,sBACP,aAEA,IAAI1D,EAAIqD,IACN9D,EAAIS,EAAE2D,EAAED,qBACRzD,GAAK4B,OAAO+B,eAAiB/B,OAAO+B,eAAerE,GAAKA,EAAEsE,WAAWC,YACvE,SAAS/D,EAAEC,GACT,IAAIT,EAAI,mBAAqBS,GAAKA,EAAE8D,YACpC,QAASvE,IAAMA,IAAMU,GAAK,uBAAyBV,EAAEwE,aAAexE,EAAEyE,MACxE,CACA,IAAI9D,EAAI,CACN,MAAS,EACT,OAAU,EACV,MAAS,EACT,SAAY,GAEd,SAASC,EAAEH,GACT,IAAIT,EAAGU,EACP,OAAO,SAAUF,GACfR,IAAMA,EAAI,CACR0E,KAAM,SAASA,OACb,OAAOhE,EAAEF,EAAEI,EAAG,EAChB,EACA,MAAS,SAAS+D,SAChB,OAAOnE,EAAEL,CACX,EACAyE,OAAQ,SAASA,OAAOnE,EAAGT,GACzB,OAAOU,EAAEF,EAAEI,EAAGD,EAAEF,GAAIT,EACtB,EACA6E,cAAe,SAASA,cAAcpE,EAAGE,EAAGC,GAC1C,OAAOZ,EAAE8E,WAAanE,EAAGD,EAAEF,EAAEP,EAAGiE,EAAkBzD,GAAIG,EACxD,EACAmE,OAAQ,SAASA,OAAOtE,GACtB,OAAOC,EAAEF,EAAEwE,EAAGvE,EAChB,GACCC,EAAI,SAASA,EAAED,EAAGwE,EAAItE,GACvBH,EAAE0E,EAAIlF,EAAEmF,KAAM3E,EAAEA,EAAIR,EAAEa,KACtB,IACE,OAAOJ,EAAEwE,EAAItE,EACf,CAAE,QACAX,EAAEa,KAAOL,EAAEA,CACb,CACF,GAAIR,EAAE8E,aAAe9E,EAAEA,EAAE8E,YAActE,EAAEL,EAAGH,EAAE8E,gBAAa,GAAS9E,EAAEoF,KAAO5E,EAAEL,EAAGH,EAAEa,KAAOL,EAAEA,EAC7F,IACE,OAAOC,EAAEiD,KAAKxD,KAAMF,EACtB,CAAE,QACAQ,EAAE0E,EAAIlF,EAAEmF,KAAM3E,EAAEA,EAAIR,EAAEa,IACxB,CACF,CACF,CACA,OAAQvE,EAAOD,QAAU8H,oBAAsB,SAASA,sBACtD,MAAO,CACLkB,KAAM,SAASA,KAAKrF,EAAGU,EAAGF,EAAGG,GAC3B,OAAOF,EAAE6E,EAAE1E,EAAEZ,GAAIU,EAAGF,EAAGG,GAAKA,EAAE4E,UAChC,EACAC,oBAAqBhF,EACrBiF,KAAMhF,EAAE2D,EACRsB,MAAO,SAASA,MAAMjF,EAAGT,GACvB,OAAO,IAAI6D,EAAcpD,EAAGT,EAC9B,EACA2F,cAAe3B,EACf4B,MAAO,SAASA,MAAMnF,EAAGT,EAAGU,EAAGC,EAAGkF,GAChC,OAAQrF,EAAER,GAAKM,EAAsByD,GAAkBnD,EAAEH,GAAIT,EAAGU,EAAGC,EAAGkF,EACxE,EACAC,KAAM7B,EACN8B,OAAQ7B,EAEZ,EAAG5H,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,UAC1E,CACAC,EAAOD,QAAU8H,oBAAqB7H,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,uBC1E3G,IAAI2J,EAAO,CAAC,EA+BZ1J,EAAOD,QAPP,SAAS4J,iBAAiBnD,EAAQoD,GAChC,IAAIC,EAtBN,SAASC,UAAUD,GACjB,QAA4B,IAAjBH,EAAKG,GAAyB,CACvC,IAAIE,EAAcxG,SAASyG,cAAcH,GAGzC,GAAII,OAAOC,mBAAqBH,aAAuBE,OAAOC,kBAC5D,IAGEH,EAAcA,EAAYI,gBAAgBC,IAC5C,CAAE,MAAO1G,GAEPqG,EAAc,IAChB,CAEFL,EAAKG,GAAUE,CACjB,CACA,OAAOL,EAAKG,EACd,CAIeC,CAAUtD,GACvB,IAAKqD,EACH,MAAM,IAAIQ,MAAM,2GAElBR,EAAOvG,YAAYsG,EACrB,C,6EC7BIxJ,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,k2FAiJtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,mCAAmC,MAAQ,GAAG,SAAW,0sCAA0sC,eAAiB,CAAC,qoGAAqoG,WAAa,MAEr8I,S,UCxJA,SAAS0G,QAAQ3C,GAGf,OAAOrE,EAAOD,QAAUiH,QAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAU9C,GAC9G,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqB6C,QAAU7C,EAAE4D,cAAgBf,QAAU7C,IAAM6C,OAAOoD,UAAY,gBAAkBjG,CACpH,EAAGrE,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,QAASiH,QAAQ3C,EAC3F,CACArE,EAAOD,QAAUiH,QAAShH,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,gBCP/F,IAAIwK,EAAU,EAAQ,IAAR,GACdvK,EAAOD,QAAUwK,EAGjB,IACEC,mBAAqBD,CACvB,CAAE,MAAOE,GACmB,iBAAfC,WACTA,WAAWF,mBAAqBD,EAEhCI,SAAS,IAAK,yBAAdA,CAAwCJ,EAE5C,C,+FCVInK,EAA0B,IAA4B,KAC1DA,EAAwBW,EAAE,KAE1BX,EAAwBC,KAAK,CAACL,EAAOM,GAAI,2fAkCrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,8BAA8B,MAAQ,GAAG,SAAW,uPAAuP,eAAiB,CAAC,0lBAA0lB,WAAa,MAEn8B,S,6ECxCIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,yYAiBtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,2CAA2C,MAAQ,GAAG,SAAW,wHAAwH,eAAiB,CAAC,4aAA4a,WAAa,MAElqB,S,6ECrBIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,shCA0CrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,yCAAyC,MAAQ,GAAG,SAAW,0RAA0R,eAAiB,CAAC,2mCAA2mC,WAAa,MAElgD,S,6EC9CIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,0DAGtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,uCAAuC,MAAQ,GAAG,SAAW,yBAAyB,eAAiB,CAAC,iEAAiE,WAAa,MAEpN,S,gBCVA,IAAIiH,EAAgB,EAAQ,KACxBZ,EAAoB,EAAQ,KA+BhC3G,EAAOD,QA9BP,SAASsJ,cAAcjF,EAAGV,GACxB,SAASQ,EAAEC,EAAGE,EAAGtD,EAAG2H,GAClB,IACE,IAAIkC,EAAIxG,EAAED,GAAGE,GACXkF,EAAIqB,EAAElG,MACR,OAAO6E,aAAahC,EAAgB7D,EAAEmH,QAAQtB,EAAE1F,GAAGW,KAAK,SAAUJ,GAChEF,EAAE,OAAQE,EAAGrD,EAAG2H,EAClB,EAAG,SAAUtE,GACXF,EAAE,QAASE,EAAGrD,EAAG2H,EACnB,GAAKhF,EAAEmH,QAAQtB,GAAG/E,KAAK,SAAUJ,GAC/BwG,EAAElG,MAAQN,EAAGrD,EAAE6J,EACjB,EAAG,SAAUxG,GACX,OAAOF,EAAE,QAASE,EAAGrD,EAAG2H,EAC1B,EACF,CAAE,MAAOtE,GACPsE,EAAEtE,EACJ,CACF,CACA,IAAID,EACJP,KAAKW,OAASoC,EAAkB0C,cAAciB,WAAY3D,EAAkB0C,cAAciB,UAAW,mBAAqBpD,QAAUA,OAAO4D,eAAiB,iBAAkB,WAC5K,OAAOlH,IACT,IAAK+C,EAAkB/C,KAAM,UAAW,SAAUQ,EAAGC,EAAGtD,GACtD,SAAS2H,IACP,OAAO,IAAIhF,EAAE,SAAUA,EAAGS,GACxBD,EAAEE,EAAGrD,EAAG2C,EAAGS,EACb,EACF,CACA,OAAOA,EAAIA,EAAIA,EAAEK,KAAKkE,EAAGA,GAAKA,GAChC,GAAG,EACL,EACgC1I,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,uBC4BrGC,EAAOD,QAjBP,SAASwC,OAAOpB,GACd,GAAwB,oBAAboC,SACT,MAAO,CACLf,OAAQ,SAASA,SAAU,EAC3BE,OAAQ,SAASA,SAAU,GAG/B,IAAIlC,EAAeW,EAAQgF,mBAAmBhF,GAC9C,MAAO,CACLqB,OAAQ,SAASA,OAAOb,IAjD5B,SAASoJ,MAAMvK,EAAcW,EAASQ,GACpC,IAAIC,EAAM,GACND,EAAII,WACNH,GAAO,cAAcH,OAAOE,EAAII,SAAU,QAExCJ,EAAIE,QACND,GAAO,UAAUH,OAAOE,EAAIE,MAAO,OAErC,IAAIkD,OAAiC,IAAdpD,EAAIK,MACvB+C,IACFnD,GAAO,SAASH,OAAOE,EAAIK,MAAMhB,OAAS,EAAI,IAAIS,OAAOE,EAAIK,OAAS,GAAI,OAE5EJ,GAAOD,EAAIC,IACPmD,IACFnD,GAAO,KAELD,EAAIE,QACND,GAAO,KAELD,EAAII,WACNH,GAAO,KAET,IAAIE,EAAYH,EAAIG,UAChBA,GAA6B,oBAATyD,OACtB3D,GAAO,uDAAuDH,OAAO8D,KAAKE,SAASC,mBAAmBC,KAAKC,UAAU9D,MAAe,QAKtIX,EAAQ8B,kBAAkBrB,EAAKpB,EAAcW,EAAQA,QACvD,CAoBM4J,CAAMvK,EAAcW,EAASQ,EAC/B,EACAe,OAAQ,SAASA,UArBrB,SAASsI,mBAAmBxK,GAE1B,GAAgC,OAA5BA,EAAayK,WACf,OAAO,EAETzK,EAAayK,WAAW5H,YAAY7C,EACtC,CAgBMwK,CAAmBxK,EACrB,EAEJ,C,6ECxDIJ,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,sRActC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,kCAAkC,MAAQ,GAAG,SAAW,+GAA+G,eAAiB,CAAC,mTAAmT,WAAa,MAEvhB,S,6EClBIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,0xBA2CtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,iCAAiC,MAAQ,GAAG,SAAW,8TAA8T,eAAiB,CAAC,i3BAAi3B,WAAa,MAEnyC,S,gBClDA,IAAIkH,EAAc,EAAQ,KACtBE,EAA2B,EAAQ,KAIvC1H,EAAOD,QAHP,SAASmL,qBAAqB/G,EAAGT,EAAGU,EAAGC,EAAGH,GACxC,OAAO,IAAIwD,EAAyBF,IAAcwB,EAAE7E,EAAGT,EAAGU,EAAGC,GAAIH,GAAKiH,QACxE,EACuCnL,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,6ECFxGK,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,iVAgBrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,0CAA0C,MAAQ,GAAG,SAAW,uJAAuJ,eAAiB,CAAC,kXAAkX,WAAa,MAEvoB,S,6ECpBIF,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACL,EAAOM,GAAI,s6DAwGtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,gCAAgC,MAAQ,GAAG,SAAW,khBAAkhB,eAAiB,CAAC,unEAAunE,WAAa,MAE5vF,S,gBC/GA,IAAIqG,EAAoB,EAAQ,KAChC,SAASyE;;AAEP,IAAI1H,EACFU,EACAD,EAAI,mBAAqB+C,OAASA,OAAS,CAAC,EAC5ChD,EAAIC,EAAEgD,UAAY,aAClB9C,EAAIF,EAAEkH,aAAe,gBACvB,SAAStK,EAAEoD,EAAGD,EAAGG,EAAGtD,GAClB,IAAI6J,EAAI1G,GAAKA,EAAEoG,qBAAqBgB,UAAYpH,EAAIoH,UAClD/B,EAAIvD,OAAOuF,OAAOX,EAAEN,WACtB,OAAO3D,EAAkB4C,EAAG,UAAW,SAAUpF,EAAGD,EAAGG,GACrD,IAAItD,EACF6J,EACArB,EACAb,EAAI,EACJE,EAAIvE,GAAK,GACTmH,GAAI,EACJC,EAAI,CACF7C,EAAG,EACH1E,EAAG,EACHL,EAAGH,EACHY,EAAGX,EACH+E,EAAG/E,EAAE+H,KAAKhI,EAAG,GACbC,EAAG,SAASA,EAAES,EAAGD,GACf,OAAOpD,EAAIqD,EAAGwG,EAAI,EAAGrB,EAAI7F,EAAG+H,EAAEvH,EAAIC,EAAGG,CACvC,GAEJ,SAASX,EAAEQ,EAAGD,GACZ,IAAK0G,EAAIzG,EAAGoF,EAAIrF,EAAGE,EAAI,GAAIoH,GAAK9C,IAAMrE,GAAKD,EAAIwE,EAAE5H,OAAQoD,IAAK,CAC5D,IAAIC,EACFtD,EAAI6H,EAAExE,GACNT,EAAI8H,EAAE7C,EACN+C,EAAI5K,EAAE,GACRoD,EAAI,GAAKE,EAAIsH,IAAMzH,KAAOqF,EAAIxI,GAAG6J,EAAI7J,EAAE,IAAM,GAAK6J,EAAI,EAAG,IAAK7J,EAAE,GAAKA,EAAE,GAAK2C,GAAK3C,EAAE,IAAM4C,KAAOU,EAAIF,EAAI,GAAKR,EAAI5C,EAAE,KAAO6J,EAAI,EAAGa,EAAE5H,EAAIK,EAAGuH,EAAEvH,EAAInD,EAAE,IAAM4C,EAAIgI,IAAMtH,EAAIF,EAAI,GAAKpD,EAAE,GAAKmD,GAAKA,EAAIyH,KAAO5K,EAAE,GAAKoD,EAAGpD,EAAE,GAAKmD,EAAGuH,EAAEvH,EAAIyH,EAAGf,EAAI,GACzO,CACA,GAAIvG,GAAKF,EAAI,EAAG,OAAOG,EACvB,MAAMkH,GAAI,EAAItH,CAChB,CACA,OAAO,SAAUG,EAAGuE,EAAG+C,GACrB,GAAIjD,EAAI,EAAG,MAAMpB,UAAU,gCAC3B,IAAKkE,GAAK,IAAM5C,GAAKjF,EAAEiF,EAAG+C,GAAIf,EAAIhC,EAAGW,EAAIoC,GAAIvH,EAAIwG,EAAI,EAAIlH,EAAI6F,KAAOiC,GAAI,CACtEzK,IAAM6J,EAAIA,EAAI,GAAKA,EAAI,IAAMa,EAAEvH,GAAK,GAAIP,EAAEiH,EAAGrB,IAAMkC,EAAEvH,EAAIqF,EAAIkC,EAAE5H,EAAI0F,GACnE,IACE,GAAIb,EAAI,EAAG3H,EAAG,CACZ,GAAI6J,IAAMvG,EAAI,QAASD,EAAIrD,EAAEsD,GAAI,CAC/B,KAAMD,EAAIA,EAAEgD,KAAKrG,EAAGwI,IAAK,MAAMjC,UAAU,oCACzC,IAAKlD,EAAEK,KAAM,OAAOL,EACpBmF,EAAInF,EAAEM,MAAOkG,EAAI,IAAMA,EAAI,EAC7B,MAAO,IAAMA,IAAMxG,EAAIrD,EAAU,SAAMqD,EAAEgD,KAAKrG,GAAI6J,EAAI,IAAMrB,EAAIjC,UAAU,oCAAsCjD,EAAI,YAAauG,EAAI,GACrI7J,EAAI2C,CACN,MAAO,IAAKU,GAAKoH,EAAIC,EAAEvH,EAAI,GAAKqF,EAAIpF,EAAEiD,KAAKlD,EAAGuH,MAAQnH,EAAG,KAC3D,CAAE,MAAOF,GACPrD,EAAI2C,EAAGkH,EAAI,EAAGrB,EAAInF,CACpB,CAAE,QACAsE,EAAI,CACN,CACF,CACA,MAAO,CACLhE,MAAON,EACPK,KAAM+G,EAEV,CACF,CApDuC,CAoDrCrH,EAAGE,EAAGtD,IAAI,GAAKwI,CACnB,CACA,IAAIjF,EAAI,CAAC,EACT,SAASgH,YAAa,CACtB,SAASM,oBAAqB,CAC9B,SAASC,6BAA8B,CACvCzH,EAAI4B,OAAO+B,eACX,IAAI6C,EAAI,GAAG1G,GAAKE,EAAEA,EAAE,GAAGF,QAAUyC,EAAkBvC,EAAI,CAAC,EAAGF,EAAG,WAC1D,OAAON,IACT,GAAIQ,GACJmF,EAAIsC,2BAA2BvB,UAAYgB,UAAUhB,UAAYtE,OAAOuF,OAAOX,GACjF,SAASlC,EAAEhF,GACT,OAAOsC,OAAO8F,eAAiB9F,OAAO8F,eAAepI,EAAGmI,6BAA+BnI,EAAEsE,UAAY6D,2BAA4BlF,EAAkBjD,EAAGW,EAAG,sBAAuBX,EAAE4G,UAAYtE,OAAOuF,OAAOhC,GAAI7F,CAClN,CACA,OAAOkI,kBAAkBtB,UAAYuB,2BAA4BlF,EAAkB4C,EAAG,cAAesC,4BAA6BlF,EAAkBkF,2BAA4B,cAAeD,mBAAoBA,kBAAkB1D,YAAc,oBAAqBvB,EAAkBkF,2BAA4BxH,EAAG,qBAAsBsC,EAAkB4C,GAAI5C,EAAkB4C,EAAGlF,EAAG,aAAcsC,EAAkB4C,EAAGrF,EAAG,WACja,OAAON,IACT,GAAI+C,EAAkB4C,EAAG,WAAY,WACnC,MAAO,oBACT,IAAKvJ,EAAOD,QAAUqL,aAAe,SAASA,eAC5C,MAAO,CACLpC,EAAGjI,EACH+G,EAAGY,EAEP,EAAG1I,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,UAC1E,CACAC,EAAOD,QAAUqL,aAAcpL,EAAOD,QAAQgE,YAAa,EAAM/D,EAAOD,QAAiB,QAAIC,EAAOD,O,GCvFhGgM,EAA2B,CAAC,EAGhC,SAASC,oBAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB9G,IAAjB+G,EACH,OAAOA,EAAanM,QAGrB,IAAIC,EAAS+L,EAAyBE,GAAY,CACjD3L,GAAI2L,EAEJlM,QAAS,CAAC,GAOX,OAHAoM,EAAoBF,GAAUjM,EAAQA,EAAOD,QAASiM,qBAG/ChM,EAAOD,OACf,CAGAiM,oBAAoBlE,EAAIqE,ECxBxBH,oBAAoB9H,EAAKlE,IACxB,IAAIoM,EAASpM,GAAUA,EAAO+D,WAC7B,IAAO/D,EAAiB,QACxB,IAAM,EAEP,OADAgM,oBAAoBrI,EAAEyI,EAAQ,CAAE9H,EAAG8H,IAC5BA,GCLRJ,oBAAoBrI,EAAI,CAAC5D,EAASsM,KACjC,IAAI,IAAIC,KAAOD,EACXL,oBAAoB3H,EAAEgI,EAAYC,KAASN,oBAAoB3H,EAAEtE,EAASuM,IAC5EtG,OAAOU,eAAe3G,EAASuM,EAAK,CAAEzF,YAAY,EAAM0F,IAAKF,EAAWC,MCH3EN,oBAAoBzC,EAAKiD,GAEZA,EAAU,sBCHvBR,oBAAoB3H,EAAI,CAAC1C,EAAK8K,IAAUzG,OAAOsE,UAAUoC,eAAetF,KAAKzF,EAAK8K,GCClFT,oBAAoB7H,EAAKpE,IACH,oBAAXmH,QAA0BA,OAAOmE,aAC1CrF,OAAOU,eAAe3G,EAASmH,OAAOmE,YAAa,CAAE3G,MAAO,WAE7DsB,OAAOU,eAAe3G,EAAS,aAAc,CAAE2E,OAAO,KCLvDsH,oBAAoBpD,EAAI,UCAxBoD,oBAAoBW,EAAIpJ,SAASqJ,SAAWzM,KAAK0M,SAASC,KCA1Dd,oBAAoBe,QAAK5H,E,ojBCWrBhE,EAAU,CAAC,EAEfA,EAAQ8B,kBAAoB,IAC5B9B,EAAQmF,cAAgB,IACxBnF,EAAQqF,OAAS,SAAc,KAAM,QACrCrF,EAAQoB,OAAS,IACjBpB,EAAQgF,mBAAqB,IAEhB,IAAI,IAAShF,GAKJ,KAAW,IAAQ6L,QAAS,IAAQA,OCxB1D,SAASC,kBAAkB9I,EAAGG,IAC3B,MAAQA,GAAKA,EAAIH,EAAEnD,UAAYsD,EAAIH,EAAEnD,QACtC,IAAK,IAAI0C,EAAI,EAAGQ,EAAIgJ,MAAM5I,GAAIZ,EAAIY,EAAGZ,IAAKQ,EAAER,GAAKS,EAAET,GACnD,OAAOQ,CACT,CCHA,SAASiJ,4BAA4BhJ,EAAGG,GACtC,GAAIH,EAAG,CACL,GAAI,iBAAmBA,EAAG,OAAO,kBAAiBA,EAAGG,GACrD,IAAIF,EAAI,CAAC,EAAEQ,SAASwC,KAAKjD,GAAGiJ,MAAM,GAAI,GACtC,MAAO,WAAahJ,GAAKD,EAAE8D,cAAgB7D,EAAID,EAAE8D,YAAYE,MAAO,QAAU/D,GAAK,QAAUA,EAAI8I,MAAMG,KAAKlJ,GAAK,cAAgBC,GAAK,2CAA2CkJ,KAAKlJ,GAAK,kBAAiBD,EAAGG,QAAK,CACtN,CACF,CCHA,SAAS,4BAAeH,EAAGT,GACzB,OCLF,SAAS6J,gBAAgBpJ,GACvB,GAAI+I,MAAMM,QAAQrJ,GAAI,OAAOA,CAC/B,CDGS,CAAeA,IELxB,SAASsJ,sBAAsBtJ,EAAGwH,GAChC,IAAIvH,EAAI,MAAQD,EAAI,KAAO,oBAAsB+C,QAAU/C,EAAE+C,OAAOC,WAAahD,EAAE,cACnF,GAAI,MAAQC,EAAG,CACb,IAAIV,EACFQ,EACAnD,EACAwI,EACAjF,EAAI,GACJoE,GAAI,EACJrE,GAAI,EACN,IACE,GAAItD,GAAKqD,EAAIA,EAAEgD,KAAKjD,IAAII,KAAM,IAAMoH,EAAG,CACrC,GAAI3F,OAAO5B,KAAOA,EAAG,OACrBsE,GAAI,CACN,MAAO,OAASA,GAAKhF,EAAI3C,EAAEqG,KAAKhD,IAAIK,QAAUH,EAAEjE,KAAKqD,EAAEgB,OAAQJ,EAAEtD,SAAW2K,GAAIjD,GAAI,GACtF,CAAE,MAAOvE,GACPE,GAAI,EAAIH,EAAIC,CACd,CAAE,QACA,IACE,IAAKuE,GAAK,MAAQtE,EAAU,SAAMmF,EAAInF,EAAU,SAAK4B,OAAOuD,KAAOA,GAAI,MACzE,CAAE,QACA,GAAIlF,EAAG,MAAMH,CACf,CACF,CACA,OAAOI,CACT,CACF,CFrB8B,CAAqBH,EAAGT,IAAM,4BAA2BS,EAAGT,IGL1F,SAASgK,mBACP,MAAM,IAAIpG,UAAU,4IACtB,CHGgG,EAChG,CIFA,SAAS,oCAAmBnD,GAC1B,OCJF,SAASwJ,mBAAmBxJ,GAC1B,GAAI+I,MAAMM,QAAQrJ,GAAI,OAAO,kBAAiBA,EAChD,CDES,CAAkBA,IEL3B,SAASyJ,iBAAiBzJ,GACxB,GAAI,oBAAsB+C,QAAU,MAAQ/C,EAAE+C,OAAOC,WAAa,MAAQhD,EAAE,cAAe,OAAO+I,MAAMG,KAAKlJ,EAC/G,CFGiC,CAAgBA,IAAM,4BAA2BA,IGLlF,SAAS0J,qBACP,MAAM,IAAIvG,UAAU,uIACtB,CHGwF,EACxF,CINA,SAASwG,OAAQ,CAEF,kBAASC,GACtB,OAAmB,MAAZA,EAAmBD,KAAO,WAC/B,OAAOlK,KAAKoG,cAAc+D,EAC5B,CACF,CCAe,SAASC,MAAMC,GAC5B,OAAY,MAALA,EAAY,GAAKf,MAAMM,QAAQS,GAAKA,EAAIf,MAAMG,KAAKY,EAC5D,CCRA,SAASC,QACP,MAAO,EACT,CAEe,qBAASH,GACtB,OAAmB,MAAZA,EAAmBG,MAAQ,WAChC,OAAOtK,KAAKuK,iBAAiBJ,EAC/B,CACF,CCRe,iBAASA,GACtB,OAAO,WACL,OAAOnK,KAAKwK,QAAQL,EACtB,CACF,CAEO,SAASM,aAAaN,GAC3B,OAAO,SAASO,GACd,OAAOA,EAAKF,QAAQL,EACtB,CACF,CCRA,IAAIQ,EAAOrB,MAAM5C,UAAUiE,KAQ3B,SAASC,aACP,OAAO5K,KAAK6K,iBACd,CCVA,IAAIC,EAASxB,MAAM5C,UAAUoE,OAE7B,SAASC,WACP,OAAOzB,MAAMG,KAAKzJ,KAAK+K,SACzB,CCNe,gBAASnM,GACtB,OAAO,IAAI0K,MAAM1K,EAAOxB,OAC1B,CCKO,SAAS4N,UAAUC,EAAQC,GAChClL,KAAKmL,cAAgBF,EAAOE,cAC5BnL,KAAKoL,aAAeH,EAAOG,aAC3BpL,KAAKqL,MAAQ,KACbrL,KAAKsL,QAAUL,EACfjL,KAAKuL,SAAWL,CAClB,CCTA,SAASM,UAAUP,EAAQQ,EAAOC,EAAO9M,EAAQ+M,EAAM1J,GASrD,IARA,IACIyI,EADAvN,EAAI,EAEJyO,EAAcH,EAAMrO,OACpByO,EAAa5J,EAAK7E,OAKfD,EAAI0O,IAAc1O,GACnBuN,EAAOe,EAAMtO,KACfuN,EAAKa,SAAWtJ,EAAK9E,GACrByB,EAAOzB,GAAKuN,GAEZgB,EAAMvO,GAAK,IAAI6N,UAAUC,EAAQhJ,EAAK9E,IAK1C,KAAOA,EAAIyO,IAAezO,GACpBuN,EAAOe,EAAMtO,MACfwO,EAAKxO,GAAKuN,EAGhB,CAEA,SAASoB,QAAQb,EAAQQ,EAAOC,EAAO9M,EAAQ+M,EAAM1J,EAAMyG,GACzD,IAAIvL,EACAuN,EAKAqB,EAJAC,EAAiB,IAAIC,IACrBL,EAAcH,EAAMrO,OACpByO,EAAa5J,EAAK7E,OAClB8O,EAAY,IAAI5C,MAAMsC,GAK1B,IAAKzO,EAAI,EAAGA,EAAIyO,IAAezO,GACzBuN,EAAOe,EAAMtO,MACf+O,EAAU/O,GAAK4O,EAAWrD,EAAIlF,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,GAAS,GAChEO,EAAeG,IAAIJ,GACrBJ,EAAKxO,GAAKuN,EAEVsB,EAAeI,IAAIL,EAAUrB,IAQnC,IAAKvN,EAAI,EAAGA,EAAI0O,IAAc1O,EAC5B4O,EAAWrD,EAAIlF,KAAKyH,EAAQhJ,EAAK9E,GAAIA,EAAG8E,GAAQ,IAC5CyI,EAAOsB,EAAerD,IAAIoD,KAC5BnN,EAAOzB,GAAKuN,EACZA,EAAKa,SAAWtJ,EAAK9E,GACrB6O,EAAeK,OAAON,IAEtBL,EAAMvO,GAAK,IAAI6N,UAAUC,EAAQhJ,EAAK9E,IAK1C,IAAKA,EAAI,EAAGA,EAAIyO,IAAezO,GACxBuN,EAAOe,EAAMtO,KAAQ6O,EAAerD,IAAIuD,EAAU/O,MAAQuN,IAC7DiB,EAAKxO,GAAKuN,EAGhB,CAEA,SAASQ,MAAMR,GACb,OAAOA,EAAKa,QACd,CA+CA,SAASe,UAAUrK,GACjB,MAAuB,iBAATA,GAAqB,WAAYA,EAC3CA,EACAqH,MAAMG,KAAKxH,EACjB,CC1GA,SAASsK,UAAU7L,EAAGqI,GACpB,OAAOrI,EAAIqI,GAAK,EAAIrI,EAAIqI,EAAI,EAAIrI,GAAKqI,EAAI,EAAIyD,GAC/C,CFRAxB,UAAUtE,UAAY,CACpBrC,YAAa2G,UACbtL,YAAa,SAAS+M,GAAS,OAAOzM,KAAKsL,QAAQoB,aAAaD,EAAOzM,KAAKqL,MAAQ,EACpFqB,aAAc,SAASD,EAAO9L,GAAQ,OAAOX,KAAKsL,QAAQoB,aAAaD,EAAO9L,EAAO,EACrFyF,cAAe,SAAS+D,GAAY,OAAOnK,KAAKsL,QAAQlF,cAAc+D,EAAW,EACjFI,iBAAkB,SAASJ,GAAY,OAAOnK,KAAKsL,QAAQf,iBAAiBJ,EAAW,GGpBlF,IAAIwC,EAAQ,+BAEnB,SACEC,IAAK,6BACLD,MAAOA,EACPE,MAAO,+BACPC,IAAK,uCACLC,MAAO,iCCLM,mBAASxI,GACtB,IAAIyI,EAASzI,GAAQ,GAAIpH,EAAI6P,EAAOC,QAAQ,KAE5C,OADI9P,GAAK,GAAqC,WAA/B6P,EAASzI,EAAKiF,MAAM,EAAGrM,MAAiBoH,EAAOA,EAAKiF,MAAMrM,EAAI,IACtE+P,EAAWpE,eAAekE,GAAU,CAACG,MAAOD,EAAWF,GAASI,MAAO7I,GAAQA,CACxF,CCJA,SAAS8I,WAAW9I,GAClB,OAAO,WACLvE,KAAKsN,gBAAgB/I,EACvB,CACF,CAEA,SAASgJ,aAAaC,GACpB,OAAO,WACLxN,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,MAClD,CACF,CAEA,SAASM,aAAanJ,EAAMzD,GAC1B,OAAO,WACLd,KAAKlD,aAAayH,EAAMzD,EAC1B,CACF,CAEA,SAAS6M,eAAeH,EAAU1M,GAChC,OAAO,WACLd,KAAK4N,eAAeJ,EAASL,MAAOK,EAASJ,MAAOtM,EACtD,CACF,CAEA,SAAS+M,aAAatJ,EAAMzD,GAC1B,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKsN,gBAAgB/I,GAC/BvE,KAAKlD,aAAayH,EAAMtE,EAC/B,CACF,CAEA,SAAS8N,eAAeP,EAAU1M,GAChC,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,OAC1DpN,KAAK4N,eAAeJ,EAASL,MAAOK,EAASJ,MAAOnN,EAC3D,CACF,CCxCe,oBAASyK,GACtB,OAAQA,EAAKS,eAAiBT,EAAKS,cAAc6C,aACzCtD,EAAK/K,UAAY+K,GAClBA,EAAKsD,WACd,CCFA,SAASC,YAAY1J,GACnB,OAAO,WACLvE,KAAKgG,MAAMkI,eAAe3J,EAC5B,CACF,CAEA,SAAS4J,cAAc5J,EAAMzD,EAAOsN,GAClC,OAAO,WACLpO,KAAKgG,MAAMqI,YAAY9J,EAAMzD,EAAOsN,EACtC,CACF,CAEA,SAASE,cAAc/J,EAAMzD,EAAOsN,GAClC,OAAO,WACL,IAAInO,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKgG,MAAMkI,eAAe3J,GACpCvE,KAAKgG,MAAMqI,YAAY9J,EAAMtE,EAAGmO,EACvC,CACF,CAWO,SAASG,WAAW7D,EAAMnG,GAC/B,OAAOmG,EAAK1E,MAAMwI,iBAAiBjK,IAC5B,WAAYmG,GAAM+D,iBAAiB/D,EAAM,MAAM8D,iBAAiBjK,EACzE,CClCA,SAASmK,eAAenK,GACtB,OAAO,kBACEvE,KAAKuE,EACd,CACF,CAEA,SAASoK,iBAAiBpK,EAAMzD,GAC9B,OAAO,WACLd,KAAKuE,GAAQzD,CACf,CACF,CAEA,SAAS8N,iBAAiBrK,EAAMzD,GAC9B,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,SAAkBD,KAAKuE,GACtBvE,KAAKuE,GAAQtE,CACpB,CACF,CClBA,SAAS4O,WAAWC,GAClB,OAAOA,EAAOC,OAAOC,MAAM,QAC7B,CAEA,SAASC,UAAUvE,GACjB,OAAOA,EAAKuE,WAAa,IAAIC,UAAUxE,EACzC,CAEA,SAASwE,UAAUxE,GACjB1K,KAAKmP,MAAQzE,EACb1K,KAAKoP,OAASP,WAAWnE,EAAK2E,aAAa,UAAY,GACzD,CAsBA,SAASC,WAAW5E,EAAM6E,GAExB,IADA,IAAIjS,EAAO2R,UAAUvE,GAAOvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SACrCD,EAAImD,GAAGhD,EAAKkS,IAAID,EAAMpS,GACjC,CAEA,SAASsS,cAAc/E,EAAM6E,GAE3B,IADA,IAAIjS,EAAO2R,UAAUvE,GAAOvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SACrCD,EAAImD,GAAGhD,EAAKwB,OAAOyQ,EAAMpS,GACpC,CAEA,SAASuS,YAAYH,GACnB,OAAO,WACLD,WAAWtP,KAAMuP,EACnB,CACF,CAEA,SAASI,aAAaJ,GACpB,OAAO,WACLE,cAAczP,KAAMuP,EACtB,CACF,CAEA,SAASK,gBAAgBL,EAAOzO,GAC9B,OAAO,YACJA,EAAMqG,MAAMnH,KAAM8N,WAAawB,WAAaG,eAAezP,KAAMuP,EACpE,CACF,CC3DA,SAASM,aACP7P,KAAK8P,YAAc,EACrB,CAEA,SAASC,aAAajP,GACpB,OAAO,WACLd,KAAK8P,YAAchP,CACrB,CACF,CAEA,SAASkP,aAAalP,GACpB,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WAC1B9N,KAAK8P,YAAmB,MAAL7P,EAAY,GAAKA,CACtC,CACF,CCfA,SAASgQ,aACPjQ,KAAKkQ,UAAY,EACnB,CAEA,SAASC,aAAarP,GACpB,OAAO,WACLd,KAAKkQ,UAAYpP,CACnB,CACF,CAEA,SAASsP,aAAatP,GACpB,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WAC1B9N,KAAKkQ,UAAiB,MAALjQ,EAAY,GAAKA,CACpC,CACF,CCfA,SAASoQ,QACHrQ,KAAKsQ,aAAatQ,KAAKqH,WAAW3H,YAAYM,KACpD,CCFA,SAASuQ,QACHvQ,KAAKwQ,iBAAiBxQ,KAAKqH,WAAWqF,aAAa1M,KAAMA,KAAKqH,WAAW7H,WAC/E,CCCA,SAASiR,eAAelM,GACtB,OAAO,WACL,IAAI5E,EAAWK,KAAKmL,cAChBuF,EAAM1Q,KAAKoL,aACf,OAAOsF,IAAQ/D,GAAShN,EAASgR,gBAAgBvF,eAAiBuB,EAC5DhN,EAAS8C,cAAc8B,GACvB5E,EAASiR,gBAAgBF,EAAKnM,EACtC,CACF,CAEA,SAASsM,aAAarD,GACpB,OAAO,WACL,OAAOxN,KAAKmL,cAAcyF,gBAAgBpD,EAASL,MAAOK,EAASJ,MACrE,CACF,CAEe,qBAAS7I,GACtB,IAAIiJ,EAAWsD,UAAUvM,GACzB,OAAQiJ,EAASJ,MACXyD,aACAJ,gBAAgBjD,EACxB,CCrBA,SAASuD,eACP,OAAO,IACT,CCLA,SAASjS,SACP,IAAImM,EAASjL,KAAKqH,WACd4D,GAAQA,EAAOxL,YAAYO,KACjC,CCHA,SAASgR,yBACP,IAAIC,EAAQjR,KAAKkR,WAAU,GAAQjG,EAASjL,KAAKqH,WACjD,OAAO4D,EAASA,EAAOyB,aAAauE,EAAOjR,KAAKsQ,aAAeW,CACjE,CAEA,SAASE,sBACP,IAAIF,EAAQjR,KAAKkR,WAAU,GAAOjG,EAASjL,KAAKqH,WAChD,OAAO4D,EAASA,EAAOyB,aAAauE,EAAOjR,KAAKsQ,aAAeW,CACjE,CCMA,SAASG,SAASC,GAChB,OAAO,WACL,IAAIC,EAAKtR,KAAKuR,KACd,GAAKD,EAAL,CACA,IAAK,IAAkC7Q,EAA9B+Q,EAAI,EAAGrU,GAAK,EAAG+G,EAAIoN,EAAGlU,OAAWoU,EAAItN,IAAKsN,EAC7C/Q,EAAI6Q,EAAGE,GAAMH,EAASI,MAAQhR,EAAEgR,OAASJ,EAASI,MAAShR,EAAE8D,OAAS8M,EAAS9M,KAGjF+M,IAAKnU,GAAKsD,EAFVT,KAAK0R,oBAAoBjR,EAAEgR,KAAMhR,EAAEkR,SAAUlR,EAAElD,WAK7CJ,EAAGmU,EAAGlU,OAASD,SACT6C,KAAKuR,IATF,CAUjB,CACF,CAEA,SAASK,MAAMP,EAAUvQ,EAAOvD,GAC9B,OAAO,WACL,IAAoBkD,EAAhB6Q,EAAKtR,KAAKuR,KAASI,EAhC3B,SAASE,gBAAgBF,GACvB,OAAO,SAASG,GACdH,EAASnO,KAAKxD,KAAM8R,EAAO9R,KAAKuL,SAClC,CACF,CA4BsCsG,CAAgB/Q,GAClD,GAAIwQ,EAAI,IAAK,IAAIE,EAAI,EAAGtN,EAAIoN,EAAGlU,OAAQoU,EAAItN,IAAKsN,EAC9C,IAAK/Q,EAAI6Q,EAAGE,IAAIC,OAASJ,EAASI,MAAQhR,EAAE8D,OAAS8M,EAAS9M,KAI5D,OAHAvE,KAAK0R,oBAAoBjR,EAAEgR,KAAMhR,EAAEkR,SAAUlR,EAAElD,SAC/CyC,KAAK+R,iBAAiBtR,EAAEgR,KAAMhR,EAAEkR,SAAWA,EAAUlR,EAAElD,QAAUA,QACjEkD,EAAEK,MAAQA,GAIdd,KAAK+R,iBAAiBV,EAASI,KAAME,EAAUpU,GAC/CkD,EAAI,CAACgR,KAAMJ,EAASI,KAAMlN,KAAM8M,EAAS9M,KAAMzD,MAAOA,EAAO6Q,SAAUA,EAAUpU,QAASA,GACrF+T,EACAA,EAAG7U,KAAKgE,GADJT,KAAKuR,KAAO,CAAC9Q,EAExB,CACF,CC5CA,SAASuR,cAActH,EAAM+G,EAAMQ,GACjC,IAAI5L,EAAS,WAAYqE,GACrBoH,EAAQzL,EAAO6L,YAEE,mBAAVJ,EACTA,EAAQ,IAAIA,EAAML,EAAMQ,IAExBH,EAAQzL,EAAO1G,SAASwS,YAAY,SAChCF,GAAQH,EAAMM,UAAUX,EAAMQ,EAAOI,QAASJ,EAAOK,YAAaR,EAAMS,OAASN,EAAOM,QACvFT,EAAMM,UAAUX,GAAM,GAAO,IAGpC/G,EAAKsH,cAAcF,EACrB,CAEA,SAASU,iBAAiBf,EAAMQ,GAC9B,OAAO,WACL,OAAOD,cAAchS,KAAMyR,EAAMQ,EACnC,CACF,CAEA,SAASQ,iBAAiBhB,EAAMQ,GAC9B,OAAO,WACL,OAAOD,cAAchS,KAAMyR,EAAMQ,EAAO9K,MAAMnH,KAAM8N,WACtD,CACF,CVdAoB,UAAUxI,UAAY,CACpB8I,IAAK,SAASjL,GACJvE,KAAKoP,OAAOnC,QAAQ1I,GACpB,IACNvE,KAAKoP,OAAO3S,KAAK8H,GACjBvE,KAAKmP,MAAMrS,aAAa,QAASkD,KAAKoP,OAAOhO,KAAK,MAEtD,EACAtC,OAAQ,SAASyF,GACf,IAAIpH,EAAI6C,KAAKoP,OAAOnC,QAAQ1I,GACxBpH,GAAK,IACP6C,KAAKoP,OAAO3Q,OAAOtB,EAAG,GACtB6C,KAAKmP,MAAMrS,aAAa,QAASkD,KAAKoP,OAAOhO,KAAK,MAEtD,EACAsR,SAAU,SAASnO,GACjB,OAAOvE,KAAKoP,OAAOnC,QAAQ1I,IAAS,CACtC,GWKK,IAAI,EAAO,CAAC,MAEZ,SAAS,oBAAUoO,EAAQC,GAChC5S,KAAK6S,QAAUF,EACf3S,KAAK8S,SAAWF,CAClB,CAEA,SAASG,YACP,OAAO,IAAI,oBAAU,CAAC,CAACpT,SAASgR,kBAAmB,EACrD,CAMA,oBAAUjK,UAAYqM,UAAUrM,UAAY,CAC1CrC,YAAa,oBACb2O,OCjDa,0BAASA,GACA,mBAAXA,IAAuBA,EAAS7I,SAAS6I,IAEpD,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAiF9G,EAAMwI,EAAnFzH,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,IAAIlI,MAAMhJ,GAAmBnD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9GuN,EAAOe,EAAMtO,MAAQ+V,EAAUF,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,MAClE,aAAcf,IAAMwI,EAAQ3H,SAAWb,EAAKa,UAChD4H,EAAShW,GAAK+V,GAKpB,OAAO,IAAI,oBAAUD,EAAWjT,KAAK8S,SACvC,EDqCEM,UE3Ca,mBAASJ,GACYA,EAAZ,mBAAXA,EAPb,SAASK,SAASL,GAChB,OAAO,WACL,OAAO5I,MAAM4I,EAAO7L,MAAMnH,KAAM8N,WAClC,CACF,CAG6CuF,CAASL,GACtCM,YAAYN,GAE1B,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,GAAIL,EAAU,GAAIpB,EAAI,EAAGA,EAAItN,IAAKsN,EAC/F,IAAK,IAAyC9G,EAArCe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAcD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,MACf8V,EAAUxW,KAAKuW,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,IACnDmH,EAAQnW,KAAKiO,IAKnB,OAAO,IAAI,oBAAUuI,EAAWL,EAClC,EF8BEW,YvBxCa,qBAASC,GACtB,OAAOxT,KAAKgT,OAAgB,MAATQ,EAAgB5I,WAXrC,SAAS6I,UAAUD,GACjB,OAAO,WACL,OAAO7I,EAAKnH,KAAKxD,KAAK+K,SAAUyI,EAClC,CACF,CAQQC,CAA2B,mBAAVD,EAAuBA,EAAQ/I,aAAa+I,IACrE,EuBsCEE,etBzCa,wBAASF,GACtB,OAAOxT,KAAKoT,UAAmB,MAATI,EAAgBzI,SAPxC,SAAS4I,eAAeH,GACtB,OAAO,WACL,OAAO1I,EAAOtH,KAAKxD,KAAK+K,SAAUyI,EACpC,CACF,CAIQG,CAAgC,mBAAVH,EAAuBA,EAAQ/I,aAAa+I,IAC1E,EsBuCE1I,OGrDa,0BAAS0I,GACD,mBAAVA,IAAsBA,EAAQI,QAAQJ,IAEjD,IAAK,IAAIb,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAuE9G,EAAnEe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,GAAUrU,EAAI,EAAGA,EAAImD,IAAKnD,GAC3FuN,EAAOe,EAAMtO,KAAOqW,EAAMhQ,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,IAC1D0H,EAAS1W,KAAKiO,GAKpB,OAAO,IAAI,oBAAUuI,EAAWjT,KAAK8S,SACvC,EH0CE7Q,KnBqBa,cAASnB,EAAO4H,GAC7B,IAAKoF,UAAU1Q,OAAQ,OAAOkM,MAAMG,KAAKzJ,KAAMkL,OAE/C,IAAIpD,EAAOY,EAAMoD,QAAUN,UACvBoH,EAAU5S,KAAK8S,SACfH,EAAS3S,KAAK6S,QAEG,mBAAV/R,IAAsBA,EuBrFpB,sBAASuJ,GACtB,OAAO,WACL,OAAOA,CACT,CACF,CvBiF2C,CAASvJ,IAElD,IAAK,IAAIoD,EAAIyO,EAAOvV,OAAQwB,EAAS,IAAI0K,MAAMpF,GAAIwH,EAAQ,IAAIpC,MAAMpF,GAAIyH,EAAO,IAAIrC,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAAG,CAC/G,IAAIvG,EAAS2H,EAAQpB,GACjB/F,EAAQkH,EAAOnB,GACf5F,EAAcH,EAAMrO,OACpB6E,EAAOqK,UAAUxL,EAAM0C,KAAKyH,EAAQA,GAAUA,EAAOM,SAAUiG,EAAGoB,IAClE/G,EAAa5J,EAAK7E,OAClByW,EAAanI,EAAM8F,GAAK,IAAIlI,MAAMuC,GAClCiI,EAAclV,EAAO4S,GAAK,IAAIlI,MAAMuC,GAGxC/D,EAAKmD,EAAQQ,EAAOoI,EAAYC,EAFhBnI,EAAK6F,GAAK,IAAIlI,MAAMsC,GAEoB3J,EAAMyG,GAK9D,IAAK,IAAoBqL,EAAUpT,EAA1BqT,EAAK,EAAGC,EAAK,EAAmBD,EAAKnI,IAAcmI,EAC1D,GAAID,EAAWF,EAAWG,GAAK,CAE7B,IADIA,GAAMC,IAAIA,EAAKD,EAAK,KACfrT,EAAOmT,EAAYG,OAAUA,EAAKpI,IAC3CkI,EAAS1I,MAAQ1K,GAAQ,IAC3B,CAEJ,CAKA,OAHA/B,EAAS,IAAI,oBAAUA,EAAQgU,IACxBsB,OAASxI,EAChB9M,EAAOuV,MAAQxI,EACR/M,CACT,EmBzDE8M,MpBvDa,iBACb,OAAO,IAAI,oBAAU1L,KAAKkU,QAAUlU,KAAK6S,QAAQ5R,IAAImT,QAASpU,KAAK8S,SACrE,EoBsDEnH,KKxDa,gBACb,OAAO,IAAI,oBAAU3L,KAAKmU,OAASnU,KAAK6S,QAAQ5R,IAAImT,QAASpU,KAAK8S,SACpE,ELuDE1R,KM5Da,cAASiT,EAASC,EAAUC,GACzC,IAAI7I,EAAQ1L,KAAK0L,QAAS9M,EAASoB,KAAM2L,EAAO3L,KAAK2L,OAYrD,MAXuB,mBAAZ0I,GACT3I,EAAQ2I,EAAQ3I,MACLA,EAAQA,EAAMqH,aAEzBrH,EAAQA,EAAM8I,OAAOH,EAAU,IAEjB,MAAZC,IACF1V,EAAS0V,EAAS1V,MACNA,EAASA,EAAOmU,aAEhB,MAAVwB,EAAgB5I,EAAK7M,SAAeyV,EAAO5I,GACxCD,GAAS9M,EAAS8M,EAAM+I,MAAM7V,GAAQ8V,QAAU9V,CACzD,EN+CE6V,MO3Da,eAASE,GAGtB,IAFA,IAAI5B,EAAY4B,EAAQ5B,UAAY4B,EAAQ5B,YAAc4B,EAEjDC,EAAU5U,KAAK6S,QAASgC,EAAU9B,EAAUF,QAASiC,EAAKF,EAAQxX,OAAQ2X,EAAKF,EAAQzX,OAAQ8G,EAAI8Q,KAAKC,IAAIH,EAAIC,GAAKG,EAAS,IAAI5L,MAAMwL,GAAKtD,EAAI,EAAGA,EAAItN,IAAKsN,EACpK,IAAK,IAAmG9G,EAA/FyK,EAASP,EAAQpD,GAAI4D,EAASP,EAAQrD,GAAIlR,EAAI6U,EAAO/X,OAAQqX,EAAQS,EAAO1D,GAAK,IAAIlI,MAAMhJ,GAAUnD,EAAI,EAAGA,EAAImD,IAAKnD,GACxHuN,EAAOyK,EAAOhY,IAAMiY,EAAOjY,MAC7BsX,EAAMtX,GAAKuN,GAKjB,KAAO8G,EAAIsD,IAAMtD,EACf0D,EAAO1D,GAAKoD,EAAQpD,GAGtB,OAAO,IAAI,oBAAU0D,EAAQlV,KAAK8S,SACpC,EP4CEC,UAhBF,SAASsC,sBACP,OAAOrV,IACT,EAeE0U,MQ/Da,iBAEb,IAAK,IAAI/B,EAAS3S,KAAK6S,QAASrB,GAAK,EAAGtN,EAAIyO,EAAOvV,SAAUoU,EAAItN,GAC/D,IAAK,IAA8DwG,EAA1De,EAAQkH,EAAOnB,GAAIrU,EAAIsO,EAAMrO,OAAS,EAAGuD,EAAO8K,EAAMtO,KAAYA,GAAK,IAC1EuN,EAAOe,EAAMtO,MACXwD,GAA6C,EAArC+J,EAAK4K,wBAAwB3U,IAAWA,EAAK0G,WAAWqF,aAAahC,EAAM/J,GACvFA,EAAO+J,GAKb,OAAO1K,IACT,ERoDEuV,KlB9Da,cAASC,GAGtB,SAASC,YAAY/U,EAAGqI,GACtB,OAAOrI,GAAKqI,EAAIyM,EAAQ9U,EAAE6K,SAAUxC,EAAEwC,WAAa7K,GAAKqI,CAC1D,CAJKyM,IAASA,EAAUjJ,WAMxB,IAAK,IAAIoG,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQsY,EAAa,IAAIpM,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAAG,CAC/F,IAAK,IAAmF9G,EAA/Ee,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQuY,EAAYD,EAAWlE,GAAK,IAAIlI,MAAMhJ,GAAUnD,EAAI,EAAGA,EAAImD,IAAKnD,GACxGuN,EAAOe,EAAMtO,MACfwY,EAAUxY,GAAKuN,GAGnBiL,EAAUJ,KAAKE,YACjB,CAEA,OAAO,IAAI,oBAAUC,EAAY1V,KAAK8S,UAAU4B,OAClD,EkB8CElR,KSjEa,gBACb,IAAIoS,EAAW9H,UAAU,GAGzB,OAFAA,UAAU,GAAK9N,KACf4V,EAASzO,MAAM,KAAM2G,WACd9N,IACT,ET6DE6V,MUlEa,iBACb,OAAOvM,MAAMG,KAAKzJ,KACpB,EViEE0K,KWnEa,gBAEb,IAAK,IAAIiI,EAAS3S,KAAK6S,QAASrB,EAAI,EAAGtN,EAAIyO,EAAOvV,OAAQoU,EAAItN,IAAKsN,EACjE,IAAK,IAAI/F,EAAQkH,EAAOnB,GAAIrU,EAAI,EAAGmD,EAAImL,EAAMrO,OAAQD,EAAImD,IAAKnD,EAAG,CAC/D,IAAIuN,EAAOe,EAAMtO,GACjB,GAAIuN,EAAM,OAAOA,CACnB,CAGF,OAAO,IACT,EX0DEoL,KYpEa,gBACb,IAAIA,EAAO,EACX,IAAK,MAAMpL,KAAQ1K,OAAQ8V,EAC3B,OAAOA,CACT,EZiEExL,MarEa,2BACb,OAAQtK,KAAK0K,MACf,EboEEqL,KctEa,cAASH,GAEtB,IAAK,IAAIjD,EAAS3S,KAAK6S,QAASrB,EAAI,EAAGtN,EAAIyO,EAAOvV,OAAQoU,EAAItN,IAAKsN,EACjE,IAAK,IAAgD9G,EAA5Ce,EAAQkH,EAAOnB,GAAIrU,EAAI,EAAGmD,EAAImL,EAAMrO,OAAcD,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,KAAIyY,EAASpS,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,GAI/D,OAAOzL,IACT,Ed8DEgW,Kf7Ba,cAASzR,EAAMzD,GAC5B,IAAI0M,EAAWsD,UAAUvM,GAEzB,GAAIuJ,UAAU1Q,OAAS,EAAG,CACxB,IAAIsN,EAAO1K,KAAK0K,OAChB,OAAO8C,EAASJ,MACV1C,EAAKuL,eAAezI,EAASL,MAAOK,EAASJ,OAC7C1C,EAAK2E,aAAa7B,EAC1B,CAEA,OAAOxN,KAAK+V,MAAe,MAATjV,EACX0M,EAASJ,MAAQG,aAAeF,WAAgC,mBAAVvM,EACtD0M,EAASJ,MAAQW,eAAiBF,aAClCL,EAASJ,MAAQO,eAAiBD,cAAgBF,EAAU1M,GACrE,EegBEkF,MblDa,eAASzB,EAAMzD,EAAOsN,GACnC,OAAON,UAAU1Q,OAAS,EACpB4C,KAAK+V,MAAe,MAATjV,EACLmN,YAA+B,mBAAVnN,EACrBwN,cACAH,eAAe5J,EAAMzD,EAAmB,MAAZsN,EAAmB,GAAKA,IAC1DG,WAAWvO,KAAK0K,OAAQnG,EAChC,Ea4CE2R,SZrDa,kBAAS3R,EAAMzD,GAC5B,OAAOgN,UAAU1Q,OAAS,EACpB4C,KAAK+V,MAAe,MAATjV,EACP4N,eAAkC,mBAAV5N,EACxB8N,iBACAD,kBAAkBpK,EAAMzD,IAC5Bd,KAAK0K,OAAOnG,EACpB,EY+CE4R,QXba,iBAAS5R,EAAMzD,GAC5B,IAAIyO,EAAQV,WAAWtK,EAAO,IAE9B,GAAIuJ,UAAU1Q,OAAS,EAAG,CAExB,IADA,IAAIE,EAAO2R,UAAUjP,KAAK0K,QAASvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SAC5CD,EAAImD,OAAQhD,EAAKoV,SAASnD,EAAMpS,IAAK,OAAO,EACrD,OAAO,CACT,CAEA,OAAO6C,KAAK+V,MAAuB,mBAAVjV,EACnB8O,gBAAkB9O,EAClB4O,YACAC,cAAcJ,EAAOzO,GAC7B,EWCEsV,KV1Da,wBAAStV,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAK+V,KAAc,MAATjV,EACN+O,YAA+B,mBAAV/O,EACrBkP,aACAD,cAAcjP,IAClBd,KAAK0K,OAAOoF,WACpB,EUoDEuG,KT3Da,cAASvV,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAK+V,KAAc,MAATjV,EACNmP,YAA+B,mBAAVnP,EACrBsP,aACAD,cAAcrP,IAClBd,KAAK0K,OAAOwF,SACpB,ESqDEG,MRzEa,2BACb,OAAOrQ,KAAK+V,KAAK1F,MACnB,EQwEEE,MP1Ea,2BACb,OAAOvQ,KAAK+V,KAAKxF,MACnB,EOyEEiE,Oe7Ea,gBAASjQ,GACtB,IAAIoD,EAAyB,mBAATpD,EAAsBA,EAAO,YAAQA,GACzD,OAAOvE,KAAKgT,OAAO,WACjB,OAAOhT,KAAKN,YAAYiI,EAAOR,MAAMnH,KAAM8N,WAC7C,EACF,EfyEElL,OLzEa,gBAAS2B,EAAM+R,GAC5B,IAAI3O,EAAyB,mBAATpD,EAAsBA,EAAO,YAAQA,GACrDyO,EAAmB,MAAVsD,EAAiBvF,aAAiC,mBAAXuF,EAAwBA,EAASnM,SAASmM,GAC9F,OAAOtW,KAAKgT,OAAO,WACjB,OAAOhT,KAAK0M,aAAa/E,EAAOR,MAAMnH,KAAM8N,WAAYkF,EAAO7L,MAAMnH,KAAM8N,YAAc,KAC3F,EACF,EKoEEhP,OJ5Ea,4BACb,OAAOkB,KAAK+V,KAAKjX,OACnB,EI2EEmS,MHxEa,eAASsF,GACtB,OAAOvW,KAAKgT,OAAOuD,EAAOpF,oBAAsBH,uBAClD,EGuEE9F,MgBnFa,yBAASpK,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAKkW,SAAS,WAAYpV,GAC1Bd,KAAK0K,OAAOa,QACpB,EhBgFE+F,GFpCa,YAASD,EAAUvQ,EAAOvD,GACvC,IAA+CJ,EAAyBqD,EAApEgW,EA3CN,SAASC,eAAeD,GACtB,OAAOA,EAAUzH,OAAOC,MAAM,SAAS/N,IAAI,SAAST,GAClD,IAAI+D,EAAO,GAAIpH,EAAIqD,EAAEyM,QAAQ,KAE7B,OADI9P,GAAK,IAAGoH,EAAO/D,EAAEgJ,MAAMrM,EAAI,GAAIqD,EAAIA,EAAEgJ,MAAM,EAAGrM,IAC3C,CAACsU,KAAMjR,EAAG+D,KAAMA,EACzB,EACF,CAqCkBkS,CAAepF,EAAW,IAAQ/Q,EAAIkW,EAAUpZ,OAEhE,KAAI0Q,UAAU1Q,OAAS,GAAvB,CAaA,IADAkU,EAAKxQ,EAAQ8Q,MAAQR,SAChBjU,EAAI,EAAGA,EAAImD,IAAKnD,EAAG6C,KAAK+V,KAAKzE,EAAGkF,EAAUrZ,GAAI2D,EAAOvD,IAC1D,OAAOyC,IAJP,CATE,IAAIsR,EAAKtR,KAAK0K,OAAO6G,KACrB,GAAID,EAAI,IAAK,IAA0B7Q,EAAtB+Q,EAAI,EAAGtN,EAAIoN,EAAGlU,OAAWoU,EAAItN,IAAKsN,EACjD,IAAKrU,EAAI,EAAGsD,EAAI6Q,EAAGE,GAAIrU,EAAImD,IAAKnD,EAC9B,IAAKqD,EAAIgW,EAAUrZ,IAAIsU,OAAShR,EAAEgR,MAAQjR,EAAE+D,OAAS9D,EAAE8D,KACrD,OAAO9D,EAAEK,KAUnB,EEmBE4V,SDxDa,4BAASjF,EAAMQ,GAC5B,OAAOjS,KAAK+V,MAAwB,mBAAX9D,EACnBQ,iBACAD,kBAAkBf,EAAMQ,GAChC,ECqDE,CAAC3O,OAAOC,UiBtFK,oBACb,IAAK,IAAIoP,EAAS3S,KAAK6S,QAASrB,EAAI,EAAGtN,EAAIyO,EAAOvV,OAAQoU,EAAItN,IAAKsN,EACjE,IAAK,IAAgD9G,EAA5Ce,EAAQkH,EAAOnB,GAAIrU,EAAI,EAAGmD,EAAImL,EAAMrO,OAAcD,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,YAAUuN,EAGjC,GjBmFA,kBkBvFe,oBAASP,GACtB,MAA2B,iBAAbA,EACR,IAAI,oBAAU,CAAC,CAACxK,SAASyG,cAAc+D,KAAa,CAACxK,SAASgR,kBAC9D,IAAI,oBAAU,CAAC,CAACxG,IAAY,EACpC,CCNe,SAAS,QAAItE,EAAQ8Q,GAClC,IAAI1B,EACJ,QAAgB1T,IAAZoV,EACF,IAAK,MAAM7V,KAAS+E,EACL,MAAT/E,IACImU,EAAMnU,QAAkBS,IAAR0T,GAAqBnU,GAASA,KACpDmU,EAAMnU,OAGL,CACL,IAAI7B,GAAS,EACb,IAAK,IAAI6B,KAAS+E,EACiC,OAA5C/E,EAAQ6V,EAAQ7V,IAAS7B,EAAO4G,MAC7BoP,EAAMnU,QAAkBS,IAAR0T,GAAqBnU,GAASA,KACpDmU,EAAMnU,EAGZ,CACA,OAAOmU,CACT,CCnBe,SAAS,QAAIpP,EAAQ8Q,GAClC,IAAIC,EACJ,QAAgBrV,IAAZoV,EACF,IAAK,MAAM7V,KAAS+E,EACL,MAAT/E,IACI8V,EAAM9V,QAAkBS,IAARqV,GAAqB9V,GAASA,KACpD8V,EAAM9V,OAGL,CACL,IAAI7B,GAAS,EACb,IAAK,IAAI6B,KAAS+E,EACiC,OAA5C/E,EAAQ6V,EAAQ7V,IAAS7B,EAAO4G,MAC7B+Q,EAAM9V,QAAkBS,IAARqV,GAAqB9V,GAASA,KACpD8V,EAAM9V,EAGZ,CACA,OAAO8V,CACT,CCnBe,SAAS,cAAOvM,GAC7B,OAAa,OAANA,EAAamC,KAAOnC,CAC7B,CCoBO,SAASwM,eAAehR,EAAQb,EAAG2R,EAAU,eAClD,IAAMrW,EAAIuF,EAAOzI,UAAWqG,MAAMuB,GAAKA,GAAvC,CACA,GAAIA,GAAK,GAAK1E,EAAI,EAAG,OAAQqW,EAAQ9Q,EAAO,GAAI,EAAGA,GACnD,GAAIb,GAAK,EAAG,OAAQ2R,EAAQ9Q,EAAOvF,EAAI,GAAIA,EAAI,EAAGuF,GAClD,IAAIvF,EACAnD,GAAKmD,EAAI,GAAK0E,EACdgP,EAAKgB,KAAK8B,MAAM3Z,GAChB4Z,GAAUJ,EAAQ9Q,EAAOmO,GAAKA,EAAInO,GAEtC,OAAOkR,IADOJ,EAAQ9Q,EAAOmO,EAAK,GAAIA,EAAK,EAAGnO,GACpBkR,IAAW5Z,EAAI6W,EARQ,CASnD,CChCe,SAAS,oBAAUtT,EAAGqI,GACnC,OAAY,MAALrI,GAAkB,MAALqI,EAAYyD,IAAM9L,EAAIqI,GAAK,EAAIrI,EAAIqI,EAAI,EAAIrI,GAAKqI,EAAI,EAAIyD,GAC9E,CCFe,SAAS,sBAAW9L,EAAGqI,GACpC,OAAY,MAALrI,GAAkB,MAALqI,EAAYyD,IAC5BzD,EAAIrI,GAAK,EACTqI,EAAIrI,EAAI,EACRqI,GAAKrI,EAAI,EACT8L,GACN,CCHe,SAASwK,SAASlS,GAC/B,IAAImS,EAAUC,EAAUC,EAiBxB,SAASC,KAAK1W,EAAG2J,EAAGgN,EAAK,EAAGC,EAAK5W,EAAEtD,QACjC,GAAIia,EAAKC,EAAI,CACX,GAAuB,IAAnBL,EAAS5M,EAAGA,GAAU,OAAOiN,EACjC,EAAG,CACD,MAAMC,EAAOF,EAAKC,IAAQ,EACtBJ,EAASxW,EAAE6W,GAAMlN,GAAK,EAAGgN,EAAKE,EAAM,EACnCD,EAAKC,CACZ,OAASF,EAAKC,EAChB,CACA,OAAOD,CACT,CAmBA,OAvCiB,IAAbvS,EAAE1H,QACJ6Z,EAAW,oBACXC,EAAW,CAACnX,EAAGsK,IAAM,oBAAUvF,EAAE/E,GAAIsK,GACrC8M,EAAQ,CAACpX,EAAGsK,IAAMvF,EAAE/E,GAAKsK,IAEzB4M,EAAWnS,IAAM,qBAAaA,IAAM,sBAAaA,EAAI0S,KACrDN,EAAWpS,EACXqS,EAAQrS,GAgCH,CAACsS,KAAMK,OALd,SAASA,OAAO/W,EAAG2J,EAAGgN,EAAK,EAAGC,EAAK5W,EAAEtD,QACnC,MAAMD,EAAIia,KAAK1W,EAAG2J,EAAGgN,EAAIC,EAAK,GAC9B,OAAOna,EAAIka,GAAMF,EAAMzW,EAAEvD,EAAI,GAAIkN,IAAM8M,EAAMzW,EAAEvD,GAAIkN,GAAKlN,EAAI,EAAIA,CAClE,EAEsBua,MAjBtB,SAASA,MAAMhX,EAAG2J,EAAGgN,EAAK,EAAGC,EAAK5W,EAAEtD,QAClC,GAAIia,EAAKC,EAAI,CACX,GAAuB,IAAnBL,EAAS5M,EAAGA,GAAU,OAAOiN,EACjC,EAAG,CACD,MAAMC,EAAOF,EAAKC,IAAQ,EACtBJ,EAASxW,EAAE6W,GAAMlN,IAAM,EAAGgN,EAAKE,EAAM,EACpCD,EAAKC,CACZ,OAASF,EAAKC,EAChB,CACA,OAAOD,CACT,EAQF,CAEA,SAASG,OACP,OAAO,CACT,CCnDA,MAAMG,EAAkBX,SAAS,qBACpBY,EAAcD,EAAgBD,MAG3C,GAF0BC,EAAgBP,KACdJ,SAAS,eAAQS,OAC7C,GCRO,SAASI,UAAUC,EAAQC,GAChC,OAAQjK,UAAU1Q,QAChB,KAAK,EAAG,MACR,KAAK,EAAG4C,KAAK+X,MAAMD,GAAS,MAC5B,QAAS9X,KAAK+X,MAAMA,GAAOD,OAAOA,GAEpC,OAAO9X,IACT,CCJe,SAAS,oBACtB,IAGIgY,EAHAF,EAAS,GACTC,EAAQ,GACRE,EAAa,GAGjB,SAASC,UACP,IAAI/a,EAAI,EAAGmD,EAAI0U,KAAK4B,IAAI,EAAGmB,EAAM3a,QAEjC,IADA6a,EAAa,IAAI3O,MAAMhJ,EAAI,KAClBnD,EAAImD,GAAG2X,EAAW9a,EAAI,GAAK,eAAU2a,EAAQ3a,EAAImD,GAC1D,OAAO6X,KACT,CAEA,SAASA,MAAM9N,GACb,OAAY,MAALA,GAAa5G,MAAM4G,GAAKA,GAAK2N,EAAUD,EAAMK,EAAOH,EAAY5N,GACzE,CAqCA,OAnCA8N,MAAME,aAAe,SAASzQ,GAC5B,IAAIzK,EAAI4a,EAAM9K,QAAQrF,GACtB,OAAOzK,EAAI,EAAI,CAACqP,IAAKA,KAAO,CAC1BrP,EAAI,EAAI8a,EAAW9a,EAAI,GAAK2a,EAAO,GACnC3a,EAAI8a,EAAW7a,OAAS6a,EAAW9a,GAAK2a,EAAOA,EAAO1a,OAAS,GAEnE,EAEA+a,MAAML,OAAS,SAASQ,GACtB,IAAKxK,UAAU1Q,OAAQ,OAAO0a,EAAOtO,QACrCsO,EAAS,GACT,IAAK,IAAI/X,KAAKuY,EAAY,MAALvY,GAAc0D,MAAM1D,GAAKA,IAAI+X,EAAOrb,KAAKsD,GAE9D,OADA+X,EAAOvC,KAAK,qBACL2C,SACT,EAEAC,MAAMJ,MAAQ,SAASO,GACrB,OAAOxK,UAAU1Q,QAAU2a,EAAQzO,MAAMG,KAAK6O,GAAIJ,WAAaH,EAAMvO,OACvE,EAEA2O,MAAMH,QAAU,SAASM,GACvB,OAAOxK,UAAU1Q,QAAU4a,EAAUM,EAAGH,OAASH,CACnD,EAEAG,MAAMI,UAAY,WAChB,OAAON,EAAWzO,OACpB,EAEA2O,MAAMK,KAAO,WACX,OAAO,oBACFV,OAAOA,GACPC,MAAMA,GACNC,QAAQA,EACf,EAEOH,UAAU1Q,MAAMgR,MAAOrK,UAChC,CCxDA,MAAM2K,EAAMzD,KAAK0D,KAAK,IAClBC,EAAK3D,KAAK0D,KAAK,IACfE,EAAK5D,KAAK0D,KAAK,GAEnB,SAASG,SAASC,EAAOtU,EAAM5G,GAC7B,MAAMmb,GAAQvU,EAAOsU,GAAS9D,KAAK4B,IAAI,EAAGhZ,GACtCob,EAAQhE,KAAK8B,MAAM9B,KAAKiE,MAAMF,IAC9BG,EAAQH,EAAO/D,KAAKmE,IAAI,GAAIH,GAC5BI,EAASF,GAAST,EAAM,GAAKS,GAASP,EAAK,EAAIO,GAASN,EAAK,EAAI,EACrE,IAAI3E,EAAIoF,EAAIC,EAeZ,OAdIN,EAAQ,GACVM,EAAMtE,KAAKmE,IAAI,IAAKH,GAASI,EAC7BnF,EAAKe,KAAKuE,MAAMT,EAAQQ,GACxBD,EAAKrE,KAAKuE,MAAM/U,EAAO8U,GACnBrF,EAAKqF,EAAMR,KAAS7E,EACpBoF,EAAKC,EAAM9U,KAAQ6U,EACvBC,GAAOA,IAEPA,EAAMtE,KAAKmE,IAAI,GAAIH,GAASI,EAC5BnF,EAAKe,KAAKuE,MAAMT,EAAQQ,GACxBD,EAAKrE,KAAKuE,MAAM/U,EAAO8U,GACnBrF,EAAKqF,EAAMR,KAAS7E,EACpBoF,EAAKC,EAAM9U,KAAQ6U,GAErBA,EAAKpF,GAAM,IAAOrW,GAASA,EAAQ,EAAUib,SAASC,EAAOtU,EAAc,EAAR5G,GAChE,CAACqW,EAAIoF,EAAIC,EAClB,CAmBO,SAASE,cAAcV,EAAOtU,EAAM5G,GAEzC,OAAOib,SADOC,GAASA,EAAvBtU,GAAQA,EAAsB5G,GAASA,GACH,EACtC,CChDe,oBAASyG,EAAanI,EAASwK,GAC5CrC,EAAYqC,UAAYxK,EAAQwK,UAAYA,EAC5CA,EAAUrC,YAAcA,CAC1B,CAEO,SAASoV,OAAOxO,EAAQxC,GAC7B,IAAI/B,EAAYtE,OAAOuF,OAAOsD,EAAOvE,WACrC,IAAK,IAAIgC,KAAOD,EAAY/B,EAAUgC,GAAOD,EAAWC,GACxD,OAAOhC,CACT,CCPO,SAASgT,QAAS,CAElB,IAAIC,EAAS,GACTC,EAAW,EAAID,EAEtBE,EAAM,sBACNC,EAAM,oDACNC,EAAM,qDACNC,EAAQ,qBACRC,GAAe,IAAIC,OAAO,UAAUL,KAAOA,KAAOA,SAClDM,GAAe,IAAID,OAAO,UAAUH,KAAOA,KAAOA,SAClDK,GAAgB,IAAIF,OAAO,WAAWL,KAAOA,KAAOA,KAAOC,SAC3DO,GAAgB,IAAIH,OAAO,WAAWH,KAAOA,KAAOA,KAAOD,SAC3DQ,GAAe,IAAIJ,OAAO,UAAUJ,KAAOC,KAAOA,SAClDQ,GAAgB,IAAIL,OAAO,WAAWJ,KAAOC,KAAOA,KAAOD,SAE3DU,GAAQ,CACVC,UAAW,SACXC,aAAc,SACdC,KAAM,MACNC,WAAY,QACZC,MAAO,SACPC,MAAO,SACPC,OAAQ,SACRC,MAAO,EACPC,eAAgB,SAChBC,KAAM,IACNC,WAAY,QACZC,MAAO,SACPC,UAAW,SACXC,UAAW,QACXC,WAAY,QACZC,UAAW,SACXC,MAAO,SACPC,eAAgB,QAChBC,SAAU,SACVC,QAAS,SACTC,KAAM,MACNC,SAAU,IACVC,SAAU,MACVC,cAAe,SACfC,SAAU,SACVC,UAAW,MACXC,SAAU,SACVC,UAAW,SACXC,YAAa,QACbC,eAAgB,QAChBC,WAAY,SACZC,WAAY,SACZC,QAAS,QACTC,WAAY,SACZC,aAAc,QACdC,cAAe,QACfC,cAAe,QACfC,cAAe,QACfC,cAAe,MACfC,WAAY,QACZC,SAAU,SACVC,YAAa,MACbC,QAAS,QACTC,QAAS,QACTC,WAAY,QACZC,UAAW,SACXC,YAAa,SACbC,YAAa,QACbC,QAAS,SACTC,UAAW,SACXC,WAAY,SACZC,KAAM,SACNC,UAAW,SACXC,KAAM,QACNC,MAAO,MACPC,YAAa,SACbC,KAAM,QACNC,SAAU,SACVC,QAAS,SACTC,UAAW,SACXC,OAAQ,QACRC,MAAO,SACPC,MAAO,SACPC,SAAU,SACVC,cAAe,SACfC,UAAW,QACXC,aAAc,SACdC,UAAW,SACXC,WAAY,SACZC,UAAW,SACXC,qBAAsB,SACtBC,UAAW,SACXC,WAAY,QACZC,UAAW,SACXC,UAAW,SACXC,YAAa,SACbC,cAAe,QACfC,aAAc,QACdC,eAAgB,QAChBC,eAAgB,QAChBC,eAAgB,SAChBC,YAAa,SACbC,KAAM,MACNC,UAAW,QACXC,MAAO,SACPC,QAAS,SACTC,OAAQ,QACRC,iBAAkB,QAClBC,WAAY,IACZC,aAAc,SACdC,aAAc,QACdC,eAAgB,QAChBC,gBAAiB,QACjBC,kBAAmB,MACnBC,gBAAiB,QACjBC,gBAAiB,SACjBC,aAAc,QACdC,UAAW,SACXC,UAAW,SACXC,SAAU,SACVC,YAAa,SACbC,KAAM,IACNC,QAAS,SACTC,MAAO,QACPC,UAAW,QACXC,OAAQ,SACRC,UAAW,SACXC,OAAQ,SACRC,cAAe,SACfC,UAAW,SACXC,cAAe,SACfC,cAAe,SACfC,WAAY,SACZC,UAAW,SACXC,KAAM,SACNC,KAAM,SACNC,KAAM,SACNC,WAAY,SACZC,OAAQ,QACRC,cAAe,QACfC,IAAK,SACLC,UAAW,SACXC,UAAW,QACXC,YAAa,QACbC,OAAQ,SACRC,WAAY,SACZC,SAAU,QACVC,SAAU,SACVC,OAAQ,SACRC,OAAQ,SACRC,QAAS,QACTC,UAAW,QACXC,UAAW,QACXC,UAAW,QACXC,KAAM,SACNC,YAAa,MACbC,UAAW,QACXC,IAAK,SACLC,KAAM,MACNC,QAAS,SACTC,OAAQ,SACRC,UAAW,QACXC,OAAQ,SACRC,MAAO,SACPC,MAAO,SACPC,WAAY,SACZC,OAAQ,SACRC,YAAa,UAkBf,SAASC,kBACP,OAAO7jB,KAAK8jB,MAAMC,WACpB,CAUA,SAASC,kBACP,OAAOhkB,KAAK8jB,MAAMG,WACpB,CAEe,SAAS,YAAMC,GAC5B,IAAIhgB,EAAG6D,EAEP,OADAmc,GAAUA,EAAS,IAAInV,OAAOoV,eACtBjgB,EAAI8V,EAAMoK,KAAKF,KAAYnc,EAAI7D,EAAE,GAAG9G,OAAQ8G,EAAImgB,SAASngB,EAAE,GAAI,IAAW,IAAN6D,EAAUuc,KAAKpgB,GAC/E,IAAN6D,EAAU,IAAIwc,IAAKrgB,GAAK,EAAI,GAAQA,GAAK,EAAI,IAAQA,GAAK,EAAI,GAAY,IAAJA,GAAiB,GAAJA,IAAY,EAAU,GAAJA,EAAU,GACzG,IAAN6D,EAAUyc,KAAKtgB,GAAK,GAAK,IAAMA,GAAK,GAAK,IAAMA,GAAK,EAAI,KAAW,IAAJA,GAAY,KACrE,IAAN6D,EAAUyc,KAAMtgB,GAAK,GAAK,GAAQA,GAAK,EAAI,IAAQA,GAAK,EAAI,GAAQA,GAAK,EAAI,IAAQA,GAAK,EAAI,GAAY,IAAJA,IAAkB,GAAJA,IAAY,EAAU,GAAJA,GAAY,KAClJ,OACCA,EAAI+V,GAAamK,KAAKF,IAAW,IAAIK,IAAIrgB,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAI,IAC3DA,EAAIiW,GAAaiK,KAAKF,IAAW,IAAIK,IAAW,IAAPrgB,EAAE,GAAW,IAAY,IAAPA,EAAE,GAAW,IAAY,IAAPA,EAAE,GAAW,IAAK,IAC/FA,EAAIkW,GAAcgK,KAAKF,IAAWM,KAAKtgB,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,KAC3DA,EAAImW,GAAc+J,KAAKF,IAAWM,KAAY,IAAPtgB,EAAE,GAAW,IAAY,IAAPA,EAAE,GAAW,IAAY,IAAPA,EAAE,GAAW,IAAKA,EAAE,KAC/FA,EAAIoW,GAAa8J,KAAKF,IAAWO,KAAKvgB,EAAE,GAAIA,EAAE,GAAK,IAAKA,EAAE,GAAK,IAAK,IACpEA,EAAIqW,GAAc6J,KAAKF,IAAWO,KAAKvgB,EAAE,GAAIA,EAAE,GAAK,IAAKA,EAAE,GAAK,IAAKA,EAAE,IACxEsW,GAAM1R,eAAeob,GAAUI,KAAK9J,GAAM0J,IAC/B,gBAAXA,EAA2B,IAAIK,IAAI/X,IAAKA,IAAKA,IAAK,GAClD,IACR,CAEA,SAAS8X,KAAKhkB,GACZ,OAAO,IAAIikB,IAAIjkB,GAAK,GAAK,IAAMA,GAAK,EAAI,IAAU,IAAJA,EAAU,EAC1D,CAEA,SAASkkB,KAAKjkB,EAAGmkB,EAAG3b,EAAGrI,GAErB,OADIA,GAAK,IAAGH,EAAImkB,EAAI3b,EAAIyD,KACjB,IAAI+X,IAAIhkB,EAAGmkB,EAAG3b,EAAGrI,EAC1B,CAEO,SAASikB,WAAWlkB,GAEzB,OADMA,aAAaiZ,QAAQjZ,EAAI,YAAMA,IAChCA,EAEE,IAAI8jB,KADX9jB,EAAIA,EAAEqjB,OACWvjB,EAAGE,EAAEikB,EAAGjkB,EAAEsI,EAAGtI,EAAEmkB,SAFjB,IAAIL,GAGrB,CAEO,SAAS,UAAIhkB,EAAGmkB,EAAG3b,EAAG6b,GAC3B,OAA4B,IAArB9W,UAAU1Q,OAAeunB,WAAWpkB,GAAK,IAAIgkB,IAAIhkB,EAAGmkB,EAAG3b,EAAc,MAAX6b,EAAkB,EAAIA,EACzF,CAEO,SAASL,IAAIhkB,EAAGmkB,EAAG3b,EAAG6b,GAC3B5kB,KAAKO,GAAKA,EACVP,KAAK0kB,GAAKA,EACV1kB,KAAK+I,GAAKA,EACV/I,KAAK4kB,SAAWA,CAClB,CA8BA,SAASC,gBACP,MAAO,IAAIC,IAAI9kB,KAAKO,KAAKukB,IAAI9kB,KAAK0kB,KAAKI,IAAI9kB,KAAK+I,IAClD,CAMA,SAASgc,gBACP,MAAMrkB,EAAIskB,OAAOhlB,KAAK4kB,SACtB,MAAO,GAAS,IAANlkB,EAAU,OAAS,UAAUukB,OAAOjlB,KAAKO,OAAO0kB,OAAOjlB,KAAK0kB,OAAOO,OAAOjlB,KAAK+I,KAAW,IAANrI,EAAU,IAAM,KAAKA,MACrH,CAEA,SAASskB,OAAOJ,GACd,OAAOnhB,MAAMmhB,GAAW,EAAI5P,KAAK4B,IAAI,EAAG5B,KAAKC,IAAI,EAAG2P,GACtD,CAEA,SAASK,OAAOnkB,GACd,OAAOkU,KAAK4B,IAAI,EAAG5B,KAAKC,IAAI,IAAKD,KAAKuE,MAAMzY,IAAU,GACxD,CAEA,SAASgkB,IAAIhkB,GAEX,QADAA,EAAQmkB,OAAOnkB,IACC,GAAK,IAAM,IAAMA,EAAME,SAAS,GAClD,CAEA,SAASyjB,KAAKS,EAAGC,EAAGpd,EAAGrH,GAIrB,OAHIA,GAAK,EAAGwkB,EAAIC,EAAIpd,EAAIyE,IACfzE,GAAK,GAAKA,GAAK,EAAGmd,EAAIC,EAAI3Y,IAC1B2Y,GAAK,IAAGD,EAAI1Y,KACd,IAAI4Y,IAAIF,EAAGC,EAAGpd,EAAGrH,EAC1B,CAEO,SAAS2kB,WAAW5kB,GACzB,GAAIA,aAAa2kB,IAAK,OAAO,IAAIA,IAAI3kB,EAAEykB,EAAGzkB,EAAE0kB,EAAG1kB,EAAEsH,EAAGtH,EAAEmkB,SAEtD,GADMnkB,aAAaiZ,QAAQjZ,EAAI,YAAMA,KAChCA,EAAG,OAAO,IAAI2kB,IACnB,GAAI3kB,aAAa2kB,IAAK,OAAO3kB,EAE7B,IAAIF,GADJE,EAAIA,EAAEqjB,OACIvjB,EAAI,IACVmkB,EAAIjkB,EAAEikB,EAAI,IACV3b,EAAItI,EAAEsI,EAAI,IACVkM,EAAMD,KAAKC,IAAI1U,EAAGmkB,EAAG3b,GACrB6N,EAAM5B,KAAK4B,IAAIrW,EAAGmkB,EAAG3b,GACrBmc,EAAI1Y,IACJ2Y,EAAIvO,EAAM3B,EACVlN,GAAK6O,EAAM3B,GAAO,EAUtB,OATIkQ,GACaD,EAAX3kB,IAAMqW,GAAU8N,EAAI3b,GAAKoc,EAAc,GAATT,EAAI3b,GAC7B2b,IAAM9N,GAAU7N,EAAIxI,GAAK4kB,EAAI,GAC5B5kB,EAAImkB,GAAKS,EAAI,EACvBA,GAAKpd,EAAI,GAAM6O,EAAM3B,EAAM,EAAI2B,EAAM3B,EACrCiQ,GAAK,IAELC,EAAIpd,EAAI,GAAKA,EAAI,EAAI,EAAImd,EAEpB,IAAIE,IAAIF,EAAGC,EAAGpd,EAAGtH,EAAEmkB,QAC5B,CAMA,SAASQ,IAAIF,EAAGC,EAAGpd,EAAG6c,GACpB5kB,KAAKklB,GAAKA,EACVllB,KAAKmlB,GAAKA,EACVnlB,KAAK+H,GAAKA,EACV/H,KAAK4kB,SAAWA,CAClB,CAsCA,SAASU,OAAOxkB,GAEd,OADAA,GAASA,GAAS,GAAK,KACR,EAAIA,EAAQ,IAAMA,CACnC,CAEA,SAASykB,OAAOzkB,GACd,OAAOkU,KAAK4B,IAAI,EAAG5B,KAAKC,IAAI,EAAGnU,GAAS,GAC1C,CAGA,SAAS0kB,QAAQN,EAAGnQ,EAAI0Q,GACtB,OAGY,KAHJP,EAAI,GAAKnQ,GAAM0Q,EAAK1Q,GAAMmQ,EAAI,GAChCA,EAAI,IAAMO,EACVP,EAAI,IAAMnQ,GAAM0Q,EAAK1Q,IAAO,IAAMmQ,GAAK,GACvCnQ,EACR,CC3YO,SAAS2Q,MAAMC,EAAIC,EAAIC,EAAIC,EAAIC,GACpC,IAAIC,EAAKL,EAAKA,EAAIM,EAAKD,EAAKL,EAC5B,QAAS,EAAI,EAAIA,EAAK,EAAIK,EAAKC,GAAML,GAC9B,EAAI,EAAII,EAAK,EAAIC,GAAMJ,GACvB,EAAI,EAAIF,EAAK,EAAIK,EAAK,EAAIC,GAAMH,EACjCG,EAAKF,GAAM,CACnB,CDmKA,WAAOrM,MAAO,YAAO,CACnB,IAAAlB,CAAK0N,GACH,OAAO9jB,OAAO+jB,OAAO,IAAInmB,KAAKqE,YAAarE,KAAMkmB,EACnD,EACA,WAAAE,GACE,OAAOpmB,KAAK8jB,MAAMsC,aACpB,EACAtB,IAAKjB,gBACLE,UAAWF,gBACXwC,WAUF,SAASC,mBACP,OAAOtmB,KAAK8jB,MAAMuC,YACpB,EAXEE,UAaF,SAASC,kBACP,OAAOnB,WAAWrlB,MAAMumB,WAC1B,EAdEtC,UAAWD,gBACXhjB,SAAUgjB,kBAiEZ,WAAOO,IAAK,UAAK9K,OAAOC,MAAO,CAC7B,QAAAE,CAAS1Z,GAEP,OADAA,EAAS,MAALA,EAAY0Z,EAAW5E,KAAKmE,IAAIS,EAAU1Z,GACvC,IAAIqkB,IAAIvkB,KAAKO,EAAIL,EAAGF,KAAK0kB,EAAIxkB,EAAGF,KAAK+I,EAAI7I,EAAGF,KAAK4kB,QAC1D,EACA,MAAAjL,CAAOzZ,GAEL,OADAA,EAAS,MAALA,EAAYyZ,EAAS3E,KAAKmE,IAAIQ,EAAQzZ,GACnC,IAAIqkB,IAAIvkB,KAAKO,EAAIL,EAAGF,KAAK0kB,EAAIxkB,EAAGF,KAAK+I,EAAI7I,EAAGF,KAAK4kB,QAC1D,EACA,GAAAd,GACE,OAAO9jB,IACT,EACA,KAAAymB,GACE,OAAO,IAAIlC,IAAIU,OAAOjlB,KAAKO,GAAI0kB,OAAOjlB,KAAK0kB,GAAIO,OAAOjlB,KAAK+I,GAAIic,OAAOhlB,KAAK4kB,SAC7E,EACA,WAAAwB,GACE,OAAS,IAAOpmB,KAAKO,GAAKP,KAAKO,EAAI,QAC1B,IAAOP,KAAK0kB,GAAK1kB,KAAK0kB,EAAI,QAC1B,IAAO1kB,KAAK+I,GAAK/I,KAAK+I,EAAI,OAC3B,GAAK/I,KAAK4kB,SAAW5kB,KAAK4kB,SAAW,CAC/C,EACAE,IAAKD,cACLd,UAAWc,cACXwB,WASF,SAASK,iBACP,MAAO,IAAI5B,IAAI9kB,KAAKO,KAAKukB,IAAI9kB,KAAK0kB,KAAKI,IAAI9kB,KAAK+I,KAAK+b,IAA+C,KAA1CrhB,MAAMzD,KAAK4kB,SAAW,EAAI5kB,KAAK4kB,WAC3F,EAVEX,UAAWc,cACX/jB,SAAU+jB,iBAyEZ,WAAOK,IAXA,SAASuB,IAAIzB,EAAGC,EAAGpd,EAAG6c,GAC3B,OAA4B,IAArB9W,UAAU1Q,OAAeioB,WAAWH,GAAK,IAAIE,IAAIF,EAAGC,EAAGpd,EAAc,MAAX6c,EAAkB,EAAIA,EACzF,EASiBnL,OAAOC,MAAO,CAC7B,QAAAE,CAAS1Z,GAEP,OADAA,EAAS,MAALA,EAAY0Z,EAAW5E,KAAKmE,IAAIS,EAAU1Z,GACvC,IAAIklB,IAAIplB,KAAKklB,EAAGllB,KAAKmlB,EAAGnlB,KAAK+H,EAAI7H,EAAGF,KAAK4kB,QAClD,EACA,MAAAjL,CAAOzZ,GAEL,OADAA,EAAS,MAALA,EAAYyZ,EAAS3E,KAAKmE,IAAIQ,EAAQzZ,GACnC,IAAIklB,IAAIplB,KAAKklB,EAAGllB,KAAKmlB,EAAGnlB,KAAK+H,EAAI7H,EAAGF,KAAK4kB,QAClD,EACA,GAAAd,GACE,IAAIoB,EAAIllB,KAAKklB,EAAI,IAAqB,KAAdllB,KAAKklB,EAAI,GAC7BC,EAAI1hB,MAAMyhB,IAAMzhB,MAAMzD,KAAKmlB,GAAK,EAAInlB,KAAKmlB,EACzCpd,EAAI/H,KAAK+H,EACT0d,EAAK1d,GAAKA,EAAI,GAAMA,EAAI,EAAIA,GAAKod,EACjCpQ,EAAK,EAAIhN,EAAI0d,EACjB,OAAO,IAAIlB,IACTiB,QAAQN,GAAK,IAAMA,EAAI,IAAMA,EAAI,IAAKnQ,EAAI0Q,GAC1CD,QAAQN,EAAGnQ,EAAI0Q,GACfD,QAAQN,EAAI,IAAMA,EAAI,IAAMA,EAAI,IAAKnQ,EAAI0Q,GACzCzlB,KAAK4kB,QAET,EACA,KAAA6B,GACE,OAAO,IAAIrB,IAAIE,OAAOtlB,KAAKklB,GAAIK,OAAOvlB,KAAKmlB,GAAII,OAAOvlB,KAAK+H,GAAIid,OAAOhlB,KAAK4kB,SAC7E,EACA,WAAAwB,GACE,OAAQ,GAAKpmB,KAAKmlB,GAAKnlB,KAAKmlB,GAAK,GAAK1hB,MAAMzD,KAAKmlB,KACzC,GAAKnlB,KAAK+H,GAAK/H,KAAK+H,GAAK,GACzB,GAAK/H,KAAK4kB,SAAW5kB,KAAK4kB,SAAW,CAC/C,EACA,SAAA2B,GACE,MAAM7lB,EAAIskB,OAAOhlB,KAAK4kB,SACtB,MAAO,GAAS,IAANlkB,EAAU,OAAS,UAAU4kB,OAAOtlB,KAAKklB,OAAwB,IAAjBK,OAAOvlB,KAAKmlB,QAA+B,IAAjBI,OAAOvlB,KAAK+H,MAAkB,IAANrH,EAAU,IAAM,KAAKA,MACnI,KEzXF,kCAAe2J,GAAK,IAAMA,ECE1B,SAASuc,OAAOlmB,EAAGX,GACjB,OAAO,SAASS,GACd,OAAOE,EAAIF,EAAIT,CACjB,CACF,CAaO,SAAS8mB,MAAMjf,GACpB,OAAoB,KAAZA,GAAKA,GAAWkf,QAAU,SAASpmB,EAAGqI,GAC5C,OAAOA,EAAIrI,EAbf,SAASqmB,YAAYrmB,EAAGqI,EAAGnB,GACzB,OAAOlH,EAAIsU,KAAKmE,IAAIzY,EAAGkH,GAAImB,EAAIiM,KAAKmE,IAAIpQ,EAAGnB,GAAKlH,EAAGkH,EAAI,EAAIA,EAAG,SAASpH,GACrE,OAAOwU,KAAKmE,IAAIzY,EAAIF,EAAIuI,EAAGnB,EAC7B,CACF,CASmBmf,CAAYrmB,EAAGqI,EAAGnB,GAAK,4BAASnE,MAAM/C,GAAKqI,EAAIrI,EAChE,CACF,CAEe,SAASomB,QAAQpmB,EAAGqI,GACjC,IAAIhJ,EAAIgJ,EAAIrI,EACZ,OAAOX,EAAI6mB,OAAOlmB,EAAGX,GAAK,4BAAS0D,MAAM/C,GAAKqI,EAAIrI,EACpD,CCvBA,SAAe,SAAUsmB,SAASpf,GAChC,IAAIqf,EAAQJ,MAAMjf,GAElB,SAASkc,IAAIhL,EAAOoO,GAClB,IAAI3mB,EAAI0mB,GAAOnO,EAAQ,UAASA,IAAQvY,GAAI2mB,EAAM,UAASA,IAAM3mB,GAC7DmkB,EAAIuC,EAAMnO,EAAM4L,EAAGwC,EAAIxC,GACvB3b,EAAIke,EAAMnO,EAAM/P,EAAGme,EAAIne,GACvB6b,EAAUkC,QAAQhO,EAAM8L,QAASsC,EAAItC,SACzC,OAAO,SAASpkB,GAKd,OAJAsY,EAAMvY,EAAIA,EAAEC,GACZsY,EAAM4L,EAAIA,EAAElkB,GACZsY,EAAM/P,EAAIA,EAAEvI,GACZsY,EAAM8L,QAAUA,EAAQpkB,GACjBsY,EAAQ,EACjB,CACF,CAIA,OAFAgL,IAAI+C,MAAQG,SAELlD,GACR,CApBD,CAoBG,GAEH,SAASqD,UAAUC,GACjB,OAAO,SAASC,GACd,IAIIlqB,EAAG8pB,EAJH3mB,EAAI+mB,EAAOjqB,OACXmD,EAAI,IAAI+I,MAAMhJ,GACdokB,EAAI,IAAIpb,MAAMhJ,GACdyI,EAAI,IAAIO,MAAMhJ,GAElB,IAAKnD,EAAI,EAAGA,EAAImD,IAAKnD,EACnB8pB,EAAQ,UAASI,EAAOlqB,IACxBoD,EAAEpD,GAAK8pB,EAAM1mB,GAAK,EAClBmkB,EAAEvnB,GAAK8pB,EAAMvC,GAAK,EAClB3b,EAAE5L,GAAK8pB,EAAMle,GAAK,EAMpB,OAJAxI,EAAI6mB,EAAO7mB,GACXmkB,EAAI0C,EAAO1C,GACX3b,EAAIqe,EAAOre,GACXke,EAAMrC,QAAU,EACT,SAASpkB,GAId,OAHAymB,EAAM1mB,EAAIA,EAAEC,GACZymB,EAAMvC,EAAIA,EAAElkB,GACZymB,EAAMle,EAAIA,EAAEvI,GACLymB,EAAQ,EACjB,CACF,CACF,CAEO,IAAIK,GAAWH,UH7CP,mBAASthB,GACtB,IAAIvF,EAAIuF,EAAOzI,OAAS,EACxB,OAAO,SAASoD,GACd,IAAIrD,EAAIqD,GAAK,EAAKA,EAAI,EAAKA,GAAK,GAAKA,EAAI,EAAGF,EAAI,GAAK0U,KAAK8B,MAAMtW,EAAIF,GAChEulB,EAAKhgB,EAAO1I,GACZ2oB,EAAKjgB,EAAO1I,EAAI,GAChByoB,EAAKzoB,EAAI,EAAI0I,EAAO1I,EAAI,GAAK,EAAI0oB,EAAKC,EACtCC,EAAK5oB,EAAImD,EAAI,EAAIuF,EAAO1I,EAAI,GAAK,EAAI2oB,EAAKD,EAC9C,OAAOH,OAAOllB,EAAIrD,EAAImD,GAAKA,EAAGslB,EAAIC,EAAIC,EAAIC,EAC5C,CACF,GGoC4BoB,UCpDb,qBAASthB,GACtB,IAAIvF,EAAIuF,EAAOzI,OACf,OAAO,SAASoD,GACd,IAAIrD,EAAI6X,KAAK8B,QAAQtW,GAAK,GAAK,IAAMA,EAAIA,GAAKF,GAC1CslB,EAAK/f,GAAQ1I,EAAImD,EAAI,GAAKA,GAC1BulB,EAAKhgB,EAAO1I,EAAImD,GAChBwlB,EAAKjgB,GAAQ1I,EAAI,GAAKmD,GACtBylB,EAAKlgB,GAAQ1I,EAAI,GAAKmD,GAC1B,OAAOolB,OAAOllB,EAAIrD,EAAImD,GAAKA,EAAGslB,EAAIC,EAAIC,EAAIC,EAC5C,CACF,GCLO,SAASwB,aAAa7mB,EAAGqI,GAC9B,IAII5L,EAJAqqB,EAAKze,EAAIA,EAAE3L,OAAS,EACpBqqB,EAAK/mB,EAAIsU,KAAKC,IAAIuS,EAAI9mB,EAAEtD,QAAU,EAClCiN,EAAI,IAAIf,MAAMme,GACdzgB,EAAI,IAAIsC,MAAMke,GAGlB,IAAKrqB,EAAI,EAAGA,EAAIsqB,IAAMtqB,EAAGkN,EAAElN,GAAK2D,MAAMJ,EAAEvD,GAAI4L,EAAE5L,IAC9C,KAAOA,EAAIqqB,IAAMrqB,EAAG6J,EAAE7J,GAAK4L,EAAE5L,GAE7B,OAAO,SAASqD,GACd,IAAKrD,EAAI,EAAGA,EAAIsqB,IAAMtqB,EAAG6J,EAAE7J,GAAKkN,EAAElN,GAAGqD,GACrC,OAAOwG,CACT,CACF,CCrBe,cAAStG,EAAGqI,GACzB,IAAIhJ,EAAI,IAAI2nB,KACZ,OAAOhnB,GAAKA,EAAGqI,GAAKA,EAAG,SAASvI,GAC9B,OAAOT,EAAE4nB,QAAQjnB,GAAK,EAAIF,GAAKuI,EAAIvI,GAAIT,CACzC,CACF,CCLe,oBAASW,EAAGqI,GACzB,OAAOrI,GAAKA,EAAGqI,GAAKA,EAAG,SAASvI,GAC9B,OAAOE,GAAK,EAAIF,GAAKuI,EAAIvI,CAC3B,CACF,CCFe,gBAASE,EAAGqI,GACzB,IAEI7I,EAFA/C,EAAI,CAAC,EACL6J,EAAI,CAAC,EAMT,IAAK9G,KAHK,OAANQ,GAA2B,iBAANA,IAAgBA,EAAI,CAAC,GACpC,OAANqI,GAA2B,iBAANA,IAAgBA,EAAI,CAAC,GAEpCA,EACJ7I,KAAKQ,EACPvD,EAAE+C,GAAKY,MAAMJ,EAAER,GAAI6I,EAAE7I,IAErB8G,EAAE9G,GAAK6I,EAAE7I,GAIb,OAAO,SAASM,GACd,IAAKN,KAAK/C,EAAG6J,EAAE9G,GAAK/C,EAAE+C,GAAGM,GACzB,OAAOwG,CACT,CACF,CCpBA,IAAI4gB,GAAM,8CACNC,GAAM,IAAI3N,OAAO0N,GAAIE,OAAQ,KAclB,gBAASpnB,EAAGqI,GACzB,IACIgf,EACAC,EACAC,EAHAC,EAAKN,GAAIO,UAAYN,GAAIM,UAAY,EAIrChrB,GAAK,EACLgoB,EAAI,GACJiD,EAAI,GAMR,IAHA1nB,GAAQ,GAAIqI,GAAQ,IAGZgf,EAAKH,GAAIxD,KAAK1jB,MACdsnB,EAAKH,GAAIzD,KAAKrb,MACfkf,EAAKD,EAAG/oB,OAASipB,IACpBD,EAAKlf,EAAES,MAAM0e,EAAID,GACb9C,EAAEhoB,GAAIgoB,EAAEhoB,IAAM8qB,EACb9C,IAAIhoB,GAAK8qB,IAEXF,EAAKA,EAAG,OAASC,EAAKA,EAAG,IACxB7C,EAAEhoB,GAAIgoB,EAAEhoB,IAAM6qB,EACb7C,IAAIhoB,GAAK6qB,GAEd7C,IAAIhoB,GAAK,KACTirB,EAAE3rB,KAAK,CAACU,EAAGA,EAAGkN,EAAG,WAAO0d,EAAIC,MAE9BE,EAAKL,GAAIM,UAYX,OARID,EAAKnf,EAAE3L,SACT6qB,EAAKlf,EAAES,MAAM0e,GACT/C,EAAEhoB,GAAIgoB,EAAEhoB,IAAM8qB,EACb9C,IAAIhoB,GAAK8qB,GAKT9C,EAAE/nB,OAAS,EAAKgrB,EAAE,GA7C3B,SAASC,IAAItf,GACX,OAAO,SAASvI,GACd,OAAOuI,EAAEvI,GAAK,EAChB,CACF,CA0CQ6nB,CAAID,EAAE,GAAG/d,GApDjB,SAAS,YAAKtB,GACZ,OAAO,WACL,OAAOA,CACT,CACF,CAiDQ,CAAKA,IACJA,EAAIqf,EAAEhrB,OAAQ,SAASoD,GACtB,IAAK,IAAWC,EAAPtD,EAAI,EAAMA,EAAI4L,IAAK5L,EAAGgoB,GAAG1kB,EAAI2nB,EAAEjrB,IAAIA,GAAKsD,EAAE4J,EAAE7J,GACrD,OAAO2kB,EAAE/jB,KAAK,GAChB,EACR,CC/De,yBAASV,EAAGqI,GACpBA,IAAGA,EAAI,IACZ,IAEI5L,EAFAmD,EAAII,EAAIsU,KAAKC,IAAIlM,EAAE3L,OAAQsD,EAAEtD,QAAU,EACvC4J,EAAI+B,EAAES,QAEV,OAAO,SAAShJ,GACd,IAAKrD,EAAI,EAAGA,EAAImD,IAAKnD,EAAG6J,EAAE7J,GAAKuD,EAAEvD,IAAM,EAAIqD,GAAKuI,EAAE5L,GAAKqD,EACvD,OAAOwG,CACT,CACF,CCCe,eAAStG,EAAGqI,GACzB,IAAkB/B,EAAdxG,SAAWuI,EACf,OAAY,MAALA,GAAmB,YAANvI,EAAkB,4BAASuI,IAClC,WAANvI,EAAiB,WACZ,WAANA,GAAmBwG,EAAI,YAAM+B,KAAOA,EAAI/B,EAAG8c,IAAOhV,OAClD/F,aAAa,YAAQ+a,GACrB/a,aAAa2e,KAAOY,KDLrB,SAAS,0BAAcje,GAC5B,OAAOke,YAAYC,OAAOne,MAAQA,aAAaoe,SACjD,CCIQ,CAAc1f,GAAK,gBACnBO,MAAMM,QAAQb,GAAKwe,aACE,mBAAdxe,EAAE2f,SAAgD,mBAAf3f,EAAE/H,UAA2ByC,MAAMsF,GAAK4f,OAClF,YAAQjoB,EAAGqI,EACnB,CCrBe,eAASrI,EAAGqI,GACzB,OAAOrI,GAAKA,EAAGqI,GAAKA,EAAG,SAASvI,GAC9B,OAAOwU,KAAKuE,MAAM7Y,GAAK,EAAIF,GAAKuI,EAAIvI,EACtC,CACF,CCJe,SAAS,kBAAO6J,GAC7B,OAAQA,CACV,CCGA,IAAIue,GAAO,CAAC,EAAG,GAER,SAAS,oBAASve,GACvB,OAAOA,CACT,CAEA,SAASwe,UAAUnoB,EAAGqI,GACpB,OAAQA,GAAMrI,GAAKA,GACb,SAAS2J,GAAK,OAAQA,EAAI3J,GAAKqI,CAAG,ECb3B,SAAS+f,UAAUze,GAChC,OAAO,WACL,OAAOA,CACT,CACF,CDUQ,CAAS5G,MAAMsF,GAAKyD,IAAM,GAClC,CAUA,SAASuc,MAAMjR,EAAQC,EAAOiR,GAC5B,IAAIC,EAAKnR,EAAO,GAAIoR,EAAKpR,EAAO,GAAIqR,EAAKpR,EAAM,GAAIqR,EAAKrR,EAAM,GAG9D,OAFImR,EAAKD,GAAIA,EAAKJ,UAAUK,EAAID,GAAKE,EAAKH,EAAYI,EAAID,KACrDF,EAAKJ,UAAUI,EAAIC,GAAKC,EAAKH,EAAYG,EAAIC,IAC3C,SAAS/e,GAAK,OAAO8e,EAAGF,EAAG5e,GAAK,CACzC,CAEA,SAASgf,QAAQvR,EAAQC,EAAOiR,GAC9B,IAAIxX,EAAIwD,KAAKC,IAAI6C,EAAO1a,OAAQ2a,EAAM3a,QAAU,EAC5C2C,EAAI,IAAIuJ,MAAMkI,GACdjR,EAAI,IAAI+I,MAAMkI,GACdrU,GAAK,EAQT,IALI2a,EAAOtG,GAAKsG,EAAO,KACrBA,EAASA,EAAOtO,QAAQnE,UACxB0S,EAAQA,EAAMvO,QAAQnE,aAGflI,EAAIqU,GACXzR,EAAE5C,GAAK0rB,UAAU/Q,EAAO3a,GAAI2a,EAAO3a,EAAI,IACvCoD,EAAEpD,GAAK6rB,EAAYjR,EAAM5a,GAAI4a,EAAM5a,EAAI,IAGzC,OAAO,SAASkN,GACd,IAAIlN,EAAIib,EAAON,EAAQzN,EAAG,EAAGmH,GAAK,EAClC,OAAOjR,EAAEpD,GAAG4C,EAAE5C,GAAGkN,GACnB,CACF,CAEO,SAASmO,KAAKsP,EAAQ7hB,GAC3B,OAAOA,EACF6R,OAAOgQ,EAAOhQ,UACdC,MAAM+P,EAAO/P,SACbiR,YAAYlB,EAAOkB,eACnBvC,MAAMqB,EAAOrB,SACbzO,QAAQ8P,EAAO9P,UACtB,CAEO,SAASsR,cACd,IAGIC,EACAC,EACAxR,EAEAyR,EACAC,EACAC,EATA7R,EAAS8Q,GACT7Q,EAAQ6Q,GACRI,EAAc,MAIdvC,EAAQ,oBAKZ,SAASvO,UACP,IAAI5X,EAAI0U,KAAKC,IAAI6C,EAAO1a,OAAQ2a,EAAM3a,QAItC,OAHIqpB,IAAU,sBAAUA,EA7D5B,SAASmD,QAAQlpB,EAAGqI,GAClB,IAAIvI,EAEJ,OADIE,EAAIqI,IAAGvI,EAAIE,EAAGA,EAAIqI,EAAGA,EAAIvI,GACtB,SAAS6J,GAAK,OAAO2K,KAAK4B,IAAIlW,EAAGsU,KAAKC,IAAIlM,EAAGsB,GAAK,CAC3D,CAyDoCuf,CAAQ9R,EAAO,GAAIA,EAAOxX,EAAI,KAC9DmpB,EAAYnpB,EAAI,EAAI+oB,QAAUN,MAC9BW,EAASC,EAAQ,KACVxR,KACT,CAEA,SAASA,MAAM9N,GACb,OAAY,MAALA,GAAa5G,MAAM4G,GAAKA,GAAK2N,GAAW0R,IAAWA,EAASD,EAAU3R,EAAO7W,IAAIsoB,GAAYxR,EAAOiR,KAAeO,EAAU9C,EAAMpc,IAC5I,CA8BA,OA5BA8N,MAAM0R,OAAS,SAASjiB,GACtB,OAAO6e,EAAM+C,GAAaG,IAAUA,EAAQF,EAAU1R,EAAOD,EAAO7W,IAAIsoB,GAAY,cAAqB3hB,IAC3G,EAEAuQ,MAAML,OAAS,SAASQ,GACtB,OAAOxK,UAAU1Q,QAAU0a,EAASxO,MAAMG,KAAK6O,EAAG,mBAASJ,WAAaJ,EAAOtO,OACjF,EAEA2O,MAAMJ,MAAQ,SAASO,GACrB,OAAOxK,UAAU1Q,QAAU2a,EAAQzO,MAAMG,KAAK6O,GAAIJ,WAAaH,EAAMvO,OACvE,EAEA2O,MAAM2R,WAAa,SAASxR,GAC1B,OAAOP,EAAQzO,MAAMG,KAAK6O,GAAI0Q,EAAc,MAAkB9Q,SAChE,EAEAC,MAAMsO,MAAQ,SAASnO,GACrB,OAAOxK,UAAU1Q,QAAUqpB,IAAQnO,GAAW,oBAAUJ,WAAauO,IAAU,mBACjF,EAEAtO,MAAM6Q,YAAc,SAAS1Q,GAC3B,OAAOxK,UAAU1Q,QAAU4rB,EAAc1Q,EAAGJ,WAAa8Q,CAC3D,EAEA7Q,MAAMH,QAAU,SAASM,GACvB,OAAOxK,UAAU1Q,QAAU4a,EAAUM,EAAGH,OAASH,CACnD,EAEO,SAASxX,EAAGmF,GAEjB,OADA4jB,EAAY/oB,EAAGgpB,EAAc7jB,EACtBuS,SACT,CACF,CAEe,SAAS6R,aACtB,OAAOT,cAAc,oBAAU,oBACjC,CE3HA,ICCWU,GDDPC,GAAK,2EAEM,SAASC,gBAAgBC,GACtC,KAAM3W,EAAQyW,GAAG7F,KAAK+F,IAAa,MAAM,IAAI1jB,MAAM,mBAAqB0jB,GACxE,IAAI3W,EACJ,OAAO,IAAI4W,gBAAgB,CACzBC,KAAM7W,EAAM,GACZ8W,MAAO9W,EAAM,GACb+W,KAAM/W,EAAM,GACZgX,OAAQhX,EAAM,GACdgE,KAAMhE,EAAM,GACZiX,MAAOjX,EAAM,GACbkX,MAAOlX,EAAM,GACbmX,UAAWnX,EAAM,IAAMA,EAAM,GAAGhK,MAAM,GACtCuF,KAAMyE,EAAM,GACZ/B,KAAM+B,EAAM,KAEhB,CAIO,SAAS4W,gBAAgBD,GAC9BnqB,KAAKqqB,UAA0B9oB,IAAnB4oB,EAAUE,KAAqB,IAAMF,EAAUE,KAAO,GAClErqB,KAAKsqB,WAA4B/oB,IAApB4oB,EAAUG,MAAsB,IAAMH,EAAUG,MAAQ,GACrEtqB,KAAKuqB,UAA0BhpB,IAAnB4oB,EAAUI,KAAqB,IAAMJ,EAAUI,KAAO,GAClEvqB,KAAKwqB,YAA8BjpB,IAArB4oB,EAAUK,OAAuB,GAAKL,EAAUK,OAAS,GACvExqB,KAAKwX,OAAS2S,EAAU3S,KACxBxX,KAAKyqB,WAA4BlpB,IAApB4oB,EAAUM,WAAsBlpB,GAAa4oB,EAAUM,MACpEzqB,KAAK0qB,QAAUP,EAAUO,MACzB1qB,KAAK2qB,eAAoCppB,IAAxB4oB,EAAUQ,eAA0BppB,GAAa4oB,EAAUQ,UAC5E3qB,KAAK+O,OAASob,EAAUpb,KACxB/O,KAAKyR,UAA0BlQ,IAAnB4oB,EAAU1Y,KAAqB,GAAK0Y,EAAU1Y,KAAO,EACnE,CExBO,SAASmZ,mBAAmBvgB,EAAGrF,GACpC,IAAK7H,GAAKkN,EAAIrF,EAAIqF,EAAEwgB,cAAc7lB,EAAI,GAAKqF,EAAEwgB,iBAAiB5d,QAAQ,MAAQ,EAAG,OAAO,KACxF,IAAI9P,EAAG2tB,EAAczgB,EAAEb,MAAM,EAAGrM,GAIhC,MAAO,CACL2tB,EAAY1tB,OAAS,EAAI0tB,EAAY,GAAKA,EAAYthB,MAAM,GAAKshB,GAChEzgB,EAAEb,MAAMrM,EAAI,GAEjB,CCjBe,kBAASkN,GACtB,OAAOA,EAAIugB,mBAAmB5V,KAAK+V,IAAI1gB,KAASA,EAAE,GAAKmC,GACzD,CCFe,uBAASnC,EAAGrF,GACzB,IAAIjF,EAAI6qB,mBAAmBvgB,EAAGrF,GAC9B,IAAKjF,EAAG,OAAOsK,EAAI,GACnB,IAAIygB,EAAc/qB,EAAE,GAChBirB,EAAWjrB,EAAE,GACjB,OAAOirB,EAAW,EAAI,KAAO,IAAI1hB,OAAO0hB,GAAU5pB,KAAK,KAAO0pB,EACxDA,EAAY1tB,OAAS4tB,EAAW,EAAIF,EAAYthB,MAAM,EAAGwhB,EAAW,GAAK,IAAMF,EAAYthB,MAAMwhB,EAAW,GAC5GF,EAAc,IAAIxhB,MAAM0hB,EAAWF,EAAY1tB,OAAS,GAAGgE,KAAK,IACxE,CJUA8oB,gBAAgBxjB,UAAY0jB,gBAAgB1jB,UAe5C0jB,gBAAgB1jB,UAAU1F,SAAW,WACnC,OAAOhB,KAAKqqB,KACNrqB,KAAKsqB,MACLtqB,KAAKuqB,KACLvqB,KAAKwqB,QACJxqB,KAAKwX,KAAO,IAAM,UACHjW,IAAfvB,KAAKyqB,MAAsB,GAAKzV,KAAK4B,IAAI,EAAgB,EAAb5W,KAAKyqB,SACjDzqB,KAAK0qB,MAAQ,IAAM,UACAnpB,IAAnBvB,KAAK2qB,UAA0B,GAAK,IAAM3V,KAAK4B,IAAI,EAAoB,EAAjB5W,KAAK2qB,aAC3D3qB,KAAK+O,KAAO,IAAM,IACnB/O,KAAKyR,IACb,EK1CA,UACE,IAAK,CAACpH,EAAGrF,KAAW,IAAJqF,GAAS4gB,QAAQjmB,GACjC,EAAMqF,GAAM2K,KAAKuE,MAAMlP,GAAGrJ,SAAS,GACnC,EAAMqJ,GAAMA,EAAI,GAChB,EHRa,uBAASA,GACtB,OAAO2K,KAAK+V,IAAI1gB,EAAI2K,KAAKuE,MAAMlP,KAAO,KAChCA,EAAE6gB,eAAe,MAAMC,QAAQ,KAAM,IACrC9gB,EAAErJ,SAAS,GACnB,EGKE,EAAK,CAACqJ,EAAGrF,IAAMqF,EAAEwgB,cAAc7lB,GAC/B,EAAK,CAACqF,EAAGrF,IAAMqF,EAAE4gB,QAAQjmB,GACzB,EAAK,CAACqF,EAAGrF,IAAMqF,EAAE+gB,YAAYpmB,GAC7B,EAAMqF,GAAM2K,KAAKuE,MAAMlP,GAAGrJ,SAAS,GACnC,EAAK,CAACqJ,EAAGrF,IAAMqmB,cAAkB,IAAJhhB,EAASrF,GACtC,EAAKqmB,cACL,EJXa,0BAAShhB,EAAGrF,GACzB,IAAIjF,EAAI6qB,mBAAmBvgB,EAAGrF,GAC9B,IAAKjF,EAAG,OAAOsK,EAAI,GACnB,IAAIygB,EAAc/qB,EAAE,GAChBirB,EAAWjrB,EAAE,GACb5C,EAAI6tB,GAAYhB,GAAuE,EAAtDhV,KAAK4B,KAAK,EAAG5B,KAAKC,IAAI,EAAGD,KAAK8B,MAAMkU,EAAW,MAAY,EAC5F1qB,EAAIwqB,EAAY1tB,OACpB,OAAOD,IAAMmD,EAAIwqB,EACX3tB,EAAImD,EAAIwqB,EAAc,IAAIxhB,MAAMnM,EAAImD,EAAI,GAAGc,KAAK,KAChDjE,EAAI,EAAI2tB,EAAYthB,MAAM,EAAGrM,GAAK,IAAM2tB,EAAYthB,MAAMrM,GAC1D,KAAO,IAAImM,MAAM,EAAInM,GAAGiE,KAAK,KAAOwpB,mBAAmBvgB,EAAG2K,KAAK4B,IAAI,EAAG5R,EAAI7H,EAAI,IAAI,EAC1F,EICE,EAAMkN,GAAM2K,KAAKuE,MAAMlP,GAAGrJ,SAAS,IAAIsqB,cACvC,EAAMjhB,GAAM2K,KAAKuE,MAAMlP,GAAGrJ,SAAS,KCjBtB,sBAASqJ,GACtB,OAAOA,CACT,CCOA,ICPI,GACO6Z,GACAqH,GDKPtqB,GAAMqI,MAAM5C,UAAUzF,IACtBuqB,GAAW,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAEhE,gBAASC,GACtB,IAAIhgB,OAA4BlK,IAApBkqB,EAAOC,eAA+CnqB,IAArBkqB,EAAOE,UAA0B,aEbjE,qBAASD,EAAUC,GAChC,OAAO,SAAS7qB,EAAO2pB,GAOrB,IANA,IAAIttB,EAAI2D,EAAM1D,OACVoD,EAAI,GACJgR,EAAI,EACJkT,EAAIgH,EAAS,GACbtuB,EAAS,EAEND,EAAI,GAAKunB,EAAI,IACdtnB,EAASsnB,EAAI,EAAI+F,IAAO/F,EAAI1P,KAAK4B,IAAI,EAAG6T,EAAQrtB,IACpDoD,EAAE/D,KAAKqE,EAAM8qB,UAAUzuB,GAAKunB,EAAGvnB,EAAIunB,OAC9BtnB,GAAUsnB,EAAI,GAAK+F,KACxB/F,EAAIgH,EAASla,GAAKA,EAAI,GAAKka,EAAStuB,QAGtC,OAAOoD,EAAE6E,UAAUjE,KAAKuqB,EAC1B,CACF,CFJ2FE,CAAY5qB,GAAIuC,KAAKioB,EAAOC,SAAUI,QAASL,EAAOE,UAAY,IACvJI,OAAqCxqB,IAApBkqB,EAAOO,SAAyB,GAAKP,EAAOO,SAAS,GAAK,GAC3EC,OAAqC1qB,IAApBkqB,EAAOO,SAAyB,GAAKP,EAAOO,SAAS,GAAK,GAC3EE,OAA6B3qB,IAAnBkqB,EAAOS,QAAwB,IAAMT,EAAOS,QAAU,GAChEC,OAA+B5qB,IAApBkqB,EAAOU,SAAyB,aGjBlC,wBAASA,GACtB,OAAO,SAASrrB,GACd,OAAOA,EAAMqqB,QAAQ,SAAU,SAAShuB,GACtC,OAAOgvB,GAAUhvB,EACnB,EACF,CACF,CHW4DivB,CAAenrB,GAAIuC,KAAKioB,EAAOU,SAAUE,SAC/FC,OAA6B/qB,IAAnBkqB,EAAOa,QAAwB,IAAMb,EAAOa,QAAU,GAChEC,OAAyBhrB,IAAjBkqB,EAAOc,MAAsB,IAAMd,EAAOc,MAAQ,GAC1DC,OAAqBjrB,IAAfkqB,EAAOe,IAAoB,MAAQf,EAAOe,IAAM,GAE1D,SAASC,UAAUtC,GAGjB,IAAIE,GAFJF,EAAYD,gBAAgBC,IAEPE,KACjBC,EAAQH,EAAUG,MAClBC,EAAOJ,EAAUI,KACjBC,EAASL,EAAUK,OACnBhT,EAAO2S,EAAU3S,KACjBiT,EAAQN,EAAUM,MAClBC,EAAQP,EAAUO,MAClBC,EAAYR,EAAUQ,UACtB5b,EAAOob,EAAUpb,KACjB0C,EAAO0Y,EAAU1Y,KAGR,MAATA,GAAciZ,GAAQ,EAAMjZ,EAAO,KAG7Bib,GAAYjb,UAAqBlQ,IAAdopB,IAA4BA,EAAY,IAAK5b,GAAO,EAAM0C,EAAO,MAG1F+F,GAAkB,MAAT6S,GAA0B,MAAVC,KAAgB9S,GAAO,EAAM6S,EAAO,IAAKC,EAAQ,KAI9E,IAAItd,EAAoB,MAAXwd,EAAiBuB,EAA4B,MAAXvB,GAAkB,SAAS9gB,KAAK+H,GAAQ,IAAMA,EAAK0S,cAAgB,GAC9GwI,EAAoB,MAAXnC,EAAiByB,EAAiB,OAAOviB,KAAK+H,GAAQ6a,EAAU,GAKzEM,EAAaF,GAAYjb,GACzBob,EAAc,aAAanjB,KAAK+H,GAUpC,SAASyS,OAAOpjB,GACd,IAEI3D,EAAGmD,EAAG0G,EAFN8lB,EAAc9f,EACd+f,EAAcJ,EAGlB,GAAa,MAATlb,EACFsb,EAAcH,EAAW9rB,GAASisB,EAClCjsB,EAAQ,OACH,CAIL,IAAIksB,GAHJlsB,GAASA,GAGmB,GAAK,EAAIA,EAAQ,EAiB7C,GAdAA,EAAQ2C,MAAM3C,GAAS0rB,EAAMI,EAAW5X,KAAK+V,IAAIjqB,GAAQ6pB,GAGrD5b,IAAMjO,EIjFH,oBAASqkB,GACtB8H,EAAK,IAAK,IAAkChZ,EAA9B3T,EAAI6kB,EAAE/nB,OAAQD,EAAI,EAAG6W,GAAM,EAAO7W,EAAImD,IAAKnD,EACvD,OAAQgoB,EAAEhoB,IACR,IAAK,IAAK6W,EAAKC,EAAK9W,EAAG,MACvB,IAAK,IAAgB,IAAP6W,IAAUA,EAAK7W,GAAG8W,EAAK9W,EAAG,MACxC,QAAS,KAAMgoB,EAAEhoB,GAAI,MAAM8vB,EAASjZ,EAAK,IAAGA,EAAK,GAGrD,OAAOA,EAAK,EAAImR,EAAE3b,MAAM,EAAGwK,GAAMmR,EAAE3b,MAAMyK,EAAK,GAAKkR,CACrD,CJwE0B+H,CAAWpsB,IAGzBksB,GAA4B,KAAVlsB,GAAwB,MAATypB,IAAcyC,GAAgB,GAGnEF,GAAeE,EAA0B,MAATzC,EAAeA,EAAOgC,EAAkB,MAAThC,GAAyB,MAATA,EAAe,GAAKA,GAAQuC,EAC3GC,GAAwB,MAATtb,EAAe+Z,GAAS,EAAIxB,GAAiB,GAAK,IAAM+C,GAAeC,GAA0B,MAATzC,EAAe,IAAM,IAIxHsC,EAEF,IADA1vB,GAAK,EAAGmD,EAAIQ,EAAM1D,SACTD,EAAImD,GACX,GAA6B,IAAzB0G,EAAIlG,EAAMqsB,WAAWhwB,KAAc6J,EAAI,GAAI,CAC7C+lB,GAAqB,KAAN/lB,EAAWklB,EAAUprB,EAAM0I,MAAMrM,EAAI,GAAK2D,EAAM0I,MAAMrM,IAAM4vB,EAC3EjsB,EAAQA,EAAM0I,MAAM,EAAGrM,GACvB,KACF,CAGN,CAGIutB,IAAUlT,IAAM1W,EAAQ2K,EAAM3K,EAAOssB,MAGzC,IAAIhwB,EAAS0vB,EAAY1vB,OAAS0D,EAAM1D,OAAS2vB,EAAY3vB,OACzDiwB,EAAUjwB,EAASqtB,EAAQ,IAAInhB,MAAMmhB,EAAQrtB,EAAS,GAAGgE,KAAKipB,GAAQ,GAM1E,OAHIK,GAASlT,IAAM1W,EAAQ2K,EAAM4hB,EAAUvsB,EAAOusB,EAAQjwB,OAASqtB,EAAQsC,EAAY3vB,OAASgwB,KAAWC,EAAU,IAG7G/C,GACN,IAAK,IAAKxpB,EAAQgsB,EAAchsB,EAAQisB,EAAcM,EAAS,MAC/D,IAAK,IAAKvsB,EAAQgsB,EAAcO,EAAUvsB,EAAQisB,EAAa,MAC/D,IAAK,IAAKjsB,EAAQusB,EAAQ7jB,MAAM,EAAGpM,EAASiwB,EAAQjwB,QAAU,GAAK0vB,EAAchsB,EAAQisB,EAAcM,EAAQ7jB,MAAMpM,GAAS,MAC9H,QAAS0D,EAAQusB,EAAUP,EAAchsB,EAAQisB,EAGnD,OAAOZ,EAASrrB,EAClB,CAMA,OAtEA6pB,OAA0BppB,IAAdopB,EAA0B,EAChC,SAASjhB,KAAK+H,GAAQuD,KAAK4B,IAAI,EAAG5B,KAAKC,IAAI,GAAI0V,IAC/C3V,KAAK4B,IAAI,EAAG5B,KAAKC,IAAI,GAAI0V,IAgE/BzG,OAAOljB,SAAW,WAChB,OAAOmpB,EAAY,EACrB,EAEOjG,MACT,CAYA,MAAO,CACLA,OAAQuI,UACRlB,aAZF,SAASA,aAAapB,EAAWrpB,GAC/B,IAAIgE,EAAI2nB,YAAWtC,EAAYD,gBAAgBC,IAAsB1Y,KAAO,IAAK0Y,IAC7ErqB,EAAiE,EAA7DkV,KAAK4B,KAAK,EAAG5B,KAAKC,IAAI,EAAGD,KAAK8B,MAAMkU,SAASlqB,GAAS,KAC1DZ,EAAI8U,KAAKmE,IAAI,IAAKrZ,GAClBkN,EAASwe,GAAS,EAAI1rB,EAAI,GAC9B,OAAO,SAASgB,GACd,OAAOgE,EAAE5E,EAAIY,GAASkM,CACxB,CACF,EAMF,CCvIe,SAASsgB,cAAc7kB,GAIpC,OAHA,GAAS,OAAaA,GACtByb,GAAS,GAAOA,OAChBqH,GAAe,GAAOA,aACf,EACT,CIde,SAASgC,WAAWzU,EAAOtU,EAAM5G,EAAOusB,GACrD,IACIQ,EADA5R,E/B8CC,SAASyU,SAAS1U,EAAOtU,EAAM5G,GACNA,GAASA,EACvC,MAAMyH,GADNb,GAAQA,IAAMsU,GAASA,GACOQ,EAAMjU,EAAUmU,cAAchV,EAAMsU,EAAOlb,GAAS4b,cAAcV,EAAOtU,EAAM5G,GAC7G,OAAQyH,GAAW,EAAI,IAAMiU,EAAM,EAAI,GAAKA,EAAMA,EACpD,C+BlDakU,CAAS1U,EAAOtU,EAAM5G,GAGjC,QADAusB,EAAYD,gBAA6B,MAAbC,EAAoB,KAAOA,IACrC1Y,MAChB,IAAK,IACH,IAAI3Q,EAAQkU,KAAK4B,IAAI5B,KAAK+V,IAAIjS,GAAQ9D,KAAK+V,IAAIvmB,IAE/C,OAD2B,MAAvB2lB,EAAUQ,WAAsBlnB,MAAMknB,ECRjC,yBAAS5R,EAAMjY,GAC5B,OAAOkU,KAAK4B,IAAI,EAAgE,EAA7D5B,KAAK4B,KAAK,EAAG5B,KAAKC,IAAI,EAAGD,KAAK8B,MAAMkU,SAASlqB,GAAS,KAAWkqB,SAAShW,KAAK+V,IAAIhS,IACxG,CDM4D0U,CAAgB1U,EAAMjY,MAASqpB,EAAUQ,UAAYA,GACpGY,GAAapB,EAAWrpB,GAEjC,IAAK,GACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACwB,MAAvBqpB,EAAUQ,WAAsBlnB,MAAMknB,EEhBjC,wBAAS5R,EAAMnC,GAE5B,OADAmC,EAAO/D,KAAK+V,IAAIhS,GAAOnC,EAAM5B,KAAK+V,IAAInU,GAAOmC,EACtC/D,KAAK4B,IAAI,EAAGoU,SAASpU,GAAOoU,SAASjS,IAAS,CACvD,CFa4D2U,CAAe3U,EAAM/D,KAAK4B,IAAI5B,KAAK+V,IAAIjS,GAAQ9D,KAAK+V,IAAIvmB,QAAU2lB,EAAUQ,UAAYA,GAAgC,MAAnBR,EAAU1Y,OACrK,MAEF,IAAK,IACL,IAAK,IACwB,MAAvB0Y,EAAUQ,WAAsBlnB,MAAMknB,EGrBjC,wBAAS5R,GACtB,OAAO/D,KAAK4B,IAAI,GAAIoU,SAAShW,KAAK+V,IAAIhS,IACxC,CHmB4D4U,CAAe5U,MAAQoR,EAAUQ,UAAYA,EAAuC,GAAP,MAAnBR,EAAU1Y,OAI9H,OAAOyS,GAAOiG,EAChB,CIvBO,SAASyD,UAAUzV,GACxB,IAAIL,EAASK,EAAML,OAkDnB,OAhDAK,EAAM0V,MAAQ,SAASjwB,GACrB,IAAImC,EAAI+X,IACR,OnCkBW,SAAS+V,MAAM/U,EAAOtU,EAAM5G,GAEzC,MAD8BA,GAASA,GACzB,GAAI,MAAO,GACzB,IAFckb,GAASA,MAAvBtU,GAAQA,GAEY,MAAO,CAACsU,GAC5B,MAAMzT,EAAUb,EAAOsU,GAAQ7E,EAAIoF,EAAIC,GAAOjU,EAAUwT,SAASrU,EAAMsU,EAAOlb,GAASib,SAASC,EAAOtU,EAAM5G,GAC7G,KAAMyb,GAAMpF,GAAK,MAAO,GACxB,MAAM3T,EAAI+Y,EAAKpF,EAAK,EAAG4Z,EAAQ,IAAIvkB,MAAMhJ,GACzC,GAAI+E,EACF,GAAIiU,EAAM,EAAG,IAAK,IAAInc,EAAI,EAAGA,EAAImD,IAAKnD,EAAG0wB,EAAM1wB,IAAMkc,EAAKlc,IAAMmc,OAC3D,IAAK,IAAInc,EAAI,EAAGA,EAAImD,IAAKnD,EAAG0wB,EAAM1wB,IAAMkc,EAAKlc,GAAKmc,OAEvD,GAAIA,EAAM,EAAG,IAAK,IAAInc,EAAI,EAAGA,EAAImD,IAAKnD,EAAG0wB,EAAM1wB,IAAM8W,EAAK9W,IAAMmc,OAC3D,IAAK,IAAInc,EAAI,EAAGA,EAAImD,IAAKnD,EAAG0wB,EAAM1wB,IAAM8W,EAAK9W,GAAKmc,EAEzD,OAAOuU,CACT,CmCjCWA,CAAM9tB,EAAE,GAAIA,EAAEA,EAAE3C,OAAS,GAAa,MAATQ,EAAgB,GAAKA,EAC3D,EAEAua,EAAMoV,WAAa,SAAS3vB,EAAOusB,GACjC,IAAIpqB,EAAI+X,IACR,OAAOyV,WAAWxtB,EAAE,GAAIA,EAAEA,EAAE3C,OAAS,GAAa,MAATQ,EAAgB,GAAKA,EAAOusB,EACvE,EAEAhS,EAAM2V,KAAO,SAASlwB,GACP,MAATA,IAAeA,EAAQ,IAE3B,IAKImwB,EACAhV,EANAhZ,EAAI+X,IACJ9D,EAAK,EACLC,EAAKlU,EAAE3C,OAAS,EAChB0b,EAAQ/Y,EAAEiU,GACVxP,EAAOzE,EAAEkU,GAGT+Z,EAAU,GAOd,IALIxpB,EAAOsU,IACTC,EAAOD,EAAOA,EAAQtU,EAAMA,EAAOuU,EACnCA,EAAO/E,EAAIA,EAAKC,EAAIA,EAAK8E,GAGpBiV,KAAY,GAAG,CAEpB,IADAjV,EAAOS,cAAcV,EAAOtU,EAAM5G,MACrBmwB,EAGX,OAFAhuB,EAAEiU,GAAM8E,EACR/Y,EAAEkU,GAAMzP,EACDsT,EAAO/X,GACT,GAAIgZ,EAAO,EAChBD,EAAQ9D,KAAK8B,MAAMgC,EAAQC,GAAQA,EACnCvU,EAAOwQ,KAAKiZ,KAAKzpB,EAAOuU,GAAQA,MAC3B,MAAIA,EAAO,GAIhB,MAHAD,EAAQ9D,KAAKiZ,KAAKnV,EAAQC,GAAQA,EAClCvU,EAAOwQ,KAAK8B,MAAMtS,EAAOuU,GAAQA,CAGnC,CACAgV,EAAUhV,CACZ,CAEA,OAAOZ,CACT,EAEOA,CACT,CAEe,SAAS,gBACtB,IAAIA,EAAQ4R,aAQZ,OANA5R,EAAMK,KAAO,WACX,OAAOA,KAAKL,EAAO,gBACrB,EAEAN,UAAU1Q,MAAMgR,EAAOrK,WAEhB8f,UAAUzV,EACnB,CCjEe,SAAS+V,WACtB,IAKIlW,EALAmW,EAAK,EACLC,EAAK,EACL9tB,EAAI,EACJwX,EAAS,CAAC,IACVC,EAAQ,CAAC,EAAG,GAGhB,SAASI,MAAM9N,GACb,OAAY,MAALA,GAAaA,GAAKA,EAAI0N,EAAMK,EAAON,EAAQzN,EAAG,EAAG/J,IAAM0X,CAChE,CAEA,SAASE,UACP,IAAI/a,GAAK,EAET,IADA2a,EAAS,IAAIxO,MAAMhJ,KACVnD,EAAImD,GAAGwX,EAAO3a,KAAOA,EAAI,GAAKixB,GAAMjxB,EAAImD,GAAK6tB,IAAO7tB,EAAI,GACjE,OAAO6X,KACT,CAiCA,OA/BAA,MAAML,OAAS,SAASQ,GACtB,OAAOxK,UAAU1Q,SAAW+wB,EAAIC,GAAM9V,EAAG6V,GAAMA,EAAIC,GAAMA,EAAIlW,WAAa,CAACiW,EAAIC,EACjF,EAEAjW,MAAMJ,MAAQ,SAASO,GACrB,OAAOxK,UAAU1Q,QAAUkD,GAAKyX,EAAQzO,MAAMG,KAAK6O,IAAIlb,OAAS,EAAG8a,WAAaH,EAAMvO,OACxF,EAEA2O,MAAME,aAAe,SAASzQ,GAC5B,IAAIzK,EAAI4a,EAAM9K,QAAQrF,GACtB,OAAOzK,EAAI,EAAI,CAACqP,IAAKA,KACfrP,EAAI,EAAI,CAACgxB,EAAIrW,EAAO,IACpB3a,GAAKmD,EAAI,CAACwX,EAAOxX,EAAI,GAAI8tB,GACzB,CAACtW,EAAO3a,EAAI,GAAI2a,EAAO3a,GAC/B,EAEAgb,MAAMH,QAAU,SAASM,GACvB,OAAOxK,UAAU1Q,QAAU4a,EAAUM,EAAGH,OAASA,KACnD,EAEAA,MAAMF,WAAa,WACjB,OAAOH,EAAOtO,OAChB,EAEA2O,MAAMK,KAAO,WACX,OAAO0V,WACFpW,OAAO,CAACqW,EAAIC,IACZrW,MAAMA,GACNC,QAAQA,EACf,EAEOH,UAAU1Q,MAAMymB,UAAUzV,OAAQrK,UAC3C,CCpDe,SAASugB,YACtB,IAEIrW,EAFAF,EAAS,CAAC,IACVC,EAAQ,CAAC,EAAG,GAEZzX,EAAI,EAER,SAAS6X,MAAM9N,GACb,OAAY,MAALA,GAAaA,GAAKA,EAAI0N,EAAMK,EAAON,EAAQzN,EAAG,EAAG/J,IAAM0X,CAChE,CA0BA,OAxBAG,MAAML,OAAS,SAASQ,GACtB,OAAOxK,UAAU1Q,QAAU0a,EAASxO,MAAMG,KAAK6O,GAAIhY,EAAI0U,KAAKC,IAAI6C,EAAO1a,OAAQ2a,EAAM3a,OAAS,GAAI+a,OAASL,EAAOtO,OACpH,EAEA2O,MAAMJ,MAAQ,SAASO,GACrB,OAAOxK,UAAU1Q,QAAU2a,EAAQzO,MAAMG,KAAK6O,GAAIhY,EAAI0U,KAAKC,IAAI6C,EAAO1a,OAAQ2a,EAAM3a,OAAS,GAAI+a,OAASJ,EAAMvO,OAClH,EAEA2O,MAAME,aAAe,SAASzQ,GAC5B,IAAIzK,EAAI4a,EAAM9K,QAAQrF,GACtB,MAAO,CAACkQ,EAAO3a,EAAI,GAAI2a,EAAO3a,GAChC,EAEAgb,MAAMH,QAAU,SAASM,GACvB,OAAOxK,UAAU1Q,QAAU4a,EAAUM,EAAGH,OAASH,CACnD,EAEAG,MAAMK,KAAO,WACX,OAAO6V,YACFvW,OAAOA,GACPC,MAAMA,GACNC,QAAQA,EACf,EAEOH,UAAU1Q,MAAMgR,MAAOrK,UAChC,CCtCe,gBAASqc,GAEtB,IADA,IAAI7pB,EAAI6pB,EAAU/sB,OAAS,EAAI,EAAGiqB,EAAS,IAAI/d,MAAMhJ,GAAInD,EAAI,EACtDA,EAAImD,GAAG+mB,EAAOlqB,GAAK,IAAMgtB,EAAU3gB,MAAU,EAAJrM,EAAa,IAAJA,GACzD,OAAOkqB,CACT,CXEAiG,cAAc,CACZ3B,UAAW,IACXD,SAAU,CAAC,GACXM,SAAU,CAAC,IAAK,MYPlB,WAAesC,GAAU,GAAoBA,EAAOA,EAAOlxB,OAAS,ICWpE,SAAemxB,KAVK,IAAIjlB,MAAM,GAAGzL,OAC/B,qBACA,2BACA,iCACA,uCACA,6CACA,mDACA,0DACAoD,IAAIomB,SCXC,MAAM,GAAUrS,KAAKwZ,GAAK,IACpB,GAAU,IAAMxZ,KAAKwZ,GCK9BC,GAAK,OAELC,GAAK,OACLC,GAAK,EAAI,GACThJ,GAAK,EAAI,GACTK,GAAK,EAAIL,GAAKA,GACdM,GAAKN,GAAKA,GAAKA,GAEnB,SAASiJ,WAAWnuB,GAClB,GAAIA,aAAaouB,IAAK,OAAO,IAAIA,IAAIpuB,EAAEsH,EAAGtH,EAAEC,EAAGD,EAAEsI,EAAGtI,EAAEmkB,SACtD,GAAInkB,aAAaquB,IAAK,OAAOC,QAAQtuB,GAC/BA,aAAa8jB,MAAM9jB,EAAIkkB,WAAWlkB,IACxC,IAGuE4J,EAAG2kB,EAHtEzuB,EAAI0uB,SAASxuB,EAAEF,GACfmkB,EAAIuK,SAASxuB,EAAEikB,GACf3b,EAAIkmB,SAASxuB,EAAEsI,GACfnB,EAAIsnB,SAAS,SAAY3uB,EAAI,SAAYmkB,EAAI,SAAY3b,GAdtD,GAmBP,OAJIxI,IAAMmkB,GAAKA,IAAM3b,EAAGsB,EAAI2kB,EAAIpnB,GAC9ByC,EAAI6kB,SAAS,SAAY3uB,EAAI,SAAYmkB,EAAI,SAAY3b,GAAK0lB,IAC9DO,EAAIE,SAAS,SAAY3uB,EAAI,SAAYmkB,EAAI,SAAY3b,GAAK2lB,KAEzD,IAAIG,IAAI,IAAMjnB,EAAI,GAAI,KAAOyC,EAAIzC,GAAI,KAAOA,EAAIonB,GAAIvuB,EAAEmkB,QAC/D,CAMe,SAASuK,IAAIpnB,EAAGrH,EAAGqI,EAAG6b,GACnC,OAA4B,IAArB9W,UAAU1Q,OAAewxB,WAAW7mB,GAAK,IAAI8mB,IAAI9mB,EAAGrH,EAAGqI,EAAc,MAAX6b,EAAkB,EAAIA,EACzF,CAEO,SAASiK,IAAI9mB,EAAGrH,EAAGqI,EAAG6b,GAC3B5kB,KAAK+H,GAAKA,EACV/H,KAAKU,GAAKA,EACVV,KAAK+I,GAAKA,EACV/I,KAAK4kB,SAAWA,CAClB,CAyBA,SAASsK,QAAQ1uB,GACf,OAAOA,EAAIylB,GAAKjR,KAAKmE,IAAI3Y,EAAG,EAAI,GAAKA,EAAIwlB,GAAK2I,EAChD,CAEA,SAASS,QAAQ5uB,GACf,OAAOA,EAAImlB,GAAKnlB,EAAIA,EAAIA,EAAIwlB,IAAMxlB,EAAImuB,GACxC,CAEA,SAASU,SAAShlB,GAChB,OAAO,KAAOA,GAAK,SAAY,MAAQA,EAAI,MAAQ2K,KAAKmE,IAAI9O,EAAG,EAAI,KAAO,KAC5E,CAEA,SAAS4kB,SAAS5kB,GAChB,OAAQA,GAAK,MAAQ,OAAUA,EAAI,MAAQ2K,KAAKmE,KAAK9O,EAAI,MAAS,MAAO,IAC3E,CAEA,SAASilB,WAAW7uB,GAClB,GAAIA,aAAaquB,IAAK,OAAO,IAAIA,IAAIruB,EAAEykB,EAAGzkB,EAAEuG,EAAGvG,EAAEsH,EAAGtH,EAAEmkB,SAEtD,GADMnkB,aAAaouB,MAAMpuB,EAAImuB,WAAWnuB,IAC5B,IAARA,EAAEC,GAAmB,IAARD,EAAEsI,EAAS,OAAO,IAAI+lB,IAAItiB,IAAK,EAAI/L,EAAEsH,GAAKtH,EAAEsH,EAAI,IAAM,EAAIyE,IAAK/L,EAAEsH,EAAGtH,EAAEmkB,SACvF,IAAIM,EAAIlQ,KAAKua,MAAM9uB,EAAEsI,EAAGtI,EAAEC,GAAK,GAC/B,OAAO,IAAIouB,IAAI5J,EAAI,EAAIA,EAAI,IAAMA,EAAGlQ,KAAK0D,KAAKjY,EAAEC,EAAID,EAAEC,EAAID,EAAEsI,EAAItI,EAAEsI,GAAItI,EAAEsH,EAAGtH,EAAEmkB,QAC/E,CAUO,SAASkK,IAAI5J,EAAGle,EAAGe,EAAG6c,GAC3B5kB,KAAKklB,GAAKA,EACVllB,KAAKgH,GAAKA,EACVhH,KAAK+H,GAAKA,EACV/H,KAAK4kB,SAAWA,CAClB,CAEA,SAASmK,QAAQtuB,GACf,GAAIgD,MAAMhD,EAAEykB,GAAI,OAAO,IAAI2J,IAAIpuB,EAAEsH,EAAG,EAAG,EAAGtH,EAAEmkB,SAC5C,IAAIM,EAAIzkB,EAAEykB,EAAI,GACd,OAAO,IAAI2J,IAAIpuB,EAAEsH,EAAGiN,KAAKwa,IAAItK,GAAKzkB,EAAEuG,EAAGgO,KAAKya,IAAIvK,GAAKzkB,EAAEuG,EAAGvG,EAAEmkB,QAC9D,CC3Ge,SAAS,QAAI9L,EAAOoO,GACjC,IAAInf,EAAI,SAAO+Q,EAAQ,IAASA,IAAQ/Q,GAAImf,EAAM,IAASA,IAAMnf,GAC7DrH,EAAI,QAAMoY,EAAMpY,EAAGwmB,EAAIxmB,GACvBqI,EAAI,QAAM+P,EAAM/P,EAAGme,EAAIne,GACvB6b,EAAU,QAAM9L,EAAM8L,QAASsC,EAAItC,SACvC,OAAO,SAASpkB,GAKd,OAJAsY,EAAM/Q,EAAIA,EAAEvH,GACZsY,EAAMpY,EAAIA,EAAEF,GACZsY,EAAM/P,EAAIA,EAAEvI,GACZsY,EAAM8L,QAAUA,EAAQpkB,GACjBsY,EAAQ,EACjB,CACF,CCfA,SAAS4W,mBAAmBpvB,EAAGE,EAAGV,EAAGS,EAAGE,EAAGC,EAAGsG,GAC5C,IACE,IAAI7J,EAAImD,EAAEI,GAAGsG,GACXrB,EAAIxI,EAAE2D,KACV,CAAE,MAAOR,GACP,YAAYR,EAAEQ,EAChB,CACAnD,EAAE0D,KAAOL,EAAEmF,GAAK4B,QAAQN,QAAQtB,GAAG/E,KAAKL,EAAGE,EAC7C,CACA,SAASkvB,kBAAkBrvB,GACzB,OAAO,WACL,IAAIE,EAAIR,KACNF,EAAIgO,UACN,OAAO,IAAIvG,QAAQ,SAAUhH,EAAGE,GAC9B,IAAIC,EAAIJ,EAAE6G,MAAM3G,EAAGV,GACnB,SAASuL,MAAM/K,GACbovB,mBAAmBhvB,EAAGH,EAAGE,EAAG4K,MAAOukB,OAAQ,OAAQtvB,EACrD,CACA,SAASsvB,OAAOtvB,GACdovB,mBAAmBhvB,EAAGH,EAAGE,EAAG4K,MAAOukB,OAAQ,QAAStvB,EACtD,CACA+K,WAAM,EACR,EACF,CACF,CFoBA,WAAOwjB,IAAKM,IAAK1V,OAAOC,MAAO,CAC7B,QAAAE,CAAS1Z,GACP,OAAO,IAAI2uB,IAAI7uB,KAAK+H,EAzCd,IAyC4B,MAAL7H,EAAY,EAAIA,GAAIF,KAAKU,EAAGV,KAAK+I,EAAG/I,KAAK4kB,QACxE,EACA,MAAAjL,CAAOzZ,GACL,OAAO,IAAI2uB,IAAI7uB,KAAK+H,EA5Cd,IA4C4B,MAAL7H,EAAY,EAAIA,GAAIF,KAAKU,EAAGV,KAAK+I,EAAG/I,KAAK4kB,QACxE,EACA,GAAAd,GACE,IAAIlc,GAAK5H,KAAK+H,EAAI,IAAM,IACpBsC,EAAI5G,MAAMzD,KAAKU,GAAKkH,EAAIA,EAAI5H,KAAKU,EAAI,IACrCsuB,EAAIvrB,MAAMzD,KAAK+I,GAAKnB,EAAIA,EAAI5H,KAAK+I,EAAI,IAIzC,OAAO,IAAIwb,IACT8K,SAAU,WAJZhlB,EAAIokB,GAAKW,QAAQ/kB,IAIW,WAH5BzC,EAjDK,EAiDIwnB,QAAQxnB,IAG2B,UAF5ConB,EAAIN,GAAKU,QAAQJ,KAGfK,UAAU,SAAYhlB,EAAI,UAAYzC,EAAI,QAAYonB,GACtDK,SAAU,SAAYhlB,EAAI,SAAYzC,EAAI,UAAYonB,GACtDhvB,KAAK4kB,QAET,KAgDF,WAAOkK,IAjBA,SAASe,IAAI3K,EAAGle,EAAGe,EAAG6c,GAC3B,OAA4B,IAArB9W,UAAU1Q,OAAekyB,WAAWpK,GAAK,IAAI4J,IAAI5J,EAAGle,EAAGe,EAAc,MAAX6c,EAAkB,EAAIA,EACzF,EAeiBnL,OAAOC,MAAO,CAC7B,QAAAE,CAAS1Z,GACP,OAAO,IAAI4uB,IAAI9uB,KAAKklB,EAAGllB,KAAKgH,EAAGhH,KAAK+H,EA7G9B,IA6G4C,MAAL7H,EAAY,EAAIA,GAAIF,KAAK4kB,QACxE,EACA,MAAAjL,CAAOzZ,GACL,OAAO,IAAI4uB,IAAI9uB,KAAKklB,EAAGllB,KAAKgH,EAAGhH,KAAK+H,EAhH9B,IAgH4C,MAAL7H,EAAY,EAAIA,GAAIF,KAAK4kB,QACxE,EACA,GAAAd,GACE,OAAOiL,QAAQ/uB,MAAM8jB,KACvB,K,6DGzHEgM,GAAO,CAAChvB,MAAO,QAEnB,SAAS,oBACP,IAAK,IAAyCN,EAArCrD,EAAI,EAAGmD,EAAIwN,UAAU1Q,OAAQkb,EAAI,CAAC,EAAMnb,EAAImD,IAAKnD,EAAG,CAC3D,KAAMqD,EAAIsN,UAAU3Q,GAAK,KAAQqD,KAAK8X,GAAM,QAAQ5O,KAAKlJ,GAAI,MAAM,IAAIiG,MAAM,iBAAmBjG,GAChG8X,EAAE9X,GAAK,EACT,CACA,OAAO,IAAIuvB,SAASzX,EACtB,CAEA,SAASyX,SAASzX,GAChBtY,KAAKsY,EAAIA,CACX,CAoDA,SAAS3P,IAAI8I,EAAMlN,GACjB,IAAK,IAA4ByC,EAAxB7J,EAAI,EAAGmD,EAAImR,EAAKrU,OAAWD,EAAImD,IAAKnD,EAC3C,IAAK6J,EAAIyK,EAAKtU,IAAIoH,OAASA,EACzB,OAAOyC,EAAElG,KAGf,CAEA,SAASsL,IAAIqF,EAAMlN,EAAMqR,GACvB,IAAK,IAAIzY,EAAI,EAAGmD,EAAImR,EAAKrU,OAAQD,EAAImD,IAAKnD,EACxC,GAAIsU,EAAKtU,GAAGoH,OAASA,EAAM,CACzBkN,EAAKtU,GAAK2yB,GAAMre,EAAOA,EAAKjI,MAAM,EAAGrM,GAAGU,OAAO4T,EAAKjI,MAAMrM,EAAI,IAC9D,KACF,CAGF,OADgB,MAAZyY,GAAkBnE,EAAKhV,KAAK,CAAC8H,KAAMA,EAAMzD,MAAO8U,IAC7CnE,CACT,CA1DAse,SAASrpB,UAAY,kBAASA,UAAY,CACxCrC,YAAa0rB,SACbze,GAAI,SAASD,EAAUuE,GACrB,IAEIpV,EAFA8X,EAAItY,KAAKsY,EACT0X,EAbR,SAAS,wBAAexZ,EAAWyZ,GACjC,OAAOzZ,EAAUzH,OAAOC,MAAM,SAAS/N,IAAI,SAAST,GAClD,IAAI+D,EAAO,GAAIpH,EAAIqD,EAAEyM,QAAQ,KAE7B,GADI9P,GAAK,IAAGoH,EAAO/D,EAAEgJ,MAAMrM,EAAI,GAAIqD,EAAIA,EAAEgJ,MAAM,EAAGrM,IAC9CqD,IAAMyvB,EAAMnnB,eAAetI,GAAI,MAAM,IAAIiG,MAAM,iBAAmBjG,GACtE,MAAO,CAACiR,KAAMjR,EAAG+D,KAAMA,EACzB,EACF,CAMY,CAAe8M,EAAW,GAAIiH,GAElCnb,GAAK,EACLmD,EAAI0vB,EAAE5yB,OAGV,KAAI0Q,UAAU1Q,OAAS,GAAvB,CAOA,GAAgB,MAAZwY,GAAwC,mBAAbA,EAAyB,MAAM,IAAInP,MAAM,qBAAuBmP,GAC/F,OAASzY,EAAImD,GACX,GAAIE,GAAK6Q,EAAW2e,EAAE7yB,IAAIsU,KAAM6G,EAAE9X,GAAK4L,IAAIkM,EAAE9X,GAAI6Q,EAAS9M,KAAMqR,QAC3D,GAAgB,MAAZA,EAAkB,IAAKpV,KAAK8X,EAAGA,EAAE9X,GAAK4L,IAAIkM,EAAE9X,GAAI6Q,EAAS9M,KAAM,MAG1E,OAAOvE,IAVP,CAFE,OAAS7C,EAAImD,OAAQE,GAAK6Q,EAAW2e,EAAE7yB,IAAIsU,QAAUjR,EAAImI,IAAI2P,EAAE9X,GAAI6Q,EAAS9M,OAAQ,OAAO/D,CAa/F,EACAgY,KAAM,WACJ,IAAIA,EAAO,CAAC,EAAGF,EAAItY,KAAKsY,EACxB,IAAK,IAAI9X,KAAK8X,EAAGE,EAAKhY,GAAK8X,EAAE9X,GAAGgJ,QAChC,OAAO,IAAIumB,SAASvX,EACtB,EACAhV,KAAM,SAASiO,EAAMye,GACnB,IAAK5vB,EAAIwN,UAAU1Q,OAAS,GAAK,EAAG,IAAK,IAAgCkD,EAAGE,EAA/B2vB,EAAO,IAAI7mB,MAAMhJ,GAAInD,EAAI,EAASA,EAAImD,IAAKnD,EAAGgzB,EAAKhzB,GAAK2Q,UAAU3Q,EAAI,GACnH,IAAK6C,KAAKsY,EAAExP,eAAe2I,GAAO,MAAM,IAAIhL,MAAM,iBAAmBgL,GACrE,IAAuBtU,EAAI,EAAGmD,GAAzBE,EAAIR,KAAKsY,EAAE7G,IAAoBrU,OAAQD,EAAImD,IAAKnD,EAAGqD,EAAErD,GAAG2D,MAAMqG,MAAM+oB,EAAMC,EACjF,EACAhpB,MAAO,SAASsK,EAAMye,EAAMC,GAC1B,IAAKnwB,KAAKsY,EAAExP,eAAe2I,GAAO,MAAM,IAAIhL,MAAM,iBAAmBgL,GACrE,IAAK,IAAIjR,EAAIR,KAAKsY,EAAE7G,GAAOtU,EAAI,EAAGmD,EAAIE,EAAEpD,OAAQD,EAAImD,IAAKnD,EAAGqD,EAAErD,GAAG2D,MAAMqG,MAAM+oB,EAAMC,EACrF,GAsBF,2BCnFA,IAIIC,GACAC,GALA,GAAQ,EACRC,GAAU,EACVC,GAAW,EAIXC,GAAY,EACZC,GAAW,EACXC,GAAY,EACZC,GAA+B,iBAAhBC,aAA4BA,YAAYC,IAAMD,YAAclJ,KAC3EoJ,GAA6B,iBAAXzqB,QAAuBA,OAAO0qB,sBAAwB1qB,OAAO0qB,sBAAsBjpB,KAAKzB,QAAU,SAASvB,GAAKksB,WAAWlsB,EAAG,GAAK,EAElJ,SAAS+rB,MACd,OAAOJ,KAAaK,GAASG,UAAWR,GAAWE,GAAME,MAAQH,GACnE,CAEA,SAASO,WACPR,GAAW,CACb,CAEO,SAASS,QACdlxB,KAAKmxB,MACLnxB,KAAKoxB,MACLpxB,KAAKqL,MAAQ,IACf,CAyBO,SAASgmB,MAAMzb,EAAU0b,EAAOC,GACrC,IAAI/wB,EAAI,IAAI0wB,MAEZ,OADA1wB,EAAEgxB,QAAQ5b,EAAU0b,EAAOC,GACpB/wB,CACT,CAaA,SAASixB,OACPhB,IAAYD,GAAYG,GAAME,OAASH,GACvC,GAAQJ,GAAU,EAClB,KAdK,SAASoB,aACdb,QACE,GAEF,IADA,IAAkB/wB,EAAdU,EAAI4vB,GACD5vB,IACAV,EAAI2wB,GAAWjwB,EAAE4wB,QAAU,GAAG5wB,EAAE2wB,MAAM3tB,UAAKjC,EAAWzB,GAC3DU,EAAIA,EAAE6K,QAEN,EACJ,CAMIqmB,EACF,CAAE,QACA,GAAQ,EAWZ,SAASC,MACP,IAAIhD,EAAmB3I,EAAfL,EAAKyK,GAAcmB,EAAOnE,IAClC,KAAOzH,GACDA,EAAGwL,OACDI,EAAO5L,EAAGyL,QAAOG,EAAO5L,EAAGyL,OAC/BzC,EAAKhJ,EAAIA,EAAKA,EAAGta,QAEjB2a,EAAKL,EAAGta,MAAOsa,EAAGta,MAAQ,KAC1Bsa,EAAKgJ,EAAKA,EAAGtjB,MAAQ2a,EAAKoK,GAAWpK,GAGzCqK,GAAW1B,EACXiD,MAAML,EACR,CAvBII,GACAlB,GAAW,CACb,CACF,CAEA,SAASoB,OACP,IAAIhB,EAAMF,GAAME,MAAOS,EAAQT,EAAML,GACjCc,EA7EU,MA6ESZ,IAAaY,EAAOd,GAAYK,EACzD,CAiBA,SAASe,MAAML,GACT,KACAjB,KAASA,GAAUwB,aAAaxB,KACxBiB,EAAOd,GACP,IACNc,EAAOnE,MAAUkD,GAAUU,WAAWS,KAAMF,EAAOZ,GAAME,MAAQH,KACjEH,KAAUA,GAAWwB,cAAcxB,OAElCA,KAAUC,GAAYG,GAAME,MAAON,GAAWyB,YAAYH,KAvGnD,MAwGZ,GAAQ,EAAGf,GAASW,OAExB,CC3Ge,qBAAS7b,EAAU0b,EAAOC,GACvC,IAAI/wB,EAAI,IAAI0wB,MAMZ,OALAI,EAAiB,MAATA,EAAgB,GAAKA,EAC7B9wB,EAAEgxB,QAAQS,IACRzxB,EAAEgE,OACFoR,EAASqc,EAAUX,IAClBA,EAAOC,GACH/wB,CACT,CDgBA0wB,MAAMxqB,UAAY2qB,MAAM3qB,UAAY,CAClCrC,YAAa6sB,MACbM,QAAS,SAAS5b,EAAU0b,EAAOC,GACjC,GAAwB,mBAAb3b,EAAyB,MAAM,IAAIlS,UAAU,8BACxD6tB,GAAgB,MAARA,EAAeV,OAASU,IAAkB,MAATD,EAAgB,GAAKA,GACzDtxB,KAAKqL,OAASglB,KAAarwB,OAC1BqwB,GAAUA,GAAShlB,MAAQrL,KAC1BowB,GAAWpwB,KAChBqwB,GAAWrwB,MAEbA,KAAKmxB,MAAQvb,EACb5V,KAAKoxB,MAAQG,EACbK,OACF,EACAptB,KAAM,WACAxE,KAAKmxB,QACPnxB,KAAKmxB,MAAQ,KACbnxB,KAAKoxB,MAAQhE,IACbwE,QAEJ,GE3CF,IAAIM,GAAU,GAAS,QAAS,MAAO,SAAU,aAC7CC,GAAa,GAUF,kBAASznB,EAAMnG,EAAM7H,EAAIuC,EAAOwM,EAAO2mB,GACpD,IAAIC,EAAY3nB,EAAK4nB,aACrB,GAAKD,GACA,GAAI31B,KAAM21B,EAAW,YADV3nB,EAAK4nB,aAAe,CAAC,GAmCvC,SAAS3qB,OAAO+C,EAAMhO,EAAIH,GACxB,IACIg2B,EADAF,EAAY3nB,EAAK4nB,aAQrB,SAASE,SAASP,GAChB11B,EAAKk2B,MAtDc,EAuDnBl2B,EAAK80B,MAAMG,QAAQ1Y,MAAOvc,EAAK+0B,MAAO/0B,EAAKg1B,MAGvCh1B,EAAK+0B,OAASW,GAASnZ,MAAMmZ,EAAU11B,EAAK+0B,MAClD,CAEA,SAASxY,MAAMmZ,GACb,IAAI90B,EAAGqU,EAAGlR,EAAGG,EAGb,GAjEmB,IAiEflE,EAAKk2B,MAAqB,OAAOjuB,OAErC,IAAKrH,KAAKk1B,EAER,IADA5xB,EAAI4xB,EAAUl1B,IACRoH,OAAShI,EAAKgI,KAApB,CAKA,GAxEe,IAwEX9D,EAAEgyB,MAAmB,OAAO,YAAQ3Z,OAvEzB,IA0EXrY,EAAEgyB,OACJhyB,EAAEgyB,MAzES,EA0EXhyB,EAAE4wB,MAAM7sB,OACR/D,EAAE6Q,GAAG9N,KAAK,YAAakH,EAAMA,EAAKa,SAAU9K,EAAExB,MAAOwB,EAAEgL,cAChD4mB,EAAUl1B,KAITA,EAAIT,IACZ+D,EAAEgyB,MAjFS,EAkFXhyB,EAAE4wB,MAAM7sB,OACR/D,EAAE6Q,GAAG9N,KAAK,SAAUkH,EAAMA,EAAKa,SAAU9K,EAAExB,MAAOwB,EAAEgL,cAC7C4mB,EAAUl1B,GApBe,CAwCpC,GAZA,YAAQ,WA/FS,IAgGXZ,EAAKk2B,QACPl2B,EAAKk2B,MAhGQ,EAiGbl2B,EAAK80B,MAAMG,QAAQkB,KAAMn2B,EAAK+0B,MAAO/0B,EAAKg1B,MAC1CmB,KAAKT,GAET,GAIA11B,EAAKk2B,MA1Ga,EA2GlBl2B,EAAK+U,GAAG9N,KAAK,QAASkH,EAAMA,EAAKa,SAAUhP,EAAK0C,MAAO1C,EAAKkP,OA3G1C,IA4GdlP,EAAKk2B,MAAT,CAKA,IAJAl2B,EAAKk2B,MA5GY,EA+GjBF,EAAQ,IAAIjpB,MAAMhJ,EAAI/D,EAAKg2B,MAAMn1B,QAC5BD,EAAI,EAAGqU,GAAK,EAAGrU,EAAImD,IAAKnD,GACvBsD,EAAIlE,EAAKg2B,MAAMp1B,GAAG2D,MAAM0C,KAAKkH,EAAMA,EAAKa,SAAUhP,EAAK0C,MAAO1C,EAAKkP,UACrE8mB,IAAQ/gB,GAAK/Q,GAGjB8xB,EAAMn1B,OAASoU,EAAI,CAVgB,CAWrC,CAEA,SAASkhB,KAAKT,GAKZ,IAJA,IAAIzxB,EAAIyxB,EAAU11B,EAAKo2B,SAAWp2B,EAAKq2B,KAAKpvB,KAAK,KAAMyuB,EAAU11B,EAAKo2B,WAAap2B,EAAK80B,MAAMG,QAAQhtB,MAAOjI,EAAKk2B,MAvHlG,EAuHkH,GAC9Ht1B,GAAK,EACLmD,EAAIiyB,EAAMn1B,SAELD,EAAImD,GACXiyB,EAAMp1B,GAAGqG,KAAKkH,EAAMlK,GA5HN,IAgIZjE,EAAKk2B,QACPl2B,EAAK+U,GAAG9N,KAAK,MAAOkH,EAAMA,EAAKa,SAAUhP,EAAK0C,MAAO1C,EAAKkP,OAC1DjH,OAEJ,CAEA,SAASA,OAIP,IAAK,IAAIrH,KAHTZ,EAAKk2B,MAtIU,EAuIfl2B,EAAK80B,MAAM7sB,cACJ6tB,EAAU31B,GACH21B,EAAW,cAClB3nB,EAAK4nB,YACd,CA9FAD,EAAU31B,GAAMH,EAChBA,EAAK80B,MAAQA,MAAMmB,SAAU,EAAGj2B,EAAKg1B,KA8FvC,CAtIE5pB,CAAO+C,EAAMhO,EAAI,CACf6H,KAAMA,EACNtF,MAAOA,EACPwM,MAAOA,EACP6F,GAAI4gB,GACJK,MAAOJ,GACPZ,KAAMa,EAAOb,KACbD,MAAOc,EAAOd,MACdqB,SAAUP,EAAOO,SACjBC,KAAMR,EAAOQ,KACbvB,MAAO,KACPoB,MAvBiB,GAyBrB,CAEO,SAASI,KAAKnoB,EAAMhO,GACzB,IAAI81B,EAAW,aAAI9nB,EAAMhO,GACzB,GAAI81B,EAASC,MA7BM,EA6BW,MAAM,IAAIhsB,MAAM,+BAC9C,OAAO+rB,CACT,CAEO,SAAS,aAAI9nB,EAAMhO,GACxB,IAAI81B,EAAW,aAAI9nB,EAAMhO,GACzB,GAAI81B,EAASC,MAhCM,EAgCW,MAAM,IAAIhsB,MAAM,6BAC9C,OAAO+rB,CACT,CAEO,SAAS,aAAI9nB,EAAMhO,GACxB,IAAI81B,EAAW9nB,EAAK4nB,aACpB,IAAKE,KAAcA,EAAWA,EAAS91B,IAAM,MAAM,IAAI+J,MAAM,wBAC7D,OAAO+rB,CACT,CC/Ce,uBAAS9nB,EAAMnG,GAC5B,IACIiuB,EACAM,EAEA31B,EAJAk1B,EAAY3nB,EAAK4nB,aAGjBhoB,GAAQ,EAGZ,GAAK+nB,EAAL,CAIA,IAAKl1B,KAFLoH,EAAe,MAARA,EAAe,KAAOA,EAAO,GAE1B8tB,GACHG,EAAWH,EAAUl1B,IAAIoH,OAASA,GACvCuuB,EAASN,EAASC,MDPA,GCOoBD,EAASC,MDJ/B,ECKhBD,EAASC,MDJM,ECKfD,EAASnB,MAAM7sB,OACfguB,EAASlhB,GAAG9N,KAAKsvB,EAAS,YAAc,SAAUpoB,EAAMA,EAAKa,SAAUinB,EAASvzB,MAAOuzB,EAAS/mB,cACzF4mB,EAAUl1B,IAL8BmN,GAAQ,EAQrDA,UAAcI,EAAK4nB,YAbD,CAcxB,CCvBA,ICEIS,GDFA,GAAU,IAAM/d,KAAKwZ,GAEd,GAAW,CACpBwE,WAAY,EACZC,WAAY,EACZC,OAAQ,EACRC,MAAO,EACPC,OAAQ,EACRC,OAAQ,GAGK,mBAAS3yB,EAAGqI,EAAG/B,EAAGjH,EAAGD,EAAGgF,GACrC,IAAIsuB,EAAQC,EAAQF,EAKpB,OAJIC,EAASpe,KAAK0D,KAAKhY,EAAIA,EAAIqI,EAAIA,MAAIrI,GAAK0yB,EAAQrqB,GAAKqqB,IACrDD,EAAQzyB,EAAIsG,EAAI+B,EAAIhJ,KAAGiH,GAAKtG,EAAIyyB,EAAOpzB,GAAKgJ,EAAIoqB,IAChDE,EAASre,KAAK0D,KAAK1R,EAAIA,EAAIjH,EAAIA,MAAIiH,GAAKqsB,EAAQtzB,GAAKszB,EAAQF,GAASE,GACtE3yB,EAAIX,EAAIgJ,EAAI/B,IAAGtG,GAAKA,EAAGqI,GAAKA,EAAGoqB,GAASA,EAAOC,GAAUA,GACtD,CACLJ,WAAYlzB,EACZmzB,WAAYnuB,EACZouB,OAAQle,KAAKua,MAAMxmB,EAAGrI,GAAK,GAC3ByyB,MAAOne,KAAKse,KAAKH,GAAS,GAC1BC,OAAQA,EACRC,OAAQA,EAEZ,CEtBA,SAASE,qBAAqBC,EAAOC,EAASC,EAASC,GAErD,SAASrxB,IAAI6iB,GACX,OAAOA,EAAE/nB,OAAS+nB,EAAE7iB,MAAQ,IAAM,EACpC,CAqCA,OAAO,SAAS5B,EAAGqI,GACjB,IAAIoc,EAAI,GACJiD,EAAI,GAOR,OANA1nB,EAAI8yB,EAAM9yB,GAAIqI,EAAIyqB,EAAMzqB,GAtC1B,SAAS6qB,UAAUC,EAAIC,EAAIC,EAAIC,EAAI7O,EAAGiD,GACpC,GAAIyL,IAAOE,GAAMD,IAAOE,EAAI,CAC1B,IAAI72B,EAAIgoB,EAAE1oB,KAAK,aAAc,KAAMg3B,EAAS,KAAMC,GAClDtL,EAAE3rB,KAAK,CAACU,EAAGA,EAAI,EAAGkN,EAAG,WAAOwpB,EAAIE,IAAM,CAAC52B,EAAGA,EAAI,EAAGkN,EAAG,WAAOypB,EAAIE,IACjE,MAAWD,GAAMC,IACf7O,EAAE1oB,KAAK,aAAes3B,EAAKN,EAAUO,EAAKN,EAE9C,CAgCEE,CAAUlzB,EAAEsyB,WAAYtyB,EAAEuyB,WAAYlqB,EAAEiqB,WAAYjqB,EAAEkqB,WAAY9N,EAAGiD,GA9BvE,SAAS8K,OAAOxyB,EAAGqI,EAAGoc,EAAGiD,GACnB1nB,IAAMqI,GACJrI,EAAIqI,EAAI,IAAKA,GAAK,IAAcA,EAAIrI,EAAI,MAAKA,GAAK,KACtD0nB,EAAE3rB,KAAK,CAACU,EAAGgoB,EAAE1oB,KAAK6F,IAAI6iB,GAAK,UAAW,KAAMwO,GAAY,EAAGtpB,EAAG,WAAO3J,EAAGqI,MAC/DA,GACToc,EAAE1oB,KAAK6F,IAAI6iB,GAAK,UAAYpc,EAAI4qB,EAEpC,CAwBET,CAAOxyB,EAAEwyB,OAAQnqB,EAAEmqB,OAAQ/N,EAAGiD,GAtBhC,SAAS+K,MAAMzyB,EAAGqI,EAAGoc,EAAGiD,GAClB1nB,IAAMqI,EACRqf,EAAE3rB,KAAK,CAACU,EAAGgoB,EAAE1oB,KAAK6F,IAAI6iB,GAAK,SAAU,KAAMwO,GAAY,EAAGtpB,EAAG,WAAO3J,EAAGqI,KAC9DA,GACToc,EAAE1oB,KAAK6F,IAAI6iB,GAAK,SAAWpc,EAAI4qB,EAEnC,CAiBER,CAAMzyB,EAAEyyB,MAAOpqB,EAAEoqB,MAAOhO,EAAGiD,GAf7B,SAASjQ,MAAM0b,EAAIC,EAAIC,EAAIC,EAAI7O,EAAGiD,GAChC,GAAIyL,IAAOE,GAAMD,IAAOE,EAAI,CAC1B,IAAI72B,EAAIgoB,EAAE1oB,KAAK6F,IAAI6iB,GAAK,SAAU,KAAM,IAAK,KAAM,KACnDiD,EAAE3rB,KAAK,CAACU,EAAGA,EAAI,EAAGkN,EAAG,WAAOwpB,EAAIE,IAAM,CAAC52B,EAAGA,EAAI,EAAGkN,EAAG,WAAOypB,EAAIE,IACjE,MAAkB,IAAPD,GAAmB,IAAPC,GACrB7O,EAAE1oB,KAAK6F,IAAI6iB,GAAK,SAAW4O,EAAK,IAAMC,EAAK,IAE/C,CASE7b,CAAMzX,EAAE0yB,OAAQ1yB,EAAE2yB,OAAQtqB,EAAEqqB,OAAQrqB,EAAEsqB,OAAQlO,EAAGiD,GACjD1nB,EAAIqI,EAAI,KACD,SAASvI,GAEd,IADA,IAA0BC,EAAtBtD,GAAK,EAAGmD,EAAI8nB,EAAEhrB,SACTD,EAAImD,GAAG6kB,GAAG1kB,EAAI2nB,EAAEjrB,IAAIA,GAAKsD,EAAE4J,EAAE7J,GACtC,OAAO2kB,EAAE/jB,KAAK,GAChB,CACF,CACF,CAEO,IAAI6yB,GAA0BV,qBDxD9B,SAASW,SAASpzB,GACvB,MAAMoD,EAAI,IAA0B,mBAAdiwB,UAA2BA,UAAYC,iBAAiBtzB,EAAQ,IACtF,OAAOoD,EAAEmwB,WAAa,GAAWC,UAAUpwB,EAAExD,EAAGwD,EAAE6E,EAAG7E,EAAE8C,EAAG9C,EAAEnE,EAAGmE,EAAEpE,EAAGoE,EAAEY,EACxE,ECqDoE,OAAQ,MAAO,QACxEyvB,GAA0BhB,qBDpD9B,SAASiB,SAAS1zB,GACvB,OAAa,MAATA,EAAsB,IACrBiyB,KAASA,GAAUpzB,SAASiR,gBAAgB,6BAA8B,MAC/EmiB,GAAQj2B,aAAa,YAAagE,IAC5BA,EAAQiyB,GAAQxJ,UAAUkL,QAAQC,eAEjCJ,WADPxzB,EAAQA,EAAM6zB,QACSj0B,EAAGI,EAAMiI,EAAGjI,EAAMkG,EAAGlG,EAAMf,EAAGe,EAAMhB,EAAGgB,EAAMgE,GAFL,GAGjE,EC6CoE,KAAM,IAAK,KC5D/E,SAAS8vB,YAAYl4B,EAAI6H,GACvB,IAAIswB,EAAQC,EACZ,OAAO,WACL,IAAItC,EAAW,aAAIxyB,KAAMtD,GACrB61B,EAAQC,EAASD,MAKrB,GAAIA,IAAUsC,EAEZ,IAAK,IAAI13B,EAAI,EAAGmD,GADhBw0B,EAASD,EAAStC,GACSn1B,OAAQD,EAAImD,IAAKnD,EAC1C,GAAI23B,EAAO33B,GAAGoH,OAASA,EAAM,EAC3BuwB,EAASA,EAAOtrB,SACT/K,OAAOtB,EAAG,GACjB,KACF,CAIJq1B,EAASD,MAAQuC,CACnB,CACF,CAEA,SAASC,cAAcr4B,EAAI6H,EAAMzD,GAC/B,IAAI+zB,EAAQC,EACZ,GAAqB,mBAAVh0B,EAAsB,MAAM,IAAI2F,MAC3C,OAAO,WACL,IAAI+rB,EAAW,aAAIxyB,KAAMtD,GACrB61B,EAAQC,EAASD,MAKrB,GAAIA,IAAUsC,EAAQ,CACpBC,GAAUD,EAAStC,GAAO/oB,QAC1B,IAAK,IAAIhJ,EAAI,CAAC+D,KAAMA,EAAMzD,MAAOA,GAAQ3D,EAAI,EAAGmD,EAAIw0B,EAAO13B,OAAQD,EAAImD,IAAKnD,EAC1E,GAAI23B,EAAO33B,GAAGoH,OAASA,EAAM,CAC3BuwB,EAAO33B,GAAKqD,EACZ,KACF,CAEErD,IAAMmD,GAAGw0B,EAAOr4B,KAAK+D,EAC3B,CAEAgyB,EAASD,MAAQuC,CACnB,CACF,CAoBO,SAASE,WAAWC,EAAY1wB,EAAMzD,GAC3C,IAAIpE,EAAKu4B,EAAWC,IAOpB,OALAD,EAAWlf,KAAK,WACd,IAAIyc,EAAW,aAAIxyB,KAAMtD,IACxB81B,EAAS1xB,QAAU0xB,EAAS1xB,MAAQ,CAAC,IAAIyD,GAAQzD,EAAMqG,MAAMnH,KAAM8N,UACtE,GAEO,SAASpD,GACd,OAAO,aAAIA,EAAMhO,GAAIoE,MAAMyD,EAC7B,CACF,CC7Ee,gCAAS7D,EAAGqI,GACzB,IAAI/B,EACJ,OAAqB,iBAAN+B,EAAiB,WAC1BA,aAAa,YAAQ,IACpB/B,EAAI,YAAM+B,KAAOA,EAAI/B,EAAG,IACzB,QAAmBtG,EAAGqI,EAC9B,CCJA,SAAS,gBAAWxE,GAClB,OAAO,WACLvE,KAAKsN,gBAAgB/I,EACvB,CACF,CAEA,SAAS,kBAAaiJ,GACpB,OAAO,WACLxN,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,MAClD,CACF,CAEA,SAAS,kBAAa7I,EAAMykB,EAAamM,GACvC,IAAIC,EAEAC,EADAC,EAAUH,EAAS,GAEvB,OAAO,WACL,IAAII,EAAUv1B,KAAKqP,aAAa9K,GAChC,OAAOgxB,IAAYD,EAAU,KACvBC,IAAYH,EAAWC,EACvBA,EAAerM,EAAYoM,EAAWG,EAASJ,EACvD,CACF,CAEA,SAAS,oBAAe3nB,EAAUwb,EAAamM,GAC7C,IAAIC,EAEAC,EADAC,EAAUH,EAAS,GAEvB,OAAO,WACL,IAAII,EAAUv1B,KAAKiW,eAAezI,EAASL,MAAOK,EAASJ,OAC3D,OAAOmoB,IAAYD,EAAU,KACvBC,IAAYH,EAAWC,EACvBA,EAAerM,EAAYoM,EAAWG,EAASJ,EACvD,CACF,CAEA,SAAS,kBAAa5wB,EAAMykB,EAAaloB,GACvC,IAAIs0B,EACAI,EACAH,EACJ,OAAO,WACL,IAAIE,EAA+BD,EAAtBH,EAASr0B,EAAMd,MAC5B,GAAc,MAAVm1B,EAGJ,OAFAI,EAAUv1B,KAAKqP,aAAa9K,OAC5B+wB,EAAUH,EAAS,IACU,KACvBI,IAAYH,GAAYE,IAAYE,EAAWH,GAC9CG,EAAWF,EAASD,EAAerM,EAAYoM,EAAWG,EAASJ,IAL1Cn1B,KAAKsN,gBAAgB/I,EAMvD,CACF,CAEA,SAAS,oBAAeiJ,EAAUwb,EAAaloB,GAC7C,IAAIs0B,EACAI,EACAH,EACJ,OAAO,WACL,IAAIE,EAA+BD,EAAtBH,EAASr0B,EAAMd,MAC5B,GAAc,MAAVm1B,EAGJ,OAFAI,EAAUv1B,KAAKiW,eAAezI,EAASL,MAAOK,EAASJ,WACvDkoB,EAAUH,EAAS,IACU,KACvBI,IAAYH,GAAYE,IAAYE,EAAWH,GAC9CG,EAAWF,EAASD,EAAerM,EAAYoM,EAAWG,EAASJ,IAL1Cn1B,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,MAMlF,CACF,CCvDA,SAASqoB,YAAYjoB,EAAU1M,GAC7B,IAAI6tB,EAAI3a,EACR,SAASue,QACP,IAAIp1B,EAAI2D,EAAMqG,MAAMnH,KAAM8N,WAE1B,OADI3Q,IAAM6W,IAAI2a,GAAM3a,EAAK7W,IAV7B,SAASu4B,kBAAkBloB,EAAUrQ,GACnC,OAAO,SAASqD,GACdR,KAAK4N,eAAeJ,EAASL,MAAOK,EAASJ,MAAOjQ,EAAEqG,KAAKxD,KAAMQ,GACnE,CACF,CAMmCk1B,CAAkBloB,EAAUrQ,IACpDwxB,CACT,CAEA,OADA4D,MAAMoD,OAAS70B,EACRyxB,KACT,CAEA,SAASqD,UAAUrxB,EAAMzD,GACvB,IAAI6tB,EAAI3a,EACR,SAASue,QACP,IAAIp1B,EAAI2D,EAAMqG,MAAMnH,KAAM8N,WAE1B,OADI3Q,IAAM6W,IAAI2a,GAAM3a,EAAK7W,IA3B7B,SAAS04B,gBAAgBtxB,EAAMpH,GAC7B,OAAO,SAASqD,GACdR,KAAKlD,aAAayH,EAAMpH,EAAEqG,KAAKxD,KAAMQ,GACvC,CACF,CAuBmCq1B,CAAgBtxB,EAAMpH,IAC9CwxB,CACT,CAEA,OADA4D,MAAMoD,OAAS70B,EACRyxB,KACT,CChCA,SAASuD,cAAcp5B,EAAIoE,GACzB,OAAO,WACL+xB,KAAK7yB,KAAMtD,GAAI40B,OAASxwB,EAAMqG,MAAMnH,KAAM8N,UAC5C,CACF,CAEA,SAASioB,cAAcr5B,EAAIoE,GACzB,OAAOA,GAASA,EAAO,WACrB+xB,KAAK7yB,KAAMtD,GAAI40B,MAAQxwB,CACzB,CACF,CCVA,SAASk1B,iBAAiBt5B,EAAIoE,GAC5B,OAAO,WACL,aAAId,KAAMtD,GAAIi2B,UAAY7xB,EAAMqG,MAAMnH,KAAM8N,UAC9C,CACF,CAEA,SAASmoB,iBAAiBv5B,EAAIoE,GAC5B,OAAOA,GAASA,EAAO,WACrB,aAAId,KAAMtD,GAAIi2B,SAAW7xB,CAC3B,CACF,CCVA,IAAI,GAAY,EAAU4F,UAAUrC,YCiBpC,SAAS,kBAAYE,GACnB,OAAO,WACLvE,KAAKgG,MAAMkI,eAAe3J,EAC5B,CACF,CCDA,IAAI7H,GAAK,EAEF,SAASw5B,WAAWvjB,EAAQC,EAASrO,EAAM7H,GAChDsD,KAAK6S,QAAUF,EACf3S,KAAK8S,SAAWF,EAChB5S,KAAKm2B,MAAQ5xB,EACbvE,KAAKk1B,IAAMx4B,CACb,CAMO,SAAS05B,QACd,QAAS15B,EACX,CAEA,IAAI25B,GAAsB,EAAU3vB,UAEpCwvB,WAAWxvB,UAVI,SAAS,sBAAWnC,GACjC,OAAO,IAAY0wB,WAAW1wB,EAChC,EAQkCmC,UAAY,CAC5CrC,YAAa6xB,WACbljB,OCvCa,2BAASA,GACtB,IAAIzO,EAAOvE,KAAKm2B,MACZz5B,EAAKsD,KAAKk1B,IAEQ,mBAAXliB,IAAuBA,EAAS7I,SAAS6I,IAEpD,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAiF9G,EAAMwI,EAAnFzH,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,IAAIlI,MAAMhJ,GAAmBnD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9GuN,EAAOe,EAAMtO,MAAQ+V,EAAUF,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,MAClE,aAAcf,IAAMwI,EAAQ3H,SAAWb,EAAKa,UAChD4H,EAAShW,GAAK+V,EACdsf,SAASrf,EAAShW,GAAIoH,EAAM7H,EAAIS,EAAGgW,EAAU,aAAIzI,EAAMhO,KAK7D,OAAO,IAAIw5B,WAAWjjB,EAAWjT,KAAK8S,SAAUvO,EAAM7H,EACxD,EDuBE0W,UExCa,8BAASJ,GACtB,IAAIzO,EAAOvE,KAAKm2B,MACZz5B,EAAKsD,KAAKk1B,IAEQ,mBAAXliB,IAAuBA,EAASM,YAAYN,IAEvD,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,GAAIL,EAAU,GAAIpB,EAAI,EAAGA,EAAItN,IAAKsN,EAC/F,IAAK,IAAyC9G,EAArCe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAcD,EAAI,EAAGA,EAAImD,IAAKnD,EAClE,GAAIuN,EAAOe,EAAMtO,GAAI,CACnB,IAAK,IAA2DsP,EAAvD1B,EAAWiI,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,GAAe6qB,EAAU,aAAI5rB,EAAMhO,GAAKwD,EAAI,EAAG6H,EAAIgD,EAAS3N,OAAQ8C,EAAI6H,IAAK7H,GAC/HuM,EAAQ1B,EAAS7K,KACnBsyB,SAAS/lB,EAAOlI,EAAM7H,EAAIwD,EAAG6K,EAAUurB,GAG3CrjB,EAAUxW,KAAKsO,GACf6H,EAAQnW,KAAKiO,EACf,CAIJ,OAAO,IAAIwrB,WAAWjjB,EAAWL,EAASrO,EAAM7H,EAClD,EFoBE6W,YAAa8iB,GAAoB9iB,YACjCG,eAAgB2iB,GAAoB3iB,eACpC5I,OG5Ca,2BAAS0I,GACD,mBAAVA,IAAsBA,EAAQI,QAAQJ,IAEjD,IAAK,IAAIb,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAuE9G,EAAnEe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,GAAUrU,EAAI,EAAGA,EAAImD,IAAKnD,GAC3FuN,EAAOe,EAAMtO,KAAOqW,EAAMhQ,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,IAC1D0H,EAAS1W,KAAKiO,GAKpB,OAAO,IAAIwrB,WAAWjjB,EAAWjT,KAAK8S,SAAU9S,KAAKm2B,MAAOn2B,KAAKk1B,IACnE,EHiCEzgB,MI9Ca,0BAASwgB,GACtB,GAAIA,EAAWC,MAAQl1B,KAAKk1B,IAAK,MAAM,IAAIzuB,MAE3C,IAAK,IAAImO,EAAU5U,KAAK6S,QAASgC,EAAUogB,EAAWpiB,QAASiC,EAAKF,EAAQxX,OAAQ2X,EAAKF,EAAQzX,OAAQ8G,EAAI8Q,KAAKC,IAAIH,EAAIC,GAAKG,EAAS,IAAI5L,MAAMwL,GAAKtD,EAAI,EAAGA,EAAItN,IAAKsN,EACrK,IAAK,IAAmG9G,EAA/FyK,EAASP,EAAQpD,GAAI4D,EAASP,EAAQrD,GAAIlR,EAAI6U,EAAO/X,OAAQqX,EAAQS,EAAO1D,GAAK,IAAIlI,MAAMhJ,GAAUnD,EAAI,EAAGA,EAAImD,IAAKnD,GACxHuN,EAAOyK,EAAOhY,IAAMiY,EAAOjY,MAC7BsX,EAAMtX,GAAKuN,GAKjB,KAAO8G,EAAIsD,IAAMtD,EACf0D,EAAO1D,GAAKoD,EAAQpD,GAGtB,OAAO,IAAI0kB,WAAWhhB,EAAQlV,KAAK8S,SAAU9S,KAAKm2B,MAAOn2B,KAAKk1B,IAChE,EJ+BEniB,UF7Ca,gCACb,OAAO,IAAI,GAAU/S,KAAK6S,QAAS7S,KAAK8S,SAC1C,EE4CEmiB,WK/Ca,sBAKb,IAJA,IAAI1wB,EAAOvE,KAAKm2B,MACZI,EAAMv2B,KAAKk1B,IACXsB,EAAMJ,QAEDzjB,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQoU,EAAI,EAAGA,EAAItN,IAAKsN,EACjE,IAAK,IAAyC9G,EAArCe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAcD,EAAI,EAAGA,EAAImD,IAAKnD,EAClE,GAAIuN,EAAOe,EAAMtO,GAAI,CACnB,IAAIm5B,EAAU,aAAI5rB,EAAM6rB,GACxB/D,SAAS9nB,EAAMnG,EAAMiyB,EAAKr5B,EAAGsO,EAAO,CAClC8lB,KAAM+E,EAAQ/E,KAAO+E,EAAQhF,MAAQgF,EAAQ3D,SAC7CrB,MAAO,EACPqB,SAAU2D,EAAQ3D,SAClBC,KAAM0D,EAAQ1D,MAElB,CAIJ,OAAO,IAAIsD,WAAWvjB,EAAQ3S,KAAK8S,SAAUvO,EAAMiyB,EACrD,EL4BEhzB,KAAM6yB,GAAoB7yB,KAC1BqS,MAAOwgB,GAAoBxgB,MAC3BnL,KAAM2rB,GAAoB3rB,KAC1BoL,KAAMugB,GAAoBvgB,KAC1BxL,MAAO+rB,GAAoB/rB,MAC3ByL,KAAMsgB,GAAoBtgB,KAC1BzE,GMhCa,uBAAS/M,EAAMoN,GAC5B,IAAIjV,EAAKsD,KAAKk1B,IAEd,OAAOpnB,UAAU1Q,OAAS,EACpB,aAAI4C,KAAK0K,OAAQhO,GAAI4U,GAAGA,GAAG/M,GAC3BvE,KAAK+V,KApBb,SAAS0gB,WAAW/5B,EAAI6H,EAAMoN,GAC5B,IAAI+kB,EAAKC,EAAKC,EAThB,SAAS9d,MAAMvU,GACb,OAAQA,EAAO,IAAIwK,OAAOC,MAAM,SAAS6nB,MAAM,SAASr2B,GACtD,IAAIrD,EAAIqD,EAAEyM,QAAQ,KAElB,OADI9P,GAAK,IAAGqD,EAAIA,EAAEgJ,MAAM,EAAGrM,KACnBqD,GAAW,UAANA,CACf,EACF,CAGsBsY,CAAMvU,GAAQsuB,KAAO,aACzC,OAAO,WACL,IAAIL,EAAWoE,EAAI52B,KAAMtD,GACrB4U,EAAKkhB,EAASlhB,GAKdA,IAAOolB,IAAMC,GAAOD,EAAMplB,GAAIkH,QAAQlH,GAAG/M,EAAMoN,GAEnD6gB,EAASlhB,GAAKqlB,CAChB,CACF,CAOkBF,CAAW/5B,EAAI6H,EAAMoN,GACvC,EN2BEqE,KNaa,yBAASzR,EAAMzD,GAC5B,IAAI0M,EAAWsD,UAAUvM,GAAOpH,EAAiB,cAAbqQ,EAA2B,GAAuB,uBACtF,OAAOxN,KAAK41B,UAAUrxB,EAAuB,mBAAVzD,GAC5B0M,EAASJ,MAAQ,oBAAiB,mBAAcI,EAAUrQ,EAAG63B,WAAWh1B,KAAM,QAAUuE,EAAMzD,IACtF,MAATA,GAAiB0M,EAASJ,MAAQ,kBAAe,iBAAYI,IAC5DA,EAASJ,MAAQ,oBAAiB,mBAAcI,EAAUrQ,EAAG2D,GACtE,EMlBE80B,ULvBa,8BAASrxB,EAAMzD,GAC5B,IAAI4H,EAAM,QAAUnE,EACpB,GAAIuJ,UAAU1Q,OAAS,EAAG,OAAQsL,EAAM1I,KAAKuyB,MAAM7pB,KAASA,EAAIitB,OAChE,GAAa,MAAT70B,EAAe,OAAOd,KAAKuyB,MAAM7pB,EAAK,MAC1C,GAAqB,mBAAV5H,EAAsB,MAAM,IAAI2F,MAC3C,IAAI+G,EAAWsD,UAAUvM,GACzB,OAAOvE,KAAKuyB,MAAM7pB,GAAM8E,EAASJ,MAAQqoB,YAAcG,WAAWpoB,EAAU1M,GAC9E,EKiBEkF,MDQa,0BAASzB,EAAMzD,EAAOsN,GACnC,IAAIjR,EAAqB,cAAhBoH,GAAQ,IAAsB,GAAuB,uBAC9D,OAAgB,MAATzD,EAAgBd,KAClB82B,WAAWvyB,EAjElB,SAASwyB,UAAUxyB,EAAMykB,GACvB,IAAIoM,EACAI,EACAH,EACJ,OAAO,WACL,IAAIE,EAAU,WAAMv1B,KAAMuE,GACtB+wB,GAAWt1B,KAAKgG,MAAMkI,eAAe3J,GAAO,WAAMvE,KAAMuE,IAC5D,OAAOgxB,IAAYD,EAAU,KACvBC,IAAYH,GAAYE,IAAYE,EAAWH,EAC/CA,EAAerM,EAAYoM,EAAWG,EAASC,EAAWF,EAClE,CACF,CAsDwByB,CAAUxyB,EAAMpH,IACjCmU,GAAG,aAAe/M,EAAM,kBAAYA,IACpB,mBAAVzD,EAAuBd,KAC7B82B,WAAWvyB,EArClB,SAAS,oBAAcA,EAAMykB,EAAaloB,GACxC,IAAIs0B,EACAI,EACAH,EACJ,OAAO,WACL,IAAIE,EAAU,WAAMv1B,KAAMuE,GACtB4wB,EAASr0B,EAAMd,MACfs1B,EAAUH,EAAS,GAEvB,OADc,MAAVA,IAAoCn1B,KAAKgG,MAAMkI,eAAe3J,GAA9C+wB,EAAUH,EAA2C,WAAMn1B,KAAMuE,IAC9EgxB,IAAYD,EAAU,KACvBC,IAAYH,GAAYE,IAAYE,EAAWH,GAC9CG,EAAWF,EAASD,EAAerM,EAAYoM,EAAWG,EAASJ,GAC5E,CACF,CAwBwB,CAAc5wB,EAAMpH,EAAG63B,WAAWh1B,KAAM,SAAWuE,EAAMzD,KAC1EiV,KAvBP,SAASihB,iBAAiBt6B,EAAI6H,GAC5B,IAAImyB,EAAKC,EAAKM,EAAwDn4B,EAA7C4J,EAAM,SAAWnE,EAAMuN,EAAQ,OAASpJ,EACjE,OAAO,WACL,IAAI8pB,EAAW,aAAIxyB,KAAMtD,GACrB4U,EAAKkhB,EAASlhB,GACdK,EAAkC,MAAvB6gB,EAAS1xB,MAAM4H,GAAe5J,IAAWA,EAAS,kBAAYyF,SAAShD,EAKlF+P,IAAOolB,GAAOO,IAActlB,IAAWglB,GAAOD,EAAMplB,GAAIkH,QAAQlH,GAAGQ,EAAOmlB,EAAYtlB,GAE1F6gB,EAASlhB,GAAKqlB,CAChB,CACF,CASYK,CAAiBh3B,KAAKk1B,IAAK3wB,IACjCvE,KACC82B,WAAWvyB,EApDlB,SAAS,oBAAcA,EAAMykB,EAAamM,GACxC,IAAIC,EAEAC,EADAC,EAAUH,EAAS,GAEvB,OAAO,WACL,IAAII,EAAU,WAAMv1B,KAAMuE,GAC1B,OAAOgxB,IAAYD,EAAU,KACvBC,IAAYH,EAAWC,EACvBA,EAAerM,EAAYoM,EAAWG,EAASJ,EACvD,CACF,CA0CwB,CAAc5wB,EAAMpH,EAAG2D,GAAQsN,GAChDkD,GAAG,aAAe/M,EAAM,KAC/B,EClBEuyB,WO5Ca,+BAASvyB,EAAMzD,EAAOsN,GACnC,IAAI1F,EAAM,UAAYnE,GAAQ,IAC9B,GAAIuJ,UAAU1Q,OAAS,EAAG,OAAQsL,EAAM1I,KAAKuyB,MAAM7pB,KAASA,EAAIitB,OAChE,GAAa,MAAT70B,EAAe,OAAOd,KAAKuyB,MAAM7pB,EAAK,MAC1C,GAAqB,mBAAV5H,EAAsB,MAAM,IAAI2F,MAC3C,OAAOzG,KAAKuyB,MAAM7pB,EAhBpB,SAASouB,WAAWvyB,EAAMzD,EAAOsN,GAC/B,IAAI5N,EAAGwT,EACP,SAASue,QACP,IAAIp1B,EAAI2D,EAAMqG,MAAMnH,KAAM8N,WAE1B,OADI3Q,IAAM6W,IAAIxT,GAAKwT,EAAK7W,IAV5B,SAAS+5B,iBAAiB3yB,EAAMpH,EAAGiR,GACjC,OAAO,SAAS5N,GACdR,KAAKgG,MAAMqI,YAAY9J,EAAMpH,EAAEqG,KAAKxD,KAAMQ,GAAI4N,EAChD,CACF,CAMkC8oB,CAAiB3yB,EAAMpH,EAAGiR,IACjD5N,CACT,CAEA,OADA+xB,MAAMoD,OAAS70B,EACRyxB,KACT,CAOyBuE,CAAWvyB,EAAMzD,EAAmB,MAAZsN,EAAmB,GAAKA,GACzE,EPuCEgI,KQ/Ca,yBAAStV,GACtB,OAAOd,KAAKuyB,MAAM,OAAyB,mBAAVzxB,EARnC,SAAS,kBAAaA,GACpB,OAAO,WACL,IAAIq0B,EAASr0B,EAAMd,MACnBA,KAAK8P,YAAwB,MAAVqlB,EAAiB,GAAKA,CAC3C,CACF,CAIQ,CAAaH,WAAWh1B,KAAM,OAAQc,IAf9C,SAAS,kBAAaA,GACpB,OAAO,WACLd,KAAK8P,YAAchP,CACrB,CACF,CAYQ,CAAsB,MAATA,EAAgB,GAAKA,EAAQ,IAClD,ER4CEq2B,US9Ca,8BAASr2B,GACtB,IAAI4H,EAAM,OACV,GAAIoF,UAAU1Q,OAAS,EAAG,OAAQsL,EAAM1I,KAAKuyB,MAAM7pB,KAASA,EAAIitB,OAChE,GAAa,MAAT70B,EAAe,OAAOd,KAAKuyB,MAAM7pB,EAAK,MAC1C,GAAqB,mBAAV5H,EAAsB,MAAM,IAAI2F,MAC3C,OAAOzG,KAAKuyB,MAAM7pB,EAhBpB,SAASyuB,UAAUr2B,GACjB,IAAI6tB,EAAI3a,EACR,SAASue,QACP,IAAIp1B,EAAI2D,EAAMqG,MAAMnH,KAAM8N,WAE1B,OADI3Q,IAAM6W,IAAI2a,GAAM3a,EAAK7W,IAV7B,SAASi6B,gBAAgBj6B,GACvB,OAAO,SAASqD,GACdR,KAAK8P,YAAc3S,EAAEqG,KAAKxD,KAAMQ,EAClC,CACF,CAMmC42B,CAAgBj6B,IACxCwxB,CACT,CAEA,OADA4D,MAAMoD,OAAS70B,EACRyxB,KACT,CAOyB4E,CAAUr2B,GACnC,ETyCEhC,OUxDa,6BACb,OAAOkB,KAAKsR,GAAG,aATjB,SAAS+lB,eAAe36B,GACtB,OAAO,WACL,IAAIuO,EAASjL,KAAKqH,WAClB,IAAK,IAAIlK,KAAK6C,KAAKsyB,aAAc,IAAKn1B,IAAMT,EAAI,OAC5CuO,GAAQA,EAAOxL,YAAYO,KACjC,CACF,CAG+Bq3B,CAAer3B,KAAKk1B,KACnD,EVuDE3C,MRda,eAAShuB,EAAMzD,GAC5B,IAAIpE,EAAKsD,KAAKk1B,IAId,GAFA3wB,GAAQ,GAEJuJ,UAAU1Q,OAAS,EAAG,CAExB,IADA,IACkCoD,EAD9B+xB,EAAQ,aAAIvyB,KAAK0K,OAAQhO,GAAI61B,MACxBp1B,EAAI,EAAGmD,EAAIiyB,EAAMn1B,OAAWD,EAAImD,IAAKnD,EAC5C,IAAKqD,EAAI+xB,EAAMp1B,IAAIoH,OAASA,EAC1B,OAAO/D,EAAEM,MAGb,OAAO,IACT,CAEA,OAAOd,KAAK+V,MAAe,MAATjV,EAAgB8zB,YAAcG,eAAer4B,EAAI6H,EAAMzD,GAC3E,EQDEwwB,MJpDa,eAASxwB,GACtB,IAAIpE,EAAKsD,KAAKk1B,IAEd,OAAOpnB,UAAU1Q,OACX4C,KAAK+V,MAAuB,mBAAVjV,EACdg1B,cACAC,eAAer5B,EAAIoE,IACvB,aAAId,KAAK0K,OAAQhO,GAAI40B,KAC7B,EI6CEqB,SHrDa,kBAAS7xB,GACtB,IAAIpE,EAAKsD,KAAKk1B,IAEd,OAAOpnB,UAAU1Q,OACX4C,KAAK+V,MAAuB,mBAAVjV,EACdk1B,iBACAC,kBAAkBv5B,EAAIoE,IAC1B,aAAId,KAAK0K,OAAQhO,GAAIi2B,QAC7B,EG8CEC,KW3Da,cAAS9xB,GACtB,IAAIpE,EAAKsD,KAAKk1B,IAEd,OAAOpnB,UAAU1Q,OACX4C,KAAK+V,KAXb,SAASuhB,aAAa56B,EAAIoE,GACxB,GAAqB,mBAAVA,EAAsB,MAAM,IAAI2F,MAC3C,OAAO,WACL,aAAIzG,KAAMtD,GAAIk2B,KAAO9xB,CACvB,CACF,CAMkBw2B,CAAa56B,EAAIoE,IAC3B,aAAId,KAAK0K,OAAQhO,GAAIk2B,IAC7B,EXsDE2E,YY3Da,gCAASz2B,GACtB,GAAqB,mBAAVA,EAAsB,MAAM,IAAI2F,MAC3C,OAAOzG,KAAK+V,KAVd,SAASwhB,YAAY76B,EAAIoE,GACvB,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WAC1B,GAAiB,mBAAN7N,EAAkB,MAAM,IAAIwG,MACvC,aAAIzG,KAAMtD,GAAIk2B,KAAO3yB,CACvB,CACF,CAImBs3B,CAAYv3B,KAAKk1B,IAAKp0B,GACzC,EZyDEomB,IapEa,eACb,IAAIwP,EAAKC,EAAKzG,EAAOlwB,KAAMtD,EAAKwzB,EAAKgF,IAAKpf,EAAOoa,EAAKpa,OACtD,OAAO,IAAIvO,QAAQ,SAASN,EAASuwB,GACnC,IAAIC,EAAS,CAAC32B,MAAO02B,GACjBtQ,EAAM,CAACpmB,MAAO,WAA4B,MAATgV,GAAY7O,GAAW,GAE5DipB,EAAKna,KAAK,WACR,IAAIyc,EAAW,aAAIxyB,KAAMtD,GACrB4U,EAAKkhB,EAASlhB,GAKdA,IAAOolB,KACTC,GAAOD,EAAMplB,GAAIkH,QACbF,EAAEmf,OAAOh7B,KAAKg7B,GAClBd,EAAIre,EAAEof,UAAUj7B,KAAKg7B,GACrBd,EAAIre,EAAE4O,IAAIzqB,KAAKyqB,IAGjBsL,EAASlhB,GAAKqlB,CAChB,GAGa,IAAT7gB,GAAY7O,GAClB,EACF,Eb2CE,CAAC3D,OAAOC,UAAW8yB,GAAoB/yB,OAAOC,WclEhD,IAAIo0B,GAAgB,CAClBpG,KAAM,KACND,MAAO,EACPqB,SAAU,IACVC,KCDK,SAASgF,WAAWp3B,GACzB,QAASA,GAAK,IAAM,EAAIA,EAAIA,EAAIA,GAAKA,GAAK,GAAKA,EAAIA,EAAI,GAAK,CAC9D,GDEA,SAAS81B,QAAQ5rB,EAAMhO,GAErB,IADA,IAAI01B,IACKA,EAAS1nB,EAAK4nB,iBAAmBF,EAASA,EAAO11B,KACxD,KAAMgO,EAAOA,EAAKrD,YAChB,MAAM,IAAIZ,MAAM,cAAc/J,eAGlC,OAAO01B,CACT,CEhBA,EAAU1rB,UAAUgxB,UCFL,6BAASnzB,GACtB,OAAOvE,KAAK+V,KAAK,WACf,cAAU/V,KAAMuE,EAClB,EACF,EDDA,EAAUmC,UAAUuuB,WFiBL,8BAAS1wB,GACtB,IAAI7H,EACA01B,EAEA7tB,aAAgB2xB,YAClBx5B,EAAK6H,EAAK2wB,IAAK3wB,EAAOA,EAAK4xB,QAE3Bz5B,EAAK05B,SAAUhE,EAASuF,IAAepG,KAAOV,MAAOtsB,EAAe,MAARA,EAAe,KAAOA,EAAO,IAG3F,IAAK,IAAIoO,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQoU,EAAI,EAAGA,EAAItN,IAAKsN,EACjE,IAAK,IAAyC9G,EAArCe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAcD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,KACfq1B,SAAS9nB,EAAMnG,EAAM7H,EAAIS,EAAGsO,EAAO2mB,GAAUkE,QAAQ5rB,EAAMhO,IAKjE,OAAO,IAAIw5B,WAAWvjB,EAAQ3S,KAAK8S,SAAUvO,EAAM7H,EACrD,EI3BA,MAAM,IAACquB,GAAKnU,IAAG,OAAK,IAAI5B,KAExB,SAAS6iB,QAAQ/3B,GACf,MAAO,EAAEA,EAAE,IAAKA,EAAE,GACpB,CAEA,SAASg4B,QAAQh4B,GACf,MAAO,CAAC+3B,QAAQ/3B,EAAE,IAAK+3B,QAAQ/3B,EAAE,IACnC,CAIW,CAAC,IAAK,KAAKmB,IAAIwQ,MAOf,CAAC,IAAK,KAAKxQ,IAAIwQ,MAOf,CAAC,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,MAAMxQ,IAAIwQ,MA8D5D,SAASA,KAAKjR,GACZ,MAAO,CAACiR,KAAMjR,EAChB,CCtGO,MACMu3B,GAAoB,CAACC,SAAS,EAAMC,SAAS,GAM3C,qBAASnmB,GACtBA,EAAMomB,iBACNpmB,EAAMqmB,0BACR,CCVA,SAASC,KAAK/tB,GACZ,QAASA,EAAI2K,KAAKqjB,IAAIhuB,IAAM,EAAIA,GAAK,CACvC,CAUA,SAAe,SAAUiuB,QAAQC,EAAKC,EAAMC,GAI1C,SAASC,KAAKC,EAAIC,GAChB,IAKIz7B,EACA07B,EANAC,EAAMH,EAAG,GAAII,EAAMJ,EAAG,GAAIK,EAAKL,EAAG,GAClCM,EAAML,EAAG,GAAIM,EAAMN,EAAG,GAAIO,EAAKP,EAAG,GAClCQ,EAAKH,EAAMH,EACXO,EAAKH,EAAMH,EACXO,EAAKF,EAAKA,EAAKC,EAAKA,EAKxB,GAAIC,EA5BO,MA6BTT,EAAI7jB,KAAKukB,IAAIJ,EAAKH,GAAMT,EACxBp7B,EAAI,SAASqD,GACX,MAAO,CACLs4B,EAAMt4B,EAAI44B,EACVL,EAAMv4B,EAAI64B,EACVL,EAAKhkB,KAAKqjB,IAAIE,EAAM/3B,EAAIq4B,GAE5B,MAIG,CACH,IAAI3P,EAAKlU,KAAK0D,KAAK4gB,GACfE,GAAML,EAAKA,EAAKH,EAAKA,EAAKP,EAAOa,IAAO,EAAIN,EAAKR,EAAOtP,GACxDuQ,GAAMN,EAAKA,EAAKH,EAAKA,EAAKP,EAAOa,IAAO,EAAIH,EAAKX,EAAOtP,GACxDC,EAAKnU,KAAKukB,IAAIvkB,KAAK0D,KAAK8gB,EAAKA,EAAK,GAAKA,GACvCpQ,EAAKpU,KAAKukB,IAAIvkB,KAAK0D,KAAK+gB,EAAKA,EAAK,GAAKA,GAC3CZ,GAAKzP,EAAKD,GAAMoP,EAChBp7B,EAAI,SAASqD,GACX,IAAI2kB,EAAI3kB,EAAIq4B,EACRa,EAAStB,KAAKjP,GACdxjB,EAAIqzB,GAAMR,EAAOtP,IAAOwQ,EAxCpC,SAASC,KAAKtvB,GACZ,QAASA,EAAI2K,KAAKqjB,IAAI,EAAIhuB,IAAM,IAAMA,EAAI,EAC5C,CAsC6CsvB,CAAKpB,EAAMpT,EAAIgE,GA5C5D,SAASyQ,KAAKvvB,GACZ,QAASA,EAAI2K,KAAKqjB,IAAIhuB,IAAM,EAAIA,GAAK,CACvC,CA0CkEuvB,CAAKzQ,IAC/D,MAAO,CACL2P,EAAMnzB,EAAIyzB,EACVL,EAAMpzB,EAAI0zB,EACVL,EAAKU,EAAStB,KAAKG,EAAMpT,EAAIgE,GAEjC,CACF,CAIA,OAFAhsB,EAAEw1B,SAAe,IAAJkG,EAAWN,EAAMvjB,KAAK6kB,MAE5B18B,CACT,CAOA,OALAu7B,KAAKH,IAAM,SAASjgB,GAClB,IAAIwhB,EAAK9kB,KAAK4B,IAAI,MAAO0B,GAAIyhB,EAAKD,EAAKA,EACvC,OAAOxB,QAAQwB,EAAIC,EAD6BA,EAAKA,EAEvD,EAEOrB,IACR,CAxDD,CAwDG1jB,KAAK6kB,MAAO,EAAG,GCpEH,qBAAS/nB,EAAOpH,GAG7B,GAFAoH,ECHa,yBAASA,GACtB,IAAIkoB,EACJ,KAAOA,EAAcloB,EAAMkoB,aAAaloB,EAAQkoB,EAChD,OAAOloB,CACT,CDDU,CAAYA,QACPvQ,IAATmJ,IAAoBA,EAAOoH,EAAMmoB,eACjCvvB,EAAM,CACR,IAAIkC,EAAMlC,EAAKwvB,iBAAmBxvB,EAClC,GAAIkC,EAAIutB,eAAgB,CACtB,IAAIC,EAAQxtB,EAAIutB,iBAGhB,OAFAC,EAAM/vB,EAAIyH,EAAMuoB,QAASD,EAAMxyB,EAAIkK,EAAMwoB,QAElC,EADPF,EAAQA,EAAMG,gBAAgB7vB,EAAK8vB,eAAeC,YACpCpwB,EAAG+vB,EAAMxyB,EACzB,CACA,GAAI8C,EAAKgwB,sBAAuB,CAC9B,IAAIC,EAAOjwB,EAAKgwB,wBAChB,MAAO,CAAC5oB,EAAMuoB,QAAUM,EAAKvjB,KAAO1M,EAAKkwB,WAAY9oB,EAAMwoB,QAAUK,EAAKE,IAAMnwB,EAAKowB,UACvF,CACF,CACA,MAAO,CAAChpB,EAAMipB,MAAOjpB,EAAMkpB,MAC7B,CEnBA,2BAAe3wB,GAAK,IAAMA,ECAX,SAAS4wB,UAAUxpB,GAAM,YACtCuoB,EAAW,OACX/zB,EAAM,UACNsjB,EAAS,SACT7S,IAEAtU,OAAO84B,iBAAiBl7B,KAAM,CAC5ByR,KAAM,CAAC3Q,MAAO2Q,EAAMxO,YAAY,EAAMC,cAAc,GACpD82B,YAAa,CAACl5B,MAAOk5B,EAAa/2B,YAAY,EAAMC,cAAc,GAClE+C,OAAQ,CAACnF,MAAOmF,EAAQhD,YAAY,EAAMC,cAAc,GACxDqmB,UAAW,CAACzoB,MAAOyoB,EAAWtmB,YAAY,EAAMC,cAAc,GAC9DoV,EAAG,CAACxX,MAAO4V,IAEf,CCbO,SAASykB,UAAUj7B,EAAGmK,EAAGzC,GAC9B5H,KAAKE,EAAIA,EACTF,KAAKqK,EAAIA,EACTrK,KAAK4H,EAAIA,CACX,CAEAuzB,UAAUz0B,UAAY,CACpBrC,YAAa82B,UACbhjB,MAAO,SAASjY,GACd,OAAa,IAANA,EAAUF,KAAO,IAAIm7B,UAAUn7B,KAAKE,EAAIA,EAAGF,KAAKqK,EAAGrK,KAAK4H,EACjE,EACAgsB,UAAW,SAASvpB,EAAGzC,GACrB,OAAa,IAANyC,EAAgB,IAANzC,EAAU5H,KAAO,IAAIm7B,UAAUn7B,KAAKE,EAAGF,KAAKqK,EAAIrK,KAAKE,EAAImK,EAAGrK,KAAK4H,EAAI5H,KAAKE,EAAI0H,EACjG,EACAT,MAAO,SAASizB,GACd,MAAO,CAACA,EAAM,GAAKp6B,KAAKE,EAAIF,KAAKqK,EAAG+vB,EAAM,GAAKp6B,KAAKE,EAAIF,KAAK4H,EAC/D,EACAwzB,OAAQ,SAAS/wB,GACf,OAAOA,EAAIrK,KAAKE,EAAIF,KAAKqK,CAC3B,EACAgxB,OAAQ,SAASzzB,GACf,OAAOA,EAAI5H,KAAKE,EAAIF,KAAK4H,CAC3B,EACAiiB,OAAQ,SAAS5gB,GACf,MAAO,EAAEA,EAAS,GAAKjJ,KAAKqK,GAAKrK,KAAKE,GAAI+I,EAAS,GAAKjJ,KAAK4H,GAAK5H,KAAKE,EACzE,EACAo7B,QAAS,SAASjxB,GAChB,OAAQA,EAAIrK,KAAKqK,GAAKrK,KAAKE,CAC7B,EACAq7B,QAAS,SAAS3zB,GAChB,OAAQA,EAAI5H,KAAK4H,GAAK5H,KAAKE,CAC7B,EACAs7B,SAAU,SAASnxB,GACjB,OAAOA,EAAEmO,OAAOV,OAAOzN,EAAE0N,QAAQ9W,IAAIjB,KAAKs7B,QAASt7B,MAAMiB,IAAIoJ,EAAEwf,OAAQxf,GACzE,EACAoxB,SAAU,SAAS7zB,GACjB,OAAOA,EAAE4Q,OAAOV,OAAOlQ,EAAEmQ,QAAQ9W,IAAIjB,KAAKu7B,QAASv7B,MAAMiB,IAAI2G,EAAEiiB,OAAQjiB,GACzE,EACA5G,SAAU,WACR,MAAO,aAAehB,KAAKqK,EAAI,IAAMrK,KAAK4H,EAAI,WAAa5H,KAAKE,EAAI,GACtE,GAGK,IAAI,GAAW,IAAIi7B,UAAU,EAAG,EAAG,GC3CnC,SAAS,0BAAcrpB,GAC5BA,EAAMqmB,0BACR,CAEe,6BAASrmB,GACtBA,EAAMomB,iBACNpmB,EAAMqmB,0BACR,CCKA,SAAS,mBAAcrmB,GACrB,QAASA,EAAM4pB,SAA0B,UAAf5pB,EAAML,MAAsBK,EAAM6pB,OAC9D,CAEA,SAAS,qBACP,IAAI77B,EAAIE,KACR,OAAIF,aAAa87B,YACf97B,EAAIA,EAAEo6B,iBAAmBp6B,GACnB+7B,aAAa,WAEV,CAAC,EADR/7B,EAAIA,EAAEg8B,QAAQrH,SACHpqB,EAAGvK,EAAE8H,GAAI,CAAC9H,EAAEuK,EAAIvK,EAAE2qB,MAAO3qB,EAAE8H,EAAI9H,EAAEi8B,SAEvC,CAAC,CAAC,EAAG,GAAI,CAACj8B,EAAE2qB,MAAMgK,QAAQ3zB,MAAOhB,EAAEi8B,OAAOtH,QAAQ3zB,QAEpD,CAAC,CAAC,EAAG,GAAI,CAAChB,EAAEk8B,YAAal8B,EAAEm8B,cACpC,CAEA,SAASC,mBACP,OAAOl8B,KAAKm8B,QAAU,EACxB,CAEA,SAASC,kBAAkBtqB,GACzB,OAAQA,EAAMuqB,QAA8B,IAApBvqB,EAAMwqB,UAAkB,IAAOxqB,EAAMwqB,UAAY,EAAI,OAAUxqB,EAAM4pB,QAAU,GAAK,EAC9G,CAEA,SAAS,wBACP,OAAOa,UAAUC,gBAAmB,iBAAkBx8B,IACxD,CAEA,SAASy8B,iBAAiBlT,EAAWmT,EAAQC,GAC3C,IAAIC,EAAMrT,EAAU+R,QAAQoB,EAAO,GAAG,IAAMC,EAAgB,GAAG,GAC3DE,EAAMtT,EAAU+R,QAAQoB,EAAO,GAAG,IAAMC,EAAgB,GAAG,GAC3DG,EAAMvT,EAAUgS,QAAQmB,EAAO,GAAG,IAAMC,EAAgB,GAAG,GAC3DI,EAAMxT,EAAUgS,QAAQmB,EAAO,GAAG,IAAMC,EAAgB,GAAG,GAC/D,OAAOpT,EAAUqK,UACfiJ,EAAMD,GAAOA,EAAMC,GAAO,EAAI7nB,KAAKC,IAAI,EAAG2nB,IAAQ5nB,KAAK4B,IAAI,EAAGimB,GAC9DE,EAAMD,GAAOA,EAAMC,GAAO,EAAI/nB,KAAKC,IAAI,EAAG6nB,IAAQ9nB,KAAK4B,IAAI,EAAGmmB,GAElE,CAEe,gBACb,IAUIC,EACAC,EACAC,EAZApyB,EAAS,mBACT4xB,EAAS,mBACTS,EAAYV,iBACZW,EAAahB,kBACbiB,EAAY,sBACZC,EAAc,CAAC,EAAGlQ,KAClBuP,EAAkB,CAAC,EAAEvP,KAAWA,KAAW,CAACA,IAAUA,MACtDuF,EAAW,IACX3J,EAAc,GACduU,EAAY,GAAS,QAAS,OAAQ,OAMtCC,EAAiB,EACjBC,EAAc,GAElB,SAAS/E,KAAK3lB,GACZA,EACKmD,SAAS,SAAUgmB,kBACnB5qB,GAAG,aAAcosB,QAAS,CAACzF,SAAS,IACpC3mB,GAAG,iBAAkBqsB,aACrBrsB,GAAG,gBAAiBssB,YACtB9yB,OAAOuyB,GACL/rB,GAAG,kBAAmBusB,cACtBvsB,GAAG,iBAAkBwsB,YACrBxsB,GAAG,iCAAkCysB,YACrC/3B,MAAM,8BAA+B,gBAC5C,CA0DA,SAASmS,MAAMoR,EAAWrpB,GAExB,OADAA,EAAI8U,KAAK4B,IAAI0mB,EAAY,GAAItoB,KAAKC,IAAIqoB,EAAY,GAAIp9B,OACzCqpB,EAAUrpB,EAAIqpB,EAAY,IAAI4R,UAAUj7B,EAAGqpB,EAAUlf,EAAGkf,EAAU3hB,EACjF,CAEA,SAASgsB,UAAUrK,EAAWoP,EAAIC,GAChC,IAAIvuB,EAAIsuB,EAAG,GAAKC,EAAG,GAAKrP,EAAUrpB,EAAG0H,EAAI+wB,EAAG,GAAKC,EAAG,GAAKrP,EAAUrpB,EACnE,OAAOmK,IAAMkf,EAAUlf,GAAKzC,IAAM2hB,EAAU3hB,EAAI2hB,EAAY,IAAI4R,UAAU5R,EAAUrpB,EAAGmK,EAAGzC,EAC5F,CAEA,SAASo2B,SAAStB,GAChB,MAAO,GAAGA,EAAO,GAAG,KAAMA,EAAO,GAAG,IAAM,IAAKA,EAAO,GAAG,KAAMA,EAAO,GAAG,IAAM,EACjF,CAEA,SAASlK,SAASyC,EAAY1L,EAAW6Q,EAAOtoB,GAC9CmjB,EACK3jB,GAAG,aAAc,WAAa2sB,QAAQj+B,KAAM8N,WAAWgE,MAAMA,GAAOgH,OAAS,GAC7ExH,GAAG,0BAA2B,WAAa2sB,QAAQj+B,KAAM8N,WAAWgE,MAAMA,GAAOoV,KAAO,GACxFqL,MAAM,OAAQ,WACb,IAAIrC,EAAOlwB,KACPmwB,EAAOriB,UACP4W,EAAIuZ,QAAQ/N,EAAMC,GAAMre,MAAMA,GAC9BhS,EAAI48B,EAAOv1B,MAAM+oB,EAAMC,GACvBnrB,EAAa,MAATo1B,EAAgB4D,SAASl+B,GAAsB,mBAAVs6B,EAAuBA,EAAMjzB,MAAM+oB,EAAMC,GAAQiK,EAC1Fh1B,EAAI4P,KAAK4B,IAAI9W,EAAE,GAAG,GAAKA,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAKA,EAAE,GAAG,IAC/CY,EAAIwvB,EAAKiM,OACTpzB,EAAyB,mBAAdwgB,EAA2BA,EAAUpiB,MAAM+oB,EAAMC,GAAQ5G,EACpEpsB,EAAI6rB,EAAYtoB,EAAEmpB,OAAO7kB,GAAGnH,OAAOuH,EAAI1E,EAAER,GAAI6I,EAAE8gB,OAAO7kB,GAAGnH,OAAOuH,EAAI2D,EAAE7I,IAC1E,OAAO,SAASM,GACd,GAAU,IAANA,EAASA,EAAIuI,MACZ,CAAE,IAAIhB,EAAI5K,EAAEqD,GAAIN,EAAIkF,EAAI2C,EAAE,GAAIvH,EAAI,IAAI26B,UAAUj7B,EAAG8E,EAAE,GAAK+C,EAAE,GAAK7H,EAAG8E,EAAE,GAAK+C,EAAE,GAAK7H,EAAI,CAC3FwkB,EAAEgU,KAAK,KAAMl4B,EACf,CACF,EACN,CAEA,SAASy9B,QAAQ/N,EAAMC,EAAM+N,GAC3B,OAASA,GAAShO,EAAKiO,WAAc,IAAIC,QAAQlO,EAAMC,EACzD,CAEA,SAASiO,QAAQlO,EAAMC,GACrBnwB,KAAKkwB,KAAOA,EACZlwB,KAAKmwB,KAAOA,EACZnwB,KAAK8yB,OAAS,EACd9yB,KAAKg6B,YAAc,KACnBh6B,KAAK08B,OAASA,EAAOv1B,MAAM+oB,EAAMC,GACjCnwB,KAAKq+B,KAAO,CACd,CA8CA,SAASX,QAAQ5rB,KAAUqe,GACzB,GAAKrlB,EAAO3D,MAAMnH,KAAM8N,WAAxB,CACA,IAAI4W,EAAIuZ,QAAQj+B,KAAMmwB,GAAMre,MAAMA,GAC9BtR,EAAIR,KAAKm8B,OACTj8B,EAAI8U,KAAK4B,IAAI0mB,EAAY,GAAItoB,KAAKC,IAAIqoB,EAAY,GAAI98B,EAAEN,EAAI8U,KAAKmE,IAAI,EAAGikB,EAAWj2B,MAAMnH,KAAM8N,cAC/F9I,EAAI,YAAQ8M,GAIhB,GAAI4S,EAAE4Z,MACA5Z,EAAE6Z,MAAM,GAAG,KAAOv5B,EAAE,IAAM0f,EAAE6Z,MAAM,GAAG,KAAOv5B,EAAE,KAChD0f,EAAE6Z,MAAM,GAAK/9B,EAAEqpB,OAAOnF,EAAE6Z,MAAM,GAAKv5B,IAErC8sB,aAAapN,EAAE4Z,WAIZ,IAAI99B,EAAEN,IAAMA,EAAG,OAIlBwkB,EAAE6Z,MAAQ,CAACv5B,EAAGxE,EAAEqpB,OAAO7kB,IACvB,cAAUhF,MACV0kB,EAAE5L,OACJ,CAEA,oBAAQhH,GACR4S,EAAE4Z,MAAQtN,WAGV,SAASwN,aACP9Z,EAAE4Z,MAAQ,KACV5Z,EAAEwC,KACJ,EAvMe,KAkMfxC,EAAEgU,KAAK,QAASyE,EAAUvJ,UAAUzb,MAAM3X,EAAGN,GAAIwkB,EAAE6Z,MAAM,GAAI7Z,EAAE6Z,MAAM,IAAK7Z,EAAEgY,OAAQC,GA3B1C,CAiC5C,CAEA,SAASgB,YAAY7rB,KAAUqe,GAC7B,IAAI+M,GAAgBpyB,EAAO3D,MAAMnH,KAAM8N,WAAvC,CACA,IAAImsB,EAAgBnoB,EAAMmoB,cACtBvV,EAAIuZ,QAAQj+B,KAAMmwB,GAAM,GAAMre,MAAMA,GACpC7R,EAAI,WAAO6R,EAAM2sB,MAAMntB,GAAG,iBAW9B,SAASotB,WAAW5sB,GAElB,GADA,oBAAQA,IACH4S,EAAEia,MAAO,CACZ,IAAIvF,EAAKtnB,EAAMuoB,QAAUlM,EAAIkL,EAAKvnB,EAAMwoB,QAAUsE,EAClDla,EAAEia,MAAQvF,EAAKA,EAAKC,EAAKA,EAAKmE,CAChC,CACA9Y,EAAE5S,MAAMA,GACN4mB,KAAK,QAASyE,EAAUvJ,UAAUlP,EAAEwL,KAAKiM,OAAQzX,EAAE6Z,MAAM,GAAK,YAAQzsB,EAAOmoB,GAAgBvV,EAAE6Z,MAAM,IAAK7Z,EAAEgY,OAAQC,GACxH,GAnB4D,GAAMrrB,GAAG,eAqBrE,SAASutB,WAAW/sB,GAClB7R,EAAEqR,GAAG,8BAA+B,MCzRnC,SAASwtB,QAAQL,EAAMM,GAC5B,IAAI9iC,EAAOwiC,EAAK9+B,SAASgR,gBACrBoC,EAAY,WAAO0rB,GAAMntB,GAAG,iBAAkB,MAC9CytB,IACFhsB,EAAUzB,GAAG,aAAc,YAASymB,IACpC/G,WAAW,WAAaje,EAAUzB,GAAG,aAAc,KAAO,EAAG,IAE3D,kBAAmBrV,EACrB8W,EAAUzB,GAAG,mBAAoB,OAEjCrV,EAAK+J,MAAMg5B,cAAgB/iC,EAAKgjC,kBACzBhjC,EAAKgjC,WAEhB,CD6QM,CAAWntB,EAAM2sB,KAAM/Z,EAAEia,OACzB,oBAAQ7sB,GACR4S,EAAE5S,MAAMA,GAAOoV,KACjB,GA1BiG,GAC7FliB,EAAI,YAAQ8M,EAAOmoB,GACnB9L,EAAKrc,EAAMuoB,QACXuE,EAAK9sB,EAAMwoB,SCjRJ,gBAASmE,GACtB,IAAIxiC,EAAOwiC,EAAK9+B,SAASgR,gBACrBoC,EAAY,WAAO0rB,GAAMntB,GAAG,iBAAkB,YAASymB,IACvD,kBAAmB97B,EACrB8W,EAAUzB,GAAG,mBAAoB,YAASymB,KAE1C97B,EAAKgjC,WAAahjC,EAAK+J,MAAMg5B,cAC7B/iC,EAAK+J,MAAMg5B,cAAgB,OAE/B,CD0QI,CAAYltB,EAAM2sB,MAClB,0BAAc3sB,GACd4S,EAAE6Z,MAAQ,CAACv5B,EAAGhF,KAAKm8B,OAAOtS,OAAO7kB,IACjC,cAAUhF,MACV0kB,EAAE5L,OAZuD,CA8B3D,CAEA,SAAS8kB,WAAW9rB,KAAUqe,GAC5B,GAAKrlB,EAAO3D,MAAMnH,KAAM8N,WAAxB,CACA,IAAI6gB,EAAK3uB,KAAKm8B,OACVxD,EAAK,YAAQ7mB,EAAMotB,eAAiBptB,EAAMotB,eAAe,GAAKptB,EAAO9R,MACrE44B,EAAKjK,EAAG9E,OAAO8O,GACfwG,EAAKxQ,EAAGzuB,GAAK4R,EAAMstB,SAAW,GAAM,GACpCzZ,EAAKwX,EAAUvJ,UAAUzb,MAAMwW,EAAIwQ,GAAKxG,EAAIC,GAAK8D,EAAOv1B,MAAMnH,KAAMmwB,GAAOwM,GAE/E,oBAAQ7qB,GACJ6gB,EAAW,EAAG,WAAO3yB,MAAMi1B,aAAatC,SAASA,GAAUnvB,KAAKgvB,SAAU7M,EAAIgT,EAAI7mB,GACjF,WAAO9R,MAAMwD,KAAKk1B,KAAKnP,UAAW5D,EAAIgT,EAAI7mB,EATL,CAU5C,CAEA,SAAS+rB,aAAa/rB,KAAUqe,GAC9B,GAAKrlB,EAAO3D,MAAMnH,KAAM8N,WAAxB,CACA,IAGIuxB,EAASliC,EAAGqD,EAAGwE,EAHfs6B,EAAUxtB,EAAMwtB,QAChBh/B,EAAIg/B,EAAQliC,OACZsnB,EAAIuZ,QAAQj+B,KAAMmwB,EAAMre,EAAMotB,eAAe9hC,SAAWkD,GAAGwR,MAAMA,GAIrE,IADA,0BAAcA,GACT3U,EAAI,EAAGA,EAAImD,IAAKnD,EAEnB6H,EAAI,CADYA,EAAI,YAApBxE,EAAI8+B,EAAQniC,GAAmB6C,MACvBA,KAAKm8B,OAAOtS,OAAO7kB,GAAIxE,EAAEvD,YAC5BynB,EAAE6a,OACG7a,EAAE8a,QAAU9a,EAAE6a,OAAO,KAAOv6B,EAAE,KAAI0f,EAAE8a,OAASx6B,EAAG0f,EAAE2Z,KAAO,IADpD3Z,EAAE6a,OAASv6B,EAAGq6B,GAAU,EAAM3a,EAAE2Z,KAAO,IAAMrB,GAI1DA,IAAeA,EAAgBlL,aAAakL,IAE5CqC,IACE3a,EAAE2Z,KAAO,IAAGpB,EAAaj4B,EAAE,GAAIg4B,EAAgBhM,WAAW,WAAagM,EAAgB,IAAM,EA3QpF,MA4Qb,cAAUh9B,MACV0kB,EAAE5L,QAnBsC,CAqB5C,CAEA,SAASglB,WAAWhsB,KAAUqe,GAC5B,GAAKnwB,KAAKm+B,UAAV,CACA,IAEwBhhC,EAAGqD,EAAGwE,EAAG+C,EAF7B2c,EAAIuZ,QAAQj+B,KAAMmwB,GAAMre,MAAMA,GAC9BwtB,EAAUxtB,EAAMotB,eAChB5+B,EAAIg/B,EAAQliC,OAGhB,IADA,oBAAQ0U,GACH3U,EAAI,EAAGA,EAAImD,IAAKnD,EACH6H,EAAI,YAApBxE,EAAI8+B,EAAQniC,GAAmB6C,MAC3B0kB,EAAE6a,QAAU7a,EAAE6a,OAAO,KAAO/+B,EAAEvD,WAAYynB,EAAE6a,OAAO,GAAKv6B,EACnD0f,EAAE8a,QAAU9a,EAAE8a,OAAO,KAAOh/B,EAAEvD,aAAYynB,EAAE8a,OAAO,GAAKx6B,GAGnE,GADAxE,EAAIkkB,EAAEwL,KAAKiM,OACPzX,EAAE8a,OAAQ,CACZ,IAAI7G,EAAKjU,EAAE6a,OAAO,GAAIE,EAAK/a,EAAE6a,OAAO,GAChC3G,EAAKlU,EAAE8a,OAAO,GAAIE,EAAKhb,EAAE8a,OAAO,GAChCG,GAAMA,EAAK/G,EAAG,GAAKD,EAAG,IAAMgH,GAAMA,EAAK/G,EAAG,GAAKD,EAAG,IAAMgH,EACxDC,GAAMA,EAAKF,EAAG,GAAKD,EAAG,IAAMG,GAAMA,EAAKF,EAAG,GAAKD,EAAG,IAAMG,EAC5Dp/B,EAAI2X,MAAM3X,EAAGwU,KAAK0D,KAAKinB,EAAKC,IAC5B56B,EAAI,EAAE2zB,EAAG,GAAKC,EAAG,IAAM,GAAID,EAAG,GAAKC,EAAG,IAAM,GAC5C7wB,EAAI,EAAE03B,EAAG,GAAKC,EAAG,IAAM,GAAID,EAAG,GAAKC,EAAG,IAAM,EAC9C,KACK,KAAIhb,EAAE6a,OACN,OADcv6B,EAAI0f,EAAE6a,OAAO,GAAIx3B,EAAI2c,EAAE6a,OAAO,EACtC,CAEX7a,EAAEgU,KAAK,QAASyE,EAAUvJ,UAAUpzB,EAAGwE,EAAG+C,GAAI2c,EAAEgY,OAAQC,GAxB7B,CAyB7B,CAEA,SAASoB,WAAWjsB,KAAUqe,GAC5B,GAAKnwB,KAAKm+B,UAAV,CACA,IAEwBhhC,EAAGqD,EAFvBkkB,EAAIuZ,QAAQj+B,KAAMmwB,GAAMre,MAAMA,GAC9BwtB,EAAUxtB,EAAMotB,eAChB5+B,EAAIg/B,EAAQliC,OAKhB,IAHA,0BAAc0U,GACVorB,GAAapL,aAAaoL,GAC9BA,EAAclM,WAAW,WAAakM,EAAc,IAAM,EArT3C,KAsTV//B,EAAI,EAAGA,EAAImD,IAAKnD,EACnBqD,EAAI8+B,EAAQniC,GACRunB,EAAE6a,QAAU7a,EAAE6a,OAAO,KAAO/+B,EAAEvD,kBAAmBynB,EAAE6a,OAC9C7a,EAAE8a,QAAU9a,EAAE8a,OAAO,KAAOh/B,EAAEvD,mBAAmBynB,EAAE8a,OAG9D,GADI9a,EAAE8a,SAAW9a,EAAE6a,SAAQ7a,EAAE6a,OAAS7a,EAAE8a,cAAe9a,EAAE8a,QACrD9a,EAAE6a,OAAQ7a,EAAE6a,OAAO,GAAKv/B,KAAKm8B,OAAOtS,OAAOnF,EAAE6a,OAAO,SAItD,GAFA7a,EAAEwC,MAEa,IAAXxC,EAAE2Z,OACJ79B,EAAI,YAAQA,EAAGR,MACXgV,KAAK6qB,MAAM5C,EAAW,GAAKz8B,EAAE,GAAIy8B,EAAW,GAAKz8B,EAAE,IAAMi9B,GAAa,CACxE,IAAIz4B,EAAI,WAAOhF,MAAMsR,GAAG,iBACpBtM,GAAGA,EAAEmC,MAAMnH,KAAM8N,UACvB,CAvBuB,CA0B7B,CAmDA,OAzWA4qB,KAAKnP,UAAY,SAASuW,EAAYvW,EAAW6Q,EAAOtoB,GACtD,IAAIiB,EAAY+sB,EAAW/sB,UAAY+sB,EAAW/sB,YAAc+sB,EAChE/sB,EAAUmD,SAAS,SAAUgmB,kBACzB4D,IAAe/sB,EACjByf,SAASsN,EAAYvW,EAAW6Q,EAAOtoB,GAEvCiB,EAAU2kB,YAAY3hB,KAAK,WACzBkoB,QAAQj+B,KAAM8N,WACXgE,MAAMA,GACNgH,QACA4f,KAAK,KAA2B,mBAAdnP,EAA2BA,EAAUpiB,MAAMnH,KAAM8N,WAAayb,GAChFrC,KACL,EAEJ,EAEAwR,KAAKqH,QAAU,SAAShtB,EAAW7S,EAAG8E,EAAG8M,GACvC4mB,KAAKsH,QAAQjtB,EAAW,WAGtB,OAFS/S,KAAKm8B,OAAOj8B,GACC,mBAANA,EAAmBA,EAAEiH,MAAMnH,KAAM8N,WAAa5N,EAEhE,EAAG8E,EAAG8M,EACR,EAEA4mB,KAAKsH,QAAU,SAASjtB,EAAW7S,EAAG8E,EAAG8M,GACvC4mB,KAAKnP,UAAUxW,EAAW,WACxB,IAAIjT,EAAI48B,EAAOv1B,MAAMnH,KAAM8N,WACvB6gB,EAAK3uB,KAAKm8B,OACVxD,EAAU,MAAL3zB,EAAYg5B,SAASl+B,GAAkB,mBAANkF,EAAmBA,EAAEmC,MAAMnH,KAAM8N,WAAa9I,EACpF4zB,EAAKjK,EAAG9E,OAAO8O,GACfwG,EAAkB,mBAANj/B,EAAmBA,EAAEiH,MAAMnH,KAAM8N,WAAa5N,EAC9D,OAAOi9B,EAAUvJ,UAAUzb,MAAMwW,EAAIwQ,GAAKxG,EAAIC,GAAK94B,EAAG68B,EACxD,EAAG33B,EAAG8M,EACR,EAEA4mB,KAAKuH,YAAc,SAASltB,EAAW1I,EAAGzC,EAAGkK,GAC3C4mB,KAAKnP,UAAUxW,EAAW,WACxB,OAAOoqB,EAAUn9B,KAAKm8B,OAAOvI,UACd,mBAANvpB,EAAmBA,EAAElD,MAAMnH,KAAM8N,WAAazD,EACxC,mBAANzC,EAAmBA,EAAET,MAAMnH,KAAM8N,WAAalG,GACpD80B,EAAOv1B,MAAMnH,KAAM8N,WAAY6uB,EACpC,EAAG,KAAM7qB,EACX,EAEA4mB,KAAKwH,YAAc,SAASntB,EAAW1I,EAAGzC,EAAG5C,EAAG8M,GAC9C4mB,KAAKnP,UAAUxW,EAAW,WACxB,IAAIjT,EAAI48B,EAAOv1B,MAAMnH,KAAM8N,WACvBtN,EAAIR,KAAKm8B,OACTxD,EAAU,MAAL3zB,EAAYg5B,SAASl+B,GAAkB,mBAANkF,EAAmBA,EAAEmC,MAAMnH,KAAM8N,WAAa9I,EACxF,OAAOm4B,EAAU,GAASvJ,UAAU+E,EAAG,GAAIA,EAAG,IAAIxgB,MAAM3X,EAAEN,GAAG0zB,UAC9C,mBAANvpB,GAAoBA,EAAElD,MAAMnH,KAAM8N,YAAczD,EAC1C,mBAANzC,GAAoBA,EAAET,MAAMnH,KAAM8N,YAAclG,GACtD9H,EAAG68B,EACR,EAAG33B,EAAG8M,EACR,EAmDAssB,QAAQ13B,UAAY,CAClBoL,MAAO,SAASA,GAEd,OADIA,IAAO9R,KAAKg6B,YAAcloB,GACvB9R,IACT,EACA8Y,MAAO,WAKL,OAJsB,MAAhB9Y,KAAK8yB,SACT9yB,KAAKkwB,KAAKiO,UAAYn+B,KACtBA,KAAKmgC,KAAK,UAELngC,IACT,EACA04B,KAAM,SAAShwB,EAAK6gB,GAMlB,OALIvpB,KAAKu+B,OAAiB,UAAR71B,IAAiB1I,KAAKu+B,MAAM,GAAKhV,EAAUM,OAAO7pB,KAAKu+B,MAAM,KAC3Ev+B,KAAKu/B,QAAkB,UAAR72B,IAAiB1I,KAAKu/B,OAAO,GAAKhW,EAAUM,OAAO7pB,KAAKu/B,OAAO,KAC9Ev/B,KAAKw/B,QAAkB,UAAR92B,IAAiB1I,KAAKw/B,OAAO,GAAKjW,EAAUM,OAAO7pB,KAAKw/B,OAAO,KAClFx/B,KAAKkwB,KAAKiM,OAAS5S,EACnBvpB,KAAKmgC,KAAK,QACHngC,IACT,EACAknB,IAAK,WAKH,OAJsB,MAAhBlnB,KAAK8yB,gBACF9yB,KAAKkwB,KAAKiO,UACjBn+B,KAAKmgC,KAAK,QAELngC,IACT,EACAmgC,KAAM,SAAS1uB,GACb,IAAI1R,EAAI,WAAOC,KAAKkwB,MAAMhlB,QAC1BqyB,EAAU/5B,KACRiO,EACAzR,KAAKkwB,KACL,IAAI+K,UAAUxpB,EAAM,CAClBuoB,YAAah6B,KAAKg6B,YAClB/zB,OAAQyyB,KACRjnB,OACA8X,UAAWvpB,KAAKkwB,KAAKiM,OACrBzlB,SAAU6mB,IAEZx9B,EAEJ,GAsKF24B,KAAK0E,WAAa,SAAS9kB,GACzB,OAAOxK,UAAU1Q,QAAUggC,EAA0B,mBAAN9kB,EAAmBA,EAAI,sBAAUA,GAAIogB,MAAQ0E,CAC9F,EAEA1E,KAAK5tB,OAAS,SAASwN,GACrB,OAAOxK,UAAU1Q,QAAU0N,EAAsB,mBAANwN,EAAmBA,EAAI,uBAAWA,GAAIogB,MAAQ5tB,CAC3F,EAEA4tB,KAAK2E,UAAY,SAAS/kB,GACxB,OAAOxK,UAAU1Q,QAAUigC,EAAyB,mBAAN/kB,EAAmBA,EAAI,uBAAWA,GAAIogB,MAAQ2E,CAC9F,EAEA3E,KAAKgE,OAAS,SAASpkB,GACrB,OAAOxK,UAAU1Q,QAAUs/B,EAAsB,mBAANpkB,EAAmBA,EAAI,qBAAS,CAAC,EAAEA,EAAE,GAAG,IAAKA,EAAE,GAAG,IAAK,EAAEA,EAAE,GAAG,IAAKA,EAAE,GAAG,MAAOogB,MAAQgE,CACpI,EAEAhE,KAAK4E,YAAc,SAAShlB,GAC1B,OAAOxK,UAAU1Q,QAAUkgC,EAAY,IAAMhlB,EAAE,GAAIglB,EAAY,IAAMhlB,EAAE,GAAIogB,MAAQ,CAAC4E,EAAY,GAAIA,EAAY,GAClH,EAEA5E,KAAKiE,gBAAkB,SAASrkB,GAC9B,OAAOxK,UAAU1Q,QAAUu/B,EAAgB,GAAG,IAAMrkB,EAAE,GAAG,GAAIqkB,EAAgB,GAAG,IAAMrkB,EAAE,GAAG,GAAIqkB,EAAgB,GAAG,IAAMrkB,EAAE,GAAG,GAAIqkB,EAAgB,GAAG,IAAMrkB,EAAE,GAAG,GAAIogB,MAAQ,CAAC,CAACiE,EAAgB,GAAG,GAAIA,EAAgB,GAAG,IAAK,CAACA,EAAgB,GAAG,GAAIA,EAAgB,GAAG,IACzQ,EAEAjE,KAAKyE,UAAY,SAAS7kB,GACxB,OAAOxK,UAAU1Q,QAAU+/B,EAAY7kB,EAAGogB,MAAQyE,CACpD,EAEAzE,KAAK/F,SAAW,SAASra,GACvB,OAAOxK,UAAU1Q,QAAUu1B,GAAYra,EAAGogB,MAAQ/F,CACpD,EAEA+F,KAAK1P,YAAc,SAAS1Q,GAC1B,OAAOxK,UAAU1Q,QAAU4rB,EAAc1Q,EAAGogB,MAAQ1P,CACtD,EAEA0P,KAAKpnB,GAAK,WACR,IAAIxQ,EAAQy8B,EAAUjsB,GAAGnK,MAAMo2B,EAAWzvB,WAC1C,OAAOhN,IAAUy8B,EAAY7E,KAAO53B,CACtC,EAEA43B,KAAK0H,cAAgB,SAAS9nB,GAC5B,OAAOxK,UAAU1Q,QAAUogC,GAAkBllB,GAAKA,GAAKA,EAAGogB,MAAQ1jB,KAAK0D,KAAK8kB,EAC9E,EAEA9E,KAAK+E,YAAc,SAASnlB,GAC1B,OAAOxK,UAAU1Q,QAAUqgC,GAAenlB,EAAGogB,MAAQ+E,CACvD,EAEO/E,IACT,C,4nCE1bO,SAAS2H,YAAYC,EAAWC,GACnC,IAAI7b,EAAI4b,EAAUttB,OAAO,KAADnV,OAAM0iC,IAQ9B,OANI7b,EAAEpa,QACFoa,EAAI4b,EAAU9rB,OAAO,KAAKwB,KAAK,QAASuqB,GAExC7b,EAAEtR,UAAU,KAAKtU,SAGd4lB,CACX,CAGO,SAAS8b,cAAcr2B,EAAU+L,EAAUpV,GAE9C,IAAKqJ,EAASs2B,WAAW,OAASt2B,EAASs2B,WAAW,KAClD,MAAM,IAAIh6B,MAAM,qEAKpB,IADA,IACAtH,EAAA,EAAAuhC,EADoBp3B,MAAMG,KAAK9J,SAASghC,aACJxhC,EAAAuhC,EAAAtjC,OAAA+B,IAAE,CAAjC,IAAMG,EAAUohC,EAAAvhC,GACjB,IACI,IACwByhC,EAD6BC,EAAAC,2BAAvCxhC,EAAWyhC,UAAYzhC,EAAW0hC,OACxB,IAAxB,IAAAH,EAAA1b,MAAAyb,EAAAC,EAAAvgC,KAAAO,MAA0B,KAAfogC,EAAIL,EAAA9/B,MACX,GAAImgC,EAAKC,eAAiB/2B,EAGtB,YADA82B,EAAKj7B,MAAMkQ,GAAYpV,EAG/B,CAAC,OAAAqgC,GAAAN,EAAA/gC,EAAAqhC,EAAA,SAAAN,EAAA/7B,GAAA,CACL,CAAE,MAAOhF,GAEL,CAER,CAGA,IAAIshC,EAAczhC,SAAS0hC,eAAe,iBACrCD,KACDA,EAAczhC,SAAS8C,cAAc,UACzB/F,GAAK,gBACjBiD,SAAS6G,KAAK9G,YAAY0hC,IAI9B,IACIA,EAAYE,MAAMC,WAAW,GAAD1jC,OAAIsM,EAAQ,OAAAtM,OAAMqY,EAAQ,MAAArY,OAAKiD,EAAK,OAAOsgC,EAAYE,MAAMP,SAAS3jC,OACtG,CAAE,MAAO0C,GACL0hC,QAAQtoB,MAAM,0BAADrb,OAA2BsM,EAAQ,OAAAtM,OAAMqY,EAAQ,MAAArY,OAAKiD,EAAK,OAAOhB,EACnF,CACJ,CJVsBq7B,UAAUz0B,UIYzB,IAAM+6B,GAAuB,SAAvBA,qBAAiClB,GAE1C,IAAMmB,EAAc/hC,SAAS8C,cAAc,OAC3Ci/B,EAAYnB,UAAYA,EAGxBmB,EAAY17B,MAAM27B,SAAW,WAC7BD,EAAY17B,MAAM47B,WAAa,SAC/BF,EAAY17B,MAAM+1B,OAAS,OAC3B2F,EAAY17B,MAAMykB,MAAQ,OAC1BiX,EAAY17B,MAAM67B,WAAa,SAC/BH,EAAY17B,MAAM87B,SAAW,UAG7BniC,SAASoiC,KAAKriC,YAAYgiC,GAG1B,IAAMI,EAAWE,WAAW37B,OAAOoI,iBAAiBizB,GAAaI,UAKjE,OAFAniC,SAASoiC,KAAKtiC,YAAYiiC,GAEnBI,GAAY,CACvB,EAEaG,GAA0B,SAA1BA,wBAAoC1B,EAAW2B,GAExD,IAAMR,EAAc/hC,SAAS8C,cAAc,OAC3Ci/B,EAAYnB,UAAYA,EAGxBmB,EAAY17B,MAAM27B,SAAW,WAC7BD,EAAY17B,MAAM47B,WAAa,SAC/BF,EAAY17B,MAAM+1B,OAAS,OAE3B2F,EAAY17B,MAAM67B,WAAa,SAG/BliC,SAASoiC,KAAKriC,YAAYgiC,GAG1B,IAAMS,EAAgB97B,OAAOoI,iBAAiBizB,GAAalzB,iBAAiB0zB,GAK5E,OAFAviC,SAASoiC,KAAKtiC,YAAYiiC,GAEnBS,GAAiB,IAC5B,EAqEO,SAASC,yBAAyBx1B,GACrC,GAAKA,GAASA,aAAegvB,WAA7B,CAEA,IAAMyG,EAAc,IAAIC,IAAI,CACxB,OACA,eACA,YACA,SACA,eACA,iBACA,iBACA,kBACA,mBACA,sBAGEC,EAAQ,GAAH1kC,OAAA2kC,oCAEJl5B,MAAMG,KAAK44B,IAAY,CAE1B,gBACA,kBACA,cACA,oBAEA,cACA,YACA,aACA,cACA,iBACA,eACA,cAEA,UACA,aACA,UACA,iBAEA,SACA,eACA,aACA,aAEA,cAmCJI,oBAAoB71B,GACpBA,EAAIrC,iBAAiB,KAAKm4B,QAAQ,SAACC,GAAE,OAAKF,oBAAoBE,EAAG,EA9EjB,CA6ChD,SAASF,oBAAoBE,GACzB,IAAMC,EAAKv8B,OAAOoI,iBAAiBk0B,GAyBnC,GAvBAJ,EAAMG,QAAQ,SAAC19B,GACX,IACI,IAAM/E,EAAI2iC,EAAGp0B,iBAAiBxJ,GAG9B,IAAK/E,GAAW,KAANA,GAAkB,YAANA,EAAiB,OAGvC,GAAU,SAANA,IAAiBoiC,EAAYl2B,IAAInH,GAAI,OAGzC,GAAU,QAAN/E,GAAqB,iBAAN+E,EAAsB,OAGpC29B,EAAG38B,MAAMwI,iBAAiBxJ,IAC3B29B,EAAG38B,MAAMqI,YAAYrJ,EAAG/E,EAEhC,CAAE,MAAOH,GACL,CAER,GAGI6iC,EAAGE,SAAwC,SAA7BF,EAAGE,QAAQ1e,cAA0B,CACnD,IAAM2e,EAAKF,EAAGp0B,iBAAiB,aAC3Bs0B,IAAOH,EAAG38B,MAAMwI,iBAAiB,cAAcm0B,EAAG38B,MAAMqI,YAAY,YAAay0B,EACzF,CACJ,CAIJ,CACO,SAASC,cAAcn2B,GAC1B,IAAM+tB,EAAO/tB,EAAI8tB,wBAEXt1B,EAAI4P,KAAKuE,MAAMohB,EAAKlQ,QAAUpG,SAASzX,EAAIyC,aAAa,WAAa,IACrE6V,EAAIlQ,KAAKuE,MAAMohB,EAAKoB,SAAW1X,SAASzX,EAAIyC,aAAa,YAAc,IAGxEzC,EAAIivB,aAAa,YAClBjvB,EAAI9P,aAAa,UAAW,OAAFe,OAASuH,EAAC,KAAAvH,OAAIqnB,IAE5CtY,EAAI9P,aAAa,QAASsI,GAC1BwH,EAAI9P,aAAa,SAAUooB,EAC/B,CAUO,IAuDM8d,GAA2B,SAA3BA,yBAAqCC,GAC9C,OAAOA,EAAO/X,eAAe,MAAMC,QAAQ,MAAO,IACtD,EA4EO,SAAS+X,iBAAiBl2B,GAC7B,MAAO,GAAPnP,OAAUmP,EAAM,KAAAnP,OAAImX,KAAKmuB,SAASniC,SAAS,IAAIoiC,OAAO,EAAG,GAC7D,CAGO,IAsBMC,GAAsB,SAAtBA,oBAAgCC,EAAQC,EAAW3tB,GAA+C,IAArC4tB,EAAS11B,UAAA1Q,OAAA,QAAAmE,IAAAuM,UAAA,GAAAA,UAAA,GAAG,KAAM21B,EAAU31B,UAAA1Q,OAAA,QAAAmE,IAAAuM,UAAA,GAAAA,UAAA,GAAG,KACrG,IAAK,IAAM41B,KAAOJ,EAAQ,CACtB,IAAMK,EAAaL,EAAOI,GAEtBp6B,MAAMM,QAAQ+5B,GACdA,EAAWjB,QAAQ,SAACkB,GAEZt6B,MAAMM,QAAQg6B,GACdA,EAAMlB,QAAQ,SAACmB,GACPA,EAAYC,SAAWP,GACvB3tB,EAASiuB,EAAaL,EAAWC,EAEzC,GAEIG,EAAME,SAAWP,GACjB3tB,EAASguB,EAAOJ,EAAWC,EAGvC,GAGIE,EAAWG,SAAWP,GACtB3tB,EAAS+tB,EAAYH,EAAWC,EAG5C,CACJ,EA2EO,SAASM,mBAAmBx/B,GAC/BA,EAAOA,EAAK4mB,QAAQ,OAAQ,OAAOA,QAAQ,OAAQ,OACnD,IACI6Y,EADQ,IAAI9pB,OAAO,SAAW3V,EAAO,aACrB6f,KAAKnb,SAASg7B,QAClC,OAAQD,EAAiBE,mBAAmBF,EAAQ,GAAG7Y,QAAQ,MAAO,MAApD,IACtB,CA4EO,IAaMgZ,GAA4B,SAA5BA,0BAAsCC,GAC/C,IAAI7jC,EAAGmkB,EAAG3b,EAGV,IAAKq7B,EAAgB3D,WAAW,SAAW2D,EAAgB3D,WAAW,KAAM,CACxE,IAAM4D,EAAU1kC,SAAS8C,cAAc,OACvC4hC,EAAQr+B,MAAMihB,MAAQmd,EACtBzkC,SAASoiC,KAAKriC,YAAY2kC,GAC1B,IAAMC,EAAgBj+B,OAAOoI,iBAAiB41B,GAASpd,MACvDtnB,SAASoiC,KAAKtiC,YAAY4kC,GAC1BD,EAAkBE,CACtB,CAGA,GAAIF,EAAgB3D,WAAW,KAAM,CACjC,IAAI3b,EAAMsf,EAAgBjZ,QAAQ,IAAK,IACpB,IAAfrG,EAAI1nB,SACJ0nB,EAAMA,EACD9V,MAAM,IACN/N,IAAI,SAAC+F,GAAC,OAAKA,EAAIA,CAAC,GAChB5F,KAAK,KAEdb,EAAI8jB,SAASS,EAAI8G,UAAU,EAAG,GAAI,IAClClH,EAAIL,SAASS,EAAI8G,UAAU,EAAG,GAAI,IAClC7iB,EAAIsb,SAASS,EAAI8G,UAAU,EAAG,GAAI,GACtC,KAAO,CAEH,IAAM9H,EAAMsgB,EAAgB5wB,MAAM,QAClCjT,EAAI8jB,SAASP,EAAI,IACjBY,EAAIL,SAASP,EAAI,IACjB/a,EAAIsb,SAASP,EAAI,GACrB,CAMA,OAH4BvjB,EAAI,IAAd,MAA+BmkB,EAAI,IAAd,MAA+B3b,EAAI,IAAd,MAGzC,GAAM,QAAU,OACvC,EAGaw7B,GAAqB,SAArBA,mBAAsBtjC,GAC/B,OAAIA,EAAIujC,WAAWC,eAAuB,wBACtCxjC,EAAIyjC,eAAuB,mCACd,UAAbzjC,EAAI0jC,KAAyB,mBAC1B,yGACX,EAGaC,GAA2B,SAA3BA,yBAA4B3jC,GACrC,OAAIA,EAAIujC,WAAWC,eAAuB,mBACtCxjC,EAAIyjC,eAAuB,qBACd,UAAbzjC,EAAI0jC,KAAyB,cAC1B,uBACX,EASaE,GAA0B,SAA1BA,wBAAoC5jC,GAC7C,IAAM6jC,EAAY,GAAM7jC,EAAI8jC,UAAU/V,EAAI/tB,EAAI+jC,OACxCC,EAAa,GAAMhkC,EAAI8jC,UAAU/V,EAAI/tB,EAAIikC,QAC/C,MAAO,CAACjkC,EAAI8jC,UAAU16B,EAAIy6B,EAAW7jC,EAAI8jC,UAAUn9B,EAAIq9B,EAAYhkC,EAAI8jC,UAAU16B,EAAIy6B,EAAW7jC,EAAI8jC,UAAUn9B,EAAIq9B,EACtH,EC1rBA,SAAS7hC,QAAQ3C,GAGf,OAAO2C,QAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAU9C,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqB6C,QAAU7C,EAAE4D,cAAgBf,QAAU7C,IAAM6C,OAAOoD,UAAY,gBAAkBjG,CACpH,EAAG2C,QAAQ3C,EACb,CCNA,SAAS0kC,cAAc3kC,GACrB,IAAIrD,ECFN,SAASioC,YAAY5kC,EAAGD,GACtB,GAAI,UAAY6C,QAAQ5C,KAAOA,EAAG,OAAOA,EACzC,IAAIV,EAAIU,EAAE8C,OAAO8hC,aACjB,QAAI,IAAWtlC,EAAG,CAChB,IAAI3C,EAAI2C,EAAE0D,KAAKhD,EAAGD,GAAK,WACvB,GAAI,UAAY6C,QAAQjG,GAAI,OAAOA,EACnC,MAAM,IAAIuG,UAAU,+CACtB,CACA,OAAQ,WAAanD,EAAI8rB,OAASP,QAAQtrB,EAC5C,CDPU4kC,CAAY5kC,EAAG,UACvB,MAAO,UAAY4C,QAAQjG,GAAKA,EAAIA,EAAI,EAC1C,CEJA,SAASkoC,gBAAgBvlC,EAAGS,EAAGC,GAC7B,OAAQD,EAAI4kC,cAAc5kC,MAAOT,EAAIsC,OAAOU,eAAehD,EAAGS,EAAG,CAC/DO,MAAON,EACPyC,YAAY,EACZC,cAAc,EACdC,UAAU,IACPrD,EAAES,GAAKC,EAAGV,CACjB,CCLe,uBAASqK,GACtB,MAA2B,iBAAbA,EACR,IAAI,oBAAU,CAACxK,SAAS4K,iBAAiBJ,IAAY,CAACxK,SAASgR,kBAC/D,IAAI,oBAAU,CAACvG,MAAMD,IAAY,EACzC,CCNO,MAAMm7B,MACX,WAAAjhC,GACErE,KAAKulC,UAAY,IAAIC,aAAa,IAClCxlC,KAAKylC,GAAK,CACZ,CACA,GAAAj2B,CAAInF,GACF,MAAMrF,EAAIhF,KAAKulC,UACf,IAAIpoC,EAAI,EACR,IAAK,IAAIqU,EAAI,EAAGA,EAAIxR,KAAKylC,IAAMj0B,EAAI,GAAIA,IAAK,CAC1C,MAAM5J,EAAI5C,EAAEwM,GACV8F,EAAKjN,EAAIzC,EACTyP,EAAKrC,KAAK+V,IAAI1gB,GAAK2K,KAAK+V,IAAInjB,GAAKyC,GAAKiN,EAAK1P,GAAKA,GAAK0P,EAAKjN,GACxDgN,IAAIrS,EAAE7H,KAAOka,GACjBhN,EAAIiN,CACN,CAGA,OAFAtS,EAAE7H,GAAKkN,EACPrK,KAAKylC,GAAKtoC,EAAI,EACP6C,IACT,CACA,OAAA0oB,GACE,MAAM1jB,EAAIhF,KAAKulC,UACf,IAAiBl7B,EAAGzC,EAAGyP,EAAnB/W,EAAIN,KAAKylC,GAAcnuB,EAAK,EAChC,GAAIhX,EAAI,EAAG,CAET,IADAgX,EAAKtS,IAAI1E,GACFA,EAAI,IACT+J,EAAIiN,EACJ1P,EAAI5C,IAAI1E,GACRgX,EAAKjN,EAAIzC,EACTyP,EAAKzP,GAAK0P,EAAKjN,IACXgN,KAEF/W,EAAI,IAAO+W,EAAK,GAAKrS,EAAE1E,EAAI,GAAK,GAAO+W,EAAK,GAAKrS,EAAE1E,EAAI,GAAK,KAC9DsH,EAAS,EAALyP,EACJhN,EAAIiN,EAAK1P,EACLA,GAAKyC,EAAIiN,IAAIA,EAAKjN,GAE1B,CACA,OAAOiN,CACT,ECvCK,IAAIouB,GAAU,KACV,GAAW,MACXC,GAAK3wB,KAAKwZ,GACVoX,GAASD,GAAK,EACdE,GAAYF,GAAK,EACjB,GAAW,EAALA,GAEN,GAAU,IAAMA,GAChB,GAAUA,GAAK,IAEf,GAAM3wB,KAAK+V,IACXuI,GAAOte,KAAKse,KACZ/D,GAAQva,KAAKua,MACb,GAAMva,KAAKwa,IACXvB,GAAOjZ,KAAKiZ,KAGZ4R,IAFM7qB,KAAKqjB,IACHrjB,KAAK8B,MACL9B,KAAK6qB,OAGb,IAFM7qB,KAAKukB,IACLvkB,KAAKmE,IACLnE,KAAKya,KACXlF,GAAOvV,KAAKuV,MAAQ,SAASlgB,GAAK,OAAOA,EAAI,EAAI,EAAIA,EAAI,GAAK,EAAI,CAAG,EACrEqO,GAAO1D,KAAK0D,KACN1D,KAAKkO,IAMf,SAAS4iB,KAAKz7B,GACnB,OAAOA,EAAI,EAAIu7B,GAASv7B,GAAK,GAAKu7B,GAAS5wB,KAAK8wB,KAAKz7B,EACvD,CC/Be,SAAS,YAAQ,CCAhC,SAAS07B,eAAeC,EAAUC,GAC5BD,GAAYE,GAAmBp9B,eAAek9B,EAASv0B,OACzDy0B,GAAmBF,EAASv0B,MAAMu0B,EAAUC,EAEhD,CAEA,ICDIE,GAAIC,GACJC,GAAIC,GAAIC,GACRC,GAAIC,GAAIC,GACRC,GAAIC,GAAIC,GACRC,GAAUC,GACV5Y,GAAIyQ,GAAIoI,GDJRC,GAAmB,CACrBC,QAAS,SAASve,EAAQsd,GACxBF,eAAepd,EAAOqd,SAAUC,EAClC,EACAkB,kBAAmB,SAASxe,EAAQsd,GAElC,IADA,IAAImB,EAAWze,EAAOye,SAAUjqC,GAAK,EAAGmD,EAAI8mC,EAAShqC,SAC5CD,EAAImD,GAAGylC,eAAeqB,EAASjqC,GAAG6oC,SAAUC,EACvD,GAGEC,GAAqB,CACvBmB,OAAQ,SAAS1e,EAAQsd,GACvBA,EAAOqB,QACT,EACAC,MAAO,SAAS5e,EAAQsd,GACtBtd,EAASA,EAAO6e,YAChBvB,EAAO7L,MAAMzR,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAC5C,EACA8e,WAAY,SAAS9e,EAAQsd,GAE3B,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAGqoB,EAAS6e,EAAYrqC,GAAI8oC,EAAO7L,MAAMzR,EAAO,GAAIA,EAAO,GAAIA,EAAO,GACrF,EACA+e,WAAY,SAAS/e,EAAQsd,GAC3B0B,WAAWhf,EAAO6e,YAAavB,EAAQ,EACzC,EACA2B,gBAAiB,SAASjf,EAAQsd,GAEhC,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAGqnC,WAAWH,EAAYrqC,GAAI8oC,EAAQ,EACrD,EACA4B,QAAS,SAASlf,EAAQsd,GACxB6B,cAAcnf,EAAO6e,YAAavB,EACpC,EACA8B,aAAc,SAASpf,EAAQsd,GAE7B,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAGwnC,cAAcN,EAAYrqC,GAAI8oC,EAChD,EACA+B,mBAAoB,SAASrf,EAAQsd,GAEnC,IADA,IAAIgC,EAAatf,EAAOsf,WAAY9qC,GAAK,EAAGmD,EAAI2nC,EAAW7qC,SAClDD,EAAImD,GAAGylC,eAAekC,EAAW9qC,GAAI8oC,EAChD,GAGF,SAAS0B,WAAWH,EAAavB,EAAQiC,GACvC,IAA6CC,EAAzChrC,GAAK,EAAGmD,EAAIknC,EAAYpqC,OAAS8qC,EAErC,IADAjC,EAAOmC,cACEjrC,EAAImD,GAAG6nC,EAAaX,EAAYrqC,GAAI8oC,EAAO7L,MAAM+N,EAAW,GAAIA,EAAW,GAAIA,EAAW,IACnGlC,EAAOoC,SACT,CAEA,SAASP,cAAcN,EAAavB,GAClC,IAAI9oC,GAAK,EAAGmD,EAAIknC,EAAYpqC,OAE5B,IADA6oC,EAAOqC,iBACEnrC,EAAImD,GAAGqnC,WAAWH,EAAYrqC,GAAI8oC,EAAQ,GACnDA,EAAOsC,YACT,CAEe,gBAAS5f,EAAQsd,GAC1Btd,GAAUse,GAAiBn+B,eAAe6f,EAAOlX,MACnDw1B,GAAiBte,EAAOlX,MAAMkX,EAAQsd,GAEtCF,eAAepd,EAAQsd,EAE3B,CCxDA,IAAIuC,GAAiB,CACnBlB,OAAQ,UACRlN,MAAOqO,cACPL,UAAWM,kBACXL,QAASM,gBACTL,aAAc,WACZE,GAAeJ,UAAYQ,kBAC3BJ,GAAeH,QAAUQ,eAC3B,EACAN,WAAY,WACVC,GAAeJ,UAAYM,kBAC3BF,GAAeH,QAAUM,eAC3B,GAIF,SAASF,cAAcK,EAAQC,GAC7BD,GAAU,GACV,IAAIE,EAAS,GADMD,GAAO,IAE1BE,uBAAuBD,EAAS,GAAIF,GAASE,EAAS,GAAIF,GAAS,GAAIC,GACzE,CAEA,SAASE,uBAAuB5+B,EAAGzC,EAAGonB,KAClCmX,GACFE,KAAOh8B,EAAIg8B,IAAMF,GACjBG,KAAO1+B,EAAI0+B,IAAMH,GACjBI,KAAOvX,EAAIuX,IAAMJ,EACnB,CAEA,SAASuC,oBACPF,GAAepO,MAAQ8O,sBACzB,CAEA,SAASA,uBAAuBJ,EAAQC,GACtCD,GAAU,GACV,IAAIE,EAAS,GADMD,GAAO,IAE1B5a,GAAK6a,EAAS,GAAIF,GAClBlK,GAAKoK,EAAS,GAAIF,GAClB9B,GAAK,GAAI+B,GACTP,GAAepO,MAAQ+O,kBACvBF,uBAAuB9a,GAAIyQ,GAAIoI,GACjC,CAEA,SAASmC,kBAAkBL,EAAQC,GACjCD,GAAU,GACV,IAAIE,EAAS,GADMD,GAAO,IAEtB1+B,EAAI2+B,EAAS,GAAIF,GACjBlhC,EAAIohC,EAAS,GAAIF,GACjB9Z,EAAI,GAAI+Z,GACR3jC,EAAImqB,GAAM7W,IAAMtT,EAAIw5B,GAAK5P,EAAIgY,GAAKp/B,GAAKxC,GAAKA,EAAI4hC,GAAK38B,EAAI8jB,GAAKa,GAAK5pB,GAAKA,EAAI+oB,GAAKvmB,EAAIg3B,GAAKv0B,GAAKjF,GAAI+oB,GAAK9jB,EAAIu0B,GAAKh3B,EAAIo/B,GAAKhY,GAC9HoX,IAAMhhC,EACNohC,IAAMphC,GAAK+oB,IAAMA,GAAK9jB,IACtBo8B,IAAMrhC,GAAKw5B,IAAMA,GAAKh3B,IACtB8+B,IAAMthC,GAAK4hC,IAAMA,GAAKhY,IACtBia,uBAAuB9a,GAAIyQ,GAAIoI,GACjC,CAEA,SAAS2B,kBACPH,GAAepO,MAAQqO,aACzB,CAIA,SAASG,oBACPJ,GAAepO,MAAQgP,sBACzB,CAEA,SAASP,kBACPQ,kBAAkBvC,GAAUC,IAC5ByB,GAAepO,MAAQqO,aACzB,CAEA,SAASW,uBAAuBN,EAAQC,GACtCjC,GAAWgC,EAAQ/B,GAAQgC,EAC3BD,GAAU,GAASC,GAAO,GAC1BP,GAAepO,MAAQiP,kBACvB,IAAIL,EAAS,GAAID,GACjB5a,GAAK6a,EAAS,GAAIF,GAClBlK,GAAKoK,EAAS,GAAIF,GAClB9B,GAAK,GAAI+B,GACTE,uBAAuB9a,GAAIyQ,GAAIoI,GACjC,CAEA,SAASqC,kBAAkBP,EAAQC,GACjCD,GAAU,GACV,IAAIE,EAAS,GADMD,GAAO,IAEtB1+B,EAAI2+B,EAAS,GAAIF,GACjBlhC,EAAIohC,EAAS,GAAIF,GACjB9Z,EAAI,GAAI+Z,GACRO,EAAK1K,GAAK5P,EAAIgY,GAAKp/B,EACnB2hC,EAAKvC,GAAK38B,EAAI8jB,GAAKa,EACnBwa,EAAKrb,GAAKvmB,EAAIg3B,GAAKv0B,EACnBnG,EAAI27B,GAAMyJ,EAAIC,EAAIC,GAClBpkC,EAAI0gC,KAAK5hC,GACTjE,EAAIiE,IAAMkB,EAAIlB,EAClByiC,GAAGn3B,IAAIvP,EAAIqpC,GACX1C,GAAGp3B,IAAIvP,EAAIspC,GACX1C,GAAGr3B,IAAIvP,EAAIupC,GACXpD,IAAMhhC,EACNohC,IAAMphC,GAAK+oB,IAAMA,GAAK9jB,IACtBo8B,IAAMrhC,GAAKw5B,IAAMA,GAAKh3B,IACtB8+B,IAAMthC,GAAK4hC,IAAMA,GAAKhY,IACtBia,uBAAuB9a,GAAIyQ,GAAIoI,GACjC,CAEe,kBAASre,GACtBwd,GAAKC,GACLC,GAAKC,GAAKC,GACVC,GAAKC,GAAKC,GAAK,EACfC,GAAK,IAAIrB,MACTsB,GAAK,IAAItB,MACTuB,GAAK,IAAIvB,MACTW,OAAOtd,EAAQ6f,IAEf,IAAIn+B,GAAKs8B,GACL/+B,GAAKg/B,GACL5X,GAAK6X,GACL3iC,EAAI27B,GAAMx1B,EAAGzC,EAAGonB,GAGpB,OAAI9qB,EAAI,KACNmG,EAAIm8B,GAAI5+B,EAAI6+B,GAAIzX,EAAI0X,GAEhBN,GAAKV,KAASr7B,EAAIg8B,GAAIz+B,EAAI0+B,GAAItX,EAAIuX,KACtCriC,EAAI27B,GAAMx1B,EAAGzC,EAAGonB,IAER,IAAiB,CAACxiB,IAAKA,KAG1B,CAAC+iB,GAAM3nB,EAAGyC,GAAK,GAASy7B,KAAK9W,EAAI9qB,GAAK,GAC/C,CC5Ie,kBACb,IACIulC,EADAC,EAAQ,GAEZ,MAAO,CACLtP,MAAO,SAAS/vB,EAAGzC,EAAG1D,GACpBulC,EAAKhtC,KAAK,CAAC4N,EAAGzC,EAAG1D,GACnB,EACAkkC,UAAW,WACTsB,EAAMjtC,KAAKgtC,EAAO,GACpB,EACApB,QAAS,UACTsB,OAAQ,WACFD,EAAMtsC,OAAS,GAAGssC,EAAMjtC,KAAKitC,EAAMpnC,MAAMzE,OAAO6rC,EAAME,SAC5D,EACA1sC,OAAQ,WACN,IAAIA,EAASwsC,EAGb,OAFAA,EAAQ,GACRD,EAAO,KACAvsC,CACT,EAEJ,CCrBe,oBAASwD,EAAGqI,GACzB,OAAO,GAAIrI,EAAE,GAAKqI,EAAE,IAAM28B,IAAW,GAAIhlC,EAAE,GAAKqI,EAAE,IAAM28B,EAC1D,CCDA,SAASmE,aAAazP,EAAO0P,EAAQC,EAAOC,GAC1ChqC,KAAKqK,EAAI+vB,EACTp6B,KAAKgvB,EAAI8a,EACT9pC,KAAKS,EAAIspC,EACT/pC,KAAKF,EAAIkqC,EACThqC,KAAKC,GAAI,EACTD,KAAKM,EAAIN,KAAKgF,EAAI,IACpB,CAKe,gBAASilC,EAAUC,EAAqBC,EAAanhB,EAAaid,GAC/E,IAEI9oC,EACAmD,EAHA8pC,EAAU,GACVC,EAAO,GAyBX,GArBAJ,EAASvH,QAAQ,SAAS4H,GACxB,MAAKhqC,EAAIgqC,EAAQltC,OAAS,IAAM,GAAhC,CACA,IAAIkD,EAAqC+J,EAAlCsuB,EAAK2R,EAAQ,GAAI1R,EAAK0R,EAAQhqC,GAErC,GAAIiqC,WAAW5R,EAAIC,GAAK,CACtB,IAAKD,EAAG,KAAOC,EAAG,GAAI,CAEpB,IADAqN,EAAOmC,YACFjrC,EAAI,EAAGA,EAAImD,IAAKnD,EAAG8oC,EAAO7L,OAAOzB,EAAK2R,EAAQntC,IAAI,GAAIw7B,EAAG,IAE9D,YADAsN,EAAOoC,SAET,CAEAzP,EAAG,IAAM,IACX,CAEAwR,EAAQ3tC,KAAK4N,EAAI,IAAIw/B,aAAalR,EAAI2R,EAAS,MAAM,IACrDD,EAAK5tC,KAAK4N,EAAE5J,EAAI,IAAIopC,aAAalR,EAAI,KAAMtuB,GAAG,IAC9C+/B,EAAQ3tC,KAAK4N,EAAI,IAAIw/B,aAAajR,EAAI0R,EAAS,MAAM,IACrDD,EAAK5tC,KAAK4N,EAAE5J,EAAI,IAAIopC,aAAajR,EAAI,KAAMvuB,GAAG,GAjBL,CAkB3C,GAEK+/B,EAAQhtC,OAAb,CAMA,IAJAitC,EAAK90B,KAAK20B,GACV,YAAKE,GACL,YAAKC,GAEAltC,EAAI,EAAGmD,EAAI+pC,EAAKjtC,OAAQD,EAAImD,IAAKnD,EACpCktC,EAAKltC,GAAG2C,EAAIqqC,GAAeA,EAO7B,IAJA,IACIL,EACA1P,EAFAthB,EAAQsxB,EAAQ,KAIV,CAIR,IAFA,IAAII,EAAU1xB,EACV2xB,GAAY,EACTD,EAAQvqC,OAAQuqC,EAAUA,EAAQlqC,KAAOwY,EAAO,OACvDgxB,EAASU,EAAQxb,EACjBiX,EAAOmC,YACP,EAAG,CAED,GADAoC,EAAQvqC,EAAIuqC,EAAQ/pC,EAAER,GAAI,EACtBuqC,EAAQ1qC,EAAG,CACb,GAAI2qC,EACF,IAAKttC,EAAI,EAAGmD,EAAIwpC,EAAO1sC,OAAQD,EAAImD,IAAKnD,EAAG8oC,EAAO7L,OAAOA,EAAQ0P,EAAO3sC,IAAI,GAAIi9B,EAAM,SAEtFpR,EAAYwhB,EAAQngC,EAAGmgC,EAAQlqC,EAAE+J,EAAG,EAAG47B,GAEzCuE,EAAUA,EAAQlqC,CACpB,KAAO,CACL,GAAImqC,EAEF,IADAX,EAASU,EAAQxlC,EAAEgqB,EACd7xB,EAAI2sC,EAAO1sC,OAAS,EAAGD,GAAK,IAAKA,EAAG8oC,EAAO7L,OAAOA,EAAQ0P,EAAO3sC,IAAI,GAAIi9B,EAAM,SAEpFpR,EAAYwhB,EAAQngC,EAAGmgC,EAAQxlC,EAAEqF,GAAI,EAAG47B,GAE1CuE,EAAUA,EAAQxlC,CACpB,CAEA8kC,GADAU,EAAUA,EAAQ/pC,GACDuuB,EACjByb,GAAaA,CACf,QAAUD,EAAQvqC,GAClBgmC,EAAOoC,SACT,CA5C2B,CA6C7B,CAEA,SAAS,YAAKj+B,GACZ,GAAM9J,EAAI8J,EAAMhN,OAAhB,CAKA,IAJA,IAAIkD,EAGAyI,EAFA5L,EAAI,EACJuD,EAAI0J,EAAM,KAELjN,EAAImD,GACXI,EAAEJ,EAAIyI,EAAIqB,EAAMjN,GAChB4L,EAAE/D,EAAItE,EACNA,EAAIqI,EAENrI,EAAEJ,EAAIyI,EAAIqB,EAAM,GAChBrB,EAAE/D,EAAItE,CAXyB,CAYjC,CChGe,SAAS,YAAMgqC,GAC5B,OAAOphC,MAAMG,KAPf,SAAUkhC,QAAQD,GAChB,IAAK,MAAMtgC,KAASsgC,QACXtgC,CAEX,CAGoBugC,CAAQD,GAC5B,CCFA,IAAIE,GAAU,IAAKC,IAAWD,GAKf,SAASE,cAAc3c,EAAIyQ,EAAIxQ,EAAI2c,GAEhD,SAASC,QAAQ3gC,EAAGzC,GAClB,OAAOumB,GAAM9jB,GAAKA,GAAK+jB,GAAMwQ,GAAMh3B,GAAKA,GAAKmjC,CAC/C,CAEA,SAAS/hB,YAAYvf,EAAMwhC,EAAIC,EAAWjF,GACxC,IAAIvlC,EAAI,EAAGyqC,EAAK,EAChB,GAAY,MAAR1hC,IACI/I,EAAI0qC,OAAO3hC,EAAMyhC,OAAiBC,EAAKC,OAAOH,EAAIC,KACnDG,aAAa5hC,EAAMwhC,GAAM,EAAIC,EAAY,EAC9C,GAAGjF,EAAO7L,MAAY,IAAN15B,GAAiB,IAANA,EAAUytB,EAAKC,EAAI1tB,EAAI,EAAIqqC,EAAKnM,UACnDl+B,GAAKA,EAAIwqC,EAAY,GAAK,KAAOC,QAEzClF,EAAO7L,MAAM6Q,EAAG,GAAIA,EAAG,GAE3B,CAEA,SAASG,OAAOpmC,EAAGkmC,GACjB,OAAO,GAAIlmC,EAAE,GAAKmpB,GAAMuX,GAAUwF,EAAY,EAAI,EAAI,EAChD,GAAIlmC,EAAE,GAAKopB,GAAMsX,GAAUwF,EAAY,EAAI,EAAI,EAC/C,GAAIlmC,EAAE,GAAK45B,GAAM8G,GAAUwF,EAAY,EAAI,EAAI,EAC/CA,EAAY,EAAI,EAAI,CAC5B,CAEA,SAAShB,oBAAoBxpC,EAAGqI,GAC9B,OAAOsiC,aAAa3qC,EAAE2J,EAAGtB,EAAEsB,EAC7B,CAEA,SAASghC,aAAa3qC,EAAGqI,GACvB,IAAIuiC,EAAKF,OAAO1qC,EAAG,GACf6qC,EAAKH,OAAOriC,EAAG,GACnB,OAAOuiC,IAAOC,EAAKD,EAAKC,EACX,IAAPD,EAAWviC,EAAE,GAAKrI,EAAE,GACb,IAAP4qC,EAAW5qC,EAAE,GAAKqI,EAAE,GACb,IAAPuiC,EAAW5qC,EAAE,GAAKqI,EAAE,GACpBA,EAAE,GAAKrI,EAAE,EACjB,CAEA,OAAO,SAASulC,GACd,IAEIgE,EACAuB,EACAC,EACAC,EAAKC,EAAKC,EACVC,EAAIC,EAAIC,EACRC,EACA9N,EARA+N,EAAehG,EACfiG,EAAe,SASfC,EAAa,CACf/R,MACAgO,UAgDF,SAASA,YACP+D,EAAW/R,MAAQgS,UACfZ,GAASA,EAAQ/uC,KAAKgvC,EAAO,IACjCO,GAAQ,EACRD,GAAK,EACLF,EAAKC,EAAKt/B,GACZ,EArDE67B,QA0DF,SAASA,UACH4B,IACFmC,UAAUV,EAAKC,GACXC,GAAOG,GAAIG,EAAavC,SAC5BM,EAASxtC,KAAKyvC,EAAahvC,WAE7BivC,EAAW/R,MAAQA,MACf2R,GAAIE,EAAa5D,SACvB,EAjEEC,aAuBF,SAASA,eACP2D,EAAeC,EAAcjC,EAAW,GAAIuB,EAAU,GAAItN,GAAQ,CACpE,EAxBEqK,WA0BF,SAASA,aACP,IAAI4B,EApBN,SAASkC,gBAGP,IAFA,IAAIC,EAAU,EAELnvC,EAAI,EAAGmD,EAAIkrC,EAAQpuC,OAAQD,EAAImD,IAAKnD,EAC3C,IAAK,IAAgEovC,EAAIpB,EAAhEM,EAAOD,EAAQruC,GAAIqU,EAAI,EAAGtN,EAAIunC,EAAKruC,OAAQg9B,EAAQqR,EAAK,GAAYjS,EAAKY,EAAM,GAAIX,EAAKW,EAAM,GAAI5oB,EAAItN,IAAKsN,EAClH+6B,EAAK/S,EAAI2R,EAAK1R,EAAqBD,GAAjBY,EAAQqR,EAAKj6B,IAAe,GAAIioB,EAAKW,EAAM,GACzD+Q,GAAMJ,EAAUtR,EAAKsR,IAAOvR,EAAK+S,IAAOxB,EAAKI,IAAO1R,EAAK0R,IAAOhd,EAAKoe,MAAOD,EACrE7S,GAAMsR,IAAOvR,EAAK+S,IAAOxB,EAAKI,IAAO1R,EAAK0R,IAAOhd,EAAKoe,MAAOD,EAI5E,OAAOA,CACT,CAQoBD,GACdG,EAActO,GAASiM,EACvBa,GAAWf,EAAW,YAAMA,IAAW7sC,QACvCovC,GAAexB,KACjB/E,EAAOqC,eACHkE,IACFvG,EAAOmC,YACPpf,YAAY,KAAM,KAAM,EAAGid,GAC3BA,EAAOoC,WAEL2C,GACF,OAAWf,EAAUC,oBAAqBC,EAAanhB,YAAaid,GAEtEA,EAAOsC,cAET0D,EAAehG,EAAQgE,EAAWuB,EAAUC,EAAO,IACrD,GAxCA,SAASrR,MAAM/vB,EAAGzC,GACZojC,QAAQ3gC,EAAGzC,IAAIqkC,EAAa7R,MAAM/vB,EAAGzC,EAC3C,CA6DA,SAASwkC,UAAU/hC,EAAGzC,GACpB,IAAI3H,EAAI+qC,QAAQ3gC,EAAGzC,GAEnB,GADI4jC,GAASC,EAAKhvC,KAAK,CAAC4N,EAAGzC,IACvBokC,EACFN,EAAMrhC,EAAGshC,EAAM/jC,EAAGgkC,EAAM3rC,EACxB+rC,GAAQ,EACJ/rC,IACFgsC,EAAa7D,YACb6D,EAAa7R,MAAM/vB,EAAGzC,SAGxB,GAAI3H,GAAK8rC,EAAIE,EAAa7R,MAAM/vB,EAAGzC,OAC9B,CACH,IAAIlH,EAAI,CAACmrC,EAAK72B,KAAK4B,IAAIi0B,GAAS71B,KAAKC,IAAI21B,GAASiB,IAAMC,EAAK92B,KAAK4B,IAAIi0B,GAAS71B,KAAKC,IAAI21B,GAASkB,KAC7F/iC,EAAI,CAACsB,EAAI2K,KAAK4B,IAAIi0B,GAAS71B,KAAKC,IAAI21B,GAASvgC,IAAKzC,EAAIoN,KAAK4B,IAAIi0B,GAAS71B,KAAKC,IAAI21B,GAAShjC,MClJzF,mBAASlH,EAAGqI,EAAGolB,EAAIyQ,EAAIxQ,EAAI2c,GACxC,IAQIxqC,EARAksC,EAAK/rC,EAAE,GACPgsC,EAAKhsC,EAAE,GAGPiuB,EAAK,EACLhJ,EAAK,EACLyT,EAJKrwB,EAAE,GAIG0jC,EACVpT,EAJKtwB,EAAE,GAIG2jC,EAId,GADAnsC,EAAI4tB,EAAKse,EACJrT,KAAM74B,EAAI,GAAf,CAEA,GADAA,GAAK64B,EACDA,EAAK,EAAG,CACV,GAAI74B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,MAAO,GAAI64B,EAAK,EAAG,CACjB,GAAI74B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,CAGA,GADAA,EAAI6tB,EAAKqe,EACJrT,KAAM74B,EAAI,GAAf,CAEA,GADAA,GAAK64B,EACDA,EAAK,EAAG,CACV,GAAI74B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,MAAO,GAAI64B,EAAK,EAAG,CACjB,GAAI74B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,CAGA,GADAA,EAAIq+B,EAAK8N,EACJrT,KAAM94B,EAAI,GAAf,CAEA,GADAA,GAAK84B,EACDA,EAAK,EAAG,CACV,GAAI94B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,MAAO,GAAI84B,EAAK,EAAG,CACjB,GAAI94B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,CAGA,GADAA,EAAIwqC,EAAK2B,EACJrT,KAAM94B,EAAI,GAAf,CAEA,GADAA,GAAK84B,EACDA,EAAK,EAAG,CACV,GAAI94B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,MAAO,GAAI84B,EAAK,EAAG,CACjB,GAAI94B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,CAIA,OAFIouB,EAAK,IAAGjuB,EAAE,GAAK+rC,EAAK9d,EAAKyK,EAAI14B,EAAE,GAAKgsC,EAAK/d,EAAK0K,GAC9C1T,EAAK,IAAG5c,EAAE,GAAK0jC,EAAK9mB,EAAKyT,EAAIrwB,EAAE,GAAK2jC,EAAK/mB,EAAK0T,IAC3C,CAZiB,CAXA,CAXA,CAXA,CA8C1B,CDyFc,CAAS34B,EAAGqI,EAAGolB,EAAIyQ,EAAIxQ,EAAI2c,GAQpB9qC,IACTgsC,EAAa7D,YACb6D,EAAa7R,MAAM/vB,EAAGzC,GACtBs2B,GAAQ,IAVH6N,IACHE,EAAa7D,YACb6D,EAAa7R,MAAM15B,EAAE,GAAIA,EAAE,KAE7BurC,EAAa7R,MAAMrxB,EAAE,GAAIA,EAAE,IACtB9I,GAAGgsC,EAAa5D,UACrBnK,GAAQ,EAMZ,CAEF2N,EAAKxhC,EAAGyhC,EAAKlkC,EAAGmkC,EAAK9rC,CACvB,CAEA,OAAOksC,CACT,CACF,CEvKA,0BAAe9hC,GAAKA,ECMb,SAAS,sBAAYsiC,GAC1B,OAAO,SAAS1G,GACd,IAAI9gB,EAAI,IAAIynB,gBACZ,IAAK,IAAIlkC,KAAOikC,EAASxnB,EAAEzc,GAAOikC,EAAQjkC,GAE1C,OADAyc,EAAE8gB,OAASA,EACJ9gB,CACT,CACF,CAEA,SAASynB,kBAAmB,CAE5BA,gBAAgBlmC,UAAY,CAC1BrC,YAAauoC,gBACbxS,MAAO,SAAS/vB,EAAGzC,GAAK5H,KAAKimC,OAAO7L,MAAM/vB,EAAGzC,EAAI,EACjD0/B,OAAQ,WAAatnC,KAAKimC,OAAOqB,QAAU,EAC3Cc,UAAW,WAAapoC,KAAKimC,OAAOmC,WAAa,EACjDC,QAAS,WAAaroC,KAAKimC,OAAOoC,SAAW,EAC7CC,aAAc,WAAatoC,KAAKimC,OAAOqC,cAAgB,EACvDC,WAAY,WAAavoC,KAAKimC,OAAOsC,YAAc,GCtBrD,IAAI,GAAKnb,IACL,GAAK,GACLgB,IAAM,GACN2c,GAAK3c,GAELye,GAAe,CACjBzS,MAYF,SAAS0S,YAAYziC,EAAGzC,GAClByC,EAAI,KAAI,GAAKA,GACbA,EAAI+jB,KAAIA,GAAK/jB,GACbzC,EAAI,KAAI,GAAKA,GACbA,EAAImjC,KAAIA,GAAKnjC,EACnB,EAhBEwgC,UAAW,UACXC,QAAS,UACTC,aAAc,UACdC,WAAY,UACZrrC,OAAQ,WACN,IAAI6vC,EAAS,CAAC,CAAC,GAAI,IAAK,CAAC3e,GAAI2c,KAE7B,OADA3c,GAAK2c,KAAO,GAAK,GAAK3d,KACf2f,CACT,GAUF,YCxBA,SAASC,IAAIC,EAAYC,EAAWvkB,GAClC,IAAI0hB,EAAO4C,EAAWE,YAAcF,EAAWE,aAM/C,OALAF,EAAW90B,MAAM,KAAKyb,UAAU,CAAC,EAAG,IACxB,MAARyW,GAAc4C,EAAWE,WAAW,MACxC,OAAUxkB,EAAQskB,EAAWhH,OAAO8G,KACpCG,EAAUH,GAAa7vC,UACX,MAARmtC,GAAc4C,EAAWE,WAAW9C,GACjC4C,CACT,CAEO,SAASG,UAAUH,EAAYvQ,EAAQ/T,GAC5C,OAAOqkB,IAAIC,EAAY,SAASlkC,GAC9B,IAAI3D,EAAIs3B,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC7BxX,EAAIwX,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC7Bx8B,EAAI8U,KAAKC,IAAI7P,GAAK2D,EAAE,GAAG,GAAKA,EAAE,GAAG,IAAKmc,GAAKnc,EAAE,GAAG,GAAKA,EAAE,GAAG,KAC1DsB,GAAKqyB,EAAO,GAAG,IAAMt3B,EAAIlF,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACpDnB,GAAK80B,EAAO,GAAG,IAAMxX,EAAIhlB,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACxDkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CAEO,SAAS0kB,QAAQJ,EAAYn3B,EAAM6S,GACxC,OAAOykB,UAAUH,EAAY,CAAC,CAAC,EAAG,GAAIn3B,GAAO6S,EAC/C,CAEO,SAAS2kB,SAASL,EAAYxiB,EAAO9B,GAC1C,OAAOqkB,IAAIC,EAAY,SAASlkC,GAC9B,IAAI3D,GAAKqlB,EACLvqB,EAAIkF,GAAK2D,EAAE,GAAG,GAAKA,EAAE,GAAG,IACxBsB,GAAKjF,EAAIlF,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACpCnB,GAAK1H,EAAI6I,EAAE,GAAG,GAClBkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CAEO,SAAS4kB,UAAUN,EAAYlR,EAAQpT,GAC5C,OAAOqkB,IAAIC,EAAY,SAASlkC,GAC9B,IAAImc,GAAK6W,EACL77B,EAAIglB,GAAKnc,EAAE,GAAG,GAAKA,EAAE,GAAG,IACxBsB,GAAKnK,EAAI6I,EAAE,GAAG,GACdnB,GAAKsd,EAAIhlB,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACxCkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CC1CA,IAEI6kB,GACAC,GACA,GACA,GALAC,GAAU,IAAIpI,MACdqI,GAAc,IAAIrI,MAMlBsI,GAAa,CACfxT,MAAO,UACPgO,UAAW,UACXC,QAAS,UACTC,aAAc,WACZsF,GAAWxF,UAAYyF,cACvBD,GAAWvF,QAAUyF,WACvB,EACAvF,WAAY,WACVqF,GAAWxF,UAAYwF,GAAWvF,QAAUuF,GAAWxT,MAAQ,UAC/DsT,GAAQl+B,IAAI,GAAIm+B,KAChBA,GAAc,IAAIrI,KACpB,EACApoC,OAAQ,WACN,IAAI6wC,EAAOL,GAAU,EAErB,OADAA,GAAU,IAAIpI,MACPyI,CACT,GAGF,SAASF,gBACPD,GAAWxT,MAAQ4T,cACrB,CAEA,SAASA,eAAe3jC,EAAGzC,GACzBgmC,GAAWxT,MAAQ6T,UACnBT,GAAM,GAAKnjC,EAAGojC,GAAM,GAAK7lC,CAC3B,CAEA,SAASqmC,UAAU5jC,EAAGzC,GACpB+lC,GAAYn+B,IAAI,GAAKnF,EAAI,GAAKzC,GAC9B,GAAKyC,EAAG,GAAKzC,CACf,CAEA,SAASkmC,cACPG,UAAUT,GAAKC,GACjB,CAEA,YC7CA,IASI,GACA,GACA,GACA,GAZA,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EAML,GAAiB,CACnBrT,MAAO,uBACPgO,UAAW,2BACXC,QAAS,yBACTC,aAAc,WACZ,GAAeF,UAAY,2BAC3B,GAAeC,QAAU,wBAC3B,EACAE,WAAY,WACV,GAAenO,MAAQ,uBACvB,GAAegO,UAAY,2BAC3B,GAAeC,QAAU,wBAC3B,EACAnrC,OAAQ,WACN,IAAI8gC,EAAW,GAAK,CAAC,GAAK,GAAI,GAAK,IAC7B,GAAK,CAAC,GAAK,GAAI,GAAK,IACpB,GAAK,CAAC,GAAK,GAAI,GAAK,IACpB,CAACxxB,IAAKA,KAIZ,OAHA,GAAK,GAAK,GACV,GAAK,GAAK,GACV,GAAK,GAAK,GAAK,EACRwxB,CACT,GAGF,SAAS,uBAAc3zB,EAAGzC,GACxB,IAAMyC,EACN,IAAMzC,IACJ,EACJ,CAEA,SAAS,6BACP,GAAewyB,MAAQ8T,sBACzB,CAEA,SAASA,uBAAuB7jC,EAAGzC,GACjC,GAAewyB,MAAQ+T,kBACvB,uBAAc,GAAK9jC,EAAG,GAAKzC,EAC7B,CAEA,SAASumC,kBAAkB9jC,EAAGzC,GAC5B,IAAIwxB,EAAK/uB,EAAI,GAAIgvB,EAAKzxB,EAAI,GAAIonB,EAAItW,GAAK0gB,EAAKA,EAAKC,EAAKA,GACtD,IAAMrK,GAAK,GAAK3kB,GAAK,EACrB,IAAM2kB,GAAK,GAAKpnB,GAAK,EACrB,IAAMonB,EACN,uBAAc,GAAK3kB,EAAG,GAAKzC,EAC7B,CAEA,SAAS,2BACP,GAAewyB,MAAQ,sBACzB,CAEA,SAAS,6BACP,GAAeA,MAAQgU,sBACzB,CAEA,SAAS,2BACPC,kBAAkB,GAAK,GACzB,CAEA,SAASD,uBAAuB/jC,EAAGzC,GACjC,GAAewyB,MAAQiU,kBACvB,uBAAc,GAAM,GAAKhkC,EAAG,GAAM,GAAKzC,EACzC,CAEA,SAASymC,kBAAkBhkC,EAAGzC,GAC5B,IAAIwxB,EAAK/uB,EAAI,GACTgvB,EAAKzxB,EAAI,GACTonB,EAAItW,GAAK0gB,EAAKA,EAAKC,EAAKA,GAE5B,IAAMrK,GAAK,GAAK3kB,GAAK,EACrB,IAAM2kB,GAAK,GAAKpnB,GAAK,EACrB,IAAMonB,EAGN,KADAA,EAAI,GAAK3kB,EAAI,GAAKzC,IACP,GAAKyC,GAChB,IAAM2kB,GAAK,GAAKpnB,GAChB,IAAU,EAAJonB,EACN,uBAAc,GAAK3kB,EAAG,GAAKzC,EAC7B,CAEA,YChGe,SAAS0mC,YAAY35B,GAClC3U,KAAKuuC,SAAW55B,CAClB,CAEA25B,YAAY5nC,UAAY,CACtB8nC,QAAS,IACTC,YAAa,SAASn2B,GACpB,OAAOtY,KAAKwuC,QAAUl2B,EAAGtY,IAC3B,EACAsoC,aAAc,WACZtoC,KAAK0uC,MAAQ,CACf,EACAnG,WAAY,WACVvoC,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACY,IAAfroC,KAAK0uC,OAAa1uC,KAAKuuC,SAASK,YACpC5uC,KAAK2uC,OAASniC,GAChB,EACA4tB,MAAO,SAAS/vB,EAAGzC,GACjB,OAAQ5H,KAAK2uC,QACX,KAAK,EACH3uC,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GACxB5H,KAAK2uC,OAAS,EACd,MAEF,KAAK,EACH3uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GACxB,MAEF,QACE5H,KAAKuuC,SAASM,OAAOxkC,EAAIrK,KAAKwuC,QAAS5mC,GACvC5H,KAAKuuC,SAASQ,IAAI1kC,EAAGzC,EAAG5H,KAAKwuC,QAAS,EAAG,IAI/C,EACAtxC,OAAQ,WCvCV,IACI8xC,GACA,GACA,GACA,GACA,GALAC,GAAY,IAAI3J,MAOhB4J,GAAe,CACjB9U,MAAO,UACPgO,UAAW,WACT8G,GAAa9U,MAAQ+U,gBACvB,EACA9G,QAAS,WACH2G,IAAYI,YAAY,GAAK,IACjCF,GAAa9U,MAAQ,SACvB,EACAkO,aAAc,WACZ0G,IAAa,CACf,EACAzG,WAAY,WACVyG,GAAa,IACf,EACA9xC,OAAQ,WACN,IAAIE,GAAU6xC,GAEd,OADAA,GAAY,IAAI3J,MACTloC,CACT,GAGF,SAAS+xC,iBAAiB9kC,EAAGzC,GAC3BsnC,GAAa9U,MAAQgV,YACrB,GAAM,GAAK/kC,EAAG,GAAM,GAAKzC,CAC3B,CAEA,SAASwnC,YAAY/kC,EAAGzC,GACtB,IAAMyC,EAAG,IAAMzC,EACfqnC,GAAUz/B,IAAIkJ,GAAK,GAAK,GAAK,GAAK,KAClC,GAAKrO,EAAG,GAAKzC,CACf,CAEA,YC3CA,IAAIynC,GAAaC,GAAaC,GAAaC,GAE5B,MAAMC,WACnB,WAAAprC,CAAYqrC,GACV1vC,KAAK2vC,QAAoB,MAAVD,EAAiB,cAgEpC,SAASE,YAAYF,GACnB,MAAM3vC,EAAIiV,KAAK8B,MAAM44B,GACrB,KAAM3vC,GAAK,GAAI,MAAM,IAAI8vC,WAAW,mBAAmBH,KACvD,GAAI3vC,EAAI,GAAI,OAAO,cACnB,GAAIA,IAAMsvC,GAAa,CACrB,MAAMnvC,EAAI,IAAMH,EAChBsvC,GAActvC,EACduvC,GAAc,SAAS96B,OAAOs7B,GAC5B,IAAI3yC,EAAI,EACR6C,KAAKsY,GAAKw3B,EAAQ,GAClB,IAAK,MAAMt+B,EAAIs+B,EAAQ1yC,OAAQD,EAAIqU,IAAKrU,EACtC6C,KAAKsY,GAAKtD,KAAKuE,MAAMzL,UAAU3Q,GAAK+C,GAAKA,EAAI4vC,EAAQ3yC,EAEzD,CACF,CACA,OAAOmyC,EACT,CAhF6CM,CAAYF,GACrD1vC,KAAKwuC,QAAU,IACfxuC,KAAKsY,EAAI,EACX,CACA,WAAAm2B,CAAYn2B,GAEV,OADAtY,KAAKwuC,SAAWl2B,EACTtY,IACT,CACA,YAAAsoC,GACEtoC,KAAK0uC,MAAQ,CACf,CACA,UAAAnG,GACEvoC,KAAK0uC,MAAQliC,GACf,CACA,SAAA47B,GACEpoC,KAAK2uC,OAAS,CAChB,CACA,OAAAtG,GACqB,IAAfroC,KAAK0uC,QAAa1uC,KAAKsY,GAAK,KAChCtY,KAAK2uC,OAASniC,GAChB,CACA,KAAA4tB,CAAM/vB,EAAGzC,GACP,OAAQ5H,KAAK2uC,QACX,KAAK,EACH3uC,KAAK2vC,OAAO,IAAItlC,KAAKzC,IACrB5H,KAAK2uC,OAAS,EACd,MAEF,KAAK,EACH3uC,KAAK2vC,OAAO,IAAItlC,KAAKzC,IACrB,MAEF,QAEE,GADA5H,KAAK2vC,OAAO,IAAItlC,KAAKzC,IACjB5H,KAAKwuC,UAAYe,IAAevvC,KAAK2vC,UAAYL,GAAa,CAChE,MAAM/uC,EAAIP,KAAKwuC,QACTrpB,EAAInlB,KAAKsY,EACftY,KAAKsY,EAAI,GACTtY,KAAK2vC,OAAO,MAAMpvC,KAAKA,KAAKA,cAAc,EAAIA,KAAKA,KAAKA,aAAa,EAAIA,KACzEgvC,GAAchvC,EACd+uC,GAActvC,KAAK2vC,QACnBH,GAAcxvC,KAAKsY,EACnBtY,KAAKsY,EAAI6M,CACX,CACAnlB,KAAKsY,GAAKk3B,GAIhB,CACA,MAAAtyC,GACE,MAAMA,EAAS8C,KAAKsY,EAEpB,OADAtY,KAAKsY,EAAI,GACFpb,EAAOE,OAASF,EAAS,IAClC,EAGF,SAAS,cAAO4yC,GACd,IAAI3yC,EAAI,EACR6C,KAAKsY,GAAKw3B,EAAQ,GAClB,IAAK,MAAMt+B,EAAIs+B,EAAQ1yC,OAAQD,EAAIqU,IAAKrU,EACtC6C,KAAKsY,GAAKxK,UAAU3Q,GAAK2yC,EAAQ3yC,EAErC,CC1De,kBAAS8vC,EAAYt4B,GAClC,IAEIo7B,EACAC,EAHAN,EAAS,EACTjB,EAAc,IAIlB,SAASwB,KAAKtnB,GAKZ,OAJIA,IACyB,mBAAhB8lB,GAA4BuB,EAAcvB,aAAaA,EAAYtnC,MAAMnH,KAAM8N,YAC1Fm4B,OAAOtd,EAAQonB,EAAiBC,KAE3BA,EAAc9yC,QACvB,CAqDA,OAnDA+yC,KAAKlC,KAAO,SAASplB,GAEnB,OADAsd,OAAOtd,EAAQonB,EAAiB,KACzB,GAAS7yC,QAClB,EAEA+yC,KAAKC,QAAU,SAASvnB,GAEtB,OADAsd,OAAOtd,EAAQonB,EAAiB,KACzB,GAAY7yC,QACrB,EAEA+yC,KAAKlD,OAAS,SAASpkB,GAErB,OADAsd,OAAOtd,EAAQonB,EAAiB,KACzB,GAAW7yC,QACpB,EAEA+yC,KAAKjS,SAAW,SAASrV,GAEvB,OADAsd,OAAOtd,EAAQonB,EAAiB,KACzB,GAAa7yC,QACtB,EAEA+yC,KAAKhD,WAAa,SAAS30B,GACzB,OAAKxK,UAAU1Q,QACf2yC,EAAwB,MAALz3B,GAAa20B,EAAa,KAAM,sBAAaA,EAAa30B,GAAG2tB,OACzEgK,MAFuBhD,CAGhC,EAEAgD,KAAKt7B,QAAU,SAAS2D,GACtB,OAAKxK,UAAU1Q,QACf4yC,EAAqB,MAAL13B,GAAa3D,EAAU,KAAM,IAAI86B,WAAWC,IAAW,IAAIpB,YAAY35B,EAAU2D,GACtE,mBAAhBm2B,GAA4BuB,EAAcvB,YAAYA,GAC1DwB,MAHuBt7B,CAIhC,EAEAs7B,KAAKxB,YAAc,SAASn2B,GAC1B,OAAKxK,UAAU1Q,QACfqxC,EAA2B,mBAANn2B,EAAmBA,GAAK03B,EAAcvB,aAAan2B,IAAKA,GACtE23B,MAFuBxB,CAGhC,EAEAwB,KAAKP,OAAS,SAASp3B,GACrB,IAAKxK,UAAU1Q,OAAQ,OAAOsyC,EAC9B,GAAS,MAALp3B,EAAWo3B,EAAS,SACnB,CACH,MAAM3vC,EAAIiV,KAAK8B,MAAMwB,GACrB,KAAMvY,GAAK,GAAI,MAAM,IAAI8vC,WAAW,mBAAmBv3B,KACvDo3B,EAAS3vC,CACX,CAEA,OADgB,OAAZ4U,IAAkBq7B,EAAgB,IAAIP,WAAWC,IAC9CO,IACT,EAEOA,KAAKhD,WAAWA,GAAYyC,OAAOA,GAAQ/6B,QAAQA,EAC5D,CC3Ee,SAAS,gBAAQ,CCEjB,uBACb,IACI80B,EADAC,EAAQ,GAEZ,MAAO,CACLtP,MAAO,SAAS/vB,EAAGzC,EAAG1D,GACpBulC,EAAKhtC,KAAK,CAAC4N,EAAGzC,EAAG1D,GACnB,EACAkkC,UAAW,WACTsB,EAAMjtC,KAAKgtC,EAAO,GACpB,EACApB,QAAS,cACTsB,OAAQ,WACFD,EAAMtsC,OAAS,GAAGssC,EAAMjtC,KAAKitC,EAAMpnC,MAAMzE,OAAO6rC,EAAME,SAC5D,EACA1sC,OAAQ,WACN,IAAIA,EAASwsC,EAGb,OAFAA,EAAQ,GACRD,EAAO,KACAvsC,CACT,EAEJ,CCvBO,IAAI,GAAU,KAEV,GAAK8X,KAAKwZ,GACV,GAAS,GAAK,EACd,GAAY,GAAK,EACjB,GAAW,EAAL,GAEN,GAAU,IAAM,GAChB,GAAU,GAAK,IAEf,GAAMxZ,KAAK+V,IACX,GAAO/V,KAAKse,KACZ,GAAQte,KAAKua,MACb,GAAMva,KAAKwa,IAOX,IANOxa,KAAKiZ,KACNjZ,KAAKqjB,IACHrjB,KAAK8B,MACL9B,KAAK6qB,MACP7qB,KAAKukB,IACLvkB,KAAKmE,IACLnE,KAAKya,KACX,GAAOza,KAAKuV,MAAQ,SAASlgB,GAAK,OAAOA,EAAI,EAAI,EAAIA,EAAI,GAAK,EAAI,CAAG,EACrE,GAAO2K,KAAK0D,KACN1D,KAAKkO,IAMf,SAAS,UAAK7Y,GACnB,OAAOA,EAAI,EAAI,GAASA,GAAK,GAAK,GAAS2K,KAAK8wB,KAAKz7B,EACvD,CC7Be,wBAAS3J,EAAGqI,GACzB,OAAO,GAAIrI,EAAE,GAAKqI,EAAE,IAAM,IAAW,GAAIrI,EAAE,GAAKqI,EAAE,IAAM,EAC1D,CCDA,SAAS,oBAAaqxB,EAAO0P,EAAQC,EAAOC,GAC1ChqC,KAAKqK,EAAI+vB,EACTp6B,KAAKgvB,EAAI8a,EACT9pC,KAAKS,EAAIspC,EACT/pC,KAAKF,EAAIkqC,EACThqC,KAAKC,GAAI,EACTD,KAAKM,EAAIN,KAAKgF,EAAI,IACpB,CAKe,qBAASilC,EAAUC,EAAqBC,EAAanhB,EAAaid,GAC/E,IAEI9oC,EACAmD,EAHA8pC,EAAU,GACVC,EAAO,GAyBX,GArBAJ,EAASvH,QAAQ,SAAS4H,GACxB,MAAKhqC,EAAIgqC,EAAQltC,OAAS,IAAM,GAAhC,CACA,IAAIkD,EAAqC+J,EAAlCsuB,EAAK2R,EAAQ,GAAI1R,EAAK0R,EAAQhqC,GAErC,GAAI,eAAWq4B,EAAIC,GAAK,CACtB,IAAKD,EAAG,KAAOC,EAAG,GAAI,CAEpB,IADAqN,EAAOmC,YACFjrC,EAAI,EAAGA,EAAImD,IAAKnD,EAAG8oC,EAAO7L,OAAOzB,EAAK2R,EAAQntC,IAAI,GAAIw7B,EAAG,IAE9D,YADAsN,EAAOoC,SAET,CAEAzP,EAAG,IAAM,IACX,CAEAwR,EAAQ3tC,KAAK4N,EAAI,IAAI,oBAAasuB,EAAI2R,EAAS,MAAM,IACrDD,EAAK5tC,KAAK4N,EAAE5J,EAAI,IAAI,oBAAak4B,EAAI,KAAMtuB,GAAG,IAC9C+/B,EAAQ3tC,KAAK4N,EAAI,IAAI,oBAAauuB,EAAI0R,EAAS,MAAM,IACrDD,EAAK5tC,KAAK4N,EAAE5J,EAAI,IAAI,oBAAam4B,EAAI,KAAMvuB,GAAG,GAjBL,CAkB3C,GAEK+/B,EAAQhtC,OAAb,CAMA,IAJAitC,EAAK90B,KAAK20B,GACV,iBAAKE,GACL,iBAAKC,GAEAltC,EAAI,EAAGmD,EAAI+pC,EAAKjtC,OAAQD,EAAImD,IAAKnD,EACpCktC,EAAKltC,GAAG2C,EAAIqqC,GAAeA,EAO7B,IAJA,IACIL,EACA1P,EAFAthB,EAAQsxB,EAAQ,KAIV,CAIR,IAFA,IAAII,EAAU1xB,EACV2xB,GAAY,EACTD,EAAQvqC,OAAQuqC,EAAUA,EAAQlqC,KAAOwY,EAAO,OACvDgxB,EAASU,EAAQxb,EACjBiX,EAAOmC,YACP,EAAG,CAED,GADAoC,EAAQvqC,EAAIuqC,EAAQ/pC,EAAER,GAAI,EACtBuqC,EAAQ1qC,EAAG,CACb,GAAI2qC,EACF,IAAKttC,EAAI,EAAGmD,EAAIwpC,EAAO1sC,OAAQD,EAAImD,IAAKnD,EAAG8oC,EAAO7L,OAAOA,EAAQ0P,EAAO3sC,IAAI,GAAIi9B,EAAM,SAEtFpR,EAAYwhB,EAAQngC,EAAGmgC,EAAQlqC,EAAE+J,EAAG,EAAG47B,GAEzCuE,EAAUA,EAAQlqC,CACpB,KAAO,CACL,GAAImqC,EAEF,IADAX,EAASU,EAAQxlC,EAAEgqB,EACd7xB,EAAI2sC,EAAO1sC,OAAS,EAAGD,GAAK,IAAKA,EAAG8oC,EAAO7L,OAAOA,EAAQ0P,EAAO3sC,IAAI,GAAIi9B,EAAM,SAEpFpR,EAAYwhB,EAAQngC,EAAGmgC,EAAQxlC,EAAEqF,GAAI,EAAG47B,GAE1CuE,EAAUA,EAAQxlC,CACpB,CAEA8kC,GADAU,EAAUA,EAAQ/pC,GACDuuB,EACjByb,GAAaA,CACf,QAAUD,EAAQvqC,GAClBgmC,EAAOoC,SACT,CA5C2B,CA6C7B,CAEA,SAAS,iBAAKj+B,GACZ,GAAM9J,EAAI8J,EAAMhN,OAAhB,CAKA,IAJA,IAAIkD,EAGAyI,EAFA5L,EAAI,EACJuD,EAAI0J,EAAM,KAELjN,EAAImD,GACXI,EAAEJ,EAAIyI,EAAIqB,EAAMjN,GAChB4L,EAAE/D,EAAItE,EACNA,EAAIqI,EAENrI,EAAEJ,EAAIyI,EAAIqB,EAAM,GAChBrB,EAAE/D,EAAItE,CAXyB,CAYjC,CCrGO,MAAM,WACX,WAAA2D,GACErE,KAAKulC,UAAY,IAAIC,aAAa,IAClCxlC,KAAKylC,GAAK,CACZ,CACA,GAAAj2B,CAAInF,GACF,MAAMrF,EAAIhF,KAAKulC,UACf,IAAIpoC,EAAI,EACR,IAAK,IAAIqU,EAAI,EAAGA,EAAIxR,KAAKylC,IAAMj0B,EAAI,GAAIA,IAAK,CAC1C,MAAM5J,EAAI5C,EAAEwM,GACV8F,EAAKjN,EAAIzC,EACTyP,EAAKrC,KAAK+V,IAAI1gB,GAAK2K,KAAK+V,IAAInjB,GAAKyC,GAAKiN,EAAK1P,GAAKA,GAAK0P,EAAKjN,GACxDgN,IAAIrS,EAAE7H,KAAOka,GACjBhN,EAAIiN,CACN,CAGA,OAFAtS,EAAE7H,GAAKkN,EACPrK,KAAKylC,GAAKtoC,EAAI,EACP6C,IACT,CACA,OAAA0oB,GACE,MAAM1jB,EAAIhF,KAAKulC,UACf,IAAiBl7B,EAAGzC,EAAGyP,EAAnB/W,EAAIN,KAAKylC,GAAcnuB,EAAK,EAChC,GAAIhX,EAAI,EAAG,CAET,IADAgX,EAAKtS,IAAI1E,GACFA,EAAI,IACT+J,EAAIiN,EACJ1P,EAAI5C,IAAI1E,GACRgX,EAAKjN,EAAIzC,EACTyP,EAAKzP,GAAK0P,EAAKjN,IACXgN,KAEF/W,EAAI,IAAO+W,EAAK,GAAKrS,EAAE1E,EAAI,GAAK,GAAO+W,EAAK,GAAKrS,EAAE1E,EAAI,GAAK,KAC9DsH,EAAS,EAALyP,EACJhN,EAAIiN,EAAK1P,EACLA,GAAKyC,EAAIiN,IAAIA,EAAKjN,GAE1B,CACA,OAAOiN,CACT,ECrCK,SAAS64B,UAAUC,GACxB,MAAO,CAAC,GAAMA,EAAU,GAAIA,EAAU,IAAK,UAAKA,EAAU,IAC5D,CAEO,SAASA,UAAUD,GACxB,IAAIrH,EAASqH,EAAU,GAAIpH,EAAMoH,EAAU,GAAInH,EAAS,GAAID,GAC5D,MAAO,CAACC,EAAS,GAAIF,GAASE,EAAS,GAAIF,GAAS,GAAIC,GAC1D,CAEO,SAASsH,aAAa3vC,EAAGqI,GAC9B,OAAOrI,EAAE,GAAKqI,EAAE,GAAKrI,EAAE,GAAKqI,EAAE,GAAKrI,EAAE,GAAKqI,EAAE,EAC9C,CAEO,SAASunC,eAAe5vC,EAAGqI,GAChC,MAAO,CAACrI,EAAE,GAAKqI,EAAE,GAAKrI,EAAE,GAAKqI,EAAE,GAAIrI,EAAE,GAAKqI,EAAE,GAAKrI,EAAE,GAAKqI,EAAE,GAAIrI,EAAE,GAAKqI,EAAE,GAAKrI,EAAE,GAAKqI,EAAE,GACvF,CAGO,SAASwnC,oBAAoB7vC,EAAGqI,GACrCrI,EAAE,IAAMqI,EAAE,GAAIrI,EAAE,IAAMqI,EAAE,GAAIrI,EAAE,IAAMqI,EAAE,EACxC,CAEO,SAASynC,eAAeC,EAAQvwC,GACrC,MAAO,CAACuwC,EAAO,GAAKvwC,EAAGuwC,EAAO,GAAKvwC,EAAGuwC,EAAO,GAAKvwC,EACpD,CAGO,SAASwwC,0BAA0B3wC,GACxC,IAAIgI,EAAI,GAAKhI,EAAE,GAAKA,EAAE,GAAKA,EAAE,GAAKA,EAAE,GAAKA,EAAE,GAAKA,EAAE,IAClDA,EAAE,IAAMgI,EAAGhI,EAAE,IAAMgI,EAAGhI,EAAE,IAAMgI,CAChC,CC5BA,SAAS4oC,UAAUvW,GACjB,OAAI,GAAIA,EAAM,KAAO,GACZA,EAAM,GAEN,GAAKA,EAAM,MAAQ,GAAIA,EAAM,IAAM,IAAM,GAAM,GAC1D,CCHe,SAAS,gBAAMsQ,GAC5B,OAAOphC,MAAMG,KAPf,SAAU,cAAQihC,GAChB,IAAK,MAAMtgC,KAASsgC,QACXtgC,CAEX,CAGoB,CAAQsgC,GAC5B,CCFe,cAASkG,EAAcC,EAAU7nB,EAAalQ,GAC3D,OAAO,SAASg4B,GACd,IAIItF,EACAvB,EACAwB,EANAhC,EAAOoH,EAASC,GAChBC,EAAa,cACbC,EAAWH,EAASE,GACpBE,GAAiB,EAKjB5G,EAAO,CACTjQ,MACAgO,UACAC,QACAC,aAAc,WACZ+B,EAAKjQ,MAAQ8W,UACb7G,EAAKjC,UAAY+I,UACjB9G,EAAKhC,QAAU+I,QACfnH,EAAW,GACXuB,EAAU,EACZ,EACAjD,WAAY,WACV8B,EAAKjQ,MAAQA,MACbiQ,EAAKjC,UAAYA,UACjBiC,EAAKhC,QAAUA,QACf4B,EAAW,gBAAMA,GACjB,IAAIE,EFrBG,yBAASqB,EAASpR,GAC/B,IAAI0O,EAAS6H,UAAUvW,GACnB2O,EAAM3O,EAAM,GACZiX,EAAS,GAAItI,GACbuI,EAAS,CAAC,GAAIxI,IAAU,GAAIA,GAAS,GACrCyI,EAAQ,EACRjF,EAAU,EAEVkF,EAAM,IAAI,WAEC,IAAXH,EAActI,EAAM,GAAS,IACZ,IAAZsI,IAAetI,GAAO,GAAS,IAExC,IAAK,IAAI5rC,EAAI,EAAGmD,EAAIkrC,EAAQpuC,OAAQD,EAAImD,IAAKnD,EAC3C,GAAM+G,GAAKunC,EAAOD,EAAQruC,IAAIC,OAS9B,IARA,IAAIquC,EACAvnC,EACAutC,EAAShG,EAAKvnC,EAAI,GAClBwtC,EAAUf,UAAUc,GACpBE,EAAOF,EAAO,GAAK,EAAI,GACvBG,EAAU,GAAID,GACdE,EAAU,GAAIF,GAETngC,EAAI,EAAGA,EAAItN,IAAKsN,EAAGkgC,EAAUI,EAASF,EAAUG,EAASF,EAAUG,EAASP,EAASQ,EAAQ,CACpG,IAAIA,EAASxG,EAAKj6B,GACdsgC,EAAUnB,UAAUsB,GACpBC,EAAOD,EAAO,GAAK,EAAI,GACvBF,EAAU,GAAIG,GACdF,EAAU,GAAIE,GACd/6B,EAAQ26B,EAAUJ,EAClBnnB,EAAOpT,GAAS,EAAI,GAAK,EACzBg7B,EAAW5nB,EAAOpT,EAClBi7B,EAAeD,EAAW,GAC1BjyC,EAAI0xC,EAAUG,EAOlB,GALAP,EAAIhiC,IAAI,GAAMtP,EAAIqqB,EAAO,GAAI4nB,GAAWN,EAAUG,EAAU9xC,EAAI,GAAIiyC,KACpEZ,GAASa,EAAej7B,EAAQoT,EAAO,GAAMpT,EAIzCi7B,EAAeV,GAAW5I,EAASgJ,GAAWhJ,EAAQ,CACxD,IAAIiG,EAAMuB,eAAeF,UAAUqB,GAASrB,UAAU6B,IACtDvB,0BAA0B3B,GAC1B,IAAIsD,EAAe/B,eAAegB,EAAQvC,GAC1C2B,0BAA0B2B,GAC1B,IAAIC,GAAUF,EAAej7B,GAAS,GAAK,EAAI,GAAK,UAAKk7B,EAAa,KAClEtJ,EAAMuJ,GAAUvJ,IAAQuJ,IAAWvD,EAAI,IAAMA,EAAI,OACnDzC,GAAW8F,EAAej7B,GAAS,EAAI,GAAK,EAEhD,CACF,CAcF,OAAQo6B,GAAQ,MAAYA,EAAQ,IAAWC,GL1E3B,OK0EyD,EAAVlF,CACrE,CE5C0BiG,CAAgB/G,EAAS1yB,GACvCmxB,EAAS7sC,QACN6zC,IAAgBH,EAAKxI,eAAgB2I,GAAiB,GAC3D,YAAWhH,EAAUC,oBAAqBC,EAAanhB,EAAa8nB,IAC3D3G,IACJ8G,IAAgBH,EAAKxI,eAAgB2I,GAAiB,GAC3DH,EAAK1I,YACLpf,EAAY,KAAM,KAAM,EAAG8nB,GAC3BA,EAAKzI,WAEH4I,IAAgBH,EAAKvI,aAAc0I,GAAiB,GACxDhH,EAAWuB,EAAU,IACvB,EACAlE,OAAQ,WACNwJ,EAAKxI,eACLwI,EAAK1I,YACLpf,EAAY,KAAM,KAAM,EAAG8nB,GAC3BA,EAAKzI,UACLyI,EAAKvI,YACP,GAGF,SAASnO,MAAM0O,EAAQC,GACjB6H,EAAa9H,EAAQC,IAAM+H,EAAK1W,MAAM0O,EAAQC,EACpD,CAEA,SAASyJ,UAAU1J,EAAQC,GACzBU,EAAKrP,MAAM0O,EAAQC,EACrB,CAEA,SAASX,YACPiC,EAAKjQ,MAAQoY,UACb/I,EAAKrB,WACP,CAEA,SAASC,UACPgC,EAAKjQ,MAAQA,MACbqP,EAAKpB,SACP,CAEA,SAAS6I,UAAUpI,EAAQC,GACzB0C,EAAKhvC,KAAK,CAACqsC,EAAQC,IACnBiI,EAAS5W,MAAM0O,EAAQC,EACzB,CAEA,SAASoI,YACPH,EAAS5I,YACTqD,EAAO,EACT,CAEA,SAAS2F,UACPF,UAAUzF,EAAK,GAAG,GAAIA,EAAK,GAAG,IAC9BuF,EAAS3I,UAET,IAEIlrC,EAA4B+G,EAC5BomC,EACAlQ,EAJA8D,EAAQ8S,EAAS9S,QACjBuU,EAAe1B,EAAW7zC,SACvBoD,EAAImyC,EAAar1C,OAQxB,GAJAquC,EAAKnpC,MACLkpC,EAAQ/uC,KAAKgvC,GACbA,EAAO,KAEFnrC,EAGL,GAAY,EAAR49B,GAEF,IAAKh6B,GADLomC,EAAUmI,EAAa,IACNr1C,OAAS,GAAK,EAAG,CAGhC,IAFK6zC,IAAgBH,EAAKxI,eAAgB2I,GAAiB,GAC3DH,EAAK1I,YACAjrC,EAAI,EAAGA,EAAI+G,IAAK/G,EAAG2zC,EAAK1W,OAAOA,EAAQkQ,EAAQntC,IAAI,GAAIi9B,EAAM,IAClE0W,EAAKzI,SACP,OAME/nC,EAAI,GAAa,EAAR49B,GAAWuU,EAAah2C,KAAKg2C,EAAanwC,MAAMzE,OAAO40C,EAAa7I,UAEjFK,EAASxtC,KAAKg2C,EAAa3nC,OAAO4nC,cACpC,CAEA,OAAOrI,CACT,CACF,CAEA,SAASqI,aAAapI,GACpB,OAAOA,EAAQltC,OAAS,CAC1B,CAIA,SAAS8sC,oBAAoBxpC,EAAGqI,GAC9B,QAASrI,EAAIA,EAAE2J,GAAG,GAAK,EAAI3J,EAAE,GAAK,GAAS,GAAU,GAASA,EAAE,MACvDqI,EAAIA,EAAEsB,GAAG,GAAK,EAAItB,EAAE,GAAK,GAAS,GAAU,GAASA,EAAE,GAClE,CC/HA,SAAeshC,KACb,WAAa,OAAO,CAAM,EAS5B,SAASsI,qBAAqB1M,GAC5B,IAGI/H,EAHAwT,EAAUllC,IACVmlC,EAAOnlC,IACPomC,EAAQpmC,IAGZ,MAAO,CACL47B,UAAW,WACTnC,EAAOmC,YACPlK,EAAQ,CACV,EACA9D,MAAO,SAAS0X,EAASI,GACvB,IAAIW,EAAQf,EAAU,EAAI,IAAM,GAC5B36B,EAAQ,GAAI26B,EAAUJ,GACtB,GAAIv6B,EAAQ,IAAM,IACpB8uB,EAAO7L,MAAMsX,EAASC,GAAQA,EAAOO,GAAQ,EAAI,EAAI,IAAU,IAC/DjM,EAAO7L,MAAMwY,EAAOjB,GACpB1L,EAAOoC,UACPpC,EAAOmC,YACPnC,EAAO7L,MAAMyY,EAAOlB,GACpB1L,EAAO7L,MAAM0X,EAASH,GACtBzT,EAAQ,GACC0U,IAAUC,GAAS17B,GAAS,KACjC,GAAIu6B,EAAUkB,GAAS,KAASlB,GAAWkB,EAAQ,IACnD,GAAId,EAAUe,GAAS,KAASf,GAAWe,EAAQ,IACvDlB,EAoBR,SAASmB,0BAA0BpB,EAASC,EAAMG,EAASI,GACzD,IAAIL,EACAG,EACAe,EAAoB,GAAIrB,EAAUI,GACtC,OAAO,GAAIiB,GAAqB,GAC1B,IAAM,GAAIpB,IAASK,EAAU,GAAIE,IAAS,GAAIJ,GAC1C,GAAII,IAASL,EAAU,GAAIF,IAAS,GAAID,KACvCG,EAAUG,EAAUe,KACxBpB,EAAOO,GAAQ,CACxB,CA7BeY,CAA0BpB,EAASC,EAAMG,EAASI,GACzDjM,EAAO7L,MAAMwY,EAAOjB,GACpB1L,EAAOoC,UACPpC,EAAOmC,YACPnC,EAAO7L,MAAMyY,EAAOlB,GACpBzT,EAAQ,GAEV+H,EAAO7L,MAAMsX,EAAUI,EAASH,EAAOO,GACvCU,EAAQC,CACV,EACAxK,QAAS,WACPpC,EAAOoC,UACPqJ,EAAUC,EAAOnlC,GACnB,EACA0xB,MAAO,WACL,OAAO,EAAIA,CACb,EAEJ,EAaA,SAAS8U,4BAA4BvpC,EAAMwhC,EAAIC,EAAWjF,GACxD,IAAI8C,EACJ,GAAY,MAARt/B,EACFs/B,EAAMmC,EAAY,GAClBjF,EAAO7L,OAAO,GAAI2O,GAClB9C,EAAO7L,MAAM,EAAG2O,GAChB9C,EAAO7L,MAAM,GAAI2O,GACjB9C,EAAO7L,MAAM,GAAI,GACjB6L,EAAO7L,MAAM,IAAK2O,GAClB9C,EAAO7L,MAAM,GAAI2O,GACjB9C,EAAO7L,OAAO,IAAK2O,GACnB9C,EAAO7L,OAAO,GAAI,GAClB6L,EAAO7L,OAAO,GAAI2O,QACb,GAAI,GAAIt/B,EAAK,GAAKwhC,EAAG,IAAM,GAAS,CACzC,IAAInC,EAASr/B,EAAK,GAAKwhC,EAAG,GAAK,IAAM,GACrClC,EAAMmC,EAAYpC,EAAS,EAC3B7C,EAAO7L,OAAO0O,EAAQC,GACtB9C,EAAO7L,MAAM,EAAG2O,GAChB9C,EAAO7L,MAAM0O,EAAQC,EACvB,MACE9C,EAAO7L,MAAM6Q,EAAG,GAAIA,EAAG,GAE3B,EApFE,EAAE,IAAK,KCDF,SAASgI,aAAahN,EAAQiN,EAAQ/7B,EAAO+zB,EAAWvc,EAAIhJ,GACjE,GAAKxO,EAAL,CACA,IAAIg8B,EAAY,GAAID,GAChBE,EAAY,GAAIF,GAChBn6B,EAAOmyB,EAAY/zB,EACb,MAANwX,GACFA,EAAKukB,EAAShI,EAAY,GAC1BvlB,EAAKutB,EAASn6B,EAAO,IAErB4V,EAAK0kB,aAAaF,EAAWxkB,GAC7BhJ,EAAK0tB,aAAaF,EAAWxtB,IACzBulB,EAAY,EAAIvc,EAAKhJ,EAAKgJ,EAAKhJ,KAAIgJ,GAAMuc,EAAY,KAE3D,IAAK,IAAI9Q,EAAO55B,EAAImuB,EAAIuc,EAAY,EAAI1qC,EAAImlB,EAAKnlB,EAAImlB,EAAInlB,GAAKuY,EAC5DqhB,EAAQ+V,UAAU,CAACgD,GAAYC,EAAY,GAAI5yC,IAAK4yC,EAAY,GAAI5yC,KACpEylC,EAAO7L,MAAMA,EAAM,GAAIA,EAAM,GAdb,CAgBpB,CAGA,SAASiZ,aAAaF,EAAW/Y,IAC/BA,EAAQgW,UAAUhW,IAAc,IAAM+Y,EACtCzC,0BAA0BtW,GAC1B,IAAI8Y,ETJC,SAAS,UAAK7oC,GACnB,OAAOA,EAAI,EAAI,EAAIA,GAAK,EAAI,GAAK2K,KAAKs+B,KAAKjpC,EAC7C,CSEe,EAAM+vB,EAAM,IACzB,SAAUA,EAAM,GAAK,GAAK8Y,EAASA,GAAU,GAAM,IAAW,EAChE,CCzBA,IAAI,GAAU,IAAK,IAAU,IAKd,SAAS,wBAAc/kB,EAAIyQ,EAAIxQ,EAAI2c,GAEhD,SAASC,QAAQ3gC,EAAGzC,GAClB,OAAOumB,GAAM9jB,GAAKA,GAAK+jB,GAAMwQ,GAAMh3B,GAAKA,GAAKmjC,CAC/C,CAEA,SAAS/hB,YAAYvf,EAAMwhC,EAAIC,EAAWjF,GACxC,IAAIvlC,EAAI,EAAGyqC,EAAK,EAChB,GAAY,MAAR1hC,IACI/I,EAAI0qC,OAAO3hC,EAAMyhC,OAAiBC,EAAKC,OAAOH,EAAIC,KACnDG,aAAa5hC,EAAMwhC,GAAM,EAAIC,EAAY,EAC9C,GAAGjF,EAAO7L,MAAY,IAAN15B,GAAiB,IAANA,EAAUytB,EAAKC,EAAI1tB,EAAI,EAAIqqC,EAAKnM,UACnDl+B,GAAKA,EAAIwqC,EAAY,GAAK,KAAOC,QAEzClF,EAAO7L,MAAM6Q,EAAG,GAAIA,EAAG,GAE3B,CAEA,SAASG,OAAOpmC,EAAGkmC,GACjB,OAAO,GAAIlmC,EAAE,GAAKmpB,GAAM,GAAU+c,EAAY,EAAI,EAAI,EAChD,GAAIlmC,EAAE,GAAKopB,GAAM,GAAU8c,EAAY,EAAI,EAAI,EAC/C,GAAIlmC,EAAE,GAAK45B,GAAM,GAAUsM,EAAY,EAAI,EAAI,EAC/CA,EAAY,EAAI,EAAI,CAC5B,CAEA,SAAShB,oBAAoBxpC,EAAGqI,GAC9B,OAAOsiC,aAAa3qC,EAAE2J,EAAGtB,EAAEsB,EAC7B,CAEA,SAASghC,aAAa3qC,EAAGqI,GACvB,IAAIuiC,EAAKF,OAAO1qC,EAAG,GACf6qC,EAAKH,OAAOriC,EAAG,GACnB,OAAOuiC,IAAOC,EAAKD,EAAKC,EACX,IAAPD,EAAWviC,EAAE,GAAKrI,EAAE,GACb,IAAP4qC,EAAW5qC,EAAE,GAAKqI,EAAE,GACb,IAAPuiC,EAAW5qC,EAAE,GAAKqI,EAAE,GACpBA,EAAE,GAAKrI,EAAE,EACjB,CAEA,OAAO,SAASulC,GACd,IAEIgE,EACAuB,EACAC,EACAC,EAAKC,EAAKC,EACVC,EAAIC,EAAIC,EACRC,EACA9N,EARA+N,EAAehG,EACfiG,EAAe,cASfC,EAAa,CACf/R,MACAgO,UAgDF,SAASA,YACP+D,EAAW/R,MAAQgS,UACfZ,GAASA,EAAQ/uC,KAAKgvC,EAAO,IACjCO,GAAQ,EACRD,GAAK,EACLF,EAAKC,EAAKt/B,GACZ,EArDE67B,QA0DF,SAASA,UACH4B,IACFmC,UAAUV,EAAKC,GACXC,GAAOG,GAAIG,EAAavC,SAC5BM,EAASxtC,KAAKyvC,EAAahvC,WAE7BivC,EAAW/R,MAAQA,MACf2R,GAAIE,EAAa5D,SACvB,EAjEEC,aAuBF,SAASA,eACP2D,EAAeC,EAAcjC,EAAW,GAAIuB,EAAU,GAAItN,GAAQ,CACpE,EAxBEqK,WA0BF,SAASA,aACP,IAAI4B,EApBN,SAASkC,gBAGP,IAFA,IAAIC,EAAU,EAELnvC,EAAI,EAAGmD,EAAIkrC,EAAQpuC,OAAQD,EAAImD,IAAKnD,EAC3C,IAAK,IAAgEovC,EAAIpB,EAAhEM,EAAOD,EAAQruC,GAAIqU,EAAI,EAAGtN,EAAIunC,EAAKruC,OAAQg9B,EAAQqR,EAAK,GAAYjS,EAAKY,EAAM,GAAIX,EAAKW,EAAM,GAAI5oB,EAAItN,IAAKsN,EAClH+6B,EAAK/S,EAAI2R,EAAK1R,EAAqBD,GAAjBY,EAAQqR,EAAKj6B,IAAe,GAAIioB,EAAKW,EAAM,GACzD+Q,GAAMJ,EAAUtR,EAAKsR,IAAOvR,EAAK+S,IAAOxB,EAAKI,IAAO1R,EAAK0R,IAAOhd,EAAKoe,MAAOD,EACrE7S,GAAMsR,IAAOvR,EAAK+S,IAAOxB,EAAKI,IAAO1R,EAAK0R,IAAOhd,EAAKoe,MAAOD,EAI5E,OAAOA,CACT,CAQoBD,GACdG,EAActO,GAASiM,EACvBa,GAAWf,EAAW,gBAAMA,IAAW7sC,QACvCovC,GAAexB,KACjB/E,EAAOqC,eACHkE,IACFvG,EAAOmC,YACPpf,YAAY,KAAM,KAAM,EAAGid,GAC3BA,EAAOoC,WAEL2C,GACF,YAAWf,EAAUC,oBAAqBC,EAAanhB,YAAaid,GAEtEA,EAAOsC,cAET0D,EAAehG,EAAQgE,EAAWuB,EAAUC,EAAO,IACrD,GAxCA,SAASrR,MAAM/vB,EAAGzC,GACZojC,QAAQ3gC,EAAGzC,IAAIqkC,EAAa7R,MAAM/vB,EAAGzC,EAC3C,CA6DA,SAASwkC,UAAU/hC,EAAGzC,GACpB,IAAI3H,EAAI+qC,QAAQ3gC,EAAGzC,GAEnB,GADI4jC,GAASC,EAAKhvC,KAAK,CAAC4N,EAAGzC,IACvBokC,EACFN,EAAMrhC,EAAGshC,EAAM/jC,EAAGgkC,EAAM3rC,EACxB+rC,GAAQ,EACJ/rC,IACFgsC,EAAa7D,YACb6D,EAAa7R,MAAM/vB,EAAGzC,SAGxB,GAAI3H,GAAK8rC,EAAIE,EAAa7R,MAAM/vB,EAAGzC,OAC9B,CACH,IAAIlH,EAAI,CAACmrC,EAAK72B,KAAK4B,IAAI,GAAS5B,KAAKC,IAAI,GAAS42B,IAAMC,EAAK92B,KAAK4B,IAAI,GAAS5B,KAAKC,IAAI,GAAS62B,KAC7F/iC,EAAI,CAACsB,EAAI2K,KAAK4B,IAAI,GAAS5B,KAAKC,IAAI,GAAS5K,IAAKzC,EAAIoN,KAAK4B,IAAI,GAAS5B,KAAKC,IAAI,GAASrN,MClJzF,uBAASlH,EAAGqI,EAAGolB,EAAIyQ,EAAIxQ,EAAI2c,GACxC,IAQIxqC,EARAksC,EAAK/rC,EAAE,GACPgsC,EAAKhsC,EAAE,GAGPiuB,EAAK,EACLhJ,EAAK,EACLyT,EAJKrwB,EAAE,GAIG0jC,EACVpT,EAJKtwB,EAAE,GAIG2jC,EAId,GADAnsC,EAAI4tB,EAAKse,EACJrT,KAAM74B,EAAI,GAAf,CAEA,GADAA,GAAK64B,EACDA,EAAK,EAAG,CACV,GAAI74B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,MAAO,GAAI64B,EAAK,EAAG,CACjB,GAAI74B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,CAGA,GADAA,EAAI6tB,EAAKqe,EACJrT,KAAM74B,EAAI,GAAf,CAEA,GADAA,GAAK64B,EACDA,EAAK,EAAG,CACV,GAAI74B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,MAAO,GAAI64B,EAAK,EAAG,CACjB,GAAI74B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,CAGA,GADAA,EAAIq+B,EAAK8N,EACJrT,KAAM94B,EAAI,GAAf,CAEA,GADAA,GAAK84B,EACDA,EAAK,EAAG,CACV,GAAI94B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,MAAO,GAAI84B,EAAK,EAAG,CACjB,GAAI94B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,CAGA,GADAA,EAAIwqC,EAAK2B,EACJrT,KAAM94B,EAAI,GAAf,CAEA,GADAA,GAAK84B,EACDA,EAAK,EAAG,CACV,GAAI94B,EAAIolB,EAAI,OACRplB,EAAIouB,IAAIA,EAAKpuB,EACnB,MAAO,GAAI84B,EAAK,EAAG,CACjB,GAAI94B,EAAIouB,EAAI,OACRpuB,EAAIolB,IAAIA,EAAKplB,EACnB,CAIA,OAFIouB,EAAK,IAAGjuB,EAAE,GAAK+rC,EAAK9d,EAAKyK,EAAI14B,EAAE,GAAKgsC,EAAK/d,EAAK0K,GAC9C1T,EAAK,IAAG5c,EAAE,GAAK0jC,EAAK9mB,EAAKyT,EAAIrwB,EAAE,GAAK2jC,EAAK/mB,EAAK0T,IAC3C,CAZiB,CAXA,CAXA,CAXA,CA8C1B,CDyFc,CAAS34B,EAAGqI,EAAGolB,EAAIyQ,EAAIxQ,EAAI2c,GAQpB9qC,IACTgsC,EAAa7D,YACb6D,EAAa7R,MAAM/vB,EAAGzC,GACtBs2B,GAAQ,IAVH6N,IACHE,EAAa7D,YACb6D,EAAa7R,MAAM15B,EAAE,GAAIA,EAAE,KAE7BurC,EAAa7R,MAAMrxB,EAAE,GAAIA,EAAE,IACtB9I,GAAGgsC,EAAa5D,UACrBnK,GAAQ,EAMZ,CAEF2N,EAAKxhC,EAAGyhC,EAAKlkC,EAAGmkC,EAAK9rC,CACvB,CAEA,OAAOksC,CACT,CACF,CEvKe,iBAASzrC,EAAGqI,GAEzB,SAASwqC,QAAQlpC,EAAGzC,GAClB,OAAOyC,EAAI3J,EAAE2J,EAAGzC,GAAImB,EAAEsB,EAAE,GAAIA,EAAE,GAChC,CAMA,OAJI3J,EAAEmpB,QAAU9gB,EAAE8gB,SAAQ0pB,QAAQ1pB,OAAS,SAASxf,EAAGzC,GACrD,OAAOyC,EAAItB,EAAE8gB,OAAOxf,EAAGzC,KAASlH,EAAEmpB,OAAOxf,EAAE,GAAIA,EAAE,GACnD,GAEOkpC,OACT,CCXA,uCAAelpC,GAAKA,ECGpB,SAASmpC,iBAAiB1K,EAAQC,GAChC,MAAO,CAAC,GAAID,GAAU,GAAKA,EAAS9zB,KAAKuE,OAAOuvB,EAAS,IAAO,GAAMA,EAAQC,EAChF,CAIO,SAAS,uBAAc0K,EAAaC,EAAUC,GACnD,OAAQF,GAAe,IAAQC,GAAYC,EAAaJ,QAAQK,eAAeH,GAAcI,iBAAiBH,EAAUC,IACpHC,eAAeH,GACdC,GAAYC,EAAaE,iBAAiBH,EAAUC,GACrDH,gBACN,CAEA,SAASM,sBAAsBL,GAC7B,OAAO,SAAS3K,EAAQC,GACtB,MAA8B,EAAvBD,GAAU2K,GAAuB,GAAK3K,EAAS,GAAMA,GAAU,GAAKA,EAAS,GAAMA,EAAQC,EACpG,CACF,CAEA,SAAS6K,eAAeH,GACtB,IAAIM,EAAWD,sBAAsBL,GAErC,OADAM,EAASlqB,OAASiqB,uBAAuBL,GAClCM,CACT,CAEA,SAASF,iBAAiBH,EAAUC,GAClC,IAAIK,EAAc,GAAIN,GAClBO,EAAc,GAAIP,GAClBQ,EAAgB,GAAIP,GACpBQ,EAAgB,GAAIR,GAExB,SAASI,SAASjL,EAAQC,GACxB,IAAIC,EAAS,GAAID,GACb1+B,EAAI,GAAIy+B,GAAUE,EAClBphC,EAAI,GAAIkhC,GAAUE,EAClBha,EAAI,GAAI+Z,GACR7oC,EAAI8uB,EAAIglB,EAAc3pC,EAAI4pC,EAC9B,MAAO,CACL,GAAMrsC,EAAIssC,EAAgBh0C,EAAIi0C,EAAe9pC,EAAI2pC,EAAchlB,EAAIilB,GACnE,UAAK/zC,EAAIg0C,EAAgBtsC,EAAIusC,GAEjC,CAcA,OAZAJ,SAASlqB,OAAS,SAASif,EAAQC,GACjC,IAAIC,EAAS,GAAID,GACb1+B,EAAI,GAAIy+B,GAAUE,EAClBphC,EAAI,GAAIkhC,GAAUE,EAClBha,EAAI,GAAI+Z,GACR7oC,EAAI8uB,EAAIklB,EAAgBtsC,EAAIusC,EAChC,MAAO,CACL,GAAMvsC,EAAIssC,EAAgBllB,EAAImlB,EAAe9pC,EAAI2pC,EAAc9zC,EAAI+zC,GACnE,UAAK/zC,EAAI8zC,EAAc3pC,EAAI4pC,GAE/B,EAEOF,QACT,CCrDO,SAAS,0BAAYpH,GAC1B,OAAO,SAAS1G,GACd,IAAI9gB,EAAI,IAAI,0BACZ,IAAK,IAAIzc,KAAOikC,EAASxnB,EAAEzc,GAAOikC,EAAQjkC,GAE1C,OADAyc,EAAE8gB,OAASA,EACJ9gB,CACT,CACF,CAEA,SAAS,4BAAmB,CCf5B,SAAS,sBAAe6gB,EAAUC,GAC5BD,GAAY,GAAmBl9B,eAAek9B,EAASv0B,OACzD,GAAmBu0B,EAASv0B,MAAMu0B,EAAUC,EAEhD,CFGAuN,iBAAiB3pB,OAAS2pB,iBCU1B,0BAAgB9sC,UAAY,CAC1BrC,YAAa,0BACb+1B,MAAO,SAAS/vB,EAAGzC,GAAK5H,KAAKimC,OAAO7L,MAAM/vB,EAAGzC,EAAI,EACjD0/B,OAAQ,WAAatnC,KAAKimC,OAAOqB,QAAU,EAC3Cc,UAAW,WAAapoC,KAAKimC,OAAOmC,WAAa,EACjDC,QAAS,WAAaroC,KAAKimC,OAAOoC,SAAW,EAC7CC,aAAc,WAAatoC,KAAKimC,OAAOqC,cAAgB,EACvDC,WAAY,WAAavoC,KAAKimC,OAAOsC,YAAc,GClBrD,IAAI,GAAmB,CACrBrB,QAAS,SAASve,EAAQsd,GACxB,sBAAetd,EAAOqd,SAAUC,EAClC,EACAkB,kBAAmB,SAASxe,EAAQsd,GAElC,IADA,IAAImB,EAAWze,EAAOye,SAAUjqC,GAAK,EAAGmD,EAAI8mC,EAAShqC,SAC5CD,EAAImD,GAAG,sBAAe8mC,EAASjqC,GAAG6oC,SAAUC,EACvD,GAGE,GAAqB,CACvBoB,OAAQ,SAAS1e,EAAQsd,GACvBA,EAAOqB,QACT,EACAC,MAAO,SAAS5e,EAAQsd,GACtBtd,EAASA,EAAO6e,YAChBvB,EAAO7L,MAAMzR,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAC5C,EACA8e,WAAY,SAAS9e,EAAQsd,GAE3B,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAGqoB,EAAS6e,EAAYrqC,GAAI8oC,EAAO7L,MAAMzR,EAAO,GAAIA,EAAO,GAAIA,EAAO,GACrF,EACA+e,WAAY,SAAS/e,EAAQsd,GAC3B,kBAAWtd,EAAO6e,YAAavB,EAAQ,EACzC,EACA2B,gBAAiB,SAASjf,EAAQsd,GAEhC,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAG,kBAAWknC,EAAYrqC,GAAI8oC,EAAQ,EACrD,EACA4B,QAAS,SAASlf,EAAQsd,GACxB,qBAActd,EAAO6e,YAAavB,EACpC,EACA8B,aAAc,SAASpf,EAAQsd,GAE7B,IADA,IAAIuB,EAAc7e,EAAO6e,YAAarqC,GAAK,EAAGmD,EAAIknC,EAAYpqC,SACrDD,EAAImD,GAAG,qBAAcknC,EAAYrqC,GAAI8oC,EAChD,EACA+B,mBAAoB,SAASrf,EAAQsd,GAEnC,IADA,IAAIgC,EAAatf,EAAOsf,WAAY9qC,GAAK,EAAGmD,EAAI2nC,EAAW7qC,SAClDD,EAAImD,GAAG,sBAAe2nC,EAAW9qC,GAAI8oC,EAChD,GAGF,SAAS,kBAAWuB,EAAavB,EAAQiC,GACvC,IAA6CC,EAAzChrC,GAAK,EAAGmD,EAAIknC,EAAYpqC,OAAS8qC,EAErC,IADAjC,EAAOmC,cACEjrC,EAAImD,GAAG6nC,EAAaX,EAAYrqC,GAAI8oC,EAAO7L,MAAM+N,EAAW,GAAIA,EAAW,GAAIA,EAAW,IACnGlC,EAAOoC,SACT,CAEA,SAAS,qBAAcb,EAAavB,GAClC,IAAI9oC,GAAK,EAAGmD,EAAIknC,EAAYpqC,OAE5B,IADA6oC,EAAOqC,iBACEnrC,EAAImD,GAAG,kBAAWknC,EAAYrqC,GAAI8oC,EAAQ,GACnDA,EAAOsC,YACT,CC1DA,IAAI,GAAKnb,IACL,GAAK,GACL,IAAM,GACN,GAAK,GAEL,GAAe,CACjBgN,MAYF,SAAS,mBAAY/vB,EAAGzC,GAClByC,EAAI,KAAI,GAAKA,GACbA,EAAI,KAAI,GAAKA,GACbzC,EAAI,KAAI,GAAKA,GACbA,EAAI,KAAI,GAAKA,EACnB,EAhBEwgC,UAAW,cACXC,QAAS,cACTC,aAAc,cACdC,WAAY,cACZrrC,OAAQ,WACN,IAAI6vC,EAAS,CAAC,CAAC,GAAI,IAAK,CAAC,GAAI,KAE7B,OADA,GAAK,KAAO,GAAK,GAAK3f,KACf2f,CACT,GAUF,YCxBA,SAAS,QAAIE,EAAYC,EAAWvkB,GAClC,IAAI0hB,EAAO4C,EAAWE,YAAcF,EAAWE,aAM/C,OALAF,EAAW90B,MAAM,KAAKyb,UAAU,CAAC,EAAG,IACxB,MAARyW,GAAc4C,EAAWE,WAAW,MFwD3B,oBAASxkB,EAAQsd,GAC1Btd,GAAU,GAAiB7f,eAAe6f,EAAOlX,MACnD,GAAiBkX,EAAOlX,MAAMkX,EAAQsd,GAEtC,sBAAetd,EAAQsd,EAE3B,CE7DE,CAAUtd,EAAQskB,EAAWhH,OAAO,KACpCiH,EAAU,GAAahwC,UACX,MAARmtC,GAAc4C,EAAWE,WAAW9C,GACjC4C,CACT,CAEO,SAAS,cAAUA,EAAYvQ,EAAQ/T,GAC5C,OAAO,QAAIskB,EAAY,SAASlkC,GAC9B,IAAI3D,EAAIs3B,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC7BxX,EAAIwX,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC7Bx8B,EAAI8U,KAAKC,IAAI7P,GAAK2D,EAAE,GAAG,GAAKA,EAAE,GAAG,IAAKmc,GAAKnc,EAAE,GAAG,GAAKA,EAAE,GAAG,KAC1DsB,GAAKqyB,EAAO,GAAG,IAAMt3B,EAAIlF,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACpDnB,GAAK80B,EAAO,GAAG,IAAMxX,EAAIhlB,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACxDkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CClBA,IACIyrB,GAAiB,GAAI,GAAK,IAEf,kBAASC,EAASC,GAC/B,OAAQA,EAYV,SAAS,kBAASD,EAASC,GAEzB,SAASC,eAAepmB,EAAIyQ,EAAI8S,EAASnF,EAAI/S,EAAIgb,EAAIpmB,EAAI2c,EAAI+G,EAAS3G,EAAI1R,EAAIgb,EAAIC,EAAOzO,GACvF,IAAI7M,EAAKhL,EAAKD,EACVkL,EAAK0R,EAAKnM,EACVtF,EAAKF,EAAKA,EAAKC,EAAKA,EACxB,GAAIC,EAAK,EAAIgb,GAAUI,IAAS,CAC9B,IAAIh0C,EAAI6rC,EAAKpB,EACTpiC,EAAIywB,EAAKC,EACTzyB,EAAIwtC,EAAKC,EACTvwC,EAAI,GAAKxD,EAAIA,EAAIqI,EAAIA,EAAI/B,EAAIA,GAC7B2tC,EAAO,UAAK3tC,GAAK9C,GACjB0wC,EAAU,GAAI,GAAI5tC,GAAK,GAAK,IAAW,GAAI0qC,EAAUI,GAAW,IAAWJ,EAAUI,GAAW,EAAI,GAAM/oC,EAAGrI,GAC7GsE,EAAIqvC,EAAQO,EAASD,GACrBE,EAAK7vC,EAAE,GACP8vC,EAAK9vC,EAAE,GACP+vC,EAAMF,EAAK1mB,EACX6mB,EAAMF,EAAKlW,EACXqW,EAAK5b,EAAK0b,EAAM3b,EAAK4b,GACrBC,EAAKA,EAAK3b,EAAKgb,GACZ,IAAKlb,EAAK2b,EAAM1b,EAAK2b,GAAO1b,EAAK,IAAO,IACxCiT,EAAKpB,EAAK3R,EAAKC,EAAK+a,EAAKC,EAAKL,MACnCG,eAAepmB,EAAIyQ,EAAI8S,EAASnF,EAAI/S,EAAIgb,EAAIK,EAAIC,EAAIF,EAASl0C,GAAKwD,EAAG6E,GAAK7E,EAAG8C,EAAG0tC,EAAOzO,GACvFA,EAAO7L,MAAMya,EAAIC,GACjBP,eAAeM,EAAIC,EAAIF,EAASl0C,EAAGqI,EAAG/B,EAAGonB,EAAI2c,EAAI+G,EAAS3G,EAAI1R,EAAIgb,EAAIC,EAAOzO,GAEjF,CACF,CACA,OAAO,SAASA,GACd,IAAIa,EAAU0G,EAAKC,EAAKyH,EAAKC,EAAKC,EAC9B1D,EAASvjB,EAAIyQ,EAAI2N,EAAI/S,EAAIgb,EAEzBa,EAAiB,CACnBjb,MACAgO,UACAC,QACAC,aAAc,WAAarC,EAAOqC,eAAgB+M,EAAejN,UAAY+I,SAAW,EACxF5I,WAAY,WAAatC,EAAOsC,aAAc8M,EAAejN,UAAYA,SAAW,GAGtF,SAAShO,MAAM/vB,EAAGzC,GAChByC,EAAIgqC,EAAQhqC,EAAGzC,GACfq+B,EAAO7L,MAAM/vB,EAAE,GAAIA,EAAE,GACvB,CAEA,SAAS+9B,YACPja,EAAK3hB,IACL6oC,EAAejb,MAAQgS,UACvBnG,EAAOmC,WACT,CAEA,SAASgE,UAAUtD,EAAQC,GACzB,IAAI/hC,EAAIopC,UAAU,CAACtH,EAAQC,IAAO/jC,EAAIqvC,EAAQvL,EAAQC,GACtDwL,eAAepmB,EAAIyQ,EAAI8S,EAASnF,EAAI/S,EAAIgb,EAAIrmB,EAAKnpB,EAAE,GAAI45B,EAAK55B,EAAE,GAAI0sC,EAAU5I,EAAQyD,EAAKvlC,EAAE,GAAIwyB,EAAKxyB,EAAE,GAAIwtC,EAAKxtC,EAAE,GArExG,GAqEsHi/B,GAC/HA,EAAO7L,MAAMjM,EAAIyQ,EACnB,CAEA,SAASyJ,UACPgN,EAAejb,MAAQA,MACvB6L,EAAOoC,SACT,CAEA,SAAS8I,YACP/I,YACAiN,EAAejb,MAAQkb,UACvBD,EAAehN,QAAU+I,OAC3B,CAEA,SAASkE,UAAUxM,EAAQC,GACzBqD,UAAUtF,EAAWgC,EAAQC,GAAMyE,EAAMrf,EAAIsf,EAAM7O,EAAIsW,EAAM3I,EAAI4I,EAAM3b,EAAI4b,EAAMZ,EACjFa,EAAejb,MAAQgS,SACzB,CAEA,SAASgF,UACPmD,eAAepmB,EAAIyQ,EAAI8S,EAASnF,EAAI/S,EAAIgb,EAAIhH,EAAKC,EAAK3G,EAAUoO,EAAKC,EAAKC,EA1FjE,GA0FgFnP,GACzFoP,EAAehN,QAAUA,QACzBA,SACF,CAEA,OAAOgN,CACT,CACF,CA7FmB,CAAShB,EAASC,GAGrC,SAASiB,aAAalB,GACpB,OAAO,0BAAY,CACjBja,MAAO,SAAS/vB,EAAGzC,GACjByC,EAAIgqC,EAAQhqC,EAAGzC,GACf5H,KAAKimC,OAAO7L,MAAM/vB,EAAE,GAAIA,EAAE,GAC5B,GAEJ,CAV+CkrC,CAAalB,EAC5D,CCEA,IAAImB,GAAmB,0BAAY,CACjCpb,MAAO,SAAS/vB,EAAGzC,GACjB5H,KAAKimC,OAAO7L,MAAM/vB,EAAI,GAASzC,EAAI,GACrC,IAuBF,SAAS6tC,qBAAqBv1C,EAAGk5B,EAAIC,EAAIqc,EAAIC,EAAIC,GAC/C,IAAKA,EAAO,OAZd,SAASC,eAAe31C,EAAGk5B,EAAIC,EAAIqc,EAAIC,GACrC,SAASpsB,UAAUlf,EAAGzC,GAEpB,MAAO,CAACwxB,EAAKl5B,GADbmK,GAAKqrC,GACerc,EAAKn5B,GADhB0H,GAAK+tC,GAEhB,CAIA,OAHApsB,UAAUM,OAAS,SAASxf,EAAGzC,GAC7B,MAAO,EAAEyC,EAAI+uB,GAAMl5B,EAAIw1C,GAAKrc,EAAKzxB,GAAK1H,EAAIy1C,EAC5C,EACOpsB,SACT,CAGqBssB,CAAe31C,EAAGk5B,EAAIC,EAAIqc,EAAIC,GACjD,IAAIG,EAAW,GAAIF,GACfG,EAAW,GAAIH,GACfl1C,EAAIo1C,EAAW51C,EACf6I,EAAIgtC,EAAW71C,EACf81C,EAAKF,EAAW51C,EAChBgoB,EAAK6tB,EAAW71C,EAChB+1C,GAAMF,EAAW1c,EAAKyc,EAAW1c,GAAMl5B,EACvCg2C,GAAMH,EAAW3c,EAAK0c,EAAWzc,GAAMn5B,EAC3C,SAASqpB,UAAUlf,EAAGzC,GAEpB,MAAO,CAAClH,GADR2J,GAAKqrC,GACW3sC,GADPnB,GAAK+tC,GACUvc,EAAIC,EAAKtwB,EAAIsB,EAAI3J,EAAIkH,EAC/C,CAIA,OAHA2hB,UAAUM,OAAS,SAASxf,EAAGzC,GAC7B,MAAO,CAAC8tC,GAAMM,EAAK3rC,EAAI6d,EAAKtgB,EAAIquC,GAAKN,GAAMO,EAAKhuB,EAAK7d,EAAI2rC,EAAKpuC,GAChE,EACO2hB,SACT,CAEe,SAAS0jB,WAAWoH,GACjC,OAGK,SAAS8B,kBAAkBC,GAChC,IAAI/B,EAI+CnhB,EAKpC0L,EAAIxQ,EAAI2c,EAEnBsL,EACAC,EACAC,EACAC,EACAC,EAdAv2C,EAAI,IACJmK,EAAI,IAAKzC,EAAI,IACbkhC,EAAS,EAAGC,EAAM,EAClB0K,EAAc,EAAGC,EAAW,EAAGC,EAAa,EAC5CiC,EAAQ,EACRF,EAAK,EACLC,EAAK,EACLe,EAAQ,KAAMC,EAAU,GACxBxoB,EAAK,KAAkByoB,EAAW,iCAClCtC,EAAS,GAOb,SAASrH,WAAW7S,GAClB,OAAOmc,EAAuBnc,EAAM,GAAK,GAASA,EAAM,GAAK,GAC/D,CAEA,SAASvQ,OAAOuQ,GAEd,OADAA,EAAQmc,EAAuB1sB,OAAOuQ,EAAM,GAAIA,EAAM,MACtC,CAACA,EAAM,GAAK,GAASA,EAAM,GAAK,GAClD,CAsEA,SAASyc,WACP,IAAIp/B,EAASg+B,qBAAqBv1C,EAAG,EAAG,EAAGw1C,EAAIC,EAAIC,GAAOzuC,MAAM,KAAMktC,EAAQvL,EAAQC,IAClFxf,EAAYksB,qBAAqBv1C,EAAGmK,EAAIoN,EAAO,GAAI7P,EAAI6P,EAAO,GAAIi+B,EAAIC,EAAIC,GAK9E,OAJA1iB,EAAS,uBAAcugB,EAAaC,EAAUC,GAC9C2C,EAAmB/C,QAAQc,EAAS9qB,GACpCgtB,EAAyBhD,QAAQrgB,EAAQojB,GACzCD,EAAkBS,SAASR,EAAkBhC,GACtCyC,OACT,CAEA,SAASA,QAEP,OADAP,EAAQC,EAAc,KACfxJ,UACT,CAEA,OAnFAA,WAAWhH,OAAS,SAASA,GAC3B,OAAOuQ,GAASC,IAAgBxQ,EAASuQ,EAAQA,EAAQhB,GAxE7D,SAASwB,gBAAgB9jB,GACvB,OAAO,0BAAY,CACjBkH,MAAO,SAAS/vB,EAAGzC,GACjB,IAAIrH,EAAI2yB,EAAO7oB,EAAGzC,GAClB,OAAO5H,KAAKimC,OAAO7L,MAAM75B,EAAE,GAAIA,EAAE,GACnC,GAEJ,CAiE8Ey2C,CAAgB9jB,EAAhB8jB,CAAwBL,EAAQN,EAAgBO,EAASH,EAAcxQ,MACnJ,EAEAgH,WAAW0J,QAAU,SAASr+B,GAC5B,OAAOxK,UAAU1Q,QAAUu5C,EAAUr+B,EAAGo+B,OAAQn1C,EAAWw1C,SAAWJ,CACxE,EAEA1J,WAAW2J,SAAW,SAASt+B,GAC7B,OAAOxK,UAAU1Q,QAAUw5C,EAAWt+B,EAAG6V,EAAKyQ,EAAKxQ,EAAK2c,EAAK,KAAMgM,SAAWH,CAChF,EAEA3J,WAAWgK,UAAY,SAAS3+B,GAC9B,OAAOxK,UAAU1Q,QAAUu5C,GAAWr+B,EC/F3B,qBAAS46B,GACtB,IAAIgE,EAAK,GAAIhE,GACT/7B,EAAQ,EAAI,GACZggC,EAAcD,EAAK,EACnBE,EAAgB,GAAIF,GAAM,GAM9B,SAASlM,QAAQlC,EAAQC,GACvB,OAAO,GAAID,GAAU,GAAIC,GAAOmO,CAClC,CAiFA,SAASG,UAAU32C,EAAGqI,EAAGuuC,GACvB,IAKIC,EAAK,CAAC,EAAG,EAAG,GACZC,EAAKlH,eANAF,UAAU1vC,GACV0vC,UAAUrnC,IAMf0uC,EAAOpH,aAAamH,EAAIA,GACxBE,EAAOF,EAAG,GACVG,EAAcF,EAAOC,EAAOA,EAGhC,IAAKC,EAAa,OAAQL,GAAO52C,EAEjC,IAAI+zC,EAAMyC,EAAKO,EAAOE,EAClBC,GAAMV,EAAKQ,EAAOC,EAClBE,EAAQvH,eAAeiH,EAAIC,GAC3BM,EAAItH,eAAe+G,EAAI9C,GAE3BlE,oBAAoBuH,EADZtH,eAAegH,EAAII,IAI3B,IAAIjyC,EAAIkyC,EACJzyC,EAAIirC,aAAayH,EAAGnyC,GACpBoyC,EAAK1H,aAAa1qC,EAAGA,GACrBqgB,EAAK5gB,EAAIA,EAAI2yC,GAAM1H,aAAayH,EAAGA,GAAK,GAE5C,KAAI9xB,EAAK,GAAT,CAEA,IAAIxlB,EAAI,GAAKwlB,GACToC,EAAIooB,eAAe7qC,IAAKP,EAAI5E,GAAKu3C,GAIrC,GAHAxH,oBAAoBnoB,EAAG0vB,GACvB1vB,EAAI+nB,UAAU/nB,IAETkvB,EAAK,OAAOlvB,EAGjB,IAII4G,EAJA0iB,EAAUhxC,EAAE,GACZoxC,EAAU/oC,EAAE,GACZ4oC,EAAOjxC,EAAE,GACTwxC,EAAOnpC,EAAE,GAGT+oC,EAAUJ,IAAS1iB,EAAI0iB,EAASA,EAAUI,EAASA,EAAU9iB,GAEjE,IAAI7X,EAAQ26B,EAAUJ,EAClBsG,EAAQ,GAAI7gC,EAAQ,IAAM,GAM9B,IAHK6gC,GAAS9F,EAAOP,IAAM3iB,EAAI2iB,EAAMA,EAAOO,EAAMA,EAAOljB,GAF1CgpB,GAAS7gC,EAAQ,GAM1B6gC,EACErG,EAAOO,EAAO,EAAI9pB,EAAE,IAAM,GAAIA,EAAE,GAAKspB,GAAW,GAAUC,EAAOO,GACjEP,GAAQvpB,EAAE,IAAMA,EAAE,IAAM8pB,EAC1B/6B,EAAQ,IAAMu6B,GAAWtpB,EAAE,IAAMA,EAAE,IAAM0pB,GAAU,CACvD,IAAImG,EAAKzH,eAAe7qC,IAAKP,EAAI5E,GAAKu3C,GAEtC,OADAxH,oBAAoB0H,EAAIH,GACjB,CAAC1vB,EAAG+nB,UAAU8H,GACvB,CAjCkB,CAkCpB,CAIA,SAASC,KAAKpP,EAAQC,GACpB,IAAIxoC,EAAI42C,EAAcjE,EAAS,GAAKA,EAChCgF,EAAO,EAKX,OAJIpP,GAAUvoC,EAAG23C,GAAQ,EAChBpP,EAASvoC,IAAG23C,GAAQ,GACzBnP,GAAOxoC,EAAG23C,GAAQ,EACbnP,EAAMxoC,IAAG23C,GAAQ,GACnBA,CACT,CAEA,OAAO7N,KAAKW,QAvJZ,SAAS6F,SAAS5K,GAChB,IAAIwL,EACA+C,EACA5uB,EACAuyB,EACAja,EACJ,MAAO,CACLkK,UAAW,WACT+P,EAAMvyB,GAAK,EACXsY,EAAQ,CACV,EACA9D,MAAO,SAAS0O,EAAQC,GACtB,IACIqP,EADAnG,EAAS,CAACnJ,EAAQC,GAElB9oC,EAAI+qC,QAAQlC,EAAQC,GACpB/hC,EAAImwC,EACAl3C,EAAI,EAAIi4C,KAAKpP,EAAQC,GACrB9oC,EAAIi4C,KAAKpP,GAAUA,EAAS,EAAI,IAAM,IAAKC,GAAO,EAO1D,IANK0I,IAAW0G,EAAMvyB,EAAK3lB,IAAIgmC,EAAOmC,YAClCnoC,IAAM2lB,MACRwyB,EAASf,UAAU5F,EAAQQ,KACZ,eAAWR,EAAQ2G,IAAW,eAAWnG,EAAQmG,MAC9DnG,EAAO,GAAK,GAEZhyC,IAAM2lB,EACRsY,EAAQ,EACJj+B,GAEFgmC,EAAOmC,YACPgQ,EAASf,UAAUpF,EAAQR,GAC3BxL,EAAO7L,MAAMge,EAAO,GAAIA,EAAO,MAG/BA,EAASf,UAAU5F,EAAQQ,GAC3BhM,EAAO7L,MAAMge,EAAO,GAAIA,EAAO,GAAI,GACnCnS,EAAOoC,WAEToJ,EAAS2G,OACJ,GAAIhB,GAAiB3F,GAAU0F,EAAcl3C,EAAG,CACrD,IAAIO,EAGEwG,EAAIwtC,KAAQh0C,EAAI62C,UAAUpF,EAAQR,GAAQ,MAC9CvT,EAAQ,EACJiZ,GACFlR,EAAOmC,YACPnC,EAAO7L,MAAM55B,EAAE,GAAG,GAAIA,EAAE,GAAG,IAC3BylC,EAAO7L,MAAM55B,EAAE,GAAG,GAAIA,EAAE,GAAG,IAC3BylC,EAAOoC,YAEPpC,EAAO7L,MAAM55B,EAAE,GAAG,GAAIA,EAAE,GAAG,IAC3BylC,EAAOoC,UACPpC,EAAOmC,YACPnC,EAAO7L,MAAM55B,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAI,IAGrC,EACIP,GAAOwxC,GAAW,eAAWA,EAAQQ,IACvChM,EAAO7L,MAAM6X,EAAO,GAAIA,EAAO,IAEjCR,EAASQ,EAAQrsB,EAAK3lB,EAAGu0C,EAAKxtC,CAChC,EACAqhC,QAAS,WACHziB,GAAIqgB,EAAOoC,UACfoJ,EAAS,IACX,EAGAvT,MAAO,WACL,OAAOA,GAAUia,GAAOvyB,IAAO,CACjC,EAEJ,EApFA,SAASoD,YAAYvf,EAAMwhC,EAAIC,EAAWjF,GACxCgN,aAAahN,EAAQiN,EAAQ/7B,EAAO+zB,EAAWzhC,EAAMwhC,EACvD,EAiK4CkM,EAAc,CAAC,GAAIjE,GAAU,EAAE,GAAIA,EAAS,IAC1F,CD3E8C,CAAWwD,EAAQp+B,EAAI,KAAYo+B,EAAQ,KAAM,IAAmBK,SAAWL,EAAQ,EACnI,EAEAzJ,WAAWE,WAAa,SAAS70B,GAC/B,OAAOxK,UAAU1Q,QAAUw5C,EAAgB,MAALt+B,GAAa6V,EAAKyQ,EAAKxQ,EAAK2c,EAAK,KAAM,kCAAY,wBAAc5c,GAAM7V,EAAE,GAAG,GAAIsmB,GAAMtmB,EAAE,GAAG,GAAI8V,GAAM9V,EAAE,GAAG,GAAIyyB,GAAMzyB,EAAE,GAAG,IAAKy+B,SAAiB,MAAN5oB,EAAa,KAAO,CAAC,CAACA,EAAIyQ,GAAK,CAACxQ,EAAI2c,GACrN,EAEAkC,WAAW90B,MAAQ,SAASG,GAC1B,OAAOxK,UAAU1Q,QAAU8C,GAAKoY,EAAGu+B,YAAc32C,CACnD,EAEA+sC,WAAWrZ,UAAY,SAAStb,GAC9B,OAAOxK,UAAU1Q,QAAUiN,GAAKiO,EAAE,GAAI1Q,GAAK0Q,EAAE,GAAIu+B,YAAc,CAACxsC,EAAGzC,EACrE,EAEAqlC,WAAWx1B,OAAS,SAASa,GAC3B,OAAOxK,UAAU1Q,QAAU0rC,EAASxwB,EAAE,GAAK,IAAM,GAASywB,EAAMzwB,EAAE,GAAK,IAAM,GAASu+B,YAAc,CAAC/N,EAAS,GAASC,EAAM,GAC/H,EAEAkE,WAAW/Z,OAAS,SAAS5a,GAC3B,OAAOxK,UAAU1Q,QAAUq2C,EAAcn7B,EAAE,GAAK,IAAM,GAASo7B,EAAWp7B,EAAE,GAAK,IAAM,GAASq7B,EAAar7B,EAAElb,OAAS,EAAIkb,EAAE,GAAK,IAAM,GAAU,EAAGu+B,YAAc,CAACpD,EAAc,GAASC,EAAW,GAASC,EAAa,GAC/N,EAEA1G,WAAWsE,MAAQ,SAASj5B,GAC1B,OAAOxK,UAAU1Q,QAAUw4C,EAAQt9B,EAAI,IAAM,GAASu+B,YAAcjB,EAAQ,EAC9E,EAEA3I,WAAWoL,SAAW,SAAS//B,GAC7B,OAAOxK,UAAU1Q,QAAUs4C,EAAKp9B,GAAK,EAAI,EAAGu+B,YAAcnB,EAAK,CACjE,EAEAzI,WAAWqL,SAAW,SAAShgC,GAC7B,OAAOxK,UAAU1Q,QAAUu4C,EAAKr9B,GAAK,EAAI,EAAGu+B,YAAclB,EAAK,CACjE,EAEA1I,WAAWtiB,UAAY,SAASrS,GAC9B,OAAOxK,UAAU1Q,QAAUi5C,EAAkBS,SAASR,EAAkBhC,EAASh8B,EAAIA,GAAIy+B,SAAW,GAAKzC,EAC3G,EAEArH,WAAWG,UAAY,SAAS1Q,EAAQ/T,GACtC,OAAO,cAAUskB,WAAYvQ,EAAQ/T,EACvC,EAEAskB,WAAWI,QAAU,SAASv3B,EAAM6S,GAClC,OFzHG,SAAS,YAAQskB,EAAYn3B,EAAM6S,GACxC,OAAO,cAAUskB,EAAY,CAAC,CAAC,EAAG,GAAIn3B,GAAO6S,EAC/C,CEuHW,CAAQskB,WAAYn3B,EAAM6S,EACnC,EAEAskB,WAAWK,SAAW,SAAS7iB,EAAO9B,GACpC,OFzHG,SAAS,aAASskB,EAAYxiB,EAAO9B,GAC1C,OAAO,QAAIskB,EAAY,SAASlkC,GAC9B,IAAI3D,GAAKqlB,EACLvqB,EAAIkF,GAAK2D,EAAE,GAAG,GAAKA,EAAE,GAAG,IACxBsB,GAAKjF,EAAIlF,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACpCnB,GAAK1H,EAAI6I,EAAE,GAAG,GAClBkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CEiHW,CAASskB,WAAYxiB,EAAO9B,EACrC,EAEAskB,WAAWM,UAAY,SAASxR,EAAQpT,GACtC,OFnHG,SAAS,cAAUskB,EAAYlR,EAAQpT,GAC5C,OAAO,QAAIskB,EAAY,SAASlkC,GAC9B,IAAImc,GAAK6W,EACL77B,EAAIglB,GAAKnc,EAAE,GAAG,GAAKA,EAAE,GAAG,IACxBsB,GAAKnK,EAAI6I,EAAE,GAAG,GACdnB,GAAKsd,EAAIhlB,GAAK6I,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EACxCkkC,EAAW90B,MAAM,IAAMjY,GAAG0zB,UAAU,CAACvpB,EAAGzC,GAC1C,EAAG+gB,EACL,CE2GW,CAAUskB,WAAYlR,EAAQpT,EACvC,EAiBO,WAGL,OAFA0rB,EAAU+B,EAAUjvC,MAAMnH,KAAM8N,WAChCm/B,WAAWpjB,OAASwqB,EAAQxqB,QAAUA,OAC/BgtB,UACT,CACF,CAtHSV,CAAkB,WAAa,OAAO9B,CAAS,EAA/C8B,EACT,CE3DO,IAAI,GAAMnhC,KAAK+V,IAMX,IALO/V,KAAKse,KACJte,KAAKua,MACNva,KAAKiZ,KACNjZ,KAAKwa,IACLxa,KAAKqjB,IACHrjB,KAAK8B,OAEb,IADM9B,KAAKukB,IACLvkB,KAAK4B,KACX,GAAM5B,KAAKC,IASX,IARMD,KAAKmE,IACHnE,KAAKuE,MACNvE,KAAKuV,KACNvV,KAAKya,IACLza,KAAKkO,IAINlO,KAAKwZ,IACV,GAAS,GAAK,EAMd,IAJUxZ,KAAKujC,QACP,cAAK,GACJ,cAAK,IAEJ,IAAM,IAChB,GAAU,GAAK,IAcnB,SAAS,cAAKluC,GACnB,OAAOA,EAAI,EAAI2K,KAAK0D,KAAKrO,GAAK,CAChC,CCvCA,IAAI,GAAI,CACN,CAAC,OAAS,MACV,CAAC,EAAQ,GACT,CAAC,MAAQ,MACT,CAAC,MAAQ,MACT,CAAC,IAAQ,MACT,CAAC,MAAQ,MACT,CAAC,KAAQ,KACT,CAAC,IAAQ,MACT,CAAC,MAAQ,MACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,KAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,OACT,CAAC,MAAQ,IAOJ,SAASmuC,YAAY1P,EAAQC,GAClC,IASI7oC,EATA/C,EAAI,GAAI,GAAe,GAAX,GAAI4rC,GAAY,IAC5B/0B,EAAK,GAAM7W,GACXs7C,EAAKt7C,EAAI6W,EACTy4B,GAAMvsC,EAAI,GAAE8T,IAAK,GACjB04B,EAAKxsC,EAAE,GACPw4C,GAAMx4C,EAAI,KAAI8T,IAAK,GACnB2kC,EAAKz4C,EAAE,GACPopC,GAAMppC,EAAI,GAAE,GAAI,KAAM8T,KAAM,GAC5Bu1B,EAAKrpC,EAAE,GAEX,MAAO,CACL4oC,GAAU4P,EAAKD,GAAMnP,EAAKmD,GAAM,EAAIgM,EAAKA,GAAMnP,EAAK,EAAIoP,EAAKjM,GAAM,IAClE1D,EAAM,EAAI,IAAU,KAAW4P,EAAKF,GAAMlP,EAAKmD,GAAM,EAAI+L,EAAKA,GAAMlP,EAAK,EAAIoP,EAAKjM,GAAM,GAE7F,CAnBA,GAAEhK,QAAQ,SAAS3iC,GACjBA,EAAE,IAAM,MACV,GAmBAy4C,YAAY3uB,OAAS,SAASxf,EAAGzC,GAC/B,IAAIgxC,EAAKhxC,EAAI,GACTmhC,EAAW,GAAL6P,EACNz7C,EAAI,GAAI,GAAI,GAAI4rC,EAAM,IACtB/0B,EAAK,GAAI,EAAG,GAAM7W,IACtB,EAAG,CACD,IAAIuvC,EAAK,GAAE14B,GAAI,GACX2kC,EAAK,GAAE3kC,EAAK,GAAG,GACfu1B,EAAK,GAAE,GAAI,GAAIv1B,EAAK,IAAI,GACxBrO,EAAI4jC,EAAKmD,EACTzsC,EAAIspC,EAAK,EAAIoP,EAAKjM,EAClBlsC,EAAI,GAAK,GAAIo4C,GAAMD,GAAMhzC,EACzBqB,EAAI/G,EAAI0F,EACR8yC,EAAKj4C,GAAK,EAAIwG,EAAIxG,GAAK,EAAI,EAAIwG,EAAIxG,IACvC,GAAIi4C,GAAM,GAAY,IAAPzkC,EAAU,CACvB+0B,GAAOnhC,GAAK,EAAI,GAAK,IAAM6wC,EAAKt7C,GAChC,IAAYga,EAAR3F,EAAI,GACR,GAGEinC,GAFAt7C,EAAI,GAAI,GAAI,GAAI4rC,GAAO,KACvB/0B,EAAK,GAAM7W,IAEXuvC,EAAK,GAAE14B,GAAI,GACX2kC,EAAK,GAAE3kC,EAAK,GAAG,GACfu1B,EAAK,GAAE,GAAI,GAAIv1B,EAAK,IAAI,GACxB+0B,IAAQ5xB,GAASvP,GAAK,EAAI,IAAU,KAAW+wC,EAAKF,GAAMlP,EAAKmD,GAAM,EAAI+L,EAAKA,GAAMlP,EAAK,EAAIoP,EAAKjM,GAAM,GAAK9kC,GAAK,SAC3G,GAAIuP,GDvDG,SCuDoB3F,EAAI,GACxC,KACF,CACF,SAAWwC,GAAM,GACjB,IAAIy4B,EAAK,GAAEz4B,GAAI,GACX0kC,EAAK,GAAE1kC,EAAK,GAAG,GACfs1B,EAAK,GAAE,GAAI,GAAIt1B,EAAK,IAAI,GAC5B,MAAO,CACL3J,GAAKquC,EAAKD,GAAMnP,EAAKmD,GAAM,EAAIgM,EAAKA,GAAMnP,EAAK,EAAIoP,EAAKjM,GAAM,GAC9D1D,EAAM,GAEV,ECnFO,IAAI,GAAQ,+BAEnB,UACEn8B,IAAK,6BACLD,MAAO,GACPE,MAAO,+BACPC,IAAK,uCACLC,MAAO,iCCLM,uBAASxI,GACtB,IAAIyI,EAASzI,GAAQ,GAAIpH,EAAI6P,EAAOC,QAAQ,KAE5C,OADI9P,GAAK,GAAqC,WAA/B6P,EAASzI,EAAKiF,MAAM,EAAGrM,MAAiBoH,EAAOA,EAAKiF,MAAMrM,EAAI,IACtE,GAAW2L,eAAekE,GAAU,CAACG,MAAO,GAAWH,GAASI,MAAO7I,GAAQA,CACxF,CCHA,SAAS,uBAAeA,GACtB,OAAO,WACL,IAAI5E,EAAWK,KAAKmL,cAChBuF,EAAM1Q,KAAKoL,aACf,OAAOsF,IAAQ,IAAS/Q,EAASgR,gBAAgBvF,eAAiB,GAC5DzL,EAAS8C,cAAc8B,GACvB5E,EAASiR,gBAAgBF,EAAKnM,EACtC,CACF,CAEA,SAAS,qBAAaiJ,GACpB,OAAO,WACL,OAAOxN,KAAKmL,cAAcyF,gBAAgBpD,EAASL,MAAOK,EAASJ,MACrE,CACF,CAEe,kCAAS7I,GACtB,IAAIiJ,EAAW,cAAUjJ,GACzB,OAAQiJ,EAASJ,MACX,qBACA,wBAAgBI,EACxB,CCxBA,SAAS,gBAAQ,CAEF,sBAASrD,GACtB,OAAmB,MAAZA,EAAmB,cAAO,WAC/B,OAAOnK,KAAKoG,cAAc+D,EAC5B,CACF,CCNA,SAAS,oBACP,MAAO,EACT,CCFe,0BAASvL,GACtB,OAAO,IAAI0K,MAAM1K,EAAOxB,OAC1B,CCKO,SAAS,gBAAU6N,EAAQC,GAChClL,KAAKmL,cAAgBF,EAAOE,cAC5BnL,KAAKoL,aAAeH,EAAOG,aAC3BpL,KAAKqL,MAAQ,KACbrL,KAAKsL,QAAUL,EACfjL,KAAKuL,SAAWL,CAClB,CAEA,gBAAUxE,UAAY,CACpBrC,YAAa,gBACb3E,YAAa,SAAS+M,GAAS,OAAOzM,KAAKsL,QAAQoB,aAAaD,EAAOzM,KAAKqL,MAAQ,EACpFqB,aAAc,SAASD,EAAO9L,GAAQ,OAAOX,KAAKsL,QAAQoB,aAAaD,EAAO9L,EAAO,EACrFyF,cAAe,SAAS+D,GAAY,OAAOnK,KAAKsL,QAAQlF,cAAc+D,EAAW,EACjFI,iBAAkB,SAASJ,GAAY,OAAOnK,KAAKsL,QAAQf,iBAAiBJ,EAAW,GCdzF,SAAS,eAAUc,EAAQQ,EAAOC,EAAO9M,EAAQ+M,EAAM1J,GASrD,IARA,IACIyI,EADAvN,EAAI,EAEJyO,EAAcH,EAAMrO,OACpByO,EAAa5J,EAAK7E,OAKfD,EAAI0O,IAAc1O,GACnBuN,EAAOe,EAAMtO,KACfuN,EAAKa,SAAWtJ,EAAK9E,GACrByB,EAAOzB,GAAKuN,GAEZgB,EAAMvO,GAAK,IAAI,gBAAU8N,EAAQhJ,EAAK9E,IAK1C,KAAOA,EAAIyO,IAAezO,GACpBuN,EAAOe,EAAMtO,MACfwO,EAAKxO,GAAKuN,EAGhB,CAEA,SAAS,aAAQO,EAAQQ,EAAOC,EAAO9M,EAAQ+M,EAAM1J,EAAMyG,GACzD,IAAIvL,EACAuN,EAKAqB,EAJAC,EAAiB,CAAC,EAClBJ,EAAcH,EAAMrO,OACpByO,EAAa5J,EAAK7E,OAClB8O,EAAY,IAAI5C,MAAMsC,GAK1B,IAAKzO,EAAI,EAAGA,EAAIyO,IAAezO,GACzBuN,EAAOe,EAAMtO,MACf+O,EAAU/O,GAAK4O,EAzCL,IAyC4BrD,EAAIlF,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,GACnEM,KAAYC,EACdL,EAAKxO,GAAKuN,EAEVsB,EAAeD,GAAYrB,GAQjC,IAAKvN,EAAI,EAAGA,EAAI0O,IAAc1O,GAExBuN,EAAOsB,EADXD,EAtDY,IAsDWrD,EAAIlF,KAAKyH,EAAQhJ,EAAK9E,GAAIA,EAAG8E,MAElDrD,EAAOzB,GAAKuN,EACZA,EAAKa,SAAWtJ,EAAK9E,GACrB6O,EAAeD,GAAY,MAE3BL,EAAMvO,GAAK,IAAI,gBAAU8N,EAAQhJ,EAAK9E,IAK1C,IAAKA,EAAI,EAAGA,EAAIyO,IAAezO,GACxBuN,EAAOe,EAAMtO,KAAQ6O,EAAeE,EAAU/O,MAAQuN,IACzDiB,EAAKxO,GAAKuN,EAGhB,CCrDA,SAAS,eAAUhK,EAAGqI,GACpB,OAAOrI,EAAIqI,GAAK,EAAIrI,EAAIqI,EAAI,EAAIrI,GAAKqI,EAAI,EAAIyD,GAC/C,CCrBA,SAAS,0BAAWjI,GAClB,OAAO,WACLvE,KAAKsN,gBAAgB/I,EACvB,CACF,CAEA,SAAS,4BAAaiJ,GACpB,OAAO,WACLxN,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,MAClD,CACF,CAEA,SAAS,4BAAa7I,EAAMzD,GAC1B,OAAO,WACLd,KAAKlD,aAAayH,EAAMzD,EAC1B,CACF,CAEA,SAAS,8BAAe0M,EAAU1M,GAChC,OAAO,WACLd,KAAK4N,eAAeJ,EAASL,MAAOK,EAASJ,MAAOtM,EACtD,CACF,CAEA,SAAS,4BAAayD,EAAMzD,GAC1B,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKsN,gBAAgB/I,GAC/BvE,KAAKlD,aAAayH,EAAMtE,EAC/B,CACF,CAEA,SAAS,8BAAeuN,EAAU1M,GAChC,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKyN,kBAAkBD,EAASL,MAAOK,EAASJ,OAC1DpN,KAAK4N,eAAeJ,EAASL,MAAOK,EAASJ,MAAOnN,EAC3D,CACF,CCxCe,iCAASyK,GACtB,OAAQA,EAAKS,eAAiBT,EAAKS,cAAc6C,aACzCtD,EAAK/K,UAAY+K,GAClBA,EAAKsD,WACd,CCFA,SAAS,4BAAYzJ,GACnB,OAAO,WACLvE,KAAKgG,MAAMkI,eAAe3J,EAC5B,CACF,CAEA,SAAS,8BAAcA,EAAMzD,EAAOsN,GAClC,OAAO,WACLpO,KAAKgG,MAAMqI,YAAY9J,EAAMzD,EAAOsN,EACtC,CACF,CAEA,SAAS,8BAAc7J,EAAMzD,EAAOsN,GAClC,OAAO,WACL,IAAInO,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,EAAWD,KAAKgG,MAAMkI,eAAe3J,GACpCvE,KAAKgG,MAAMqI,YAAY9J,EAAMtE,EAAGmO,EACvC,CACF,CCpBA,SAAS,wBAAe7J,GACtB,OAAO,kBACEvE,KAAKuE,EACd,CACF,CAEA,SAAS,0BAAiBA,EAAMzD,GAC9B,OAAO,WACLd,KAAKuE,GAAQzD,CACf,CACF,CAEA,SAAS,0BAAiByD,EAAMzD,GAC9B,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WACjB,MAAL7N,SAAkBD,KAAKuE,GACtBvE,KAAKuE,GAAQtE,CACpB,CACF,CClBA,SAAS,mBAAW6O,GAClB,OAAOA,EAAOC,OAAOC,MAAM,QAC7B,CAEA,SAAS,kBAAUtE,GACjB,OAAOA,EAAKuE,WAAa,IAAI,kBAAUvE,EACzC,CAEA,SAAS,kBAAUA,GACjB1K,KAAKmP,MAAQzE,EACb1K,KAAKoP,OAAS,mBAAW1E,EAAK2E,aAAa,UAAY,GACzD,CAsBA,SAAS,mBAAW3E,EAAM6E,GAExB,IADA,IAAIjS,EAAO,kBAAUoN,GAAOvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SACrCD,EAAImD,GAAGhD,EAAKkS,IAAID,EAAMpS,GACjC,CAEA,SAAS,sBAAcuN,EAAM6E,GAE3B,IADA,IAAIjS,EAAO,kBAAUoN,GAAOvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SACrCD,EAAImD,GAAGhD,EAAKwB,OAAOyQ,EAAMpS,GACpC,CAEA,SAAS,oBAAYoS,GACnB,OAAO,WACL,mBAAWvP,KAAMuP,EACnB,CACF,CAEA,SAAS,qBAAaA,GACpB,OAAO,WACL,sBAAcvP,KAAMuP,EACtB,CACF,CAEA,SAAS,wBAAgBA,EAAOzO,GAC9B,OAAO,YACJA,EAAMqG,MAAMnH,KAAM8N,WAAa,mBAAa,uBAAe9N,KAAMuP,EACpE,CACF,CC3DA,SAAS,kBACPvP,KAAK8P,YAAc,EACrB,CAEA,SAAS,4BAAahP,GACpB,OAAO,WACLd,KAAK8P,YAAchP,CACrB,CACF,CAEA,SAAS,4BAAaA,GACpB,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WAC1B9N,KAAK8P,YAAmB,MAAL7P,EAAY,GAAKA,CACtC,CACF,CCfA,SAAS,kBACPD,KAAKkQ,UAAY,EACnB,CAEA,SAAS,kBAAapP,GACpB,OAAO,WACLd,KAAKkQ,UAAYpP,CACnB,CACF,CAEA,SAAS,kBAAaA,GACpB,OAAO,WACL,IAAIb,EAAIa,EAAMqG,MAAMnH,KAAM8N,WAC1B9N,KAAKkQ,UAAiB,MAALjQ,EAAY,GAAKA,CACpC,CACF,CCfA,SAAS,cACHD,KAAKsQ,aAAatQ,KAAKqH,WAAW3H,YAAYM,KACpD,CCFA,SAAS,cACHA,KAAKwQ,iBAAiBxQ,KAAKqH,WAAWqF,aAAa1M,KAAMA,KAAKqH,WAAW7H,WAC/E,CCCA,SAAS,sBACP,OAAO,IACT,CCLA,SAAS,gBACP,IAAIyL,EAASjL,KAAKqH,WACd4D,GAAQA,EAAOxL,YAAYO,KACjC,CCHA,SAAS,+BACP,OAAOA,KAAKqH,WAAWqF,aAAa1M,KAAKkR,WAAU,GAAQlR,KAAKsQ,YAClE,CAEA,SAAS,4BACP,OAAOtQ,KAAKqH,WAAWqF,aAAa1M,KAAKkR,WAAU,GAAOlR,KAAKsQ,YACjE,CPOA,kBAAU5J,UAAY,CACpB8I,IAAK,SAASjL,GACJvE,KAAKoP,OAAOnC,QAAQ1I,GACpB,IACNvE,KAAKoP,OAAO3S,KAAK8H,GACjBvE,KAAKmP,MAAMrS,aAAa,QAASkD,KAAKoP,OAAOhO,KAAK,MAEtD,EACAtC,OAAQ,SAASyF,GACf,IAAIpH,EAAI6C,KAAKoP,OAAOnC,QAAQ1I,GACxBpH,GAAK,IACP6C,KAAKoP,OAAO3Q,OAAOtB,EAAG,GACtB6C,KAAKmP,MAAMrS,aAAa,QAASkD,KAAKoP,OAAOhO,KAAK,MAEtD,EACAsR,SAAU,SAASnO,GACjB,OAAOvE,KAAKoP,OAAOnC,QAAQ1I,IAAS,CACtC,GQ9BF,IAAIs0C,GAAe,CAAC,EAET,GAAQ,KAEK,oBAAbl5C,WAEH,iBADQA,SAASgR,kBAErBkoC,GAAe,CAACC,WAAY,YAAaC,WAAY,cAIzD,SAASC,sBAAsBrnC,EAAU1S,EAAOwM,GAE9C,OADAkG,EAAW,mBAAgBA,EAAU1S,EAAOwM,GACrC,SAASqG,GACd,IAAImnC,EAAUnnC,EAAMonC,cACfD,IAAYA,IAAYj5C,MAAkD,EAAxCi5C,EAAQ3jC,wBAAwBtV,QACrE2R,EAASnO,KAAKxD,KAAM8R,EAExB,CACF,CAEA,SAAS,mBAAgBH,EAAU1S,EAAOwM,GACxC,OAAO,SAAS0tC,GACd,IAAIC,EAAS,GACb,GAAQD,EACR,IACExnC,EAASnO,KAAKxD,KAAMA,KAAKuL,SAAUtM,EAAOwM,EAC5C,CAAE,QACA,GAAQ2tC,CACV,CACF,CACF,CAUA,SAAS,YAAS/nC,GAChB,OAAO,WACL,IAAIC,EAAKtR,KAAKuR,KACd,GAAKD,EAAL,CACA,IAAK,IAAkC7Q,EAA9B+Q,EAAI,EAAGrU,GAAK,EAAG+G,EAAIoN,EAAGlU,OAAWoU,EAAItN,IAAKsN,EAC7C/Q,EAAI6Q,EAAGE,GAAMH,EAASI,MAAQhR,EAAEgR,OAASJ,EAASI,MAAShR,EAAE8D,OAAS8M,EAAS9M,KAGjF+M,IAAKnU,GAAKsD,EAFVT,KAAK0R,oBAAoBjR,EAAEgR,KAAMhR,EAAEkR,SAAUlR,EAAEu3B,WAK7C76B,EAAGmU,EAAGlU,OAASD,SACT6C,KAAKuR,IATF,CAUjB,CACF,CAEA,SAAS,SAAMF,EAAUvQ,EAAOk3B,GAC9B,IAAI7yB,EAAO0zC,GAAa/vC,eAAeuI,EAASI,MAAQunC,sBAAwB,mBAChF,OAAO,SAASj5C,EAAG5C,EAAGsO,GACpB,IAAoBhL,EAAhB6Q,EAAKtR,KAAKuR,KAASI,EAAWxM,EAAKrE,EAAO3D,EAAGsO,GACjD,GAAI6F,EAAI,IAAK,IAAIE,EAAI,EAAGtN,EAAIoN,EAAGlU,OAAQoU,EAAItN,IAAKsN,EAC9C,IAAK/Q,EAAI6Q,EAAGE,IAAIC,OAASJ,EAASI,MAAQhR,EAAE8D,OAAS8M,EAAS9M,KAI5D,OAHAvE,KAAK0R,oBAAoBjR,EAAEgR,KAAMhR,EAAEkR,SAAUlR,EAAEu3B,SAC/Ch4B,KAAK+R,iBAAiBtR,EAAEgR,KAAMhR,EAAEkR,SAAWA,EAAUlR,EAAEu3B,QAAUA,QACjEv3B,EAAEK,MAAQA,GAIdd,KAAK+R,iBAAiBV,EAASI,KAAME,EAAUqmB,GAC/Cv3B,EAAI,CAACgR,KAAMJ,EAASI,KAAMlN,KAAM8M,EAAS9M,KAAMzD,MAAOA,EAAO6Q,SAAUA,EAAUqmB,QAASA,GACrF1mB,EACAA,EAAG7U,KAAKgE,GADJT,KAAKuR,KAAO,CAAC9Q,EAExB,CACF,CAuBO,SAAS44C,YAAYF,EAAQxnC,EAAUue,EAAMC,GAClD,IAAIipB,EAAS,GACbD,EAAOnf,YAAc,GACrB,GAAQmf,EACR,IACE,OAAOxnC,EAASxK,MAAM+oB,EAAMC,EAC9B,CAAE,QACA,GAAQipB,CACV,CACF,CCxGA,SAAS,uBAAc1uC,EAAM+G,EAAMQ,GACjC,IAAI5L,EAAS,wBAAYqE,GACrBoH,EAAQzL,EAAO6L,YAEE,mBAAVJ,EACTA,EAAQ,IAAIA,EAAML,EAAMQ,IAExBH,EAAQzL,EAAO1G,SAASwS,YAAY,SAChCF,GAAQH,EAAMM,UAAUX,EAAMQ,EAAOI,QAASJ,EAAOK,YAAaR,EAAMS,OAASN,EAAOM,QACvFT,EAAMM,UAAUX,GAAM,GAAO,IAGpC/G,EAAKsH,cAAcF,EACrB,CAEA,SAAS,0BAAiBL,EAAMQ,GAC9B,OAAO,WACL,OAAO,uBAAcjS,KAAMyR,EAAMQ,EACnC,CACF,CAEA,SAAS,0BAAiBR,EAAMQ,GAC9B,OAAO,WACL,OAAO,uBAAcjS,KAAMyR,EAAMQ,EAAO9K,MAAMnH,KAAM8N,WACtD,CACF,CCKO,IAAI,GAAO,CAAC,MAEZ,SAAS,wBAAU6E,EAAQC,GAChC5S,KAAK6S,QAAUF,EACf3S,KAAK8S,SAAWF,CAClB,CAEA,SAAS,0BACP,OAAO,IAAI,wBAAU,CAAC,CAACjT,SAASgR,kBAAmB,GACrD,CAEA,wBAAUjK,UAAY,wBAAUA,UAAY,CAC1CrC,YAAa,wBACb2O,OC1Ca,8BAASA,GACA,mBAAXA,IAAuBA,EAAS,aAASA,IAEpD,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAiF9G,EAAMwI,EAAnFzH,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,IAAIlI,MAAMhJ,GAAmBnD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9GuN,EAAOe,EAAMtO,MAAQ+V,EAAUF,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,MAClE,aAAcf,IAAMwI,EAAQ3H,SAAWb,EAAKa,UAChD4H,EAAShW,GAAK+V,GAKpB,OAAO,IAAI,wBAAUD,EAAWjT,KAAK8S,SACvC,ED8BEM,UE3Ca,6BAASJ,GACA,mBAAXA,IAAuBA,ErBArB,yBAAS7I,GACtB,OAAmB,MAAZA,EAAmB,kBAAQ,WAChC,OAAOnK,KAAKuK,iBAAiBJ,EAC/B,CACF,CqBJ6C,CAAY6I,IAEvD,IAAK,IAAIL,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,GAAIL,EAAU,GAAIpB,EAAI,EAAGA,EAAItN,IAAKsN,EAC/F,IAAK,IAAyC9G,EAArCe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAcD,EAAI,EAAGA,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,MACf8V,EAAUxW,KAAKuW,EAAOxP,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,IACnDmH,EAAQnW,KAAKiO,IAKnB,OAAO,IAAI,wBAAUuI,EAAWL,EAClC,EF+BE9H,OG5Ca,8BAAS0I,GACD,mBAAVA,IAAsBA,ECJpB,qBAASrJ,GACtB,OAAO,WACL,OAAOnK,KAAKwK,QAAQL,EACtB,CACF,CDA2C,CAAQqJ,IAEjD,IAAK,IAAIb,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQ6V,EAAY,IAAI3J,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAC3F,IAAK,IAAuE9G,EAAnEe,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQ+V,EAAWF,EAAUzB,GAAK,GAAUrU,EAAI,EAAGA,EAAImD,IAAKnD,GAC3FuN,EAAOe,EAAMtO,KAAOqW,EAAMhQ,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,IAC1D0H,EAAS1W,KAAKiO,GAKpB,OAAO,IAAI,wBAAUuI,EAAWjT,KAAK8S,SACvC,EHiCE7Q,KhB4Ba,wBAASnB,EAAO4H,GAC7B,IAAK5H,EAGH,OAFAmB,EAAO,IAAIqH,MAAMtJ,KAAK8V,QAAStE,GAAK,EACpCxR,KAAK+V,KAAK,SAAShW,GAAKkC,IAAOuP,GAAKzR,CAAG,GAChCkC,EAGT,IAAI6F,EAAOY,EAAM,aAAU,eACvBkK,EAAU5S,KAAK8S,SACfH,EAAS3S,KAAK6S,QAEG,mBAAV/R,IAAsBA,EqBvFpB,mCAASuJ,GACtB,OAAO,WACL,OAAOA,CACT,CACF,CrBmF2C,CAASvJ,IAElD,IAAK,IAAIoD,EAAIyO,EAAOvV,OAAQwB,EAAS,IAAI0K,MAAMpF,GAAIwH,EAAQ,IAAIpC,MAAMpF,GAAIyH,EAAO,IAAIrC,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAAG,CAC/G,IAAIvG,EAAS2H,EAAQpB,GACjB/F,EAAQkH,EAAOnB,GACf5F,EAAcH,EAAMrO,OACpB6E,EAAOnB,EAAM0C,KAAKyH,EAAQA,GAAUA,EAAOM,SAAUiG,EAAGoB,GACxD/G,EAAa5J,EAAK7E,OAClByW,EAAanI,EAAM8F,GAAK,IAAIlI,MAAMuC,GAClCiI,EAAclV,EAAO4S,GAAK,IAAIlI,MAAMuC,GAGxC/D,EAAKmD,EAAQQ,EAAOoI,EAAYC,EAFhBnI,EAAK6F,GAAK,IAAIlI,MAAMsC,GAEoB3J,EAAMyG,GAK9D,IAAK,IAAoBqL,EAAUpT,EAA1BqT,EAAK,EAAGC,EAAK,EAAmBD,EAAKnI,IAAcmI,EAC1D,GAAID,EAAWF,EAAWG,GAAK,CAE7B,IADIA,GAAMC,IAAIA,EAAKD,EAAK,KACfrT,EAAOmT,EAAYG,OAAUA,EAAKpI,IAC3CkI,EAAS1I,MAAQ1K,GAAQ,IAC3B,CAEJ,CAKA,OAHA/B,EAAS,IAAI,wBAAUA,EAAQgU,IACxBsB,OAASxI,EAChB9M,EAAOuV,MAAQxI,EACR/M,CACT,EgBpEE8M,MjB9Ca,2BACb,OAAO,IAAI,wBAAU1L,KAAKkU,QAAUlU,KAAK6S,QAAQ5R,IAAI,kBAASjB,KAAK8S,SACrE,EiB6CEnH,KM/Ca,0BACb,OAAO,IAAI,wBAAU3L,KAAKmU,OAASnU,KAAK6S,QAAQ5R,IAAI,kBAASjB,KAAK8S,SACpE,EN8CE1R,KOnDa,wBAASiT,EAASC,EAAUC,GACzC,IAAI7I,EAAQ1L,KAAK0L,QAAS9M,EAASoB,KAAM2L,EAAO3L,KAAK2L,OAIrD,OAHAD,EAA2B,mBAAZ2I,EAAyBA,EAAQ3I,GAASA,EAAM8I,OAAOH,EAAU,IAChE,MAAZC,IAAkB1V,EAAS0V,EAAS1V,IAC1B,MAAV2V,EAAgB5I,EAAK7M,SAAeyV,EAAO5I,GACxCD,GAAS9M,EAAS8M,EAAM+I,MAAM7V,GAAQ8V,QAAU9V,CACzD,EP8CE6V,MQlDa,yBAAS1B,GAEtB,IAAK,IAAI6B,EAAU5U,KAAK6S,QAASgC,EAAU9B,EAAUF,QAASiC,EAAKF,EAAQxX,OAAQ2X,EAAKF,EAAQzX,OAAQ8G,EAAI8Q,KAAKC,IAAIH,EAAIC,GAAKG,EAAS,IAAI5L,MAAMwL,GAAKtD,EAAI,EAAGA,EAAItN,IAAKsN,EACpK,IAAK,IAAmG9G,EAA/FyK,EAASP,EAAQpD,GAAI4D,EAASP,EAAQrD,GAAIlR,EAAI6U,EAAO/X,OAAQqX,EAAQS,EAAO1D,GAAK,IAAIlI,MAAMhJ,GAAUnD,EAAI,EAAGA,EAAImD,IAAKnD,GACxHuN,EAAOyK,EAAOhY,IAAMiY,EAAOjY,MAC7BsX,EAAMtX,GAAKuN,GAKjB,KAAO8G,EAAIsD,IAAMtD,EACf0D,EAAO1D,GAAKoD,EAAQpD,GAGtB,OAAO,IAAI,wBAAU0D,EAAQlV,KAAK8S,SACpC,ERoCE4B,MSrDa,2BAEb,IAAK,IAAI/B,EAAS3S,KAAK6S,QAASrB,GAAK,EAAGtN,EAAIyO,EAAOvV,SAAUoU,EAAItN,GAC/D,IAAK,IAA8DwG,EAA1De,EAAQkH,EAAOnB,GAAIrU,EAAIsO,EAAMrO,OAAS,EAAGuD,EAAO8K,EAAMtO,KAAYA,GAAK,IAC1EuN,EAAOe,EAAMtO,MACXwD,GAA6C,EAArC+J,EAAK4K,wBAAwB3U,IAAWA,EAAK0G,WAAWqF,aAAahC,EAAM/J,GACvFA,EAAO+J,GAKb,OAAO1K,IACT,ET0CEuV,KfpDa,wBAASC,GAGtB,SAASC,YAAY/U,EAAGqI,GACtB,OAAOrI,GAAKqI,EAAIyM,EAAQ9U,EAAE6K,SAAUxC,EAAEwC,WAAa7K,GAAKqI,CAC1D,CAJKyM,IAASA,EAAU,gBAMxB,IAAK,IAAI7C,EAAS3S,KAAK6S,QAAS3O,EAAIyO,EAAOvV,OAAQsY,EAAa,IAAIpM,MAAMpF,GAAIsN,EAAI,EAAGA,EAAItN,IAAKsN,EAAG,CAC/F,IAAK,IAAmF9G,EAA/Ee,EAAQkH,EAAOnB,GAAIlR,EAAImL,EAAMrO,OAAQuY,EAAYD,EAAWlE,GAAK,IAAIlI,MAAMhJ,GAAUnD,EAAI,EAAGA,EAAImD,IAAKnD,GACxGuN,EAAOe,EAAMtO,MACfwY,EAAUxY,GAAKuN,GAGnBiL,EAAUJ,KAAKE,YACjB,CAEA,OAAO,IAAI,wBAAUC,EAAY1V,KAAK8S,UAAU4B,OAClD,EeoCElR,KUvDa,0BACb,IAAIoS,EAAW9H,UAAU,GAGzB,OAFAA,UAAU,GAAK9N,KACf4V,EAASzO,MAAM,KAAM2G,WACd9N,IACT,EVmDE6V,MWxDa,2BACb,IAAIA,EAAQ,IAAIvM,MAAMtJ,KAAK8V,QAAS3Y,GAAK,EAEzC,OADA6C,KAAK+V,KAAK,WAAaF,IAAQ1Y,GAAK6C,IAAM,GACnC6V,CACT,EXqDEnL,KYzDa,0BAEb,IAAK,IAAIiI,EAAS3S,KAAK6S,QAASrB,EAAI,EAAGtN,EAAIyO,EAAOvV,OAAQoU,EAAItN,IAAKsN,EACjE,IAAK,IAAI/F,EAAQkH,EAAOnB,GAAIrU,EAAI,EAAGmD,EAAImL,EAAMrO,OAAQD,EAAImD,IAAKnD,EAAG,CAC/D,IAAIuN,EAAOe,EAAMtO,GACjB,GAAIuN,EAAM,OAAOA,CACnB,CAGF,OAAO,IACT,EZgDEoL,Ka1Da,0BACb,IAAIA,EAAO,EAEX,OADA9V,KAAK+V,KAAK,aAAeD,CAAM,GACxBA,CACT,EbuDExL,Mc3Da,+BACb,OAAQtK,KAAK0K,MACf,Ed0DEqL,Ke5Da,wBAASH,GAEtB,IAAK,IAAIjD,EAAS3S,KAAK6S,QAASrB,EAAI,EAAGtN,EAAIyO,EAAOvV,OAAQoU,EAAItN,IAAKsN,EACjE,IAAK,IAAgD9G,EAA5Ce,EAAQkH,EAAOnB,GAAIrU,EAAI,EAAGmD,EAAImL,EAAMrO,OAAcD,EAAImD,IAAKnD,GAC9DuN,EAAOe,EAAMtO,KAAIyY,EAASpS,KAAKkH,EAAMA,EAAKa,SAAUpO,EAAGsO,GAI/D,OAAOzL,IACT,EfoDEgW,KdnBa,wBAASzR,EAAMzD,GAC5B,IAAI0M,EAAW,cAAUjJ,GAEzB,GAAIuJ,UAAU1Q,OAAS,EAAG,CACxB,IAAIsN,EAAO1K,KAAK0K,OAChB,OAAO8C,EAASJ,MACV1C,EAAKuL,eAAezI,EAASL,MAAOK,EAASJ,OAC7C1C,EAAK2E,aAAa7B,EAC1B,CAEA,OAAOxN,KAAK+V,MAAe,MAATjV,EACX0M,EAASJ,MAAQ,4BAAe,0BAAgC,mBAAVtM,EACtD0M,EAASJ,MAAQ,8BAAiB,4BAClCI,EAASJ,MAAQ,8BAAiB,6BAAgBI,EAAU1M,GACrE,EcMEkF,MZxCa,yBAASzB,EAAMzD,EAAOsN,GACnC,OAAON,UAAU1Q,OAAS,EACpB4C,KAAK+V,MAAe,MAATjV,EACL,4BAA+B,mBAAVA,EACrB,8BACA,+BAAeyD,EAAMzD,EAAmB,MAAZsN,EAAmB,GAAKA,IAI3D,SAAS,iBAAW1D,EAAMnG,GAC/B,OAAOmG,EAAK1E,MAAMwI,iBAAiBjK,IAC5B,wBAAYmG,GAAM+D,iBAAiB/D,EAAM,MAAM8D,iBAAiBjK,EACzE,CANQ,CAAWvE,KAAK0K,OAAQnG,EAChC,EYkCE2R,SX3Ca,4BAAS3R,EAAMzD,GAC5B,OAAOgN,UAAU1Q,OAAS,EACpB4C,KAAK+V,MAAe,MAATjV,EACP,wBAAkC,mBAAVA,EACxB,0BACA,2BAAkByD,EAAMzD,IAC5Bd,KAAK0K,OAAOnG,EACpB,EWqCE4R,QVHa,2BAAS5R,EAAMzD,GAC5B,IAAIyO,EAAQ,mBAAWhL,EAAO,IAE9B,GAAIuJ,UAAU1Q,OAAS,EAAG,CAExB,IADA,IAAIE,EAAO,kBAAU0C,KAAK0K,QAASvN,GAAK,EAAGmD,EAAIiP,EAAMnS,SAC5CD,EAAImD,OAAQhD,EAAKoV,SAASnD,EAAMpS,IAAK,OAAO,EACrD,OAAO,CACT,CAEA,OAAO6C,KAAK+V,MAAuB,mBAAVjV,EACnB,wBAAkBA,EAClB,oBACA,sBAAcyO,EAAOzO,GAC7B,EUTEsV,KThDa,4BAAStV,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAK+V,KAAc,MAATjV,EACN,iBAA+B,mBAAVA,EACrB,4BACA,6BAAcA,IAClBd,KAAK0K,OAAOoF,WACpB,ES0CEuG,KRjDa,wBAASvV,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAK+V,KAAc,MAATjV,EACN,iBAA+B,mBAAVA,EACrB,kBACA,mBAAcA,IAClBd,KAAK0K,OAAOwF,SACpB,EQ2CEG,MP/Da,+BACb,OAAOrQ,KAAK+V,KAAK,YACnB,EO8DExF,MNhEa,+BACb,OAAOvQ,KAAK+V,KAAK,YACnB,EM+DEvB,OgBnEa,0BAASjQ,GACtB,IAAIoD,EAAyB,mBAATpD,EAAsBA,EAAO,yBAAQA,GACzD,OAAOvE,KAAKgT,OAAO,WACjB,OAAOhT,KAAKN,YAAYiI,EAAOR,MAAMnH,KAAM8N,WAC7C,EACF,EhB+DElL,OL/Da,0BAAS2B,EAAM+R,GAC5B,IAAI3O,EAAyB,mBAATpD,EAAsBA,EAAO,yBAAQA,GACrDyO,EAAmB,MAAVsD,EAAiB,oBAAiC,mBAAXA,EAAwBA,EAAS,aAASA,GAC9F,OAAOtW,KAAKgT,OAAO,WACjB,OAAOhT,KAAK0M,aAAa/E,EAAOR,MAAMnH,KAAM8N,WAAYkF,EAAO7L,MAAMnH,KAAM8N,YAAc,KAC3F,EACF,EK0DEhP,OJlEa,gCACb,OAAOkB,KAAK+V,KAAK,cACnB,EIiEE9E,MHhEa,yBAASsF,GACtB,OAAOvW,KAAKgT,OAAOuD,EAAO,0BAAsB,6BAClD,EG+DErL,MiBzEa,6BAASpK,GACtB,OAAOgN,UAAU1Q,OACX4C,KAAKkW,SAAS,WAAYpV,GAC1Bd,KAAK0K,OAAOa,QACpB,EjBsEE+F,GFEa,sBAASD,EAAUvQ,EAAOk3B,GACvC,IAA+C76B,EAAyBqD,EAApEgW,EA5CN,SAAS,kBAAeA,GACtB,OAAOA,EAAUzH,OAAOC,MAAM,SAAS/N,IAAI,SAAST,GAClD,IAAI+D,EAAO,GAAIpH,EAAIqD,EAAEyM,QAAQ,KAE7B,OADI9P,GAAK,IAAGoH,EAAO/D,EAAEgJ,MAAMrM,EAAI,GAAIqD,EAAIA,EAAEgJ,MAAM,EAAGrM,IAC3C,CAACsU,KAAMjR,EAAG+D,KAAMA,EACzB,EACF,CAsCkB,CAAe8M,EAAW,IAAQ/Q,EAAIkW,EAAUpZ,OAEhE,KAAI0Q,UAAU1Q,OAAS,GAAvB,CAcA,IAFAkU,EAAKxQ,EAAQ,SAAQ,YACN,MAAXk3B,IAAiBA,GAAU,GAC1B76B,EAAI,EAAGA,EAAImD,IAAKnD,EAAG6C,KAAK+V,KAAKzE,EAAGkF,EAAUrZ,GAAI2D,EAAOk3B,IAC1D,OAAOh4B,IALP,CATE,IAAIsR,EAAKtR,KAAK0K,OAAO6G,KACrB,GAAID,EAAI,IAAK,IAA0B7Q,EAAtB+Q,EAAI,EAAGtN,EAAIoN,EAAGlU,OAAWoU,EAAItN,IAAKsN,EACjD,IAAKrU,EAAI,EAAGsD,EAAI6Q,EAAGE,GAAIrU,EAAImD,IAAKnD,EAC9B,IAAKqD,EAAIgW,EAAUrZ,IAAIsU,OAAShR,EAAEgR,MAAQjR,EAAE+D,OAAS9D,EAAE8D,KACrD,OAAO9D,EAAEK,KAWnB,EEpBE4V,SD9Ca,gCAASjF,EAAMQ,GAC5B,OAAOjS,KAAK+V,MAAwB,mBAAX9D,EACnB,0BACA,2BAAkBR,EAAMQ,GAChC,GmB/Be,iCAAS9H,GACtB,MAA2B,iBAAbA,EACR,IAAI,wBAAU,CAAC,CAACxK,SAASyG,cAAc+D,KAAa,CAACxK,SAASgR,kBAC9D,IAAI,wBAAU,CAAC,CAACxG,IAAY,GACpC,CCNA,IAAImvC,GAAS,EAMb,SAASC,QACPv5C,KAAKsY,EAAI,OAASghC,IAAQt4C,SAAS,GACrC,CCNe,wCAEb,IADA,IAAqB8mB,EAAjB0iB,EAAU,GACP1iB,EAAS0iB,EAAQxQ,aAAawQ,EAAU1iB,EAC/C,OAAO0iB,CACT,CCNe,mBAAS9/B,EAAMoH,GAC5B,IAAIlF,EAAMlC,EAAKwvB,iBAAmBxvB,EAElC,GAAIkC,EAAIutB,eAAgB,CACtB,IAAIC,EAAQxtB,EAAIutB,iBAGhB,OAFAC,EAAM/vB,EAAIyH,EAAMuoB,QAASD,EAAMxyB,EAAIkK,EAAMwoB,QAElC,EADPF,EAAQA,EAAMG,gBAAgB7vB,EAAK8vB,eAAeC,YACpCpwB,EAAG+vB,EAAMxyB,EACzB,CAEA,IAAI+yB,EAAOjwB,EAAKgwB,wBAChB,MAAO,CAAC5oB,EAAMuoB,QAAUM,EAAKvjB,KAAO1M,EAAKkwB,WAAY9oB,EAAMwoB,QAAUK,EAAKE,IAAMnwB,EAAKowB,UACvF,CCTe,eAASpwB,GACtB,IAAIoH,EAAQ,+BAEZ,OADIA,EAAMotB,iBAAgBptB,EAAQA,EAAMotB,eAAe,IAChD,UAAMx0B,EAAMoH,EACrB,CCJe,eAASpH,EAAM40B,EAASriC,GACjC6Q,UAAU1Q,OAAS,IAAGH,EAAaqiC,EAASA,EAAU,+BAAcJ,gBAExE,IAAK,IAA6Csa,EAAzCr8C,EAAI,EAAGmD,EAAIg/B,EAAUA,EAAQliC,OAAS,EAAUD,EAAImD,IAAKnD,EAChE,IAAKq8C,EAAQla,EAAQniC,IAAIF,aAAeA,EACtC,OAAO,UAAMyN,EAAM8uC,GAIvB,OAAO,IACT,CJHAD,MAAM7yC,UARS,SAAS,cACtB,OAAO,IAAI6yC,KACb,EAMwB7yC,UAAY,CAClCrC,YAAak1C,MACb5wC,IAAK,SAAS+B,GAEZ,IADA,IAAIhO,EAAKsD,KAAKsY,IACL5b,KAAMgO,SAAaA,EAAOA,EAAKrD,YAAa,OACrD,OAAOqD,EAAKhO,EACd,EACA0P,IAAK,SAAS1B,EAAM5J,GAClB,OAAO4J,EAAK1K,KAAKsY,GAAKxX,CACxB,EACAhC,OAAQ,SAAS4L,GACf,OAAO1K,KAAKsY,KAAK5N,UAAeA,EAAK1K,KAAKsY,EAC5C,EACAtX,SAAU,WACR,OAAOhB,KAAKsY,CACd,GKzBF,IAAI,GAAO,CAACxX,MAAO,WAAY,GAE/B,SAAS,wBACP,IAAK,IAAyCN,EAArCrD,EAAI,EAAGmD,EAAIwN,UAAU1Q,OAAQkb,EAAI,CAAC,EAAMnb,EAAImD,IAAKnD,EAAG,CAC3D,KAAMqD,EAAIsN,UAAU3Q,GAAK,KAAQqD,KAAK8X,EAAI,MAAM,IAAI7R,MAAM,iBAAmBjG,GAC7E8X,EAAE9X,GAAK,EACT,CACA,OAAO,IAAI,kBAAS8X,EACtB,CAEA,SAAS,kBAASA,GAChBtY,KAAKsY,EAAIA,CACX,CAoDA,SAAS,aAAI7G,EAAMlN,GACjB,IAAK,IAA4ByC,EAAxB7J,EAAI,EAAGmD,EAAImR,EAAKrU,OAAWD,EAAImD,IAAKnD,EAC3C,IAAK6J,EAAIyK,EAAKtU,IAAIoH,OAASA,EACzB,OAAOyC,EAAElG,KAGf,CAEA,SAAS,aAAI2Q,EAAMlN,EAAMqR,GACvB,IAAK,IAAIzY,EAAI,EAAGmD,EAAImR,EAAKrU,OAAQD,EAAImD,IAAKnD,EACxC,GAAIsU,EAAKtU,GAAGoH,OAASA,EAAM,CACzBkN,EAAKtU,GAAK,GAAMsU,EAAOA,EAAKjI,MAAM,EAAGrM,GAAGU,OAAO4T,EAAKjI,MAAMrM,EAAI,IAC9D,KACF,CAGF,OADgB,MAAZyY,GAAkBnE,EAAKhV,KAAK,CAAC8H,KAAMA,EAAMzD,MAAO8U,IAC7CnE,CACT,CA1DA,kBAAS/K,UAAY,sBAASA,UAAY,CACxCrC,YAAa,kBACbiN,GAAI,SAASD,EAAUuE,GACrB,IAEIpV,EAFA8X,EAAItY,KAAKsY,EACT0X,EAbR,SAAS,4BAAexZ,EAAWyZ,GACjC,OAAOzZ,EAAUzH,OAAOC,MAAM,SAAS/N,IAAI,SAAST,GAClD,IAAI+D,EAAO,GAAIpH,EAAIqD,EAAEyM,QAAQ,KAE7B,GADI9P,GAAK,IAAGoH,EAAO/D,EAAEgJ,MAAMrM,EAAI,GAAIqD,EAAIA,EAAEgJ,MAAM,EAAGrM,IAC9CqD,IAAMyvB,EAAMnnB,eAAetI,GAAI,MAAM,IAAIiG,MAAM,iBAAmBjG,GACtE,MAAO,CAACiR,KAAMjR,EAAG+D,KAAMA,EACzB,EACF,CAMY,CAAe8M,EAAW,GAAIiH,GAElCnb,GAAK,EACLmD,EAAI0vB,EAAE5yB,OAGV,KAAI0Q,UAAU1Q,OAAS,GAAvB,CAOA,GAAgB,MAAZwY,GAAwC,mBAAbA,EAAyB,MAAM,IAAInP,MAAM,qBAAuBmP,GAC/F,OAASzY,EAAImD,GACX,GAAIE,GAAK6Q,EAAW2e,EAAE7yB,IAAIsU,KAAM6G,EAAE9X,GAAK,aAAI8X,EAAE9X,GAAI6Q,EAAS9M,KAAMqR,QAC3D,GAAgB,MAAZA,EAAkB,IAAKpV,KAAK8X,EAAGA,EAAE9X,GAAK,aAAI8X,EAAE9X,GAAI6Q,EAAS9M,KAAM,MAG1E,OAAOvE,IAVP,CAFE,OAAS7C,EAAImD,OAAQE,GAAK6Q,EAAW2e,EAAE7yB,IAAIsU,QAAUjR,EAAI,aAAI8X,EAAE9X,GAAI6Q,EAAS9M,OAAQ,OAAO/D,CAa/F,EACAgY,KAAM,WACJ,IAAIA,EAAO,CAAC,EAAGF,EAAItY,KAAKsY,EACxB,IAAK,IAAI9X,KAAK8X,EAAGE,EAAKhY,GAAK8X,EAAE9X,GAAGgJ,QAChC,OAAO,IAAI,kBAASgP,EACtB,EACAhV,KAAM,SAASiO,EAAMye,GACnB,IAAK5vB,EAAIwN,UAAU1Q,OAAS,GAAK,EAAG,IAAK,IAAgCkD,EAAGE,EAA/B2vB,EAAO,IAAI7mB,MAAMhJ,GAAInD,EAAI,EAASA,EAAImD,IAAKnD,EAAGgzB,EAAKhzB,GAAK2Q,UAAU3Q,EAAI,GACnH,IAAK6C,KAAKsY,EAAExP,eAAe2I,GAAO,MAAM,IAAIhL,MAAM,iBAAmBgL,GACrE,IAAuBtU,EAAI,EAAGmD,GAAzBE,EAAIR,KAAKsY,EAAE7G,IAAoBrU,OAAQD,EAAImD,IAAKnD,EAAGqD,EAAErD,GAAG2D,MAAMqG,MAAM+oB,EAAMC,EACjF,EACAhpB,MAAO,SAASsK,EAAMye,EAAMC,GAC1B,IAAKnwB,KAAKsY,EAAExP,eAAe2I,GAAO,MAAM,IAAIhL,MAAM,iBAAmBgL,GACrE,IAAK,IAAIjR,EAAIR,KAAKsY,EAAE7G,GAAOtU,EAAI,EAAGmD,EAAIE,EAAEpD,OAAQD,EAAImD,IAAKnD,EAAGqD,EAAErD,GAAG2D,MAAMqG,MAAM+oB,EAAMC,EACrF,GAsBF,+BCjFO,SAAS,oCACd,GAAMgI,0BACR,CAEe,+BACb,GAAMD,iBACN,GAAMC,0BACR,CCTe,8BAAS9tB,GACtB,OAAO,WACL,OAAOA,CACT,CACF,CCJe,SAASovC,UAAUxzC,EAAQwL,EAAM24B,EAAS1tC,EAAIo2B,EAAQzoB,EAAGzC,EAAGwxB,EAAIC,EAAI3iB,GACjF1W,KAAKiG,OAASA,EACdjG,KAAKyR,KAAOA,EACZzR,KAAKoqC,QAAUA,EACfpqC,KAAK/C,WAAaP,EAClBsD,KAAK8yB,OAASA,EACd9yB,KAAKqK,EAAIA,EACTrK,KAAK4H,EAAIA,EACT5H,KAAKo5B,GAAKA,EACVp5B,KAAKq5B,GAAKA,EACVr5B,KAAKsY,EAAI5B,CACX,CCHA,SAAS,qBACP,OAAQ,GAAMilB,MAChB,CAEA,SAAS+d,mBACP,OAAO15C,KAAKqH,UACd,CAEA,SAASsyC,eAAe55C,GACtB,OAAY,MAALA,EAAY,CAACsK,EAAG,GAAMA,EAAGzC,EAAG,GAAMA,GAAK7H,CAChD,CAEA,SAAS,wBACP,MAAO,iBAAkBC,IAC3B,CAEe,gBACb,IAOI45C,EACAC,EACAC,EACA5c,EAVApyB,EAAS,mBACTw1B,EAAYoZ,iBACZtP,EAAUuP,eACVtc,EAAY,sBACZ0c,EAAW,CAAC,EACZxc,EAAY,GAAS,QAAS,OAAQ,OACtCzK,EAAS,EAKT0K,EAAiB,EAErB,SAASwc,KAAKjnC,GACZA,EACKzB,GAAG,iBAAkBqsB,aACvB7yB,OAAOuyB,GACL/rB,GAAG,kBAAmBusB,cACtBvsB,GAAG,iBAAkBwsB,YACrBxsB,GAAG,iCAAkCysB,YACrC/3B,MAAM,eAAgB,QACtBA,MAAM,8BAA+B,gBAC5C,CAEA,SAAS23B,cACP,IAAIT,GAAgBpyB,EAAO3D,MAAMnH,KAAM8N,WAAvC,CACA,IAAImwB,EAAUgc,YAAY,QAAS3Z,EAAUn5B,MAAMnH,KAAM8N,WAAYywB,MAAOv+B,KAAM8N,WAC7EmwB,IACL,wBAAO,GAAMQ,MAAMntB,GAAG,iBAAkBotB,YAAY,GAAMptB,GAAG,eAAgButB,YAAY,GClD9E,oBAASJ,GACtB,IAAIxiC,EAAOwiC,EAAK9+B,SAASgR,gBACrBoC,EAAY,wBAAO0rB,GAAMntB,GAAG,iBAAkB,qBAAS,GACvD,kBAAmBrV,EACrB8W,EAAUzB,GAAG,mBAAoB,qBAAS,IAE1CrV,EAAKgjC,WAAahjC,EAAK+J,MAAMg5B,cAC7B/iC,EAAK+J,MAAMg5B,cAAgB,OAE/B,CD0CI,CAAO,GAAMP,MACb,oCACAqb,GAAc,EACdF,EAAa,GAAMvf,QACnBwf,EAAa,GAAMvf,QACnB2D,EAAQ,SATiD,CAU3D,CAEA,SAASS,aAEP,GADA,uBACKob,EAAa,CAChB,IAAI1gB,EAAK,GAAMiB,QAAUuf,EAAYvgB,EAAK,GAAMiB,QAAUuf,EAC1DC,EAAc1gB,EAAKA,EAAKC,EAAKA,EAAKmE,CACpC,CACAuc,EAASxb,MAAM,OACjB,CAEA,SAASM,aACP,wBAAO,GAAMJ,MAAMntB,GAAG,8BAA+B,MC1DlD,SAAS,eAAQmtB,EAAMM,GAC5B,IAAI9iC,EAAOwiC,EAAK9+B,SAASgR,gBACrBoC,EAAY,wBAAO0rB,GAAMntB,GAAG,iBAAkB,MAC9CytB,IACFhsB,EAAUzB,GAAG,aAAc,qBAAS,GACpC0f,WAAW,WAAaje,EAAUzB,GAAG,aAAc,KAAO,EAAG,IAE3D,kBAAmBrV,EACrB8W,EAAUzB,GAAG,mBAAoB,OAEjCrV,EAAK+J,MAAMg5B,cAAgB/iC,EAAKgjC,kBACzBhjC,EAAKgjC,WAEhB,CD8CI,CAAQ,GAAMR,KAAMqb,GACpB,sBACAC,EAASxb,MAAM,MACjB,CAEA,SAASV,eACP,GAAK/yB,EAAO3D,MAAMnH,KAAM8N,WAAxB,CACA,IAEwB3Q,EAAG8gC,EAFvBqB,EAAU,GAAMJ,eAChBl4B,EAAIs5B,EAAUn5B,MAAMnH,KAAM8N,WAC1BxN,EAAIg/B,EAAQliC,OAEhB,IAAKD,EAAI,EAAGA,EAAImD,IAAKnD,GACf8gC,EAAUgc,YAAY3a,EAAQniC,GAAGF,WAAY+J,EAAGwyC,MAAOx5C,KAAM8N,cAC/D,oCACAmwB,EAAQ,SAR8B,CAW5C,CAEA,SAASH,aACP,IACwB3gC,EAAG8gC,EADvBqB,EAAU,GAAMJ,eAChB5+B,EAAIg/B,EAAQliC,OAEhB,IAAKD,EAAI,EAAGA,EAAImD,IAAKnD,GACf8gC,EAAU8b,EAASza,EAAQniC,GAAGF,eAChC,sBACAghC,EAAQ,QAGd,CAEA,SAASF,aACP,IACwB5gC,EAAG8gC,EADvBqB,EAAU,GAAMJ,eAChB5+B,EAAIg/B,EAAQliC,OAIhB,IAFI8/B,GAAapL,aAAaoL,GAC9BA,EAAclM,WAAW,WAAakM,EAAc,IAAM,EAAG,KACxD//B,EAAI,EAAGA,EAAImD,IAAKnD,GACf8gC,EAAU8b,EAASza,EAAQniC,GAAGF,eAChC,oCACAghC,EAAQ,OAGd,CAEA,SAASgc,YAAYv9C,EAAI4jC,EAAWlG,EAAOlK,EAAMC,GAC/C,IAA8BhL,EAAGiU,EAAIC,EAAjCr0B,EAAIo1B,EAAMkG,EAAW5jC,GACrBw9C,EAAe3c,EAAU/kB,OAE7B,GAAK6gC,YAAY,IAAII,UAAUO,KAAM,cAAe70B,EAAGzoB,EAAIo2B,EAAQ9tB,EAAE,GAAIA,EAAE,GAAI,EAAG,EAAGk1C,GAAe,WAClG,OAAuD,OAAlD,GAAM9P,QAAUjlB,EAAIilB,EAAQjjC,MAAM+oB,EAAMC,MAC7CiJ,EAAKjU,EAAE9a,EAAIrF,EAAE,IAAM,EACnBq0B,EAAKlU,EAAEvd,EAAI5C,EAAE,IAAM,GACZ,EACT,GAEA,OAAO,SAASi5B,QAAQxsB,GACtB,IAAYnR,EAARq4B,EAAK3zB,EACT,OAAQyM,GACN,IAAK,QAASsoC,EAASr9C,GAAMuhC,QAAS39B,EAAIwyB,IAAU,MACpD,IAAK,aAAcinB,EAASr9C,KAAOo2B,EACnC,IAAK,OAAQ9tB,EAAIo1B,EAAMkG,EAAW5jC,GAAK4D,EAAIwyB,EAE7CumB,YAAY,IAAII,UAAUO,KAAMvoC,EAAM0T,EAAGzoB,EAAI4D,EAAG0E,EAAE,GAAKo0B,EAAIp0B,EAAE,GAAKq0B,EAAIr0B,EAAE,GAAK2zB,EAAG,GAAI3zB,EAAE,GAAK2zB,EAAG,GAAIuhB,GAAeA,EAAa/yC,MAAO+yC,EAAc,CAACzoC,EAAMye,EAAMC,GAClK,CACF,CA2BA,OAzBA6pB,KAAKlvC,OAAS,SAASwN,GACrB,OAAOxK,UAAU1Q,QAAU0N,EAAsB,mBAANwN,EAAmBA,EAAI,uBAAWA,GAAI0hC,MAAQlvC,CAC3F,EAEAkvC,KAAK1Z,UAAY,SAAShoB,GACxB,OAAOxK,UAAU1Q,QAAUkjC,EAAyB,mBAANhoB,EAAmBA,EAAI,qBAASA,GAAI0hC,MAAQ1Z,CAC5F,EAEA0Z,KAAK5P,QAAU,SAAS9xB,GACtB,OAAOxK,UAAU1Q,QAAUgtC,EAAuB,mBAAN9xB,EAAmBA,EAAI,qBAASA,GAAI0hC,MAAQ5P,CAC1F,EAEA4P,KAAK3c,UAAY,SAAS/kB,GACxB,OAAOxK,UAAU1Q,QAAUigC,EAAyB,mBAAN/kB,EAAmBA,EAAI,uBAAWA,GAAI0hC,MAAQ3c,CAC9F,EAEA2c,KAAK1oC,GAAK,WACR,IAAIxQ,EAAQy8B,EAAUjsB,GAAGnK,MAAMo2B,EAAWzvB,WAC1C,OAAOhN,IAAUy8B,EAAYyc,KAAOl5C,CACtC,EAEAk5C,KAAK5Z,cAAgB,SAAS9nB,GAC5B,OAAOxK,UAAU1Q,QAAUogC,GAAkBllB,GAAKA,GAAKA,EAAG0hC,MAAQhlC,KAAK0D,KAAK8kB,EAC9E,EAEOwc,IACT,CDzJAP,UAAU/yC,UAAU4K,GAAK,WACvB,IAAIxQ,EAAQd,KAAKsY,EAAEhH,GAAGnK,MAAMnH,KAAKsY,EAAGxK,WACpC,OAAOhN,IAAUd,KAAKsY,EAAItY,KAAOc,CACnC,EGhBA,IAAI,GAAKkU,KAAKwZ,GACV,GAAM,EAAI,GACV,GAAU,KACV2rB,GAAa,GAAM,GAEvB,SAASC,OACPp6C,KAAKq6C,IAAMr6C,KAAKs6C,IAChBt6C,KAAKu6C,IAAMv6C,KAAKw6C,IAAM,KACtBx6C,KAAKsY,EAAI,EACX,CAEA,SAAS,YACP,OAAO,IAAI8hC,IACb,CAEAA,KAAK1zC,UAAY,UAAKA,UAAY,CAChCrC,YAAa+1C,KACbvL,OAAQ,SAASxkC,EAAGzC,GAClB5H,KAAKsY,GAAK,KAAOtY,KAAKq6C,IAAMr6C,KAAKu6C,KAAOlwC,GAAK,KAAOrK,KAAKs6C,IAAMt6C,KAAKw6C,KAAO5yC,EAC7E,EACAgnC,UAAW,WACQ,OAAb5uC,KAAKu6C,MACPv6C,KAAKu6C,IAAMv6C,KAAKq6C,IAAKr6C,KAAKw6C,IAAMx6C,KAAKs6C,IACrCt6C,KAAKsY,GAAK,IAEd,EACAw2B,OAAQ,SAASzkC,EAAGzC,GAClB5H,KAAKsY,GAAK,KAAOtY,KAAKu6C,KAAOlwC,GAAK,KAAOrK,KAAKw6C,KAAO5yC,EACvD,EACA6yC,iBAAkB,SAASrsB,EAAI2c,EAAI1gC,EAAGzC,GACpC5H,KAAKsY,GAAK,MAAQ8V,EAAM,MAAQ2c,EAAM,KAAO/qC,KAAKu6C,KAAOlwC,GAAK,KAAOrK,KAAKw6C,KAAO5yC,EACnF,EACA8yC,cAAe,SAAStsB,EAAI2c,EAAI8J,EAAIC,EAAIzqC,EAAGzC,GACzC5H,KAAKsY,GAAK,MAAQ8V,EAAM,MAAQ2c,EAAM,MAAQ8J,EAAM,MAAQC,EAAM,KAAO90C,KAAKu6C,KAAOlwC,GAAK,KAAOrK,KAAKw6C,KAAO5yC,EAC/G,EACA+yC,MAAO,SAASvsB,EAAI2c,EAAI8J,EAAIC,EAAIv0C,GAC9B6tB,GAAMA,EAAI2c,GAAMA,EAAI8J,GAAMA,EAAIC,GAAMA,EAAIv0C,GAAKA,EAC7C,IAAI4tB,EAAKnuB,KAAKu6C,IACV3b,EAAK5+B,KAAKw6C,IACVI,EAAM/F,EAAKzmB,EACXysB,EAAM/F,EAAK/J,EACX+P,EAAM3sB,EAAKC,EACX2sB,EAAMnc,EAAKmM,EACXiQ,EAAQF,EAAMA,EAAMC,EAAMA,EAG9B,GAAIx6C,EAAI,EAAG,MAAM,IAAIkG,MAAM,oBAAsBlG,GAGjD,GAAiB,OAAbP,KAAKu6C,IACPv6C,KAAKsY,GAAK,KAAOtY,KAAKu6C,IAAMnsB,GAAM,KAAOpuB,KAAKw6C,IAAMzP,QAIjD,GAAMiQ,EAAQ,GAKd,GAAMhmC,KAAK+V,IAAIgwB,EAAMH,EAAMC,EAAMC,GAAO,IAAav6C,EAKrD,CACH,IAAI06C,EAAMpG,EAAK1mB,EACX+sB,EAAMpG,EAAKlW,EACXuc,EAAQP,EAAMA,EAAMC,EAAMA,EAC1BO,EAAQH,EAAMA,EAAMC,EAAMA,EAC1BG,EAAMrmC,KAAK0D,KAAKyiC,GAChBG,EAAMtmC,KAAK0D,KAAKsiC,GAChBjzC,EAAIxH,EAAIyU,KAAKkO,KAAK,GAAKlO,KAAKs+B,MAAM6H,EAAQH,EAAQI,IAAU,EAAIC,EAAMC,KAAS,GAC/EC,EAAMxzC,EAAIuzC,EACVE,EAAMzzC,EAAIszC,EAGVrmC,KAAK+V,IAAIwwB,EAAM,GAAK,KACtBv7C,KAAKsY,GAAK,KAAO8V,EAAKmtB,EAAMT,GAAO,KAAO/P,EAAKwQ,EAAMR,IAGvD/6C,KAAKsY,GAAK,IAAM/X,EAAI,IAAMA,EAAI,WAAaw6C,EAAME,EAAMH,EAAMI,GAAQ,KAAOl7C,KAAKu6C,IAAMnsB,EAAKotB,EAAMZ,GAAO,KAAO56C,KAAKw6C,IAAMzP,EAAKyQ,EAAMX,EACxI,MArBE76C,KAAKsY,GAAK,KAAOtY,KAAKu6C,IAAMnsB,GAAM,KAAOpuB,KAAKw6C,IAAMzP,QAsBxD,EACAgE,IAAK,SAAS1kC,EAAGzC,EAAGrH,EAAGgsC,EAAIpB,EAAIsQ,GAC7BpxC,GAAKA,EAAGzC,GAAKA,EAAW6zC,IAAQA,EAChC,IAAIriB,GADY74B,GAAKA,GACRyU,KAAKwa,IAAI+c,GAClBlT,EAAK94B,EAAIyU,KAAKya,IAAI8c,GAClBpe,EAAK9jB,EAAI+uB,EACTwF,EAAKh3B,EAAIyxB,EACTqiB,EAAK,EAAID,EACTE,EAAKF,EAAMlP,EAAKpB,EAAKA,EAAKoB,EAG9B,GAAIhsC,EAAI,EAAG,MAAM,IAAIkG,MAAM,oBAAsBlG,GAGhC,OAAbP,KAAKu6C,IACPv6C,KAAKsY,GAAK,IAAM6V,EAAK,IAAMyQ,GAIpB5pB,KAAK+V,IAAI/qB,KAAKu6C,IAAMpsB,GAAM,IAAWnZ,KAAK+V,IAAI/qB,KAAKw6C,IAAM5b,GAAM,MACtE5+B,KAAKsY,GAAK,IAAM6V,EAAK,IAAMyQ,GAIxBr+B,IAGDo7C,EAAK,IAAGA,EAAKA,EAAK,GAAM,IAGxBA,EAAKxB,GACPn6C,KAAKsY,GAAK,IAAM/X,EAAI,IAAMA,EAAI,QAAUm7C,EAAK,KAAOrxC,EAAI+uB,GAAM,KAAOxxB,EAAIyxB,GAAM,IAAM94B,EAAI,IAAMA,EAAI,QAAUm7C,EAAK,KAAO17C,KAAKu6C,IAAMpsB,GAAM,KAAOnuB,KAAKw6C,IAAM5b,GAIrJ+c,EAAK,KACZ37C,KAAKsY,GAAK,IAAM/X,EAAI,IAAMA,EAAI,SAAWo7C,GAAM,IAAO,IAAMD,EAAK,KAAO17C,KAAKu6C,IAAMlwC,EAAI9J,EAAIyU,KAAKwa,IAAI2b,IAAO,KAAOnrC,KAAKw6C,IAAM5yC,EAAIrH,EAAIyU,KAAKya,IAAI0b,KAElJ,EACAxQ,KAAM,SAAStwB,EAAGzC,EAAGxC,EAAG8f,GACtBllB,KAAKsY,GAAK,KAAOtY,KAAKq6C,IAAMr6C,KAAKu6C,KAAOlwC,GAAK,KAAOrK,KAAKs6C,IAAMt6C,KAAKw6C,KAAO5yC,GAAK,MAAQxC,EAAK,MAAQ8f,EAAK,KAAQ9f,EAAK,GACzH,EACApE,SAAU,WACR,OAAOhB,KAAKsY,CACd,GAGF,mBCjIe,+BAASjO,GACtB,OAAO,SAASuxC,WACd,OAAOvxC,CACT,CACF,CCJO,IAAI,GAAU,MACV,GAAK2K,KAAKwZ,GACV,GAAS,GAAK,EACd,GAAM,EAAI,GCCrB,SAASqtB,eAAe97C,GACtB,OAAOA,EAAE+7C,WACX,CAEA,SAASC,eAAeh8C,GACtB,OAAOA,EAAEi8C,WACX,CAEA,SAASC,cAAcl8C,GACrB,OAAOA,EAAEm8C,UACX,CAEA,SAASC,YAAYp8C,GACnB,OAAOA,EAAEq8C,QACX,CAEA,SAASC,YAAYt8C,GACnB,OAAOA,GAAKA,EAAEu8C,QAChB,CAEA,SAAS,SAAKjyC,GACZ,OAAOA,GAAK,EAAI,GAASA,IAAM,GAAK,GAAS2K,KAAK8wB,KAAKz7B,EACzD,CAWA,SAASkyC,eAAepuB,EAAIyQ,EAAIxQ,EAAI2c,EAAI3hB,EAAIozB,EAAId,GAC9C,IAAIZ,EAAM3sB,EAAKC,EACX2sB,EAAMnc,EAAKmM,EACX1zB,GAAMqkC,EAAKc,GAAMA,GAAMxnC,KAAK0D,KAAKoiC,EAAMA,EAAMC,EAAMA,GACnD0B,EAAKplC,EAAK0jC,EACV2B,GAAMrlC,EAAKyjC,EACX6B,EAAMxuB,EAAKsuB,EACXG,EAAMhe,EAAK8d,EACXG,EAAMzuB,EAAKquB,EACXK,EAAM/R,EAAK2R,EACXlP,GAAOmP,EAAME,GAAO,EACpBpP,GAAOmP,EAAME,GAAO,EACpB1jB,EAAKyjB,EAAMF,EACXtjB,EAAKyjB,EAAMF,EACXtjB,EAAKF,EAAKA,EAAKC,EAAKA,EACpB94B,EAAI6oB,EAAKozB,EACTO,EAAIJ,EAAMG,EAAMD,EAAMD,EACtB78C,GAAKs5B,EAAK,GAAK,EAAI,GAAKrkB,KAAK0D,KAAK1D,KAAK4B,IAAI,EAAGrW,EAAIA,EAAI+4B,EAAKyjB,EAAIA,IAC/DC,GAAOD,EAAI1jB,EAAKD,EAAKr5B,GAAKu5B,EAC1B2jB,IAAQF,EAAI3jB,EAAKC,EAAKt5B,GAAKu5B,EAC3B4jB,GAAOH,EAAI1jB,EAAKD,EAAKr5B,GAAKu5B,EAC1B6jB,IAAQJ,EAAI3jB,EAAKC,EAAKt5B,GAAKu5B,EAC3BsD,EAAMogB,EAAMxP,EACZ1Q,EAAMmgB,EAAMxP,EACZ5Q,EAAMqgB,EAAM1P,EACZzQ,EAAMogB,EAAM1P,EAMhB,OAFI7Q,EAAMA,EAAME,EAAMA,EAAMD,EAAMA,EAAME,EAAMA,IAAKigB,EAAME,EAAKD,EAAME,GAE7D,CACL7T,GAAI0T,EACJzT,GAAI0T,EACJnC,KAAM2B,EACN1B,KAAM2B,EACNC,IAAKK,GAAO5zB,EAAK7oB,EAAI,GACrBq8C,IAAKK,GAAO7zB,EAAK7oB,EAAI,GAEzB,CC5EA,SAAS68C,OAAOzoC,GACd3U,KAAKuuC,SAAW55B,CAClB,CA0Be,sBAASA,GACtB,OAAO,IAAIyoC,OAAOzoC,EACpB,CC9BO,SAAS,QAAE3P,GAChB,OAAOA,EAAE,EACX,CAEO,SAAS,QAAEA,GAChB,OAAOA,EAAE,EACX,CDFAo4C,OAAO12C,UAAY,CACjB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,YACHroC,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EACtB,QAAS3uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAErC,IECa,SAAS,mBAAY21C,GAElC,SAASC,OAAO7oC,GACd,OAAO,IAAI8oC,OAAOF,EAAM5oC,GAC1B,CAIA,OAFA6oC,OAAOE,OAASH,EAETC,MACT,EAjC+B,CAAY,cAE3C,SAASC,OAAOF,GACdv9C,KAAK09C,OAASH,CAChB,CAEAE,OAAO/2C,UAAY,CACjB22C,UAAW,WACTr9C,KAAK09C,OAAOL,WACd,EACAC,QAAS,WACPt9C,KAAK09C,OAAOJ,SACd,EACAlV,UAAW,WACTpoC,KAAK09C,OAAOtV,WACd,EACAC,QAAS,WACProC,KAAK09C,OAAOrV,SACd,EACAjO,MAAO,SAAS15B,EAAGH,GACjBP,KAAK09C,OAAOtjB,MAAM75B,EAAIyU,KAAKya,IAAI/uB,GAAIH,GAAKyU,KAAKwa,IAAI9uB,GACnD,GCvBUsU,KAAK0D,KAAK,EAAI,GCE1B,IACIilC,GAAK3oC,KAAKya,IAAI,GAAK,IAAMza,KAAKya,IAAI,EAAI,GAAK,IACtCza,KAAKya,IAAI,GAAM,IACdza,KAAKwa,IAAI,GAAM,ICLbxa,KAAK0D,KAAK,GCCd1D,KAAK0D,KAAK,GACN1D,KAAK0D,KAAK,ICFP,oBAAY,CCApB,SAAS,YAAMwX,EAAM7lB,EAAGzC,GAC7BsoB,EAAKqe,SAASmM,eACX,EAAIxqB,EAAKmqB,IAAMnqB,EAAKqqB,KAAO,GAC3B,EAAIrqB,EAAKoqB,IAAMpqB,EAAKsqB,KAAO,GAC3BtqB,EAAKmqB,IAAM,EAAInqB,EAAKqqB,KAAO,GAC3BrqB,EAAKoqB,IAAM,EAAIpqB,EAAKsqB,KAAO,GAC3BtqB,EAAKmqB,IAAM,EAAInqB,EAAKqqB,IAAMlwC,GAAK,GAC/B6lB,EAAKoqB,IAAM,EAAIpqB,EAAKsqB,IAAM5yC,GAAK,EAEpC,CAEO,SAASg2C,MAAMjpC,GACpB3U,KAAKuuC,SAAW55B,CAClB,CCVA,SAASkpC,YAAYlpC,GACnB3U,KAAKuuC,SAAW55B,CAClB,CCHA,SAASmpC,UAAUnpC,GACjB3U,KAAKuuC,SAAW55B,CAClB,CCFA,SAASopC,OAAOppC,EAASqpC,GACvBh+C,KAAKi+C,OAAS,IAAIL,MAAMjpC,GACxB3U,KAAKk+C,MAAQF,CACf,CHUAJ,MAAMl3C,UAAY,CAChB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAChBv6C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMhuC,IACtBxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EAAG,YAAM3uC,KAAMA,KAAKu6C,IAAKv6C,KAAKw6C,KACnC,KAAK,EAAGx6C,KAAKuuC,SAASO,OAAO9uC,KAAKu6C,IAAKv6C,KAAKw6C,MAE1Cx6C,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAKuuC,SAASO,QAAQ,EAAI9uC,KAAKq6C,IAAMr6C,KAAKu6C,KAAO,GAAI,EAAIv6C,KAAKs6C,IAAMt6C,KAAKw6C,KAAO,GACzG,QAAS,YAAMx6C,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMlwC,EAChCrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAM5yC,CAClC,GCtCFi2C,YAAYn3C,UAAY,CACtB22C,UAAW,SACXC,QAAS,SACTlV,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAMn+C,KAAKo+C,IAAMp+C,KAAKq+C,IACjDr+C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAMt+C,KAAKu+C,IAAMv+C,KAAKw+C,IAAMhyC,IACvDxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EACH3uC,KAAKuuC,SAASM,OAAO7uC,KAAKm+C,IAAKn+C,KAAKs+C,KACpCt+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKuuC,SAASM,QAAQ7uC,KAAKm+C,IAAM,EAAIn+C,KAAKo+C,KAAO,GAAIp+C,KAAKs+C,IAAM,EAAIt+C,KAAKu+C,KAAO,GAChFv+C,KAAKuuC,SAASO,QAAQ9uC,KAAKo+C,IAAM,EAAIp+C,KAAKm+C,KAAO,GAAIn+C,KAAKu+C,IAAM,EAAIv+C,KAAKs+C,KAAO,GAChFt+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKo6B,MAAMp6B,KAAKm+C,IAAKn+C,KAAKs+C,KAC1Bt+C,KAAKo6B,MAAMp6B,KAAKo+C,IAAKp+C,KAAKu+C,KAC1Bv+C,KAAKo6B,MAAMp6B,KAAKq+C,IAAKr+C,KAAKw+C,KAIhC,EACApkB,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAKm+C,IAAM9zC,EAAGrK,KAAKs+C,IAAM12C,EAAG,MACrD,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKo+C,IAAM/zC,EAAGrK,KAAKu+C,IAAM32C,EAAG,MACrD,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKq+C,IAAMh0C,EAAGrK,KAAKw+C,IAAM52C,EAAG5H,KAAKuuC,SAASM,QAAQ7uC,KAAKq6C,IAAM,EAAIr6C,KAAKu6C,IAAMlwC,GAAK,GAAIrK,KAAKs6C,IAAM,EAAIt6C,KAAKw6C,IAAM5yC,GAAK,GAAI,MACjJ,QAAS,YAAM5H,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMlwC,EAChCrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAM5yC,CAClC,GCxCFk2C,UAAUp3C,UAAY,CACpB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAChBv6C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMhuC,IACtBxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,YACHroC,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,IAAIxgB,GAAMnuB,KAAKq6C,IAAM,EAAIr6C,KAAKu6C,IAAMlwC,GAAK,EAAGu0B,GAAM5+B,KAAKs6C,IAAM,EAAIt6C,KAAKw6C,IAAM5yC,GAAK,EAAG5H,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAO3gB,EAAIyQ,GAAM5+B,KAAKuuC,SAASM,OAAO1gB,EAAIyQ,GAAK,MACvL,KAAK,EAAG5+B,KAAK2uC,OAAS,EACtB,QAAS,YAAM3uC,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMlwC,EAChCrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAM5yC,CAClC,GC1BFm2C,OAAOr3C,UAAY,CACjB0hC,UAAW,WACTpoC,KAAKy+C,GAAK,GACVz+C,KAAK0+C,GAAK,GACV1+C,KAAKi+C,OAAO7V,WACd,EACAC,QAAS,WACP,IAAIh+B,EAAIrK,KAAKy+C,GACT72C,EAAI5H,KAAK0+C,GACTltC,EAAInH,EAAEjN,OAAS,EAEnB,GAAIoU,EAAI,EAQN,IAPA,IAKIhR,EALA2tB,EAAK9jB,EAAE,GACPu0B,EAAKh3B,EAAE,GACPwxB,EAAK/uB,EAAEmH,GAAK2c,EACZkL,EAAKzxB,EAAE4J,GAAKotB,EACZzhC,GAAK,IAGAA,GAAKqU,GACZhR,EAAIrD,EAAIqU,EACRxR,KAAKi+C,OAAO7jB,MACVp6B,KAAKk+C,MAAQ7zC,EAAElN,IAAM,EAAI6C,KAAKk+C,QAAU/vB,EAAK3tB,EAAI44B,GACjDp5B,KAAKk+C,MAAQt2C,EAAEzK,IAAM,EAAI6C,KAAKk+C,QAAUtf,EAAKp+B,EAAI64B,IAKvDr5B,KAAKy+C,GAAKz+C,KAAK0+C,GAAK,KACpB1+C,KAAKi+C,OAAO5V,SACd,EACAjO,MAAO,SAAS/vB,EAAGzC,GACjB5H,KAAKy+C,GAAGhiD,MAAM4N,GACdrK,KAAK0+C,GAAGjiD,MAAMmL,EAChB,IAGa,SAAU+2C,OAAOX,GAE9B,SAASY,OAAOjqC,GACd,OAAgB,IAATqpC,EAAa,IAAIJ,MAAMjpC,GAAW,IAAIopC,OAAOppC,EAASqpC,EAC/D,CAMA,OAJAY,OAAOZ,KAAO,SAASA,GACrB,OAAOW,QAAQX,EACjB,EAEOY,MACR,EAXD,CAWG,KCvDI,SAAS,eAAM1uB,EAAM7lB,EAAGzC,GAC7BsoB,EAAKqe,SAASmM,cACZxqB,EAAKqqB,IAAMrqB,EAAKzuB,IAAMyuB,EAAKiuB,IAAMjuB,EAAKmqB,KACtCnqB,EAAKsqB,IAAMtqB,EAAKzuB,IAAMyuB,EAAKouB,IAAMpuB,EAAKoqB,KACtCpqB,EAAKiuB,IAAMjuB,EAAKzuB,IAAMyuB,EAAKqqB,IAAMlwC,GACjC6lB,EAAKouB,IAAMpuB,EAAKzuB,IAAMyuB,EAAKsqB,IAAM5yC,GACjCsoB,EAAKiuB,IACLjuB,EAAKouB,IAET,CAEO,SAASO,SAASlqC,EAASmqC,GAChC9+C,KAAKuuC,SAAW55B,EAChB3U,KAAKyB,IAAM,EAAIq9C,GAAW,CAC5B,CAEAD,SAASn4C,UAAY,CACnB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAC3Bn+C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAM9xC,IACjCxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EAAG3uC,KAAKuuC,SAASO,OAAO9uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAM,MAClD,KAAK,EAAG,eAAMt+C,KAAMA,KAAKu6C,IAAKv6C,KAAKw6C,MAEjCx6C,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKu6C,IAAMlwC,EAAGrK,KAAKw6C,IAAM5yC,EAAG,MACrD,KAAK,EAAG5H,KAAK2uC,OAAS,EACtB,QAAS,eAAM3uC,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,IAGa,SAAU+2C,OAAOG,GAE9B,SAASC,SAASpqC,GAChB,OAAO,IAAIkqC,SAASlqC,EAASmqC,EAC/B,CAMA,OAJAC,SAASD,QAAU,SAASA,GAC1B,OAAOH,QAAQG,EACjB,EAEOC,QACR,EAXD,CAWG,GCzDI,SAASC,eAAerqC,EAASmqC,GACtC9+C,KAAKuuC,SAAW55B,EAChB3U,KAAKyB,IAAM,EAAIq9C,GAAW,CAC5B,CAEAE,eAAet4C,UAAY,CACzB22C,UAAW,SACXC,QAAS,SACTlV,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAMn+C,KAAKo+C,IAAMp+C,KAAKq+C,IAAMr+C,KAAKi/C,IAC5Dj/C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAMt+C,KAAKu+C,IAAMv+C,KAAKw+C,IAAMx+C,KAAKk/C,IAAM1yC,IAClExM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EACH3uC,KAAKuuC,SAASM,OAAO7uC,KAAKo+C,IAAKp+C,KAAKu+C,KACpCv+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKuuC,SAASO,OAAO9uC,KAAKo+C,IAAKp+C,KAAKu+C,KACpCv+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKo6B,MAAMp6B,KAAKo+C,IAAKp+C,KAAKu+C,KAC1Bv+C,KAAKo6B,MAAMp6B,KAAKq+C,IAAKr+C,KAAKw+C,KAC1Bx+C,KAAKo6B,MAAMp6B,KAAKi/C,IAAKj/C,KAAKk/C,KAIhC,EACA9kB,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAKo+C,IAAM/zC,EAAGrK,KAAKu+C,IAAM32C,EAAG,MACrD,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKuuC,SAASM,OAAO7uC,KAAKq+C,IAAMh0C,EAAGrK,KAAKw+C,IAAM52C,GAAI,MAC3E,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKi/C,IAAM50C,EAAGrK,KAAKk/C,IAAMt3C,EAAG,MACrD,QAAS,eAAM5H,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,IAGa,SAAU+2C,OAAOG,GAE9B,SAASC,SAASpqC,GAChB,OAAO,IAAIqqC,eAAerqC,EAASmqC,EACrC,CAMA,OAJAC,SAASD,QAAU,SAASA,GAC1B,OAAOH,QAAQG,EACjB,EAEOC,QACR,EAXD,CAWG,GC1DI,SAASI,aAAaxqC,EAASmqC,GACpC9+C,KAAKuuC,SAAW55B,EAChB3U,KAAKyB,IAAM,EAAIq9C,GAAW,CAC5B,CAEAK,aAAaz4C,UAAY,CACvB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAC3Bn+C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAM9xC,IACjCxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,YACHroC,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAO9uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAOt+C,KAAKuuC,SAASM,OAAO7uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAM,MAC3H,KAAK,EAAGt+C,KAAK2uC,OAAS,EACtB,QAAS,eAAM3uC,KAAMqK,EAAGzC,GAE1B5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,IAGa,SAAU+2C,OAAOG,GAE9B,SAASC,SAASpqC,GAChB,OAAO,IAAIwqC,aAAaxqC,EAASmqC,EACnC,CAMA,OAJAC,SAASD,QAAU,SAASA,GAC1B,OAAOH,QAAQG,EACjB,EAEOC,QACR,EAXD,CAWG,GC7CI,SAAS,iBAAM7uB,EAAM7lB,EAAGzC,GAC7B,IAAIwmB,EAAK8B,EAAKqqB,IACVxP,EAAK7a,EAAKsqB,IACV3F,EAAK3kB,EAAKiuB,IACVrJ,EAAK5kB,EAAKouB,IAEd,GAAIpuB,EAAKkvB,OAAS,GAAS,CACzB,IAAI1+C,EAAI,EAAIwvB,EAAKmvB,QAAU,EAAInvB,EAAKkvB,OAASlvB,EAAKovB,OAASpvB,EAAKqvB,QAC5Dj/C,EAAI,EAAI4vB,EAAKkvB,QAAUlvB,EAAKkvB,OAASlvB,EAAKovB,QAC9ClxB,GAAMA,EAAK1tB,EAAIwvB,EAAKmqB,IAAMnqB,EAAKqvB,QAAUrvB,EAAKiuB,IAAMjuB,EAAKmvB,SAAW/+C,EACpEyqC,GAAMA,EAAKrqC,EAAIwvB,EAAKoqB,IAAMpqB,EAAKqvB,QAAUrvB,EAAKouB,IAAMpuB,EAAKmvB,SAAW/+C,CACtE,CAEA,GAAI4vB,EAAKsvB,OAAS,GAAS,CACzB,IAAIz2C,EAAI,EAAImnB,EAAKuvB,QAAU,EAAIvvB,EAAKsvB,OAAStvB,EAAKovB,OAASpvB,EAAKqvB,QAC5Dr7C,EAAI,EAAIgsB,EAAKsvB,QAAUtvB,EAAKsvB,OAAStvB,EAAKovB,QAC9CzK,GAAMA,EAAK9rC,EAAImnB,EAAKqqB,IAAMrqB,EAAKuvB,QAAUp1C,EAAI6lB,EAAKqvB,SAAWr7C,EAC7D4wC,GAAMA,EAAK/rC,EAAImnB,EAAKsqB,IAAMtqB,EAAKuvB,QAAU73C,EAAIsoB,EAAKqvB,SAAWr7C,CAC/D,CAEAgsB,EAAKqe,SAASmM,cAActsB,EAAI2c,EAAI8J,EAAIC,EAAI5kB,EAAKiuB,IAAKjuB,EAAKouB,IAC7D,CAEA,SAASoB,WAAW/qC,EAASihC,GAC3B51C,KAAKuuC,SAAW55B,EAChB3U,KAAK2/C,OAAS/J,CAChB,CAEA8J,WAAWh5C,UAAY,CACrB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAC3Bn+C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAM9xC,IACjCxM,KAAKo/C,OAASp/C,KAAKs/C,OAASt/C,KAAKw/C,OACjCx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAAUv/C,KAAKy/C,QACnCz/C,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EAAG3uC,KAAKuuC,SAASO,OAAO9uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAM,MAClD,KAAK,EAAGt+C,KAAKo6B,MAAMp6B,KAAKm+C,IAAKn+C,KAAKs+C,MAEhCt+C,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAGjB,GAFAyC,GAAKA,EAAGzC,GAAKA,EAET5H,KAAK2uC,OAAQ,CACf,IAAIiR,EAAM5/C,KAAKm+C,IAAM9zC,EACjBw1C,EAAM7/C,KAAKs+C,IAAM12C,EACrB5H,KAAKw/C,OAASxqC,KAAK0D,KAAK1Y,KAAKy/C,QAAUzqC,KAAKmE,IAAIymC,EAAMA,EAAMC,EAAMA,EAAK7/C,KAAK2/C,QAC9E,CAEA,OAAQ3/C,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EACtB,QAAS,iBAAM3uC,KAAMqK,EAAGzC,GAG1B5H,KAAKo/C,OAASp/C,KAAKs/C,OAAQt/C,KAAKs/C,OAASt/C,KAAKw/C,OAC9Cx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAASv/C,KAAKu/C,QAAUv/C,KAAKy/C,QACjDz/C,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,GAGF,SAAe,SAAU+2C,OAAO/I,GAE9B,SAASkK,WAAWnrC,GAClB,OAAOihC,EAAQ,IAAI8J,WAAW/qC,EAASihC,GAAS,IAAIiJ,SAASlqC,EAAS,EACxE,CAMA,OAJAmrC,WAAWlK,MAAQ,SAASA,GAC1B,OAAO+I,QAAQ/I,EACjB,EAEOkK,UACR,CAXD,CAWG,ICnFH,SAASC,iBAAiBprC,EAASihC,GACjC51C,KAAKuuC,SAAW55B,EAChB3U,KAAK2/C,OAAS/J,CAChB,CAEAmK,iBAAiBr5C,UAAY,CAC3B22C,UAAW,SACXC,QAAS,SACTlV,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAMn+C,KAAKo+C,IAAMp+C,KAAKq+C,IAAMr+C,KAAKi/C,IAC5Dj/C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAMt+C,KAAKu+C,IAAMv+C,KAAKw+C,IAAMx+C,KAAKk/C,IAAM1yC,IAClExM,KAAKo/C,OAASp/C,KAAKs/C,OAASt/C,KAAKw/C,OACjCx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAAUv/C,KAAKy/C,QACnCz/C,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EACH3uC,KAAKuuC,SAASM,OAAO7uC,KAAKo+C,IAAKp+C,KAAKu+C,KACpCv+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKuuC,SAASO,OAAO9uC,KAAKo+C,IAAKp+C,KAAKu+C,KACpCv+C,KAAKuuC,SAASK,YACd,MAEF,KAAK,EACH5uC,KAAKo6B,MAAMp6B,KAAKo+C,IAAKp+C,KAAKu+C,KAC1Bv+C,KAAKo6B,MAAMp6B,KAAKq+C,IAAKr+C,KAAKw+C,KAC1Bx+C,KAAKo6B,MAAMp6B,KAAKi/C,IAAKj/C,KAAKk/C,KAIhC,EACA9kB,MAAO,SAAS/vB,EAAGzC,GAGjB,GAFAyC,GAAKA,EAAGzC,GAAKA,EAET5H,KAAK2uC,OAAQ,CACf,IAAIiR,EAAM5/C,KAAKm+C,IAAM9zC,EACjBw1C,EAAM7/C,KAAKs+C,IAAM12C,EACrB5H,KAAKw/C,OAASxqC,KAAK0D,KAAK1Y,KAAKy/C,QAAUzqC,KAAKmE,IAAIymC,EAAMA,EAAMC,EAAMA,EAAK7/C,KAAK2/C,QAC9E,CAEA,OAAQ3/C,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAKo+C,IAAM/zC,EAAGrK,KAAKu+C,IAAM32C,EAAG,MACrD,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKuuC,SAASM,OAAO7uC,KAAKq+C,IAAMh0C,EAAGrK,KAAKw+C,IAAM52C,GAAI,MAC3E,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG3uC,KAAKi/C,IAAM50C,EAAGrK,KAAKk/C,IAAMt3C,EAAG,MACrD,QAAS,iBAAM5H,KAAMqK,EAAGzC,GAG1B5H,KAAKo/C,OAASp/C,KAAKs/C,OAAQt/C,KAAKs/C,OAASt/C,KAAKw/C,OAC9Cx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAASv/C,KAAKu/C,QAAUv/C,KAAKy/C,QACjDz/C,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,IAGa,SAAU+2C,OAAO/I,GAE9B,SAASkK,WAAWnrC,GAClB,OAAOihC,EAAQ,IAAImK,iBAAiBprC,EAASihC,GAAS,IAAIoJ,eAAerqC,EAAS,EACpF,CAMA,OAJAmrC,WAAWlK,MAAQ,SAASA,GAC1B,OAAO+I,QAAQ/I,EACjB,EAEOkK,UACR,EAXD,CAWG,ICtEH,SAASE,eAAerrC,EAASihC,GAC/B51C,KAAKuuC,SAAW55B,EAChB3U,KAAK2/C,OAAS/J,CAChB,CAEAoK,eAAet5C,UAAY,CACzB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAAMv6C,KAAKm+C,IAC3Bn+C,KAAKs6C,IAAMt6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAM9xC,IACjCxM,KAAKo/C,OAASp/C,KAAKs/C,OAASt/C,KAAKw/C,OACjCx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAAUv/C,KAAKy/C,QACnCz/C,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,YACHroC,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GAGjB,GAFAyC,GAAKA,EAAGzC,GAAKA,EAET5H,KAAK2uC,OAAQ,CACf,IAAIiR,EAAM5/C,KAAKm+C,IAAM9zC,EACjBw1C,EAAM7/C,KAAKs+C,IAAM12C,EACrB5H,KAAKw/C,OAASxqC,KAAK0D,KAAK1Y,KAAKy/C,QAAUzqC,KAAKmE,IAAIymC,EAAMA,EAAMC,EAAMA,EAAK7/C,KAAK2/C,QAC9E,CAEA,OAAQ3/C,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAO9uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAOt+C,KAAKuuC,SAASM,OAAO7uC,KAAKm+C,IAAKn+C,KAAKs+C,KAAM,MAC3H,KAAK,EAAGt+C,KAAK2uC,OAAS,EACtB,QAAS,iBAAM3uC,KAAMqK,EAAGzC,GAG1B5H,KAAKo/C,OAASp/C,KAAKs/C,OAAQt/C,KAAKs/C,OAASt/C,KAAKw/C,OAC9Cx/C,KAAKq/C,QAAUr/C,KAAKu/C,QAASv/C,KAAKu/C,QAAUv/C,KAAKy/C,QACjDz/C,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMv6C,KAAKm+C,IAAKn+C,KAAKm+C,IAAM9zC,EACrDrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAMx6C,KAAKs+C,IAAKt+C,KAAKs+C,IAAM12C,CACvD,IAGa,SAAU+2C,OAAO/I,GAE9B,SAASkK,WAAWnrC,GAClB,OAAOihC,EAAQ,IAAIoK,eAAerrC,EAASihC,GAAS,IAAIuJ,aAAaxqC,EAAS,EAChF,CAMA,OAJAmrC,WAAWlK,MAAQ,SAASA,GAC1B,OAAO+I,QAAQ/I,EACjB,EAEOkK,UACR,EAXD,CAWG,IC3DH,SAASG,aAAatrC,GACpB3U,KAAKuuC,SAAW55B,CAClB,CCJA,SAAS,cAAKtK,GACZ,OAAOA,EAAI,GAAK,EAAI,CACtB,CAMA,SAAS61C,OAAOhwB,EAAM2kB,EAAIC,GACxB,IAAIqL,EAAKjwB,EAAKqqB,IAAMrqB,EAAKmqB,IACrB+F,EAAKvL,EAAK3kB,EAAKqqB,IACf8F,GAAMnwB,EAAKsqB,IAAMtqB,EAAKoqB,MAAQ6F,GAAMC,EAAK,IAAM,GAC/CE,GAAMxL,EAAK5kB,EAAKsqB,MAAQ4F,GAAMD,EAAK,IAAM,GACzCn7C,GAAKq7C,EAAKD,EAAKE,EAAKH,IAAOA,EAAKC,GACpC,OAAQ,cAAKC,GAAM,cAAKC,IAAOtrC,KAAKC,IAAID,KAAK+V,IAAIs1B,GAAKrrC,KAAK+V,IAAIu1B,GAAK,GAAMtrC,KAAK+V,IAAI/lB,KAAO,CAC5F,CAGA,SAASu7C,OAAOrwB,EAAM1vB,GACpB,IAAI0kB,EAAIgL,EAAKqqB,IAAMrqB,EAAKmqB,IACxB,OAAOn1B,GAAK,GAAKgL,EAAKsqB,IAAMtqB,EAAKoqB,KAAOp1B,EAAI1kB,GAAK,EAAIA,CACvD,CAKA,SAAS,eAAM0vB,EAAMvB,EAAIhJ,GACvB,IAAIwI,EAAK+B,EAAKmqB,IACVzb,EAAK1O,EAAKoqB,IACVlsB,EAAK8B,EAAKqqB,IACVxP,EAAK7a,EAAKsqB,IACVphB,GAAMhL,EAAKD,GAAM,EACrB+B,EAAKqe,SAASmM,cAAcvsB,EAAKiL,EAAIwF,EAAKxF,EAAKzK,EAAIP,EAAKgL,EAAI2R,EAAK3R,EAAKzT,EAAIyI,EAAI2c,EAChF,CAEA,SAASyV,UAAU7rC,GACjB3U,KAAKuuC,SAAW55B,CAClB,CAyCA,SAAS8rC,UAAU9rC,GACjB3U,KAAKuuC,SAAW,IAAImS,eAAe/rC,EACrC,CAMA,SAAS+rC,eAAe/rC,GACtB3U,KAAKuuC,SAAW55B,CAClB,CCxFA,SAASgsC,QAAQhsC,GACf3U,KAAKuuC,SAAW55B,CAClB,CA0CA,SAASisC,cAAcv2C,GACrB,IAAIlN,EAEA+G,EADA5D,EAAI+J,EAAEjN,OAAS,EAEfsD,EAAI,IAAI4I,MAAMhJ,GACdyI,EAAI,IAAIO,MAAMhJ,GACdC,EAAI,IAAI+I,MAAMhJ,GAElB,IADAI,EAAE,GAAK,EAAGqI,EAAE,GAAK,EAAGxI,EAAE,GAAK8J,EAAE,GAAK,EAAIA,EAAE,GACnClN,EAAI,EAAGA,EAAImD,EAAI,IAAKnD,EAAGuD,EAAEvD,GAAK,EAAG4L,EAAE5L,GAAK,EAAGoD,EAAEpD,GAAK,EAAIkN,EAAElN,GAAK,EAAIkN,EAAElN,EAAI,GAE5E,IADAuD,EAAEJ,EAAI,GAAK,EAAGyI,EAAEzI,EAAI,GAAK,EAAGC,EAAED,EAAI,GAAK,EAAI+J,EAAE/J,EAAI,GAAK+J,EAAE/J,GACnDnD,EAAI,EAAGA,EAAImD,IAAKnD,EAAG+G,EAAIxD,EAAEvD,GAAK4L,EAAE5L,EAAI,GAAI4L,EAAE5L,IAAM+G,EAAG3D,EAAEpD,IAAM+G,EAAI3D,EAAEpD,EAAI,GAE1E,IADAuD,EAAEJ,EAAI,GAAKC,EAAED,EAAI,GAAKyI,EAAEzI,EAAI,GACvBnD,EAAImD,EAAI,EAAGnD,GAAK,IAAKA,EAAGuD,EAAEvD,IAAMoD,EAAEpD,GAAKuD,EAAEvD,EAAI,IAAM4L,EAAE5L,GAE1D,IADA4L,EAAEzI,EAAI,IAAM+J,EAAE/J,GAAKI,EAAEJ,EAAI,IAAM,EAC1BnD,EAAI,EAAGA,EAAImD,EAAI,IAAKnD,EAAG4L,EAAE5L,GAAK,EAAIkN,EAAElN,EAAI,GAAKuD,EAAEvD,EAAI,GACxD,MAAO,CAACuD,EAAGqI,EACb,CC5DA,SAAS83C,KAAKlsC,EAASnU,GACrBR,KAAKuuC,SAAW55B,EAChB3U,KAAK+E,GAAKvE,CACZ,CHGAy/C,aAAav5C,UAAY,CACvB22C,UAAW,SACXC,QAAS,SACTlV,UAAW,WACTpoC,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACHroC,KAAK2uC,QAAQ3uC,KAAKuuC,SAASK,WACjC,EACAxU,MAAO,SAAS/vB,EAAGzC,GACjByC,GAAKA,EAAGzC,GAAKA,EACT5H,KAAK2uC,OAAQ3uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,IACpC5H,KAAK2uC,OAAS,EAAG3uC,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAChD,GCoBF44C,UAAU95C,UAAY,CACpB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKq6C,IAAMr6C,KAAKu6C,IAChBv6C,KAAKs6C,IAAMt6C,KAAKw6C,IAChBx6C,KAAK8gD,IAAMt0C,IACXxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACP,OAAQroC,KAAK2uC,QACX,KAAK,EAAG3uC,KAAKuuC,SAASO,OAAO9uC,KAAKu6C,IAAKv6C,KAAKw6C,KAAM,MAClD,KAAK,EAAG,eAAMx6C,KAAMA,KAAK8gD,IAAKP,OAAOvgD,KAAMA,KAAK8gD,OAE9C9gD,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACzE5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,KACxB,EACAtU,MAAO,SAAS/vB,EAAGzC,GACjB,IAAI+d,EAAKnZ,IAGT,GADQ5E,GAAKA,GAAbyC,GAAKA,KACKrK,KAAKu6C,KAAO3yC,IAAM5H,KAAKw6C,IAAjC,CACA,OAAQx6C,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EAAG,MACzB,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG,eAAM3uC,KAAMugD,OAAOvgD,KAAM2lB,EAAKu6B,OAAOlgD,KAAMqK,EAAGzC,IAAK+d,GAAK,MACjF,QAAS,eAAM3lB,KAAMA,KAAK8gD,IAAKn7B,EAAKu6B,OAAOlgD,KAAMqK,EAAGzC,IAGtD5H,KAAKq6C,IAAMr6C,KAAKu6C,IAAKv6C,KAAKu6C,IAAMlwC,EAChCrK,KAAKs6C,IAAMt6C,KAAKw6C,IAAKx6C,KAAKw6C,IAAM5yC,EAChC5H,KAAK8gD,IAAMn7B,CAViC,CAW9C,IAOD86B,UAAU/5C,UAAYtE,OAAOuF,OAAO64C,UAAU95C,YAAY0zB,MAAQ,SAAS/vB,EAAGzC,GAC7E44C,UAAU95C,UAAU0zB,MAAM52B,KAAKxD,KAAM4H,EAAGyC,EAC1C,EAMAq2C,eAAeh6C,UAAY,CACzBmoC,OAAQ,SAASxkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOjnC,EAAGyC,EAAI,EACrDukC,UAAW,WAAa5uC,KAAKuuC,SAASK,WAAa,EACnDE,OAAQ,SAASzkC,EAAGzC,GAAK5H,KAAKuuC,SAASO,OAAOlnC,EAAGyC,EAAI,EACrDqwC,cAAe,SAAStsB,EAAI2c,EAAI8J,EAAIC,EAAIzqC,EAAGzC,GAAK5H,KAAKuuC,SAASmM,cAAc3P,EAAI3c,EAAI0mB,EAAID,EAAIjtC,EAAGyC,EAAI,GC1FrGs2C,QAAQj6C,UAAY,CAClB22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKy+C,GAAK,GACVz+C,KAAK0+C,GAAK,EACZ,EACArW,QAAS,WACP,IAAIh+B,EAAIrK,KAAKy+C,GACT72C,EAAI5H,KAAK0+C,GACTp+C,EAAI+J,EAAEjN,OAEV,GAAIkD,EAEF,GADAN,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAE,GAAIzC,EAAE,IAAM5H,KAAKuuC,SAASM,OAAOxkC,EAAE,GAAIzC,EAAE,IACnE,IAANtH,EACFN,KAAKuuC,SAASO,OAAOzkC,EAAE,GAAIzC,EAAE,SAI7B,IAFA,IAAIm5C,EAAKH,cAAcv2C,GACnB22C,EAAKJ,cAAch5C,GACdoM,EAAK,EAAGC,EAAK,EAAGA,EAAK3T,IAAK0T,IAAMC,EACvCjU,KAAKuuC,SAASmM,cAAcqG,EAAG,GAAG/sC,GAAKgtC,EAAG,GAAGhtC,GAAK+sC,EAAG,GAAG/sC,GAAKgtC,EAAG,GAAGhtC,GAAK3J,EAAE4J,GAAKrM,EAAEqM,KAKnFjU,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAAqB,IAANpuC,IAAUN,KAAKuuC,SAASK,YAC/D5uC,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,MACtB1uC,KAAKy+C,GAAKz+C,KAAK0+C,GAAK,IACtB,EACAtkB,MAAO,SAAS/vB,EAAGzC,GACjB5H,KAAKy+C,GAAGhiD,MAAM4N,GACdrK,KAAK0+C,GAAGjiD,MAAMmL,EAChB,GCnCFi5C,KAAKn6C,UAAY,CACf22C,UAAW,WACTr9C,KAAK0uC,MAAQ,CACf,EACA4O,QAAS,WACPt9C,KAAK0uC,MAAQliC,GACf,EACA47B,UAAW,WACTpoC,KAAKy+C,GAAKz+C,KAAK0+C,GAAKlyC,IACpBxM,KAAK2uC,OAAS,CAChB,EACAtG,QAAS,WACH,EAAIroC,KAAK+E,IAAM/E,KAAK+E,GAAK,GAAqB,IAAhB/E,KAAK2uC,QAAc3uC,KAAKuuC,SAASO,OAAO9uC,KAAKy+C,GAAIz+C,KAAK0+C,KACpF1+C,KAAK0uC,OAAyB,IAAf1uC,KAAK0uC,OAA+B,IAAhB1uC,KAAK2uC,SAAe3uC,KAAKuuC,SAASK,YACrE5uC,KAAK0uC,OAAS,IAAG1uC,KAAK+E,GAAK,EAAI/E,KAAK+E,GAAI/E,KAAK0uC,MAAQ,EAAI1uC,KAAK0uC,MACpE,EACAtU,MAAO,SAAS/vB,EAAGzC,GAEjB,OADAyC,GAAKA,EAAGzC,GAAKA,EACL5H,KAAK2uC,QACX,KAAK,EAAG3uC,KAAK2uC,OAAS,EAAG3uC,KAAK0uC,MAAQ1uC,KAAKuuC,SAASO,OAAOzkC,EAAGzC,GAAK5H,KAAKuuC,SAASM,OAAOxkC,EAAGzC,GAAI,MAC/F,KAAK,EAAG5H,KAAK2uC,OAAS,EACtB,QACE,GAAI3uC,KAAK+E,IAAM,EACb/E,KAAKuuC,SAASO,OAAO9uC,KAAKy+C,GAAI72C,GAC9B5H,KAAKuuC,SAASO,OAAOzkC,EAAGzC,OACnB,CACL,IAAIwmB,EAAKpuB,KAAKy+C,IAAM,EAAIz+C,KAAK+E,IAAMsF,EAAIrK,KAAK+E,GAC5C/E,KAAKuuC,SAASO,OAAO1gB,EAAIpuB,KAAK0+C,IAC9B1+C,KAAKuuC,SAASO,OAAO1gB,EAAIxmB,EAC3B,EAIJ5H,KAAKy+C,GAAKp0C,EAAGrK,KAAK0+C,GAAK92C,CACzB,GCvCiB0B,MAAM5C,UAAU8C,MCKnC,IAAI,GAA4B,mBAAXlG,QAAoD,iBAApBA,OAAOC,SAAwB,SAAUxF,GAC5F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAyB,mBAAXuF,QAAyBvF,EAAIsG,cAAgBf,QAAUvF,IAAQuF,OAAOoD,UAAY,gBAAkB3I,CAC3H,EAYIkjD,eAAiB,SAAUC,EAAUC,GACvC,KAAMD,aAAoBC,GACxB,MAAM,IAAIz9C,UAAU,oCAExB,EAEI09C,GAAc,WAChB,SAASlmB,iBAAiBj1B,EAAQo7C,GAChC,IAAK,IAAIlkD,EAAI,EAAGA,EAAIkkD,EAAMjkD,OAAQD,IAAK,CACrC,IAAImkD,EAAaD,EAAMlkD,GACvBmkD,EAAWr+C,WAAaq+C,EAAWr+C,aAAc,EACjDq+C,EAAWp+C,cAAe,EACtB,UAAWo+C,IAAYA,EAAWn+C,UAAW,GACjDf,OAAOU,eAAemD,EAAQq7C,EAAW54C,IAAK44C,EAChD,CACF,CAEA,OAAO,SAAUH,EAAaI,EAAYC,GAGxC,OAFID,GAAYrmB,iBAAiBimB,EAAYz6C,UAAW66C,GACpDC,GAAatmB,iBAAiBimB,EAAaK,GACxCL,CACT,CACF,CAhBkB,GAwBdM,GAAWr/C,OAAO+jB,QAAU,SAAUlgB,GACxC,IAAK,IAAI9I,EAAI,EAAGA,EAAI2Q,UAAU1Q,OAAQD,IAAK,CACzC,IAAI2qB,EAASha,UAAU3Q,GAEvB,IAAK,IAAIuL,KAAOof,EACV1lB,OAAOsE,UAAUoC,eAAetF,KAAKskB,EAAQpf,KAC/CzC,EAAOyC,GAAOof,EAAOpf,GAG3B,CAEA,OAAOzC,CACT,EAEI,GAAM,SAAS0C,IAAIggB,EAAQzS,EAAUwrC,GACxB,OAAX/4B,IAAiBA,EAAS5hB,SAASL,WACvC,IAAIi7C,EAAOv/C,OAAOw/C,yBAAyBj5B,EAAQzS,GAEnD,QAAa3U,IAATogD,EAAoB,CACtB,IAAI12C,EAAS7I,OAAO+B,eAAewkB,GAEnC,OAAe,OAAX1d,OACF,EAEOtC,IAAIsC,EAAQiL,EAAUwrC,EAEjC,CAAO,GAAI,UAAWC,EACpB,OAAOA,EAAK7gD,MAEZ,IAAI0H,EAASm5C,EAAKh5C,IAElB,YAAepH,IAAXiH,EAIGA,EAAOhF,KAAKk+C,QAJnB,CAMJ,EAEIG,SAAW,SAAUC,EAAUC,GACjC,GAA0B,mBAAfA,GAA4C,OAAfA,EACtC,MAAM,IAAIr+C,UAAU,kEAAoEq+C,GAG1FD,EAASp7C,UAAYtE,OAAOuF,OAAOo6C,GAAcA,EAAWr7C,UAAW,CACrErC,YAAa,CACXvD,MAAOghD,EACP7+C,YAAY,EACZE,UAAU,EACVD,cAAc,KAGd6+C,IAAY3/C,OAAO8F,eAAiB9F,OAAO8F,eAAe45C,EAAUC,GAAcD,EAAS19C,UAAY29C,EAC7G,EAYIC,0BAA4B,SAAUzlD,EAAMiH,GAC9C,IAAKjH,EACH,MAAM,IAAI0lD,eAAe,6DAG3B,OAAOz+C,GAAyB,iBAATA,GAAqC,mBAATA,EAA8BjH,EAAPiH,CAC5E,EA8BI0+C,GAAa,WACf,SAASA,WAAWC,GAClB,IAAIC,EAASD,EAAK93C,EACdA,OAAe9I,IAAX6gD,EAAuB,EAAIA,EAC/BC,EAASF,EAAKv6C,EACdA,OAAerG,IAAX8gD,EAAuB,EAAIA,EAC/BC,EAAKH,EAAKG,GACVC,EAAKJ,EAAKI,GACVC,EAAUL,EAAK9oB,GACfA,OAAiB93B,IAAZihD,EAAwB,EAAIA,EACjCC,EAAUN,EAAK/oB,GACfA,OAAiB73B,IAAZkhD,EAAwB,EAAIA,EACjCC,EAAaP,EAAKl7B,MAClBA,OAAuB1lB,IAAfmhD,EAA2B,OAASA,EAC5CzgD,EAAOkgD,EAAKlgD,KACZwP,EAAO0wC,EAAK1wC,KACZ24B,EAAU+X,EAAK/X,QACfuY,EAAYR,EAAKQ,UACjBC,EAAOT,EAAKS,KACZC,EAAUV,EAAKU,QACfnmD,EAAKylD,EAAKzlD,GACV6jC,EAAY4hB,EAAK5hB,UACrB0gB,eAAejhD,KAAMkiD,YAErBliD,KAAK8iD,SAAavhD,IAAP+gD,EAAmBA,EAAKj4C,EAAI+uB,EACvCp5B,KAAK+iD,SAAaxhD,IAAPghD,EAAmBA,EAAK36C,EAAIyxB,EACvCr5B,KAAKy+C,GAAKp0C,EACVrK,KAAK0+C,GAAK92C,EACV5H,KAAKgjD,OAAS/7B,EACdjnB,KAAKtD,GAAKA,EACVsD,KAAKijD,WAAa1iB,GAAa,GAE/BvgC,KAAKkjD,MAAQzxC,GAAQ,GACrBzR,KAAKiC,KAAOA,EAEZjC,KAAK4iD,KAAOA,GAAQ,CAAC,EACrB5iD,KAAK2iD,UAAYA,GAAa,CAAC,EAC/B3iD,KAAKoqC,QAAUA,GAAW,CAAC,EAE3BpqC,KAAK6iD,QAAUA,GAAW,EAC5B,CAgKA,OA9JAzB,GAAYc,WAAY,CAAC,CACvBx5C,IAAK,iBACL5H,MAAO,SAASqiD,iBACVnjD,KAAKyR,KAAK2xC,cACZpjD,KAAKyR,KAAK2xC,cACNpjD,KAAKyR,KAAK24B,SAA2E,IAAhEpqC,KAAKyR,KAAK24B,QAAQh3B,UAAU,iBAAiByC,QAAQzY,QAC5E4C,KAAKyR,KAAK4xC,gBAGhB,GACC,CACD36C,IAAK,kBACL5H,MAAO,SAASwiD,kBACdtjD,KAAKyR,KAAK6xC,iBAAmBtjD,KAAKyR,KAAK6xC,iBACzC,GACC,CACD56C,IAAK,eACL5H,MAAO,SAASyiD,eACVvjD,KAAKyR,KAAK+xC,YACZxjD,KAAKyR,KAAK+xC,YAE4D,IAAlExjD,KAAKyR,KAAKkxC,UAAUvvC,UAAU,iBAAiByC,QAAQzY,QACzD4C,KAAKyR,KAAKgyC,kBAGZzjD,KAAKyR,KAAKiyC,aAEd,GACC,CACDh7C,IAAK,YACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAKijD,UACd,EACA72C,IAAK,SAASw3C,OAAOrjB,GACnBvgC,KAAKijD,WAAa1iB,EACdvgC,KAAKyR,KAAKoyC,cAAc7jD,KAAKyR,KAAKoyC,cACxC,GACC,CACDn7C,IAAK,OACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAKkjD,KACd,EACA92C,IAAK,SAASw3C,OAAOnyC,GACnBzR,KAAKkjD,MAAQzxC,EACbzR,KAAKsjD,iBACP,GACC,CACD56C,IAAK,IACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAKy+C,EACd,EACAryC,IAAK,SAASw3C,OAAOv5C,GACnBrK,KAAKy+C,GAAKp0C,EACVrK,KAAKmjD,gBACP,GACC,CACDz6C,IAAK,IACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAK0+C,EACd,EACAtyC,IAAK,SAASw3C,OAAOh8C,GACnB5H,KAAK0+C,GAAK92C,EACV5H,KAAKmjD,gBACP,GACC,CACDz6C,IAAK,QACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAKgjD,MACd,EACA52C,IAAK,SAASw3C,OAAO38B,GACnBjnB,KAAKgjD,OAAS/7B,EACdjnB,KAAKmjD,gBACP,GACC,CACDz6C,IAAK,KACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAK8iD,GACd,EACA12C,IAAK,SAASw3C,OAAOxqB,GACnBp5B,KAAK8iD,IAAM1pB,EACXp5B,KAAKujD,cACP,GACC,CACD76C,IAAK,KACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAK+iD,GACd,EACA32C,IAAK,SAASw3C,OAAOvqB,GACnBr5B,KAAK+iD,IAAM1pB,EACXr5B,KAAKujD,cACP,GACC,CACD76C,IAAK,KACL0D,IAAK,SAASw3C,OAAOtB,GACnBtiD,KAAK8iD,IAAMR,EAAKtiD,KAAKy+C,GACrBz+C,KAAKujD,cACP,GACC,CACD76C,IAAK,KACL0D,IAAK,SAASw3C,OAAOrB,GACnBviD,KAAK+iD,IAAMR,EAAKviD,KAAK0+C,GACrB1+C,KAAKujD,cACP,GACC,CACD76C,IAAK,SACLC,IAAK,SAASg7C,SACZ,MAAO,CAAEt5C,EAAGrK,KAAK8iD,IAAKl7C,EAAG5H,KAAK+iD,IAChC,EACA32C,IAAK,SAASw3C,OAAOE,GACnB,IAAIz5C,EAAIy5C,EAAMz5C,EACVzC,EAAIk8C,EAAMl8C,EAEd5H,KAAK8iD,IAAMz4C,EACXrK,KAAK+iD,IAAMn7C,EACX5H,KAAKujD,cACP,GACC,CACD76C,IAAK,WACLC,IAAK,SAASg7C,SACZ,MAAO,CAAEt5C,EAAGrK,KAAKy+C,GAAI72C,EAAG5H,KAAK0+C,GAC/B,EACAtyC,IAAK,SAASw3C,OAAOG,GACnB,IAAI15C,EAAI05C,EAAM15C,EACVzC,EAAIm8C,EAAMn8C,EAEd5H,KAAKy+C,GAAKp0C,EACVrK,KAAK0+C,GAAK92C,EACV5H,KAAKmjD,gBACP,GACC,CACDz6C,IAAK,cACLC,IAAK,SAASg7C,SACZ,MAAO,CACLt5C,EAAGrK,KAAKy+C,GAAKz+C,KAAK8iD,IAClBl7C,EAAG5H,KAAK0+C,GAAK1+C,KAAK+iD,IAEtB,GACC,CACDr6C,IAAK,OACLC,IAAK,SAASg7C,SACZ,IAAIK,EAAO,CACT35C,EAAGrK,KAAKy+C,GACR72C,EAAG5H,KAAK0+C,GACRtlB,GAAIp5B,KAAK8iD,IACTzpB,GAAIr5B,KAAK+iD,KAWX,OARI/iD,KAAKiC,MAAQG,OAAOwD,KAAK5F,KAAKiC,MAAM7E,OAAS,IAAG4mD,EAAK/hD,KAAOjC,KAAKiC,MACjEjC,KAAKyR,OAAMuyC,EAAKvyC,KAAOzR,KAAKyR,MAC5BzR,KAAKijD,aAAYe,EAAKzjB,UAAYvgC,KAAKijD,YAEvC7gD,OAAOwD,KAAK5F,KAAK2iD,WAAWvlD,OAAS,IAAG4mD,EAAKrB,UAAY3iD,KAAK2iD,WAC9DvgD,OAAOwD,KAAK5F,KAAKoqC,SAAShtC,OAAS,IAAG4mD,EAAK5Z,QAAUpqC,KAAKoqC,SAC1DhoC,OAAOwD,KAAK5F,KAAK4iD,MAAMxlD,OAAS,IAAG4mD,EAAKpB,KAAO5iD,KAAK4iD,MAEjDoB,CACT,KAEK9B,UACT,CAzMiB,GA2Mb+B,GAAuB,WACzB,SAASA,qBAAqB9B,GAC5B,IAAI+B,EAAc/B,EAAK+B,YACnBC,EAAYhC,EAAKgC,UACjBC,EAAmBjC,EAAKiC,iBAC5BnD,eAAejhD,KAAMikD,sBAErBjkD,KAAKmkD,UAAYA,EACjBnkD,KAAKokD,iBAAmBA,EACxBpkD,KAAKkkD,YAAcA,CACrB,CAiHA,OA/GA9C,GAAY6C,qBAAsB,CAAC,CACjCv7C,IAAK,aACL5H,MAAO,SAASujD,WAAWC,GACzBtkD,KAAKkkD,YAAYxhB,QAAQ,SAAU3iC,GACjCA,EAAE0R,UAAOlQ,EACTxB,EAAEqqC,QAAUka,GAAeA,EAAYla,SAAWrqC,EAAEqqC,QACpDrqC,EAAE4iD,UAAY2B,GAAeA,EAAY3B,WAAa5iD,EAAE4iD,UACxD5iD,EAAE6iD,KAAO0B,GAAeA,EAAY1B,MAAQ7iD,EAAE6iD,IAChD,EACF,GACC,CACDl6C,IAAK,2BACL5H,MAAO,SAASyjD,2BACd,IAAIC,EAAQxkD,KAEZA,KAAKkkD,YAAYxhB,QAAQ,SAAU3iC,GACjCA,EAAE0R,KAAK8yC,yBAAyBC,EAAML,UACxC,EACF,GACC,CACDz7C,IAAK,WACL5H,MAAO,SAAS2jD,SAASC,GACvB1kD,KAAKkkD,YAAYxhB,QAAQ,SAAUhiC,GAC7BA,EAAE+Q,OACJ/Q,EAAE+Q,KAAKgzC,SAAWC,EAClBhkD,EAAE+Q,KAAKkzC,iBAEX,EACF,GACC,CACDj8C,IAAK,gBACL5H,MAAO,SAAS8jD,cAAc/B,GAC5B7iD,KAAKkkD,YAAYxhB,QAAQ,SAAUhiC,GACjCA,EAAEmiD,QAAUA,EACRniD,EAAE+Q,MACJoxC,EAAQngB,QAAQ,SAAU3iC,GACpBW,EAAE+Q,KAAK1R,KACTW,EAAE+Q,KAAK1R,GAAGjB,QAAU4B,EAAE+Q,KAAK1R,GAAGjB,SAC9B4B,EAAE+Q,KAAK1R,QAAKwB,EAEhB,EAEJ,EACF,GACC,CACDmH,IAAK,iBACL5H,MAAO,SAAS+jD,eAAeC,GAC7B9kD,KAAKkkD,YAAYxhB,QAAQ,SAAUhiC,GAC7BA,EAAE+Q,MAAQ/Q,EAAE+Q,KAAKozC,gBACnBnkD,EAAE+Q,KAAKozC,eAAeC,EAE1B,EACF,GACC,CACDp8C,IAAK,aACL5H,MAAO,SAASikD,aACd/kD,KAAKkkD,YAAYxhB,QAAQ,SAAUhiC,GAC7BA,EAAE+Q,MAAQ/Q,EAAE+Q,KAAKuzC,UACnBtkD,EAAE+Q,KAAKuzC,UAEX,EACF,GACC,CACDt8C,IAAK,oBACL5H,MAAO,SAASmkD,kBAAkBC,GAChCllD,KAAKkkD,YAAYxhB,QAAQ,SAAUhiC,GAC7BA,EAAE+Q,OACJ/Q,EAAE+Q,KAAKyzC,YAAcA,EAEzB,EACF,GACC,CACDx8C,IAAK,OACLC,IAAK,SAASg7C,SACZ,IAAIwB,EAASnlD,KAEb,OAAOA,KAAKkkD,YAAYjjD,IAAI,SAAUP,GACpC,IAAIsjD,EAAOtjD,EAAEsjD,KASb,OARImB,EAAOf,kBAAoB1jD,EAAEuB,OAC/B+hD,EAAK/hD,KAAO,CAAC,EACbG,OAAOwD,KAAKu/C,EAAOf,kBAAkB1hB,QAAQ,SAAUxiC,GACrD8jD,EAAK/hD,KAAK/B,GAAKilD,EAAOf,iBAAiBlkD,GAAG,CAAEmK,EAAG3J,EAAE2J,EAAGzC,EAAGlH,EAAEkH,GAG3D,IAEKo8C,CACT,EACF,GACC,CACDt7C,IAAK,YACLC,IAAK,SAASg7C,SACZ,OAAO3jD,KAAKkkD,YAAYjjD,IAAI,SAAUP,GACpC,OAAO+gD,GAAS,CAAC,EAAG/gD,EAAE+Q,KAAK2zC,oBAAqB,CAAEC,UAAW3kD,EAAE2J,EAAGi7C,UAAW5kD,EAAEkH,GACjF,EACF,KAgBKq8C,oBACT,CA5H2B,GAqMvBsB,GAAmB,SAASA,iBAAiBj7B,EAAO1iB,GAQtD,MAPc,YAAV0iB,GAAiC,SAAVA,GAA8B,UAAVA,IAE3CA,EADE1iB,EAAI,EACE,MAEA,UAGL0iB,CACT,EAEIk7B,GAAmB,SAASA,iBAAiBl7B,EAAOjgB,GAQtD,MAPc,YAAVigB,GAAiC,QAAVA,GAA6B,WAAVA,IAE1CA,EADEjgB,EAAI,EACE,QAEA,QAGLigB,CACT,EAEIm7B,GAAuB,CAAC,YAAa,MAAO,UAC5CC,GAAuB,CAAC,YAAa,OAAQ,SA6C7CC,GAAc,SAASA,YAAYxD,GACrC,IAAIlgD,EAAOkgD,EAAKlgD,KACZ2jD,EAAazD,EAAK5E,MAClBA,OAAuBh8C,IAAfqkD,EAA2B,aAAcA,EACjDC,EAAgB1D,EAAK0D,cACrBtlB,EAAY4hB,EAAK5hB,UACjBulB,EAAU3D,EAAK2D,QAEfC,EC/mBS,oBACb,IAAI17C,EAAI,QACJzC,EAAI,QACJo+C,EAAU,uBAAS,GACnBrxC,EAAU,KACV4oC,EAAQ,aACR7zB,EAAS,KAEb,SAAS+f,KAAKxnC,GACZ,IAAI9E,EAEA4C,EAEAkmD,EAHA3lD,EAAI2B,EAAK7E,OAET8oD,GAAW,EAKf,IAFe,MAAXvxC,IAAiB+U,EAAS6zB,EAAM0I,EAAS,OAExC9oD,EAAI,EAAGA,GAAKmD,IAAKnD,IACdA,EAAImD,GAAK0lD,EAAQjmD,EAAIkC,EAAK9E,GAAIA,EAAG8E,MAAWikD,KAC5CA,GAAYA,GAAUx8B,EAAO0e,YAC5B1e,EAAO2e,WAEV6d,GAAUx8B,EAAO0Q,OAAO/vB,EAAEtK,EAAG5C,EAAG8E,IAAQ2F,EAAE7H,EAAG5C,EAAG8E,IAGtD,GAAIgkD,EAAQ,OAAOv8B,EAAS,KAAMu8B,EAAS,IAAM,IACnD,CAsBA,OApBAxc,KAAKp/B,EAAI,SAASiO,GAChB,OAAOxK,UAAU1Q,QAAUiN,EAAiB,mBAANiO,EAAmBA,EAAI,uBAAUA,GAAImxB,MAAQp/B,CACrF,EAEAo/B,KAAK7hC,EAAI,SAAS0Q,GAChB,OAAOxK,UAAU1Q,QAAUwK,EAAiB,mBAAN0Q,EAAmBA,EAAI,uBAAUA,GAAImxB,MAAQ7hC,CACrF,EAEA6hC,KAAKuc,QAAU,SAAS1tC,GACtB,OAAOxK,UAAU1Q,QAAU4oD,EAAuB,mBAAN1tC,EAAmBA,EAAI,wBAAWA,GAAImxB,MAAQuc,CAC5F,EAEAvc,KAAK8T,MAAQ,SAASjlC,GACpB,OAAOxK,UAAU1Q,QAAUmgD,EAAQjlC,EAAc,MAAX3D,IAAoB+U,EAAS6zB,EAAM5oC,IAAW80B,MAAQ8T,CAC9F,EAEA9T,KAAK90B,QAAU,SAAS2D,GACtB,OAAOxK,UAAU1Q,QAAe,MAALkb,EAAY3D,EAAU+U,EAAS,KAAOA,EAAS6zB,EAAM5oC,EAAU2D,GAAImxB,MAAQ90B,CACxG,EAEO80B,IACT,CD8jBgB,GAAO8T,MAAMA,GAEvB4I,EAAU,CACZ10C,KAAM,OACN8uB,UAAWA,EACXulB,QAASA,EACT7jD,KAAMA,GAYR,OATI4jD,GACFE,EAAQpxC,QAAQkxC,GAChBM,EAAQC,YAAcL,GAEtBI,EAAQE,MAAQ,CACdtmD,EAAGgmD,EAAQ9jD,IAIRkkD,CACT,EAEIG,GAAa,SAASA,WAAWxC,GACnC,IAAI7hD,EAAO6hD,EAAM7hD,KACb4jD,EAAgB/B,EAAM+B,cAKtBM,EAAU,CACZ10C,KAAM,OACN8uB,UANcujB,EAAMvjB,UAOpBulB,QANYhC,EAAMgC,QAOlB7jD,KAAMA,GAGJskD,ExBzkBS,eACb,IAAIzK,EAAcD,eACdG,EAAcD,eACdyK,EAAe,sBAAS,GACxBC,EAAY,KACZvK,EAAaD,cACbG,EAAWD,YACXG,EAAWD,YACX1nC,EAAU,KAEd,SAASo6B,MACP,IAAIkX,EACA1lD,EACA4oB,GAAM2yB,EAAY30C,MAAMnH,KAAM8N,WAC9Bsb,GAAM4yB,EAAY70C,MAAMnH,KAAM8N,WAC9By+B,EAAK2P,EAAW/0C,MAAMnH,KAAM8N,WAAa,GACzCq9B,EAAKiR,EAASj1C,MAAMnH,KAAM8N,WAAa,GACvC6tC,EAAK3mC,KAAK+V,IAAIogB,EAAKoB,GACnBmP,EAAKvQ,EAAKoB,EAQd,GANK53B,IAASA,EAAUsxC,EAAS,MAG7B78B,EAAKD,IAAI5oB,EAAI6oB,EAAIA,EAAKD,EAAIA,EAAK5oB,GAG7B6oB,EAAK,GAGN,GAAIuyB,EAAK,GAAM,GAClBhnC,EAAQk6B,OAAOzlB,EAAKpU,KAAKwa,IAAI+c,GAAKnjB,EAAKpU,KAAKya,IAAI8c,IAChD53B,EAAQo6B,IAAI,EAAG,EAAG3lB,EAAImjB,EAAIpB,GAAKuQ,GAC3BvyB,EAAK,KACPxU,EAAQk6B,OAAO1lB,EAAKnU,KAAKwa,IAAI2b,GAAKhiB,EAAKnU,KAAKya,IAAI0b,IAChDx2B,EAAQo6B,IAAI,EAAG,EAAG5lB,EAAIgiB,EAAIoB,EAAImP,QAK7B,CACH,IAWI/sB,EACAhJ,EAZA+gC,EAAMna,EACNoa,EAAMxb,EACN+J,EAAM3I,EACNqa,EAAMzb,EACN0b,EAAMlL,EACNmL,EAAMnL,EACNoL,EAAKzK,EAASn1C,MAAMnH,KAAM8N,WAAa,EACvCk5C,EAAMD,EAAK,KAAaN,GAAaA,EAAUt/C,MAAMnH,KAAM8N,WAAakH,KAAK0D,KAAKyQ,EAAKA,EAAKC,EAAKA,IACjGozB,EAAKxnC,KAAKC,IAAID,KAAK+V,IAAI3B,EAAKD,GAAM,GAAIq9B,EAAar/C,MAAMnH,KAAM8N,YAC/Dm5C,EAAMzK,EACN0K,EAAM1K,EAKV,GAAIwK,EAAK,GAAS,CAChB,IAAIruB,EAAK,SAAKquB,EAAK79B,EAAKnU,KAAKya,IAAIs3B,IAC7BnuB,EAAK,SAAKouB,EAAK59B,EAAKpU,KAAKya,IAAIs3B,KAC5BF,GAAY,EAALluB,GAAU,IAA8Buc,GAArBvc,GAAO+iB,EAAK,GAAK,EAAekL,GAAOjuB,IACjEkuB,EAAM,EAAG3R,EAAM0R,GAAOra,EAAKpB,GAAM,IACjC2b,GAAY,EAALluB,GAAU,IAA8B8tB,GAArB9tB,GAAO8iB,EAAK,GAAK,EAAeiL,GAAO/tB,IACjEkuB,EAAM,EAAGJ,EAAMC,GAAOpa,EAAKpB,GAAM,EACxC,CAEA,IAAI2P,EAAM1xB,EAAKpU,KAAKwa,IAAIk3B,GACpB3L,EAAM3xB,EAAKpU,KAAKya,IAAIi3B,GACpB7J,GAAM1zB,EAAKnU,KAAKwa,IAAIo3B,GACpB9J,GAAM3zB,EAAKnU,KAAKya,IAAIm3B,GAGxB,GAAIpK,EAAK,GAAS,CAChB,IAAIG,GAAMvzB,EAAKpU,KAAKwa,IAAIm3B,GACpB/J,GAAMxzB,EAAKpU,KAAKya,IAAIk3B,GACpBnZ,GAAMrkB,EAAKnU,KAAKwa,IAAI0lB,GACpBzH,GAAMtkB,EAAKnU,KAAKya,IAAIylB,GAGxB,GAAIyG,EAAK,GAAI,CACX,IAAIwL,GAAKN,EAAM,GAhIzB,SAASxP,UAAUlpB,EAAIyQ,EAAIxQ,EAAI2c,EAAI8J,EAAIC,EAAIsS,EAAIC,GAC7C,IAAIxK,EAAMzuB,EAAKD,EAAI2uB,EAAM/R,EAAKnM,EAC1B0oB,EAAMF,EAAKvS,EAAI0S,EAAMF,EAAKvS,EAC1Bt0C,GAAK8mD,GAAO1oB,EAAKkW,GAAMyS,GAAOp5B,EAAK0mB,KAAQ0S,EAAM1K,EAAMyK,EAAMxK,GACjE,MAAO,CAAC3uB,EAAK3tB,EAAIq8C,EAAKje,EAAKp+B,EAAIs8C,EACjC,CA2HmCzF,CAAUyD,EAAKC,EAAKvN,GAAKC,GAAKkP,GAAKC,GAAKC,GAAKC,IAAO,CAACD,GAAKC,IAC/ErQ,GAAKqO,EAAMqM,GAAG,GACdza,GAAKqO,EAAMoM,GAAG,GACdzO,GAAKiE,GAAMwK,GAAG,GACdxO,GAAKiE,GAAMuK,GAAG,GACdK,GAAK,EAAIxyC,KAAKya,IAAIza,KAAKs+B,MAAM7G,GAAKiM,GAAKhM,GAAKiM,KAAO3jC,KAAK0D,KAAK+zB,GAAKA,GAAKC,GAAKA,IAAM13B,KAAK0D,KAAKggC,GAAKA,GAAKC,GAAKA,MAAQ,GACnH8O,GAAKzyC,KAAK0D,KAAKyuC,GAAG,GAAKA,GAAG,GAAKA,GAAG,GAAKA,GAAG,IAC9CF,EAAMjyC,KAAKC,IAAIunC,GAAKrzB,EAAKs+B,KAAOD,GAAK,IACrCN,EAAMlyC,KAAKC,IAAIunC,GAAKpzB,EAAKq+B,KAAOD,GAAK,GACvC,CACF,CAGMV,EAAM,GAGHI,EAAM,IACbv4B,EAAK4tB,eAAe/O,GAAKC,GAAKqN,EAAKC,EAAK3xB,EAAI89B,EAAKxL,GACjD/1B,EAAK42B,eAAeI,GAAKC,GAAKC,GAAKC,GAAK1zB,EAAI89B,EAAKxL,GAEjD/mC,EAAQk6B,OAAOlgB,EAAG2a,GAAK3a,EAAGmsB,IAAKnsB,EAAG4a,GAAK5a,EAAGosB,KAGtCmM,EAAM1K,EAAI7nC,EAAQo6B,IAAIpgB,EAAG2a,GAAI3a,EAAG4a,GAAI2d,EAAKlyC,KAAKua,MAAMZ,EAAGosB,IAAKpsB,EAAGmsB,KAAM9lC,KAAKua,MAAM5J,EAAGo1B,IAAKp1B,EAAGm1B,MAAOY,IAIpG/mC,EAAQo6B,IAAIpgB,EAAG2a,GAAI3a,EAAG4a,GAAI2d,EAAKlyC,KAAKua,MAAMZ,EAAGosB,IAAKpsB,EAAGmsB,KAAM9lC,KAAKua,MAAMZ,EAAGiuB,IAAKjuB,EAAGguB,MAAOjB,GACxF/mC,EAAQo6B,IAAI,EAAG,EAAG3lB,EAAIpU,KAAKua,MAAMZ,EAAG4a,GAAK5a,EAAGiuB,IAAKjuB,EAAG2a,GAAK3a,EAAGguB,KAAM3nC,KAAKua,MAAM5J,EAAG4jB,GAAK5jB,EAAGi3B,IAAKj3B,EAAG2jB,GAAK3jB,EAAGg3B,MAAOjB,GAC/G/mC,EAAQo6B,IAAIppB,EAAG2jB,GAAI3jB,EAAG4jB,GAAI2d,EAAKlyC,KAAKua,MAAM5J,EAAGi3B,IAAKj3B,EAAGg3B,KAAM3nC,KAAKua,MAAM5J,EAAGo1B,IAAKp1B,EAAGm1B,MAAOY,MAKvF/mC,EAAQk6B,OAAOiM,EAAKC,GAAMpmC,EAAQo6B,IAAI,EAAG,EAAG3lB,EAAIs9B,EAAKC,GAAMjL,IArB1C/mC,EAAQk6B,OAAOiM,EAAKC,GAyBpC5xB,EAAK,IAAc09B,EAAM,GAGtBI,EAAM,IACbt4B,EAAK4tB,eAAeM,GAAKC,GAAKH,GAAKC,GAAKzzB,GAAK89B,EAAKvL,GAClD/1B,EAAK42B,eAAezB,EAAKC,EAAKvN,GAAKC,GAAKtkB,GAAK89B,EAAKvL,GAElD/mC,EAAQm6B,OAAOngB,EAAG2a,GAAK3a,EAAGmsB,IAAKnsB,EAAG4a,GAAK5a,EAAGosB,KAGtCkM,EAAMzK,EAAI7nC,EAAQo6B,IAAIpgB,EAAG2a,GAAI3a,EAAG4a,GAAI0d,EAAKjyC,KAAKua,MAAMZ,EAAGosB,IAAKpsB,EAAGmsB,KAAM9lC,KAAKua,MAAM5J,EAAGo1B,IAAKp1B,EAAGm1B,MAAOY,IAIpG/mC,EAAQo6B,IAAIpgB,EAAG2a,GAAI3a,EAAG4a,GAAI0d,EAAKjyC,KAAKua,MAAMZ,EAAGosB,IAAKpsB,EAAGmsB,KAAM9lC,KAAKua,MAAMZ,EAAGiuB,IAAKjuB,EAAGguB,MAAOjB,GACxF/mC,EAAQo6B,IAAI,EAAG,EAAG5lB,EAAInU,KAAKua,MAAMZ,EAAG4a,GAAK5a,EAAGiuB,IAAKjuB,EAAG2a,GAAK3a,EAAGguB,KAAM3nC,KAAKua,MAAM5J,EAAG4jB,GAAK5jB,EAAGi3B,IAAKj3B,EAAG2jB,GAAK3jB,EAAGg3B,KAAMjB,GAC9G/mC,EAAQo6B,IAAIppB,EAAG2jB,GAAI3jB,EAAG4jB,GAAI0d,EAAKjyC,KAAKua,MAAM5J,EAAGi3B,IAAKj3B,EAAGg3B,KAAM3nC,KAAKua,MAAM5J,EAAGo1B,IAAKp1B,EAAGm1B,MAAOY,KAKvF/mC,EAAQo6B,IAAI,EAAG,EAAG5lB,EAAIy9B,EAAK1R,EAAKwG,GArBI/mC,EAAQm6B,OAAO+N,GAAKC,GAsB/D,MAhHqBnoC,EAAQk6B,OAAO,EAAG,GAoHvC,GAFAl6B,EAAQi6B,YAEJqX,EAAQ,OAAOtxC,EAAU,KAAMsxC,EAAS,IAAM,IACpD,CAwCA,OAtCAlX,IAAI/Q,SAAW,WACb,IAAIz9B,IAAMu7C,EAAY30C,MAAMnH,KAAM8N,aAAckuC,EAAY70C,MAAMnH,KAAM8N,YAAc,EAClFpN,IAAMw7C,EAAW/0C,MAAMnH,KAAM8N,aAAcsuC,EAASj1C,MAAMnH,KAAM8N,YAAc,EAAI,GAAK,EAC3F,MAAO,CAACkH,KAAKwa,IAAI9uB,GAAKH,EAAGyU,KAAKya,IAAI/uB,GAAKH,EACzC,EAEAwuC,IAAI+M,YAAc,SAASxjC,GACzB,OAAOxK,UAAU1Q,QAAU0+C,EAA2B,mBAANxjC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAO+M,CAC9F,EAEA/M,IAAIiN,YAAc,SAAS1jC,GACzB,OAAOxK,UAAU1Q,QAAU4+C,EAA2B,mBAAN1jC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAOiN,CAC9F,EAEAjN,IAAIyX,aAAe,SAASluC,GAC1B,OAAOxK,UAAU1Q,QAAUopD,EAA4B,mBAANluC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAOyX,CAC/F,EAEAzX,IAAI0X,UAAY,SAASnuC,GACvB,OAAOxK,UAAU1Q,QAAUqpD,EAAiB,MAALnuC,EAAY,KAAoB,mBAANA,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAO0X,CAC/G,EAEA1X,IAAImN,WAAa,SAAS5jC,GACxB,OAAOxK,UAAU1Q,QAAU8+C,EAA0B,mBAAN5jC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAOmN,CAC7F,EAEAnN,IAAIqN,SAAW,SAAS9jC,GACtB,OAAOxK,UAAU1Q,QAAUg/C,EAAwB,mBAAN9jC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAOqN,CAC3F,EAEArN,IAAIuN,SAAW,SAAShkC,GACtB,OAAOxK,UAAU1Q,QAAUk/C,EAAwB,mBAANhkC,EAAmBA,EAAI,uBAAUA,GAAIy2B,KAAOuN,CAC3F,EAEAvN,IAAIp6B,QAAU,SAAS2D,GACrB,OAAOxK,UAAU1Q,QAAWuX,EAAe,MAAL2D,EAAY,KAAOA,EAAIy2B,KAAOp6B,CACtE,EAEOo6B,GACT,CwBiZiBA,GAAM+M,YAAY75C,EAAK65C,aAAe,GAAGE,YAAY/5C,EAAK+5C,aAAe/5C,EAAKixC,QAAU,GAAGgJ,WAAWj6C,EAAKi6C,YAAc,GAAGE,SAASn6C,EAAKm6C,UAAY,EAAIpnC,KAAKwZ,IAY9K,OAVIq3B,GACFU,EAAS5xC,QAAQkxC,GACjBM,EAAQC,YAAcL,SAGtBI,EAAQE,MAAQ,CACdtmD,EAAGwmD,KAIAJ,CACT,EA4CIuB,GAAY,SAASA,UAAUvF,GACjC,IAAI1wC,EAAO0wC,EAAK1wC,KACZk2C,EAAcxF,EAAKwF,YAEnBC,EAAan2C,EAAKm2C,WAClBC,EAASD,EAAWjmB,SAEpBvT,EAAKw5B,EAAWv9C,EAAIw9C,EAAOx9C,EAC3BwqC,EAAKzmB,EAAKw5B,EAAWxuB,GACrB2R,EAAK6c,EAAWhgD,EAAIigD,EAAOjgD,EAC3BktC,EAAK/J,EAAK6c,EAAWvuB,GAErByuB,EAAcF,EAAWxd,QAE7B,GAAoB,WAAhBud,IAA6BG,EAAY9L,aAAe8L,EAAY5U,QAAS,CAC/E,IAAIhuB,EAAIlQ,KAAK0D,MAAM0V,EAAKymB,IAAOzmB,EAAKymB,IAAO9J,EAAK+J,IAAO/J,EAAK+J,IACxDvD,EAAQv8B,KAAK8wB,MAAMgP,EAAK5vB,GACxB3kB,EAAIunD,EAAY9L,aAAe8L,EAAY5U,QAAU4U,EAAYC,eAAiB,GAEtF35B,EAAKpZ,KAAK+V,IAAI/V,KAAKwa,IAAI+hB,GAAShxC,IAAMs0C,EAAK,GAAK,EAAI,GACpD9J,EAAK/1B,KAAK+V,IAAI/V,KAAKya,IAAI8hB,GAAShxC,IAAMu0C,EAAK,GAAK,EAAI,EACtD,CAEA,GAAoB,SAAhB6S,EAAwB,CAC1B,IAAIl9B,EAAQq9B,EAAYr9B,MACpBsR,EAAS+rB,EAAY/rB,QAGrBtR,EAAQ,GAAKm9B,EAAWxuB,GAAK,GAAK3O,EAAQ,GAAKm9B,EAAWxuB,GAAK,KAClBhL,EAA3CpZ,KAAK+V,IAAIN,GAASzV,KAAK+V,IAAI68B,EAAWxuB,IAAU3O,EAAQ,EAAYA,IAEtEsR,EAAS,GAAK6rB,EAAWvuB,GAAK,GAAK0C,EAAS,GAAK6rB,EAAWvuB,GAAK,KACnB0R,EAA5C/1B,KAAK+V,IAAIgR,GAAU/mB,KAAK+V,IAAI68B,EAAWvuB,IAAU0C,EAAS,EAAYA,GAExE3N,IAAO3D,EAAQ,GAAKsgB,IAAOhP,EAAS,IACtC3N,EAAKymB,EAAG9J,EAAK+J,EAEjB,CAEA,MAAO,CAAC,CAAC1mB,EAAI2c,GAAK,CAAC8J,EAAIC,GACzB,EA8EIkT,eAAiB,SAAW7F,GAC9B,IAAI1wC,EAAO0wC,EAAK1wC,KACZw2C,EAAgB9F,EAAK8F,cACrBN,EAAcxF,EAAKwF,YAGlBM,IACHA,EAAgB,CAAC,GAEdA,EAAcne,QAA0C,iBAAzBme,EAAcne,SAChDme,EAAcne,OAASoe,GAAaz2C,EAAKm2C,WAAWC,OAAQI,EAAcne,SAEvEme,EAAc1K,QACjB0K,EAAc1K,MAAQ,IAGxB,IAAI4K,EAAU,GAEd,GAAI12C,EAAKgzC,SAAU,CACjB,IAAI2D,EAAWH,EAAcne,OAAO7oC,IAAI,SAAU+F,EAAG7J,GACnD,OAAOskD,GAAS,CAAC,EAzXL,SAAS4G,YAAYlG,GACrC,IAAImG,EAAUnG,EAAK7Y,GACfA,OAAiB/nC,IAAZ+mD,EAAwB,EAAIA,EACjCC,EAAUpG,EAAK5Y,GAGnB,MAAO,CAAEif,KAAM,CAAEn+C,EAAGi/B,EAAI1hC,OAFHrG,IAAZgnD,EAAwB,EAAIA,GAGvC,CAkX0BF,CAAY,CAAE/e,GAAItiC,EAAE,GAAIuiC,GAAIviC,EAAE,KAAO,CAAE/H,MAAO9B,GACpE,GAEIsrD,EAAc,SAASA,YAAYxpD,GACrCgpD,EAAcne,OAAO7qC,GAAO,IAAM,GAAMm6B,GACxC6uB,EAAcne,OAAO7qC,GAAO,IAAM,GAAMo6B,GACxC5nB,EAAKgyC,iBACP,EAEA0E,EAAU12C,EAAKi3C,WAAWN,EAASnnD,IAAI,SAAUikB,GAC/C,OAAOu8B,GAAS,CAAC,EAAGv8B,EAAEsjC,KAAM,CAAExO,KAAMyO,EAAY3gD,KAAK2J,EAAMyT,EAAEjmB,QAC/D,GACF,CAEA,IAAIgD,EAAOylD,GAAU,CAAEj2C,KAAMA,EAAMk2C,YAAaA,IAIhD,OAHA1lD,EAAO,CAACA,EAAK,IAAIpE,OA3tBK,SAAU8qD,GAChC,GAAIr/C,MAAMM,QAAQ++C,GAAM,CACtB,IAAK,IAAIxrD,EAAI,EAAGyrD,EAAOt/C,MAAMq/C,EAAIvrD,QAASD,EAAIwrD,EAAIvrD,OAAQD,IAAKyrD,EAAKzrD,GAAKwrD,EAAIxrD,GAE7E,OAAOyrD,CACT,CACE,OAAOt/C,MAAMG,KAAKk/C,EAEtB,CAmtB0BE,CAAkBZ,EAAcne,QAAS,CAAC7nC,EAAK,KAGhE,CAAE6mD,WAFQ,CAACnD,GAAY,CAAE1jD,KAAMA,EAAMs7C,MAAO0K,EAAc1K,MAAOhd,UAAW,eAElD4nB,QAASA,EAC3C,EAEGD,GAAe,SAASA,aAAaL,GAOvC,IANA,IAAIkB,EAAUj7C,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,EAE9Ek7C,EAAYnB,EAAOx9C,GAAK0+C,EAAU,GAAlCC,EAAyCnB,EAAOjgD,GAAKmhD,EAAU,GAC/D/jD,EAAI,GAEJ7H,EAAI,EACDA,GAAK4rD,EAAS5rD,IACnB6H,EAAEvI,KAAK,CAACusD,EAAS7rD,EAAIA,EAAI,EAAI,GAAI6rD,EAAS7rD,EAAIA,EAAI,EAAI,KAExD,OAAO6H,CACT,EA0EIikD,cAAgB,SAAW9G,GAC7B,IAAI2F,EAAc3F,EAAK2F,YACnBr2C,EAAO0wC,EAAK1wC,KAEXq2C,EAAY5U,QAAW4U,EAAY9L,cACtC8L,EAAY5U,OAAS,IAGvB,IAAIiV,EAAU,GACVnhD,EAAIs/C,GAAW,CAAErkD,KAAM6lD,EAAavnB,UAAW,YACnD,GAAI9uB,EAAKgzC,SAAU,CACjB,IAAIv/B,EAreY,SAASgkC,cAAcpF,GACzC,IAAIqF,EAAWrF,EAAMxa,GACjBA,OAAkB/nC,IAAb4nD,EAAyB,EAAIA,EAClCC,EAAWtF,EAAMva,GACjBA,OAAkBhoC,IAAb6nD,EAAyB,EAAIA,EAClChgC,EAAK06B,EAAM16B,GACXigC,EAAKvF,EAAMuF,GACXh8B,EAAUy2B,EAAMz2B,QAEhBnI,EAAI,CAAEsjC,KAAM,CAAEn+C,EAAGi/B,EAAI1hC,EAAG2hC,IAc5B,YAZWhoC,IAAP6nB,IACFlE,EAAEkE,GAAK,CAAE/e,EAAGi/B,EAAKlgB,EAAKpU,KAAK0D,KAAK,GAAI9Q,EAAG2hC,EAAKngB,EAAKpU,KAAK0D,KAAK,UAGlDnX,IAAP8nD,IACFnkC,EAAEmkC,GAAK,CAAEh/C,EAAGi/B,EAAK+f,EAAKr0C,KAAK0D,KAAK,GAAI9Q,EAAG2hC,EAAK8f,EAAKr0C,KAAK0D,KAAK,UAG7CnX,IAAZ8rB,IACFnI,EAAEmI,QAAU,CAAEhjB,EAAGi/B,EAAKlgB,EAAKiE,EAASzlB,EAAG2hC,IAGlCrkB,CACT,CA6cYgkC,CAAc,CACpB9/B,GAAIpiB,EAAE/E,KAAK+5C,aAAeh1C,EAAE/E,KAAKixC,OACjCmW,GAAIriD,EAAE/E,KAAK65C,YACXzuB,QAASy6B,EAAYC,gBAGnBuB,EAAe,SAASA,aAAatzC,GACvC,IAAIzV,EAAIunD,EAAY9xC,GAAQ,GAAMojB,GAAKpkB,KAAK0D,KAAK,GACjDovC,EAAY9xC,GAAQzV,EACpBkR,EAAK4xC,gBACL5xC,EAAKgyC,iBACP,EAEI2E,EAAW,CAAC3G,GAAS,CAAC,EAAGv8B,EAAEkE,GAAI,CACjC4wB,KAAMsP,EAAaxhD,KAAK2J,OAAkClQ,IAA5BumD,EAAY9L,YAA4B,cAAgB,aAGpF8L,EAAYhM,aACdsM,EAAS3rD,KAAKglD,GAAS,CAAC,EAAGv8B,EAAEmkC,GAAI,CAAErP,KAAMsP,EAAaxhD,KAAK2J,EAAM,kBAEnE02C,EAAU12C,EAAKi3C,WAAWN,EAC5B,CAIA,OAFAphD,EAAEq/C,MAAM,gBAAkB,EAEnB,CAAEyC,WAAY,CAAC9hD,GAAImhD,QAASA,EACpC,EAsMGoB,GAAO,WACT,SAASA,KAAKpH,GACZ,IAAIzhD,EAAIyhD,EAAKzhD,EACTknD,EAAazF,EAAKyF,WAClBnD,EAAWtC,EAAKsC,SAChB+E,EAAarH,EAAKqH,WAClBtE,EAAc/C,EAAK+C,YACnBf,EAAYhC,EAAKgC,UAWrB,GAVAlD,eAAejhD,KAAMupD,MAErBvpD,KAAKU,EAAIA,EAETV,KAAK4iD,MAA+C,IAAxCgF,EAAW/E,QAAQ51C,QAAQ,SAAkBvM,EAAEsS,OAAO,qBAClEhT,KAAKypD,YAAczpD,KAAK4iD,MAAQliD,EAAEsS,OAAO,6BACzChT,KAAK2iD,WAAyD,IAA7CiF,EAAW/E,QAAQ51C,QAAQ,cAAuBvM,EAAEsS,OAAO,0BAC5EhT,KAAKoqC,SAAqD,IAA3Cwd,EAAW/E,QAAQ51C,QAAQ,YAAqBvM,EAAEsS,OAAO,wBACxEhT,KAAKwpD,WAAaA,EAEdA,EAAY,CACd,IAAIE,EAAUC,GAAY7hD,KAAK,KAAM0hD,EAAY5B,GACjD8B,EAAQ,CAAEE,UAAW5pD,KAAK4iD,KAAMr+C,KAAM,SACtCmlD,EAAQ,CAAEE,UAAW5pD,KAAK2iD,UAAWp+C,KAAM,cAC3CmlD,EAAQ,CAAEE,UAAW5pD,KAAKoqC,QAAS7lC,KAAM,WAC3C,CAEAvE,KAAK4nD,WAAaA,EAClB5nD,KAAKykD,SAAWmD,EAAWnD,UAAYA,EACvCzkD,KAAKklD,iBAA8B3jD,IAAhB2jD,EAA4BA,EAAc,EAC7DllD,KAAK6pD,cAAgB,EACrB7pD,KAAK8pD,cAAgB,EAEjB3F,GAAayD,EAAW3lD,MAC1BjC,KAAK6yB,KAAKsxB,EAEd,CAyXA,OAvXA/C,GAAYmI,KAAM,CAAC,CACjB7gD,IAAK,OACL5H,MAAO,SAAS+xB,KAAKsxB,GACdnkD,KAAK4nD,WAAWv9C,GACnBrK,KAAK+pD,KAAK5F,GAEPnkD,KAAK4nD,WAAWhgD,GACnB5H,KAAKgqD,KAAK7F,EAEd,GACC,CACDz7C,IAAK,OACL5H,MAAO,SAASkpD,KAAK7F,GACfA,EAAUv8C,IACZ5H,KAAK4nD,WAAWhgD,EAAIu8C,EAAUv8C,EAAE5H,KAAK4nD,WAAW3lD,MAEpD,GACC,CACDyG,IAAK,OACL5H,MAAO,SAASipD,KAAK5F,GACfA,EAAU95C,IACZrK,KAAK4nD,WAAWv9C,EAAI85C,EAAU95C,EAAErK,KAAK4nD,WAAW3lD,MAEpD,GACC,CACDyG,IAAK,iBACL5H,MAAO,SAAS6jD,iBACd3kD,KAAKU,EAAE0S,UAAU,iBAAiBtU,QACpC,GACC,CACD4J,IAAK,YACL5H,MAAO,SAASmpD,UAAUL,EAAWM,GACnC,IAAI1F,EAAQxkD,KAEPsJ,MAAMM,QAAQsgD,KACjBA,EAAW,CAACA,IAGdA,EAASp/C,OAAO,SAAU/B,GACxB,OAAOA,CACT,GAAG25B,QAAQ,SAAUohB,GACnB,IAAIryC,EAAOqyC,EAAMryC,KACb8uB,EAAYujB,EAAMvjB,UAClB8lB,EAAQvC,EAAMuC,MACd8B,EAAUrE,EAAMqE,QAChBrC,EAAUhC,EAAMgC,QAEpB,GAAa,WAATr0C,GAzvBK,SAAS04C,WAAWC,GACnC,IAAI3+C,EAAQ2+C,EAAM3+C,MACd08C,EAAUiC,EAAMjC,QAChBkC,EAAUD,EAAM7pD,EAChBA,OAAgBgB,IAAZ8oD,EAAwB,GAAKA,EAIjCnlC,EAAIzZ,EAAM2H,UAAU,iBAAiBnR,KAAKkmD,GAE9CjjC,EAAExZ,QAAQ8I,OAAO,UAAUwB,KAAK,QAAS,UAAUA,KAAK,OAAQ,QAAQA,KAAK,eAAgB,IAAKA,KAAK,SAAU,QAAQA,KAAK,mBAAoB,GAAGA,KAAK,SAAU,QAAQxS,KAAKw2C,OAAO1Z,UAAU,wBAAO,iBAAiB51B,QAAQ4G,GAAG,QAAS,SAAUvR,GACtP,OAAOA,EAAE+Y,OAAS/Y,EAAE+Y,MAAM/Y,EAC5B,GAAGuR,GAAG,OAAQ,SAAUvR,GACtB,OAAOA,EAAEi6C,MAAQj6C,EAAEi6C,KAAKj6C,EAC1B,GAAGuR,GAAG,MAAO,SAAUvR,GACrB,OAAOA,EAAEmnB,KAAOnnB,EAAEmnB,IAAInnB,EACxB,IAEA0L,EAAM2H,UAAU,iBAAiB4C,KAAK,KAAM,SAAUjW,GACpD,OAAOA,EAAEsK,CACX,GAAG2L,KAAK,KAAM,SAAUjW,GACtB,OAAOA,EAAE6H,CACX,GAAGoO,KAAK,IAAK,SAAUjW,GACrB,OAAOA,EAAEQ,GAAKA,CAChB,GAAGyV,KAAK,QAAS,SAAUjW,GACzB,MAAO,WAAaA,EAAEwgC,WAAa,GACrC,GAEArb,EAAEvZ,OAAO7M,QACX,CA6tBUqrD,CAAW,CAAE1+C,MAAOm+C,EAAWrpD,EAAG8lD,GAASA,EAAM9lD,EAAG4nD,QAASA,QACxD,CACLmC,GAAaV,EAAW,CAACpF,EAAMoD,YAAan2C,EAAM8uB,EAAWulB,GAM7D,IALA,IAAInjB,EAAKinB,EAAU52C,OAAOvB,EAAO,KAAOq0C,GAAWvlB,IAC/CgqB,EAAWnoD,OAAOwD,KAAKygD,GACvBmE,EAAc,GAEdC,EAAe9nB,EAAGj4B,OAAO/H,WACpBxF,EAAIstD,EAAartD,OAAS,EAAGD,GAAK,EAAGA,IAAK,CACjD,IAAIoH,EAAOkmD,EAAattD,GAAGoH,MACK,IAA5BgmD,EAASt9C,QAAQ1I,IAAyB,UAATA,GAAkBimD,EAAY/tD,KAAK8H,EAC1E,CAEAgmD,EAAS7nB,QAAQ,SAAU1sB,GACZ,SAATA,EACF2sB,EAAGvsB,KAAKiwC,EAAMrwC,IAEd2sB,EAAG3sB,KAAKA,EAAMqwC,EAAMrwC,GAExB,GAEAw0C,EAAY9nB,QAAQ,SAAU1sB,GAC5B,OAAO2sB,EAAG3sB,KAAKA,EAAM,KACvB,EACF,CACF,EACF,GAIC,CACDtN,IAAK,cACL5H,MAAO,SAAS4pD,cACd,OAAOC,GAAmB3qD,KAAK4iD,KAAM,gCACvC,GACC,CACDl6C,IAAK,oBACL5H,MAAO,SAASskD,oBACd,IAAIwF,EAAOD,GAAmB3qD,KAAK4iD,KAAM,4BACrCr5B,EAAYvpB,KAAKypD,YAAYzzC,KAAK,aAAahH,MAAM,aAKzD,OAJA47C,EAAKf,cAAgB7nB,WAAWzY,EAAU,IAAMvpB,KAAK4nD,WAAWxuB,GAChEwxB,EAAKd,cAAgB9nB,WAAWzY,EAAU,IAAMvpB,KAAK4nD,WAAWvuB,GAChEuxB,EAAKC,QAAU7qD,KAAK4nD,WAAWxuB,GAC/BwxB,EAAKE,QAAU9qD,KAAK4nD,WAAWvuB,GACxBuxB,CACT,GACC,CACDliD,IAAK,cACL5H,MAAO,SAASiqD,cACd,IAAI5F,EAASnlD,KAET2U,EAAU7G,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,CAAC,EAE/Eg6C,EAAc9nD,KAAK4nD,WAAWxd,QAC9B34B,EAAOkD,EAAQlD,KACfu5C,EAAgB,CAAEv5C,KAAMzR,KAAM8nD,YAAaA,GAE3C1d,EAAU,CAAC,EACF,WAAT34B,EAAmB24B,EAAU6e,cAAc+B,GAAiC,SAATv5C,EAAiB24B,EAlV5E,SAAW+X,GAC3B,IAAI2F,EAAc3F,EAAK2F,YACnBr2C,EAAO0wC,EAAK1wC,KAEXq2C,EAAYr9B,QACfq9B,EAAYr9B,MAAQ,KAEjBq9B,EAAY/rB,SACf+rB,EAAY/rB,OAAS,KAGvB,IAAIosB,EAAU,GACV19B,EAAQq9B,EAAYr9B,MACpBsR,EAAS+rB,EAAY/rB,OAIrBpB,EAAOgrB,GAAY,CAAE1jD,KADd,CAAC,CAAC,EAAG,GAAI,CAACwoB,EAAO,GAAI,CAACA,EAAOsR,GAAS,CAAC,EAAGA,GAAS,CAAC,EAAG,IAC7BwE,UAAW,YAEhD,GAAI9uB,EAAKgzC,SAAU,CACjB,IAYIwG,EAAW,CAAC,CAAE5gD,EAAGogB,EAAO7iB,EAAGm0B,EAAS,EAAGie,KAZzB,SAASkR,cACzBpD,EAAYr9B,MAAQ,GAAMpgB,EAC1BoH,EAAK4xC,gBACL5xC,EAAKgyC,iBACP,EAQ6D37C,KAAK2J,IAAS,CAAEpH,EAAGogB,EAAQ,EAAG7iB,EAAGm0B,EAAQie,KANnF,SAASmR,eAC1BrD,EAAY/rB,OAAS,GAAMn0B,EAC3B6J,EAAK4xC,gBACL5xC,EAAKgyC,iBACP,EAEyH37C,KAAK2J,KAE9H02C,EAAU12C,EAAKi3C,WAAWuC,EAC5B,CAEA,OADAtwB,EAAK0rB,MAAM,gBAAkB,GACtB,CAAEyC,WAAY,CAACnuB,GAAOwtB,QAASA,EACvC,CA4SuGiD,CAAYJ,GAAiC,cAATv5C,EAAsB24B,EA1S3I,SAAW+X,GAChC,IAAI2F,EAAc3F,EAAK2F,YAGnBD,EAFO1F,EAAK1wC,KAEEm2C,WAAWjmB,SAEzBvT,QAAyB7sB,IAAnBumD,EAAY15B,GAAmB05B,EAAY15B,GAAKy5B,EAAOx9C,GAAKw9C,EAAOx9C,EACzEwqC,QAAyBtzC,IAAnBumD,EAAYjT,GAAmBiT,EAAYjT,GAAKgT,EAAOx9C,GAAKw9C,EAAOx9C,EACzE0gC,QAAyBxpC,IAAnBumD,EAAY/c,GAAmB+c,EAAY/c,GAAK8c,EAAOjgD,GAAKigD,EAAOjgD,EACzEktC,QAAyBvzC,IAAnBumD,EAAYhT,GAAmBgT,EAAYhT,GAAK+S,EAAOjgD,GAAKigD,EAAOjgD,EAG7E,MAAO,CAAEkhD,WAAY,CAACnD,GAAY,CAAE1jD,KADzB,CAAC,CAACmsB,EAAI2c,GAAK,CAAC8J,EAAIC,IACqBvU,UAAW,aAC5D,CA6R2K8qB,CAAiBL,GAAiC,UAATv5C,IAAkB24B,EA3RpN,SAAW+X,GAC5B,IAAImJ,EAAmBnJ,EAAK2F,YACxBA,OAAmCvmD,IAArB+pD,EAAiC,CAAC,EAAIA,EACpDC,EAAYpJ,EAAK1wC,KACjBA,OAAqBlQ,IAAdgqD,EAA0B,CAAC,EAAIA,EACtC3D,EAAa95C,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,CAAC,EAElF09C,EAAe/5C,EAAK+5C,cAAgB/5C,EAAK+5C,aAAaphB,QAErD0d,EAAY5U,SACXsY,GAAgBA,EAAatY,OAC/B4U,EAAY5U,OAASsY,EAAatY,OAElC4U,EAAY5U,OAAS,IAGpB4U,EAAYz9C,GACXmhD,GAAgBA,EAAanhD,IAC/By9C,EAAYz9C,EAAImhD,EAAanhD,GAG5By9C,EAAYlgD,GACX4jD,GAAgBA,EAAa5jD,IAC/BkgD,EAAYlgD,EAAI4jD,EAAa5jD,GAIjC,IAAIugD,EAAU,GACVW,EAAa,GACb5V,EAAS4U,EAAY5U,OACrB4I,EAAuB,GAAT5I,EACd7oC,EAAI,EACJzC,EAAI,EAEJ6jD,EAAkBz2C,KAAK0D,KAAK,GAAKw6B,EACjCwY,EAAY,CACdC,aAAczY,EACd0Y,aAAc1Y,EACd2Y,YAAa3Y,EACb4Y,cAAe5Y,EACf6Y,OAAQN,EACRO,OAAQP,EACRQ,MAAOR,EACPS,QAAST,GAGP3D,EAAYz9C,IAAMy9C,EAAYlgD,EAChCyC,EAAIqhD,EAAU,IAAM5D,EAAYz9C,GACvBy9C,EAAYlgD,IAAMkgD,EAAYz9C,EACvCzC,EAAI8jD,EAAU,IAAM5D,EAAYlgD,GACvBkgD,EAAYz9C,GAAKy9C,EAAYlgD,IACtCyC,EAAIqhD,EAAU,IAAM5D,EAAYz9C,EAAI,UACpCzC,EAAI8jD,EAAU,IAAM5D,EAAYlgD,EAAI,WAGtC,IAAI2hB,EAAY,aAAelf,EAAI,KAAOzC,EAAI,IAC1CukD,EAAW7F,GAAW,CAAE/lB,UAAW,UAAWt+B,KAAM,CAAEixC,OAAQA,KAClEiZ,EAAS9F,MAAM98B,UAAYA,EAC3B4iC,EAAS9F,MAAMh8B,KAAOu9B,EAAW3gC,MACjCklC,EAAS9F,MAAM,kBAAoB,QACnC8F,EAAS9F,MAAM,gBAAkB,MAEjC,IAAI+F,EAAS9F,GAAW,CACtB/lB,UAAW,eACXt+B,KAAM,CAAE+5C,YAAa9I,EAAQ4I,YAAaA,KAG5CsQ,EAAO/F,MAAM98B,UAAYA,EAEzB6iC,EAAO/F,MAAM,gBAAkB,MAC/B+F,EAAO/F,MAAMh8B,KAAO,QAEpB,IAAIgiC,OAAU,EACd,GAAIhiD,GAAKzC,IAAMyC,IAAMzC,EACnBykD,EAAU1G,GAAY,CACpBplB,UAAW,kBACXt+B,KAAM,CAAC,CAAC,EAAG,GAAI,CAACoI,GAAK,EAAG,GAAI,CAAC,EAAGzC,GAAK,GAAI,CAAC,EAAG,WAE1C,GAAIyC,GAAKzC,EAAG,CACjB,IAAI0kD,EAAqB,SAASA,mBAAmBrsD,GACnD,IAAIsqB,EAAOzc,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,EAC/E,OAAO7N,GAAKA,EAAI+U,KAAK0D,KAAK,GAAK1D,KAAK0D,KAAK,IAAM6R,EAAO2oB,EAASl+B,KAAK0D,KAAK,EAC3E,EAEA2zC,EAAU1G,GAAY,CACpBplB,UAAW,kBACXt+B,KAAM,CAAC,CAAC,EAAG,GAAI,CAACqqD,EAAmBjiD,GAAIiiD,EAAmB1kD,IAAK,CAAC0kD,EAAmBjiD,GAAI,GAAIiiD,EAAmB1kD,GAAI,IAAK,CAAC,EAAG,KAE/H,CASA,GAPIykD,IACFA,EAAQhG,MAAMh8B,KAAOu9B,EAAW3gC,MAChColC,EAAQhG,MAAM,kBAAoB,QAClCgG,EAAQhG,MAAM,gBAAkB,MAChCyC,EAAWrsD,KAAK4vD,IAGd56C,EAAKgzC,SAAU,CACjB,IAOI8H,EAAW,CAAEliD,EAAO,EAAJA,EAAOzC,EAAO,EAAJA,EAAOoyC,KAPrB,SAASwS,YACvB1E,EAAYz9C,EAAI,GAAMA,EAAc,GAAT6oC,EAAa,OAAS,GAAM7oC,EAAa,EAAT6oC,EAAa,aAAU3xC,EAClFumD,EAAYlgD,EAAI,GAAMA,EAAc,GAATsrC,EAAa,MAAQ,GAAMtrC,EAAa,EAATsrC,EAAa,cAAW3xC,EAElFkQ,EAAK4xC,eACP,EAEqDv7C,KAAK2J,IACrD86C,EAASliD,GAAMkiD,EAAS3kD,IAC3B2kD,EAAS3kD,GAAKsrC,GAGhBiV,EAAU12C,EAAKi3C,WAAW,CAAC6D,GAC7B,CAEA,IAAIn2C,OAAO,EAsBX,OArBI0xC,EAAY1xC,OACdA,EAAO,CACL3E,KAAM,OACN8uB,UAAW,aACX8lB,MAAO,CACLh8B,KAAM,QACNoiC,OAAQ,OACR,YAAa,OACbr2C,KAAM0xC,EAAY1xC,KAClB,cAAe,SACfijB,GAAI,QACJhvB,EAAGA,EACHzC,EAAGA,KAKTkhD,EAAWrsD,KAAK0vD,GAChBrD,EAAWrsD,KAAK2vD,GAChBtD,EAAWrsD,KAAK2Z,GAET,CAAE0yC,WAAYA,EAAYX,QAASA,EAC3C,CAmJgPuE,CAAa1B,EAAehrD,KAAK4nD,aAE5Q,IAAI+E,EAAWviB,EACXwiB,EAAsBD,EAAS7D,WAC/BA,OAAqCvnD,IAAxBqrD,EAAoC,GAAKA,EACtDC,EAAmBF,EAASxE,QAC5BA,OAA+B5mD,IAArBsrD,EAAiC,GAAKA,EAapD,OAXA/D,EAAWpmB,QAAQ,SAAU17B,GACvBA,GAAKA,EAAEq/C,QAAUr/C,EAAEq/C,MAAMoG,SAC3BzlD,EAAEq/C,MAAMoG,OAAStH,EAAOyC,WAAW3gC,MAEvC,GAEIjnB,KAAKykD,WACP0D,EAAUA,EAAQtqD,OAAOmC,KAAK0oD,WAAW,CAAC,CAAE1O,KAAMh6C,KAAK8sD,YAAYhlD,KAAK9H,UACxE8oD,EAAWrsD,KAAK,CAAEgV,KAAM,SAAU02C,QAASA,KAGtCW,CACT,GACC,CACDpgD,IAAK,gBACL5H,MAAO,SAASisD,gBACd,IAAIC,EAAShtD,KAET2U,EAAU7G,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,CAAC,EAE/Em6C,EAAgBjoD,KAAK4nD,WAAWjF,UAChClxC,EAAOw2C,EAAcx2C,MAAQkD,EAAQlD,KACrCw7C,EAAkB,CAAEx7C,KAAMzR,KAAMioD,cAAeA,GACnDgF,EAAgBtF,YAAc3nD,KAAKwrD,cAAgBxrD,KAAKwrD,aAAaphB,SAAWpqC,KAAKwrD,aAAaphB,QAAQ34B,KAE1G,IAAIkxC,EAAY,CAAC,EACKA,EAAT,UAATlxC,EAA8Bu2C,eAAeiF,GAAmC,UAATx7C,EAhmB5D,SAAW0wC,GAC9B,IAAI1wC,EAAO0wC,EAAK1wC,KACZk2C,EAAcxF,EAAKwF,YAGnBC,EAAan2C,EAAKm2C,WAClBC,EAASD,EAAWjmB,SAEpBvT,EAAKw5B,EAAWv9C,EAAIw9C,EAAOx9C,EAC3BwqC,EAAKzmB,EAAKw5B,EAAWxuB,GACrB2R,EAAK6c,EAAWhgD,EAAIigD,EAAOjgD,EAC3BktC,EAAK/J,EAAK6c,EAAWvuB,GAErByuB,EAAcF,EAAWxd,QAE7B,GAAoB,SAAhBud,EAAwB,CAC1B,IAAIl9B,EAAQq9B,EAAYr9B,MACpBsR,EAAS+rB,EAAY/rB,QAGrBtR,EAAQ,GAAKm9B,EAAWxuB,GAAK,GAAK3O,EAAQ,GAAKm9B,EAAWxuB,GAAK,KAClBhL,EAA3CpZ,KAAK+V,IAAIN,GAASzV,KAAK+V,IAAI68B,EAAWxuB,IAAU3O,EAAQ,EAAYA,IAEtEsR,EAAS,GAAK6rB,EAAWvuB,GAAK,GAAK0C,EAAS,GAAK6rB,EAAWvuB,GAAK,KACnB0R,EAA5C/1B,KAAK+V,IAAIgR,GAAU/mB,KAAK+V,IAAI68B,EAAWvuB,IAAU0C,EAAS,EAAYA,GAExE3N,IAAO3D,EAAQ,GAAKsgB,IAAOhP,EAAS,IACtC3N,EAAKymB,EAAG9J,EAAK+J,EAEjB,CAEA,IAAI7yC,EAAO,CAAC,CAACmsB,EAAI2c,GAAK,CAAC8J,EAAIC,IAEvBoY,EAAQpY,EAAK/J,EACboiB,EAAQtY,EAAKzmB,EACbg/B,EAAKvY,EACLwY,EAAKvY,EACLwY,EAAWxY,EAAK/J,GAAM8J,EAAKzmB,GAAMymB,EAAKzmB,GAAM0mB,EAAK/J,GAAM,EAAI,EAU/D,GARI/1B,KAAK+V,IAAIoiC,GAASn4C,KAAK+V,IAAImiC,IAC7BE,EAAKvY,EACLwY,EAAKtiB,EAAKoiB,EAAQG,IAElBD,EAAKvY,EACLsY,EAAKh/B,EAAK8+B,EAAQI,GAGA,WAAhB3F,IAA6BG,EAAY9L,aAAe8L,EAAY5U,QAAS,CAC/E,IAAI3yC,GAAKunD,EAAY9L,aAAe8L,EAAY5U,SAAW4U,EAAYC,eAAiB,GACpF3qD,EAASmD,EAAIyU,KAAK0D,KAAK,GAE3B,GAAI1D,KAAK+V,IAAIoiC,GAAS/vD,GAAU4X,KAAK+V,IAAImiC,GAAS9vD,EAGhD6E,EAAO,CAAC,CAFRmsB,EAAKhxB,GAAUy3C,EAAK,GAAK,EAAI,GAC7B9J,EAAK3tC,GAAU03C,EAAK,GAAK,EAAI,IACX,CAACsY,EAAIC,GAAK,CAACxY,EAAIC,SAC5B,GAAI9/B,KAAK+V,IAAIoiC,GAASn4C,KAAK+V,IAAImiC,GAAQ,CAC5C,IAAI3b,EAAQv8B,KAAK8wB,MAAMgP,EAAKv0C,GAE5B0B,EAAO,CAAC,CADRmsB,EAAKpZ,KAAK+V,IAAI/V,KAAKwa,IAAI+hB,GAAShxC,IAAMs0C,EAAK,GAAK,EAAI,GACvCC,GAAK,CAACD,EAAIC,GACzB,KAAO,CACL,IAAIyY,EAASv4C,KAAKs+B,KAAKuB,EAAKt0C,GAE5B0B,EAAO,CAAC,CAAC4yC,EADT9J,EAAK/1B,KAAK+V,IAAI/V,KAAKya,IAAI89B,GAAUhtD,IAAMu0C,EAAK,GAAK,EAAI,IACnC,CAACD,EAAIC,GACzB,CACF,MACE7yC,EAAO,CAAC,CAACmsB,EAAI2c,GAAK,CAACqiB,EAAIC,GAAK,CAACxY,EAAIC,IAGnC,MAAO,CAAEgU,WAAY,CAACnD,GAAY,CAAE1jD,KAAMA,EAAMs+B,UAAW,eAC5D,CA2hB8GitB,CAAeP,GArmB1G,SAAWhF,GAC7B,IAAIhmD,EAAOylD,GAAUO,GACrB,MAAO,CAAEa,WAAY,CAACnD,GAAY,CAAE1jD,KAAMA,EAAMs+B,UAAW,eAC5D,CAkmB+JktB,CAAcR,GACxK,IAAIS,EAAa/K,EACbgL,EAAwBD,EAAW5E,WACnCA,OAAuCvnD,IAA1BosD,EAAsC,GAAKA,EACxDC,EAAqBF,EAAWvF,QAChCA,OAAiC5mD,IAAvBqsD,EAAmC,GAAKA,EAElDC,EAAU/E,EAAW,GAErB+E,IACFA,EAAQxH,MAAMoG,OAASzsD,KAAK4nD,WAAW3gC,MACvC4mC,EAAQxH,MAAMh8B,KAAO,QAEvB,IAAIyjC,EAAU7F,EAAc/gC,KAAOvS,EAAQuS,IACvCA,EAAM,CAAC,EACX,GAAgB,UAAZ4mC,EAAqB,CACvB,IAAI3oC,EAAI0oC,EAAQ5rD,KAAK,GACjBnC,EAAI+tD,EAAQ5rD,KAAK,GACN+S,KAAK0D,KAAK1D,KAAKmE,IAAIgM,EAAE,GAAKrlB,EAAE,GAAI,GAAKkV,KAAKmE,IAAIgM,EAAE,GAAKrlB,EAAE,GAAI,IAC3D,GAAK+tD,EAAQ5rD,KAAK,KAC/BkjB,EAAI0oC,EAAQ5rD,KAAK,IAEnBilB,EAzfa,SAAWi7B,GAC9B,IAAIyF,EAAazF,EAAKyF,WAClB9uC,EAAQqpC,EAAKrpC,MACboO,EAAMi7B,EAAKj7B,IACX6mC,EAAa5L,EAAKhqC,MAClBA,OAAuB5W,IAAfwsD,EAA2B,EAAIA,EAEvClG,EAASD,EAAWjmB,SAItB7oB,EAHGA,EAGK,EAAEoO,EAAI,GAAKpO,EAAM,IAAKoO,EAAI,GAAKpO,EAAM,IAFrC,CAAC8uC,EAAWxuB,GAAIwuB,EAAWvuB,IAIhCnS,IACHA,EAAM,CAAC0gC,EAAWv9C,EAAIw9C,EAAOx9C,EAAGu9C,EAAWhgD,EAAIigD,EAAOjgD,IAGxD,IAAIwmB,EAAKlH,EAAI,GACT6jB,EAAK7jB,EAAI,GAETkS,EAAKtgB,EAAM,GACXugB,EAAKvgB,EAAM,GAEXhD,EAAO,GAAKqC,EACZ61C,EAAc,GAAK,IAAMh5C,KAAKwZ,GAC9B+iB,EAAQv8B,KAAKse,KAAK+F,EAAKD,GAEvBA,EAAK,IACPmY,GAASv8B,KAAKwZ,IAGhB,IAAIvsB,EAAO,CAAC,CAACmsB,EAAI2c,GAAK,CAAC/1B,KAAKwa,IAAI+hB,EAAQyc,GAAel4C,EAAOsY,EAAIpZ,KAAKya,IAAI8hB,EAAQyc,GAAel4C,EAAOi1B,GAAK,CAAC/1B,KAAKwa,IAAI+hB,EAAQyc,GAAel4C,EAAOsY,EAAIpZ,KAAKya,IAAI8hB,EAAQyc,GAAel4C,EAAOi1B,GAAK,CAAC3c,EAAI2c,IAiB3M,MAAO,CACL+d,WAAY,CAACnD,GAAY,CACvB1jD,KAAMA,EACNs+B,UAAW,gCACXulB,QAAS,mBAGd,CAkcamI,CAAe,CACnBrG,WAAY5nD,KAAK4nD,WACjB9uC,MAAOqM,EACP+B,IAAKpnB,EACLqY,MAAO8vC,EAAciG,UAEzB,KAAuB,QAAZJ,EACT5mC,EAvcW,SAAWi7B,GAC5B,IAAI0L,EAAU1L,EAAK1Y,KACfskB,EAAa5L,EAAKhqC,MAClBA,OAAuB5W,IAAfwsD,EAA2B,EAAIA,EAEvCI,EAAM7H,GAAW,CACnB/lB,UAAW,8BACXulB,QAAS,gBACT7jD,KAAM,CAAEixC,OAAQ,EAAIl+B,KAAK0D,KAAKP,MAIhC,OAFAg2C,EAAI9H,MAAM98B,UAAY,aAAeskC,EAAQ5rD,KAAK,GAAG,GAAK,KAAO4rD,EAAQ5rD,KAAK,GAAG,GAAK,IAE/E,CAAE6mD,WAAY,CAACqF,GACvB,CA0baC,CAAa,CAAE3kB,KAAMokB,EAAS11C,MAAO8vC,EAAciG,WAC/CJ,GAAuB,SAAZA,GACrB9tD,KAAK2iD,WAAa3iD,KAAK2iD,UAAU3vC,OAAO,kBAAkBlU,SAc5D,OAXIooB,EAAI4hC,aACN5hC,EAAI4hC,WAAWpmB,QAAQ,SAAU17B,GAC/BA,EAAEq/C,MAAMh8B,KAAO2iC,EAAOpF,WAAW3gC,MACjCjgB,EAAEq/C,MAAMoG,OAASO,EAAOpF,WAAW3gC,KACrC,GACA6hC,EAAaA,EAAWjrD,OAAOqpB,EAAI4hC,aAGjC9oD,KAAKykD,UACgB,IAAnB0D,EAAQ/qD,QAAc0rD,EAAWrsD,KAAK,CAAEgV,KAAM,SAAU02C,QAASA,IAEhEW,CACT,GACC,CACDpgD,IAAK,WACL5H,MAAO,SAASutD,WACd,IAAIC,EAAStuD,KAET2U,EAAU7G,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,CAAC,EAE/EygD,EAAWvuD,KAAK4nD,WAAWhF,KAC3Bt4B,EAAQikC,EAASjkC,OAAS3V,EAAQ2V,OAAS,UAC3CkkC,EAAa,CACf5D,KAAMj2C,EAAQi2C,KACdtgC,MAAOA,EACPu9B,OAAQ7nD,KAAK4nD,WAAWC,QAEtB4G,EAAWF,EAASE,UAAY95C,EAAQ85C,SACxC7L,EAAO,CAAC,EACK,aAAb6L,EAAyB7L,EAxvBhB,SAAWT,GAC5B,IAAI73B,EAAQ63B,EAAK73B,MACb83B,EAASD,EAAK93C,EACdA,OAAe9I,IAAX6gD,EAAuB,EAAIA,EAC/BC,EAASF,EAAKv6C,EACdA,OAAerG,IAAX8gD,EAAuB,EAAIA,EAC/BuI,EAAOzI,EAAKyI,KACZ/C,EAAS1F,EAAK0F,OAIJ,SAFdv9B,EAAQi7B,GAAiBj7B,EAAOu9B,EAAOjgD,IAGrCA,GAAKgjD,EAAK7uB,OACS,WAAVzR,IACT1iB,GAAKgjD,EAAK7uB,OAAS,GAGrB,IAAI95B,EAAO,CAAC,CAACoI,EAAGzC,GAAI,CAACyC,EAAGzC,EAAIgjD,EAAK7uB,SACjC,MAAO,CAAE+sB,WAAY,CAACnD,GAAY,CAAE1jD,KAAMA,EAAMs+B,UAAW,eAC5D,CAquByCmuB,CAAaF,GAAkC,eAAbC,IAA2B7L,EAnuBlF,SAAWT,GAC9B,IAAI73B,EAAQ63B,EAAK73B,MACb83B,EAASD,EAAK93C,EACdA,OAAe9I,IAAX6gD,EAAuB,EAAIA,EAC/BC,EAASF,EAAKv6C,EACdA,OAAerG,IAAX8gD,EAAuB,EAAIA,EAC/BwF,EAAS1F,EAAK0F,OACd+C,EAAOzI,EAAKyI,KAIF,WAFdtgC,EAAQk7B,GAAiBl7B,EAAOu9B,EAAOx9C,IAGrCA,GAAKugD,EAAKngC,MACS,WAAVH,IACTjgB,GAAKugD,EAAKngC,MAAQ,GAGpB,IAAIxoB,EAAO,CAAC,CAACoI,EAAGzC,GAAI,CAACyC,EAAIugD,EAAKngC,MAAO7iB,IACrC,MAAO,CAAEkhD,WAAY,CAACnD,GAAY,CAAE1jD,KAAMA,EAAMs+B,UAAW,eAC5D,CAgtB6GouB,CAAeH,IAEvH,IAAII,EAAQhM,EACRiM,EAAmBD,EAAM9F,WACzBA,OAAkCvnD,IAArBstD,EAAiC,GAAKA,EACnDC,EAAgBF,EAAMzG,QACtBA,OAA4B5mD,IAAlButD,EAA8B,GAAKA,EAMjD,GAJAhG,EAAWpmB,QAAQ,SAAU17B,GAC3BA,EAAEq/C,MAAMoG,OAAS6B,EAAO1G,WAAW3gC,KACrC,GAEIjnB,KAAKykD,SAAU,CACjB0D,EAAUnoD,KAAK0oD,WAAW,CAAC,CAAEr+C,EAAG,EAAGzC,EAAG,EAAGoyC,KAAMh6C,KAAK+uD,SAASjnD,KAAK9H,SAClE8oD,EAAWrsD,KAAK,CAAEgV,KAAM,SAAU02C,QAASA,IAE3C,IAAI6G,EAAWhvD,KAAK+uD,SAASjnD,KAAK9H,MAC9B8Y,EAAQ9Y,KAAKivD,YAAYnnD,KAAK9H,MAC9BknB,EAAMlnB,KAAKkvD,UAAUpnD,KAAK9H,MAC9BA,KAAK4iD,KAAKp/C,KAAKw2C,OAAO1Z,UAAU,wBAAO,iBAAiB51B,QAAQ4G,GAAG,QAAS,SAAUvR,GACpF,OAAO+Y,EAAM/Y,EACf,GAAGuR,GAAG,OAAQ,SAAUvR,GACtB,OAAOivD,EAASjvD,EAClB,GAAGuR,GAAG,MAAO,SAAUvR,GACrB,OAAOmnB,EAAInnB,EACb,GACF,MACEC,KAAK4iD,KAAKtxC,GAAG,iBAAkB,MAEjC,OAAOw3C,CACT,GACC,CACDpgD,IAAK,kBACL5H,MAAO,SAASquD,gBAAgBx6C,GAC9B,IAAI45C,EAAWvuD,KAAK4nD,WAAWhF,KAC3Bv1B,OAA+B9rB,IAArBgtD,EAASlhC,QAAwBkhC,EAASlhC,QAAUrtB,KAAKklD,YACnEkK,EAAcb,EAASa,aAAez6C,EAAQy6C,aAAe,YAC7DX,EAAWF,EAASE,UAAY95C,EAAQ85C,SACxCnkC,EAAQikC,EAASjkC,OAAS3V,EAAQ2V,OAAS,UAE9B,aAAbmkC,EAAyBW,EAAc,YAAkC,eAAbX,IAA2BW,EAAc,aAEzG,IAQIC,EA/4BU,SAAWlN,GAC7B,IAAImN,EAAenN,EAAK90B,QACpBA,OAA2B9rB,IAAjB+tD,EAA6B,EAAIA,EAC3CC,EAAYpN,EAAKyI,KACjBA,OAAqBrpD,IAAdguD,EAA0B,CAAEllD,EAAG,EAAGzC,EAAG,EAAG6iB,MAAO,EAAGsR,OAAQ,GAAMwzB,EACvEjlC,EAAQ63B,EAAK73B,MACb8kC,EAAcjN,EAAKiN,YACnBI,EAAcrN,EAAK0F,OACnBA,OAAyBtmD,IAAhBiuD,EAA4B,CAAEnlD,EAAG,EAAGzC,EAAG,GAAM4nD,EAEtDnlD,GAAKugD,EAAKvgD,EACVzC,EAAI,EA6BR,OA5BmD,IAA/C69C,GAAqBx4C,QAAQmiD,IAC/B9kC,EAAQk7B,GAAiBl7B,EAAOu9B,EAAOx9C,GACnCw9C,EAAOjgD,EAAI,GAAqB,cAAhBwnD,GAA+C,QAAhBA,EACjDxnD,GAAKgjD,EAAK7uB,OAAS1O,EAEnBzlB,GAAKylB,EAGO,WAAV/C,EACFjgB,GAAKugD,EAAKngC,MAAQ,EACC,UAAVH,IACTjgB,GAAKugD,EAAKngC,SAE4C,IAA/Ci7B,GAAqBz4C,QAAQmiD,KACtC9kC,EAAQi7B,GAAiBj7B,EAAOu9B,EAAOjgD,GACnCigD,EAAOx9C,EAAI,GAAqB,cAAhB+kD,GAA+C,SAAhBA,EACjD/kD,GAAKugD,EAAKngC,MAAQ4C,EAElBhjB,GAAKgjB,EAGO,WAAV/C,EACF1iB,GAAKgjD,EAAK7uB,OAAS,EACA,QAAVzR,IACT1iB,GAAKgjD,EAAK7uB,SAIP,CAAE1xB,EAAGA,EAAGzC,EAAGA,EACnB,CAs2B0B6nD,CARJ,CACfpiC,QAASA,EACTu9B,KAAMj2C,EAAQi2C,KACd/C,OAAQ7nD,KAAK4nD,WAAWC,OACxBuH,YAAaA,EACb9kC,MAAOA,IAILjgB,EAAIglD,EAAehlD,EACnBzC,EAAIynD,EAAeznD,EAMvB,OAJA5H,KAAK6pD,cAAgBx/C,EAAIrK,KAAK4nD,WAAWxuB,GACzCp5B,KAAK8pD,cAAgBliD,EAAI5H,KAAK4nD,WAAWvuB,GACzCr5B,KAAK4iD,MAAQ5iD,KAAKypD,YAAYzzC,KAAK,YAAa,aAAe3L,EAAI,KAAOzC,EAAI,KAEvE,EACT,GACC,CACDc,IAAK,eACL5H,MAAO,SAAS4uD,aAAa9F,EAAW+F,GACtC,OAAO3vD,KAAKiqD,UAAUL,EAAW+F,EACnC,GACC,CACDjnD,IAAK,gBACL5H,MAAO,SAASuiD,gBACdrjD,KAAKoqC,SAAWpqC,KAAK0vD,aAAa1vD,KAAKoqC,QAASpqC,KAAK+qD,cACvD,GACC,CACDriD,IAAK,kBACL5H,MAAO,SAAS2iD,kBACdzjD,KAAK2iD,WAAa3iD,KAAK0vD,aAAa1vD,KAAK2iD,UAAW3iD,KAAK+sD,gBAC3D,GACC,CACDrkD,IAAK,aACL5H,MAAO,SAAS4iD,aACd,IAAIkH,EAAO98C,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK9N,KAAK0qD,cAEpF1qD,KAAKypD,aAAezpD,KAAK0vD,aAAa1vD,KAAKypD,YAAazpD,KAAKmvD,gBAAgB,CAAEvE,KAAMA,KACrF5qD,KAAK4iD,MAAQ5iD,KAAK0vD,aAAa1vD,KAAK4iD,KAAM5iD,KAAKquD,SAAS,CAAEzD,KAAMA,IAClE,GACC,CACDliD,IAAK,cACL5H,MAAO,SAASsiD,cACd,IAAIzhB,EAAW3hC,KAAK4nD,WAAWjmB,SAC/B3hC,KAAKU,EAAEsV,KAAK,YAAa,aAAe2rB,EAASt3B,EAAI,KAAOs3B,EAAS/5B,EAAI,IAC3E,GACC,CACDc,IAAK,kBACL5H,MAAO,SAASwiD,kBACdtjD,KAAKoqC,SAAWpqC,KAAKoqC,QAAQp3B,OAAO,KAAKlU,SACzCkB,KAAK2iD,WAAa3iD,KAAK2iD,UAAU3vC,OAAO,KAAKlU,QAE/C,GACC,CACD4J,IAAK,YACL5H,MAAO,SAAS0iD,YACd,GAAIxjD,KAAK4iD,KAAM,CACb,IAAIiF,EAAS7nD,KAAK4nD,WAAWC,OAC7B7nD,KAAK4iD,KAAK5sC,KAAK,YAAa,aAAe6xC,EAAOx9C,EAAI,KAAOw9C,EAAOjgD,EAAI,IAC1E,CACF,GACC,CACDc,IAAK,2BACL5H,MAAO,SAASyjD,yBAAyBJ,GACnCA,GAAankD,KAAK4nD,WAAW3lD,OAC/BjC,KAAK+pD,KAAK5F,GACVnkD,KAAKgqD,KAAK7F,IAEZnkD,KAAKojD,aACP,GACC,CACD16C,IAAK,eACL5H,MAAO,SAAS+iD,eACd7jD,KAAKU,EAAEsV,KAAK,QAAS,eAAiBhW,KAAKugC,WAAavgC,KAAKugC,aAAe,KAAOvgC,KAAKykD,SAAW,WAAa,IAAM,KAAOzkD,KAAK4nD,WAAWrnB,WAAa,IAC5J,GACC,CACD73B,IAAK,OACL5H,MAAO,SAAS8uD,OACd5vD,KAAK6jD,eACL7jD,KAAKojD,cACLpjD,KAAKwjD,YACLxjD,KAAKqjD,gBACLrjD,KAAKyjD,kBACLzjD,KAAK0jD,YACP,GACC,CACDh7C,IAAK,cACL5H,MAAO,SAASmuD,cACd,GAAMj1B,YAAY61B,kBAClB7vD,KAAKwpD,YAAcxpD,KAAKwpD,WAAWhmD,KAAK,YAAaxD,KAAKU,EAAGV,KAAK4nD,YAClE5nD,KAAKU,EAAEyV,QAAQ,YAAY,GAC3BnW,KAAKU,EAAE0S,UAAU,iBAAiBpN,MAAM,iBAAkB,OAC5D,GACC,CACD0C,IAAK,YACL5H,MAAO,SAASouD,YACdlvD,KAAKwpD,YAAcxpD,KAAKwpD,WAAWhmD,KAAK,UAAWxD,KAAKU,EAAGV,KAAK4nD,YAChE5nD,KAAKU,EAAEyV,QAAQ,YAAY,GAC3BnW,KAAKU,EAAE0S,UAAU,iBAAiBpN,MAAM,iBAAkB,MAC5D,GACC,CACD0C,IAAK,cACL5H,MAAO,SAASgsD,cACd,IAAInrB,EAAW3hC,KAAK4nD,WAAWjmB,SAC/BA,EAASt3B,GAAK,GAAM+uB,GACpBuI,EAAS/5B,GAAK,GAAMyxB,GACpBr5B,KAAK4nD,WAAWjmB,SAAWA,CAC7B,GACC,CACDj5B,IAAK,WACL5H,MAAO,SAASiuD,WACd,IAAIlH,EAAS7nD,KAAK4nD,WAAWC,OAC7BA,EAAOx9C,GAAK,GAAM+uB,GAClByuB,EAAOjgD,GAAK,GAAMyxB,GAClBr5B,KAAK4nD,WAAWC,OAASA,CAC3B,GACC,CACDn/C,IAAK,aACL5H,MAAO,SAAS4nD,WAAWP,GACzB,IAAI2H,EAAS9vD,KAEb,OAAOmoD,EAAQlnD,IAAI,SAAUikB,GAC3B,OAAOu8B,GAAS,CAAC,EAAGv8B,EAAG,CACrBpM,MAAOg3C,EAAOb,YAAYnnD,KAAKgoD,GAC/B5oC,IAAK4oC,EAAOZ,UAAUpnD,KAAKgoD,IAE/B,EACF,KAEKvG,IACT,CA5ZW,GA8ZPwG,GAAa,SAASA,WAAWC,EAAaxE,EAAcyE,GAC9D,OAAO,SAAUC,GAGf,SAASH,WAAWI,GAClBlP,eAAejhD,KAAM+vD,YAErB,IAAIK,EAASpO,0BAA0BhiD,MAAO+vD,WAAW3rD,WAAahC,OAAO+B,eAAe4rD,aAAavsD,KAAKxD,KAAMmwD,IAcpH,OAZAC,EAAO5E,aAAeA,EAElBA,EAAa3I,SACf2I,EAAa3I,QAAQngB,QAAQ,SAAU3iC,GACrCqwD,EAAOrwD,IAAMqwD,EAAOrwD,GAAGjB,SAEvBsxD,EAAOrwD,QAAKwB,EACF,SAANxB,IACFqwD,EAAO3G,iBAAcloD,EAEzB,GAEK6uD,CACT,CAwCA,OA5DAvO,SAASkO,WAAYG,GAsBrB9O,GAAY2O,WAAY,CAAC,CACvBrnD,IAAK,YACL5H,MAAO,SAASy/B,YACd,MAAO,IAAMirB,EAAajrB,WAAa,GAAIwvB,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,YAAa1G,OAAS,GAAI+vD,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,YAAa1G,MAAMwD,KAAKxD,OAAS,GACtQ,GACC,CACD0I,IAAK,cACL5H,MAAO,SAASiqD,YAAYp2C,GAE1B,OADA3U,KAAKwrD,aAAaphB,QAAUqX,GAAS,CAAC,EAAG+J,EAAaphB,QAASpqC,KAAKwrD,aAAaphB,SAC1E,GAAI2lB,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,cAAe1G,MAAMwD,KAAKxD,KAAMyhD,GAAS,CAAC,EAAG9sC,EAAS3U,KAAKwrD,aAAaphB,SACpK,GACC,CACD1hC,IAAK,gBACL5H,MAAO,SAASisD,cAAcp4C,GAE5B,OADA3U,KAAKwrD,aAAa7I,UAAYlB,GAAS,CAAC,EAAG+J,EAAa7I,UAAW3iD,KAAKwrD,aAAa7I,WAC9E,GAAIoN,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,gBAAiB1G,MAAMwD,KAAKxD,KAAMyhD,GAAS,CAAC,EAAG9sC,EAAS62C,EAAa7I,UAAW3iD,KAAKwrD,aAAa7I,WAC9L,GACC,CACDj6C,IAAK,WACL5H,MAAO,SAASutD,SAAS15C,GAEvB,OADA3U,KAAKwrD,aAAa5I,KAAOnB,GAAS,CAAC,EAAG+J,EAAa5I,KAAM5iD,KAAKwrD,aAAa5I,MACpE,GAAImN,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,WAAY1G,MAAMwD,KAAKxD,KAAMyhD,GAAS,CAAC,EAAG9sC,EAAS62C,EAAa5I,KAAM5iD,KAAKwrD,aAAa5I,MACpL,GACC,CACDl6C,IAAK,kBACL5H,MAAO,SAASquD,gBAAgBx6C,GAC9B,OAAO,GAAIo7C,WAAWrpD,UAAUtC,WAAahC,OAAO+B,eAAe4rD,WAAWrpD,WAAY,kBAAmB1G,MAAMwD,KAAKxD,KAAMyhD,GAAS,CAAC,EAAG9sC,EAAS62C,EAAa5I,KAAM5iD,KAAKwrD,aAAa5I,MAC3L,IACE,CAAC,CACHl6C,IAAK,OACL5H,MAAO,SAAS+xB,KAAK+0B,EAAYzD,GAK/B,OAJA,GAAI4L,WAAW3rD,WAAahC,OAAO+B,eAAe4rD,YAAa,OAAQ/vD,MAAMwD,KAAKxD,KAAM4nD,EAAYzD,GAChG8L,IACFrI,EAAaqI,EAAMrI,EAAYzD,IAE1ByD,CACT,KAEKmI,UACT,CA9DO,CA8DLC,EACJ,EAEIK,GAAa,SAAUC,GAGzB,SAASD,WAAWp+C,GAClBgvC,eAAejhD,KAAMqwD,YAErB,IAAIE,EAASvO,0BAA0BhiD,MAAOqwD,WAAWjsD,WAAahC,OAAO+B,eAAeksD,aAAa7sD,KAAKxD,KAAMiS,IAIpH,OAFAs+C,EAAOzL,SAAW7yC,EAAO6yC,UAAY,IACrCyL,EAAOvL,WACAuL,CACT,CA+DA,OAzEA1O,SAASwO,WAAYC,GAYrBlP,GAAYiP,WAAY,CAAC,CACvB3nD,IAAK,iBACL5H,MAAO,SAAS+jD,eAAeC,GAC7B9kD,KAAK8kD,SAAWA,EAChB9kD,KAAKglD,UACP,GAIC,CACDt8C,IAAK,WACL5H,MAAO,SAASkkD,WACd,GAAIhlD,KAAK4iD,KAAM,CACb0H,GAAatqD,KAAK4iD,KAAM,CAAC5iD,KAAK4nD,YAAa,IAAK,2BAEhD,IAAI6B,EAAczpD,KAAK4iD,KAAK5vC,OAAO,6BACnCs3C,GAAab,EAAa,CAACzpD,KAAK4nD,YAAa,OAAQ,sBACrD0C,GAAab,EAAa,CAACzpD,KAAK4nD,YAAa,OAAQ,yBACrD0C,GAAab,EAAa,CAACzpD,KAAK4nD,YAAa,OAAQ,yBAErD,IAAI4I,EAAY,CAAEz0B,OAAQ,GACtB00B,EAAQzwD,KAAKU,EAAEsS,OAAO,8BACtB09C,EAAa1wD,KAAK4nD,WAAWhF,MAAQ5iD,KAAK4nD,WAAWhF,KAAKz9C,MAAQnF,KAAKwrD,cAAgBxrD,KAAKwrD,aAAa5I,MAAQ5iD,KAAKwrD,aAAa5I,KAAKz9C,MAAQnF,KAAK8kD,SAErJ6L,EAAe3wD,KAAK4nD,WAAWhF,MAAQ5iD,KAAK4nD,WAAWhF,KAAK+N,cAAgB3wD,KAAKwrD,cAAgBxrD,KAAKwrD,aAAa5I,MAAQ5iD,KAAKwrD,aAAa5I,KAAK+N,aAElJC,EAAY5wD,KAAK4nD,WAAWhF,MAAQ5iD,KAAK4nD,WAAWhF,KAAKgO,WAAa5wD,KAAKwrD,cAAgBxrD,KAAKwrD,aAAa5I,MAAQ5iD,KAAKwrD,aAAa5I,KAAKgO,UAE5IC,EAAiB,CAAEh2B,IAAK,EAAGi2B,OAAQ,EAAG15C,KAAM,EAAGM,MAAO,GAY1D,GAXyB,iBAAdk5C,EACTC,EAAiB,CACfh2B,IAAK+1B,EACLE,OAAQF,EACRx5C,KAAMw5C,EACNl5C,MAAOk5C,GAEAA,GAAuF,iBAApD,IAAdA,EAA4B,YAAc,GAAQA,MAChFC,EAAiBpP,GAASoP,EAAgBD,IAGxC5wD,KAAK4nD,WAAWhF,KAAKmO,MAAO,CAC9B,IAAIA,EAAQ/wD,KAAKU,EAAEsS,OAAO,8BAC1B+9C,EAAM36C,KAAKpW,KAAK4nD,WAAWhF,KAAKmO,OAChCA,EAAM/6C,KAAK,OAAQhW,KAAK4nD,WAAW3gC,OACnC8pC,EAAM/6C,KAAK,cAAe,QAC1B+6C,EAAMvtD,KAAK2B,GAAMurD,EAAYC,GAC7BH,EAAYO,EAAMrmD,OAAOsmD,SAC3B,CAEAP,EAAMr6C,KAAKpW,KAAK4nD,WAAWhF,KAAK6N,OAAOz6C,KAAK,KAAM,KAClDy6C,EAAMjtD,KAAK2B,GAAMurD,EAAYC,GAE7BF,EAAMz6C,KAAK,IAAwB,IAAnBw6C,EAAUz0B,QAAgB,GAC1C00B,EAAMz6C,KAAK,OAAQhW,KAAK4nD,WAAW3gC,OAEnC,IAAI2jC,EAAO5qD,KAAK0qD,cAEhB1qD,KAAKU,EAAEsS,OAAO,2BAA2BgD,KAAK,QAAS40C,EAAKngC,MAAQomC,EAAez5C,KAAOy5C,EAAen5C,OAAO1B,KAAK,SAAU40C,EAAK7uB,OAAS80B,EAAeh2B,IAAMg2B,EAAeC,QAAQ96C,KAAK,IAAK40C,EAAKvgD,EAAIwmD,EAAez5C,MAAMpB,KAAK,KAAM66C,EAAeh2B,KAAK7kB,KAAK,OAAQ,SAASA,KAAK,eAAgB,EAC7S,CACF,KAEKq6C,UACT,CA3EiB,CA2Ef9G,IAEE0H,GAAUlB,GAAWM,GAAY,CACnC9vB,UAAW,QACXqiB,KAAM,CAAEt4B,MAAO,YAGb4mC,GAAYnB,GAAWM,GAAY,CACrC9vB,UAAW,UACXqiB,KAAM,CAAE6L,SAAU,gBAmBhB0C,IAhBiBpB,GAAWmB,GAAW,CACzC3wB,UAAW,gBACXoiB,UAAW,CAAElxC,KAAM,WAGAs+C,GAAWmB,GAAW,CACzC3wB,UAAW,gBACXoiB,UAAW,CAAElxC,KAAM,WAGPs+C,GAAWxG,GAAM,CAC7BhpB,UAAW,QACX6J,QAAS,CAAE34B,KAAM,SACjBoxC,QAAS,CAAC,YAAa,UAGHkN,GAAWM,GAAY,CAC3C9vB,UAAW,iBACX6J,QAAS,CAAE34B,KAAM,UACjBmxC,KAAM,CAAE6L,SAAU,cAClB9L,UAAW,CAAElxC,KAAM,YAGjB2/C,GAAgBrB,GAAWM,GAAY,CACzC9vB,UAAW,eACX6J,QAAS,CAAE34B,KAAM,QACjBmxC,KAAM,CAAE6L,SAAU,cAClB9L,UAAW,CAAElxC,KAAM,WAGjB4/C,GAAe,SAAUC,GAG3B,SAASD,eAEP,OADApQ,eAAejhD,KAAMqxD,cACdrP,0BAA0BhiD,MAAOqxD,aAAajtD,WAAahC,OAAO+B,eAAektD,eAAelqD,MAAMnH,KAAM8N,WACrH,CA2BA,OAhCA+zC,SAASwP,aAAcC,GAOvBlQ,GAAYiQ,aAAc,CAAC,CACzB3oD,IAAK,OACL5H,MAAO,SAASkpD,KAAK7F,GACnB,GAAIkN,aAAa3qD,UAAUtC,WAAahC,OAAO+B,eAAektD,aAAa3qD,WAAY,OAAQ1G,MAAMwD,KAAKxD,KAAMmkD,GAChH,IAAIzjD,EAAIV,KAAK4nD,YACRlnD,EAAE0pC,QAAQhc,IAAM1tB,EAAE0pC,QAAQyK,KAAOn0C,EAAEuB,MAAQkiD,EAAUv8C,IACxDlH,EAAEkH,EAAIu8C,EAAUv8C,EAAElH,EAAEuB,QAEjBvB,EAAE0pC,QAAQhc,KAAM1tB,EAAE0pC,QAAQyK,IAAQn0C,EAAE2J,IACvC3J,EAAE2J,EAAI3J,EAAE0pC,QAAQhc,IAAM1tB,EAAE0pC,QAAQyK,GAEpC,GACC,CACDnsC,IAAK,OACL5H,MAAO,SAASipD,KAAK5F,GACnB,GAAIkN,aAAa3qD,UAAUtC,WAAahC,OAAO+B,eAAektD,aAAa3qD,WAAY,OAAQ1G,MAAMwD,KAAKxD,KAAMmkD,GAChH,IAAIzjD,EAAIV,KAAK4nD,YACRlnD,EAAE0pC,QAAQW,IAAMrqC,EAAE0pC,QAAQ0K,KAAOp0C,EAAEuB,MAAQkiD,EAAU95C,IACxD3J,EAAE2J,EAAI85C,EAAU95C,EAAE3J,EAAEuB,QAEjBvB,EAAE0pC,QAAQW,KAAMrqC,EAAE0pC,QAAQ0K,IAAQp0C,EAAEkH,IACvClH,EAAEkH,EAAIlH,EAAE0pC,QAAQW,IAAMrqC,EAAE0pC,QAAQ0K,GAEpC,KAEKuc,YACT,CAlCmB,CAkCjBH,IAEEK,GAAgBxB,GAAWsB,GAAc,CAC3C9wB,UAAW,sBACX6J,QAAS,CAAE34B,KAAM,eAGf64C,GAAe,SAASA,aAAa5pD,EAAGX,EAAG0R,EAAM8uB,EAAWulB,GAC9D,IAAIr6C,EAAQ/K,EAAE0S,UAAU3B,EAAO,KAAOq0C,GAAWvlB,IAAYt+B,KAAKlC,GAIlE,OAHA0L,EAAMC,QAAQ8I,OAAO/C,GAAMgD,MAAMhJ,GAAOuK,KAAK,QAASuqB,GAEtD90B,EAAME,OAAO7M,SACN4B,CACT,EAEIipD,GAAc,SAASA,YAAYH,EAAY5B,EAAY7D,GAC7D,IAAI6F,EAAY7F,EAAM6F,UAClBrlD,EAAOw/C,EAAMx/C,KAEbqlD,GACFA,EAAUt4C,GAAG,wBAAyB,WACpCk4C,EAAWhmD,KAAKe,EAAO,OAAQqlD,EAAWhC,EAC5C,GAAGt2C,GAAG,uBAAwB,WAC5B,OAAOk4C,EAAWhmD,KAAKe,EAAO,MAAOqlD,EAAWhC,EAClD,GAAGt2C,GAAG,oBAAqB,WACzB,OAAOk4C,EAAWhmD,KAAKe,EAAO,QAASqlD,EAAWhC,EACpD,EAEJ,EAGIziD,GAAO,SAASA,KAAKiR,EAAMqU,EAAOkmC,GACpC,IAAI9uB,EAAa/zB,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,IAErFsI,EAAKL,KAAK,WASR,IARA,IAAIK,EAAO,wBAAOpW,MACdwxD,EAAQp7C,EAAKA,OAAOpH,MAAM2hD,GAAgB,cAActrD,UAAUyF,OAAO,SAAU1F,GACrF,MAAa,KAANA,CACT,GACIqsD,OAAO,EACP5D,EAAU,GACV6D,EAAQt7C,EAAKA,KAAK,MAAM5B,OAAO,SAASwB,KAAK,IAAK,GAAGA,KAAK,KAAM,SAE7Dy7C,EAAOD,EAAMlvD,OAClBurD,EAAQpxD,KAAKg1D,GACbC,EAAMt7C,KAAKy3C,EAAQzsD,KAAK,MACpBswD,EAAMhnD,OAAOinD,wBAA0BlnC,GAASojC,EAAQzwD,OAAS,IACnEywD,EAAQvrD,MACRovD,EAAMt7C,KAAKy3C,EAAQzsD,KAAK,MACxBysD,EAAU,CAAC4D,GACXC,EAAQt7C,EAAK5B,OAAO,SAASwB,KAAK,IAAK,GAAGA,KAAK,KAAM6rB,EAAa,MAAMzrB,KAAKq7C,GAGnF,EACF,EAEI9G,GAAqB,SAASA,mBAAmB53C,GACnD,IAAI5I,EAAW2D,UAAU1Q,OAAS,QAAsBmE,IAAjBuM,UAAU,GAAmBA,UAAU,GAAK,gBAEnF,OAAKiF,EAIEA,EAAUK,UAAUjJ,GAAU0L,QAAQ+7C,OAAO,SAAU5sD,EAAGgC,GAC/D,IAAI4jD,EAAO5jD,EAAEgqD,UACbhsD,EAAEqF,EAAI2K,KAAKC,IAAIjQ,EAAEqF,EAAGugD,EAAKvgD,GACzBrF,EAAE4C,EAAIoN,KAAKC,IAAIjQ,EAAE4C,EAAGgjD,EAAKhjD,GACzB5C,EAAEylB,MAAQzV,KAAK4B,IAAI5R,EAAEylB,MAAOmgC,EAAKngC,OAEjC,IAAIonC,EAAU7qD,GAAKA,EAAErE,YAAcqE,EAAErE,WAAWiF,EAEhD,OADA5C,EAAE+2B,OAAS/mB,KAAK4B,IAAI5R,EAAE+2B,QAAS81B,GAAW7vB,WAAW6vB,EAAQ/wD,QAAU,GAAK8pD,EAAK7uB,QAC1E/2B,CACT,EAAG,CAAEqF,EAAG,EAAGzC,EAAG,EAAG6iB,MAAO,EAAGsR,OAAQ,IAZ1B,CAAE1xB,EAAG,EAAGzC,EAAG,EAAG6iB,MAAO,EAAGsR,OAAQ,EAa3C,EAEA,SAAS6rB,aACP,IAAI1D,EAAc,GACdpkB,OAAa,EACbnrB,OAAU,EAEdkuC,EAAU,GACNsB,EAAY,CAAC,EACbC,EAAmB,CAAC,EACpBK,GAAW,EACXqN,OAAM,EACNrgD,EAAOy/C,GACPpM,OAAW,EACXI,OAAc,EACd6M,EAAuB,GAAS,cAAe,aAAc,eAAgB,gBAAiB,eAAgB,iBAAkB,WAAY,UAAW,YAAa,UAAW,aAC/KC,OAAM,EAENpK,EAAa,SAASA,WAAW70C,GACnCi/C,EAAMj/C,EAED0xC,GACH1xC,EAAUK,UAAU,iBAAiBtU,SAGvC,IAAImzD,EAAwB/N,EAAYjjD,IAAI,SAAUP,GAOpD,OANKA,EAAE+Q,OACL/Q,EAAE+Q,KAAOA,GAEN/Q,EAAEmiD,UACLniD,EAAEmiD,QAAUA,GAEP,IAAIX,GAAWxhD,EACxB,GAEAo/B,EAAaA,GAAc,IAAImkB,GAAqB,CAClDC,YAAa+N,EACb9N,UAAWA,EACXC,iBAAkBA,EAClB0N,IAAKA,IAGW/+C,EAAUK,UAAU,KAAKnR,KAAK,CAAC69B,IACrCp0B,QAAQ8I,OAAO,KAAKwB,KAAK,QAAS,eAE9C,IAAIvK,EAAQsH,EAAUC,OAAO,iBAC7Bs3C,GAAa7+C,EAAOq0B,EAAWokB,YAAa,IAAK,cAEjD,IAAI0D,WAAan8C,EAAM2H,UAAU,gBAEjCw0C,WAAW7xC,KAAK,SAAUhW,GACxB,IAAIW,EAAI,wBAAOV,MAEfU,EAAEsV,KAAK,QAAS,cAEhBs0C,GAAa5pD,EAAG,CAACX,GAAI,IAAK,wBAC1BuqD,GAAa5pD,EAAG,CAACX,GAAI,IAAK,sBAC1BuqD,GAAa5pD,EAAG,CAACX,GAAI,IAAK,mBAC1BuqD,GAAa5pD,EAAEsS,OAAO,qBAAsB,CAACjT,GAAI,IAAK,2BACtDA,EAAE0R,KAA6B,oBAAtB1R,EAAE0R,KAAKzQ,WAAmCjB,EAAE0R,KAAO,IAAI1R,EAAE0R,KAAK,CACrE/Q,EAAGA,EACHknD,WAAY7nD,EACZ+kD,SAAUA,EACVI,YAAaA,EACbT,SAAUA,EACV+E,WAAYuI,EACZ5N,UAAWA,IAEbpkD,EAAE0R,KAAKm+C,OACP7vD,EAAE0R,KAAKuzC,UAAYjlD,EAAE0R,KAAKuzC,UAC5B,EACF,EA8JA,OA5JA4C,EAAW5D,KAAO,WAQhB,OANAxiB,QAAQjI,IAAI,qLAAsLuG,EAAWkkB,MAE7M39C,OAAOmS,KAAKzW,KAAKC,UAAU89B,EAAWkkB,KAAK/iD,IAAI,SAAUP,GAEvD,cADOA,EAAE+Q,KACF/Q,CACT,KACOknD,CACT,EAEAA,EAAWhpD,OAAS,WAOlB,OANIslD,GAAepkB,IACjBokB,EAAcpkB,EAAWokB,YAAYjjD,IAAI,SAAUP,GAEjD,OADAA,EAAE+Q,KAAKm+C,OACAlvD,CACT,IAEKknD,CACT,EAEAA,EAAW7C,WAAa,WAKtB,OAJIjlB,IACFA,EAAWilB,WAAWD,GACtBZ,EAAcpkB,EAAWokB,aAEpB0D,CACT,EAEAA,EAAWsK,iBAAmB,WAG5B,OAFApyB,EAAWykB,2BACXL,EAAcpkB,EAAWokB,YAClB0D,CACT,EAEAA,EAAW/E,QAAU,SAAUvqC,GAC7B,OAAKxK,UAAU1Q,QACfylD,EAAUvqC,EACNwnB,IACFA,EAAW8kB,cAAc/B,GACzBqB,EAAcpkB,EAAWokB,aAEpB0D,GANuB/E,CAOhC,EAEA+E,EAAW9C,SAAW,SAAUxsC,GAC9B,OAAKxK,UAAU1Q,QACf0nD,EAAWxsC,EACPwnB,IACFA,EAAW+kB,eAAeC,GAC1BZ,EAAcpkB,EAAWokB,aAEpB0D,GANuB9C,CAOhC,EAEA8C,EAAW1C,YAAc,SAAU5sC,GACjC,OAAKxK,UAAU1Q,QACf8nD,EAAc5sC,EACVwnB,IACFA,EAAWmlB,kBAAkBC,GAC7BhB,EAAcpkB,EAAWokB,aAEpB0D,GANuB1C,CAOhC,EAEA0C,EAAWn2C,KAAO,SAAU6G,EAAG63C,GAC7B,OAAKriD,UAAU1Q,QACfqU,EAAO6G,EACHwnB,IACFA,EAAWokB,YAAYjjD,IAAI,SAAUP,GACnCA,EAAE+Q,KAAKmxC,MAAQliD,EAAE+Q,KAAKmxC,KAAKxvC,UAAU,mCAAmCtU,SACxE4B,EAAE+Q,KAAKg4C,aAAe/oD,EAAE+Q,KAAKg4C,YAAYr2C,UAAU,KAAKtU,SACxD4B,EAAE+Q,KAAK24B,SAAW1pC,EAAE+Q,KAAK24B,QAAQh3B,UAAU,KAAKtU,SAChD4B,EAAE+Q,KAAKkxC,WAAajiD,EAAE+Q,KAAKkxC,UAAUvvC,UAAU,KAAKtU,SACpD4B,EAAE+Q,KAAK+5C,aAAe,CAAC,EACvB9qD,EAAE+Q,KAAOA,EAET/Q,EAAE0pC,QAAU+lB,GAAYA,EAAS/lB,SAAW1pC,EAAE0pC,QAC9C1pC,EAAEiiD,UAAYwN,GAAYA,EAASxN,WAAajiD,EAAEiiD,UAClDjiD,EAAEkiD,KAAOuN,GAAYA,EAASvN,MAAQliD,EAAEkiD,IAC1C,GAEAsB,EAAcpkB,EAAWokB,aAEpB0D,GAlBuBn2C,CAmBhC,EAEAm2C,EAAW1D,YAAc,SAAU5rC,GACjC,IAAKxK,UAAU1Q,OAAQ,OAAO0iC,GAAcA,EAAWokB,aAAeA,GACtEA,EAAc5rC,EAEVwnB,GAAcA,EAAWokB,eACfA,EAAYiO,KAAK,SAAUpyD,GACrC,OAAQA,EAAE0R,MAA8B,oBAAtB1R,EAAE0R,KAAKzQ,UAC3B,IAGE8+B,EAAa,KACb8nB,EAAWoK,IAEXlyB,EAAWokB,YAAcA,GAG7B,OAAO0D,CACT,EAEAA,EAAWjzC,QAAU,SAAU2D,GAC7B,OAAKxK,UAAU1Q,QACfuX,EAAU2D,EACHsvC,GAFuBjzC,CAGhC,EAEAizC,EAAWzD,UAAY,SAAU7rC,GAC/B,OAAKxK,UAAU1Q,QACf+mD,EAAY7rC,EACLsvC,GAFuBzD,CAGhC,EAEAyD,EAAWxD,iBAAmB,SAAU9rC,GACtC,OAAKxK,UAAU1Q,QACfgnD,EAAmB9rC,EACZsvC,GAFuBxD,CAGhC,EAEAwD,EAAWkK,IAAM,SAAUx5C,GACzB,OAAKxK,UAAU1Q,QACf00D,EAAMx5C,EACCsvC,GAFuBkK,CAGhC,EAEAlK,EAAWnD,SAAW,SAAUnsC,GAC9B,OAAKxK,UAAU1Q,QACfqnD,EAAWnsC,EAEP05C,GACFA,EAAI5+C,UAAU,gBAAgB+C,QAAQ,WAAYsuC,GAGhD3kB,IACFA,EAAW2kB,SAASA,GACpBP,EAAcpkB,EAAWokB,aAEpB0D,GAXuBnD,CAYhC,EAEAmD,EAAW9nB,WAAa,SAAUxnB,GAChC,OAAKxK,UAAU1Q,QACf0iC,EAAaxnB,EACNsvC,GAFuB9nB,CAGhC,EAEA8nB,EAAWt2C,GAAK,WACd,IAAIxQ,EAAQixD,EAAqBzgD,GAAGnK,MAAM4qD,EAAsBjkD,WAChE,OAAOhN,IAAUixD,EAAuBnK,EAAa9mD,CACvD,EAEO8mD,CACT,C,qmBE5kEO,SAASwK,kBAAkBnxD,GAC9B,GAAIA,EAAIoxD,KAAM,CACV,IAAMC,EAAYrxD,EAAIoxD,KAAKr/C,OAAO,kBAAoB/R,EAAI6iC,QAE1DwuB,EAAUl/C,UAAU,mBAAmBtU,SAEvC,IAAMyzD,EAAoBtxD,EAAIuxD,aAE9B,GAAID,EAAmB,CAEnB,IAAME,EAAoB,CACtBC,gBAAiBA,GACjBC,kBAAmBA,GACnBC,sBAAuBA,GACvBC,wBAAyBA,GACzBC,sBAAuBA,IAIrBC,EAAuBR,EAAkBrO,YAAYjjD,IAAI,SAAClB,GAE5D,IAAMizD,EAAiBP,EAAkB1yD,EAAE0R,OAASihD,GACpD,OAAAO,cAAAA,cAAA,GAAYlzD,GAAC,IAAE0R,KAAMuhD,GACzB,GACME,EAAkBtL,aAAan2C,KAAKihD,IAAiBxO,YAAY6O,GAAsBtO,SAAS8N,EAAkB9N,UAGxH6N,EAAU99C,OAAO,KAAKwB,KAAK,KAAM,kBAAkBA,KAAK,QAAS,kBAAkBxS,KAAK0vD,EAC5F,CACJ,CACJ,CC5BO,IAAMC,GAAiB,SAAjBA,eAA2BlyD,EAAKmyD,GAAI,IAAAC,EAAAC,EAExCryD,EAAIsyD,QAAQC,SAAQvyD,EAAIsyD,QAAQC,OAASC,IACzCxyD,EAAIsyD,QAAQG,sBAAqBzyD,EAAIsyD,QAAQG,oBAAsBC,IAGxE1yD,EAAI2yD,oBAAsB3yD,EAAIsyD,QAAQM,gBAAkB5yD,EAAIsyD,QAAQM,gBAAkB7wB,GAGtF,IAAI8wB,EAAWV,EAAGpgD,OAAO,cACrB+gD,EAAkBD,EAASxpD,QAAU8oD,EAAG5+C,OAAO,KAAKwB,KAAK,KAAM,aAAaA,KAAK,QAAS,aAAe89C,EAG9F,QAAXT,EAAApyD,EAAIsyD,eAAO,IAAAF,GAAXA,EAAaxtD,QAA2B,OAAjB5E,EAAI+yD,UAAmBC,GAA8BhzD,EAAK8yD,GAGrF,IAAIG,GAAyB,QAAXZ,EAAAryD,EAAIsyD,eAAO,IAAAD,OAAA,EAAXA,EAAaa,SAAUV,GAAc,GAAD51D,OAAIoD,EAAIyiC,IAAG,KAAA7lC,OAAIoD,EAAImzD,MAAK,QAG9E,GAAIF,EAAa,KAAAG,EAEPC,EAAUj0B,YAAY0zB,EAAiB,oBACvCQ,EAASl0B,YAAY0zB,EAAiB,aAG5C,GAAe,QAAfM,EAAIpzD,EAAIsyD,eAAO,IAAAc,GAAXA,EAAaG,QACCF,EACTlhD,UAAU,QACVnR,KAAKiyD,GACLxoD,QACA8I,OAAO,QACPwB,KAAK,KAAM,SAACjW,GAAC,MAAK,mBAAqBA,EAAEqW,KAAK+U,QAAQ,OAAQ,IAAI,GAClEnV,KAAK,QAAS,SAACjW,GAAC,MAAK,mCAAqCA,EAAC,KAAM,GACjEiW,KAAK,IAAK,SAAUjW,GACjB,OAAIA,EAAEmzB,OACK,EAEJjyB,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAAI,EACvC,GACCoO,KAAK,IAAK,SAAUjW,GACjB,OAAIA,EAAEmzB,OACK,EAEJjyB,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAAI,EACvC,GACCoO,KAAK,MAAO,GACZA,KAAK,YAAa,SAACjW,GAChB,GAAIA,EAAEmzB,OAAQ,CACV,IAAIwhC,EAAMzzD,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAC9ByC,EAAIqqD,EAAI,GACR9sD,EAAI8sD,EAAI,GACZ,MAAO,aAAP72D,OAAoBwM,EAAC,KAAAxM,OAAI+J,EAAC,aAAA/J,OAAYkC,EAAEmzB,OAAM,IAClD,CACI,MAAO,WAEf,GACC9c,KAAK,SAAUrW,GACZ,OAAOA,EAAEqW,IACb,GAIRm+C,EACKnhD,UAAU,QACVnR,KAAKiyD,GACLxoD,QACA8I,OAAO,QACPwB,KAAK,KAAM,SAACjW,GAAC,MAAK,YAAcA,EAAEqW,KAAK+U,QAAQ,OAAQ,IAAI,GAC3DnV,KAAK,QAAS,SAACjW,GAAC,MAAK,qBAAuBA,EAAC,KAAM,GAEnDiW,KAAK,IAAK,SAAUjW,GACjB,OAAIA,EAAEmzB,OACK,EAEJjyB,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAAI,EACvC,GACCoO,KAAK,IAAK,SAAUjW,GACjB,OAAIA,EAAEmzB,OACK,EAEJjyB,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAAI,EACvC,GACCoO,KAAK,MAAO,GAGZA,KAAK,YAAa,SAACjW,GAChB,GAAIA,EAAEmzB,OAAQ,CACV,IAAIwhC,EAAMzzD,EAAIwzD,YAAY,CAAC10D,EAAEsK,EAAGtK,EAAE6H,IAC9ByC,EAAIqqD,EAAI,GACR9sD,EAAI8sD,EAAI,GACZ,MAAO,aAAP72D,OAAoBwM,EAAC,KAAAxM,OAAI+J,EAAC,aAAA/J,OAAYkC,EAAEmzB,OAAM,IAClD,CACI,MAAO,WAEf,GACC9c,KAAK,SAAUrW,GACZ,OAAOA,EAAEqW,IACb,EACR,CACJ,EA0EO,IAwCMu+C,GAAqB,SAArBA,mBAA+B1zD,GAAK,IAAA2zD,EAAAC,EAAAC,EAC7C,GAAK7zD,EAAL,CAMiBA,EAAIoxD,KAAKj/C,UAAU,uBACzBtU,SACOmC,EAAIoxD,KAAKj/C,UAAU,8BACzBtU,SACZ,IAAIi2D,EAAa9zD,EAAIoxD,KAAKj/C,UAAU,mBAG9B4hD,EAA4B,QAAXJ,EAAA3zD,EAAIsyD,eAAO,IAAAqB,GAAXA,EAAaK,yBAAsC,QAAdJ,EAAG5zD,EAAIsyD,eAAO,IAAAsB,OAAA,EAAXA,EAAaI,yBAA2BC,GACjGC,EAAWl0D,EAAIk0D,WAwDrB,OAvDAJ,EACKjqD,OAAO,SAACsqD,GAAE,OAAKJ,EAAeI,EAAIn0D,EAAI,GAEtC8U,KAAK,SAAUhW,GACZ,IAAMiyD,EAAMh/C,WAAOhT,MACbq1D,EAAYC,GAAuBv1D,EAAGo1D,EAAUl0D,GAGlDA,EAAIsyD,QAAQgC,aAOxB,SAASC,WAAWH,EAAW/0B,GAC3B,IAAMm1B,EAAW,EACXC,EAAW,EAGX9K,EAAOtqB,EACR9rB,OAAO,QACPwB,KAAK,aAAc,UACnBI,KAAKi/C,GACL3qD,OACAsmD,UAEC2E,EAAa/K,EAAKngC,MAClBmrC,EAAchL,EAAK7uB,OAGzBuE,EAAUttB,OAAO,6BAA6BlU,SAG9C,IAAMuL,GAAKsrD,EAAa,EAAIF,EACtB7tD,GAAKguD,EAAc,EAAIF,EAG7Bp1B,EACK9rB,OAAO,QACPwB,KAAK,IAAK3L,GACV2L,KAAK,IAAKpO,GACVoO,KAAK,QAAS2/C,EAAa,EAAIF,GAC/Bz/C,KAAK,SAAU4/C,EAAc,EAAIF,GACjC1/C,KAAK,QAAS,sBACvB,CArCqCw/C,CAAWH,EAAWrD,GAGnDA,EAAIx9C,OAAO,QAAQ4B,KAAKi/C,GAAWr/C,KAAK,QAAS,qBACrD,GAoCW,QAAf8+C,EAAI7zD,EAAIsyD,eAAO,IAAAuB,GAAXA,EAAaN,SACbvzD,EAAIoxD,KACCj/C,UAAU,0BACVtI,OAAO,SAACsqD,GAAE,OAAKJ,EAAeI,EAAIn0D,EAAI,GACtCuT,OAAO,QACP4B,KAAK,SAACrW,GAAC,OAAKu1D,GAAuBv1D,EAAGo1D,EAAUl0D,EAAI,GAEtDA,CAnEP,CAFIugC,QAAQq0B,KAAK,mBAsErB,EAOaP,GAAyB,SAAzBA,uBAA0Bv1D,EAAGo1D,EAAUl0D,GAChD,GAAIk0D,SAAYA,GAAAA,EAAUxsD,IAAK,CAC3B,IAAMmtD,EAAKX,EAASxsD,IAAI5I,EAAEg2D,WAAWr5D,IACrC,IAAKo5D,IAAQA,EAAGh1D,OAAgB,IAAPg1D,GAAyB,IAAbA,EAAGh1D,MACpC,MAAO,GAEP,GAAiB,MAAbg1D,EAAGh1D,MACH,OAAOG,EAAI2yD,oBAAsB3yD,EAAI2yD,oBAAoBkC,EAAGh1D,OAASkiC,GAAyB8yB,EAAGh1D,MAG7G,CACJ,EAQMo0D,GAAyB,SAAzBA,uBAA0Bc,EAAQ/0D,GACpC,IACM60D,EADI70D,EAAIk0D,WACDxsD,IAAIqtD,EAAOD,WAAWr5D,IACnC,SAAKo5D,IAAQA,EAAGh1D,OAAgB,IAAPg1D,GAAyB,IAAbA,EAAGh1D,MAK5C,EAEMmzD,GAAgC,SAAhCA,8BAA0ChzD,EAAK8yD,GAAiB,IAAAkC,EAG5DC,EAAO71B,YAAY0zB,EAAiB,0BAGpCoC,EAAkB91B,YAAY0zB,EAAiB,kBAGjDqC,EAAmBn1D,EAAIujC,WAAW6xB,uBAMhCC,EAAkBF,EAAiBtrD,OAAO,SAAC/K,EAAG5C,EAAGZ,GAAI,OAAKY,IAAMZ,EAAKg6D,UAAU,SAAC/1D,GAAC,OAAKA,EAAEu1D,WAAWr5D,KAAOqD,EAAEg2D,WAAWr5D,EAAE,EAAC,GAChIy5D,EACK/iD,UAAU,KACVnR,KAAKq0D,GACL5qD,QACA8I,OAAO,KACPwB,KAAK,YAAa,SAAUjW,GAEzB,GAAIkB,EAAIsyD,QAAQG,oBAAoB3zD,EAAEg2D,WAAWr5D,IAAK,CAClD,IAAMilC,EAAW1gC,EAAIsyD,QAAQG,oBAAoB3zD,EAAEg2D,WAAWr5D,IAC1Dg4D,EAAMzzD,EAAIwzD,YAAY,CAAC9yB,EAASt3B,EAAGs3B,EAAS/5B,IAC5CyC,EAAIqqD,EAAI,GAAGzpC,QAAQ,GACnBrjB,EAAI8sD,EAAI,GAAGzpC,QAAQ,GACvB,MAAO,aAAPptB,OAAoBwM,EAAC,KAAAxM,OAAI+J,EAAC,IAC9B,CACI,IAAIo2B,EAAW/8B,EAAIu1D,cAAcx4B,SAASj+B,GAM1C,OAJIkB,EAAIsyD,QAAQkD,6BACZz4B,EAAW/8B,EAAIsyD,QAAQkD,2BAA2B12D,EAAGi+B,IAGlD,aAAeA,EAAW,GAEzC,GACChoB,KAAK,QAAS,iBAGJ,QAAfigD,EAAIh1D,EAAIsyD,eAAO,IAAA0C,GAAXA,EAAazB,SACb0B,EAAK9iD,UAAU,KACVnR,KAAKm0D,GACL1qD,QACA8I,OAAO,KACPwB,KAAK,YAAa,SAAUjW,GAEzB,GAAIkB,EAAIsyD,QAAQG,oBAAoB3zD,EAAEg2D,WAAWr5D,IAAK,CAClD,IAAIg4D,EAAMzzD,EAAIwzD,YAAY,CACtBxzD,EAAIsyD,QAAQG,oBAAoB3zD,EAAEg2D,WAAWr5D,IAAI2N,EACjDpJ,EAAIsyD,QAAQG,oBAAoB3zD,EAAEg2D,WAAWr5D,IAAIkL,IAEjDyC,EAAIqqD,EAAI,GAAGzpC,QAAQ,GACnBrjB,EAAI8sD,EAAI,GAAGzpC,QAAQ,GACvB,MAAO,aAAPptB,OAAoBwM,EAAC,KAAAxM,OAAI+J,EAAC,IAC9B,CACI,IAAIo2B,EAAW/8B,EAAIu1D,cAAcx4B,SAASj+B,GAM1C,OAJIkB,EAAIsyD,QAAQkD,6BACZz4B,EAAW/8B,EAAIsyD,QAAQkD,2BAA2B12D,EAAGi+B,IAGlD,aAAeA,EAAW,GAEzC,GAEChoB,KAAK,QAAS,uBAE3B,EAOay9C,GAAgB,CACzBiD,SAAU,CACNC,GAAI,CACA,CAAEvgD,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,GACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,GACzD,CAAEM,KAAM,KAAM/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,MAC7C,CAAExgD,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,MAC7C,CAAExgD,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,MAC7C,CAAExgD,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,MAE7C,CAAExgD,KAAM,KAAM/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,QAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,IAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,KAAM9gD,KAAM,IACzD,CAAEM,KAAM,KAAM/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAE7D+gD,GAAI,CACA,CAAEzgD,KAAM,oBAAqB/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAC7F,CAAE1gD,KAAM,iBAAkB/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAC1F,CAAE1gD,KAAM,YAAa/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,IAClE,CAAEM,KAAM,aAAc/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,OAAQ9gD,KAAM,GAAIod,QAAS,IAChF,CAAE9c,KAAM,gBAAiB/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACzF,CAAE1gD,KAAM,YAAa/L,EAAG,KAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACrF,CAAE1gD,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IAC1F,CAAE9c,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IAC1F,CAAE9c,KAAM,WAAYugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAChF,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAC/E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IAC9E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IAC9E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IAC9E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,QAASugD,GAAI,KAAMtsD,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IAC7E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GAC9E,CAAEM,KAAM,YAAaugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GACjF,CAAEM,KAAM,OAAQugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAC5E,CAAEM,KAAM,QAASugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAC7E,CAAEM,KAAM,QAASugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAC7E,CAAEM,KAAM,eAAgBugD,GAAI,KAAMtsD,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACpF,CAAEM,KAAM,cAAeugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACnF,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IAC3F,CAAE9c,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IAC9E,CAAEM,KAAM,WAAYugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IAC7F,CAAE9c,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,KAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GAC9E,CAAEM,KAAM,WAAYugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IAC5F,CAAE9c,KAAM,WAAYugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IAC5F,CAAE9c,KAAM,QAASugD,GAAI,KAAMtsD,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IAC7E,CAAEM,KAAM,SAAUugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IAC3F,CAAE9c,KAAM,cAAeugD,GAAI,KAAMtsD,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACnF,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IAC/E,CAAEM,KAAM,OAAQugD,GAAI,KAAMtsD,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IAC5E,CAAEM,KAAM,UAAWugD,GAAI,KAAMtsD,EAAG,MAASzC,EAAG,MAASgvD,MAAO,cAEhEG,GAAI,CACA,CAAE3gD,KAAM,mBAAoB/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,OAAQ9gD,KAAM,IACzE,CAAEM,KAAM,mBAAoB/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,OAAQ9gD,KAAM,IACzE,CAAEM,KAAM,cAAe/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,IACpE,CAAEM,KAAM,eAAgB/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,OAAQ9gD,KAAM,GAAIod,QAAS,IAClF,CAAE9c,KAAM,iBAAkB/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,IACvE,CAAEM,KAAM,YAAa/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,OAAQ9gD,KAAM,IAClE,CAAEM,KAAM,UAAW/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IAChF,CAAE9c,KAAM,WAAY/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,WAAY/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IACjF,CAAE9c,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,UAAW/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACrE,CAAEM,KAAM,SAAU/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,SAAU/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,YAAa/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IACvE,CAAEM,KAAM,QAAS/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACnE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,UAAW/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,SAAU/L,EAAG,KAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,OAAQ/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAClE,CAAEM,KAAM,QAAS/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACnE,CAAEM,KAAM,QAAS/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACnE,CAAEM,KAAM,eAAgB/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAC1E,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACtE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IAClF,CAAE9c,KAAM,UAAW/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,WAAY/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IACnF,CAAE9c,KAAM,WAAY/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,SAAU/L,EAAG,KAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GACpE,CAAEM,KAAM,YAAa/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IACnF,CAAE9c,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IAClF,CAAE9c,KAAM,UAAW/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,QAAS/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IAChF,CAAE9c,KAAM,SAAU/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACpE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,cAAe/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KAE7EkhD,GAAI,CACA,CAAE5gD,KAAM,aAAc/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACtF,CAAE1gD,KAAM,qBAAsB/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,OAAQ9gD,KAAM,IAC3E,CAAEM,KAAM,UAAW/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,IAChE,CAAEM,KAAM,SAAU/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,OAAQ9gD,KAAM,GAAIod,QAAS,IAC5E,CAAE9c,KAAM,mBAAoB/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,IACzE,CAAEM,KAAM,gBAAiB/L,EAAG,KAASzC,EAAG,KAASgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACzF,CAAE1gD,KAAM,WAAY/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IACjF,CAAE9c,KAAM,aAAc/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACxE,CAAEM,KAAM,UAAW/L,EAAG,KAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,OAAQ,IAChF,CAAE9c,KAAM,YAAa/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACvE,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACtE,CAAEM,KAAM,SAAU/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,aAAc/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACxE,CAAEM,KAAM,WAAY/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GACrE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,aAAc/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IACxE,CAAEM,KAAM,cAAe/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,IACzE,CAAEM,KAAM,eAAgB/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IAC1E,CAAEM,KAAM,SAAU/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,SAAU/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,SAAU/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACpE,CAAEM,KAAM,UAAW/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,OAAQ,IACjF,CAAE9c,KAAM,WAAY/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GACtE,CAAEM,KAAM,UAAW/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GACrE,CAAEM,KAAM,OAAQ/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAClE,CAAEM,KAAM,QAAS/L,EAAG,OAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GACnE,CAAEM,KAAM,QAAS/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACnE,CAAEM,KAAM,iBAAkB/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAC5E,CAAEM,KAAM,cAAe/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACzE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IACnF,CAAE9c,KAAM,QAAS/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,IACnE,CAAEM,KAAM,WAAY/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IACnF,CAAE9c,KAAM,WAAY/L,EAAG,OAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,UAAW/L,EAAG,KAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,GACrE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IAClF,CAAE9c,KAAM,YAAa/L,EAAG,OAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,EAAGod,QAAS,IACnF,CAAE9c,KAAM,UAAW/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACrE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,QAAS,IACnF,CAAE9c,KAAM,UAAW/L,EAAG,KAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GACrE,CAAEM,KAAM,WAAY/L,EAAG,MAASzC,EAAG,KAASgvD,MAAO,YAAa9gD,KAAM,IACtE,CAAEM,KAAM,cAAe/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACzE,CAAEM,KAAM,aAAc/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,MAGhFmhD,SAAU,CACNN,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,iBAAkB/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,KAChFihD,GAAI,CAAC,CAAE3gD,KAAM,oBAAqB/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,KACnFkhD,GAAI,CAAC,CAAE5gD,KAAM,oBAAqB/L,EAAG,KAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,MAEvFohD,SAAU,CACNP,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,MAAQzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,aAAc/L,EAAG,IAAQzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,MAEhFqhD,SAAU,CACNR,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,aAAc/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,MAEhFshD,SAAU,CACNT,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,OAAQgvD,MAAO,KAAM9gD,KAAM,KAC5D+gD,GAAI,CAAC,CAAEzgD,KAAM,SAAU/L,EAAG,OAAQzC,EAAG,OAAQgvD,MAAO,YAAa9gD,KAAM,KACvEkhD,GAAI,CAAC,CAAE5gD,KAAM,UAAW/L,EAAG,OAAQzC,EAAG,OAAQgvD,MAAO,YAAa9gD,KAAM,MAE5EuhD,SAAU,CACNV,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,UAAW/L,EAAG,OAAQzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,MAE7EwhD,SAAU,CACNX,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,UAAW/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,MAE7EyhD,QAAS,CACLZ,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,KAC9D+gD,GAAI,CAAC,CAAEzgD,KAAM,QAAS/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,MAE5E0hD,WAAY,CACRb,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC7D+gD,GAAI,CAAC,CAAEzgD,KAAM,SAAU/L,EAAG,OAAQzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KACxEihD,GAAI,CAAC,CAAE3gD,KAAM,SAAU/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,KACxEkhD,GAAI,CAAC,CAAE5gD,KAAM,SAAU/L,EAAG,OAAQzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,MAE5E2hD,WAAY,CACRd,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,OAAQzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,GAAIod,OAAQ,KACzE2jC,GAAI,CAAC,CAAEzgD,KAAM,UAAW/L,EAAG,OAAQzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,OAAQ,KACrF6jC,GAAI,CAAC,CAAE3gD,KAAM,SAAU/L,EAAG,OAAQzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,GAAIod,OAAQ,MAExFwkC,QAAS,CACLf,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC9D+gD,GAAI,CAAC,CAAEzgD,KAAM,gBAAiB/L,EAAG,QAASzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,KAEpF6hD,QAAS,CACLhB,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC9D+gD,GAAI,CAAC,CAAEzgD,KAAM,UAAW/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KAC1EihD,GAAI,CAAC,CAAE3gD,KAAM,UAAW/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KAC1EkhD,GAAI,CAAC,CAAE5gD,KAAM,SAAU/L,EAAG,QAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,MAE7E8hD,WAAY,CACRjB,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,KAC9D+gD,GAAI,CAAC,CAAEzgD,KAAM,WAAY/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KAC3EkhD,GAAI,CAAC,CAAE5gD,KAAM,cAAe/L,EAAG,MAASzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,KAElF+hD,WAAY,CACRlB,GAAI,CAAC,CAAEvgD,KAAM,KAAM/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,KAAM9gD,KAAM,KAC9D+gD,GAAI,CAAC,CAAEzgD,KAAM,YAAa/L,EAAG,QAASzC,EAAG,QAASgvD,MAAO,YAAa9gD,KAAM,KAEhFgiD,YAAa,CACTnB,GAAI,CACA,CAAEvgD,KAAM,KAAM/L,EAAG,IAAQzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACxD,CAAEM,KAAM,KAAM/L,EAAG,KAAQzC,EAAG,MAASgvD,MAAO,KAAM9gD,KAAM,IACxD,CAAEM,KAAM,KAAM/L,EAAG,KAAQzC,EAAG,OAASgvD,MAAO,KAAM9gD,KAAM,IAE5D+gD,GAAI,CACA,CAAEzgD,KAAM,aAAc/L,EAAG,IAAQzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACvE,CAAEM,KAAM,aAAc/L,EAAG,KAAQzC,EAAG,MAASgvD,MAAO,YAAa9gD,KAAM,IACvE,CAAEM,KAAM,eAAgB/L,EAAG,MAAQzC,EAAG,OAASgvD,MAAO,YAAa9gD,KAAM,KAIjFiiD,YAAa,CACTlB,GAAI,CACA,CAAEzgD,KAAM,iBAAkB/L,GAAI,GAAIzC,EAAG,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACjF,CAAE1gD,KAAM,iBAAkB/L,GAAI,GAAIzC,GAAI,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAClF,CAAE1gD,KAAM,gBAAiB/L,GAAI,IAAKzC,GAAI,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAClF,CAAE1gD,KAAM,QAAS/L,GAAI,IAAKzC,EAAG,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GACzE,CAAE1gD,KAAM,UAAW/L,GAAI,IAAKzC,EAAG,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAC3E,CAAE1gD,KAAM,eAAgB/L,EAAG,GAAIzC,GAAI,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,GAC/E,CAAE1gD,KAAM,iBAAkB/L,GAAI,EAAGzC,GAAI,GAAIgvD,MAAO,OAAQ9gD,KAAM,GAAIghD,cAAe,MAKvFnD,GAA4B,CAC9BqE,GAAI,CAAE3tD,EAAG,MAASzC,EAAG,KACrBqwD,GAAI,CAAE5tD,EAAG,MAASzC,EAAG,OACrBswD,GAAI,CAAE7tD,EAAG,MAASzC,EAAG,OACrBuwD,GAAI,CAAE9tD,EAAG,OAASzC,EAAG,MACrBwwD,GAAI,CAAE/tD,EAAG,QAASzC,EAAG,SACrBywD,GAAI,CAAEhuD,EAAG,OAASzC,EAAG,OACrB0wD,GAAI,CAAEjuD,EAAG,MAASzC,EAAG,MACrB2wD,GAAI,CAAEluD,EAAG,OAASzC,EAAG,OACrB4wD,GAAI,CAAEnuD,EAAG,OAASzC,EAAG,QACrB6wD,GAAI,CAAEpuD,EAAG,MAASzC,EAAG,OACrB8wD,GAAI,CAAEruD,EAAG,MAASzC,EAAG,QACrB+wD,GAAI,CAAEtuD,EAAG,QAASzC,EAAG,SACrBgxD,GAAI,CAAEvuD,EAAG,QAASzC,EAAG,SACrBixD,GAAI,CAAExuD,EAAG,MAASzC,EAAG,OACrBkxD,GAAI,CAAEzuD,EAAG,MAASzC,EAAG,OACrBmxD,GAAI,CAAE1uD,EAAG,MAASzC,EAAG,QACrBoxD,GAAI,CAAE3uD,EAAG,OAASzC,EAAG,QACrBqxD,GAAI,CAAE5uD,EAAG,KAASzC,EAAG,SACrBsxD,GAAI,CAAE7uD,EAAG,MAASzC,EAAG,OACrBuxD,GAAI,CAAE9uD,EAAG,MAASzC,EAAG,OACrBwxD,GAAI,CAAE/uD,EAAG,MAASzC,EAAG,OACrByxD,GAAI,CAAEhvD,EAAG,MAASzC,EAAG,OACrB0xD,GAAI,CAAEjvD,EAAG,QAASzC,EAAG,SACrB2xD,GAAI,CAAElvD,EAAG,QAASzC,EAAG,SACrB4xD,GAAI,CAAEnvD,EAAG,QAASzC,EAAG,SACrB6xD,GAAI,CAAEpvD,EAAG,QAASzC,EAAG,SACrB8xD,GAAI,CAAErvD,EAAG,OAASzC,EAAG,OACrB+xD,GAAI,CAAEtvD,EAAG,KAASzC,EAAG,OACrBgyD,GAAI,CAAEvvD,EAAG,MAASzC,EAAG,QACrBiyD,GAAI,CAAExvD,EAAG,KAASzC,EAAG,QACrBkyD,GAAI,CAAEzvD,EAAG,OAASzC,EAAG,MACrBmyD,GAAI,CAAE1vD,EAAG,MAASzC,EAAG,OACrBoyD,GAAI,CAAE3vD,EAAG,OAASzC,EAAG,MACrBqyD,GAAI,CAAE5vD,EAAG,KAASzC,EAAG,OACrBsyD,GAAI,CAAE7vD,EAAG,MAASzC,EAAG,OACrBuyD,GAAI,CAAE9vD,EAAG,MAASzC,EAAG,OACrBwyD,GAAI,CAAE/vD,EAAG,KAASzC,EAAG,KACrByyD,GAAI,CAAEhwD,EAAG,MAASzC,EAAG,KACrB0yD,GAAI,CAAEjwD,EAAG,MAASzC,EAAG,MACrB2yD,GAAI,CAAElwD,EAAG,OAASzC,EAAG,OACrB4yD,GAAI,CAAEnwD,EAAG,QAASzC,EAAG,UC7sBzB,SAAS6yD,aAAaC,GACpB,IAAKA,EAASC,GAAI,MAAM,IAAIl0D,MAAMi0D,EAASE,OAAS,IAAMF,EAASG,YACnE,GAAwB,MAApBH,EAASE,QAAsC,MAApBF,EAASE,OACxC,OAAOF,EAAS1W,MAClB,CAEe,cAASr6B,EAAOkJ,GAC7B,OAAOioC,MAAMnxC,EAAOkJ,GAAMjyB,KAAK65D,aACjC,CCRe,sCAASpwD,GACtB,OAAOA,CACT,CCCe,iBAAS0wD,EAAUt6D,GAEhC,MADiB,iBAANA,IAAgBA,EAAIs6D,EAASC,QAAQv6D,IAC9B,uBAAXA,EAAEgR,KACH,CAACA,KAAM,oBAAqB21B,SAAU3mC,EAAEwnC,WAAWhnC,IAAI,SAASR,GAAK,OAAO,gBAAQs6D,EAAUt6D,EAAI,IAClG,gBAAQs6D,EAAUt6D,EAC1B,CAEA,SAAS,gBAAQs6D,EAAUt6D,GACzB,IAAI/D,EAAK+D,EAAE/D,GACPkuD,EAAOnqD,EAAEmqD,KACTmL,EAA6B,MAAhBt1D,EAAEs1D,WAAqB,CAAC,EAAIt1D,EAAEs1D,WAC3C/vB,EAMC,SAAS,eAAO+0B,EAAUt6D,GAC/B,IAAIw6D,ECnBS,uCAAS1xC,GACtB,GAAiB,MAAbA,EAAmB,OAAO,6BAC9B,IAAI4E,EACAyQ,EACAs8B,EAAK3xC,EAAUpR,MAAM,GACrBgjD,EAAK5xC,EAAUpR,MAAM,GACrBihB,EAAK7P,EAAUqK,UAAU,GACzByF,EAAK9P,EAAUqK,UAAU,GAC7B,OAAO,SAASjK,EAAOxsB,GAChBA,IAAGgxB,EAAKyQ,EAAK,GAClB,IAAIptB,EAAI,EAAGlR,EAAIqpB,EAAMvsB,OAAQssB,EAAS,IAAIpgB,MAAMhJ,GAGhD,IAFAopB,EAAO,IAAMyE,GAAMxE,EAAM,IAAMuxC,EAAK9hC,EACpC1P,EAAO,IAAMkV,GAAMjV,EAAM,IAAMwxC,EAAK9hC,EAC7B7nB,EAAIlR,GAAGopB,EAAOlY,GAAKmY,EAAMnY,KAAMA,EACtC,OAAOkY,CACT,CACF,CDGuB,CAAUqxC,EAASxxC,WACpC6xC,EAAOL,EAASK,KAEpB,SAASrsB,IAAI5xC,EAAG2sC,GACVA,EAAO1sC,QAAQ0sC,EAAOxnC,MAC1B,IAAK,IAAI5B,EAAI06D,EAAKj+D,EAAI,GAAKA,EAAIA,GAAI+C,EAAI,EAAGI,EAAII,EAAEtD,OAAQ8C,EAAII,IAAKJ,EAC/D4pC,EAAOrtC,KAAKw+D,EAAev6D,EAAER,GAAIA,IAE/B/C,EAAI,GE7BG,iBAASiN,EAAO9J,GAE7B,IADA,IAAIE,EAAGgR,EAAIpH,EAAMhN,OAAQD,EAAIqU,EAAIlR,EAC1BnD,IAAMqU,GAAGhR,EAAI4J,EAAMjN,GAAIiN,EAAMjN,KAAOiN,EAAMoH,GAAIpH,EAAMoH,GAAKhR,CAClE,CF0Be6E,CAAQykC,EAAQxpC,EAC7B,CAEA,SAAS85B,MAAMp1B,GACb,OAAOi2D,EAAej2D,EACxB,CAEA,SAASykC,KAAK2xB,GAEZ,IADA,IAAItxB,EAAS,GACJ3sC,EAAI,EAAGmD,EAAI86D,EAAKh+D,OAAQD,EAAImD,IAAKnD,EAAG4xC,IAAIqsB,EAAKj+D,GAAI2sC,GAE1D,OADIA,EAAO1sC,OAAS,GAAG0sC,EAAOrtC,KAAKqtC,EAAO,IACnCA,CACT,CAEA,SAAS2B,KAAK2vB,GAEZ,IADA,IAAItxB,EAASL,KAAK2xB,GACXtxB,EAAO1sC,OAAS,GAAG0sC,EAAOrtC,KAAKqtC,EAAO,IAC7C,OAAOA,CACT,CAEA,SAAS0B,QAAQ4vB,GACf,OAAOA,EAAKn6D,IAAIwqC,KAClB,CAEA,SAASzF,SAASvlC,GAChB,IAAmB+mC,EAAf/1B,EAAOhR,EAAEgR,KACb,OAAQA,GACN,IAAK,qBAAsB,MAAO,CAACA,KAAMA,EAAMw2B,WAAYxnC,EAAEwnC,WAAWhnC,IAAI+kC,WAC5E,IAAK,QAASwB,EAAcpN,MAAM35B,EAAE+mC,aAAc,MAClD,IAAK,aAAcA,EAAc/mC,EAAE+mC,YAAYvmC,IAAIm5B,OAAQ,MAC3D,IAAK,aAAcoN,EAAciC,KAAKhpC,EAAE26D,MAAO,MAC/C,IAAK,kBAAmB5zB,EAAc/mC,EAAE26D,KAAKn6D,IAAIwoC,MAAO,MACxD,IAAK,UAAWjC,EAAcgE,QAAQ/qC,EAAE26D,MAAO,MAC/C,IAAK,eAAgB5zB,EAAc/mC,EAAE26D,KAAKn6D,IAAIuqC,SAAU,MACxD,QAAS,OAAO,KAElB,MAAO,CAAC/5B,KAAMA,EAAM+1B,YAAaA,EACnC,CAEA,OAAOxB,SAASvlC,EAClB,CAvDiB,CAAOs6D,EAAUt6D,GAChC,OAAa,MAAN/D,GAAsB,MAARkuD,EAAe,CAACn5C,KAAM,UAAWskD,WAAYA,EAAY/vB,SAAUA,GAC1E,MAAR4kB,EAAe,CAACn5C,KAAM,UAAW/U,GAAIA,EAAIq5D,WAAYA,EAAY/vB,SAAUA,GAC3E,CAACv0B,KAAM,UAAW/U,GAAIA,EAAIkuD,KAAMA,EAAMmL,WAAYA,EAAY/vB,SAAUA,EAChF,CGjBO,IAAMq1B,GAAmB,CAC9B,KAAK,CACH,KAAM,CACJ,MAAM,CAAC,KAAO,WAAW,KAAO,CAAC,CAAC,CAAC,KAAK,MAAM,EAAE,KAAK,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,KAAK,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC,KAAK,GAAG,EAAE,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,GAAG,IAAI,CAAC,EAAE,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,KAAK,CAAC,IAAI,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,MAAM,CAAC,CAAC,IAAI,MAAM,EAAE,KAAK,IAAI,EAAE,IAAI,GAAG,EAAE,IAAI,KAAK,EAAE,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,KAAK,EAAE,IAAI,IAAI,EAAE,IAAI,GAAG,EAAE,IAAI,KAAK,EAAE,IAAI,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,CAAC,KAAK,KAAK,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,KAAK,CAAC,CAAC,KAAK,MAAM,EAAE,IAAI,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,KAAK,MAAM,EAAE,KAAK,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,KAAK,EAAE,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,KAAK,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,MAAM,UAAY,CAAC,MAAQ,CAAC,mBAAmB,mBAAmB,UAAY,CAAC,kBAAkB,qBAAqB,QAAU,CAAC,SAAW,CAAC,KAAO,qBAAqB,WAAa,CAAC,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,UACnlD,MAAM,CAAC,KAAO,WAAW,KAAO,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,KAAK,EAAE,GAAG,KAAK,CAAC,CAAC,KAAK,KAAK,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,CAAC,CAAC,IAAI,KAAK,EAAE,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,GAAG,IAAI,EAAE,GAAG,MAAM,UAAY,CAAC,MAAQ,CAAC,kBAAkB,oBAAoB,UAAY,CAAC,kBAAkB,qBAAqB,QAAU,CAAC,SAAW,CAAC,KAAO,qBAAqB,WAAa,CAAC,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,UACrjC,MAAM,CAAC,KAAO,WAAW,KAAO,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,GAAG,MAAM,UAAY,CAAC,MAAQ,CAAC,mBAAmB,oBAAoB,UAAY,CAAC,kBAAkB,qBAAqB,QAAU,CAAC,SAAW,CAAC,KAAO,qBAAqB,WAAa,CAAC,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,UACh+B,MAAM,CAAC,KAAO,WAAW,KAAO,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,KAAK,CAAC,CAAC,GAAG,KAAK,EAAE,IAAI,MAAM,CAAC,CAAC,IAAI,KAAK,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,OAAO,UAAY,CAAC,MAAQ,CAAC,mBAAmB,oBAAoB,UAAY,CAAC,kBAAkB,qBAAqB,QAAU,CAAC,SAAW,CAAC,KAAO,qBAAqB,WAAa,CAAC,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,MAAM,CAAC,KAAO,aAAa,KAAO,CAAC,GAAG,WAAa,CAAC,GAAK,QAAQ,IAAM,EAAE,GAAK,IAAI,KAAO,IAAI,GAAK,IAAI,IAAM,IAAI,GAAK,WAE34B,KAAM,CACJ,MAAM,CAAC,KAAO,WAAW,KAAO,CAAC,CAAC,CAAC,KAAK,MAAM,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC,KAAK,MAAM,EAAE,IAAI,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,GAAG,KAAK,CAAC,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,IAAI,KAAK,CAAC,CAAC,IAAI,MAAM,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,IAAI,EAAE,GAAG,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,GAAG,EAAE,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,MAAM,EAAE,IAAI,IAAI,EAAE,IAAI,GAAG,EAAE,IAAI,IAAI,EAAE,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,GAAG,IAAI,EAAE,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC,KAAK,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,MAAM,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,KAAK,MAAM,EAAE,KAAK,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,KAAK,GAAG,EAAE,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,EAAE,GAAG,KAAK,CAAC,IAAI,KAAK,EAAE,EAA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","sources":["webpack://eurostatmap/webpack/universalModuleDefinition","webpack://eurostatmap/./src/css/map-types/flow.css","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://eurostatmap/./src/css/spinner.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/OverloadYield.js","webpack://eurostatmap/./src/css/legend/ternary.css","webpack://eurostatmap/./src/css/legend/flow.css","webpack://eurostatmap/./src/css/index.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorAsync.js","webpack://eurostatmap/./src/css/map-types/proportional-symbol.css","webpack://eurostatmap/./src/css/legend/spike.css","webpack://eurostatmap/./src/css/legend/legend.css","webpack://eurostatmap/./node_modules/css-loader/dist/runtime/api.js","webpack://eurostatmap/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://eurostatmap/./src/css/minimap.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorKeys.js","webpack://eurostatmap/./src/css/legend/pie.css","webpack://eurostatmap/./src/css/map-types/coxcomb.css","webpack://eurostatmap/./src/css/labels.css","webpack://eurostatmap/./src/css/placenames.css","webpack://eurostatmap/./src/css/legend/bivariate-choropleth.css","webpack://eurostatmap/./src/css/map.css","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorDefine.js","webpack://eurostatmap/./src/css/map-types/sparkline.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorValues.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://eurostatmap/./src/css/tooltip.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/typeof.js","webpack://eurostatmap/./node_modules/@babel/runtime/regenerator/index.js","webpack://eurostatmap/./src/css/ui.css","webpack://eurostatmap/./src/css/map-types/alpha.css","webpack://eurostatmap/./src/css/map-types/pie.css","webpack://eurostatmap/./src/css/annotations.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorAsyncIterator.js","webpack://eurostatmap/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://eurostatmap/./src/css/insets.css","webpack://eurostatmap/./src/css/world.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regeneratorAsyncGen.js","webpack://eurostatmap/./src/css/legend/coxcomb.css","webpack://eurostatmap/./src/css/NUTS.css","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/regenerator.js","webpack://eurostatmap/webpack/bootstrap","webpack://eurostatmap/webpack/runtime/compat get default export","webpack://eurostatmap/webpack/runtime/define property getters","webpack://eurostatmap/webpack/runtime/get javascript chunk filename","webpack://eurostatmap/webpack/runtime/hasOwnProperty shorthand","webpack://eurostatmap/webpack/runtime/make namespace object","webpack://eurostatmap/webpack/runtime/publicPath","webpack://eurostatmap/webpack/runtime/jsonp chunk loading","webpack://eurostatmap/webpack/runtime/nonce","webpack://eurostatmap/./src/css/index.css?f7ea","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://eurostatmap/./node_modules/d3-selection/src/selector.js","webpack://eurostatmap/./node_modules/d3-selection/src/array.js","webpack://eurostatmap/./node_modules/d3-selection/src/selectorAll.js","webpack://eurostatmap/./node_modules/d3-selection/src/matcher.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/selectChild.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/selectChildren.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/sparse.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/enter.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/data.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/sort.js","webpack://eurostatmap/./node_modules/d3-selection/src/namespaces.js","webpack://eurostatmap/./node_modules/d3-selection/src/namespace.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/attr.js","webpack://eurostatmap/./node_modules/d3-selection/src/window.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/style.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/property.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/classed.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/text.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/html.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/raise.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/lower.js","webpack://eurostatmap/./node_modules/d3-selection/src/creator.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/insert.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/remove.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/clone.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/on.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/dispatch.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/index.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/select.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/selectAll.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/filter.js","webpack://eurostatmap/./node_modules/d3-selection/src/constant.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/exit.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/join.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/merge.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/order.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/call.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/nodes.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/node.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/size.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/empty.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/each.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/append.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/datum.js","webpack://eurostatmap/./node_modules/d3-selection/src/selection/iterator.js","webpack://eurostatmap/./node_modules/d3-selection/src/select.js","webpack://eurostatmap/./node_modules/d3-array/src/min.js","webpack://eurostatmap/./node_modules/d3-array/src/max.js","webpack://eurostatmap/./node_modules/d3-array/src/number.js","webpack://eurostatmap/./node_modules/d3-array/src/quantile.js","webpack://eurostatmap/./node_modules/d3-array/src/ascending.js","webpack://eurostatmap/./node_modules/d3-array/src/descending.js","webpack://eurostatmap/./node_modules/d3-array/src/bisector.js","webpack://eurostatmap/./node_modules/d3-array/src/bisect.js","webpack://eurostatmap/./node_modules/d3-scale/src/init.js","webpack://eurostatmap/./node_modules/d3-scale/src/quantile.js","webpack://eurostatmap/./node_modules/d3-array/src/ticks.js","webpack://eurostatmap/./node_modules/d3-color/src/define.js","webpack://eurostatmap/./node_modules/d3-color/src/color.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/basis.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/constant.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/color.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/rgb.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/basisClosed.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/array.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/date.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/number.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/object.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/string.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/numberArray.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/value.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/round.js","webpack://eurostatmap/./node_modules/d3-scale/src/number.js","webpack://eurostatmap/./node_modules/d3-scale/src/continuous.js","webpack://eurostatmap/./node_modules/d3-scale/src/constant.js","webpack://eurostatmap/./node_modules/d3-format/src/formatSpecifier.js","webpack://eurostatmap/./node_modules/d3-format/src/formatPrefixAuto.js","webpack://eurostatmap/./node_modules/d3-format/src/formatDecimal.js","webpack://eurostatmap/./node_modules/d3-format/src/exponent.js","webpack://eurostatmap/./node_modules/d3-format/src/formatRounded.js","webpack://eurostatmap/./node_modules/d3-format/src/formatTypes.js","webpack://eurostatmap/./node_modules/d3-format/src/identity.js","webpack://eurostatmap/./node_modules/d3-format/src/locale.js","webpack://eurostatmap/./node_modules/d3-format/src/defaultLocale.js","webpack://eurostatmap/./node_modules/d3-format/src/formatGroup.js","webpack://eurostatmap/./node_modules/d3-format/src/formatNumerals.js","webpack://eurostatmap/./node_modules/d3-format/src/formatTrim.js","webpack://eurostatmap/./node_modules/d3-scale/src/tickFormat.js","webpack://eurostatmap/./node_modules/d3-format/src/precisionPrefix.js","webpack://eurostatmap/./node_modules/d3-format/src/precisionRound.js","webpack://eurostatmap/./node_modules/d3-format/src/precisionFixed.js","webpack://eurostatmap/./node_modules/d3-scale/src/linear.js","webpack://eurostatmap/./node_modules/d3-scale/src/quantize.js","webpack://eurostatmap/./node_modules/d3-scale/src/threshold.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/colors.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/ramp.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/sequential-multi/YlGnBu.js","webpack://eurostatmap/./node_modules/d3-color/src/math.js","webpack://eurostatmap/./node_modules/d3-color/src/lab.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/lab.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://eurostatmap/./node_modules/d3-dispatch/src/dispatch.js","webpack://eurostatmap/./node_modules/d3-timer/src/timer.js","webpack://eurostatmap/./node_modules/d3-timer/src/timeout.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/schedule.js","webpack://eurostatmap/./node_modules/d3-transition/src/interrupt.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/transform/decompose.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/transform/parse.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/transform/index.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/tween.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/interpolate.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/attr.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/attrTween.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/delay.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/duration.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/selection.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/style.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/index.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/select.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/selectAll.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/filter.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/merge.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/transition.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/on.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/styleTween.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/text.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/textTween.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/remove.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/ease.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/easeVarying.js","webpack://eurostatmap/./node_modules/d3-transition/src/transition/end.js","webpack://eurostatmap/./node_modules/d3-transition/src/selection/transition.js","webpack://eurostatmap/./node_modules/d3-ease/src/cubic.js","webpack://eurostatmap/./node_modules/d3-transition/src/selection/index.js","webpack://eurostatmap/./node_modules/d3-transition/src/selection/interrupt.js","webpack://eurostatmap/./node_modules/d3-brush/src/brush.js","webpack://eurostatmap/./node_modules/d3-drag/src/noevent.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/zoom.js","webpack://eurostatmap/./node_modules/d3-selection/src/pointer.js","webpack://eurostatmap/./node_modules/d3-selection/src/sourceEvent.js","webpack://eurostatmap/./node_modules/d3-zoom/src/constant.js","webpack://eurostatmap/./node_modules/d3-zoom/src/event.js","webpack://eurostatmap/./node_modules/d3-zoom/src/transform.js","webpack://eurostatmap/./node_modules/d3-zoom/src/noevent.js","webpack://eurostatmap/./node_modules/d3-zoom/src/zoom.js","webpack://eurostatmap/./node_modules/d3-drag/src/nodrag.js","webpack://eurostatmap/./src/core/utils.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://eurostatmap/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://eurostatmap/./node_modules/d3-selection/src/selectAll.js","webpack://eurostatmap/./node_modules/d3-array/src/fsum.js","webpack://eurostatmap/./node_modules/d3-geo/src/math.js","webpack://eurostatmap/./node_modules/d3-geo/src/noop.js","webpack://eurostatmap/./node_modules/d3-geo/src/stream.js","webpack://eurostatmap/./node_modules/d3-geo/src/centroid.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/buffer.js","webpack://eurostatmap/./node_modules/d3-geo/src/pointEqual.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/rejoin.js","webpack://eurostatmap/./node_modules/d3-array/src/merge.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/rectangle.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/line.js","webpack://eurostatmap/./node_modules/d3-geo/src/identity.js","webpack://eurostatmap/./node_modules/d3-geo/src/transform.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/bounds.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/fit.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/area.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/centroid.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/context.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/measure.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/string.js","webpack://eurostatmap/./node_modules/d3-geo/src/path/index.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/noop.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/buffer.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/math.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/pointEqual.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/rejoin.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-array/src/fsum.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/cartesian.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/polygonContains.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-array/src/merge.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/index.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/antimeridian.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/circle.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/rectangle.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/line.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/compose.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/identity.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/rotation.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/transform.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/stream.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/path/bounds.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/projection/fit.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/projection/resample.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/projection/index.js","webpack://eurostatmap/./node_modules/d3-geo-projection/node_modules/d3-geo/src/clip/circle.js","webpack://eurostatmap/./node_modules/d3-geo-projection/src/math.js","webpack://eurostatmap/./node_modules/d3-geo-projection/src/robinson.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/namespaces.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/namespace.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/creator.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selector.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selectorAll.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/sparse.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/enter.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/data.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/sort.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/attr.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/window.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/style.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/property.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/classed.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/text.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/html.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/raise.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/lower.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/insert.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/remove.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/clone.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/on.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/dispatch.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/index.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/select.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/selectAll.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/filter.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/matcher.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/constant.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/exit.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/join.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/merge.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/order.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/call.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/nodes.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/node.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/size.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/empty.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/each.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/append.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/selection/datum.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/select.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/local.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/sourceEvent.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/point.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/mouse.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-selection/src/touch.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-dispatch/src/dispatch.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-drag/src/noevent.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-drag/src/constant.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-drag/src/event.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-drag/src/drag.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-drag/src/nodrag.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-path/src/path.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/constant.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/math.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/arc.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/linear.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/point.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/radial.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/symbol/diamond.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/symbol/star.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/symbol/triangle.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/symbol/wye.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/noop.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/basis.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/basisClosed.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/basisOpen.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/bundle.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/cardinal.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/cardinalClosed.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/cardinalOpen.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/catmullRom.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/catmullRomClosed.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/catmullRomOpen.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/linearClosed.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/monotone.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/natural.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/curve/step.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/array.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/indexRollupNext.js","webpack://eurostatmap/./node_modules/d3-svg-annotation/node_modules/d3-shape/src/line.js","webpack://eurostatmap/./src/core/annotations.js","webpack://eurostatmap/./src/core/labels.js","webpack://eurostatmap/./node_modules/d3-fetch/src/json.js","webpack://eurostatmap/./node_modules/topojson-client/src/identity.js","webpack://eurostatmap/./node_modules/topojson-client/src/feature.js","webpack://eurostatmap/./node_modules/topojson-client/src/transform.js","webpack://eurostatmap/./node_modules/topojson-client/src/reverse.js","webpack://eurostatmap/./src/core/kosovo.js","webpack://eurostatmap/./node_modules/d3-array/src/range.js","webpack://eurostatmap/./node_modules/d3-geo/src/graticule.js","webpack://eurostatmap/./node_modules/idb-keyval/dist/index.js","webpack://eurostatmap/./src/core/geometries.js","webpack://eurostatmap/./src/core/insets.js","webpack://eurostatmap/./src/core/stamps.js","webpack://eurostatmap/./node_modules/d3-dsv/src/dsv.js","webpack://eurostatmap/./node_modules/d3-dsv/src/csv.js","webpack://eurostatmap/./src/core/cartograms.js","webpack://eurostatmap/./node_modules/d3-geo/src/cartesian.js","webpack://eurostatmap/./node_modules/d3-geo/src/polygonContains.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/index.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/antimeridian.js","webpack://eurostatmap/./node_modules/d3-geo/src/circle.js","webpack://eurostatmap/./node_modules/d3-geo/src/compose.js","webpack://eurostatmap/./node_modules/d3-geo/src/rotation.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/resample.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/index.js","webpack://eurostatmap/./node_modules/d3-geo/src/clip/circle.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/orthographic.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/azimuthal.js","webpack://eurostatmap/./node_modules/proj4/lib/constants/values.js","webpack://eurostatmap/./node_modules/proj4/lib/constants/PrimeMeridian.js","webpack://eurostatmap/./node_modules/proj4/lib/constants/units.js","webpack://eurostatmap/./node_modules/proj4/lib/match.js","webpack://eurostatmap/./node_modules/proj4/lib/projString.js","webpack://eurostatmap/./node_modules/wkt-parser/PROJJSONBuilderBase.js","webpack://eurostatmap/./node_modules/wkt-parser/PROJJSONBuilder2015.js","webpack://eurostatmap/./node_modules/wkt-parser/PROJJSONBuilder2019.js","webpack://eurostatmap/./node_modules/wkt-parser/buildPROJJSON.js","webpack://eurostatmap/./node_modules/wkt-parser/parser.js","webpack://eurostatmap/./node_modules/wkt-parser/process.js","webpack://eurostatmap/./node_modules/wkt-parser/util.js","webpack://eurostatmap/./node_modules/wkt-parser/transformPROJJSON.js","webpack://eurostatmap/./node_modules/wkt-parser/index.js","webpack://eurostatmap/./node_modules/wkt-parser/detectWKTVersion.js","webpack://eurostatmap/./node_modules/proj4/lib/defs.js","webpack://eurostatmap/./node_modules/proj4/lib/global.js","webpack://eurostatmap/./node_modules/proj4/lib/parseCode.js","webpack://eurostatmap/./node_modules/proj4/lib/extend.js","webpack://eurostatmap/./node_modules/proj4/lib/common/msfnz.js","webpack://eurostatmap/./node_modules/proj4/lib/common/sign.js","webpack://eurostatmap/./node_modules/proj4/lib/common/adjust_lon.js","webpack://eurostatmap/./node_modules/proj4/lib/common/tsfnz.js","webpack://eurostatmap/./node_modules/proj4/lib/common/phi2z.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/merc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/longlat.js","webpack://eurostatmap/./node_modules/proj4/lib/projections.js","webpack://eurostatmap/./node_modules/proj4/lib/constants/Ellipsoid.js","webpack://eurostatmap/./node_modules/proj4/lib/deriveConstants.js","webpack://eurostatmap/./node_modules/proj4/lib/constants/Datum.js","webpack://eurostatmap/./node_modules/proj4/lib/datum.js","webpack://eurostatmap/./node_modules/proj4/lib/nadgrid.js","webpack://eurostatmap/./node_modules/proj4/lib/Proj.js","webpack://eurostatmap/./node_modules/proj4/lib/datumUtils.js","webpack://eurostatmap/./node_modules/proj4/lib/datum_transform.js","webpack://eurostatmap/./node_modules/proj4/lib/adjust_axis.js","webpack://eurostatmap/./node_modules/proj4/lib/common/toPoint.js","webpack://eurostatmap/./node_modules/proj4/lib/checkSanity.js","webpack://eurostatmap/./node_modules/proj4/lib/transform.js","webpack://eurostatmap/./node_modules/proj4/lib/core.js","webpack://eurostatmap/./node_modules/mgrs/mgrs.js","webpack://eurostatmap/./node_modules/proj4/lib/Point.js","webpack://eurostatmap/./node_modules/proj4/lib/common/pj_enfn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/pj_mlfn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/pj_inv_mlfn.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/tmerc.js","webpack://eurostatmap/./node_modules/proj4/lib/common/sinh.js","webpack://eurostatmap/./node_modules/proj4/lib/common/hypot.js","webpack://eurostatmap/./node_modules/proj4/lib/common/asinhy.js","webpack://eurostatmap/./node_modules/proj4/lib/common/log1py.js","webpack://eurostatmap/./node_modules/proj4/lib/common/gatg.js","webpack://eurostatmap/./node_modules/proj4/lib/common/clens_cmplx.js","webpack://eurostatmap/./node_modules/proj4/lib/common/cosh.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/etmerc.js","webpack://eurostatmap/./node_modules/proj4/lib/common/clens.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/utm.js","webpack://eurostatmap/./node_modules/proj4/lib/common/adjust_zone.js","webpack://eurostatmap/./node_modules/proj4/lib/common/srat.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/gauss.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/sterea.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/stere.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/somerc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/omerc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/lcc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/krovak.js","webpack://eurostatmap/./node_modules/proj4/lib/common/mlfn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/e0fn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/e1fn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/e2fn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/e3fn.js","webpack://eurostatmap/./node_modules/proj4/lib/common/gN.js","webpack://eurostatmap/./node_modules/proj4/lib/common/adjust_lat.js","webpack://eurostatmap/./node_modules/proj4/lib/common/imlfn.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/cass.js","webpack://eurostatmap/./node_modules/proj4/lib/common/qsfnz.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/laea.js","webpack://eurostatmap/./node_modules/proj4/lib/common/asinz.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/aea.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/gnom.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/cea.js","webpack://eurostatmap/./node_modules/proj4/lib/common/iqsfnz.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/eqc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/poly.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/nzmg.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/mill.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/sinu.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/moll.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/eqdc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/vandg.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/aeqd.js","webpack://eurostatmap/./node_modules/proj4/lib/common/vincenty.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/ortho.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/qsc.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/robin.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/geocent.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/tpers.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/geos.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/eqearth.js","webpack://eurostatmap/./node_modules/proj4/lib/projections/bonne.js","webpack://eurostatmap/./node_modules/proj4/lib/index.js","webpack://eurostatmap/./node_modules/proj4/projs.js","webpack://eurostatmap/./src/core/minimaps.js","webpack://eurostatmap/./src/core/zoom.js","webpack://eurostatmap/./src/core/buttons/insets-button.js","webpack://eurostatmap/./node_modules/d3-dsv/src/tsv.js","webpack://eurostatmap/./node_modules/d3-fetch/src/text.js","webpack://eurostatmap/./node_modules/d3-fetch/src/dsv.js","webpack://eurostatmap/./src/core/proj4.js","webpack://eurostatmap/./src/core/placenames.js","webpack://eurostatmap/./src/core/coastal-margin.js","webpack://eurostatmap/./src/core/scalebar.js","webpack://eurostatmap/./node_modules/simple-statistics/dist/simple-statistics.mjs","webpack://eurostatmap/./src/core/map-template.js","webpack://eurostatmap/./src/core/deprecated.js","webpack://eurostatmap/./src/core/texts.js","webpack://eurostatmap/./src/core/logo.js","webpack://eurostatmap/./src/core/buttons/zoom-buttons.js","webpack://eurostatmap/./node_modules/d3-geo/src/projection/identity.js","webpack://eurostatmap/./node_modules/jsonstat-toolkit/import.mjs","webpack://eurostatmap/./src/core/stat-data.js","webpack://eurostatmap/./src/legend/legend-pattern-fill.js","webpack://eurostatmap/./node_modules/internmap/src/index.js","webpack://eurostatmap/./node_modules/d3-scale/src/ordinal.js","webpack://eurostatmap/./node_modules/d3-scale/src/band.js","webpack://eurostatmap/./node_modules/d3-axis/src/identity.js","webpack://eurostatmap/./node_modules/d3-axis/src/axis.js","webpack://eurostatmap/./src/legend/choropleth/legend-histogram.js","webpack://eurostatmap/./src/legend/legend-continuous.js","webpack://eurostatmap/./src/legend/legend-discrete.js","webpack://eurostatmap/./src/legend/choropleth/legend-choropleth.js","webpack://eurostatmap/./src/legend/choropleth/legend-value-by-alpha.js","webpack://eurostatmap/./node_modules/d3-shape/src/constant.js","webpack://eurostatmap/./node_modules/d3-path/src/path.js","webpack://eurostatmap/./node_modules/d3-shape/src/path.js","webpack://eurostatmap/./node_modules/d3-shape/src/math.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/asterisk.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/circle.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/cross.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/diamond.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/square.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/star.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/triangle.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/wye.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol/triangle2.js","webpack://eurostatmap/./node_modules/d3-shape/src/symbol.js","webpack://eurostatmap/./src/legend/legend-circle-size.js","webpack://eurostatmap/./src/legend/proportional-symbol/legend-spike.js","webpack://eurostatmap/./src/map-types/proportional-symbol/symbols/d3-symbols.js","webpack://eurostatmap/./src/legend/proportional-symbol/legend-d3-shape.js","webpack://eurostatmap/./src/legend/proportional-symbol/legend-symbol-size.js","webpack://eurostatmap/./src/legend/proportional-symbol/legend-proportional-symbols.js","webpack://eurostatmap/./src/legend/legend.js","webpack://eurostatmap/./src/tooltip/tooltip.js","webpack://eurostatmap/./src/core/spinner.js","webpack://eurostatmap/./src/core/stat-map.js","webpack://eurostatmap/./src/core/pattern-fill.js","webpack://eurostatmap/./src/map-types/choropleth/map-choropleth.js","webpack://eurostatmap/./node_modules/d3-interpolate/src/piecewise.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/sequential-multi/OrRd.js","webpack://eurostatmap/./node_modules/d3-force/src/lcg.js","webpack://eurostatmap/./node_modules/d3-force/src/simulation.js","webpack://eurostatmap/./node_modules/d3-force/src/constant.js","webpack://eurostatmap/./node_modules/d3-force/src/x.js","webpack://eurostatmap/./node_modules/d3-force/src/y.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/add.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/quad.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/x.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/y.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/quadtree.js","webpack://eurostatmap/./node_modules/d3-force/src/jiggle.js","webpack://eurostatmap/./node_modules/d3-force/src/collide.js","webpack://eurostatmap/./src/core/dorling/dorling.js","webpack://eurostatmap/./node_modules/d3-scale/src/pow.js","webpack://eurostatmap/./src/core/scale.js","webpack://eurostatmap/./src/map-types/proportional-symbol/ps-classification.js","webpack://eurostatmap/./src/map-types/proportional-symbol/ps-background.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/cover.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/data.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/extent.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/find.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/remove.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/root.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/size.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/visit.js","webpack://eurostatmap/./node_modules/d3-quadtree/src/visitAfter.js","webpack://eurostatmap/./src/map-types/proportional-symbol/ps-interactions.js","webpack://eurostatmap/./src/map-types/proportional-symbol/symbols/spikes.js","webpack://eurostatmap/./src/map-types/proportional-symbol/map-proportional-symbols.js","webpack://eurostatmap/./src/map-types/proportional-symbol/symbols/custom.js","webpack://eurostatmap/./src/map-types/proportional-symbol/symbols/bars.js","webpack://eurostatmap/./src/map-types/proportional-symbol/symbols/circles.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/categorical/Set3.js","webpack://eurostatmap/./src/legend/legend-categorical.js","webpack://eurostatmap/./src/map-types/map-categorical.js","webpack://eurostatmap/./node_modules/d3-shape/src/array.js","webpack://eurostatmap/./node_modules/d3-shape/src/curve/linear.js","webpack://eurostatmap/./node_modules/d3-shape/src/point.js","webpack://eurostatmap/./node_modules/d3-shape/src/line.js","webpack://eurostatmap/./src/legend/choropleth/legend-choropleth-bivariate.js","webpack://eurostatmap/./src/map-types/choropleth/map-choropleth-bivariate.js","webpack://eurostatmap/./src/lib/tricolore/src/core/ternaryGeometry.ts","webpack://eurostatmap/./src/lib/tricolore/src/core/compositionUtils.ts","webpack://eurostatmap/./src/lib/tricolore/src/core/colorMapping.ts","webpack://eurostatmap/./node_modules/d3-array/src/identity.js","webpack://eurostatmap/./node_modules/d3-array/src/group.js","webpack://eurostatmap/./src/lib/tricolore/src/viz/tricoloreViz.ts","webpack://eurostatmap/./src/legend/choropleth/legend-choropleth-trivariate.js","webpack://eurostatmap/./src/map-types/choropleth/map-choropleth-trivariate.js","webpack://eurostatmap/./src/lib/tricolore/src/index.ts","webpack://eurostatmap/./node_modules/d3-shape/src/descending.js","webpack://eurostatmap/./node_modules/d3-shape/src/identity.js","webpack://eurostatmap/./node_modules/d3-shape/src/pie.js","webpack://eurostatmap/./node_modules/d3-shape/src/arc.js","webpack://eurostatmap/./node_modules/d3-scale-chromatic/src/categorical/category10.js","webpack://eurostatmap/./src/legend/legend-stripe-composition.js","webpack://eurostatmap/./node_modules/d3-array/src/extent.js","webpack://eurostatmap/./src/legend/legend-piecharts.js","webpack://eurostatmap/./src/map-types/map-piecharts.js","webpack://eurostatmap/./src/map-types/map-sparklines.js","webpack://eurostatmap/./node_modules/d3-shape/src/area.js","webpack://eurostatmap/./node_modules/d3-selection/src/create.js","webpack://eurostatmap/./src/legend/flow/legend-flow-width.js","webpack://eurostatmap/./src/legend/flow/legend-flow-color.js","webpack://eurostatmap/./src/legend/flow/legend-flow.js","webpack://eurostatmap/./node_modules/d3-array/src/sum.js","webpack://eurostatmap/./src/map-types/flow/arrows.js","webpack://eurostatmap/./src/map-types/flow/flow-bidirectional.js","webpack://eurostatmap/./src/map-types/flow/sankey.js","webpack://eurostatmap/./node_modules/d3-force/src/link.js","webpack://eurostatmap/./node_modules/d3-shape/src/curve/basis.js","webpack://eurostatmap/./node_modules/d3-shape/src/curve/bundle.js","webpack://eurostatmap/./src/map-types/flow/edge-bundling.js","webpack://eurostatmap/./node_modules/d3-force/src/manyBody.js","webpack://eurostatmap/./src/map-types/flow/straight.js","webpack://eurostatmap/./src/map-types/flow/donuts.js","webpack://eurostatmap/./src/map-types/flow/circles.js","webpack://eurostatmap/./src/map-types/flow/map-flow.js","webpack://eurostatmap/./node_modules/d3-scale/src/radial.js","webpack://eurostatmap/./node_modules/d3-shape/src/offset/none.js","webpack://eurostatmap/./node_modules/d3-shape/src/order/none.js","webpack://eurostatmap/./node_modules/d3-shape/src/stack.js","webpack://eurostatmap/./src/legend/legend-coxcomb.js","webpack://eurostatmap/./src/map-types/map-coxcomb.js","webpack://eurostatmap/./src/map-types/proportional-symbol/mushrooms/map-mushroom-interactions.js","webpack://eurostatmap/./src/legend/legend-mushroom.js","webpack://eurostatmap/./src/map-types/proportional-symbol/mushrooms/map-mushroom.js","webpack://eurostatmap/./src/eurostat-map.js","webpack://eurostatmap/./src/map-types/map-stripe-composition.js","webpack://eurostatmap/./src/map-types/choropleth/map-value-by-alpha.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"eurostatmap\"] = factory();\n\telse\n\t\troot[\"eurostatmap\"] = factory();\n})(self, () => {\nreturn ","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* dim everything except the highlighted color group */\r\n.em-flow-container line.dimmed,\r\n.em-flow-lines line.dimmed,\r\n.em-flow-container path.em-flow-link.dimmed,\r\n.em-flow-lines path.em-flow-link.dimmed {\r\n  opacity: 0;\r\n  stroke-opacity: 0;\r\n}\r\n\r\n/* emphasize the matching ones */\r\n.em-flow-container line.highlighted,\r\n.em-flow-lines line.highlighted {\r\n  opacity: 1;\r\n   stroke-opacity: 1;\r\n}\r\n\r\n.em-flow-container path.em-flow-link.highlighted,\r\n.em-flow-lines path.em-flow-link.highlighted {\r\n  /* tapered polygons use FILL */\r\n  filter: brightness(1.05);\r\n  opacity: 1;\r\n  stroke-opacity: 1;\r\n}\r\n\r\n.em-legend-label.em-flow-legend-min-label,\r\n.em-legend-label.em-flow-legend-max-label {\r\n    font-size: 12px;\r\n    fill: #666;\r\n}\r\n\r\n /* DONUT TOOLTIP */\r\n.em-donut-tooltip-table {\r\n    border-collapse: collapse;\r\n    width: 100%;\r\n    max-width: 100%;\r\n    table-layout: fixed; /* required for ellipsis to work predictably */\r\n}\r\n\r\n.em-donut-tooltip-table td {\r\n    padding: 3px 0;\r\n    font-size: 12px;\r\n    vertical-align: middle;\r\n}\r\n\r\n.em-donut-tooltip-table td:last-child {\r\n    width: 32%;\r\n    text-align: right;\r\n    white-space: nowrap;\r\n}\r\n\r\n.em-donut-tooltip-table{\r\n  border-collapse:collapse;\r\n  width:100%;\r\n  max-width:100%;\r\n  table-layout:fixed;\r\n  border-spacing:0;\r\n  box-sizing:border-box;\r\n}\r\n\r\n.em-donut-tooltip-table td{\r\n  padding:2px 6px;\r\n  font-size:12px;\r\n  vertical-align:middle;\r\n  box-sizing:border-box;\r\n}\r\n\r\n.em-donut-tooltip-table td:last-child{\r\n  text-align:right;\r\n  white-space:nowrap;\r\n  padding-left:6px;\r\n}\r\n\r\n.em-donut-tooltip-table td:first-child{\r\n  padding-right:6px;\r\n  box-sizing:border-box;\r\n  min-width:0;\r\n}\r\n\r\n.em-donut-tooltip-label{\r\n  display:flex;\r\n  align-items:center;\r\n  gap:6px;\r\n  min-width:0;\r\n  overflow:hidden;\r\n  white-space:nowrap;\r\n}\r\n\r\n.em-donut-tooltip-colorchip{\r\n  width:10px;\r\n  height:10px;\r\n  border-radius:50%;\r\n  flex-shrink:0;\r\n  display:inline-block;\r\n  vertical-align:middle;\r\n}\r\n\r\n.em-tooltip-label-text{\r\n  overflow:hidden;\r\n  text-overflow:ellipsis;\r\n  white-space:nowrap;\r\n  flex:1 1 auto;\r\n  min-width:0;\r\n  display:inline-block;\r\n  vertical-align:middle;\r\n}\r\n\r\n.em-donut-tooltip-section-header td{padding-top:6px;font-weight:600;color:#222}\r\n.em-donut-tooltip-row td{padding-top:2px}\r\n.em-donut-tooltip-total td{padding-top:6px;font-weight:700;border-top:1px solid #ddd}\r\n\r\n.em-tooltip-text{\r\n  max-width:320px;\r\n  box-sizing:border-box;\r\n  overflow:hidden;\r\n  padding:0;\r\n}\r\n\r\n /* END DONUT TOOLTIP */`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/flow.css\"],\"names\":[],\"mappings\":\"AAAA,sDAAsD;AACtD;;;;EAIE,UAAU;EACV,iBAAiB;AACnB;;AAEA,gCAAgC;AAChC;;EAEE,UAAU;GACT,iBAAiB;AACpB;;AAEA;;EAEE,8BAA8B;EAC9B,wBAAwB;EACxB,UAAU;EACV,iBAAiB;AACnB;;AAEA;;IAEI,eAAe;IACf,UAAU;AACd;;CAEC,kBAAkB;AACnB;IACI,yBAAyB;IACzB,WAAW;IACX,eAAe;IACf,mBAAmB,EAAE,8CAA8C;AACvE;;AAEA;IACI,cAAc;IACd,eAAe;IACf,sBAAsB;AAC1B;;AAEA;IACI,UAAU;IACV,iBAAiB;IACjB,mBAAmB;AACvB;;AAEA;EACE,wBAAwB;EACxB,UAAU;EACV,cAAc;EACd,kBAAkB;EAClB,gBAAgB;EAChB,qBAAqB;AACvB;;AAEA;EACE,eAAe;EACf,cAAc;EACd,qBAAqB;EACrB,qBAAqB;AACvB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,iBAAiB;EACjB,qBAAqB;EACrB,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,kBAAkB;EAClB,OAAO;EACP,WAAW;EACX,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,UAAU;EACV,WAAW;EACX,iBAAiB;EACjB,aAAa;EACb,oBAAoB;EACpB,qBAAqB;AACvB;;AAEA;EACE,eAAe;EACf,sBAAsB;EACtB,kBAAkB;EAClB,aAAa;EACb,WAAW;EACX,oBAAoB;EACpB,qBAAqB;AACvB;;AAEA,oCAAoC,eAAe,CAAC,eAAe,CAAC,UAAU;AAC9E,yBAAyB,eAAe;AACxC,2BAA2B,eAAe,CAAC,eAAe,CAAC,yBAAyB;;AAEpF;EACE,eAAe;EACf,qBAAqB;EACrB,eAAe;EACf,SAAS;AACX;;CAEC,sBAAsB\",\"sourcesContent\":[\"/* dim everything except the highlighted color group */\\r\\n.em-flow-container line.dimmed,\\r\\n.em-flow-lines line.dimmed,\\r\\n.em-flow-container path.em-flow-link.dimmed,\\r\\n.em-flow-lines path.em-flow-link.dimmed {\\r\\n  opacity: 0;\\r\\n  stroke-opacity: 0;\\r\\n}\\r\\n\\r\\n/* emphasize the matching ones */\\r\\n.em-flow-container line.highlighted,\\r\\n.em-flow-lines line.highlighted {\\r\\n  opacity: 1;\\r\\n   stroke-opacity: 1;\\r\\n}\\r\\n\\r\\n.em-flow-container path.em-flow-link.highlighted,\\r\\n.em-flow-lines path.em-flow-link.highlighted {\\r\\n  /* tapered polygons use FILL */\\r\\n  filter: brightness(1.05);\\r\\n  opacity: 1;\\r\\n  stroke-opacity: 1;\\r\\n}\\r\\n\\r\\n.em-legend-label.em-flow-legend-min-label,\\r\\n.em-legend-label.em-flow-legend-max-label {\\r\\n    font-size: 12px;\\r\\n    fill: #666;\\r\\n}\\r\\n\\r\\n /* DONUT TOOLTIP */\\r\\n.em-donut-tooltip-table {\\r\\n    border-collapse: collapse;\\r\\n    width: 100%;\\r\\n    max-width: 100%;\\r\\n    table-layout: fixed; /* required for ellipsis to work predictably */\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table td {\\r\\n    padding: 3px 0;\\r\\n    font-size: 12px;\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table td:last-child {\\r\\n    width: 32%;\\r\\n    text-align: right;\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table{\\r\\n  border-collapse:collapse;\\r\\n  width:100%;\\r\\n  max-width:100%;\\r\\n  table-layout:fixed;\\r\\n  border-spacing:0;\\r\\n  box-sizing:border-box;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table td{\\r\\n  padding:2px 6px;\\r\\n  font-size:12px;\\r\\n  vertical-align:middle;\\r\\n  box-sizing:border-box;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table td:last-child{\\r\\n  text-align:right;\\r\\n  white-space:nowrap;\\r\\n  padding-left:6px;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-table td:first-child{\\r\\n  padding-right:6px;\\r\\n  box-sizing:border-box;\\r\\n  min-width:0;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-label{\\r\\n  display:flex;\\r\\n  align-items:center;\\r\\n  gap:6px;\\r\\n  min-width:0;\\r\\n  overflow:hidden;\\r\\n  white-space:nowrap;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-colorchip{\\r\\n  width:10px;\\r\\n  height:10px;\\r\\n  border-radius:50%;\\r\\n  flex-shrink:0;\\r\\n  display:inline-block;\\r\\n  vertical-align:middle;\\r\\n}\\r\\n\\r\\n.em-tooltip-label-text{\\r\\n  overflow:hidden;\\r\\n  text-overflow:ellipsis;\\r\\n  white-space:nowrap;\\r\\n  flex:1 1 auto;\\r\\n  min-width:0;\\r\\n  display:inline-block;\\r\\n  vertical-align:middle;\\r\\n}\\r\\n\\r\\n.em-donut-tooltip-section-header td{padding-top:6px;font-weight:600;color:#222}\\r\\n.em-donut-tooltip-row td{padding-top:2px}\\r\\n.em-donut-tooltip-total td{padding-top:6px;font-weight:700;border-top:1px solid #ddd}\\r\\n\\r\\n.em-tooltip-text{\\r\\n  max-width:320px;\\r\\n  box-sizing:border-box;\\r\\n  overflow:hidden;\\r\\n  padding:0;\\r\\n}\\r\\n\\r\\n /* END DONUT TOOLTIP */\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* spinner overlay */\r\n#em-loading-overlay {\r\n    font-family: Arial, Helvetica, sans-serif;\r\n    position: absolute;\r\n    inset: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(255, 255, 255, 0.6);\r\n    z-index: 9999;\r\n    pointer-events: auto;\r\n}\r\n\r\n/* hidden state */\r\n#em-loading-overlay.is-hidden {\r\n    display: none;\r\n}\r\n\r\n/* center spinner */\r\n.em-loading-spinner {\r\n    width: 48px;\r\n    height: 48px;\r\n    border-radius: 50%;\r\n    border: 4px solid rgba(0, 0, 0, 0.12);\r\n    border-top-color: rgba(0, 0, 0, 0.65);\r\n    animation: em-spinner-rotate 1s linear infinite;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);\r\n}\r\n\r\n/* label */\r\n#em-loading-overlay .em-loading-label {\r\n    margin-top: 8px;\r\n    font-size: 13px;\r\n    color: #222;\r\n    text-align: center;\r\n    font-weight: 500;\r\n}\r\n\r\n#em-loading-overlay .em-spinner-stack {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n@keyframes em-spinner-rotate {\r\n    to { transform: rotate(360deg); }\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/spinner.css\"],\"names\":[],\"mappings\":\"AAAA,oBAAoB;AACpB;IACI,yCAAyC;IACzC,kBAAkB;IAClB,QAAQ;IACR,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,oCAAoC;IACpC,aAAa;IACb,oBAAoB;AACxB;;AAEA,iBAAiB;AACjB;IACI,aAAa;AACjB;;AAEA,mBAAmB;AACnB;IACI,WAAW;IACX,YAAY;IACZ,kBAAkB;IAClB,qCAAqC;IACrC,qCAAqC;IACrC,+CAA+C;IAC/C,yCAAyC;AAC7C;;AAEA,UAAU;AACV;IACI,eAAe;IACf,eAAe;IACf,WAAW;IACX,kBAAkB;IAClB,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;AACvB;;AAEA;IACI,KAAK,yBAAyB,EAAE;AACpC\",\"sourcesContent\":[\"/* spinner overlay */\\r\\n#em-loading-overlay {\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n    position: absolute;\\r\\n    inset: 0;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    background: rgba(255, 255, 255, 0.6);\\r\\n    z-index: 9999;\\r\\n    pointer-events: auto;\\r\\n}\\r\\n\\r\\n/* hidden state */\\r\\n#em-loading-overlay.is-hidden {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* center spinner */\\r\\n.em-loading-spinner {\\r\\n    width: 48px;\\r\\n    height: 48px;\\r\\n    border-radius: 50%;\\r\\n    border: 4px solid rgba(0, 0, 0, 0.12);\\r\\n    border-top-color: rgba(0, 0, 0, 0.65);\\r\\n    animation: em-spinner-rotate 1s linear infinite;\\r\\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);\\r\\n}\\r\\n\\r\\n/* label */\\r\\n#em-loading-overlay .em-loading-label {\\r\\n    margin-top: 8px;\\r\\n    font-size: 13px;\\r\\n    color: #222;\\r\\n    text-align: center;\\r\\n    font-weight: 500;\\r\\n}\\r\\n\\r\\n#em-loading-overlay .em-spinner-stack {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n@keyframes em-spinner-rotate {\\r\\n    to { transform: rotate(360deg); }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nmodule.exports = _OverloadYield, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* TERNARY */\r\n.em-ternary-legend-label {\r\n    font-size: 13px;\r\n    stroke: none;\r\n    fill: #3a3a3a;\r\n}\r\n.em-ternary-grid-line,\r\n.em-ternary-grid-line-minor {\r\n    pointer-events: none;\r\n}\r\n.em-ternary-axis-title {\r\n    font-size: 13px;\r\n}\r\n.em-ternary-axis-tick {\r\n    stroke: #3a3a3a;\r\n    stroke-width: 1;\r\n    pointer-events: none;\r\n}\r\n.em-ternary-legend-data-point,\r\n.em-ternary-discrete-polygon {\r\n    cursor: pointer;\r\n}\r\n.em-ternary-discrete-polygon {\r\n    transition: fill 150ms;\r\n}\r\n.em-ternary-annotation-line {\r\n    stroke: #161616;\r\n    stroke-width: 1;\r\n    opacity: 1;\r\n}\r\n.em-ternary-center-annotation-label {\r\n    font-size: 11px;\r\n    fill: #161616;\r\n    font-style: italic;\r\n    text-anchor: start;\r\n}\r\n.em-ternary-center-line-label {\r\n    opacity: 1;\r\n    font-size: 10px;\r\n}\r\n.em-ternary-center-point {\r\n    pointer-events: none;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/ternary.css\"],\"names\":[],\"mappings\":\"AAAA,YAAY;AACZ;IACI,eAAe;IACf,YAAY;IACZ,aAAa;AACjB;AACA;;IAEI,oBAAoB;AACxB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;IACf,eAAe;IACf,oBAAoB;AACxB;AACA;;IAEI,eAAe;AACnB;AACA;IACI,sBAAsB;AAC1B;AACA;IACI,eAAe;IACf,eAAe;IACf,UAAU;AACd;AACA;IACI,eAAe;IACf,aAAa;IACb,kBAAkB;IAClB,kBAAkB;AACtB;AACA;IACI,UAAU;IACV,eAAe;AACnB;AACA;IACI,oBAAoB;AACxB\",\"sourcesContent\":[\"/* TERNARY */\\r\\n.em-ternary-legend-label {\\r\\n    font-size: 13px;\\r\\n    stroke: none;\\r\\n    fill: #3a3a3a;\\r\\n}\\r\\n.em-ternary-grid-line,\\r\\n.em-ternary-grid-line-minor {\\r\\n    pointer-events: none;\\r\\n}\\r\\n.em-ternary-axis-title {\\r\\n    font-size: 13px;\\r\\n}\\r\\n.em-ternary-axis-tick {\\r\\n    stroke: #3a3a3a;\\r\\n    stroke-width: 1;\\r\\n    pointer-events: none;\\r\\n}\\r\\n.em-ternary-legend-data-point,\\r\\n.em-ternary-discrete-polygon {\\r\\n    cursor: pointer;\\r\\n}\\r\\n.em-ternary-discrete-polygon {\\r\\n    transition: fill 150ms;\\r\\n}\\r\\n.em-ternary-annotation-line {\\r\\n    stroke: #161616;\\r\\n    stroke-width: 1;\\r\\n    opacity: 1;\\r\\n}\\r\\n.em-ternary-center-annotation-label {\\r\\n    font-size: 11px;\\r\\n    fill: #161616;\\r\\n    font-style: italic;\\r\\n    text-anchor: start;\\r\\n}\\r\\n.em-ternary-center-line-label {\\r\\n    opacity: 1;\\r\\n    font-size: 10px;\\r\\n}\\r\\n.em-ternary-center-point {\\r\\n    pointer-events: none;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-flow-width-horizontal-label {\r\n    text-anchor: middle;\r\n    font-size: 13px;\r\n    /* fill: #3a3a3a */\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/flow.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,mBAAmB;IACnB,eAAe;IACf,kBAAkB;AACtB\",\"sourcesContent\":[\".em-flow-width-horizontal-label {\\r\\n    text-anchor: middle;\\r\\n    font-size: 13px;\\r\\n    /* fill: #3a3a3a */\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_1___ from \"-!../../node_modules/css-loader/dist/cjs.js!./tooltip.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_2___ from \"-!../../node_modules/css-loader/dist/cjs.js!./legend/legend.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_3___ from \"-!../../node_modules/css-loader/dist/cjs.js!./labels.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_4___ from \"-!../../node_modules/css-loader/dist/cjs.js!./annotations.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_5___ from \"-!../../node_modules/css-loader/dist/cjs.js!./NUTS.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_6___ from \"-!../../node_modules/css-loader/dist/cjs.js!./world.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_7___ from \"-!../../node_modules/css-loader/dist/cjs.js!./ui.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_8___ from \"-!../../node_modules/css-loader/dist/cjs.js!./minimap.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_9___ from \"-!../../node_modules/css-loader/dist/cjs.js!./placenames.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_10___ from \"-!../../node_modules/css-loader/dist/cjs.js!./insets.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_1___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_2___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_3___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_4___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_5___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_6___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_7___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_8___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_9___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_10___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\r\n`, \"\",{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nmodule.exports = _regeneratorAsync, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Proportional symbol and pie styles */\r\n\r\n/*   muted country boundaries */\r\n.em--ps .em-cntbn {\r\n    stroke: grey;\r\n}\r\n\r\n/*   muted nuts boundaries */\r\n.em--ps .em-bn-1,\r\n.em--ps .em-bn-2,\r\n.em--ps .em-bn-3,\r\n.em--ps .em-nutsrg [lvl='3'],\r\n.em--ps .em-nutsrg [lvl='2'],\r\n.em--ps .em-nutsrg [lvl='1'],\r\n.em--ps .em-bn-co {\r\n    stroke-width: 0.07px;\r\n}\r\n\r\n/*  muted country fill */\r\n.em--ps .em-cntrg {\r\n    fill: #f2f2f2;\r\n}\r\n\r\n/*  regions without data input */\r\n.em--ps [ecl=\"ni\"] {\r\n    fill: #e9e9e9;\r\n}\r\n\r\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\r\n/* .em--ps g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\r\n    stroke-width: 0px;\r\n} */\r\n\r\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\r\n.em--ps .em-bn-co {\r\n    stroke: grey;\r\n    stroke-width: 0.2px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/proportional-symbol.css\"],\"names\":[],\"mappings\":\"AAAA,uCAAuC;;AAEvC,+BAA+B;AAC/B;IACI,YAAY;AAChB;;AAEA,4BAA4B;AAC5B;;;;;;;IAOI,oBAAoB;AACxB;;AAEA,wBAAwB;AACxB;IACI,aAAa;AACjB;;AAEA,gCAAgC;AAChC;IACI,aAAa;AACjB;;AAEA,uHAAuH;AACvH;;GAEG;;AAEH,0HAA0H;AAC1H;IACI,YAAY;IACZ,mBAAmB;AACvB\",\"sourcesContent\":[\"/* Proportional symbol and pie styles */\\r\\n\\r\\n/*   muted country boundaries */\\r\\n.em--ps .em-cntbn {\\r\\n    stroke: grey;\\r\\n}\\r\\n\\r\\n/*   muted nuts boundaries */\\r\\n.em--ps .em-bn-1,\\r\\n.em--ps .em-bn-2,\\r\\n.em--ps .em-bn-3,\\r\\n.em--ps .em-nutsrg [lvl='3'],\\r\\n.em--ps .em-nutsrg [lvl='2'],\\r\\n.em--ps .em-nutsrg [lvl='1'],\\r\\n.em--ps .em-bn-co {\\r\\n    stroke-width: 0.07px;\\r\\n}\\r\\n\\r\\n/*  muted country fill */\\r\\n.em--ps .em-cntrg {\\r\\n    fill: #f2f2f2;\\r\\n}\\r\\n\\r\\n/*  regions without data input */\\r\\n.em--ps [ecl=\\\"ni\\\"] {\\r\\n    fill: #e9e9e9;\\r\\n}\\r\\n\\r\\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\\r\\n/* .em--ps g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\\r\\n    stroke-width: 0px;\\r\\n} */\\r\\n\\r\\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\\r\\n.em--ps .em-bn-co {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.2px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-legend-label.em-spike-legend-label {\r\n    font-size:12px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/spike.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,cAAc;AAClB\",\"sourcesContent\":[\".em-legend-label.em-spike-legend-label {\\r\\n    font-size:12px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./bivariate-choropleth.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_1___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./coxcomb.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_2___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./flow.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_3___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./pie.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_4___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./spike.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_5___ from \"-!../../../node_modules/css-loader/dist/cjs.js!./ternary.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_1___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_2___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_3___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_4___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_5___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-legend-background {\r\n    fill: white;\r\n    opacity: 0.7;\r\n    rx: 0;\r\n    ry: 0;\r\n    pointer-events: none;\r\n}\r\n\r\n/* titles */\r\n.em-legend-title {\r\n    font-weight: bold;\r\n    font-size: 15px;\r\n    fill: #696969;\r\n}\r\n\r\n.em-size-legend-title {\r\n    font-size: 15px;\r\n    fill: #666;\r\n}\r\n\r\n.em-color-legend-title {\r\n    font-size: 15px;\r\n    fill: #696969;\r\n}\r\n\r\n.em-width-legend-title {\r\n    font-size: 15px;\r\n    fill: #696969;\r\n}\r\n\r\n.em-legend-subtitle {\r\n    font-size: 15px;\r\n    fill: #696969;\r\n    opacity: 0.8;\r\n}\r\n\r\n/* labels */\r\n.em-legend-label {\r\n    font-size: 14px;\r\n    stroke: none;\r\n    fill: #696969;\r\n    dominant-baseline: unset;\r\n}\r\n\r\n.em-legend-label-max,\r\n.em-legend-label-min {\r\n    opacity: 0.8;\r\n}\r\n\r\n.em-legend-label-max:hover,\r\n.em-legend-label-min:hover,\r\n.em-legend-label-no-data:hover {\r\n    opacity: 1;\r\n    font-weight: bold;\r\n}\r\n\r\n/* ticks */\r\n.em-legend-tick {\r\n    stroke: #696969;\r\n    stroke-width: 1;\r\n}\r\n\r\n/* misc */\r\n.em-legend-separator {\r\n    stroke: white;\r\n    stroke-width: 1;\r\n}\r\n\r\n/* cursor: pointer */\r\n.em-legend-gradient {\r\n    cursor: pointer;\r\n}\r\n.em-bivariate-square,\r\n.em-legend-rect {\r\n    cursor: pointer;\r\n}\r\n.em-legend-histogram-bar {\r\n    cursor: pointer;\r\n}\r\n\r\n/* hover */\r\n.em-bivariate-square:hover,\r\n.em-legend-rect:hover {\r\n    stroke-width: 2;\r\n    stroke: red;\r\n}\r\n\r\n.em-legend-diverging-line {\r\n    stroke: #696969;\r\n}\r\n.em-legend-background {\r\n    filter: drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5));\r\n    opacity: 0.9;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/legend.css\"],\"names\":[],\"mappings\":\"AAOA;IACI,WAAW;IACX,YAAY;IACZ,KAAK;IACL,KAAK;IACL,oBAAoB;AACxB;;AAEA,WAAW;AACX;IACI,iBAAiB;IACjB,eAAe;IACf,aAAa;AACjB;;AAEA;IACI,eAAe;IACf,UAAU;AACd;;AAEA;IACI,eAAe;IACf,aAAa;AACjB;;AAEA;IACI,eAAe;IACf,aAAa;AACjB;;AAEA;IACI,eAAe;IACf,aAAa;IACb,YAAY;AAChB;;AAEA,WAAW;AACX;IACI,eAAe;IACf,YAAY;IACZ,aAAa;IACb,wBAAwB;AAC5B;;AAEA;;IAEI,YAAY;AAChB;;AAEA;;;IAGI,UAAU;IACV,iBAAiB;AACrB;;AAEA,UAAU;AACV;IACI,eAAe;IACf,eAAe;AACnB;;AAEA,SAAS;AACT;IACI,aAAa;IACb,eAAe;AACnB;;AAEA,oBAAoB;AACpB;IACI,eAAe;AACnB;AACA;;IAEI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;;AAEA,UAAU;AACV;;IAEI,eAAe;IACf,WAAW;AACf;;AAEA;IACI,eAAe;AACnB;AACA;IACI,mDAAmD;IACnD,YAAY;AAChB\",\"sourcesContent\":[\"@import 'bivariate-choropleth.css';\\r\\n@import 'coxcomb.css';\\r\\n@import 'flow.css';\\r\\n@import 'pie.css';\\r\\n@import 'spike.css';\\r\\n@import 'ternary.css';\\r\\n\\r\\n.em-legend-background {\\r\\n    fill: white;\\r\\n    opacity: 0.7;\\r\\n    rx: 0;\\r\\n    ry: 0;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n/* titles */\\r\\n.em-legend-title {\\r\\n    font-weight: bold;\\r\\n    font-size: 15px;\\r\\n    fill: #696969;\\r\\n}\\r\\n\\r\\n.em-size-legend-title {\\r\\n    font-size: 15px;\\r\\n    fill: #666;\\r\\n}\\r\\n\\r\\n.em-color-legend-title {\\r\\n    font-size: 15px;\\r\\n    fill: #696969;\\r\\n}\\r\\n\\r\\n.em-width-legend-title {\\r\\n    font-size: 15px;\\r\\n    fill: #696969;\\r\\n}\\r\\n\\r\\n.em-legend-subtitle {\\r\\n    font-size: 15px;\\r\\n    fill: #696969;\\r\\n    opacity: 0.8;\\r\\n}\\r\\n\\r\\n/* labels */\\r\\n.em-legend-label {\\r\\n    font-size: 14px;\\r\\n    stroke: none;\\r\\n    fill: #696969;\\r\\n    dominant-baseline: unset;\\r\\n}\\r\\n\\r\\n.em-legend-label-max,\\r\\n.em-legend-label-min {\\r\\n    opacity: 0.8;\\r\\n}\\r\\n\\r\\n.em-legend-label-max:hover,\\r\\n.em-legend-label-min:hover,\\r\\n.em-legend-label-no-data:hover {\\r\\n    opacity: 1;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* ticks */\\r\\n.em-legend-tick {\\r\\n    stroke: #696969;\\r\\n    stroke-width: 1;\\r\\n}\\r\\n\\r\\n/* misc */\\r\\n.em-legend-separator {\\r\\n    stroke: white;\\r\\n    stroke-width: 1;\\r\\n}\\r\\n\\r\\n/* cursor: pointer */\\r\\n.em-legend-gradient {\\r\\n    cursor: pointer;\\r\\n}\\r\\n.em-bivariate-square,\\r\\n.em-legend-rect {\\r\\n    cursor: pointer;\\r\\n}\\r\\n.em-legend-histogram-bar {\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n/* hover */\\r\\n.em-bivariate-square:hover,\\r\\n.em-legend-rect:hover {\\r\\n    stroke-width: 2;\\r\\n    stroke: red;\\r\\n}\\r\\n\\r\\n.em-legend-diverging-line {\\r\\n    stroke: #696969;\\r\\n}\\r\\n.em-legend-background {\\r\\n    filter: drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5));\\r\\n    opacity: 0.9;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-minimap-outer-circle {\r\n      filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.3))\r\n          drop-shadow(0 0 12px rgba(0, 0, 0, 0.15));\r\n      opacity:0.5\r\n}\r\n\r\n.em-minimap-inner-circle {\r\n\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/minimap.css\"],\"names\":[],\"mappings\":\"AAAA;MACM;mDAC6C;MAC7C;AACN;;AAEA;;AAEA\",\"sourcesContent\":[\".em-minimap-outer-circle {\\r\\n      filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.3))\\r\\n          drop-shadow(0 0 12px rgba(0, 0, 0, 0.15));\\r\\n      opacity:0.5\\r\\n}\\r\\n\\r\\n.em-minimap-inner-circle {\\r\\n\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nmodule.exports = _regeneratorKeys, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-pie-size-legend-line {\r\n    stroke-dasharray: 2;\r\n    stroke: grey;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/pie.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,mBAAmB;IACnB,YAAY;AAChB\",\"sourcesContent\":[\".em-pie-size-legend-line {\\r\\n    stroke-dasharray: 2;\\r\\n    stroke: grey;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*   muted country boundaries */\r\n.em--coxcomb .em-cntbn {\r\n    stroke: grey;\r\n    stroke-width: 0.25px;\r\n}\r\n\r\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\r\n.em--ps .em-bn-co,\r\n.em--pie .em-bn-co {\r\n    stroke: grey;\r\n    stroke-width: 0.1px;\r\n}\r\n\r\n/*  regions without data input */\r\n.em--coxcomb [ecl=\"ni\"] {\r\n    fill: #e9e9e9;\r\n}\r\n\r\n/* Default region fill */\r\n.em--coxcomb .em-cntrg,\r\n.em--coxcomb .em-nutsrg {\r\n    fill: #fafcde;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/coxcomb.css\"],\"names\":[],\"mappings\":\"AAAA,+BAA+B;AAC/B;IACI,YAAY;IACZ,oBAAoB;AACxB;;AAEA,0HAA0H;AAC1H;;IAEI,YAAY;IACZ,mBAAmB;AACvB;;AAEA,gCAAgC;AAChC;IACI,aAAa;AACjB;;AAEA,wBAAwB;AACxB;;IAEI,aAAa;AACjB\",\"sourcesContent\":[\"/*   muted country boundaries */\\r\\n.em--coxcomb .em-cntbn {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.25px;\\r\\n}\\r\\n\\r\\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\\r\\n.em--ps .em-bn-co,\\r\\n.em--pie .em-bn-co {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.1px;\\r\\n}\\r\\n\\r\\n/*  regions without data input */\\r\\n.em--coxcomb [ecl=\\\"ni\\\"] {\\r\\n    fill: #e9e9e9;\\r\\n}\\r\\n\\r\\n/* Default region fill */\\r\\n.em--coxcomb .em-cntrg,\\r\\n.em--coxcomb .em-nutsrg {\\r\\n    fill: #fafcde;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `#em-labels {\r\n    text-anchor: middle;\r\n    stroke-linejoin: round;\r\n    stroke-linecap: round;\r\n    font-family: Arial, Helvetica, sans-serif;\r\n    dominant-baseline: central;\r\n    pointer-events: none;\r\n    paint-order: stroke fill;\r\n}\r\n\r\n.em-labels {\r\n    font-size: 12px;\r\n    fill: #000000;\r\n}\r\n\r\n.em-label {\r\n    font-size: 12px;\r\n    opacity: 0.9;\r\n}\r\n\r\n.em-label-shadow,\r\n.em-flow-label-shadow {\r\n    font-size: 12px;\r\n    stroke-width: 2px;\r\n    stroke: white;\r\n    opacity: 0.9;\r\n    fill: none;\r\n}\r\n\r\n.em-label-background {\r\n    fill: #ffffff;\r\n    opacity: 0.9;\r\n}\r\n\r\n.em-stat-label {\r\n    fill: #111111;\r\n    stroke: #111111;\r\n    stroke-width: 0.5px;\r\n}\r\n\r\n.em-stat-label-shadow {\r\n    fill: none;\r\n    stroke: white;\r\n    stroke-width: 2.5px;\r\n    opacity: 0.9;\r\n}\r\n\r\n.em-stat-label,\r\n.em-stat-label-shadow {\r\n    font-size: 13px;\r\n}\r\n\r\n.em-label-cc {\r\n    font-size: 12px;\r\n}\r\n\r\n.em-label-shadow-cc {\r\n    font-size: 12px;\r\n    stroke-width: 3px;\r\n}\r\n\r\n.em-label-countries {\r\n    fill: #111111;\r\n    font-size: 10px;\r\n}\r\n\r\n.em-label-shadow-countries {\r\n    font-size: 10px;\r\n    stroke-width: 3px;\r\n}\r\n\r\n.em-label-seas {\r\n    font-size: 9px;\r\n    fill: #2a58b3;\r\n    letter-spacing: 0.25em;\r\n    opacity: 0.7;\r\n}\r\n\r\n.em-label-shadow-seas {\r\n    font-size: 9px;\r\n    letter-spacing: 0.25em;\r\n    stroke-width: 3px;\r\n    opacity: 0.5;\r\n}\r\n\r\n.em-flow-labels {\r\n    text-anchor: middle;\r\n    stroke-linejoin: round;\r\n    font-family: Arial, Helvetica, sans-serif;\r\n    dominant-baseline: central;\r\n}\r\n\r\n.em-flow-label {\r\n    font-size: 13px;\r\n    fill: #333333;\r\n    font-weight: bold;\r\n    opacity: 0.9;\r\n}\r\n\r\n.em-flow-label-shadow {\r\n    font-size: 13px;\r\n    stroke-width: 3px;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/labels.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,mBAAmB;IACnB,sBAAsB;IACtB,qBAAqB;IACrB,yCAAyC;IACzC,0BAA0B;IAC1B,oBAAoB;IACpB,wBAAwB;AAC5B;;AAEA;IACI,eAAe;IACf,aAAa;AACjB;;AAEA;IACI,eAAe;IACf,YAAY;AAChB;;AAEA;;IAEI,eAAe;IACf,iBAAiB;IACjB,aAAa;IACb,YAAY;IACZ,UAAU;AACd;;AAEA;IACI,aAAa;IACb,YAAY;AAChB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,mBAAmB;AACvB;;AAEA;IACI,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,YAAY;AAChB;;AAEA;;IAEI,eAAe;AACnB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,eAAe;IACf,iBAAiB;AACrB;;AAEA;IACI,aAAa;IACb,eAAe;AACnB;;AAEA;IACI,eAAe;IACf,iBAAiB;AACrB;;AAEA;IACI,cAAc;IACd,aAAa;IACb,sBAAsB;IACtB,YAAY;AAChB;;AAEA;IACI,cAAc;IACd,sBAAsB;IACtB,iBAAiB;IACjB,YAAY;AAChB;;AAEA;IACI,mBAAmB;IACnB,sBAAsB;IACtB,yCAAyC;IACzC,0BAA0B;AAC9B;;AAEA;IACI,eAAe;IACf,aAAa;IACb,iBAAiB;IACjB,YAAY;AAChB;;AAEA;IACI,eAAe;IACf,iBAAiB;AACrB\",\"sourcesContent\":[\"#em-labels {\\r\\n    text-anchor: middle;\\r\\n    stroke-linejoin: round;\\r\\n    stroke-linecap: round;\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n    dominant-baseline: central;\\r\\n    pointer-events: none;\\r\\n    paint-order: stroke fill;\\r\\n}\\r\\n\\r\\n.em-labels {\\r\\n    font-size: 12px;\\r\\n    fill: #000000;\\r\\n}\\r\\n\\r\\n.em-label {\\r\\n    font-size: 12px;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.em-label-shadow,\\r\\n.em-flow-label-shadow {\\r\\n    font-size: 12px;\\r\\n    stroke-width: 2px;\\r\\n    stroke: white;\\r\\n    opacity: 0.9;\\r\\n    fill: none;\\r\\n}\\r\\n\\r\\n.em-label-background {\\r\\n    fill: #ffffff;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.em-stat-label {\\r\\n    fill: #111111;\\r\\n    stroke: #111111;\\r\\n    stroke-width: 0.5px;\\r\\n}\\r\\n\\r\\n.em-stat-label-shadow {\\r\\n    fill: none;\\r\\n    stroke: white;\\r\\n    stroke-width: 2.5px;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.em-stat-label,\\r\\n.em-stat-label-shadow {\\r\\n    font-size: 13px;\\r\\n}\\r\\n\\r\\n.em-label-cc {\\r\\n    font-size: 12px;\\r\\n}\\r\\n\\r\\n.em-label-shadow-cc {\\r\\n    font-size: 12px;\\r\\n    stroke-width: 3px;\\r\\n}\\r\\n\\r\\n.em-label-countries {\\r\\n    fill: #111111;\\r\\n    font-size: 10px;\\r\\n}\\r\\n\\r\\n.em-label-shadow-countries {\\r\\n    font-size: 10px;\\r\\n    stroke-width: 3px;\\r\\n}\\r\\n\\r\\n.em-label-seas {\\r\\n    font-size: 9px;\\r\\n    fill: #2a58b3;\\r\\n    letter-spacing: 0.25em;\\r\\n    opacity: 0.7;\\r\\n}\\r\\n\\r\\n.em-label-shadow-seas {\\r\\n    font-size: 9px;\\r\\n    letter-spacing: 0.25em;\\r\\n    stroke-width: 3px;\\r\\n    opacity: 0.5;\\r\\n}\\r\\n\\r\\n.em-flow-labels {\\r\\n    text-anchor: middle;\\r\\n    stroke-linejoin: round;\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n    dominant-baseline: central;\\r\\n}\\r\\n\\r\\n.em-flow-label {\\r\\n    font-size: 13px;\\r\\n    fill: #333333;\\r\\n    font-weight: bold;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.em-flow-label-shadow {\\r\\n    font-size: 13px;\\r\\n    stroke-width: 3px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-placename {\r\n    text-anchor: start;\r\n}\r\n\r\n.em-placename-halo {\r\n    text-anchor: start;\r\n    fill:none;\r\n    stroke: white;\r\n    opacity:0.8;\r\n    stroke-linejoin: round;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/placenames.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;AACtB;;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,aAAa;IACb,WAAW;IACX,sBAAsB;AAC1B\",\"sourcesContent\":[\".em-placename {\\r\\n    text-anchor: start;\\r\\n}\\r\\n\\r\\n.em-placename-halo {\\r\\n    text-anchor: start;\\r\\n    fill:none;\\r\\n    stroke: white;\\r\\n    opacity:0.8;\\r\\n    stroke-linejoin: round;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-bivariate-nodata-label {\r\n    font-size: 14px;\r\n    dominant-baseline: middle;\r\n}\r\n.em-bivariate-tick-label {\r\n    text-anchor: middle;\r\n    font-size: 12px;\r\n}\r\n.em-bivariate-axis-title {\r\n    font-size: 15px;\r\n}\r\n.em-bivariate-tick {\r\n    stroke: #696969;\r\n    stroke-width: 1;\r\n}\r\n.em-bivariate-frame {\r\n    fill: none;\r\n    stroke: #696969;\r\n}\r\n.em-bivariate-nodata {\r\n    stroke: #696969;\r\n    stroke-width: 0.5;\r\n    cursor: pointer;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/bivariate-choropleth.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,eAAe;IACf,yBAAyB;AAC7B;AACA;IACI,mBAAmB;IACnB,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;IACf,eAAe;AACnB;AACA;IACI,UAAU;IACV,eAAe;AACnB;AACA;IACI,eAAe;IACf,iBAAiB;IACjB,eAAe;AACnB\",\"sourcesContent\":[\".em-bivariate-nodata-label {\\r\\n    font-size: 14px;\\r\\n    dominant-baseline: middle;\\r\\n}\\r\\n.em-bivariate-tick-label {\\r\\n    text-anchor: middle;\\r\\n    font-size: 12px;\\r\\n}\\r\\n.em-bivariate-axis-title {\\r\\n    font-size: 15px;\\r\\n}\\r\\n.em-bivariate-tick {\\r\\n    stroke: #696969;\\r\\n    stroke-width: 1;\\r\\n}\\r\\n.em-bivariate-frame {\\r\\n    fill: none;\\r\\n    stroke: #696969;\\r\\n}\\r\\n.em-bivariate-nodata {\\r\\n    stroke: #696969;\\r\\n    stroke-width: 0.5;\\r\\n    cursor: pointer;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/proportional-symbol.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_1___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/coxcomb.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_2___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/alpha.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_3___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/flow.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_4___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/pie.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_5___ from \"-!../../node_modules/css-loader/dist/cjs.js!./map-types/sparkline.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_1___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_2___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_3___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_4___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_5___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* wrapper DOM */\r\n.em-map-wrapper {\r\n    position: relative;\r\n    display: inline-block;\r\n}\r\n\r\n.em-map-wrapper > svg {\r\n    display: block;\r\n}\r\n\r\n\r\n/* General text settings */\r\ntext {\r\n    pointer-events: none;\r\n    font-family: Arial, Helvetica, sans-serif;\r\n}\r\n\r\na text {\r\n    pointer-events: all;\r\n}\r\n\r\n/* Main map */\r\n.em-map text,\r\n.em-legend text,\r\n.em-title,\r\n.em-subtitle,\r\n.em-footnote {\r\n    font-family: Arial, Helvetica, sans-serif;\r\n}\r\n\r\n.em-map.em-draggable g {\r\n    cursor: grab;\r\n}\r\n\r\n.em-map.em-dragging g {\r\n    cursor: grabbing;\r\n    cursor: -webkit-grabbing;\r\n}\r\n\r\n/* Coastal margin */\r\n.em-coastal-margin {\r\n    filter: url(#em-coastal-blur);\r\n    stroke-linejoin: round;\r\n    stroke-linecap: round;\r\n    fill: none;\r\n    stroke-width: 1;\r\n    stroke: rgb(0, 52, 107);\r\n}\r\n\r\n/* Title and subtitle styling */\r\n.em-title,\r\n.em-inset-title {\r\n    fill: #4c4b4b;\r\n    stroke: none;\r\n}\r\n\r\n.em-title {\r\n    font-size: 21px;\r\n    font-weight: bold;\r\n}\r\n\r\n.em-inset-title {\r\n    font-size: 11px;\r\n}\r\n\r\n.em-subtitle,\r\n.em-inset-subtitle {\r\n    fill: #4c4b4b;\r\n    fill-opacity: 0.9;\r\n    stroke: none;\r\n    stroke-linejoin: round;\r\n    paint-order: stroke;\r\n}\r\n\r\n.em-subtitle {\r\n    font-size: 18px;\r\n    font-weight: 100;\r\n}\r\n\r\n.em-inset-subtitle {\r\n    font-size: 12px;\r\n}\r\n\r\n.em-source-pretext {\r\n    fill: #848280;\r\n    font-size: 11px;\r\n    transform: translate(-5px, -5px);\r\n}\r\n\r\n.em-source-dataset-link {\r\n    font-size: 11px;\r\n    fill: #0e47cb;\r\n    cursor: pointer !important;\r\n    text-decoration: underline;\r\n    transform: translate(-5px, -5px);\r\n}\r\n\r\n.em-source-dataset-link:hover {\r\n    fill: #082b7a;\r\n    cursor: pointer !important;\r\n    text-decoration: underline;\r\n}\r\n\r\n.em-frame {\r\n    stroke-width: 0;\r\n    stroke: grey;\r\n}\r\n\r\n.em-insets .em-frame {\r\n    /* this will give a frame to inset maps */\r\n    stroke: grey;\r\n    stroke-width: 0.3px !important;\r\n}\r\n\r\n.em-sea {\r\n    fill: white;\r\n    /* pointer-events: none; */\r\n}\r\n\r\n.em-scalebar-line {\r\n    stroke: #696969;\r\n    stroke-width: 0.8px;\r\n}\r\n\r\n.em-scalebar-label {\r\n    font-size: 9px;\r\n    text-anchor: middle;\r\n}\r\n\r\n/* Bottom text and symbol styling */\r\n.em-footnote {\r\n    fill: #848280;\r\n    pointer-events: all;\r\n    cursor: pointer !important;\r\n    font-size: 11px;\r\n    transform: translate(5px, -5px);\r\n}\r\n\r\n.em-footnote a {\r\n    fill: #0e47cb;\r\n    text-decoration: underline;\r\n}\r\n\r\n.em-footnote a:hover {\r\n    fill: #0a328e;\r\n}\r\n\r\n.em-centroid, .em-coxcomb g {\r\n    cursor: pointer !important;\r\n}\r\n\r\n/* Graticule styling */\r\n.em-graticule {\r\n    stroke: lightgray;\r\n    stroke-width: 1;\r\n}\r\n\r\n.em-flow-link {\r\n    cursor: pointer !important;\r\n}\r\n\r\n.em-flow-link-outline {\r\n    cursor: pointer !important;\r\n}\r\n\r\n.em-flow-labels {\r\n    font-size: 15px;\r\n    stroke-width: 1px;\r\n    fill: #696969;\r\n    pointer-events: none;\r\n}\r\n\r\n.em-flow-labels-halo {\r\n    font-size: 15px;\r\n    stroke-width: 2px;\r\n    fill: white;\r\n    pointer-events: none;\r\n}\r\n\r\n.em-grid-rect,\r\n.em-grid-hexagon {\r\n    stroke: white;\r\n}\r\n\r\n.em-flow-donuts {\r\n    cursor: pointer !important;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map.css\"],\"names\":[],\"mappings\":\"AAOA,gBAAgB;AAChB;IACI,kBAAkB;IAClB,qBAAqB;AACzB;;AAEA;IACI,cAAc;AAClB;;;AAGA,0BAA0B;AAC1B;IACI,oBAAoB;IACpB,yCAAyC;AAC7C;;AAEA;IACI,mBAAmB;AACvB;;AAEA,aAAa;AACb;;;;;IAKI,yCAAyC;AAC7C;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,gBAAgB;IAChB,wBAAwB;AAC5B;;AAEA,mBAAmB;AACnB;IACI,6BAA6B;IAC7B,sBAAsB;IACtB,qBAAqB;IACrB,UAAU;IACV,eAAe;IACf,uBAAuB;AAC3B;;AAEA,+BAA+B;AAC/B;;IAEI,aAAa;IACb,YAAY;AAChB;;AAEA;IACI,eAAe;IACf,iBAAiB;AACrB;;AAEA;IACI,eAAe;AACnB;;AAEA;;IAEI,aAAa;IACb,iBAAiB;IACjB,YAAY;IACZ,sBAAsB;IACtB,mBAAmB;AACvB;;AAEA;IACI,eAAe;IACf,gBAAgB;AACpB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,gCAAgC;AACpC;;AAEA;IACI,eAAe;IACf,aAAa;IACb,0BAA0B;IAC1B,0BAA0B;IAC1B,gCAAgC;AACpC;;AAEA;IACI,aAAa;IACb,0BAA0B;IAC1B,0BAA0B;AAC9B;;AAEA;IACI,eAAe;IACf,YAAY;AAChB;;AAEA;IACI,yCAAyC;IACzC,YAAY;IACZ,8BAA8B;AAClC;;AAEA;IACI,WAAW;IACX,0BAA0B;AAC9B;;AAEA;IACI,eAAe;IACf,mBAAmB;AACvB;;AAEA;IACI,cAAc;IACd,mBAAmB;AACvB;;AAEA,mCAAmC;AACnC;IACI,aAAa;IACb,mBAAmB;IACnB,0BAA0B;IAC1B,eAAe;IACf,+BAA+B;AACnC;;AAEA;IACI,aAAa;IACb,0BAA0B;AAC9B;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,0BAA0B;AAC9B;;AAEA,sBAAsB;AACtB;IACI,iBAAiB;IACjB,eAAe;AACnB;;AAEA;IACI,0BAA0B;AAC9B;;AAEA;IACI,0BAA0B;AAC9B;;AAEA;IACI,eAAe;IACf,iBAAiB;IACjB,aAAa;IACb,oBAAoB;AACxB;;AAEA;IACI,eAAe;IACf,iBAAiB;IACjB,WAAW;IACX,oBAAoB;AACxB;;AAEA;;IAEI,aAAa;AACjB;;AAEA;IACI,0BAA0B;AAC9B\",\"sourcesContent\":[\"@import './map-types/proportional-symbol.css';\\r\\n@import './map-types/coxcomb.css';\\r\\n@import './map-types/alpha.css';\\r\\n@import './map-types/flow.css';\\r\\n@import './map-types/pie.css';\\r\\n@import './map-types/sparkline.css';\\r\\n\\r\\n/* wrapper DOM */\\r\\n.em-map-wrapper {\\r\\n    position: relative;\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n.em-map-wrapper > svg {\\r\\n    display: block;\\r\\n}\\r\\n\\r\\n\\r\\n/* General text settings */\\r\\ntext {\\r\\n    pointer-events: none;\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n}\\r\\n\\r\\na text {\\r\\n    pointer-events: all;\\r\\n}\\r\\n\\r\\n/* Main map */\\r\\n.em-map text,\\r\\n.em-legend text,\\r\\n.em-title,\\r\\n.em-subtitle,\\r\\n.em-footnote {\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n}\\r\\n\\r\\n.em-map.em-draggable g {\\r\\n    cursor: grab;\\r\\n}\\r\\n\\r\\n.em-map.em-dragging g {\\r\\n    cursor: grabbing;\\r\\n    cursor: -webkit-grabbing;\\r\\n}\\r\\n\\r\\n/* Coastal margin */\\r\\n.em-coastal-margin {\\r\\n    filter: url(#em-coastal-blur);\\r\\n    stroke-linejoin: round;\\r\\n    stroke-linecap: round;\\r\\n    fill: none;\\r\\n    stroke-width: 1;\\r\\n    stroke: rgb(0, 52, 107);\\r\\n}\\r\\n\\r\\n/* Title and subtitle styling */\\r\\n.em-title,\\r\\n.em-inset-title {\\r\\n    fill: #4c4b4b;\\r\\n    stroke: none;\\r\\n}\\r\\n\\r\\n.em-title {\\r\\n    font-size: 21px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.em-inset-title {\\r\\n    font-size: 11px;\\r\\n}\\r\\n\\r\\n.em-subtitle,\\r\\n.em-inset-subtitle {\\r\\n    fill: #4c4b4b;\\r\\n    fill-opacity: 0.9;\\r\\n    stroke: none;\\r\\n    stroke-linejoin: round;\\r\\n    paint-order: stroke;\\r\\n}\\r\\n\\r\\n.em-subtitle {\\r\\n    font-size: 18px;\\r\\n    font-weight: 100;\\r\\n}\\r\\n\\r\\n.em-inset-subtitle {\\r\\n    font-size: 12px;\\r\\n}\\r\\n\\r\\n.em-source-pretext {\\r\\n    fill: #848280;\\r\\n    font-size: 11px;\\r\\n    transform: translate(-5px, -5px);\\r\\n}\\r\\n\\r\\n.em-source-dataset-link {\\r\\n    font-size: 11px;\\r\\n    fill: #0e47cb;\\r\\n    cursor: pointer !important;\\r\\n    text-decoration: underline;\\r\\n    transform: translate(-5px, -5px);\\r\\n}\\r\\n\\r\\n.em-source-dataset-link:hover {\\r\\n    fill: #082b7a;\\r\\n    cursor: pointer !important;\\r\\n    text-decoration: underline;\\r\\n}\\r\\n\\r\\n.em-frame {\\r\\n    stroke-width: 0;\\r\\n    stroke: grey;\\r\\n}\\r\\n\\r\\n.em-insets .em-frame {\\r\\n    /* this will give a frame to inset maps */\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.3px !important;\\r\\n}\\r\\n\\r\\n.em-sea {\\r\\n    fill: white;\\r\\n    /* pointer-events: none; */\\r\\n}\\r\\n\\r\\n.em-scalebar-line {\\r\\n    stroke: #696969;\\r\\n    stroke-width: 0.8px;\\r\\n}\\r\\n\\r\\n.em-scalebar-label {\\r\\n    font-size: 9px;\\r\\n    text-anchor: middle;\\r\\n}\\r\\n\\r\\n/* Bottom text and symbol styling */\\r\\n.em-footnote {\\r\\n    fill: #848280;\\r\\n    pointer-events: all;\\r\\n    cursor: pointer !important;\\r\\n    font-size: 11px;\\r\\n    transform: translate(5px, -5px);\\r\\n}\\r\\n\\r\\n.em-footnote a {\\r\\n    fill: #0e47cb;\\r\\n    text-decoration: underline;\\r\\n}\\r\\n\\r\\n.em-footnote a:hover {\\r\\n    fill: #0a328e;\\r\\n}\\r\\n\\r\\n.em-centroid, .em-coxcomb g {\\r\\n    cursor: pointer !important;\\r\\n}\\r\\n\\r\\n/* Graticule styling */\\r\\n.em-graticule {\\r\\n    stroke: lightgray;\\r\\n    stroke-width: 1;\\r\\n}\\r\\n\\r\\n.em-flow-link {\\r\\n    cursor: pointer !important;\\r\\n}\\r\\n\\r\\n.em-flow-link-outline {\\r\\n    cursor: pointer !important;\\r\\n}\\r\\n\\r\\n.em-flow-labels {\\r\\n    font-size: 15px;\\r\\n    stroke-width: 1px;\\r\\n    fill: #696969;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.em-flow-labels-halo {\\r\\n    font-size: 15px;\\r\\n    stroke-width: 2px;\\r\\n    fill: white;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.em-grid-rect,\\r\\n.em-grid-hexagon {\\r\\n    stroke: white;\\r\\n}\\r\\n\\r\\n.em-flow-donuts {\\r\\n    cursor: pointer !important;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  module.exports = _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    function o(r, n) {\n      _regeneratorDefine(e, r, function (e) {\n        return this._invoke(r, n, e);\n      });\n    }\n    r ? i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2));\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _regeneratorDefine(e, r, n, t);\n}\nmodule.exports = _regeneratorDefine, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Sparkline maps */\r\n\r\n/*   muted country boundaries */\r\n.em--spark .em-cntbn {\r\n    stroke: grey;\r\n    stroke-width: 0.2px;\r\n}\r\n\r\n/*   muted nuts boundaries */\r\n.em--spark .em-bn-1,\r\n.em--spark .em-bn-2,\r\n.em--spark .em-bn-3,\r\n.em--spark .em-nutsrg [lvl='3'],\r\n.em--spark .em-nutsrg [lvl='2'],\r\n.em--spark .em-nutsrg [lvl='1'],\r\n.em--spark .em-bn-co {\r\n    stroke-width: 0.07px;\r\n}\r\n\r\n/*  muted country fill */\r\n.em--spark .em-cntrg {\r\n    fill: #f2f2f2;\r\n}\r\n\r\n/*  nuts fill (regions with data) */\r\n.em--spark .em-nutsrg {\r\n    fill: #fffeef;\r\n    /*fill: #c9ffd524;  very light green */\r\n    /*fill: #fffee724;  very light yellow */\r\n}\r\n\r\n/*  regions without data input */\r\n.em--spark [ecl=\"ni\"] {\r\n    fill: #e9e9e9;\r\n}\r\n\r\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\r\n.em--spark g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\r\n    stroke-width: 0px;\r\n}\r\n\r\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\r\n.em--spark .em-bn-co {\r\n    stroke: grey;\r\n    stroke-width: 0.1px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/sparkline.css\"],\"names\":[],\"mappings\":\"AAAA,mBAAmB;;AAEnB,+BAA+B;AAC/B;IACI,YAAY;IACZ,mBAAmB;AACvB;;AAEA,4BAA4B;AAC5B;;;;;;;IAOI,oBAAoB;AACxB;;AAEA,wBAAwB;AACxB;IACI,aAAa;AACjB;;AAEA,mCAAmC;AACnC;IACI,aAAa;IACb,sCAAsC;IACtC,uCAAuC;AAC3C;;AAEA,gCAAgC;AAChC;IACI,aAAa;AACjB;;AAEA,uHAAuH;AACvH;IACI,iBAAiB;AACrB;;AAEA,0HAA0H;AAC1H;IACI,YAAY;IACZ,mBAAmB;AACvB\",\"sourcesContent\":[\"/* Sparkline maps */\\r\\n\\r\\n/*   muted country boundaries */\\r\\n.em--spark .em-cntbn {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.2px;\\r\\n}\\r\\n\\r\\n/*   muted nuts boundaries */\\r\\n.em--spark .em-bn-1,\\r\\n.em--spark .em-bn-2,\\r\\n.em--spark .em-bn-3,\\r\\n.em--spark .em-nutsrg [lvl='3'],\\r\\n.em--spark .em-nutsrg [lvl='2'],\\r\\n.em--spark .em-nutsrg [lvl='1'],\\r\\n.em--spark .em-bn-co {\\r\\n    stroke-width: 0.07px;\\r\\n}\\r\\n\\r\\n/*  muted country fill */\\r\\n.em--spark .em-cntrg {\\r\\n    fill: #f2f2f2;\\r\\n}\\r\\n\\r\\n/*  nuts fill (regions with data) */\\r\\n.em--spark .em-nutsrg {\\r\\n    fill: #fffeef;\\r\\n    /*fill: #c9ffd524;  very light green */\\r\\n    /*fill: #fffee724;  very light yellow */\\r\\n}\\r\\n\\r\\n/*  regions without data input */\\r\\n.em--spark [ecl=\\\"ni\\\"] {\\r\\n    fill: #e9e9e9;\\r\\n}\\r\\n\\r\\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\\r\\n.em--spark g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\\r\\n    stroke-width: 0px;\\r\\n}\\r\\n\\r\\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\\r\\n.em--spark .em-bn-co {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.1px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nmodule.exports = _regeneratorValues, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var OverloadYield = require(\"./OverloadYield.js\");\nvar regenerator = require(\"./regenerator.js\");\nvar regeneratorAsync = require(\"./regeneratorAsync.js\");\nvar regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nvar regeneratorKeys = require(\"./regeneratorKeys.js\");\nvar regeneratorValues = require(\"./regeneratorValues.js\");\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-tooltip {\r\n    font-family: Arial;\r\n    color: #383838;\r\n    max-width: 300px;\r\n    overflow: hidden;\r\n    background: white;\r\n    padding: 0px;\r\n    border: 0px;\r\n    border-radius: 0px;\r\n    box-shadow:\r\n        0px 4px 6px rgba(0, 0, 0, 0.1),\r\n        0px 1px 3px rgba(0, 0, 0, 0.08);\r\n    position: absolute;\r\n    font-family: Helvetica, Arial, sans-serif;\r\n    pointer-events: none;\r\n    z-index: 99999999;\r\n}\r\n.em-tooltip-text {\r\n    background: #ffffff;\r\n    padding: 4px;\r\n    font-size: 15px;\r\n}\r\n.em-tooltip-bar {\r\n    background: #515560;\r\n    color: #ffffff;\r\n    padding: 6px;\r\n    font-size: 16px;\r\n}\r\n\r\n.em-footnote-tooltip {\r\n    background: #ffffff;\r\n    padding: 4px;\r\n    font-size: 12px;\r\n}\r\n.em-tooltip-table {\r\n    margin: 0px;\r\n}\r\n.em-tooltip-piechart-container {\r\n    text-align: center;\r\n    fill: #383838;\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n.em-tooltip-breakdown {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 2px;\r\n    font-size: 13px;\r\n    line-height: 1.2;\r\n    padding: 10px;\r\n    padding-top: 3px;\r\n}\r\n\r\n.em-breakdown-item {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n}\r\n\r\n.em-breakdown-color {\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 50%;\r\n    display: inline-block;\r\n    margin-right: 6px;\r\n    flex-shrink: 0;\r\n}\r\n\r\n.em-breakdown-label {\r\n    flex: 1;\r\n    color: #333;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.em-breakdown-value {\r\n    margin-left: 8px;\r\n    font-weight: 500;\r\n    color: #222;\r\n    white-space: nowrap;\r\n}\r\n\r\n.em-breakdown-item.em-total {\r\n    border-top: 1px solid #ccc;\r\n    margin-top: 3px;\r\n    padding-top: 3px;\r\n    font-weight: bold;\r\n}\r\n\r\n.em-cx-breakdown-item {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n}\r\n\r\n.em-tooltip-cx {\r\n    line-height: 1;\r\n    padding: 0px;\r\n}\r\n\r\n.em-tooltip-cx .em-breakdown-value,\r\n.em-tooltip-cx .em-breakdown-label,\r\n.em-tooltip-cx .em-breakdown-color {\r\n    margin: 0;\r\n    font-size: 11px; /* Smaller text for compactness */\r\n    white-space: nowrap;\r\n}\r\n\r\n.em-tooltip-cx-table {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n    table-layout: fixed;\r\n}\r\n\r\n.em-tooltip-cx-table th,\r\n.em-tooltip-cx-table td {\r\n    padding: 2px 4px; /* Minimal padding */\r\n    border: 1px solid #eee;\r\n}\r\n\r\n.em-tooltip-cx-table th {\r\n    background: #f7f7f7;\r\n    font-weight: bold;\r\n    font-size: 11px;\r\n}\r\n\r\n.em-tooltip-cx-table td {\r\n    font-size: 11px;\r\n    white-space: nowrap;\r\n}\r\n\r\n/* Make the Total value bold and right-aligned */\r\n.em-tooltip-cx-table .em-total td[colspan] {\r\n    text-align: right;\r\n    font-weight: bold !important;\r\n}\r\n\r\n/* Also make the inner number span bold */\r\n.em-tooltip-cx-table .em-total td[colspan] .em-breakdown-value {\r\n    font-weight: bold !important;\r\n}\r\n.em-total {\r\n    font-weight: bold !important;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/tooltip.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;IAClB,cAAc;IACd,gBAAgB;IAChB,gBAAgB;IAChB,iBAAiB;IACjB,YAAY;IACZ,WAAW;IACX,kBAAkB;IAClB;;uCAEmC;IACnC,kBAAkB;IAClB,yCAAyC;IACzC,oBAAoB;IACpB,iBAAiB;AACrB;AACA;IACI,mBAAmB;IACnB,YAAY;IACZ,eAAe;AACnB;AACA;IACI,mBAAmB;IACnB,cAAc;IACd,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,mBAAmB;IACnB,YAAY;IACZ,eAAe;AACnB;AACA;IACI,WAAW;AACf;AACA;IACI,kBAAkB;IAClB,aAAa;IACb,aAAa;IACb,uBAAuB;AAC3B;AACA;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,eAAe;IACf,gBAAgB;IAChB,aAAa;IACb,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;AAClC;;AAEA;IACI,UAAU;IACV,WAAW;IACX,kBAAkB;IAClB,qBAAqB;IACrB,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,OAAO;IACP,WAAW;IACX,mBAAmB;IACnB,gBAAgB;IAChB,uBAAuB;AAC3B;;AAEA;IACI,gBAAgB;IAChB,gBAAgB;IAChB,WAAW;IACX,mBAAmB;AACvB;;AAEA;IACI,0BAA0B;IAC1B,eAAe;IACf,gBAAgB;IAChB,iBAAiB;AACrB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;AAClC;;AAEA;IACI,cAAc;IACd,YAAY;AAChB;;AAEA;;;IAGI,SAAS;IACT,eAAe,EAAE,iCAAiC;IAClD,mBAAmB;AACvB;;AAEA;IACI,WAAW;IACX,yBAAyB;IACzB,mBAAmB;AACvB;;AAEA;;IAEI,gBAAgB,EAAE,oBAAoB;IACtC,sBAAsB;AAC1B;;AAEA;IACI,mBAAmB;IACnB,iBAAiB;IACjB,eAAe;AACnB;;AAEA;IACI,eAAe;IACf,mBAAmB;AACvB;;AAEA,gDAAgD;AAChD;IACI,iBAAiB;IACjB,4BAA4B;AAChC;;AAEA,yCAAyC;AACzC;IACI,4BAA4B;AAChC;AACA;IACI,4BAA4B;AAChC\",\"sourcesContent\":[\".em-tooltip {\\r\\n    font-family: Arial;\\r\\n    color: #383838;\\r\\n    max-width: 300px;\\r\\n    overflow: hidden;\\r\\n    background: white;\\r\\n    padding: 0px;\\r\\n    border: 0px;\\r\\n    border-radius: 0px;\\r\\n    box-shadow:\\r\\n        0px 4px 6px rgba(0, 0, 0, 0.1),\\r\\n        0px 1px 3px rgba(0, 0, 0, 0.08);\\r\\n    position: absolute;\\r\\n    font-family: Helvetica, Arial, sans-serif;\\r\\n    pointer-events: none;\\r\\n    z-index: 99999999;\\r\\n}\\r\\n.em-tooltip-text {\\r\\n    background: #ffffff;\\r\\n    padding: 4px;\\r\\n    font-size: 15px;\\r\\n}\\r\\n.em-tooltip-bar {\\r\\n    background: #515560;\\r\\n    color: #ffffff;\\r\\n    padding: 6px;\\r\\n    font-size: 16px;\\r\\n}\\r\\n\\r\\n.em-footnote-tooltip {\\r\\n    background: #ffffff;\\r\\n    padding: 4px;\\r\\n    font-size: 12px;\\r\\n}\\r\\n.em-tooltip-table {\\r\\n    margin: 0px;\\r\\n}\\r\\n.em-tooltip-piechart-container {\\r\\n    text-align: center;\\r\\n    fill: #383838;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n}\\r\\n.em-tooltip-breakdown {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 2px;\\r\\n    font-size: 13px;\\r\\n    line-height: 1.2;\\r\\n    padding: 10px;\\r\\n    padding-top: 3px;\\r\\n}\\r\\n\\r\\n.em-breakdown-item {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n}\\r\\n\\r\\n.em-breakdown-color {\\r\\n    width: 8px;\\r\\n    height: 8px;\\r\\n    border-radius: 50%;\\r\\n    display: inline-block;\\r\\n    margin-right: 6px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.em-breakdown-label {\\r\\n    flex: 1;\\r\\n    color: #333;\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n}\\r\\n\\r\\n.em-breakdown-value {\\r\\n    margin-left: 8px;\\r\\n    font-weight: 500;\\r\\n    color: #222;\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.em-breakdown-item.em-total {\\r\\n    border-top: 1px solid #ccc;\\r\\n    margin-top: 3px;\\r\\n    padding-top: 3px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.em-cx-breakdown-item {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx {\\r\\n    line-height: 1;\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx .em-breakdown-value,\\r\\n.em-tooltip-cx .em-breakdown-label,\\r\\n.em-tooltip-cx .em-breakdown-color {\\r\\n    margin: 0;\\r\\n    font-size: 11px; /* Smaller text for compactness */\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx-table {\\r\\n    width: 100%;\\r\\n    border-collapse: collapse;\\r\\n    table-layout: fixed;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx-table th,\\r\\n.em-tooltip-cx-table td {\\r\\n    padding: 2px 4px; /* Minimal padding */\\r\\n    border: 1px solid #eee;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx-table th {\\r\\n    background: #f7f7f7;\\r\\n    font-weight: bold;\\r\\n    font-size: 11px;\\r\\n}\\r\\n\\r\\n.em-tooltip-cx-table td {\\r\\n    font-size: 11px;\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n/* Make the Total value bold and right-aligned */\\r\\n.em-tooltip-cx-table .em-total td[colspan] {\\r\\n    text-align: right;\\r\\n    font-weight: bold !important;\\r\\n}\\r\\n\\r\\n/* Also make the inner number span bold */\\r\\n.em-tooltip-cx-table .em-total td[colspan] .em-breakdown-value {\\r\\n    font-weight: bold !important;\\r\\n}\\r\\n.em-total {\\r\\n    font-weight: bold !important;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../node_modules/css-loader/dist/cjs.js!./spinner.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-button {\r\n    width: 35px;\r\n    height: 35px;\r\n    user-select: none;\r\n    cursor: pointer;\r\n}\r\n\r\n.em-button rect {\r\n    fill: white;\r\n    stroke: #ccc;\r\n}\r\n\r\n.em-button rect:hover {\r\n    fill: lightgrey;\r\n}\r\n\r\n.em-button text {\r\n    text-anchor: middle;\r\n    font-size: 20px;\r\n    fill: #333333;\r\n}\r\n\r\n/* zoom  */\r\n.em-zoom-buttons {\r\n    transform: translate(94%, 10%);\r\n}\r\n\r\n/* insets */\r\n.em-insets-button {\r\n    transform: translate(94%, 2%);\r\n}\r\n\r\n.em-logo-group {\r\n    pointer-events: none;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/ui.css\"],\"names\":[],\"mappings\":\"AACA;IACI,WAAW;IACX,YAAY;IACZ,iBAAiB;IACjB,eAAe;AACnB;;AAEA;IACI,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,mBAAmB;IACnB,eAAe;IACf,aAAa;AACjB;;AAEA,UAAU;AACV;IACI,8BAA8B;AAClC;;AAEA,WAAW;AACX;IACI,6BAA6B;AACjC;;AAEA;IACI,oBAAoB;AACxB\",\"sourcesContent\":[\"@import 'spinner.css';\\r\\n.em-button {\\r\\n    width: 35px;\\r\\n    height: 35px;\\r\\n    user-select: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.em-button rect {\\r\\n    fill: white;\\r\\n    stroke: #ccc;\\r\\n}\\r\\n\\r\\n.em-button rect:hover {\\r\\n    fill: lightgrey;\\r\\n}\\r\\n\\r\\n.em-button text {\\r\\n    text-anchor: middle;\\r\\n    font-size: 20px;\\r\\n    fill: #333333;\\r\\n}\\r\\n\\r\\n/* zoom  */\\r\\n.em-zoom-buttons {\\r\\n    transform: translate(94%, 10%);\\r\\n}\\r\\n\\r\\n/* insets */\\r\\n.em-insets-button {\\r\\n    transform: translate(94%, 2%);\\r\\n}\\r\\n\\r\\n.em-logo-group {\\r\\n    pointer-events: none;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*   muted country fill */\r\n.em--alpha .em-cntrg,\r\n.em--alpha .em-cntrg {\r\n    fill: #f2f2f2;\r\n}\r\n\r\n/*   muted nuts fill */\r\n.em--alpha .em-nutsrg,\r\n.em--alpha .em-nutsrg {\r\n    fill: #fdfdfd;\r\n}\r\n\r\n/* Coastlines should not be drawn for choropleths, however for alpha maps with white regions they can be necessary */\r\n.em--alpha .em-bn-co {\r\n    stroke: grey;\r\n    stroke-width: 0.1px;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/alpha.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;AACzB;;IAEI,aAAa;AACjB;;AAEA,sBAAsB;AACtB;;IAEI,aAAa;AACjB;;AAEA,oHAAoH;AACpH;IACI,YAAY;IACZ,mBAAmB;AACvB\",\"sourcesContent\":[\"/*   muted country fill */\\r\\n.em--alpha .em-cntrg,\\r\\n.em--alpha .em-cntrg {\\r\\n    fill: #f2f2f2;\\r\\n}\\r\\n\\r\\n/*   muted nuts fill */\\r\\n.em--alpha .em-nutsrg,\\r\\n.em--alpha .em-nutsrg {\\r\\n    fill: #fdfdfd;\\r\\n}\\r\\n\\r\\n/* Coastlines should not be drawn for choropleths, however for alpha maps with white regions they can be necessary */\\r\\n.em--alpha .em-bn-co {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.1px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Proportional pie chart maps */\r\n\r\n/*   muted country boundaries */\r\n.em--pie .em-cntbn {\r\n    stroke: grey;\r\n}\r\n\r\n/*   muted nuts boundaries */\r\n.em--pie .em-bn-1,\r\n.em--pie .em-bn-2,\r\n.em--pie .em-bn-3,\r\n.em--pie .em-nutsrg [lvl='3'],\r\n.em--pie .em-nutsrg [lvl='2'],\r\n.em--pie .em-nutsrg [lvl='1'],\r\n.em--pie .em-bn-co {\r\n    stroke-width: 0.07px;\r\n}\r\n\r\n/*  muted country fill */\r\n.em--pie .em-cntrg {\r\n    fill: #f2f2f2;\r\n}\r\n\r\n/*  nuts fill (regions with data) */\r\n.em--pie .em-nutsrg {\r\n    fill: #fffeef;\r\n}\r\n\r\n/*  regions without data input */\r\n.em--pie [ecl=\"ni\"] {\r\n    fill: #f2f2f2;\r\n}\r\n\r\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\r\n.em--pie g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\r\n    stroke-width: 0px;\r\n}\r\n\r\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\r\n.em--pie .em-bn-co {\r\n    stroke: grey;\r\n    stroke-width: 0.2px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/map-types/pie.css\"],\"names\":[],\"mappings\":\"AAAA,gCAAgC;;AAEhC,+BAA+B;AAC/B;IACI,YAAY;AAChB;;AAEA,4BAA4B;AAC5B;;;;;;;IAOI,oBAAoB;AACxB;;AAEA,wBAAwB;AACxB;IACI,aAAa;AACjB;;AAEA,mCAAmC;AACnC;IACI,aAAa;AACjB;;AAEA,gCAAgC;AAChC;IACI,aAAa;AACjB;;AAEA,uHAAuH;AACvH;IACI,iBAAiB;AACrB;;AAEA,0HAA0H;AAC1H;IACI,YAAY;IACZ,mBAAmB;AACvB\",\"sourcesContent\":[\"/* Proportional pie chart maps */\\r\\n\\r\\n/*   muted country boundaries */\\r\\n.em--pie .em-cntbn {\\r\\n    stroke: grey;\\r\\n}\\r\\n\\r\\n/*   muted nuts boundaries */\\r\\n.em--pie .em-bn-1,\\r\\n.em--pie .em-bn-2,\\r\\n.em--pie .em-bn-3,\\r\\n.em--pie .em-nutsrg [lvl='3'],\\r\\n.em--pie .em-nutsrg [lvl='2'],\\r\\n.em--pie .em-nutsrg [lvl='1'],\\r\\n.em--pie .em-bn-co {\\r\\n    stroke-width: 0.07px;\\r\\n}\\r\\n\\r\\n/*  muted country fill */\\r\\n.em--pie .em-cntrg {\\r\\n    fill: #f2f2f2;\\r\\n}\\r\\n\\r\\n/*  nuts fill (regions with data) */\\r\\n.em--pie .em-nutsrg {\\r\\n    fill: #fffeef;\\r\\n}\\r\\n\\r\\n/*  regions without data input */\\r\\n.em--pie [ecl=\\\"ni\\\"] {\\r\\n    fill: #f2f2f2;\\r\\n}\\r\\n\\r\\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\\r\\n.em--pie g#em-cntbn>.em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\\r\\n    stroke-width: 0px;\\r\\n}\\r\\n\\r\\n/* Coastlines should not be drawn for choropleths, however for prop symbol maps with white regions they can be necessary */\\r\\n.em--pie .em-bn-co {\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.2px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-annotations {\r\n    /* pointer-events: none; */\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/annotations.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,0BAA0B;AAC9B\",\"sourcesContent\":[\".em-annotations {\\r\\n    /* pointer-events: none; */\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var OverloadYield = require(\"./OverloadYield.js\");\nvar regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nmodule.exports = AsyncIterator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-inset .em-zoom-buttons {\r\n    display: none;\r\n}\r\n.em-inset-title {\r\n    font-size: 11px;\r\n}\r\n.em-inset-subtitle {\r\n    font-size: 12px;\r\n}\r\n.em-insets .em-frame {\r\n    /* this will give a frame to inset maps */\r\n    stroke: grey;\r\n    stroke-width: 0.3px !important;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/insets.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,aAAa;AACjB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,yCAAyC;IACzC,YAAY;IACZ,8BAA8B;AAClC\",\"sourcesContent\":[\".em-inset .em-zoom-buttons {\\r\\n    display: none;\\r\\n}\\r\\n.em-inset-title {\\r\\n    font-size: 11px;\\r\\n}\\r\\n.em-inset-subtitle {\\r\\n    font-size: 12px;\\r\\n}\\r\\n.em-insets .em-frame {\\r\\n    /* this will give a frame to inset maps */\\r\\n    stroke: grey;\\r\\n    stroke-width: 0.3px !important;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `#g_worldbn,\r\n.em-worldrg,\r\n.em-worldbn,\r\n.em-worldbn-halo {\r\n    stroke-linecap: round;\r\n    stroke-linejoin: round;\r\n}\r\n\r\n.em-worldbn {\r\n    stroke: #4d4d4d;\r\n    stroke-width: 0.5px;\r\n}\r\n\r\n.em-worldbn,\r\n.em-worldbn-halo {\r\n    fill: none;\r\n}\r\n\r\n.em-worldrg {\r\n    fill: #efefef;\r\n    cursor: pointer;\r\n}\r\n\r\n.em-bn-d {\r\n    /* disputed */\r\n    stroke: #4d4d4d;\r\n    stroke-width: 0.1;\r\n    opacity: 0.9;\r\n    fill: none;\r\n    stroke-dasharray: 1 1;\r\n}\r\n\r\n/* world boundary halo (not coastline) */\r\n.em-worldbn-halo:not(.em-bn-co) {\r\n    stroke: rgba(216, 216, 216, 0.3);\r\n    stroke-width: 1px;\r\n}\r\n/* world boundary halo (not coastline, disputed) */\r\n.em-worldbn-halo:not(.em-bn-co) .em-bn-d {\r\n    stroke: rgba(141, 141, 141, 0.3);\r\n    stroke-width: 1px;\r\n    stroke-dasharray: 1 1;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/world.css\"],\"names\":[],\"mappings\":\"AAAA;;;;IAII,qBAAqB;IACrB,sBAAsB;AAC1B;;AAEA;IACI,eAAe;IACf,mBAAmB;AACvB;;AAEA;;IAEI,UAAU;AACd;;AAEA;IACI,aAAa;IACb,eAAe;AACnB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,iBAAiB;IACjB,YAAY;IACZ,UAAU;IACV,qBAAqB;AACzB;;AAEA,wCAAwC;AACxC;IACI,gCAAgC;IAChC,iBAAiB;AACrB;AACA,kDAAkD;AAClD;IACI,gCAAgC;IAChC,iBAAiB;IACjB,qBAAqB;AACzB\",\"sourcesContent\":[\"#g_worldbn,\\r\\n.em-worldrg,\\r\\n.em-worldbn,\\r\\n.em-worldbn-halo {\\r\\n    stroke-linecap: round;\\r\\n    stroke-linejoin: round;\\r\\n}\\r\\n\\r\\n.em-worldbn {\\r\\n    stroke: #4d4d4d;\\r\\n    stroke-width: 0.5px;\\r\\n}\\r\\n\\r\\n.em-worldbn,\\r\\n.em-worldbn-halo {\\r\\n    fill: none;\\r\\n}\\r\\n\\r\\n.em-worldrg {\\r\\n    fill: #efefef;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.em-bn-d {\\r\\n    /* disputed */\\r\\n    stroke: #4d4d4d;\\r\\n    stroke-width: 0.1;\\r\\n    opacity: 0.9;\\r\\n    fill: none;\\r\\n    stroke-dasharray: 1 1;\\r\\n}\\r\\n\\r\\n/* world boundary halo (not coastline) */\\r\\n.em-worldbn-halo:not(.em-bn-co) {\\r\\n    stroke: rgba(216, 216, 216, 0.3);\\r\\n    stroke-width: 1px;\\r\\n}\\r\\n/* world boundary halo (not coastline, disputed) */\\r\\n.em-worldbn-halo:not(.em-bn-co) .em-bn-d {\\r\\n    stroke: rgba(141, 141, 141, 0.3);\\r\\n    stroke-width: 1px;\\r\\n    stroke-dasharray: 1 1;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var regenerator = require(\"./regenerator.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nmodule.exports = _regeneratorAsyncGen, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.em-coxcomb-legend-time-label {\r\nfont-size: 13px;\r\n}\r\n.em-coxcomb-legend-time-segment {\r\n    stroke: #444;\r\n    stroke-width: 0.5;\r\n    opacity: 0.4;\r\n    fill: #ccc;\r\n    cursor: pointer;\r\n}\r\n.em-coxcomb-legend-time-segment {\r\n        stroke: #444;\r\n    stroke-width: 0.5;\r\n    opacity: 0.4;\r\n    fill: #ccc;\r\n    cursor: pointer;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/legend/coxcomb.css\"],\"names\":[],\"mappings\":\"AAAA;AACA,eAAe;AACf;AACA;IACI,YAAY;IACZ,iBAAiB;IACjB,YAAY;IACZ,UAAU;IACV,eAAe;AACnB;AACA;QACQ,YAAY;IAChB,iBAAiB;IACjB,YAAY;IACZ,UAAU;IACV,eAAe;AACnB\",\"sourcesContent\":[\".em-coxcomb-legend-time-label {\\r\\nfont-size: 13px;\\r\\n}\\r\\n.em-coxcomb-legend-time-segment {\\r\\n    stroke: #444;\\r\\n    stroke-width: 0.5;\\r\\n    opacity: 0.4;\\r\\n    fill: #ccc;\\r\\n    cursor: pointer;\\r\\n}\\r\\n.em-coxcomb-legend-time-segment {\\r\\n        stroke: #444;\\r\\n    stroke-width: 0.5;\\r\\n    opacity: 0.4;\\r\\n    fill: #ccc;\\r\\n    cursor: pointer;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* STYLING OF NUTS REGIONS AND BOUNDARIES */\r\n/* Default region fill */\r\n.em-cntrg,\r\n.em-nutsrg,\r\n.em-grid-cell {\r\n    fill: #e1e1e1;\r\n}\r\n\r\n.em-nutsrg,\r\n.em-cntrg,\r\n.em-grid-cell,\r\n#em-user-regions {\r\n    cursor: pointer !important;\r\n}\r\n\r\n/*  boundaries stroke-width */\r\n.em-bn-0 {\r\n    stroke: none;\r\n}\r\n.em-bn-1,\r\n.em-bn-2,\r\n.em-bn-3,\r\n/* when using MIXED NUTS levels, we add stroke to the regions, then show/hide those that have/dont have data */\r\n.em-nutsrg [lvl='3'],\r\n.em-nutsrg [lvl='2'],\r\n.em-nutsrg [lvl='1'],\r\n.em-bn-co {\r\n    stroke-width: 0.3;\r\n    stroke-opacity: 0.5;\r\n}\r\n\r\n/* all boudnaries and regions linecap/linejoin */\r\n#em-nutsbn,\r\n.em-cntbn,\r\n.em-cntbn-halo,\r\n.em-bn-0,\r\n.em-bn-1,\r\n.em-bn-2,\r\n.em-bn-3,\r\n.em-kosovo-bn,\r\n.em-bn-co,\r\n.em-nutsrg [lvl='3'],\r\n.em-nutsrg [lvl='2'],\r\n.em-nutsrg [lvl='1'],\r\n.em-cntrg,\r\n.em-nutsrg,\r\n.em-grid-cell {\r\n    stroke-linecap: round;\r\n    stroke-linejoin: round;\r\n}\r\n\r\n/* country boundaries */\r\n.em-cntbn {\r\n    stroke: #3f3f3f;\r\n    stroke-width: 1px;\r\n    stroke-opacity: 0.8;\r\n}\r\n\r\n/* country boundary halo (not coastline) */\r\n.em-cntbn-halo:not(.em-bn-co) {\r\n    stroke: rgba(216, 216, 216, 0.4);\r\n    stroke-width: 3px;\r\n}\r\n\r\n/* NUTS boundaries stroke color */\r\n.em-bn-1,\r\n.em-bn-2,\r\n.em-bn-3,\r\n.em-nutsrg [lvl='3'],\r\n.em-nutsrg [lvl='2'],\r\n.em-nutsrg [lvl='1'] {\r\n    stroke: #474747;\r\n}\r\n\r\n/* coastal boundaries */\r\n.em-bn-co {\r\n    stroke: white;\r\n}\r\n\r\n/* kosovo */\r\n.em-kosovo-bn {\r\n    stroke: #000;\r\n    stroke-width: 0.15;\r\n}\r\n\r\n/* dont fill certain elements */\r\n.em-frame,\r\n.em-graticule,\r\n.em-cntbn,\r\n.em-cntbn-halo,\r\n.em-bn-0,\r\n.em-bn-1,\r\n.em-bn-2,\r\n.em-bn-3,\r\n.em-kosovo-bn,\r\n.em-bn-co {\r\n    fill: none;\r\n    pointer-events: none;\r\n}\r\n\r\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\r\n/* g#em-cntbn > .em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\r\n    stroke-width: 0px;\r\n} */\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/NUTS.css\"],\"names\":[],\"mappings\":\"AAAA,2CAA2C;AAC3C,wBAAwB;AACxB;;;IAGI,aAAa;AACjB;;AAEA;;;;IAII,0BAA0B;AAC9B;;AAEA,6BAA6B;AAC7B;IACI,YAAY;AAChB;AACA;;;;;;;;IAQI,iBAAiB;IACjB,mBAAmB;AACvB;;AAEA,gDAAgD;AAChD;;;;;;;;;;;;;;;IAeI,qBAAqB;IACrB,sBAAsB;AAC1B;;AAEA,uBAAuB;AACvB;IACI,eAAe;IACf,iBAAiB;IACjB,mBAAmB;AACvB;;AAEA,0CAA0C;AAC1C;IACI,gCAAgC;IAChC,iBAAiB;AACrB;;AAEA,iCAAiC;AACjC;;;;;;IAMI,eAAe;AACnB;;AAEA,uBAAuB;AACvB;IACI,aAAa;AACjB;;AAEA,WAAW;AACX;IACI,YAAY;IACZ,kBAAkB;AACtB;;AAEA,+BAA+B;AAC/B;;;;;;;;;;IAUI,UAAU;IACV,oBAAoB;AACxB;;AAEA,uHAAuH;AACvH;;GAEG\",\"sourcesContent\":[\"/* STYLING OF NUTS REGIONS AND BOUNDARIES */\\r\\n/* Default region fill */\\r\\n.em-cntrg,\\r\\n.em-nutsrg,\\r\\n.em-grid-cell {\\r\\n    fill: #e1e1e1;\\r\\n}\\r\\n\\r\\n.em-nutsrg,\\r\\n.em-cntrg,\\r\\n.em-grid-cell,\\r\\n#em-user-regions {\\r\\n    cursor: pointer !important;\\r\\n}\\r\\n\\r\\n/*  boundaries stroke-width */\\r\\n.em-bn-0 {\\r\\n    stroke: none;\\r\\n}\\r\\n.em-bn-1,\\r\\n.em-bn-2,\\r\\n.em-bn-3,\\r\\n/* when using MIXED NUTS levels, we add stroke to the regions, then show/hide those that have/dont have data */\\r\\n.em-nutsrg [lvl='3'],\\r\\n.em-nutsrg [lvl='2'],\\r\\n.em-nutsrg [lvl='1'],\\r\\n.em-bn-co {\\r\\n    stroke-width: 0.3;\\r\\n    stroke-opacity: 0.5;\\r\\n}\\r\\n\\r\\n/* all boudnaries and regions linecap/linejoin */\\r\\n#em-nutsbn,\\r\\n.em-cntbn,\\r\\n.em-cntbn-halo,\\r\\n.em-bn-0,\\r\\n.em-bn-1,\\r\\n.em-bn-2,\\r\\n.em-bn-3,\\r\\n.em-kosovo-bn,\\r\\n.em-bn-co,\\r\\n.em-nutsrg [lvl='3'],\\r\\n.em-nutsrg [lvl='2'],\\r\\n.em-nutsrg [lvl='1'],\\r\\n.em-cntrg,\\r\\n.em-nutsrg,\\r\\n.em-grid-cell {\\r\\n    stroke-linecap: round;\\r\\n    stroke-linejoin: round;\\r\\n}\\r\\n\\r\\n/* country boundaries */\\r\\n.em-cntbn {\\r\\n    stroke: #3f3f3f;\\r\\n    stroke-width: 1px;\\r\\n    stroke-opacity: 0.8;\\r\\n}\\r\\n\\r\\n/* country boundary halo (not coastline) */\\r\\n.em-cntbn-halo:not(.em-bn-co) {\\r\\n    stroke: rgba(216, 216, 216, 0.4);\\r\\n    stroke-width: 3px;\\r\\n}\\r\\n\\r\\n/* NUTS boundaries stroke color */\\r\\n.em-bn-1,\\r\\n.em-bn-2,\\r\\n.em-bn-3,\\r\\n.em-nutsrg [lvl='3'],\\r\\n.em-nutsrg [lvl='2'],\\r\\n.em-nutsrg [lvl='1'] {\\r\\n    stroke: #474747;\\r\\n}\\r\\n\\r\\n/* coastal boundaries */\\r\\n.em-bn-co {\\r\\n    stroke: white;\\r\\n}\\r\\n\\r\\n/* kosovo */\\r\\n.em-kosovo-bn {\\r\\n    stroke: #000;\\r\\n    stroke-width: 0.15;\\r\\n}\\r\\n\\r\\n/* dont fill certain elements */\\r\\n.em-frame,\\r\\n.em-graticule,\\r\\n.em-cntbn,\\r\\n.em-cntbn-halo,\\r\\n.em-bn-0,\\r\\n.em-bn-1,\\r\\n.em-bn-2,\\r\\n.em-bn-3,\\r\\n.em-kosovo-bn,\\r\\n.em-bn-co {\\r\\n    fill: none;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n/* Hide non-nuts borders (country boundaries > that are 'other' and not coastal, not candidates, not eu and not efta) */\\r\\n/* g#em-cntbn > .em-bn-oth:not(.em-bn-co):not(.em-bn-cc):not(.em-bn-eu):not(.em-bn-efta) {\\r\\n    stroke-width: 0px;\\r\\n} */\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (module.exports = _regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".eurostatmap.min.js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/build/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","__webpack_require__.nc = undefined;","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./index.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./index.css\";\n       export default content && content.locals ? content.locals : undefined;\n","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nexport { _toConsumableArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nexport { _arrayWithoutHoles as default };","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nexport { _iterableToArray as default };","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableSpread as default };","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","// Given something array like (or null), returns something that is strictly an\n// array. This is used to ensure that array-like objects passed to d3.selectAll\n// or selection.selectAll are converted into proper arrays when creating a\n// selection; we dont ever want to create a selection backed by a live\n// HTMLCollection or NodeList. However, note that selection.selectAll will use a\n// static NodeList as a group, since it safely derived from querySelectorAll.\nexport default function array(x) {\n  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return Array.from(this.children);\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n\n// Given some data, this returns an array-like view of it: an object that\n// exposes a length property and allows numeric indexing. Note that unlike\n// selectAll, this isnt worried about live collections because the resulting\n// array will only be used briefly while data is being bound. (It is possible to\n// cause the data to change while iterating by using a key function, but please\n// dont; wed rather avoid a gratuitous copy.)\nfunction arraylike(data) {\n  return typeof data === \"object\" && \"length\" in data\n    ? data // Array, TypedArray, NodeList, array-like\n    : Array.from(data); // Map, Set, iterable, string, or anything else\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    return array(select.apply(this, arguments));\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  if (typeof onenter === \"function\") {\n    enter = onenter(enter);\n    if (enter) enter = enter.selection();\n  } else {\n    enter = enter.append(onenter + \"\");\n  }\n  if (onupdate != null) {\n    update = onupdate(update);\n    if (update) update = update.selection();\n  }\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(context) {\n  var selection = context.selection ? context.selection() : context;\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","export default function min(values, valueof) {\n  let min;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  }\n  return min;\n}\n","export default function max(values, valueof) {\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  }\n  return max;\n}\n","export default function number(x) {\n  return x === null ? NaN : +x;\n}\n\nexport function* numbers(values, valueof) {\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  }\n}\n","import max from \"./max.js\";\nimport maxIndex from \"./maxIndex.js\";\nimport min from \"./min.js\";\nimport minIndex from \"./minIndex.js\";\nimport quickselect from \"./quickselect.js\";\nimport number, {numbers} from \"./number.js\";\nimport {ascendingDefined} from \"./sort.js\";\nimport greatest from \"./greatest.js\";\n\nexport default function quantile(values, p, valueof) {\n  values = Float64Array.from(numbers(values, valueof));\n  if (!(n = values.length) || isNaN(p = +p)) return;\n  if (p <= 0 || n < 2) return min(values);\n  if (p >= 1) return max(values);\n  var n,\n      i = (n - 1) * p,\n      i0 = Math.floor(i),\n      value0 = max(quickselect(values, i0).subarray(0, i0 + 1)),\n      value1 = min(values.subarray(i0 + 1));\n  return value0 + (value1 - value0) * (i - i0);\n}\n\nexport function quantileSorted(values, p, valueof = number) {\n  if (!(n = values.length) || isNaN(p = +p)) return;\n  if (p <= 0 || n < 2) return +valueof(values[0], 0, values);\n  if (p >= 1) return +valueof(values[n - 1], n - 1, values);\n  var n,\n      i = (n - 1) * p,\n      i0 = Math.floor(i),\n      value0 = +valueof(values[i0], i0, values),\n      value1 = +valueof(values[i0 + 1], i0 + 1, values);\n  return value0 + (value1 - value0) * (i - i0);\n}\n\nexport function quantileIndex(values, p, valueof = number) {\n  if (isNaN(p = +p)) return;\n  numbers = Float64Array.from(values, (_, i) => number(valueof(values[i], i, values)));\n  if (p <= 0) return minIndex(numbers);\n  if (p >= 1) return maxIndex(numbers);\n  var numbers,\n      index = Uint32Array.from(values, (_, i) => i),\n      j = numbers.length - 1,\n      i = Math.floor(j * p);\n  quickselect(index, i, 0, j, (i, j) => ascendingDefined(numbers[i], numbers[j]));\n  i = greatest(index.subarray(0, i + 1), (i) => numbers[i]);\n  return i >= 0 ? i : -1;\n}\n","export default function ascending(a, b) {\n  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function descending(a, b) {\n  return a == null || b == null ? NaN\n    : b < a ? -1\n    : b > a ? 1\n    : b >= a ? 0\n    : NaN;\n}\n","import ascending from \"./ascending.js\";\nimport descending from \"./descending.js\";\n\nexport default function bisector(f) {\n  let compare1, compare2, delta;\n\n  // If an accessor is specified, promote it to a comparator. In this case we\n  // can test whether the search value is (self-) comparable. We cant do this\n  // for a comparator (except for specific, known comparators) because we cant\n  // tell if the comparator is symmetric, and an asymmetric comparator cant be\n  // used to test whether a single value is comparable.\n  if (f.length !== 2) {\n    compare1 = ascending;\n    compare2 = (d, x) => ascending(f(d), x);\n    delta = (d, x) => f(d) - x;\n  } else {\n    compare1 = f === ascending || f === descending ? f : zero;\n    compare2 = f;\n    delta = f;\n  }\n\n  function left(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function right(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) <= 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function center(a, x, lo = 0, hi = a.length) {\n    const i = left(a, x, lo, hi - 1);\n    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n  }\n\n  return {left, center, right};\n}\n\nfunction zero() {\n  return 0;\n}\n","import ascending from \"./ascending.js\";\nimport bisector from \"./bisector.js\";\nimport number from \"./number.js\";\n\nconst ascendingBisect = bisector(ascending);\nexport const bisectRight = ascendingBisect.right;\nexport const bisectLeft = ascendingBisect.left;\nexport const bisectCenter = bisector(number).center;\nexport default bisectRight;\n","export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: {\n      if (typeof domain === \"function\") this.interpolator(domain);\n      else this.range(domain);\n      break;\n    }\n    default: {\n      this.domain(domain);\n      if (typeof interpolator === \"function\") this.interpolator(interpolator);\n      else this.range(interpolator);\n      break;\n    }\n  }\n  return this;\n}\n","import {ascending, bisect, quantileSorted as threshold} from \"d3-array\";\nimport {initRange} from \"./init.js\";\n\nexport default function quantile() {\n  var domain = [],\n      range = [],\n      thresholds = [],\n      unknown;\n\n  function rescale() {\n    var i = 0, n = Math.max(1, range.length);\n    thresholds = new Array(n - 1);\n    while (++i < n) thresholds[i - 1] = threshold(domain, i / n);\n    return scale;\n  }\n\n  function scale(x) {\n    return x == null || isNaN(x = +x) ? unknown : range[bisect(thresholds, x)];\n  }\n\n  scale.invertExtent = function(y) {\n    var i = range.indexOf(y);\n    return i < 0 ? [NaN, NaN] : [\n      i > 0 ? thresholds[i - 1] : domain[0],\n      i < thresholds.length ? thresholds[i] : domain[domain.length - 1]\n    ];\n  };\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [];\n    for (let d of _) if (d != null && !isNaN(d = +d)) domain.push(d);\n    domain.sort(ascending);\n    return rescale();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.quantiles = function() {\n    return thresholds.slice();\n  };\n\n  scale.copy = function() {\n    return quantile()\n        .domain(domain)\n        .range(range)\n        .unknown(unknown);\n  };\n\n  return initRange.apply(scale, arguments);\n}\n","const e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nfunction tickSpec(start, stop, count) {\n  const step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log10(step)),\n      error = step / Math.pow(10, power),\n      factor = error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1;\n  let i1, i2, inc;\n  if (power < 0) {\n    inc = Math.pow(10, -power) / factor;\n    i1 = Math.round(start * inc);\n    i2 = Math.round(stop * inc);\n    if (i1 / inc < start) ++i1;\n    if (i2 / inc > stop) --i2;\n    inc = -inc;\n  } else {\n    inc = Math.pow(10, power) * factor;\n    i1 = Math.round(start / inc);\n    i2 = Math.round(stop / inc);\n    if (i1 * inc < start) ++i1;\n    if (i2 * inc > stop) --i2;\n  }\n  if (i2 < i1 && 0.5 <= count && count < 2) return tickSpec(start, stop, count * 2);\n  return [i1, i2, inc];\n}\n\nexport default function ticks(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  if (!(count > 0)) return [];\n  if (start === stop) return [start];\n  const reverse = stop < start, [i1, i2, inc] = reverse ? tickSpec(stop, start, count) : tickSpec(start, stop, count);\n  if (!(i2 >= i1)) return [];\n  const n = i2 - i1 + 1, ticks = new Array(n);\n  if (reverse) {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) * inc;\n  } else {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) * inc;\n  }\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  return tickSpec(start, stop, count)[2];\n}\n\nexport function tickStep(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  const reverse = stop < start, inc = reverse ? tickIncrement(stop, start, count) : tickIncrement(start, stop, count);\n  return (reverse ? -1 : 1) * (inc < 0 ? 1 / -inc : inc);\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default x => () => x;\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n","export default function number(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport constant from \"./constant.js\";\nimport number from \"./number.js\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(a, b) {\n  var t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    var n = Math.min(domain.length, range.length);\n    if (clamp !== identity) clamp = clamper(domain[0], domain[n - 1]);\n    piecewise = n > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = Array.from(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? true : identity, rescale()) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous() {\n  return transformer()(identity, identity);\n}\n","export default function constants(x) {\n  return function() {\n    return x;\n  };\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": (x, p) => (x * 100).toFixed(p),\n  \"b\": (x) => Math.round(x).toString(2),\n  \"c\": (x) => x + \"\",\n  \"d\": formatDecimal,\n  \"e\": (x, p) => x.toExponential(p),\n  \"f\": (x, p) => x.toFixed(p),\n  \"g\": (x, p) => x.toPrecision(p),\n  \"o\": (x) => Math.round(x).toString(8),\n  \"p\": (x, p) => formatRounded(x * 100, p),\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": (x) => Math.round(x).toString(16).toUpperCase(),\n  \"x\": (x) => Math.round(x).toString(16)\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer value part that can be\n        // grouped, and fractional or exponential suffix part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function tickFormat(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport tickFormat from \"./tickFormat.js\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain();\n    var i0 = 0;\n    var i1 = d.length - 1;\n    var start = d[i0];\n    var stop = d[i1];\n    var prestep;\n    var step;\n    var maxIter = 10;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n    \n    while (maxIter-- > 0) {\n      step = tickIncrement(start, stop, count);\n      if (step === prestep) {\n        d[i0] = start\n        d[i1] = stop\n        return domain(d);\n      } else if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n      } else {\n        break;\n      }\n      prestep = step;\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous();\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n","import {bisect} from \"d3-array\";\nimport {linearish} from \"./linear.js\";\nimport {initRange} from \"./init.js\";\n\nexport default function quantize() {\n  var x0 = 0,\n      x1 = 1,\n      n = 1,\n      domain = [0.5],\n      range = [0, 1],\n      unknown;\n\n  function scale(x) {\n    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n  }\n\n  function rescale() {\n    var i = -1;\n    domain = new Array(n);\n    while (++i < n) domain[i] = ((i + 1) * x1 - (i - n) * x0) / (n + 1);\n    return scale;\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? ([x0, x1] = _, x0 = +x0, x1 = +x1, rescale()) : [x0, x1];\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (n = (range = Array.from(_)).length - 1, rescale()) : range.slice();\n  };\n\n  scale.invertExtent = function(y) {\n    var i = range.indexOf(y);\n    return i < 0 ? [NaN, NaN]\n        : i < 1 ? [x0, domain[0]]\n        : i >= n ? [domain[n - 1], x1]\n        : [domain[i - 1], domain[i]];\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : scale;\n  };\n\n  scale.thresholds = function() {\n    return domain.slice();\n  };\n\n  scale.copy = function() {\n    return quantize()\n        .domain([x0, x1])\n        .range(range)\n        .unknown(unknown);\n  };\n\n  return initRange.apply(linearish(scale), arguments);\n}\n","import {bisect} from \"d3-array\";\nimport {initRange} from \"./init.js\";\n\nexport default function threshold() {\n  var domain = [0.5],\n      range = [0, 1],\n      unknown,\n      n = 1;\n\n  function scale(x) {\n    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_), n = Math.min(domain.length, range.length - 1), scale) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), n = Math.min(domain.length, range.length - 1), scale) : range.slice();\n  };\n\n  scale.invertExtent = function(y) {\n    var i = range.indexOf(y);\n    return [domain[i - 1], domain[i]];\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return threshold()\n        .domain(domain)\n        .range(range)\n        .unknown(unknown);\n  };\n\n  return initRange.apply(scale, arguments);\n}\n","export default function(specifier) {\n  var n = specifier.length / 6 | 0, colors = new Array(n), i = 0;\n  while (i < n) colors[i] = \"#\" + specifier.slice(i * 6, ++i * 6);\n  return colors;\n}\n","import {interpolateRgbBasis} from \"d3-interpolate\";\n\nexport default scheme => interpolateRgbBasis(scheme[scheme.length - 1]);\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"edf8b17fcdbb2c7fb8\",\n  \"ffffcca1dab441b6c4225ea8\",\n  \"ffffcca1dab441b6c42c7fb8253494\",\n  \"ffffccc7e9b47fcdbb41b6c42c7fb8253494\",\n  \"ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\n  \"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\n  \"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58\"\n).map(colors);\n\nexport default ramp(scheme);\n","export const radians = Math.PI / 180;\nexport const degrees = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nconst K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * degrees;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * radians;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","import {lab as colorLab} from \"d3-color\";\nimport color from \"./color.js\";\n\nexport default function lab(start, end) {\n  var l = color((start = colorLab(start)).l, (end = colorLab(end)).l),\n      a = color(start.a, end.a),\n      b = color(start.b, end.b),\n      opacity = color(start.opacity, end.opacity);\n  return function(t) {\n    start.l = l(t);\n    start.a = a(t);\n    start.b = b(t);\n    start.opacity = opacity(t);\n    return start + \"\";\n  };\n}\n","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","var noop = {value: () => {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend weve set an alarm, if we havent already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(undefined, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(elapsed => {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import decompose, {identity} from \"./decompose.js\";\n\nvar svgNode;\n\n/* eslint-disable no-undef */\nexport function parseCss(value) {\n  const m = new (typeof DOMMatrix === \"function\" ? DOMMatrix : WebKitCSSMatrix)(value + \"\");\n  return m.isIdentity ? identity : decompose(m.a, m.b, m.c, m.d, m.e, m.f);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import number from \"../number.js\";\nimport {parseCss, parseSvg} from \"./parse.js\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_easeVarying from \"./easeVarying.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  selectChild: selection_prototype.selectChild,\n  selectChildren: selection_prototype.selectChildren,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  easeVarying: transition_easeVarying,\n  end: transition_end,\n  [Symbol.iterator]: selection_prototype[Symbol.iterator]\n};\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {set} from \"./schedule.js\";\n\nfunction easeVarying(id, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (typeof v !== \"function\") throw new Error;\n    set(this, id).ease = v;\n  };\n}\n\nexport default function(value) {\n  if (typeof value !== \"function\") throw new Error;\n  return this.each(easeVarying(this._id, value));\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and were done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n\n    // The selection was empty, resolve end immediately\n    if (size === 0) resolve();\n  });\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      throw new Error(`transition ${id} not found`);\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolate} from \"d3-interpolate\";\nimport {pointer, select} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport BrushEvent from \"./event.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\nvar MODE_DRAG = {name: \"drag\"},\n    MODE_SPACE = {name: \"space\"},\n    MODE_HANDLE = {name: \"handle\"},\n    MODE_CENTER = {name: \"center\"};\n\nconst {abs, max, min} = Math;\n\nfunction number1(e) {\n  return [+e[0], +e[1]];\n}\n\nfunction number2(e) {\n  return [number1(e[0]), number1(e[1])];\n}\n\nvar X = {\n  name: \"x\",\n  handles: [\"w\", \"e\"].map(type),\n  input: function(x, e) { return x == null ? null : [[+x[0], e[0][1]], [+x[1], e[1][1]]]; },\n  output: function(xy) { return xy && [xy[0][0], xy[1][0]]; }\n};\n\nvar Y = {\n  name: \"y\",\n  handles: [\"n\", \"s\"].map(type),\n  input: function(y, e) { return y == null ? null : [[e[0][0], +y[0]], [e[1][0], +y[1]]]; },\n  output: function(xy) { return xy && [xy[0][1], xy[1][1]]; }\n};\n\nvar XY = {\n  name: \"xy\",\n  handles: [\"n\", \"w\", \"e\", \"s\", \"nw\", \"ne\", \"sw\", \"se\"].map(type),\n  input: function(xy) { return xy == null ? null : number2(xy); },\n  output: function(xy) { return xy; }\n};\n\nvar cursors = {\n  overlay: \"crosshair\",\n  selection: \"move\",\n  n: \"ns-resize\",\n  e: \"ew-resize\",\n  s: \"ns-resize\",\n  w: \"ew-resize\",\n  nw: \"nwse-resize\",\n  ne: \"nesw-resize\",\n  se: \"nwse-resize\",\n  sw: \"nesw-resize\"\n};\n\nvar flipX = {\n  e: \"w\",\n  w: \"e\",\n  nw: \"ne\",\n  ne: \"nw\",\n  se: \"sw\",\n  sw: \"se\"\n};\n\nvar flipY = {\n  n: \"s\",\n  s: \"n\",\n  nw: \"sw\",\n  ne: \"se\",\n  se: \"ne\",\n  sw: \"nw\"\n};\n\nvar signsX = {\n  overlay: +1,\n  selection: +1,\n  n: null,\n  e: +1,\n  s: null,\n  w: -1,\n  nw: -1,\n  ne: +1,\n  se: +1,\n  sw: -1\n};\n\nvar signsY = {\n  overlay: +1,\n  selection: +1,\n  n: -1,\n  e: null,\n  s: +1,\n  w: null,\n  nw: -1,\n  ne: -1,\n  se: +1,\n  sw: +1\n};\n\nfunction type(t) {\n  return {type: t};\n}\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter(event) {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultExtent() {\n  var svg = this.ownerSVGElement || this;\n  if (svg.hasAttribute(\"viewBox\")) {\n    svg = svg.viewBox.baseVal;\n    return [[svg.x, svg.y], [svg.x + svg.width, svg.y + svg.height]];\n  }\n  return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\n// Like d3.local, but with the name __brush rather than auto-generated.\nfunction local(node) {\n  while (!node.__brush) if (!(node = node.parentNode)) return;\n  return node.__brush;\n}\n\nfunction empty(extent) {\n  return extent[0][0] === extent[1][0]\n      || extent[0][1] === extent[1][1];\n}\n\nexport function brushSelection(node) {\n  var state = node.__brush;\n  return state ? state.dim.output(state.selection) : null;\n}\n\nexport function brushX() {\n  return brush(X);\n}\n\nexport function brushY() {\n  return brush(Y);\n}\n\nexport default function() {\n  return brush(XY);\n}\n\nfunction brush(dim) {\n  var extent = defaultExtent,\n      filter = defaultFilter,\n      touchable = defaultTouchable,\n      keys = true,\n      listeners = dispatch(\"start\", \"brush\", \"end\"),\n      handleSize = 6,\n      touchending;\n\n  function brush(group) {\n    var overlay = group\n        .property(\"__brush\", initialize)\n      .selectAll(\".overlay\")\n      .data([type(\"overlay\")]);\n\n    overlay.enter().append(\"rect\")\n        .attr(\"class\", \"overlay\")\n        .attr(\"pointer-events\", \"all\")\n        .attr(\"cursor\", cursors.overlay)\n      .merge(overlay)\n        .each(function() {\n          var extent = local(this).extent;\n          select(this)\n              .attr(\"x\", extent[0][0])\n              .attr(\"y\", extent[0][1])\n              .attr(\"width\", extent[1][0] - extent[0][0])\n              .attr(\"height\", extent[1][1] - extent[0][1]);\n        });\n\n    group.selectAll(\".selection\")\n      .data([type(\"selection\")])\n      .enter().append(\"rect\")\n        .attr(\"class\", \"selection\")\n        .attr(\"cursor\", cursors.selection)\n        .attr(\"fill\", \"#777\")\n        .attr(\"fill-opacity\", 0.3)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"shape-rendering\", \"crispEdges\");\n\n    var handle = group.selectAll(\".handle\")\n      .data(dim.handles, function(d) { return d.type; });\n\n    handle.exit().remove();\n\n    handle.enter().append(\"rect\")\n        .attr(\"class\", function(d) { return \"handle handle--\" + d.type; })\n        .attr(\"cursor\", function(d) { return cursors[d.type]; });\n\n    group\n        .each(redraw)\n        .attr(\"fill\", \"none\")\n        .attr(\"pointer-events\", \"all\")\n        .on(\"mousedown.brush\", started)\n      .filter(touchable)\n        .on(\"touchstart.brush\", started)\n        .on(\"touchmove.brush\", touchmoved)\n        .on(\"touchend.brush touchcancel.brush\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  brush.move = function(group, selection, event) {\n    if (group.tween) {\n      group\n          .on(\"start.brush\", function(event) { emitter(this, arguments).beforestart().start(event); })\n          .on(\"interrupt.brush end.brush\", function(event) { emitter(this, arguments).end(event); })\n          .tween(\"brush\", function() {\n            var that = this,\n                state = that.__brush,\n                emit = emitter(that, arguments),\n                selection0 = state.selection,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(this, arguments) : selection, state.extent),\n                i = interpolate(selection0, selection1);\n\n            function tween(t) {\n              state.selection = t === 1 && selection1 === null ? null : i(t);\n              redraw.call(that);\n              emit.brush();\n            }\n\n            return selection0 !== null && selection1 !== null ? tween : tween(1);\n          });\n    } else {\n      group\n          .each(function() {\n            var that = this,\n                args = arguments,\n                state = that.__brush,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(that, args) : selection, state.extent),\n                emit = emitter(that, args).beforestart();\n\n            interrupt(that);\n            state.selection = selection1 === null ? null : selection1;\n            redraw.call(that);\n            emit.start(event).brush(event).end(event);\n          });\n    }\n  };\n\n  brush.clear = function(group, event) {\n    brush.move(group, null, event);\n  };\n\n  function redraw() {\n    var group = select(this),\n        selection = local(this).selection;\n\n    if (selection) {\n      group.selectAll(\".selection\")\n          .style(\"display\", null)\n          .attr(\"x\", selection[0][0])\n          .attr(\"y\", selection[0][1])\n          .attr(\"width\", selection[1][0] - selection[0][0])\n          .attr(\"height\", selection[1][1] - selection[0][1]);\n\n      group.selectAll(\".handle\")\n          .style(\"display\", null)\n          .attr(\"x\", function(d) { return d.type[d.type.length - 1] === \"e\" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2; })\n          .attr(\"y\", function(d) { return d.type[0] === \"s\" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2; })\n          .attr(\"width\", function(d) { return d.type === \"n\" || d.type === \"s\" ? selection[1][0] - selection[0][0] + handleSize : handleSize; })\n          .attr(\"height\", function(d) { return d.type === \"e\" || d.type === \"w\" ? selection[1][1] - selection[0][1] + handleSize : handleSize; });\n    }\n\n    else {\n      group.selectAll(\".selection,.handle\")\n          .style(\"display\", \"none\")\n          .attr(\"x\", null)\n          .attr(\"y\", null)\n          .attr(\"width\", null)\n          .attr(\"height\", null);\n    }\n  }\n\n  function emitter(that, args, clean) {\n    var emit = that.__brush.emitter;\n    return emit && (!clean || !emit.clean) ? emit : new Emitter(that, args, clean);\n  }\n\n  function Emitter(that, args, clean) {\n    this.that = that;\n    this.args = args;\n    this.state = that.__brush;\n    this.active = 0;\n    this.clean = clean;\n  }\n\n  Emitter.prototype = {\n    beforestart: function() {\n      if (++this.active === 1) this.state.emitter = this, this.starting = true;\n      return this;\n    },\n    start: function(event, mode) {\n      if (this.starting) this.starting = false, this.emit(\"start\", event, mode);\n      else this.emit(\"brush\", event);\n      return this;\n    },\n    brush: function(event, mode) {\n      this.emit(\"brush\", event, mode);\n      return this;\n    },\n    end: function(event, mode) {\n      if (--this.active === 0) delete this.state.emitter, this.emit(\"end\", event, mode);\n      return this;\n    },\n    emit: function(type, event, mode) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new BrushEvent(type, {\n          sourceEvent: event,\n          target: brush,\n          selection: dim.output(this.state.selection),\n          mode,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function started(event) {\n    if (touchending && !event.touches) return;\n    if (!filter.apply(this, arguments)) return;\n\n    var that = this,\n        type = event.target.__data__.type,\n        mode = (keys && event.metaKey ? type = \"overlay\" : type) === \"selection\" ? MODE_DRAG : (keys && event.altKey ? MODE_CENTER : MODE_HANDLE),\n        signX = dim === Y ? null : signsX[type],\n        signY = dim === X ? null : signsY[type],\n        state = local(that),\n        extent = state.extent,\n        selection = state.selection,\n        W = extent[0][0], w0, w1,\n        N = extent[0][1], n0, n1,\n        E = extent[1][0], e0, e1,\n        S = extent[1][1], s0, s1,\n        dx = 0,\n        dy = 0,\n        moving,\n        shifting = signX && signY && keys && event.shiftKey,\n        lockX,\n        lockY,\n        points = Array.from(event.touches || [event], t => {\n          const i = t.identifier;\n          t = pointer(t, that);\n          t.point0 = t.slice();\n          t.identifier = i;\n          return t;\n        });\n\n    interrupt(that);\n    var emit = emitter(that, arguments, true).beforestart();\n\n    if (type === \"overlay\") {\n      if (selection) moving = true;\n      const pts = [points[0], points[1] || points[0]];\n      state.selection = selection = [[\n          w0 = dim === Y ? W : min(pts[0][0], pts[1][0]),\n          n0 = dim === X ? N : min(pts[0][1], pts[1][1])\n        ], [\n          e0 = dim === Y ? E : max(pts[0][0], pts[1][0]),\n          s0 = dim === X ? S : max(pts[0][1], pts[1][1])\n        ]];\n      if (points.length > 1) move(event);\n    } else {\n      w0 = selection[0][0];\n      n0 = selection[0][1];\n      e0 = selection[1][0];\n      s0 = selection[1][1];\n    }\n\n    w1 = w0;\n    n1 = n0;\n    e1 = e0;\n    s1 = s0;\n\n    var group = select(that)\n        .attr(\"pointer-events\", \"none\");\n\n    var overlay = group.selectAll(\".overlay\")\n        .attr(\"cursor\", cursors[type]);\n\n    if (event.touches) {\n      emit.moved = moved;\n      emit.ended = ended;\n    } else {\n      var view = select(event.view)\n          .on(\"mousemove.brush\", moved, true)\n          .on(\"mouseup.brush\", ended, true);\n      if (keys) view\n          .on(\"keydown.brush\", keydowned, true)\n          .on(\"keyup.brush\", keyupped, true)\n\n      dragDisable(event.view);\n    }\n\n    redraw.call(that);\n    emit.start(event, mode.name);\n\n    function moved(event) {\n      for (const p of event.changedTouches || [event]) {\n        for (const d of points)\n          if (d.identifier === p.identifier) d.cur = pointer(p, that);\n      }\n      if (shifting && !lockX && !lockY && points.length === 1) {\n        const point = points[0];\n        if (abs(point.cur[0] - point[0]) > abs(point.cur[1] - point[1]))\n          lockY = true;\n        else\n          lockX = true;\n      }\n      for (const point of points)\n        if (point.cur) point[0] = point.cur[0], point[1] = point.cur[1];\n      moving = true;\n      noevent(event);\n      move(event);\n    }\n\n    function move(event) {\n      const point = points[0], point0 = point.point0;\n      var t;\n\n      dx = point[0] - point0[0];\n      dy = point[1] - point0[1];\n\n      switch (mode) {\n        case MODE_SPACE:\n        case MODE_DRAG: {\n          if (signX) dx = max(W - w0, min(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;\n          if (signY) dy = max(N - n0, min(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;\n          break;\n        }\n        case MODE_HANDLE: {\n          if (points[1]) {\n            if (signX) w1 = max(W, min(E, points[0][0])), e1 = max(W, min(E, points[1][0])), signX = 1;\n            if (signY) n1 = max(N, min(S, points[0][1])), s1 = max(N, min(S, points[1][1])), signY = 1;\n          } else {\n            if (signX < 0) dx = max(W - w0, min(E - w0, dx)), w1 = w0 + dx, e1 = e0;\n            else if (signX > 0) dx = max(W - e0, min(E - e0, dx)), w1 = w0, e1 = e0 + dx;\n            if (signY < 0) dy = max(N - n0, min(S - n0, dy)), n1 = n0 + dy, s1 = s0;\n            else if (signY > 0) dy = max(N - s0, min(S - s0, dy)), n1 = n0, s1 = s0 + dy;\n          }\n          break;\n        }\n        case MODE_CENTER: {\n          if (signX) w1 = max(W, min(E, w0 - dx * signX)), e1 = max(W, min(E, e0 + dx * signX));\n          if (signY) n1 = max(N, min(S, n0 - dy * signY)), s1 = max(N, min(S, s0 + dy * signY));\n          break;\n        }\n      }\n\n      if (e1 < w1) {\n        signX *= -1;\n        t = w0, w0 = e0, e0 = t;\n        t = w1, w1 = e1, e1 = t;\n        if (type in flipX) overlay.attr(\"cursor\", cursors[type = flipX[type]]);\n      }\n\n      if (s1 < n1) {\n        signY *= -1;\n        t = n0, n0 = s0, s0 = t;\n        t = n1, n1 = s1, s1 = t;\n        if (type in flipY) overlay.attr(\"cursor\", cursors[type = flipY[type]]);\n      }\n\n      if (state.selection) selection = state.selection; // May be set by brush.move!\n      if (lockX) w1 = selection[0][0], e1 = selection[1][0];\n      if (lockY) n1 = selection[0][1], s1 = selection[1][1];\n\n      if (selection[0][0] !== w1\n          || selection[0][1] !== n1\n          || selection[1][0] !== e1\n          || selection[1][1] !== s1) {\n        state.selection = [[w1, n1], [e1, s1]];\n        redraw.call(that);\n        emit.brush(event, mode.name);\n      }\n    }\n\n    function ended(event) {\n      nopropagation(event);\n      if (event.touches) {\n        if (event.touches.length) return;\n        if (touchending) clearTimeout(touchending);\n        touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n      } else {\n        dragEnable(event.view, moving);\n        view.on(\"keydown.brush keyup.brush mousemove.brush mouseup.brush\", null);\n      }\n      group.attr(\"pointer-events\", \"all\");\n      overlay.attr(\"cursor\", cursors.overlay);\n      if (state.selection) selection = state.selection; // May be set by brush.move (on start)!\n      if (empty(selection)) state.selection = null, redraw.call(that);\n      emit.end(event, mode.name);\n    }\n\n    function keydowned(event) {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          shifting = signX && signY;\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_HANDLE) {\n            if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n            if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n            mode = MODE_CENTER;\n            move(event);\n          }\n          break;\n        }\n        case 32: { // SPACE; takes priority over ALT\n          if (mode === MODE_HANDLE || mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1 - dx; else if (signX > 0) w0 = w1 - dx;\n            if (signY < 0) s0 = s1 - dy; else if (signY > 0) n0 = n1 - dy;\n            mode = MODE_SPACE;\n            overlay.attr(\"cursor\", cursors.selection);\n            move(event);\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent(event);\n    }\n\n    function keyupped(event) {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          if (shifting) {\n            lockX = lockY = shifting = false;\n            move(event);\n          }\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n            if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n            mode = MODE_HANDLE;\n            move(event);\n          }\n          break;\n        }\n        case 32: { // SPACE\n          if (mode === MODE_SPACE) {\n            if (event.altKey) {\n              if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n              if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n              mode = MODE_CENTER;\n            } else {\n              if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n              if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n              mode = MODE_HANDLE;\n            }\n            overlay.attr(\"cursor\", cursors[type]);\n            move(event);\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent(event);\n    }\n  }\n\n  function touchmoved(event) {\n    emitter(this, arguments).moved(event);\n  }\n\n  function touchended(event) {\n    emitter(this, arguments).ended(event);\n  }\n\n  function initialize() {\n    var state = this.__brush || {selection: null};\n    state.extent = number2(extent.apply(this, arguments));\n    state.dim = dim;\n    return state;\n  }\n\n  brush.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant(number2(_)), brush) : extent;\n  };\n\n  brush.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), brush) : filter;\n  };\n\n  brush.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), brush) : touchable;\n  };\n\n  brush.handleSize = function(_) {\n    return arguments.length ? (handleSize = +_, brush) : handleSize;\n  };\n\n  brush.keyModifiers = function(_) {\n    return arguments.length ? (keys = !!_, brush) : keys;\n  };\n\n  brush.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? brush : value;\n  };\n\n  return brush;\n}\n","// These are typically used in conjunction with noevent to ensure that we can\n// preventDefault on the event.\nexport const nonpassive = {passive: false};\nexport const nonpassivecapture = {capture: true, passive: false};\n\nexport function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","var epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\nexport default (function zoomRho(rho, rho2, rho4) {\n\n  // p0 = [ux0, uy0, w0]\n  // p1 = [ux1, uy1, w1]\n  function zoom(p0, p1) {\n    var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n        ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n        dx = ux1 - ux0,\n        dy = uy1 - uy0,\n        d2 = dx * dx + dy * dy,\n        i,\n        S;\n\n    // Special case for u0  u1.\n    if (d2 < epsilon2) {\n      S = Math.log(w1 / w0) / rho;\n      i = function(t) {\n        return [\n          ux0 + t * dx,\n          uy0 + t * dy,\n          w0 * Math.exp(rho * t * S)\n        ];\n      }\n    }\n\n    // General case.\n    else {\n      var d1 = Math.sqrt(d2),\n          b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n          b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n          r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n          r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n      S = (r1 - r0) / rho;\n      i = function(t) {\n        var s = t * S,\n            coshr0 = cosh(r0),\n            u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n        return [\n          ux0 + u * dx,\n          uy0 + u * dy,\n          w0 * coshr0 / cosh(rho * s + r0)\n        ];\n      }\n    }\n\n    i.duration = S * 1000 * rho / Math.SQRT2;\n\n    return i;\n  }\n\n  zoom.rho = function(_) {\n    var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;\n    return zoomRho(_1, _2, _4);\n  };\n\n  return zoom;\n})(Math.SQRT2, 2, 4);\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","export default x => () => x;\n","export default function ZoomEvent(type, {\n  sourceEvent,\n  target,\n  transform,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    transform: {value: transform, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function Transform(k, x, y) {\n  this.k = k;\n  this.x = x;\n  this.y = y;\n}\n\nTransform.prototype = {\n  constructor: Transform,\n  scale: function(k) {\n    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);\n  },\n  translate: function(x, y) {\n    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);\n  },\n  apply: function(point) {\n    return [point[0] * this.k + this.x, point[1] * this.k + this.y];\n  },\n  applyX: function(x) {\n    return x * this.k + this.x;\n  },\n  applyY: function(y) {\n    return y * this.k + this.y;\n  },\n  invert: function(location) {\n    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];\n  },\n  invertX: function(x) {\n    return (x - this.x) / this.k;\n  },\n  invertY: function(y) {\n    return (y - this.y) / this.k;\n  },\n  rescaleX: function(x) {\n    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));\n  },\n  rescaleY: function(y) {\n    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));\n  },\n  toString: function() {\n    return \"translate(\" + this.x + \",\" + this.y + \") scale(\" + this.k + \")\";\n  }\n};\n\nexport var identity = new Transform(1, 0, 0);\n\ntransform.prototype = Transform.prototype;\n\nexport default function transform(node) {\n  while (!node.__zoom) if (!(node = node.parentNode)) return identity;\n  return node.__zoom;\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {select, pointer} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\n// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event\nfunction defaultFilter(event) {\n  return (!event.ctrlKey || event.type === 'wheel') && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta(event) {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchfirst,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0,\n      tapDistance = 10;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled, {passive: false})\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point, event) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point, event);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n          .event(event)\n          .start()\n          .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n          .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p, event) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p, event);\n  };\n\n  zoom.scaleTo = function(selection, k, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p, event);\n  };\n\n  zoom.translateBy = function(selection, x, y, event) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    }, null, event);\n  };\n\n  zoom.translateTo = function(selection, x, y, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p, event);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point, event) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).event(event).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).event(event).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args).event(event),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.sourceEvent = null;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    event: function(event) {\n      if (event) this.sourceEvent = event;\n      return this;\n    },\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new ZoomEvent(type, {\n          sourceEvent: this.sourceEvent,\n          target: zoom,\n          type,\n          transform: this.that.__zoom,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function wheeled(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, args).event(event),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = pointer(event);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event wont trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent(event);\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned(event, ...args) {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var currentTarget = event.currentTarget,\n        g = gesture(this, args, true).event(event),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = pointer(event, currentTarget),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation(event);\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved(event) {\n      noevent(event);\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.event(event)\n       .zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped(event) {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent(event);\n      g.event(event).end();\n    }\n  }\n\n  function dblclicked(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);\n\n    noevent(event);\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);\n    else select(this).call(zoom.transform, t1, p0, event);\n  }\n\n  function touchstarted(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, args, event.changedTouches.length === n).event(event),\n        started, i, t, p;\n\n    nopropagation(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation(event);\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        t = pointer(t, this);\n        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {\n          var p = select(this).on(\"dblclick.zoom\");\n          if (p) p.apply(this, arguments);\n        }\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  zoom.tapDistance = function(_) {\n    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;\n  };\n\n  return zoom;\n}\n","import {select} from \"d3-selection\";\nimport noevent, {nonpassivecapture} from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, nonpassivecapture);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, nonpassivecapture);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, nonpassivecapture);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","import { color, scaleLinear } from 'd3'\r\n\r\n// Ensures a <g> element with the specified class exists within the container.\r\n// If it exists, clears its contents; if not, creates it.\r\nexport function ensureGroup(container, className) {\r\n    let g = container.select(`g.${className}`)\r\n\r\n    if (g.empty()) {\r\n        g = container.append('g').attr('class', className)\r\n    } else {\r\n        g.selectAll('*').remove()\r\n    }\r\n\r\n    return g\r\n}\r\n\r\n// e.g. to be used with deprecated .style() functions. They will now update CSS classes.\r\nexport function updateCSSRule(selector, property, value) {\r\n    // Validate the selector\r\n    if (!selector.startsWith('.') && !selector.startsWith('#')) {\r\n        throw new Error('Invalid selector: Must start with \".\" for classes or \"#\" for IDs.')\r\n    }\r\n\r\n    // Check if the rule already exists in any stylesheet\r\n    const styleSheets = Array.from(document.styleSheets)\r\n    for (const styleSheet of styleSheets) {\r\n        try {\r\n            const rules = styleSheet.cssRules || styleSheet.rules\r\n            for (const rule of rules) {\r\n                if (rule.selectorText === selector) {\r\n                    // Update the property if the rule exists\r\n                    rule.style[property] = value\r\n                    return\r\n                }\r\n            }\r\n        } catch (e) {\r\n            // Some stylesheets (e.g., cross-origin) may not be accessible\r\n            //console.log(`Could not access rules in stylesheet:`, e)\r\n        }\r\n    }\r\n\r\n    // If the rule doesn't exist, create a new stylesheet and add it\r\n    let customSheet = document.getElementById('custom-styles')\r\n    if (!customSheet) {\r\n        customSheet = document.createElement('style')\r\n        customSheet.id = 'custom-styles'\r\n        document.head.appendChild(customSheet)\r\n    }\r\n\r\n    // Add the new rule to the custom stylesheet\r\n    try {\r\n        customSheet.sheet.insertRule(`${selector} { ${property}: ${value}; }`, customSheet.sheet.cssRules.length)\r\n    } catch (e) {\r\n        console.error(`Failed to insert rule: ${selector} { ${property}: ${value}; }`, e)\r\n    }\r\n}\r\n\r\nexport const getFontSizeFromClass = function (className) {\r\n    // Create a temporary element with the specified class\r\n    const tempElement = document.createElement('div')\r\n    tempElement.className = className\r\n\r\n    // Apply inline styles to minimize layout interference\r\n    tempElement.style.position = 'absolute'\r\n    tempElement.style.visibility = 'hidden'\r\n    tempElement.style.height = 'auto'\r\n    tempElement.style.width = 'auto'\r\n    tempElement.style.lineHeight = 'normal'\r\n    tempElement.style.fontSize = 'initial'\r\n\r\n    // Append directly to the body\r\n    document.body.appendChild(tempElement)\r\n\r\n    // Get the computed font-size property and parse it to a number\r\n    const fontSize = parseFloat(window.getComputedStyle(tempElement).fontSize)\r\n\r\n    // Remove the temporary element from the document body\r\n    document.body.removeChild(tempElement)\r\n\r\n    return fontSize || 0\r\n}\r\n\r\nexport const getCSSPropertyFromClass = function (className, propertyName) {\r\n    // Create a temporary element with the specified class\r\n    const tempElement = document.createElement('div')\r\n    tempElement.className = className\r\n\r\n    // Apply inline styles to minimize layout interference\r\n    tempElement.style.position = 'absolute'\r\n    tempElement.style.visibility = 'hidden'\r\n    tempElement.style.height = 'auto'\r\n    //tempElement.style.width = 'auto'\r\n    tempElement.style.lineHeight = 'normal'\r\n\r\n    // Append directly to the body\r\n    document.body.appendChild(tempElement)\r\n\r\n    // Get the computed value of the specified property\r\n    const propertyValue = window.getComputedStyle(tempElement).getPropertyValue(propertyName)\r\n\r\n    // Remove the temporary element from the document body\r\n    document.body.removeChild(tempElement)\r\n\r\n    return propertyValue || null\r\n}\r\n\r\n// Helper function to get all CSS rules defined in the document\r\nfunction getAllCSSRules() {\r\n    let cssRules = []\r\n    for (let sheet of document.styleSheets) {\r\n        try {\r\n            // Some stylesheets may not be accessible due to CORS, so we catch any errors\r\n            for (let rule of sheet.cssRules) {\r\n                cssRules.push(rule)\r\n            }\r\n        } catch (e) {\r\n            console.warn('Unable to access stylesheet:', sheet.href, e)\r\n        }\r\n    }\r\n    return cssRules\r\n}\r\n\r\n// Helper function to get explicitly defined styles from CSS for an element\r\nfunction getStylesFromCSS(element) {\r\n    let matchedRules = []\r\n    const cssRules = getAllCSSRules()\r\n\r\n    cssRules.forEach((rule) => {\r\n        if (element.matches(rule.selectorText)) {\r\n            matchedRules.push(rule.style)\r\n        }\r\n    })\r\n\r\n    // Create an object of the explicitly set styles\r\n    let explicitStyles = {}\r\n    matchedRules.forEach((style) => {\r\n        for (let i = 0; i < style.length; i++) {\r\n            const property = style[i]\r\n            explicitStyles[property] = style.getPropertyValue(property)\r\n        }\r\n    })\r\n\r\n    return explicitStyles\r\n}\r\n\r\n// Helper function to apply inline styles explicitly set in CSS. Useful for exporting SVGs with CSS styles.\r\nexport const applyInlineStylesFromCSS = (svgElement) => {\r\n    const allElements = svgElement.querySelectorAll('*')\r\n\r\n    allElements.forEach((element) => {\r\n        const cssStyles = getStylesFromCSS(element)\r\n\r\n        // Apply each explicitly defined CSS style as an inline style\r\n        Object.keys(cssStyles).forEach((property) => {\r\n            const value = cssStyles[property]\r\n\r\n            // Check if the property already has an inline style\r\n            const existingInlineStyle = element.style.getPropertyValue(property)\r\n\r\n            if (!existingInlineStyle && value) {\r\n                // If no existing inline style, set the new style\r\n                element.style.setProperty(property, value)\r\n            }\r\n        })\r\n    })\r\n}\r\n\r\n/**\r\n * Copy computed styles (a curated property list) into inline styles for all elements\r\n * so the serialized SVG renders the same as in-browser.\r\n *\r\n * Usage: call this right before serialize(svg) or rasterize(svg)\r\n */\r\nexport function applyComputedStylesToSVG(svg) {\r\n    if (!svg || !(svg instanceof SVGElement)) return\r\n\r\n    const PAINT_PROPS = new Set([\r\n        'fill',\r\n        'fill-opacity',\r\n        'fill-rule',\r\n        'stroke',\r\n        'stroke-width',\r\n        'stroke-opacity',\r\n        'stroke-linecap',\r\n        'stroke-linejoin',\r\n        'stroke-dasharray',\r\n        'stroke-dashoffset',\r\n    ])\r\n\r\n    const PROPS = [\r\n        // painting (includes PAINT_PROPS)\r\n        ...Array.from(PAINT_PROPS),\r\n        // geometry / alignment\r\n        'vector-effect',\r\n        'shape-rendering',\r\n        'text-anchor',\r\n        'dominant-baseline',\r\n        // text\r\n        'font-family',\r\n        'font-size',\r\n        'font-style',\r\n        'font-weight',\r\n        'letter-spacing',\r\n        'word-spacing',\r\n        'line-height',\r\n        // layout / visibility\r\n        'opacity',\r\n        'visibility',\r\n        'display',\r\n        'mix-blend-mode',\r\n        // filters, marker, etc\r\n        'filter',\r\n        'marker-start',\r\n        'marker-mid',\r\n        'marker-end',\r\n        // others\r\n        'transform',\r\n    ]\r\n\r\n    function inlineComputedStyle(el) {\r\n        const cs = window.getComputedStyle(el)\r\n\r\n        PROPS.forEach((p) => {\r\n            try {\r\n                const v = cs.getPropertyValue(p)\r\n\r\n                // skip empty / trivial values\r\n                if (!v || v === '' || v === 'initial') return\r\n\r\n                // Allow 'none' for paint properties (fill/stroke)  these are meaningful\r\n                if (v === 'none' && !PAINT_PROPS.has(p)) return\r\n\r\n                // Skip '0px' for properties where that is meaningless (but keep it for stroke-width)\r\n                if (v === '0px' && p !== 'stroke-width') return\r\n\r\n                // Only set if not already present as inline style\r\n                if (!el.style.getPropertyValue(p)) {\r\n                    el.style.setProperty(p, v)\r\n                }\r\n            } catch (e) {\r\n                // ignore properties that error for this element\r\n            }\r\n        })\r\n\r\n        // for text elements ensure font-size is captured if computed\r\n        if (el.tagName && el.tagName.toLowerCase() === 'text') {\r\n            const fs = cs.getPropertyValue('font-size')\r\n            if (fs && !el.style.getPropertyValue('font-size')) el.style.setProperty('font-size', fs)\r\n        }\r\n    }\r\n\r\n    inlineComputedStyle(svg)\r\n    svg.querySelectorAll('*').forEach((el) => inlineComputedStyle(el))\r\n}\r\nexport function ensureSvgSize(svg) {\r\n    const rect = svg.getBoundingClientRect()\r\n    // Use integer pixel width/height\r\n    const w = Math.round(rect.width) || parseInt(svg.getAttribute('width')) || 800\r\n    const h = Math.round(rect.height) || parseInt(svg.getAttribute('height')) || 600\r\n\r\n    // If svg already has viewBox, preserve it; else set viewBox to current content box\r\n    if (!svg.hasAttribute('viewBox')) {\r\n        svg.setAttribute('viewBox', `0 0 ${w} ${h}`)\r\n    }\r\n    svg.setAttribute('width', w)\r\n    svg.setAttribute('height', h)\r\n}\r\n\r\n/**\r\n * Return a GeoJSON feature representing a bounding box, with multipoint geometry.\r\n * This bounding box is an array like the one in topojson bbox element.\r\n * [xmin,ymin,xmax,ymax]\r\n * This is useful for to call d3.fitSize([w, h], getTopoJSONExtentAsGeoJSON(topo.bbox)))\r\n *\r\n * @param {*} bb The bounding box [xmin,ymin,xmax,ymax]. For topojson data, just give the topojson.bbox element.\r\n */\r\nexport const getBBOXAsGeoJSON = function (bb) {\r\n    return {\r\n        type: 'Feature',\r\n        geometry: {\r\n            type: 'MultiPoint',\r\n            coordinates: [\r\n                [bb[0], bb[1]],\r\n                [bb[2], bb[3]],\r\n            ],\r\n        },\r\n    }\r\n}\r\n\r\n// indexing\r\n\r\n/**\r\n * Index JSONStat stat values by 'geo' code.\r\n * Return a structure like: {geo:{value:0,status:\"\"}}\r\n *\r\n * @param {*} jsData The JSONStat data to index\r\n */\r\nexport const jsonstatToIndex = function (jsData) {\r\n    const ind = {}\r\n    const geos = jsData.Dimension('geo').id\r\n    for (let i = 0; i < geos.length; i++) ind[geos[i]] = jsData.Data(i)\r\n    return ind\r\n}\r\n\r\n/**\r\n * Index CSV stat values by 'geo' code.\r\n * Return a structure like: {geo:{value:0,status:\"\"}}\r\n *\r\n * @param {*} csvData The CSV data to index\r\n * @param {*} geoCol The name of the geo column in the CSV data\r\n * @param {*} valueCol The name of the statistical value column in the CSV file.\r\n */\r\nexport const csvToIndex = function (csvData, geoCol, valueCol) {\r\n    const ind = {}\r\n    for (let i = 0; i < csvData.length; i++) {\r\n        const d = csvData[i]\r\n        const v = d[valueCol]\r\n        if (!v) {\r\n            ind[d[geoCol]] = { value: ':', status: '' }\r\n        } else {\r\n            ind[d[geoCol]] = { value: isNaN(+v) ? v : +v, status: '' }\r\n        }\r\n    }\r\n    return ind\r\n}\r\n\r\n/**\r\n * @description returns string with space as thousand separator\r\n * @function spaceAsThousandSeparator\r\n * @param {number} number\r\n */\r\nexport const spaceAsThousandSeparator = function (number) {\r\n    return number.toLocaleString('en').replace(/,/gi, ' ')\r\n}\r\n\r\n//REST API\r\nexport const getEstatRestDataURLBase = 'https://ec.europa.eu/eurostat/api/dissemination/statistics/1.0/data/' //the different dataswag endpoints are appended to this base URL\r\n\r\n// This function builds a URL to fetch data from the Eurobase REST API.\r\n\r\n/**\r\n * Build URL to fetch data from eurobase REST API.\r\n * @param {string} datasetCode The Eurobase dataset code\r\n * @param {object=} filters The filter parameters as for example: {key:value,key:[value1,value2,value3]}\r\n * @param {number=} lang\r\n * @param {number=} format\r\n * @param {number=} version\r\n */\r\nexport const getEstatDataURL = function (datasetCode, filters, lang, format) {\r\n    lang = lang || 'en'\r\n    format = format || 'json'\r\n    var url = []\r\n    url.push(getEstatRestDataURLBase, datasetCode, '?', 'format=', format, '&lang=', lang)\r\n    if (filters)\r\n        for (var param in filters) {\r\n            var o = filters[param]\r\n            if (Array.isArray(o)) for (var i = 0; i < o.length; i++) url.push('&', param, '=', o[i])\r\n            else url.push('&', param, '=', o)\r\n        }\r\n    return url.join('')\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n * @returns {string}\r\n */\r\nexport const getURLParameterByName = function (name) {\r\n    name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]')\r\n    var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)'),\r\n        results = regex.exec(location.search)\r\n    return !results ? null : decodeURIComponent(results[1].replace(/\\+/g, ' '))\r\n}\r\n\r\nexport const checkIfDiverging = function (map) {\r\n    return map.pointOfDivergence_ !== null\r\n}\r\n\r\n/**\r\n * Wraps a diverging color interpolator so that it centers around a meaningful divergence point.\r\n * Ensures that transformed values are mapped symmetrically around the divergence point (e.g. 0).\r\n *\r\n * @param {function} colorFunc - A diverging color interpolator (e.g. d3.interpolateRdBu)\r\n * @param {[number, number]} domain - Raw data domain (min, max) before transformation\r\n * @param {number} pointOfDivergence - The central value of interest (e.g. 0 for positive vs. negative)\r\n * @param {function} transform - A value transform function (e.g. Math.log, Math.asinh)\r\n * @returns {function} - A color function that accepts raw values and returns color strings\r\n */\r\nexport const centerDivergingColorFunction = function (colorFunc, domain, pointOfDivergence = 0, transform = (d) => d) {\r\n    // Apply valueTransform to all domain boundaries and divergence point\r\n    const valueTransform = transform || ((d) => d)\r\n\r\n    const tMin = valueTransform(domain[0]) // Transformed lower bound\r\n    const tMax = valueTransform(domain[1]) // Transformed upper bound\r\n    const tDiv = valueTransform(pointOfDivergence) // Transformed center/divergence point\r\n\r\n    // Create a diverging scale: [min  center  max]  [0  0.5  1]\r\n    const scaled = scaleLinear().domain([tMin, tDiv, tMax]).range([0, 0.5, 1]).clamp(true) // Prevent extrapolation beyond 01\r\n\r\n    // Return a function that applies the transform and maps through the scaled color interpolator\r\n    return function (value) {\r\n        return colorFunc(scaled(valueTransform(value)))\r\n    }\r\n}\r\n\r\n/**\r\n * Generates a unique DOM ID\r\n * @param {string} prefix - Prefix for the ID\r\n * @returns {string} Unique ID\r\n */\r\nexport function generateUniqueId(prefix) {\r\n    return `${prefix}-${Math.random().toString(36).substr(2, 9)}`\r\n}\r\n\r\n//flags\r\nexport const flags = {\r\n    b: 'break in time series',\r\n    c: 'confidential',\r\n    d: 'definition differs, see metadata',\r\n    e: 'estimated',\r\n    f: 'forecast',\r\n    n: 'not significant',\r\n    p: 'provisional',\r\n    r: 'revised',\r\n    s: 'Eurostat estimate',\r\n    u: 'low reliability',\r\n    z: 'not applicable',\r\n}\r\n\r\n/**\r\n * @description Executes a function for all inset maps. Some insets might be external SVGs which is why this function was created.\r\n * @param {*} insets map.insets\r\n * @param {*} mainSvgId the ID of the map's svg\r\n * @param {*} callback the function to execute for each inset\r\n * @param {*} [parameter=null] the parameter to pass to the callback\r\n * @param {*} [parameter2=null] the parameter to pass to the callback\r\n */\r\nexport const executeForAllInsets = function (insets, mainSvgId, callback, parameter = null, parameter2 = null) {\r\n    for (const geo in insets) {\r\n        const insetGroup = insets[geo]\r\n\r\n        if (Array.isArray(insetGroup)) {\r\n            insetGroup.forEach((inset) => {\r\n                // Handle nested arrays for multiple insets with the same geo\r\n                if (Array.isArray(inset)) {\r\n                    inset.forEach((nestedInset) => {\r\n                        if (nestedInset.svgId_ !== mainSvgId) {\r\n                            callback(nestedInset, parameter, parameter2)\r\n                        }\r\n                    })\r\n                } else {\r\n                    if (inset.svgId_ !== mainSvgId) {\r\n                        callback(inset, parameter, parameter2)\r\n                    }\r\n                }\r\n            })\r\n        } else {\r\n            // Apply callback to unique inset\r\n            if (insetGroup.svgId_ !== mainSvgId) {\r\n                callback(insetGroup, parameter, parameter2)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const upperCaseFirstLetter = (string) => `${string.slice(0, 1).toUpperCase()}${string.slice(1)}`\r\n\r\nexport const lowerCaseAllWordsExceptFirstLetters = (string) =>\r\n    string.replaceAll(/\\S*/g, (word) => `${word.slice(0, 1)}${word.slice(1).toLowerCase()}`)\r\n\r\nexport function getDownloadURL(svgNode) {\r\n    // Create XML header to ensure the SVG is recognized properly\r\n    const xmlHeader = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\\n'\r\n\r\n    // Serialize SVG (outerHTML keeps entities)\r\n    let svgContent = xmlHeader + svgNode.outerHTML\r\n\r\n    // ---  Sanitize invalid HTML entities ---\r\n    svgContent = svgContent\r\n        .replace(/&nbsp;/g, '&#160;') // non-breaking space\r\n        .replace(/&copy;/g, '&#169;') //  if used anywhere\r\n        .replace(/&reg;/g, '&#174;') //  if used anywhere\r\n        .replace(/&times;/g, '&#215;') //  sign if used in labels\r\n        .replace(/&deg;/g, '&#176;') //  degrees symbol if used\r\n\r\n    // Create blob and return URL\r\n    const svgBlob = new Blob([svgContent], { type: 'image/svg+xml;charset=utf-8' })\r\n    const svgUrl = URL.createObjectURL(svgBlob)\r\n    return svgUrl\r\n}\r\n\r\n// Rasterize function with additional error handling\r\nexport function serialize(svg) {\r\n    const xmlns = 'http://www.w3.org/2000/xmlns/'\r\n    const xlinkns = 'http://www.w3.org/1999/xlink'\r\n    const svgns = 'http://www.w3.org/2000/svg'\r\n    const fragment = window.location.href + '#'\r\n    const walker = document.createTreeWalker(svg, NodeFilter.SHOW_ELEMENT, null, false)\r\n    while (walker.nextNode()) {\r\n        for (const attr of walker.currentNode.attributes) {\r\n            if (attr.value.includes(fragment)) {\r\n                attr.value = attr.value.replace(fragment, '#')\r\n            }\r\n        }\r\n    }\r\n    svg.setAttributeNS(xmlns, 'xmlns', svgns)\r\n    svg.setAttributeNS(xmlns, 'xmlns:xlink', xlinkns)\r\n    const serializer = new window.XMLSerializer()\r\n    const string = serializer.serializeToString(svg)\r\n    return new Blob([string], { type: 'image/svg+xml' })\r\n}\r\n\r\n// adapted from https://observablehq.com/@mbostock/saving-sv\r\n//svg to canvas blob promise\r\nexport function rasterize(svg) {\r\n    let resolve, reject\r\n    const promise = new Promise((y, n) => ((resolve = y), (reject = n)))\r\n    const image = new Image()\r\n    image.onerror = reject\r\n    image.onload = () => {\r\n        const rect = svg.getBoundingClientRect()\r\n        const canvas = document.createElement('canvas')\r\n        canvas.width = rect.width\r\n        canvas.height = rect.height\r\n        const context = canvas.getContext('2d')\r\n        context.drawImage(image, 0, 0, rect.width, rect.height)\r\n        context.canvas.toBlob(resolve)\r\n    }\r\n    image.src = URL.createObjectURL(serialize(svg))\r\n    return promise\r\n}\r\n\r\n/**\r\n * Get a URL parameter by name.\r\n *\r\n * @param {string} name\r\n * @returns {string | null}\r\n */\r\nexport function getParameterByName(name) {\r\n    name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]')\r\n    let regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)'),\r\n        results = regex.exec(location.search)\r\n    return !results ? null : decodeURIComponent(results[1].replace(/\\+/g, ' '))\r\n}\r\n\r\nexport const hexToRgb = (hex) => {\r\n    hex = hex.replace('#', '')\r\n    if (hex.length === 3) {\r\n        hex = hex\r\n            .split('')\r\n            .map((h) => h + h)\r\n            .join('')\r\n    }\r\n    const int = parseInt(hex, 16)\r\n    return [(int >> 16) & 255, (int >> 8) & 255, int & 255]\r\n}\r\n\r\n//blends two colors using 'multiply' blending mode. Returns the blended color as an RGB string\r\nexport const multiplyBlendMultipleHex = (colors) => {\r\n    // Convert hex color to RGB\r\n    const hexToRgb = (hex) => {\r\n        hex = hex.replace('#', '')\r\n        if (hex.length === 3) {\r\n            hex = hex\r\n                .split('')\r\n                .map((h) => h + h)\r\n                .join('')\r\n        }\r\n        const int = parseInt(hex, 16)\r\n        return [(int >> 16) & 255, (int >> 8) & 255, int & 255]\r\n    }\r\n\r\n    // Convert RGB to hex\r\n    const rgbToHex = ([r, g, b]) => `#${[r, g, b].map((c) => c.toString(16).padStart(2, '0')).join('')}`\r\n\r\n    // Convert all hex colors to RGB arrays\r\n    const rgbColors = colors.map(hexToRgb)\r\n\r\n    // Initialize the result with the first color\r\n    let blended = [...rgbColors[0]]\r\n\r\n    // Sequentially multiply each color with the result\r\n    for (let i = 1; i < rgbColors.length; i++) {\r\n        blended = blended.map((v, idx) => Math.round((v / 255) * (rgbColors[i][idx] / 255) * 255))\r\n    }\r\n\r\n    // Return the blended color as a hex code\r\n    return rgbToHex(blended)\r\n}\r\n\r\nexport function averageBlendHex(colors) {\r\n    const parsed = colors.map((c) => color(c).rgb())\r\n    const avg = {\r\n        r: parsed.reduce((sum, c) => sum + c.r, 0) / parsed.length,\r\n        g: parsed.reduce((sum, c) => sum + c.g, 0) / parsed.length,\r\n        b: parsed.reduce((sum, c) => sum + c.b, 0) / parsed.length,\r\n    }\r\n    return `rgb(${avg.r},${avg.g},${avg.b})`\r\n}\r\n\r\n/**\r\n * interpolateIntensity\r\n *\r\n * Adjusts the brightness of a base color based on a class index or relative position.\r\n * Typically used to differentiate quantile levels (e.g., low, medium, high) by making\r\n * lower classes appear lighter and higher classes closer to the base hue.\r\n *\r\n * @param {string} baseColor - The original color to adjust (hex or CSS string).\r\n * @param {number} idx - The class index (0 for lowest, 1 for mid, 2 for highest in 3-class scales).\r\n * @returns {string} - The adjusted color as a hex string.\r\n */\r\nexport function interpolateIntensity(baseColor, idx) {\r\n    const f = idx / 2 // 0, 0.5, 1\r\n    const c = color(baseColor)\r\n    return c.brighter(1.5 - f).formatHex() // make low brighter\r\n}\r\n\r\n// convert rect attributes into an SVG path string\r\n// used for workaround whereby clipPaths which use rect elements do not work in adobe illustrator\r\nexport const convertRectanglesToPaths = function (x, y, width, height) {\r\n    var x = parseFloat(x, 10)\r\n    var y = parseFloat(y, 10)\r\n    var width = parseFloat(width, 10)\r\n    var height = parseFloat(height, 10)\r\n\r\n    if (x < 0 || y < 0 || width < 0 || height < 0) {\r\n        return ''\r\n    }\r\n\r\n    return 'M' + x + ',' + y + 'L' + (x + width) + ',' + y + ' ' + (x + width) + ',' + (y + height) + ' ' + x + ',' + (y + height) + 'z'\r\n}\r\n\r\nexport const getTextColorForBackground = function (backgroundColor) {\r\n    let r, g, b\r\n\r\n    // Create a temporary element to handle named colors\r\n    if (!backgroundColor.startsWith('rgb') && !backgroundColor.startsWith('#')) {\r\n        const tempDiv = document.createElement('div')\r\n        tempDiv.style.color = backgroundColor\r\n        document.body.appendChild(tempDiv)\r\n        const computedColor = window.getComputedStyle(tempDiv).color\r\n        document.body.removeChild(tempDiv)\r\n        backgroundColor = computedColor // Convert named color to RGB\r\n    }\r\n\r\n    // Handle hex colors like '#FFFFFF' or '#FFF'\r\n    if (backgroundColor.startsWith('#')) {\r\n        let hex = backgroundColor.replace('#', '')\r\n        if (hex.length === 3) {\r\n            hex = hex\r\n                .split('')\r\n                .map((c) => c + c)\r\n                .join('')\r\n        }\r\n        r = parseInt(hex.substring(0, 2), 16)\r\n        g = parseInt(hex.substring(2, 4), 16)\r\n        b = parseInt(hex.substring(4, 6), 16)\r\n    } else {\r\n        // Handle RGB colors like 'rgb(255,255,255)'\r\n        const rgb = backgroundColor.match(/\\d+/g)\r\n        r = parseInt(rgb[0])\r\n        g = parseInt(rgb[1])\r\n        b = parseInt(rgb[2])\r\n    }\r\n\r\n    // Calculate luminance\r\n    const luminance = 0.2126 * (r / 255) + 0.7152 * (g / 255) + 0.0722 * (b / 255)\r\n\r\n    // Return black for light backgrounds, white for dark backgrounds\r\n    return luminance > 0.5 ? 'black' : 'white'\r\n}\r\n\r\n// get css selector. Different maps have different selectors for their regions.\r\nexport const getRegionsSelector = (map) => {\r\n    if (map.Geometries.userGeometries) return '#em-user-regions path'\r\n    if (map.gridCartogram_) return '#em-grid-container .em-grid-cell'\r\n    if (map.geo_ === 'WORLD') return '#em-worldrg path'\r\n    return '#em-nutsrg path:not(#em-cntrg-RS):not(#em-cntrg-EL), #em-cntrg path:not(#em-cntrg-RS):not(#em-cntrg-EL)'\r\n}\r\n\r\n// get css selector for legend mouse hover. Different maps have different selectors for their regions\r\nexport const getLegendRegionsSelector = (map) => {\r\n    if (map.Geometries.userGeometries) return '#em-user-regions'\r\n    if (map.gridCartogram_) return '#em-grid-container'\r\n    if (map.geo_ === 'WORLD') return '#em-worldrg'\r\n    return '#em-nutsrg, #em-cntrg'\r\n}\r\n\r\n// Helper functions to calculate current view as bbox\r\n\r\n/**\r\n * Approximate geographic bbox based on map.position_ (linear, equirectangular assumption)\r\n * Works before projection is created.\r\n * @returns [minLon, minLat, maxLon, maxLat]\r\n */\r\nexport const getApproxCurrentGeoBbox = function (map) {\r\n    const halfWidth = 0.5 * map.position_.z * map.width_\r\n    const halfHeight = 0.5 * map.position_.z * map.height_\r\n    return [map.position_.x - halfWidth, map.position_.y - halfHeight, map.position_.x + halfWidth, map.position_.y + halfHeight]\r\n}\r\n\r\n/**\r\n * Exact geographic bbox using the current projection (requires map._projection)\r\n * Computes bbox by inverting the screen corners to lon/lat.\r\n * @returns [minLon, minLat, maxLon, maxLat]\r\n */\r\nexport const getExactCurrentGeoBbox = function (map) {\r\n    if (!map._projection) {\r\n        console.warn('getExactCurrentGeoBbox called before projection exists; returning approx bbox')\r\n        return getApproxCurrentGeoBbox(map)\r\n    }\r\n\r\n    const width = map.width_\r\n    const height = map.height_\r\n\r\n    const corners = [\r\n        [0, 0],\r\n        [width, 0],\r\n        [width, height],\r\n        [0, height],\r\n    ]\r\n\r\n    const projected = corners.map((pt) => map._projection.invert(pt)).filter(Boolean) // in case projection clips some corners\r\n\r\n    const lons = projected.map((p) => p[0])\r\n    const lats = projected.map((p) => p[1])\r\n\r\n    return [Math.min(...lons), Math.min(...lats), Math.max(...lons), Math.max(...lats)]\r\n}\r\n","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import array from \"./array.js\";\nimport {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([document.querySelectorAll(selector)], [document.documentElement])\n      : new Selection([array(selector)], root);\n}\n","// https://github.com/python/cpython/blob/a74eea238f5baba15797e2e8b570d153bc8690a7/Modules/mathmodule.c#L1423\nexport class Adder {\n  constructor() {\n    this._partials = new Float64Array(32);\n    this._n = 0;\n  }\n  add(x) {\n    const p = this._partials;\n    let i = 0;\n    for (let j = 0; j < this._n && j < 32; j++) {\n      const y = p[j],\n        hi = x + y,\n        lo = Math.abs(x) < Math.abs(y) ? x - (hi - y) : y - (hi - x);\n      if (lo) p[i++] = lo;\n      x = hi;\n    }\n    p[i] = x;\n    this._n = i + 1;\n    return this;\n  }\n  valueOf() {\n    const p = this._partials;\n    let n = this._n, x, y, lo, hi = 0;\n    if (n > 0) {\n      hi = p[--n];\n      while (n > 0) {\n        x = hi;\n        y = p[--n];\n        hi = x + y;\n        lo = y - (hi - x);\n        if (lo) break;\n      }\n      if (n > 0 && ((lo < 0 && p[n - 1] < 0) || (lo > 0 && p[n - 1] > 0))) {\n        y = lo * 2;\n        x = hi + y;\n        if (y == x - hi) hi = x;\n      }\n    }\n    return hi;\n  }\n}\n\nexport function fsum(values, valueof) {\n  const adder = new Adder();\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        adder.add(value);\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        adder.add(value);\n      }\n    }\n  }\n  return +adder;\n}\n\nexport function fcumsum(values, valueof) {\n  const adder = new Adder();\n  let index = -1;\n  return Float64Array.from(values, valueof === undefined\n      ? v => adder.add(+v || 0)\n      : v => adder.add(+valueof(v, ++index, values) || 0)\n  );\n}\n","export var epsilon = 1e-6;\nexport var epsilon2 = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var quarterPi = pi / 4;\nexport var tau = pi * 2;\n\nexport var degrees = 180 / pi;\nexport var radians = pi / 180;\n\nexport var abs = Math.abs;\nexport var atan = Math.atan;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var ceil = Math.ceil;\nexport var exp = Math.exp;\nexport var floor = Math.floor;\nexport var hypot = Math.hypot;\nexport var log = Math.log;\nexport var pow = Math.pow;\nexport var sin = Math.sin;\nexport var sign = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };\nexport var sqrt = Math.sqrt;\nexport var tan = Math.tan;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x > 1 ? halfPi : x < -1 ? -halfPi : Math.asin(x);\n}\n\nexport function haversin(x) {\n  return (x = sin(x / 2)) * x;\n}\n","export default function noop() {}\n","function streamGeometry(geometry, stream) {\n  if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {\n    streamGeometryType[geometry.type](geometry, stream);\n  }\n}\n\nvar streamObjectType = {\n  Feature: function(object, stream) {\n    streamGeometry(object.geometry, stream);\n  },\n  FeatureCollection: function(object, stream) {\n    var features = object.features, i = -1, n = features.length;\n    while (++i < n) streamGeometry(features[i].geometry, stream);\n  }\n};\n\nvar streamGeometryType = {\n  Sphere: function(object, stream) {\n    stream.sphere();\n  },\n  Point: function(object, stream) {\n    object = object.coordinates;\n    stream.point(object[0], object[1], object[2]);\n  },\n  MultiPoint: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) object = coordinates[i], stream.point(object[0], object[1], object[2]);\n  },\n  LineString: function(object, stream) {\n    streamLine(object.coordinates, stream, 0);\n  },\n  MultiLineString: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamLine(coordinates[i], stream, 0);\n  },\n  Polygon: function(object, stream) {\n    streamPolygon(object.coordinates, stream);\n  },\n  MultiPolygon: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamPolygon(coordinates[i], stream);\n  },\n  GeometryCollection: function(object, stream) {\n    var geometries = object.geometries, i = -1, n = geometries.length;\n    while (++i < n) streamGeometry(geometries[i], stream);\n  }\n};\n\nfunction streamLine(coordinates, stream, closed) {\n  var i = -1, n = coordinates.length - closed, coordinate;\n  stream.lineStart();\n  while (++i < n) coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);\n  stream.lineEnd();\n}\n\nfunction streamPolygon(coordinates, stream) {\n  var i = -1, n = coordinates.length;\n  stream.polygonStart();\n  while (++i < n) streamLine(coordinates[i], stream, 1);\n  stream.polygonEnd();\n}\n\nexport default function(object, stream) {\n  if (object && streamObjectType.hasOwnProperty(object.type)) {\n    streamObjectType[object.type](object, stream);\n  } else {\n    streamGeometry(object, stream);\n  }\n}\n","import {Adder} from \"d3-array\";\nimport {asin, atan2, cos, degrees, epsilon, epsilon2, hypot, radians, sin, sqrt} from \"./math.js\";\nimport noop from \"./noop.js\";\nimport stream from \"./stream.js\";\n\nvar W0, W1,\n    X0, Y0, Z0,\n    X1, Y1, Z1,\n    X2, Y2, Z2,\n    lambda00, phi00, // first point\n    x0, y0, z0; // previous point\n\nvar centroidStream = {\n  sphere: noop,\n  point: centroidPoint,\n  lineStart: centroidLineStart,\n  lineEnd: centroidLineEnd,\n  polygonStart: function() {\n    centroidStream.lineStart = centroidRingStart;\n    centroidStream.lineEnd = centroidRingEnd;\n  },\n  polygonEnd: function() {\n    centroidStream.lineStart = centroidLineStart;\n    centroidStream.lineEnd = centroidLineEnd;\n  }\n};\n\n// Arithmetic mean of Cartesian vectors.\nfunction centroidPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi);\n  centroidPointCartesian(cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi));\n}\n\nfunction centroidPointCartesian(x, y, z) {\n  ++W0;\n  X0 += (x - X0) / W0;\n  Y0 += (y - Y0) / W0;\n  Z0 += (z - Z0) / W0;\n}\n\nfunction centroidLineStart() {\n  centroidStream.point = centroidLinePointFirst;\n}\n\nfunction centroidLinePointFirst(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi);\n  x0 = cosPhi * cos(lambda);\n  y0 = cosPhi * sin(lambda);\n  z0 = sin(phi);\n  centroidStream.point = centroidLinePoint;\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidLinePoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi),\n      x = cosPhi * cos(lambda),\n      y = cosPhi * sin(lambda),\n      z = sin(phi),\n      w = atan2(sqrt((w = y0 * z - z0 * y) * w + (w = z0 * x - x0 * z) * w + (w = x0 * y - y0 * x) * w), x0 * x + y0 * y + z0 * z);\n  W1 += w;\n  X1 += w * (x0 + (x0 = x));\n  Y1 += w * (y0 + (y0 = y));\n  Z1 += w * (z0 + (z0 = z));\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidLineEnd() {\n  centroidStream.point = centroidPoint;\n}\n\n// See J. E. Brock, The Inertia Tensor for a Spherical Triangle,\n// J. Applied Mechanics 42, 239 (1975).\nfunction centroidRingStart() {\n  centroidStream.point = centroidRingPointFirst;\n}\n\nfunction centroidRingEnd() {\n  centroidRingPoint(lambda00, phi00);\n  centroidStream.point = centroidPoint;\n}\n\nfunction centroidRingPointFirst(lambda, phi) {\n  lambda00 = lambda, phi00 = phi;\n  lambda *= radians, phi *= radians;\n  centroidStream.point = centroidRingPoint;\n  var cosPhi = cos(phi);\n  x0 = cosPhi * cos(lambda);\n  y0 = cosPhi * sin(lambda);\n  z0 = sin(phi);\n  centroidPointCartesian(x0, y0, z0);\n}\n\nfunction centroidRingPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  var cosPhi = cos(phi),\n      x = cosPhi * cos(lambda),\n      y = cosPhi * sin(lambda),\n      z = sin(phi),\n      cx = y0 * z - z0 * y,\n      cy = z0 * x - x0 * z,\n      cz = x0 * y - y0 * x,\n      m = hypot(cx, cy, cz),\n      w = asin(m), // line weight = angle\n      v = m && -w / m; // area weight multiplier\n  X2.add(v * cx);\n  Y2.add(v * cy);\n  Z2.add(v * cz);\n  W1 += w;\n  X1 += w * (x0 + (x0 = x));\n  Y1 += w * (y0 + (y0 = y));\n  Z1 += w * (z0 + (z0 = z));\n  centroidPointCartesian(x0, y0, z0);\n}\n\nexport default function(object) {\n  W0 = W1 =\n  X0 = Y0 = Z0 =\n  X1 = Y1 = Z1 = 0;\n  X2 = new Adder();\n  Y2 = new Adder();\n  Z2 = new Adder();\n  stream(object, centroidStream);\n\n  var x = +X2,\n      y = +Y2,\n      z = +Z2,\n      m = hypot(x, y, z);\n\n  // If the area-weighted ccentroid is undefined, fall back to length-weighted ccentroid.\n  if (m < epsilon2) {\n    x = X1, y = Y1, z = Z1;\n    // If the feature has zero length, fall back to arithmetic mean of point vectors.\n    if (W1 < epsilon) x = X0, y = Y0, z = Z0;\n    m = hypot(x, y, z);\n    // If the feature still has an undefined ccentroid, then return.\n    if (m < epsilon2) return [NaN, NaN];\n  }\n\n  return [atan2(y, x) * degrees, asin(z / m) * degrees];\n}\n","import noop from \"../noop.js\";\n\nexport default function() {\n  var lines = [],\n      line;\n  return {\n    point: function(x, y, m) {\n      line.push([x, y, m]);\n    },\n    lineStart: function() {\n      lines.push(line = []);\n    },\n    lineEnd: noop,\n    rejoin: function() {\n      if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));\n    },\n    result: function() {\n      var result = lines;\n      lines = [];\n      line = null;\n      return result;\n    }\n  };\n}\n","import {abs, epsilon} from \"./math.js\";\n\nexport default function(a, b) {\n  return abs(a[0] - b[0]) < epsilon && abs(a[1] - b[1]) < epsilon;\n}\n","import pointEqual from \"../pointEqual.js\";\nimport {epsilon} from \"../math.js\";\n\nfunction Intersection(point, points, other, entry) {\n  this.x = point;\n  this.z = points;\n  this.o = other; // another intersection\n  this.e = entry; // is an entry?\n  this.v = false; // visited\n  this.n = this.p = null; // next & previous\n}\n\n// A generalized polygon clipping algorithm: given a polygon that has been cut\n// into its visible line segments, and rejoins the segments by interpolating\n// along the clip edge.\nexport default function(segments, compareIntersection, startInside, interpolate, stream) {\n  var subject = [],\n      clip = [],\n      i,\n      n;\n\n  segments.forEach(function(segment) {\n    if ((n = segment.length - 1) <= 0) return;\n    var n, p0 = segment[0], p1 = segment[n], x;\n\n    if (pointEqual(p0, p1)) {\n      if (!p0[2] && !p1[2]) {\n        stream.lineStart();\n        for (i = 0; i < n; ++i) stream.point((p0 = segment[i])[0], p0[1]);\n        stream.lineEnd();\n        return;\n      }\n      // handle degenerate cases by moving the point\n      p1[0] += 2 * epsilon;\n    }\n\n    subject.push(x = new Intersection(p0, segment, null, true));\n    clip.push(x.o = new Intersection(p0, null, x, false));\n    subject.push(x = new Intersection(p1, segment, null, false));\n    clip.push(x.o = new Intersection(p1, null, x, true));\n  });\n\n  if (!subject.length) return;\n\n  clip.sort(compareIntersection);\n  link(subject);\n  link(clip);\n\n  for (i = 0, n = clip.length; i < n; ++i) {\n    clip[i].e = startInside = !startInside;\n  }\n\n  var start = subject[0],\n      points,\n      point;\n\n  while (1) {\n    // Find first unvisited intersection.\n    var current = start,\n        isSubject = true;\n    while (current.v) if ((current = current.n) === start) return;\n    points = current.z;\n    stream.lineStart();\n    do {\n      current.v = current.o.v = true;\n      if (current.e) {\n        if (isSubject) {\n          for (i = 0, n = points.length; i < n; ++i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.n.x, 1, stream);\n        }\n        current = current.n;\n      } else {\n        if (isSubject) {\n          points = current.p.z;\n          for (i = points.length - 1; i >= 0; --i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.p.x, -1, stream);\n        }\n        current = current.p;\n      }\n      current = current.o;\n      points = current.z;\n      isSubject = !isSubject;\n    } while (!current.v);\n    stream.lineEnd();\n  }\n}\n\nfunction link(array) {\n  if (!(n = array.length)) return;\n  var n,\n      i = 0,\n      a = array[0],\n      b;\n  while (++i < n) {\n    a.n = b = array[i];\n    b.p = a;\n    a = b;\n  }\n  a.n = b = array[0];\n  b.p = a;\n}\n","function* flatten(arrays) {\n  for (const array of arrays) {\n    yield* array;\n  }\n}\n\nexport default function merge(arrays) {\n  return Array.from(flatten(arrays));\n}\n","import {abs, epsilon} from \"../math.js\";\nimport clipBuffer from \"./buffer.js\";\nimport clipLine from \"./line.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {merge} from \"d3-array\";\n\nvar clipMax = 1e9, clipMin = -clipMax;\n\n// TODO Use d3-polygons polygonContains here for the ring check?\n// TODO Eliminate duplicate buffering in clipBuffer and polygon.push?\n\nexport default function clipRectangle(x0, y0, x1, y1) {\n\n  function visible(x, y) {\n    return x0 <= x && x <= x1 && y0 <= y && y <= y1;\n  }\n\n  function interpolate(from, to, direction, stream) {\n    var a = 0, a1 = 0;\n    if (from == null\n        || (a = corner(from, direction)) !== (a1 = corner(to, direction))\n        || comparePoint(from, to) < 0 ^ direction > 0) {\n      do stream.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);\n      while ((a = (a + direction + 4) % 4) !== a1);\n    } else {\n      stream.point(to[0], to[1]);\n    }\n  }\n\n  function corner(p, direction) {\n    return abs(p[0] - x0) < epsilon ? direction > 0 ? 0 : 3\n        : abs(p[0] - x1) < epsilon ? direction > 0 ? 2 : 1\n        : abs(p[1] - y0) < epsilon ? direction > 0 ? 1 : 0\n        : direction > 0 ? 3 : 2; // abs(p[1] - y1) < epsilon\n  }\n\n  function compareIntersection(a, b) {\n    return comparePoint(a.x, b.x);\n  }\n\n  function comparePoint(a, b) {\n    var ca = corner(a, 1),\n        cb = corner(b, 1);\n    return ca !== cb ? ca - cb\n        : ca === 0 ? b[1] - a[1]\n        : ca === 1 ? a[0] - b[0]\n        : ca === 2 ? a[1] - b[1]\n        : b[0] - a[0];\n  }\n\n  return function(stream) {\n    var activeStream = stream,\n        bufferStream = clipBuffer(),\n        segments,\n        polygon,\n        ring,\n        x__, y__, v__, // first point\n        x_, y_, v_, // previous point\n        first,\n        clean;\n\n    var clipStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: polygonStart,\n      polygonEnd: polygonEnd\n    };\n\n    function point(x, y) {\n      if (visible(x, y)) activeStream.point(x, y);\n    }\n\n    function polygonInside() {\n      var winding = 0;\n\n      for (var i = 0, n = polygon.length; i < n; ++i) {\n        for (var ring = polygon[i], j = 1, m = ring.length, point = ring[0], a0, a1, b0 = point[0], b1 = point[1]; j < m; ++j) {\n          a0 = b0, a1 = b1, point = ring[j], b0 = point[0], b1 = point[1];\n          if (a1 <= y1) { if (b1 > y1 && (b0 - a0) * (y1 - a1) > (b1 - a1) * (x0 - a0)) ++winding; }\n          else { if (b1 <= y1 && (b0 - a0) * (y1 - a1) < (b1 - a1) * (x0 - a0)) --winding; }\n        }\n      }\n\n      return winding;\n    }\n\n    // Buffer geometry within a polygon and then clip it en masse.\n    function polygonStart() {\n      activeStream = bufferStream, segments = [], polygon = [], clean = true;\n    }\n\n    function polygonEnd() {\n      var startInside = polygonInside(),\n          cleanInside = clean && startInside,\n          visible = (segments = merge(segments)).length;\n      if (cleanInside || visible) {\n        stream.polygonStart();\n        if (cleanInside) {\n          stream.lineStart();\n          interpolate(null, null, 1, stream);\n          stream.lineEnd();\n        }\n        if (visible) {\n          clipRejoin(segments, compareIntersection, startInside, interpolate, stream);\n        }\n        stream.polygonEnd();\n      }\n      activeStream = stream, segments = polygon = ring = null;\n    }\n\n    function lineStart() {\n      clipStream.point = linePoint;\n      if (polygon) polygon.push(ring = []);\n      first = true;\n      v_ = false;\n      x_ = y_ = NaN;\n    }\n\n    // TODO rather than special-case polygons, simply handle them separately.\n    // Ideally, coincident intersection points should be jittered to avoid\n    // clipping issues.\n    function lineEnd() {\n      if (segments) {\n        linePoint(x__, y__);\n        if (v__ && v_) bufferStream.rejoin();\n        segments.push(bufferStream.result());\n      }\n      clipStream.point = point;\n      if (v_) activeStream.lineEnd();\n    }\n\n    function linePoint(x, y) {\n      var v = visible(x, y);\n      if (polygon) ring.push([x, y]);\n      if (first) {\n        x__ = x, y__ = y, v__ = v;\n        first = false;\n        if (v) {\n          activeStream.lineStart();\n          activeStream.point(x, y);\n        }\n      } else {\n        if (v && v_) activeStream.point(x, y);\n        else {\n          var a = [x_ = Math.max(clipMin, Math.min(clipMax, x_)), y_ = Math.max(clipMin, Math.min(clipMax, y_))],\n              b = [x = Math.max(clipMin, Math.min(clipMax, x)), y = Math.max(clipMin, Math.min(clipMax, y))];\n          if (clipLine(a, b, x0, y0, x1, y1)) {\n            if (!v_) {\n              activeStream.lineStart();\n              activeStream.point(a[0], a[1]);\n            }\n            activeStream.point(b[0], b[1]);\n            if (!v) activeStream.lineEnd();\n            clean = false;\n          } else if (v) {\n            activeStream.lineStart();\n            activeStream.point(x, y);\n            clean = false;\n          }\n        }\n      }\n      x_ = x, y_ = y, v_ = v;\n    }\n\n    return clipStream;\n  };\n}\n","export default function(a, b, x0, y0, x1, y1) {\n  var ax = a[0],\n      ay = a[1],\n      bx = b[0],\n      by = b[1],\n      t0 = 0,\n      t1 = 1,\n      dx = bx - ax,\n      dy = by - ay,\n      r;\n\n  r = x0 - ax;\n  if (!dx && r > 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dx > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = x1 - ax;\n  if (!dx && r < 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dx > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  r = y0 - ay;\n  if (!dy && r > 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dy > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = y1 - ay;\n  if (!dy && r < 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dy > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  if (t0 > 0) a[0] = ax + t0 * dx, a[1] = ay + t0 * dy;\n  if (t1 < 1) b[0] = ax + t1 * dx, b[1] = ay + t1 * dy;\n  return true;\n}\n","export default x => x;\n","export default function(methods) {\n  return {\n    stream: transformer(methods)\n  };\n}\n\nexport function transformer(methods) {\n  return function(stream) {\n    var s = new TransformStream;\n    for (var key in methods) s[key] = methods[key];\n    s.stream = stream;\n    return s;\n  };\n}\n\nfunction TransformStream() {}\n\nTransformStream.prototype = {\n  constructor: TransformStream,\n  point: function(x, y) { this.stream.point(x, y); },\n  sphere: function() { this.stream.sphere(); },\n  lineStart: function() { this.stream.lineStart(); },\n  lineEnd: function() { this.stream.lineEnd(); },\n  polygonStart: function() { this.stream.polygonStart(); },\n  polygonEnd: function() { this.stream.polygonEnd(); }\n};\n","import noop from \"../noop.js\";\n\nvar x0 = Infinity,\n    y0 = x0,\n    x1 = -x0,\n    y1 = x1;\n\nvar boundsStream = {\n  point: boundsPoint,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: noop,\n  polygonEnd: noop,\n  result: function() {\n    var bounds = [[x0, y0], [x1, y1]];\n    x1 = y1 = -(y0 = x0 = Infinity);\n    return bounds;\n  }\n};\n\nfunction boundsPoint(x, y) {\n  if (x < x0) x0 = x;\n  if (x > x1) x1 = x;\n  if (y < y0) y0 = y;\n  if (y > y1) y1 = y;\n}\n\nexport default boundsStream;\n","import {default as geoStream} from \"../stream.js\";\nimport boundsStream from \"../path/bounds.js\";\n\nfunction fit(projection, fitBounds, object) {\n  var clip = projection.clipExtent && projection.clipExtent();\n  projection.scale(150).translate([0, 0]);\n  if (clip != null) projection.clipExtent(null);\n  geoStream(object, projection.stream(boundsStream));\n  fitBounds(boundsStream.result());\n  if (clip != null) projection.clipExtent(clip);\n  return projection;\n}\n\nexport function fitExtent(projection, extent, object) {\n  return fit(projection, function(b) {\n    var w = extent[1][0] - extent[0][0],\n        h = extent[1][1] - extent[0][1],\n        k = Math.min(w / (b[1][0] - b[0][0]), h / (b[1][1] - b[0][1])),\n        x = +extent[0][0] + (w - k * (b[1][0] + b[0][0])) / 2,\n        y = +extent[0][1] + (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitSize(projection, size, object) {\n  return fitExtent(projection, [[0, 0], size], object);\n}\n\nexport function fitWidth(projection, width, object) {\n  return fit(projection, function(b) {\n    var w = +width,\n        k = w / (b[1][0] - b[0][0]),\n        x = (w - k * (b[1][0] + b[0][0])) / 2,\n        y = -k * b[0][1];\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitHeight(projection, height, object) {\n  return fit(projection, function(b) {\n    var h = +height,\n        k = h / (b[1][1] - b[0][1]),\n        x = -k * b[0][0],\n        y = (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n","import {Adder} from \"d3-array\";\nimport {abs} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nvar areaSum = new Adder(),\n    areaRingSum = new Adder(),\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar areaStream = {\n  point: noop,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: function() {\n    areaStream.lineStart = areaRingStart;\n    areaStream.lineEnd = areaRingEnd;\n  },\n  polygonEnd: function() {\n    areaStream.lineStart = areaStream.lineEnd = areaStream.point = noop;\n    areaSum.add(abs(areaRingSum));\n    areaRingSum = new Adder();\n  },\n  result: function() {\n    var area = areaSum / 2;\n    areaSum = new Adder();\n    return area;\n  }\n};\n\nfunction areaRingStart() {\n  areaStream.point = areaPointFirst;\n}\n\nfunction areaPointFirst(x, y) {\n  areaStream.point = areaPoint;\n  x00 = x0 = x, y00 = y0 = y;\n}\n\nfunction areaPoint(x, y) {\n  areaRingSum.add(y0 * x - x0 * y);\n  x0 = x, y0 = y;\n}\n\nfunction areaRingEnd() {\n  areaPoint(x00, y00);\n}\n\nexport default areaStream;\n","import {sqrt} from \"../math.js\";\n\n// TODO Enforce positive area for exterior, negative area for interior?\n\nvar X0 = 0,\n    Y0 = 0,\n    Z0 = 0,\n    X1 = 0,\n    Y1 = 0,\n    Z1 = 0,\n    X2 = 0,\n    Y2 = 0,\n    Z2 = 0,\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar centroidStream = {\n  point: centroidPoint,\n  lineStart: centroidLineStart,\n  lineEnd: centroidLineEnd,\n  polygonStart: function() {\n    centroidStream.lineStart = centroidRingStart;\n    centroidStream.lineEnd = centroidRingEnd;\n  },\n  polygonEnd: function() {\n    centroidStream.point = centroidPoint;\n    centroidStream.lineStart = centroidLineStart;\n    centroidStream.lineEnd = centroidLineEnd;\n  },\n  result: function() {\n    var centroid = Z2 ? [X2 / Z2, Y2 / Z2]\n        : Z1 ? [X1 / Z1, Y1 / Z1]\n        : Z0 ? [X0 / Z0, Y0 / Z0]\n        : [NaN, NaN];\n    X0 = Y0 = Z0 =\n    X1 = Y1 = Z1 =\n    X2 = Y2 = Z2 = 0;\n    return centroid;\n  }\n};\n\nfunction centroidPoint(x, y) {\n  X0 += x;\n  Y0 += y;\n  ++Z0;\n}\n\nfunction centroidLineStart() {\n  centroidStream.point = centroidPointFirstLine;\n}\n\nfunction centroidPointFirstLine(x, y) {\n  centroidStream.point = centroidPointLine;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nfunction centroidPointLine(x, y) {\n  var dx = x - x0, dy = y - y0, z = sqrt(dx * dx + dy * dy);\n  X1 += z * (x0 + x) / 2;\n  Y1 += z * (y0 + y) / 2;\n  Z1 += z;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nfunction centroidLineEnd() {\n  centroidStream.point = centroidPoint;\n}\n\nfunction centroidRingStart() {\n  centroidStream.point = centroidPointFirstRing;\n}\n\nfunction centroidRingEnd() {\n  centroidPointRing(x00, y00);\n}\n\nfunction centroidPointFirstRing(x, y) {\n  centroidStream.point = centroidPointRing;\n  centroidPoint(x00 = x0 = x, y00 = y0 = y);\n}\n\nfunction centroidPointRing(x, y) {\n  var dx = x - x0,\n      dy = y - y0,\n      z = sqrt(dx * dx + dy * dy);\n\n  X1 += z * (x0 + x) / 2;\n  Y1 += z * (y0 + y) / 2;\n  Z1 += z;\n\n  z = y0 * x - x0 * y;\n  X2 += z * (x0 + x);\n  Y2 += z * (y0 + y);\n  Z2 += z * 3;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nexport default centroidStream;\n","import {tau} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nexport default function PathContext(context) {\n  this._context = context;\n}\n\nPathContext.prototype = {\n  _radius: 4.5,\n  pointRadius: function(_) {\n    return this._radius = _, this;\n  },\n  polygonStart: function() {\n    this._line = 0;\n  },\n  polygonEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line === 0) this._context.closePath();\n    this._point = NaN;\n  },\n  point: function(x, y) {\n    switch (this._point) {\n      case 0: {\n        this._context.moveTo(x, y);\n        this._point = 1;\n        break;\n      }\n      case 1: {\n        this._context.lineTo(x, y);\n        break;\n      }\n      default: {\n        this._context.moveTo(x + this._radius, y);\n        this._context.arc(x, y, this._radius, 0, tau);\n        break;\n      }\n    }\n  },\n  result: noop\n};\n","import {Adder} from \"d3-array\";\nimport {sqrt} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nvar lengthSum = new Adder(),\n    lengthRing,\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar lengthStream = {\n  point: noop,\n  lineStart: function() {\n    lengthStream.point = lengthPointFirst;\n  },\n  lineEnd: function() {\n    if (lengthRing) lengthPoint(x00, y00);\n    lengthStream.point = noop;\n  },\n  polygonStart: function() {\n    lengthRing = true;\n  },\n  polygonEnd: function() {\n    lengthRing = null;\n  },\n  result: function() {\n    var length = +lengthSum;\n    lengthSum = new Adder();\n    return length;\n  }\n};\n\nfunction lengthPointFirst(x, y) {\n  lengthStream.point = lengthPoint;\n  x00 = x0 = x, y00 = y0 = y;\n}\n\nfunction lengthPoint(x, y) {\n  x0 -= x, y0 -= y;\n  lengthSum.add(sqrt(x0 * x0 + y0 * y0));\n  x0 = x, y0 = y;\n}\n\nexport default lengthStream;\n","// Simple caching for constant-radius points.\nlet cacheDigits, cacheAppend, cacheRadius, cacheCircle;\n\nexport default class PathString {\n  constructor(digits) {\n    this._append = digits == null ? append : appendRound(digits);\n    this._radius = 4.5;\n    this._ = \"\";\n  }\n  pointRadius(_) {\n    this._radius = +_;\n    return this;\n  }\n  polygonStart() {\n    this._line = 0;\n  }\n  polygonEnd() {\n    this._line = NaN;\n  }\n  lineStart() {\n    this._point = 0;\n  }\n  lineEnd() {\n    if (this._line === 0) this._ += \"Z\";\n    this._point = NaN;\n  }\n  point(x, y) {\n    switch (this._point) {\n      case 0: {\n        this._append`M${x},${y}`;\n        this._point = 1;\n        break;\n      }\n      case 1: {\n        this._append`L${x},${y}`;\n        break;\n      }\n      default: {\n        this._append`M${x},${y}`;\n        if (this._radius !== cacheRadius || this._append !== cacheAppend) {\n          const r = this._radius;\n          const s = this._;\n          this._ = \"\"; // stash the old string so we can cache the circle path fragment\n          this._append`m0,${r}a${r},${r} 0 1,1 0,${-2 * r}a${r},${r} 0 1,1 0,${2 * r}z`;\n          cacheRadius = r;\n          cacheAppend = this._append;\n          cacheCircle = this._;\n          this._ = s;\n        }\n        this._ += cacheCircle;\n        break;\n      }\n    }\n  }\n  result() {\n    const result = this._;\n    this._ = \"\";\n    return result.length ? result : null;\n  }\n}\n\nfunction append(strings) {\n  let i = 1;\n  this._ += strings[0];\n  for (const j = strings.length; i < j; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  const d = Math.floor(digits);\n  if (!(d >= 0)) throw new RangeError(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  if (d !== cacheDigits) {\n    const k = 10 ** d;\n    cacheDigits = d;\n    cacheAppend = function append(strings) {\n      let i = 1;\n      this._ += strings[0];\n      for (const j = strings.length; i < j; ++i) {\n        this._ += Math.round(arguments[i] * k) / k + strings[i];\n      }\n    };\n  }\n  return cacheAppend;\n}\n","import identity from \"../identity.js\";\nimport stream from \"../stream.js\";\nimport pathArea from \"./area.js\";\nimport pathBounds from \"./bounds.js\";\nimport pathCentroid from \"./centroid.js\";\nimport PathContext from \"./context.js\";\nimport pathMeasure from \"./measure.js\";\nimport PathString from \"./string.js\";\n\nexport default function(projection, context) {\n  let digits = 3,\n      pointRadius = 4.5,\n      projectionStream,\n      contextStream;\n\n  function path(object) {\n    if (object) {\n      if (typeof pointRadius === \"function\") contextStream.pointRadius(+pointRadius.apply(this, arguments));\n      stream(object, projectionStream(contextStream));\n    }\n    return contextStream.result();\n  }\n\n  path.area = function(object) {\n    stream(object, projectionStream(pathArea));\n    return pathArea.result();\n  };\n\n  path.measure = function(object) {\n    stream(object, projectionStream(pathMeasure));\n    return pathMeasure.result();\n  };\n\n  path.bounds = function(object) {\n    stream(object, projectionStream(pathBounds));\n    return pathBounds.result();\n  };\n\n  path.centroid = function(object) {\n    stream(object, projectionStream(pathCentroid));\n    return pathCentroid.result();\n  };\n\n  path.projection = function(_) {\n    if (!arguments.length) return projection;\n    projectionStream = _ == null ? (projection = null, identity) : (projection = _).stream;\n    return path;\n  };\n\n  path.context = function(_) {\n    if (!arguments.length) return context;\n    contextStream = _ == null ? (context = null, new PathString(digits)) : new PathContext(context = _);\n    if (typeof pointRadius !== \"function\") contextStream.pointRadius(pointRadius);\n    return path;\n  };\n\n  path.pointRadius = function(_) {\n    if (!arguments.length) return pointRadius;\n    pointRadius = typeof _ === \"function\" ? _ : (contextStream.pointRadius(+_), +_);\n    return path;\n  };\n\n  path.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) digits = null;\n    else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    if (context === null) contextStream = new PathString(digits);\n    return path;\n  };\n\n  return path.projection(projection).digits(digits).context(context);\n}\n","export default function noop() {}\n","import noop from \"../noop.js\";\n\nexport default function() {\n  var lines = [],\n      line;\n  return {\n    point: function(x, y, m) {\n      line.push([x, y, m]);\n    },\n    lineStart: function() {\n      lines.push(line = []);\n    },\n    lineEnd: noop,\n    rejoin: function() {\n      if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));\n    },\n    result: function() {\n      var result = lines;\n      lines = [];\n      line = null;\n      return result;\n    }\n  };\n}\n","export var epsilon = 1e-6;\nexport var epsilon2 = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var quarterPi = pi / 4;\nexport var tau = pi * 2;\n\nexport var degrees = 180 / pi;\nexport var radians = pi / 180;\n\nexport var abs = Math.abs;\nexport var atan = Math.atan;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var ceil = Math.ceil;\nexport var exp = Math.exp;\nexport var floor = Math.floor;\nexport var hypot = Math.hypot;\nexport var log = Math.log;\nexport var pow = Math.pow;\nexport var sin = Math.sin;\nexport var sign = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };\nexport var sqrt = Math.sqrt;\nexport var tan = Math.tan;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x > 1 ? halfPi : x < -1 ? -halfPi : Math.asin(x);\n}\n\nexport function haversin(x) {\n  return (x = sin(x / 2)) * x;\n}\n","import {abs, epsilon} from \"./math.js\";\n\nexport default function(a, b) {\n  return abs(a[0] - b[0]) < epsilon && abs(a[1] - b[1]) < epsilon;\n}\n","import pointEqual from \"../pointEqual.js\";\nimport {epsilon} from \"../math.js\";\n\nfunction Intersection(point, points, other, entry) {\n  this.x = point;\n  this.z = points;\n  this.o = other; // another intersection\n  this.e = entry; // is an entry?\n  this.v = false; // visited\n  this.n = this.p = null; // next & previous\n}\n\n// A generalized polygon clipping algorithm: given a polygon that has been cut\n// into its visible line segments, and rejoins the segments by interpolating\n// along the clip edge.\nexport default function(segments, compareIntersection, startInside, interpolate, stream) {\n  var subject = [],\n      clip = [],\n      i,\n      n;\n\n  segments.forEach(function(segment) {\n    if ((n = segment.length - 1) <= 0) return;\n    var n, p0 = segment[0], p1 = segment[n], x;\n\n    if (pointEqual(p0, p1)) {\n      if (!p0[2] && !p1[2]) {\n        stream.lineStart();\n        for (i = 0; i < n; ++i) stream.point((p0 = segment[i])[0], p0[1]);\n        stream.lineEnd();\n        return;\n      }\n      // handle degenerate cases by moving the point\n      p1[0] += 2 * epsilon;\n    }\n\n    subject.push(x = new Intersection(p0, segment, null, true));\n    clip.push(x.o = new Intersection(p0, null, x, false));\n    subject.push(x = new Intersection(p1, segment, null, false));\n    clip.push(x.o = new Intersection(p1, null, x, true));\n  });\n\n  if (!subject.length) return;\n\n  clip.sort(compareIntersection);\n  link(subject);\n  link(clip);\n\n  for (i = 0, n = clip.length; i < n; ++i) {\n    clip[i].e = startInside = !startInside;\n  }\n\n  var start = subject[0],\n      points,\n      point;\n\n  while (1) {\n    // Find first unvisited intersection.\n    var current = start,\n        isSubject = true;\n    while (current.v) if ((current = current.n) === start) return;\n    points = current.z;\n    stream.lineStart();\n    do {\n      current.v = current.o.v = true;\n      if (current.e) {\n        if (isSubject) {\n          for (i = 0, n = points.length; i < n; ++i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.n.x, 1, stream);\n        }\n        current = current.n;\n      } else {\n        if (isSubject) {\n          points = current.p.z;\n          for (i = points.length - 1; i >= 0; --i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.p.x, -1, stream);\n        }\n        current = current.p;\n      }\n      current = current.o;\n      points = current.z;\n      isSubject = !isSubject;\n    } while (!current.v);\n    stream.lineEnd();\n  }\n}\n\nfunction link(array) {\n  if (!(n = array.length)) return;\n  var n,\n      i = 0,\n      a = array[0],\n      b;\n  while (++i < n) {\n    a.n = b = array[i];\n    b.p = a;\n    a = b;\n  }\n  a.n = b = array[0];\n  b.p = a;\n}\n","// https://github.com/python/cpython/blob/a74eea238f5baba15797e2e8b570d153bc8690a7/Modules/mathmodule.c#L1423\nexport class Adder {\n  constructor() {\n    this._partials = new Float64Array(32);\n    this._n = 0;\n  }\n  add(x) {\n    const p = this._partials;\n    let i = 0;\n    for (let j = 0; j < this._n && j < 32; j++) {\n      const y = p[j],\n        hi = x + y,\n        lo = Math.abs(x) < Math.abs(y) ? x - (hi - y) : y - (hi - x);\n      if (lo) p[i++] = lo;\n      x = hi;\n    }\n    p[i] = x;\n    this._n = i + 1;\n    return this;\n  }\n  valueOf() {\n    const p = this._partials;\n    let n = this._n, x, y, lo, hi = 0;\n    if (n > 0) {\n      hi = p[--n];\n      while (n > 0) {\n        x = hi;\n        y = p[--n];\n        hi = x + y;\n        lo = y - (hi - x);\n        if (lo) break;\n      }\n      if (n > 0 && ((lo < 0 && p[n - 1] < 0) || (lo > 0 && p[n - 1] > 0))) {\n        y = lo * 2;\n        x = hi + y;\n        if (y == x - hi) hi = x;\n      }\n    }\n    return hi;\n  }\n}\n\nexport function fsum(values, valueof) {\n  const adder = new Adder();\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        adder.add(value);\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        adder.add(value);\n      }\n    }\n  }\n  return +adder;\n}\n\nexport function fcumsum(values, valueof) {\n  const adder = new Adder();\n  let index = -1;\n  return Float64Array.from(values, valueof === undefined\n      ? v => adder.add(+v || 0)\n      : v => adder.add(+valueof(v, ++index, values) || 0)\n  );\n}\n","import {asin, atan2, cos, sin, sqrt} from \"./math.js\";\n\nexport function spherical(cartesian) {\n  return [atan2(cartesian[1], cartesian[0]), asin(cartesian[2])];\n}\n\nexport function cartesian(spherical) {\n  var lambda = spherical[0], phi = spherical[1], cosPhi = cos(phi);\n  return [cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi)];\n}\n\nexport function cartesianDot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nexport function cartesianCross(a, b) {\n  return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\n}\n\n// TODO return a\nexport function cartesianAddInPlace(a, b) {\n  a[0] += b[0], a[1] += b[1], a[2] += b[2];\n}\n\nexport function cartesianScale(vector, k) {\n  return [vector[0] * k, vector[1] * k, vector[2] * k];\n}\n\n// TODO return d\nexport function cartesianNormalizeInPlace(d) {\n  var l = sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);\n  d[0] /= l, d[1] /= l, d[2] /= l;\n}\n","import {Adder} from \"d3-array\";\nimport {cartesian, cartesianCross, cartesianNormalizeInPlace} from \"./cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, epsilon2, halfPi, pi, quarterPi, sign, sin, tau} from \"./math.js\";\n\nfunction longitude(point) {\n  if (abs(point[0]) <= pi)\n    return point[0];\n  else\n    return sign(point[0]) * ((abs(point[0]) + pi) % tau - pi);\n}\n\nexport default function(polygon, point) {\n  var lambda = longitude(point),\n      phi = point[1],\n      sinPhi = sin(phi),\n      normal = [sin(lambda), -cos(lambda), 0],\n      angle = 0,\n      winding = 0;\n\n  var sum = new Adder();\n\n  if (sinPhi === 1) phi = halfPi + epsilon;\n  else if (sinPhi === -1) phi = -halfPi - epsilon;\n\n  for (var i = 0, n = polygon.length; i < n; ++i) {\n    if (!(m = (ring = polygon[i]).length)) continue;\n    var ring,\n        m,\n        point0 = ring[m - 1],\n        lambda0 = longitude(point0),\n        phi0 = point0[1] / 2 + quarterPi,\n        sinPhi0 = sin(phi0),\n        cosPhi0 = cos(phi0);\n\n    for (var j = 0; j < m; ++j, lambda0 = lambda1, sinPhi0 = sinPhi1, cosPhi0 = cosPhi1, point0 = point1) {\n      var point1 = ring[j],\n          lambda1 = longitude(point1),\n          phi1 = point1[1] / 2 + quarterPi,\n          sinPhi1 = sin(phi1),\n          cosPhi1 = cos(phi1),\n          delta = lambda1 - lambda0,\n          sign = delta >= 0 ? 1 : -1,\n          absDelta = sign * delta,\n          antimeridian = absDelta > pi,\n          k = sinPhi0 * sinPhi1;\n\n      sum.add(atan2(k * sign * sin(absDelta), cosPhi0 * cosPhi1 + k * cos(absDelta)));\n      angle += antimeridian ? delta + sign * tau : delta;\n\n      // Are the longitudes either side of the points meridian (lambda),\n      // and are the latitudes smaller than the parallel (phi)?\n      if (antimeridian ^ lambda0 >= lambda ^ lambda1 >= lambda) {\n        var arc = cartesianCross(cartesian(point0), cartesian(point1));\n        cartesianNormalizeInPlace(arc);\n        var intersection = cartesianCross(normal, arc);\n        cartesianNormalizeInPlace(intersection);\n        var phiArc = (antimeridian ^ delta >= 0 ? -1 : 1) * asin(intersection[2]);\n        if (phi > phiArc || phi === phiArc && (arc[0] || arc[1])) {\n          winding += antimeridian ^ delta >= 0 ? 1 : -1;\n        }\n      }\n    }\n  }\n\n  // First, determine whether the South pole is inside or outside:\n  //\n  // It is inside if:\n  // * the polygon winds around it in a clockwise direction.\n  // * the polygon does not (cumulatively) wind around it, but has a negative\n  //   (counter-clockwise) area.\n  //\n  // Second, count the (signed) number of times a segment crosses a lambda\n  // from the point to the South pole.  If it is zero, then the point is the\n  // same side as the South pole.\n\n  return (angle < -epsilon || angle < epsilon && sum < -epsilon2) ^ (winding & 1);\n}\n","function* flatten(arrays) {\n  for (const array of arrays) {\n    yield* array;\n  }\n}\n\nexport default function merge(arrays) {\n  return Array.from(flatten(arrays));\n}\n","import clipBuffer from \"./buffer.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {epsilon, halfPi} from \"../math.js\";\nimport polygonContains from \"../polygonContains.js\";\nimport {merge} from \"d3-array\";\n\nexport default function(pointVisible, clipLine, interpolate, start) {\n  return function(sink) {\n    var line = clipLine(sink),\n        ringBuffer = clipBuffer(),\n        ringSink = clipLine(ringBuffer),\n        polygonStarted = false,\n        polygon,\n        segments,\n        ring;\n\n    var clip = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() {\n        clip.point = pointRing;\n        clip.lineStart = ringStart;\n        clip.lineEnd = ringEnd;\n        segments = [];\n        polygon = [];\n      },\n      polygonEnd: function() {\n        clip.point = point;\n        clip.lineStart = lineStart;\n        clip.lineEnd = lineEnd;\n        segments = merge(segments);\n        var startInside = polygonContains(polygon, start);\n        if (segments.length) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          clipRejoin(segments, compareIntersection, startInside, interpolate, sink);\n        } else if (startInside) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          interpolate(null, null, 1, sink);\n          sink.lineEnd();\n        }\n        if (polygonStarted) sink.polygonEnd(), polygonStarted = false;\n        segments = polygon = null;\n      },\n      sphere: function() {\n        sink.polygonStart();\n        sink.lineStart();\n        interpolate(null, null, 1, sink);\n        sink.lineEnd();\n        sink.polygonEnd();\n      }\n    };\n\n    function point(lambda, phi) {\n      if (pointVisible(lambda, phi)) sink.point(lambda, phi);\n    }\n\n    function pointLine(lambda, phi) {\n      line.point(lambda, phi);\n    }\n\n    function lineStart() {\n      clip.point = pointLine;\n      line.lineStart();\n    }\n\n    function lineEnd() {\n      clip.point = point;\n      line.lineEnd();\n    }\n\n    function pointRing(lambda, phi) {\n      ring.push([lambda, phi]);\n      ringSink.point(lambda, phi);\n    }\n\n    function ringStart() {\n      ringSink.lineStart();\n      ring = [];\n    }\n\n    function ringEnd() {\n      pointRing(ring[0][0], ring[0][1]);\n      ringSink.lineEnd();\n\n      var clean = ringSink.clean(),\n          ringSegments = ringBuffer.result(),\n          i, n = ringSegments.length, m,\n          segment,\n          point;\n\n      ring.pop();\n      polygon.push(ring);\n      ring = null;\n\n      if (!n) return;\n\n      // No intersections.\n      if (clean & 1) {\n        segment = ringSegments[0];\n        if ((m = segment.length - 1) > 0) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          for (i = 0; i < m; ++i) sink.point((point = segment[i])[0], point[1]);\n          sink.lineEnd();\n        }\n        return;\n      }\n\n      // Rejoin connected segments.\n      // TODO reuse ringBuffer.rejoin()?\n      if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));\n\n      segments.push(ringSegments.filter(validSegment));\n    }\n\n    return clip;\n  };\n}\n\nfunction validSegment(segment) {\n  return segment.length > 1;\n}\n\n// Intersections are sorted along the clip edge. For both antimeridian cutting\n// and circle clipping, the same comparison is used.\nfunction compareIntersection(a, b) {\n  return ((a = a.x)[0] < 0 ? a[1] - halfPi - epsilon : halfPi - a[1])\n       - ((b = b.x)[0] < 0 ? b[1] - halfPi - epsilon : halfPi - b[1]);\n}\n","import clip from \"./index.js\";\nimport {abs, atan, cos, epsilon, halfPi, pi, sin} from \"../math.js\";\n\nexport default clip(\n  function() { return true; },\n  clipAntimeridianLine,\n  clipAntimeridianInterpolate,\n  [-pi, -halfPi]\n);\n\n// Takes a line and cuts into visible segments. Return values: 0 - there were\n// intersections or the line was empty; 1 - no intersections; 2 - there were\n// intersections, and the first and last segments should be rejoined.\nfunction clipAntimeridianLine(stream) {\n  var lambda0 = NaN,\n      phi0 = NaN,\n      sign0 = NaN,\n      clean; // no intersections\n\n  return {\n    lineStart: function() {\n      stream.lineStart();\n      clean = 1;\n    },\n    point: function(lambda1, phi1) {\n      var sign1 = lambda1 > 0 ? pi : -pi,\n          delta = abs(lambda1 - lambda0);\n      if (abs(delta - pi) < epsilon) { // line crosses a pole\n        stream.point(lambda0, phi0 = (phi0 + phi1) / 2 > 0 ? halfPi : -halfPi);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        stream.point(lambda1, phi0);\n        clean = 0;\n      } else if (sign0 !== sign1 && delta >= pi) { // line crosses antimeridian\n        if (abs(lambda0 - sign0) < epsilon) lambda0 -= sign0 * epsilon; // handle degeneracies\n        if (abs(lambda1 - sign1) < epsilon) lambda1 -= sign1 * epsilon;\n        phi0 = clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        clean = 0;\n      }\n      stream.point(lambda0 = lambda1, phi0 = phi1);\n      sign0 = sign1;\n    },\n    lineEnd: function() {\n      stream.lineEnd();\n      lambda0 = phi0 = NaN;\n    },\n    clean: function() {\n      return 2 - clean; // if intersections, rejoin first and last segments\n    }\n  };\n}\n\nfunction clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1) {\n  var cosPhi0,\n      cosPhi1,\n      sinLambda0Lambda1 = sin(lambda0 - lambda1);\n  return abs(sinLambda0Lambda1) > epsilon\n      ? atan((sin(phi0) * (cosPhi1 = cos(phi1)) * sin(lambda1)\n          - sin(phi1) * (cosPhi0 = cos(phi0)) * sin(lambda0))\n          / (cosPhi0 * cosPhi1 * sinLambda0Lambda1))\n      : (phi0 + phi1) / 2;\n}\n\nfunction clipAntimeridianInterpolate(from, to, direction, stream) {\n  var phi;\n  if (from == null) {\n    phi = direction * halfPi;\n    stream.point(-pi, phi);\n    stream.point(0, phi);\n    stream.point(pi, phi);\n    stream.point(pi, 0);\n    stream.point(pi, -phi);\n    stream.point(0, -phi);\n    stream.point(-pi, -phi);\n    stream.point(-pi, 0);\n    stream.point(-pi, phi);\n  } else if (abs(from[0] - to[0]) > epsilon) {\n    var lambda = from[0] < to[0] ? pi : -pi;\n    phi = direction * lambda / 2;\n    stream.point(-lambda, phi);\n    stream.point(0, phi);\n    stream.point(lambda, phi);\n  } else {\n    stream.point(to[0], to[1]);\n  }\n}\n","import {cartesian, cartesianNormalizeInPlace, spherical} from \"./cartesian.js\";\nimport constant from \"./constant.js\";\nimport {acos, cos, degrees, epsilon, radians, sin, tau} from \"./math.js\";\nimport {rotateRadians} from \"./rotation.js\";\n\n// Generates a circle centered at [0, 0], with a given radius and precision.\nexport function circleStream(stream, radius, delta, direction, t0, t1) {\n  if (!delta) return;\n  var cosRadius = cos(radius),\n      sinRadius = sin(radius),\n      step = direction * delta;\n  if (t0 == null) {\n    t0 = radius + direction * tau;\n    t1 = radius - step / 2;\n  } else {\n    t0 = circleRadius(cosRadius, t0);\n    t1 = circleRadius(cosRadius, t1);\n    if (direction > 0 ? t0 < t1 : t0 > t1) t0 += direction * tau;\n  }\n  for (var point, t = t0; direction > 0 ? t > t1 : t < t1; t -= step) {\n    point = spherical([cosRadius, -sinRadius * cos(t), -sinRadius * sin(t)]);\n    stream.point(point[0], point[1]);\n  }\n}\n\n// Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].\nfunction circleRadius(cosRadius, point) {\n  point = cartesian(point), point[0] -= cosRadius;\n  cartesianNormalizeInPlace(point);\n  var radius = acos(-point[1]);\n  return ((-point[2] < 0 ? -radius : radius) + tau - epsilon) % tau;\n}\n\nexport default function() {\n  var center = constant([0, 0]),\n      radius = constant(90),\n      precision = constant(6),\n      ring,\n      rotate,\n      stream = {point: point};\n\n  function point(x, y) {\n    ring.push(x = rotate(x, y));\n    x[0] *= degrees, x[1] *= degrees;\n  }\n\n  function circle() {\n    var c = center.apply(this, arguments),\n        r = radius.apply(this, arguments) * radians,\n        p = precision.apply(this, arguments) * radians;\n    ring = [];\n    rotate = rotateRadians(-c[0] * radians, -c[1] * radians, 0).invert;\n    circleStream(stream, r, p, 1);\n    c = {type: \"Polygon\", coordinates: [ring]};\n    ring = rotate = null;\n    return c;\n  }\n\n  circle.center = function(_) {\n    return arguments.length ? (center = typeof _ === \"function\" ? _ : constant([+_[0], +_[1]]), circle) : center;\n  };\n\n  circle.radius = function(_) {\n    return arguments.length ? (radius = typeof _ === \"function\" ? _ : constant(+_), circle) : radius;\n  };\n\n  circle.precision = function(_) {\n    return arguments.length ? (precision = typeof _ === \"function\" ? _ : constant(+_), circle) : precision;\n  };\n\n  return circle;\n}\n","import {abs, epsilon} from \"../math.js\";\nimport clipBuffer from \"./buffer.js\";\nimport clipLine from \"./line.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {merge} from \"d3-array\";\n\nvar clipMax = 1e9, clipMin = -clipMax;\n\n// TODO Use d3-polygons polygonContains here for the ring check?\n// TODO Eliminate duplicate buffering in clipBuffer and polygon.push?\n\nexport default function clipRectangle(x0, y0, x1, y1) {\n\n  function visible(x, y) {\n    return x0 <= x && x <= x1 && y0 <= y && y <= y1;\n  }\n\n  function interpolate(from, to, direction, stream) {\n    var a = 0, a1 = 0;\n    if (from == null\n        || (a = corner(from, direction)) !== (a1 = corner(to, direction))\n        || comparePoint(from, to) < 0 ^ direction > 0) {\n      do stream.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);\n      while ((a = (a + direction + 4) % 4) !== a1);\n    } else {\n      stream.point(to[0], to[1]);\n    }\n  }\n\n  function corner(p, direction) {\n    return abs(p[0] - x0) < epsilon ? direction > 0 ? 0 : 3\n        : abs(p[0] - x1) < epsilon ? direction > 0 ? 2 : 1\n        : abs(p[1] - y0) < epsilon ? direction > 0 ? 1 : 0\n        : direction > 0 ? 3 : 2; // abs(p[1] - y1) < epsilon\n  }\n\n  function compareIntersection(a, b) {\n    return comparePoint(a.x, b.x);\n  }\n\n  function comparePoint(a, b) {\n    var ca = corner(a, 1),\n        cb = corner(b, 1);\n    return ca !== cb ? ca - cb\n        : ca === 0 ? b[1] - a[1]\n        : ca === 1 ? a[0] - b[0]\n        : ca === 2 ? a[1] - b[1]\n        : b[0] - a[0];\n  }\n\n  return function(stream) {\n    var activeStream = stream,\n        bufferStream = clipBuffer(),\n        segments,\n        polygon,\n        ring,\n        x__, y__, v__, // first point\n        x_, y_, v_, // previous point\n        first,\n        clean;\n\n    var clipStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: polygonStart,\n      polygonEnd: polygonEnd\n    };\n\n    function point(x, y) {\n      if (visible(x, y)) activeStream.point(x, y);\n    }\n\n    function polygonInside() {\n      var winding = 0;\n\n      for (var i = 0, n = polygon.length; i < n; ++i) {\n        for (var ring = polygon[i], j = 1, m = ring.length, point = ring[0], a0, a1, b0 = point[0], b1 = point[1]; j < m; ++j) {\n          a0 = b0, a1 = b1, point = ring[j], b0 = point[0], b1 = point[1];\n          if (a1 <= y1) { if (b1 > y1 && (b0 - a0) * (y1 - a1) > (b1 - a1) * (x0 - a0)) ++winding; }\n          else { if (b1 <= y1 && (b0 - a0) * (y1 - a1) < (b1 - a1) * (x0 - a0)) --winding; }\n        }\n      }\n\n      return winding;\n    }\n\n    // Buffer geometry within a polygon and then clip it en masse.\n    function polygonStart() {\n      activeStream = bufferStream, segments = [], polygon = [], clean = true;\n    }\n\n    function polygonEnd() {\n      var startInside = polygonInside(),\n          cleanInside = clean && startInside,\n          visible = (segments = merge(segments)).length;\n      if (cleanInside || visible) {\n        stream.polygonStart();\n        if (cleanInside) {\n          stream.lineStart();\n          interpolate(null, null, 1, stream);\n          stream.lineEnd();\n        }\n        if (visible) {\n          clipRejoin(segments, compareIntersection, startInside, interpolate, stream);\n        }\n        stream.polygonEnd();\n      }\n      activeStream = stream, segments = polygon = ring = null;\n    }\n\n    function lineStart() {\n      clipStream.point = linePoint;\n      if (polygon) polygon.push(ring = []);\n      first = true;\n      v_ = false;\n      x_ = y_ = NaN;\n    }\n\n    // TODO rather than special-case polygons, simply handle them separately.\n    // Ideally, coincident intersection points should be jittered to avoid\n    // clipping issues.\n    function lineEnd() {\n      if (segments) {\n        linePoint(x__, y__);\n        if (v__ && v_) bufferStream.rejoin();\n        segments.push(bufferStream.result());\n      }\n      clipStream.point = point;\n      if (v_) activeStream.lineEnd();\n    }\n\n    function linePoint(x, y) {\n      var v = visible(x, y);\n      if (polygon) ring.push([x, y]);\n      if (first) {\n        x__ = x, y__ = y, v__ = v;\n        first = false;\n        if (v) {\n          activeStream.lineStart();\n          activeStream.point(x, y);\n        }\n      } else {\n        if (v && v_) activeStream.point(x, y);\n        else {\n          var a = [x_ = Math.max(clipMin, Math.min(clipMax, x_)), y_ = Math.max(clipMin, Math.min(clipMax, y_))],\n              b = [x = Math.max(clipMin, Math.min(clipMax, x)), y = Math.max(clipMin, Math.min(clipMax, y))];\n          if (clipLine(a, b, x0, y0, x1, y1)) {\n            if (!v_) {\n              activeStream.lineStart();\n              activeStream.point(a[0], a[1]);\n            }\n            activeStream.point(b[0], b[1]);\n            if (!v) activeStream.lineEnd();\n            clean = false;\n          } else if (v) {\n            activeStream.lineStart();\n            activeStream.point(x, y);\n            clean = false;\n          }\n        }\n      }\n      x_ = x, y_ = y, v_ = v;\n    }\n\n    return clipStream;\n  };\n}\n","export default function(a, b, x0, y0, x1, y1) {\n  var ax = a[0],\n      ay = a[1],\n      bx = b[0],\n      by = b[1],\n      t0 = 0,\n      t1 = 1,\n      dx = bx - ax,\n      dy = by - ay,\n      r;\n\n  r = x0 - ax;\n  if (!dx && r > 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dx > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = x1 - ax;\n  if (!dx && r < 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dx > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  r = y0 - ay;\n  if (!dy && r > 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dy > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = y1 - ay;\n  if (!dy && r < 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dy > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  if (t0 > 0) a[0] = ax + t0 * dx, a[1] = ay + t0 * dy;\n  if (t1 < 1) b[0] = ax + t1 * dx, b[1] = ay + t1 * dy;\n  return true;\n}\n","export default function(a, b) {\n\n  function compose(x, y) {\n    return x = a(x, y), b(x[0], x[1]);\n  }\n\n  if (a.invert && b.invert) compose.invert = function(x, y) {\n    return x = b.invert(x, y), x && a.invert(x[0], x[1]);\n  };\n\n  return compose;\n}\n","export default x => x;\n","import compose from \"./compose.js\";\nimport {abs, asin, atan2, cos, degrees, pi, radians, sin, tau} from \"./math.js\";\n\nfunction rotationIdentity(lambda, phi) {\n  return [abs(lambda) > pi ? lambda + Math.round(-lambda / tau) * tau : lambda, phi];\n}\n\nrotationIdentity.invert = rotationIdentity;\n\nexport function rotateRadians(deltaLambda, deltaPhi, deltaGamma) {\n  return (deltaLambda %= tau) ? (deltaPhi || deltaGamma ? compose(rotationLambda(deltaLambda), rotationPhiGamma(deltaPhi, deltaGamma))\n    : rotationLambda(deltaLambda))\n    : (deltaPhi || deltaGamma ? rotationPhiGamma(deltaPhi, deltaGamma)\n    : rotationIdentity);\n}\n\nfunction forwardRotationLambda(deltaLambda) {\n  return function(lambda, phi) {\n    return lambda += deltaLambda, [lambda > pi ? lambda - tau : lambda < -pi ? lambda + tau : lambda, phi];\n  };\n}\n\nfunction rotationLambda(deltaLambda) {\n  var rotation = forwardRotationLambda(deltaLambda);\n  rotation.invert = forwardRotationLambda(-deltaLambda);\n  return rotation;\n}\n\nfunction rotationPhiGamma(deltaPhi, deltaGamma) {\n  var cosDeltaPhi = cos(deltaPhi),\n      sinDeltaPhi = sin(deltaPhi),\n      cosDeltaGamma = cos(deltaGamma),\n      sinDeltaGamma = sin(deltaGamma);\n\n  function rotation(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaPhi + x * sinDeltaPhi;\n    return [\n      atan2(y * cosDeltaGamma - k * sinDeltaGamma, x * cosDeltaPhi - z * sinDeltaPhi),\n      asin(k * cosDeltaGamma + y * sinDeltaGamma)\n    ];\n  }\n\n  rotation.invert = function(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaGamma - y * sinDeltaGamma;\n    return [\n      atan2(y * cosDeltaGamma + z * sinDeltaGamma, x * cosDeltaPhi + k * sinDeltaPhi),\n      asin(k * cosDeltaPhi - x * sinDeltaPhi)\n    ];\n  };\n\n  return rotation;\n}\n\nexport default function(rotate) {\n  rotate = rotateRadians(rotate[0] * radians, rotate[1] * radians, rotate.length > 2 ? rotate[2] * radians : 0);\n\n  function forward(coordinates) {\n    coordinates = rotate(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  }\n\n  forward.invert = function(coordinates) {\n    coordinates = rotate.invert(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  };\n\n  return forward;\n}\n","export default function(methods) {\n  return {\n    stream: transformer(methods)\n  };\n}\n\nexport function transformer(methods) {\n  return function(stream) {\n    var s = new TransformStream;\n    for (var key in methods) s[key] = methods[key];\n    s.stream = stream;\n    return s;\n  };\n}\n\nfunction TransformStream() {}\n\nTransformStream.prototype = {\n  constructor: TransformStream,\n  point: function(x, y) { this.stream.point(x, y); },\n  sphere: function() { this.stream.sphere(); },\n  lineStart: function() { this.stream.lineStart(); },\n  lineEnd: function() { this.stream.lineEnd(); },\n  polygonStart: function() { this.stream.polygonStart(); },\n  polygonEnd: function() { this.stream.polygonEnd(); }\n};\n","function streamGeometry(geometry, stream) {\n  if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {\n    streamGeometryType[geometry.type](geometry, stream);\n  }\n}\n\nvar streamObjectType = {\n  Feature: function(object, stream) {\n    streamGeometry(object.geometry, stream);\n  },\n  FeatureCollection: function(object, stream) {\n    var features = object.features, i = -1, n = features.length;\n    while (++i < n) streamGeometry(features[i].geometry, stream);\n  }\n};\n\nvar streamGeometryType = {\n  Sphere: function(object, stream) {\n    stream.sphere();\n  },\n  Point: function(object, stream) {\n    object = object.coordinates;\n    stream.point(object[0], object[1], object[2]);\n  },\n  MultiPoint: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) object = coordinates[i], stream.point(object[0], object[1], object[2]);\n  },\n  LineString: function(object, stream) {\n    streamLine(object.coordinates, stream, 0);\n  },\n  MultiLineString: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamLine(coordinates[i], stream, 0);\n  },\n  Polygon: function(object, stream) {\n    streamPolygon(object.coordinates, stream);\n  },\n  MultiPolygon: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamPolygon(coordinates[i], stream);\n  },\n  GeometryCollection: function(object, stream) {\n    var geometries = object.geometries, i = -1, n = geometries.length;\n    while (++i < n) streamGeometry(geometries[i], stream);\n  }\n};\n\nfunction streamLine(coordinates, stream, closed) {\n  var i = -1, n = coordinates.length - closed, coordinate;\n  stream.lineStart();\n  while (++i < n) coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);\n  stream.lineEnd();\n}\n\nfunction streamPolygon(coordinates, stream) {\n  var i = -1, n = coordinates.length;\n  stream.polygonStart();\n  while (++i < n) streamLine(coordinates[i], stream, 1);\n  stream.polygonEnd();\n}\n\nexport default function(object, stream) {\n  if (object && streamObjectType.hasOwnProperty(object.type)) {\n    streamObjectType[object.type](object, stream);\n  } else {\n    streamGeometry(object, stream);\n  }\n}\n","import noop from \"../noop.js\";\n\nvar x0 = Infinity,\n    y0 = x0,\n    x1 = -x0,\n    y1 = x1;\n\nvar boundsStream = {\n  point: boundsPoint,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: noop,\n  polygonEnd: noop,\n  result: function() {\n    var bounds = [[x0, y0], [x1, y1]];\n    x1 = y1 = -(y0 = x0 = Infinity);\n    return bounds;\n  }\n};\n\nfunction boundsPoint(x, y) {\n  if (x < x0) x0 = x;\n  if (x > x1) x1 = x;\n  if (y < y0) y0 = y;\n  if (y > y1) y1 = y;\n}\n\nexport default boundsStream;\n","import {default as geoStream} from \"../stream.js\";\nimport boundsStream from \"../path/bounds.js\";\n\nfunction fit(projection, fitBounds, object) {\n  var clip = projection.clipExtent && projection.clipExtent();\n  projection.scale(150).translate([0, 0]);\n  if (clip != null) projection.clipExtent(null);\n  geoStream(object, projection.stream(boundsStream));\n  fitBounds(boundsStream.result());\n  if (clip != null) projection.clipExtent(clip);\n  return projection;\n}\n\nexport function fitExtent(projection, extent, object) {\n  return fit(projection, function(b) {\n    var w = extent[1][0] - extent[0][0],\n        h = extent[1][1] - extent[0][1],\n        k = Math.min(w / (b[1][0] - b[0][0]), h / (b[1][1] - b[0][1])),\n        x = +extent[0][0] + (w - k * (b[1][0] + b[0][0])) / 2,\n        y = +extent[0][1] + (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitSize(projection, size, object) {\n  return fitExtent(projection, [[0, 0], size], object);\n}\n\nexport function fitWidth(projection, width, object) {\n  return fit(projection, function(b) {\n    var w = +width,\n        k = w / (b[1][0] - b[0][0]),\n        x = (w - k * (b[1][0] + b[0][0])) / 2,\n        y = -k * b[0][1];\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitHeight(projection, height, object) {\n  return fit(projection, function(b) {\n    var h = +height,\n        k = h / (b[1][1] - b[0][1]),\n        x = -k * b[0][0],\n        y = (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n","import {cartesian} from \"../cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, radians, sqrt} from \"../math.js\";\nimport {transformer} from \"../transform.js\";\n\nvar maxDepth = 16, // maximum depth of subdivision\n    cosMinDistance = cos(30 * radians); // cos(minimum angular distance)\n\nexport default function(project, delta2) {\n  return +delta2 ? resample(project, delta2) : resampleNone(project);\n}\n\nfunction resampleNone(project) {\n  return transformer({\n    point: function(x, y) {\n      x = project(x, y);\n      this.stream.point(x[0], x[1]);\n    }\n  });\n}\n\nfunction resample(project, delta2) {\n\n  function resampleLineTo(x0, y0, lambda0, a0, b0, c0, x1, y1, lambda1, a1, b1, c1, depth, stream) {\n    var dx = x1 - x0,\n        dy = y1 - y0,\n        d2 = dx * dx + dy * dy;\n    if (d2 > 4 * delta2 && depth--) {\n      var a = a0 + a1,\n          b = b0 + b1,\n          c = c0 + c1,\n          m = sqrt(a * a + b * b + c * c),\n          phi2 = asin(c /= m),\n          lambda2 = abs(abs(c) - 1) < epsilon || abs(lambda0 - lambda1) < epsilon ? (lambda0 + lambda1) / 2 : atan2(b, a),\n          p = project(lambda2, phi2),\n          x2 = p[0],\n          y2 = p[1],\n          dx2 = x2 - x0,\n          dy2 = y2 - y0,\n          dz = dy * dx2 - dx * dy2;\n      if (dz * dz / d2 > delta2 // perpendicular projected distance\n          || abs((dx * dx2 + dy * dy2) / d2 - 0.5) > 0.3 // midpoint close to an end\n          || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) { // angular distance\n        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x2, y2, lambda2, a /= m, b /= m, c, depth, stream);\n        stream.point(x2, y2);\n        resampleLineTo(x2, y2, lambda2, a, b, c, x1, y1, lambda1, a1, b1, c1, depth, stream);\n      }\n    }\n  }\n  return function(stream) {\n    var lambda00, x00, y00, a00, b00, c00, // first point\n        lambda0, x0, y0, a0, b0, c0; // previous point\n\n    var resampleStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() { stream.polygonStart(); resampleStream.lineStart = ringStart; },\n      polygonEnd: function() { stream.polygonEnd(); resampleStream.lineStart = lineStart; }\n    };\n\n    function point(x, y) {\n      x = project(x, y);\n      stream.point(x[0], x[1]);\n    }\n\n    function lineStart() {\n      x0 = NaN;\n      resampleStream.point = linePoint;\n      stream.lineStart();\n    }\n\n    function linePoint(lambda, phi) {\n      var c = cartesian([lambda, phi]), p = project(lambda, phi);\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x0 = p[0], y0 = p[1], lambda0 = lambda, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);\n      stream.point(x0, y0);\n    }\n\n    function lineEnd() {\n      resampleStream.point = point;\n      stream.lineEnd();\n    }\n\n    function ringStart() {\n      lineStart();\n      resampleStream.point = ringPoint;\n      resampleStream.lineEnd = ringEnd;\n    }\n\n    function ringPoint(lambda, phi) {\n      linePoint(lambda00 = lambda, phi), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;\n      resampleStream.point = linePoint;\n    }\n\n    function ringEnd() {\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x00, y00, lambda00, a00, b00, c00, maxDepth, stream);\n      resampleStream.lineEnd = lineEnd;\n      lineEnd();\n    }\n\n    return resampleStream;\n  };\n}\n","import clipAntimeridian from \"../clip/antimeridian.js\";\nimport clipCircle from \"../clip/circle.js\";\nimport clipRectangle from \"../clip/rectangle.js\";\nimport compose from \"../compose.js\";\nimport identity from \"../identity.js\";\nimport {cos, degrees, radians, sin, sqrt} from \"../math.js\";\nimport {rotateRadians} from \"../rotation.js\";\nimport {transformer} from \"../transform.js\";\nimport {fitExtent, fitSize, fitWidth, fitHeight} from \"./fit.js\";\nimport resample from \"./resample.js\";\n\nvar transformRadians = transformer({\n  point: function(x, y) {\n    this.stream.point(x * radians, y * radians);\n  }\n});\n\nfunction transformRotate(rotate) {\n  return transformer({\n    point: function(x, y) {\n      var r = rotate(x, y);\n      return this.stream.point(r[0], r[1]);\n    }\n  });\n}\n\nfunction scaleTranslate(k, dx, dy, sx, sy) {\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [dx + k * x, dy - k * y];\n  }\n  transform.invert = function(x, y) {\n    return [(x - dx) / k * sx, (dy - y) / k * sy];\n  };\n  return transform;\n}\n\nfunction scaleTranslateRotate(k, dx, dy, sx, sy, alpha) {\n  if (!alpha) return scaleTranslate(k, dx, dy, sx, sy);\n  var cosAlpha = cos(alpha),\n      sinAlpha = sin(alpha),\n      a = cosAlpha * k,\n      b = sinAlpha * k,\n      ai = cosAlpha / k,\n      bi = sinAlpha / k,\n      ci = (sinAlpha * dy - cosAlpha * dx) / k,\n      fi = (sinAlpha * dx + cosAlpha * dy) / k;\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [a * x - b * y + dx, dy - b * x - a * y];\n  }\n  transform.invert = function(x, y) {\n    return [sx * (ai * x - bi * y + ci), sy * (fi - bi * x - ai * y)];\n  };\n  return transform;\n}\n\nexport default function projection(project) {\n  return projectionMutator(function() { return project; })();\n}\n\nexport function projectionMutator(projectAt) {\n  var project,\n      k = 150, // scale\n      x = 480, y = 250, // translate\n      lambda = 0, phi = 0, // center\n      deltaLambda = 0, deltaPhi = 0, deltaGamma = 0, rotate, // pre-rotate\n      alpha = 0, // post-rotate angle\n      sx = 1, // reflectX\n      sy = 1, // reflectX\n      theta = null, preclip = clipAntimeridian, // pre-clip angle\n      x0 = null, y0, x1, y1, postclip = identity, // post-clip extent\n      delta2 = 0.5, // precision\n      projectResample,\n      projectTransform,\n      projectRotateTransform,\n      cache,\n      cacheStream;\n\n  function projection(point) {\n    return projectRotateTransform(point[0] * radians, point[1] * radians);\n  }\n\n  function invert(point) {\n    point = projectRotateTransform.invert(point[0], point[1]);\n    return point && [point[0] * degrees, point[1] * degrees];\n  }\n\n  projection.stream = function(stream) {\n    return cache && cacheStream === stream ? cache : cache = transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream = stream)))));\n  };\n\n  projection.preclip = function(_) {\n    return arguments.length ? (preclip = _, theta = undefined, reset()) : preclip;\n  };\n\n  projection.postclip = function(_) {\n    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;\n  };\n\n  projection.clipAngle = function(_) {\n    return arguments.length ? (preclip = +_ ? clipCircle(theta = _ * radians) : (theta = null, clipAntimeridian), reset()) : theta * degrees;\n  };\n\n  projection.clipExtent = function(_) {\n    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];\n  };\n\n  projection.scale = function(_) {\n    return arguments.length ? (k = +_, recenter()) : k;\n  };\n\n  projection.translate = function(_) {\n    return arguments.length ? (x = +_[0], y = +_[1], recenter()) : [x, y];\n  };\n\n  projection.center = function(_) {\n    return arguments.length ? (lambda = _[0] % 360 * radians, phi = _[1] % 360 * radians, recenter()) : [lambda * degrees, phi * degrees];\n  };\n\n  projection.rotate = function(_) {\n    return arguments.length ? (deltaLambda = _[0] % 360 * radians, deltaPhi = _[1] % 360 * radians, deltaGamma = _.length > 2 ? _[2] % 360 * radians : 0, recenter()) : [deltaLambda * degrees, deltaPhi * degrees, deltaGamma * degrees];\n  };\n\n  projection.angle = function(_) {\n    return arguments.length ? (alpha = _ % 360 * radians, recenter()) : alpha * degrees;\n  };\n\n  projection.reflectX = function(_) {\n    return arguments.length ? (sx = _ ? -1 : 1, recenter()) : sx < 0;\n  };\n\n  projection.reflectY = function(_) {\n    return arguments.length ? (sy = _ ? -1 : 1, recenter()) : sy < 0;\n  };\n\n  projection.precision = function(_) {\n    return arguments.length ? (projectResample = resample(projectTransform, delta2 = _ * _), reset()) : sqrt(delta2);\n  };\n\n  projection.fitExtent = function(extent, object) {\n    return fitExtent(projection, extent, object);\n  };\n\n  projection.fitSize = function(size, object) {\n    return fitSize(projection, size, object);\n  };\n\n  projection.fitWidth = function(width, object) {\n    return fitWidth(projection, width, object);\n  };\n\n  projection.fitHeight = function(height, object) {\n    return fitHeight(projection, height, object);\n  };\n\n  function recenter() {\n    var center = scaleTranslateRotate(k, 0, 0, sx, sy, alpha).apply(null, project(lambda, phi)),\n        transform = scaleTranslateRotate(k, x - center[0], y - center[1], sx, sy, alpha);\n    rotate = rotateRadians(deltaLambda, deltaPhi, deltaGamma);\n    projectTransform = compose(project, transform);\n    projectRotateTransform = compose(rotate, projectTransform);\n    projectResample = resample(projectTransform, delta2);\n    return reset();\n  }\n\n  function reset() {\n    cache = cacheStream = null;\n    return projection;\n  }\n\n  return function() {\n    project = projectAt.apply(this, arguments);\n    projection.invert = project.invert && invert;\n    return recenter();\n  };\n}\n","import {cartesian, cartesianAddInPlace, cartesianCross, cartesianDot, cartesianScale, spherical} from \"../cartesian.js\";\nimport {circleStream} from \"../circle.js\";\nimport {abs, cos, epsilon, pi, radians, sqrt} from \"../math.js\";\nimport pointEqual from \"../pointEqual.js\";\nimport clip from \"./index.js\";\n\nexport default function(radius) {\n  var cr = cos(radius),\n      delta = 6 * radians,\n      smallRadius = cr > 0,\n      notHemisphere = abs(cr) > epsilon; // TODO optimise for this common case\n\n  function interpolate(from, to, direction, stream) {\n    circleStream(stream, radius, delta, direction, from, to);\n  }\n\n  function visible(lambda, phi) {\n    return cos(lambda) * cos(phi) > cr;\n  }\n\n  // Takes a line and cuts into visible segments. Return values used for polygon\n  // clipping: 0 - there were intersections or the line was empty; 1 - no\n  // intersections 2 - there were intersections, and the first and last segments\n  // should be rejoined.\n  function clipLine(stream) {\n    var point0, // previous point\n        c0, // code for previous point\n        v0, // visibility of previous point\n        v00, // visibility of first point\n        clean; // no intersections\n    return {\n      lineStart: function() {\n        v00 = v0 = false;\n        clean = 1;\n      },\n      point: function(lambda, phi) {\n        var point1 = [lambda, phi],\n            point2,\n            v = visible(lambda, phi),\n            c = smallRadius\n              ? v ? 0 : code(lambda, phi)\n              : v ? code(lambda + (lambda < 0 ? pi : -pi), phi) : 0;\n        if (!point0 && (v00 = v0 = v)) stream.lineStart();\n        if (v !== v0) {\n          point2 = intersect(point0, point1);\n          if (!point2 || pointEqual(point0, point2) || pointEqual(point1, point2))\n            point1[2] = 1;\n        }\n        if (v !== v0) {\n          clean = 0;\n          if (v) {\n            // outside going in\n            stream.lineStart();\n            point2 = intersect(point1, point0);\n            stream.point(point2[0], point2[1]);\n          } else {\n            // inside going out\n            point2 = intersect(point0, point1);\n            stream.point(point2[0], point2[1], 2);\n            stream.lineEnd();\n          }\n          point0 = point2;\n        } else if (notHemisphere && point0 && smallRadius ^ v) {\n          var t;\n          // If the codes for two points are different, or are both zero,\n          // and there this segment intersects with the small circle.\n          if (!(c & c0) && (t = intersect(point1, point0, true))) {\n            clean = 0;\n            if (smallRadius) {\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1]);\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n            } else {\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1], 3);\n            }\n          }\n        }\n        if (v && (!point0 || !pointEqual(point0, point1))) {\n          stream.point(point1[0], point1[1]);\n        }\n        point0 = point1, v0 = v, c0 = c;\n      },\n      lineEnd: function() {\n        if (v0) stream.lineEnd();\n        point0 = null;\n      },\n      // Rejoin first and last segments if there were intersections and the first\n      // and last points were visible.\n      clean: function() {\n        return clean | ((v00 && v0) << 1);\n      }\n    };\n  }\n\n  // Intersects the great circle between a and b with the clip circle.\n  function intersect(a, b, two) {\n    var pa = cartesian(a),\n        pb = cartesian(b);\n\n    // We have two planes, n1.p = d1 and n2.p = d2.\n    // Find intersection line p(t) = c1 n1 + c2 n2 + t (n1  n2).\n    var n1 = [1, 0, 0], // normal\n        n2 = cartesianCross(pa, pb),\n        n2n2 = cartesianDot(n2, n2),\n        n1n2 = n2[0], // cartesianDot(n1, n2),\n        determinant = n2n2 - n1n2 * n1n2;\n\n    // Two polar points.\n    if (!determinant) return !two && a;\n\n    var c1 =  cr * n2n2 / determinant,\n        c2 = -cr * n1n2 / determinant,\n        n1xn2 = cartesianCross(n1, n2),\n        A = cartesianScale(n1, c1),\n        B = cartesianScale(n2, c2);\n    cartesianAddInPlace(A, B);\n\n    // Solve |p(t)|^2 = 1.\n    var u = n1xn2,\n        w = cartesianDot(A, u),\n        uu = cartesianDot(u, u),\n        t2 = w * w - uu * (cartesianDot(A, A) - 1);\n\n    if (t2 < 0) return;\n\n    var t = sqrt(t2),\n        q = cartesianScale(u, (-w - t) / uu);\n    cartesianAddInPlace(q, A);\n    q = spherical(q);\n\n    if (!two) return q;\n\n    // Two intersection points.\n    var lambda0 = a[0],\n        lambda1 = b[0],\n        phi0 = a[1],\n        phi1 = b[1],\n        z;\n\n    if (lambda1 < lambda0) z = lambda0, lambda0 = lambda1, lambda1 = z;\n\n    var delta = lambda1 - lambda0,\n        polar = abs(delta - pi) < epsilon,\n        meridian = polar || delta < epsilon;\n\n    if (!polar && phi1 < phi0) z = phi0, phi0 = phi1, phi1 = z;\n\n    // Check that the first point is between a and b.\n    if (meridian\n        ? polar\n          ? phi0 + phi1 > 0 ^ q[1] < (abs(q[0] - lambda0) < epsilon ? phi0 : phi1)\n          : phi0 <= q[1] && q[1] <= phi1\n        : delta > pi ^ (lambda0 <= q[0] && q[0] <= lambda1)) {\n      var q1 = cartesianScale(u, (-w + t) / uu);\n      cartesianAddInPlace(q1, A);\n      return [q, spherical(q1)];\n    }\n  }\n\n  // Generates a 4-bit vector representing the location of a point relative to\n  // the small circle's bounding box.\n  function code(lambda, phi) {\n    var r = smallRadius ? radius : pi - radius,\n        code = 0;\n    if (lambda < -r) code |= 1; // left\n    else if (lambda > r) code |= 2; // right\n    if (phi < -r) code |= 4; // below\n    else if (phi > r) code |= 8; // above\n    return code;\n  }\n\n  return clip(visible, clipLine, interpolate, smallRadius ? [0, -radius] : [-pi, radius - pi]);\n}\n","export var abs = Math.abs;\nexport var atan = Math.atan;\nexport var atan2 = Math.atan2;\nexport var ceil = Math.ceil;\nexport var cos = Math.cos;\nexport var exp = Math.exp;\nexport var floor = Math.floor;\nexport var log = Math.log;\nexport var max = Math.max;\nexport var min = Math.min;\nexport var pow = Math.pow;\nexport var round = Math.round;\nexport var sign = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };\nexport var sin = Math.sin;\nexport var tan = Math.tan;\n\nexport var epsilon = 1e-6;\nexport var epsilon2 = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var quarterPi = pi / 4;\nexport var sqrt1_2 = Math.SQRT1_2;\nexport var sqrt2 = sqrt(2);\nexport var sqrtPi = sqrt(pi);\nexport var tau = pi * 2;\nexport var degrees = 180 / pi;\nexport var radians = pi / 180;\n\nexport function sinci(x) {\n  return x ? x / Math.sin(x) : 1;\n}\n\nexport function asin(x) {\n  return x > 1 ? halfPi : x < -1 ? -halfPi : Math.asin(x);\n}\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function sqrt(x) {\n  return x > 0 ? Math.sqrt(x) : 0;\n}\n\nexport function tanh(x) {\n  x = exp(2 * x);\n  return (x - 1) / (x + 1);\n}\n\nexport function sinh(x) {\n  return (exp(x) - exp(-x)) / 2;\n}\n\nexport function cosh(x) {\n  return (exp(x) + exp(-x)) / 2;\n}\n\nexport function arsinh(x) {\n  return log(x + sqrt(x * x + 1));\n}\n\nexport function arcosh(x) {\n  return log(x + sqrt(x * x - 1));\n}\n","import {geoProjection as projection} from \"d3-geo\";\nimport {abs, degrees, epsilon2, floor, halfPi, max, min, pi, radians} from \"./math.js\";\n\nvar K = [\n  [0.9986, -0.062],\n  [1.0000, 0.0000],\n  [0.9986, 0.0620],\n  [0.9954, 0.1240],\n  [0.9900, 0.1860],\n  [0.9822, 0.2480],\n  [0.9730, 0.3100],\n  [0.9600, 0.3720],\n  [0.9427, 0.4340],\n  [0.9216, 0.4958],\n  [0.8962, 0.5571],\n  [0.8679, 0.6176],\n  [0.8350, 0.6769],\n  [0.7986, 0.7346],\n  [0.7597, 0.7903],\n  [0.7186, 0.8435],\n  [0.6732, 0.8936],\n  [0.6213, 0.9394],\n  [0.5722, 0.9761],\n  [0.5322, 1.0000]\n];\n\nK.forEach(function(d) {\n  d[1] *= 1.0144;\n});\n\nexport function robinsonRaw(lambda, phi) {\n  var i = min(18, abs(phi) * 36 / pi),\n      i0 = floor(i),\n      di = i - i0,\n      ax = (k = K[i0])[0],\n      ay = k[1],\n      bx = (k = K[++i0])[0],\n      by = k[1],\n      cx = (k = K[min(19, ++i0)])[0],\n      cy = k[1],\n      k;\n  return [\n    lambda * (bx + di * (cx - ax) / 2 + di * di * (cx - 2 * bx + ax) / 2),\n    (phi > 0 ? halfPi : -halfPi) * (by + di * (cy - ay) / 2 + di * di * (cy - 2 * by + ay) / 2)\n  ];\n}\n\nrobinsonRaw.invert = function(x, y) {\n  var yy = y / halfPi,\n      phi = yy * 90,\n      i = min(18, abs(phi / 5)),\n      i0 = max(0, floor(i));\n  do {\n    var ay = K[i0][1],\n        by = K[i0 + 1][1],\n        cy = K[min(19, i0 + 2)][1],\n        u = cy - ay,\n        v = cy - 2 * by + ay,\n        t = 2 * (abs(yy) - by) / u,\n        c = v / u,\n        di = t * (1 - c * t * (1 - 2 * c * t));\n    if (di >= 0 || i0 === 1) {\n      phi = (y >= 0 ? 5 : -5) * (di + i);\n      var j = 50, delta;\n      do {\n        i = min(18, abs(phi) / 5);\n        i0 = floor(i);\n        di = i - i0;\n        ay = K[i0][1];\n        by = K[i0 + 1][1];\n        cy = K[min(19, i0 + 2)][1];\n        phi -= (delta = (y >= 0 ? halfPi : -halfPi) * (by + di * (cy - ay) / 2 + di * di * (cy - 2 * by + ay) / 2) - y) * degrees;\n      } while (abs(delta) > epsilon2 && --j > 0);\n      break;\n    }\n  } while (--i0 >= 0);\n  var ax = K[i0][0],\n      bx = K[i0 + 1][0],\n      cx = K[min(19, i0 + 2)][0];\n  return [\n    x / (bx + di * (cx - ax) / 2 + di * di * (cx - 2 * bx + ax) / 2),\n    phi * radians\n  ];\n};\n\nexport default function() {\n  return projection(robinsonRaw)\n      .scale(152.63);\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name;\n}\n","import namespace from \"./namespace\";\nimport {xhtml} from \"./namespaces\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index\";\nimport {EnterNode} from \"./enter\";\nimport constant from \"../constant\";\n\nvar keyPrefix = \"$\"; // Protect against keys like __proto__.\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = {},\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);\n      if (keyValue in nodeByKeyValue) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue[keyValue] = node;\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = keyPrefix + key.call(parent, data[i], i, data);\n    if (node = nodeByKeyValue[keyValue]) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue[keyValue] = null;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue[keyValues[i]] === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nexport default function(value, key) {\n  if (!value) {\n    data = new Array(this.size()), j = -1;\n    this.each(function(d) { data[++j] = d; });\n    return data;\n  }\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = value.call(parent, parent && parent.__data__, j, parents),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","import namespace from \"../namespace\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import creator from \"../creator\";\nimport selector from \"../selector\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  return this.parentNode.insertBefore(this.cloneNode(false), this.nextSibling);\n}\n\nfunction selection_cloneDeep() {\n  return this.parentNode.insertBefore(this.cloneNode(true), this.nextSibling);\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","var filterEvents = {};\n\nexport var event = null;\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!(\"onmouseenter\" in element)) {\n    filterEvents = {mouseenter: \"mouseover\", mouseleave: \"mouseout\"};\n  }\n}\n\nfunction filterContextListener(listener, index, group) {\n  listener = contextListener(listener, index, group);\n  return function(event) {\n    var related = event.relatedTarget;\n    if (!related || (related !== this && !(related.compareDocumentPosition(this) & 8))) {\n      listener.call(this, event);\n    }\n  };\n}\n\nfunction contextListener(listener, index, group) {\n  return function(event1) {\n    var event0 = event; // Events can be reentrant (e.g., focus).\n    event = event1;\n    try {\n      listener.call(this, this.__data__, index, group);\n    } finally {\n      event = event0;\n    }\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, capture) {\n  var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;\n  return function(d, i, group) {\n    var on = this.__on, o, listener = wrap(value, i, group);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n        this.addEventListener(o.type, o.listener = listener, o.capture = capture);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, capture);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, capture: capture};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, capture) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  if (capture == null) capture = false;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, capture));\n  return this;\n}\n\nexport function customEvent(event1, listener, that, args) {\n  var event0 = event;\n  event1.sourceEvent = event;\n  event = event1;\n  try {\n    return listener.apply(that, args);\n  } finally {\n    event = event0;\n  }\n}\n","import defaultView from \"../window\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select\";\nimport selection_selectAll from \"./selectAll\";\nimport selection_filter from \"./filter\";\nimport selection_data from \"./data\";\nimport selection_enter from \"./enter\";\nimport selection_exit from \"./exit\";\nimport selection_join from \"./join\";\nimport selection_merge from \"./merge\";\nimport selection_order from \"./order\";\nimport selection_sort from \"./sort\";\nimport selection_call from \"./call\";\nimport selection_nodes from \"./nodes\";\nimport selection_node from \"./node\";\nimport selection_size from \"./size\";\nimport selection_empty from \"./empty\";\nimport selection_each from \"./each\";\nimport selection_attr from \"./attr\";\nimport selection_style from \"./style\";\nimport selection_property from \"./property\";\nimport selection_classed from \"./classed\";\nimport selection_text from \"./text\";\nimport selection_html from \"./html\";\nimport selection_raise from \"./raise\";\nimport selection_lower from \"./lower\";\nimport selection_append from \"./append\";\nimport selection_insert from \"./insert\";\nimport selection_remove from \"./remove\";\nimport selection_clone from \"./clone\";\nimport selection_datum from \"./datum\";\nimport selection_on from \"./on\";\nimport selection_dispatch from \"./dispatch\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch\n};\n\nexport default selection;\n","import {Selection} from \"./index\";\nimport selector from \"../selector\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index\";\nimport selectorAll from \"../selectorAll\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index\";\nimport matcher from \"../matcher\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  enter = typeof onenter === \"function\" ? onenter(enter) : enter.append(onenter + \"\");\n  if (onupdate != null) update = onupdate(update);\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(selection) {\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  var nodes = new Array(this.size()), i = -1;\n  this.each(function() { nodes[++i] = this; });\n  return nodes;\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  var size = 0;\n  this.each(function() { ++size; });\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","var nextId = 0;\n\nexport default function local() {\n  return new Local;\n}\n\nfunction Local() {\n  this._ = \"@\" + (++nextId).toString(36);\n}\n\nLocal.prototype = local.prototype = {\n  constructor: Local,\n  get: function(node) {\n    var id = this._;\n    while (!(id in node)) if (!(node = node.parentNode)) return;\n    return node[id];\n  },\n  set: function(node, value) {\n    return node[this._] = value;\n  },\n  remove: function(node) {\n    return this._ in node && delete node[this._];\n  },\n  toString: function() {\n    return this._;\n  }\n};\n","import {event} from \"./selection/on\";\n\nexport default function() {\n  var current = event, source;\n  while (source = current.sourceEvent) current = source;\n  return current;\n}\n","export default function(node, event) {\n  var svg = node.ownerSVGElement || node;\n\n  if (svg.createSVGPoint) {\n    var point = svg.createSVGPoint();\n    point.x = event.clientX, point.y = event.clientY;\n    point = point.matrixTransform(node.getScreenCTM().inverse());\n    return [point.x, point.y];\n  }\n\n  var rect = node.getBoundingClientRect();\n  return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n}\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node) {\n  var event = sourceEvent();\n  if (event.changedTouches) event = event.changedTouches[0];\n  return point(node, event);\n}\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node, touches, identifier) {\n  if (arguments.length < 3) identifier = touches, touches = sourceEvent().changedTouches;\n\n  for (var i = 0, n = touches ? touches.length : 0, touch; i < n; ++i) {\n    if ((touch = touches[i]).identifier === identifier) {\n      return point(node, touch);\n    }\n  }\n\n  return null;\n}\n","var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","import {event} from \"d3-selection\";\n\nexport function nopropagation() {\n  event.stopImmediatePropagation();\n}\n\nexport default function() {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function DragEvent(target, type, subject, id, active, x, y, dx, dy, dispatch) {\n  this.target = target;\n  this.type = type;\n  this.subject = subject;\n  this.identifier = id;\n  this.active = active;\n  this.x = x;\n  this.y = y;\n  this.dx = dx;\n  this.dy = dy;\n  this._ = dispatch;\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {event, customEvent, select, mouse, touch} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag\";\nimport noevent, {nopropagation} from \"./noevent\";\nimport constant from \"./constant\";\nimport DragEvent from \"./event\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return \"ontouchstart\" in this;\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var gesture = beforestart(\"mouse\", container.apply(this, arguments), mouse, this, arguments);\n    if (!gesture) return;\n    select(event.view).on(\"mousemove.drag\", mousemoved, true).on(\"mouseup.drag\", mouseupped, true);\n    nodrag(event.view);\n    nopropagation();\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\");\n  }\n\n  function mousemoved() {\n    noevent();\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\");\n  }\n\n  function mouseupped() {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent();\n    gestures.mouse(\"end\");\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.changedTouches,\n        c = container.apply(this, arguments),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(touches[i].identifier, c, touch, this, arguments)) {\n        nopropagation();\n        gesture(\"start\");\n      }\n    }\n  }\n\n  function touchmoved() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent();\n        gesture(\"drag\");\n      }\n    }\n  }\n\n  function touchended() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation();\n        gesture(\"end\");\n      }\n    }\n  }\n\n  function beforestart(id, container, point, that, args) {\n    var p = point(container, id), s, dx, dy,\n        sublisteners = listeners.copy();\n\n    if (!customEvent(new DragEvent(drag, \"beforestart\", s, id, active, p[0], p[1], 0, 0, sublisteners), function() {\n      if ((event.subject = s = subject.apply(that, args)) == null) return false;\n      dx = s.x - p[0] || 0;\n      dy = s.y - p[1] || 0;\n      return true;\n    })) return;\n\n    return function gesture(type) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[id] = gesture, n = active++; break;\n        case \"end\": delete gestures[id], --active; // nobreak\n        case \"drag\": p = point(container, id), n = active; break;\n      }\n      customEvent(new DragEvent(drag, type, s, id, n, p[0] + dx, p[1] + dy, p[0] - p0[0], p[1] - p0[1], sublisteners), sublisteners.apply, sublisteners, [type, that, args]);\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","import {select} from \"d3-selection\";\nimport noevent from \"./noevent\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, true);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, true);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, true);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","var pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","export var epsilon = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var tau = 2 * pi;\n","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport {epsilon, pi, halfPi, tau} from \"./math\";\n\nfunction arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction arcEndAngle(d) {\n  return d.endAngle;\n}\n\nfunction arcPadAngle(d) {\n  return d && d.padAngle; // Note: optional!\n}\n\nfunction asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n\nfunction intersect(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var x10 = x1 - x0, y10 = y1 - y0,\n      x32 = x3 - x2, y32 = y3 - y2,\n      t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / (y32 * x10 - x32 * y10);\n  return [x0 + t * x10, y0 + t * y10];\n}\n\n// Compute perpendicular offset line of length rc.\n// http://mathworld.wolfram.com/Circle-LineIntersection.html\nfunction cornerTangents(x0, y0, x1, y1, r1, rc, cw) {\n  var x01 = x0 - x1,\n      y01 = y0 - y1,\n      lo = (cw ? rc : -rc) / Math.sqrt(x01 * x01 + y01 * y01),\n      ox = lo * y01,\n      oy = -lo * x01,\n      x11 = x0 + ox,\n      y11 = y0 + oy,\n      x10 = x1 + ox,\n      y10 = y1 + oy,\n      x00 = (x11 + x10) / 2,\n      y00 = (y11 + y10) / 2,\n      dx = x10 - x11,\n      dy = y10 - y11,\n      d2 = dx * dx + dy * dy,\n      r = r1 - rc,\n      D = x11 * y10 - x10 * y11,\n      d = (dy < 0 ? -1 : 1) * Math.sqrt(Math.max(0, r * r * d2 - D * D)),\n      cx0 = (D * dy - dx * d) / d2,\n      cy0 = (-D * dx - dy * d) / d2,\n      cx1 = (D * dy + dx * d) / d2,\n      cy1 = (-D * dx + dy * d) / d2,\n      dx0 = cx0 - x00,\n      dy0 = cy0 - y00,\n      dx1 = cx1 - x00,\n      dy1 = cy1 - y00;\n\n  // Pick the closer of the two intersection points.\n  // TODO Is there a faster way to determine which intersection to use?\n  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;\n\n  return {\n    cx: cx0,\n    cy: cy0,\n    x01: -ox,\n    y01: -oy,\n    x11: cx0 * (r1 / r - 1),\n    y11: cy0 * (r1 / r - 1)\n  };\n}\n\nexport default function() {\n  var innerRadius = arcInnerRadius,\n      outerRadius = arcOuterRadius,\n      cornerRadius = constant(0),\n      padRadius = null,\n      startAngle = arcStartAngle,\n      endAngle = arcEndAngle,\n      padAngle = arcPadAngle,\n      context = null;\n\n  function arc() {\n    var buffer,\n        r,\n        r0 = +innerRadius.apply(this, arguments),\n        r1 = +outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) - halfPi,\n        a1 = endAngle.apply(this, arguments) - halfPi,\n        da = Math.abs(a1 - a0),\n        cw = a1 > a0;\n\n    if (!context) context = buffer = path();\n\n    // Ensure that the outer radius is always larger than the inner radius.\n    if (r1 < r0) r = r1, r1 = r0, r0 = r;\n\n    // Is it a point?\n    if (!(r1 > epsilon)) context.moveTo(0, 0);\n\n    // Or is it a circle or annulus?\n    else if (da > tau - epsilon) {\n      context.moveTo(r1 * Math.cos(a0), r1 * Math.sin(a0));\n      context.arc(0, 0, r1, a0, a1, !cw);\n      if (r0 > epsilon) {\n        context.moveTo(r0 * Math.cos(a1), r0 * Math.sin(a1));\n        context.arc(0, 0, r0, a1, a0, cw);\n      }\n    }\n\n    // Or is it a circular or annular sector?\n    else {\n      var a01 = a0,\n          a11 = a1,\n          a00 = a0,\n          a10 = a1,\n          da0 = da,\n          da1 = da,\n          ap = padAngle.apply(this, arguments) / 2,\n          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : Math.sqrt(r0 * r0 + r1 * r1)),\n          rc = Math.min(Math.abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),\n          rc0 = rc,\n          rc1 = rc,\n          t0,\n          t1;\n\n      // Apply padding? Note that since r1  r0, da1  da0.\n      if (rp > epsilon) {\n        var p0 = asin(rp / r0 * Math.sin(ap)),\n            p1 = asin(rp / r1 * Math.sin(ap));\n        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;\n        else da0 = 0, a00 = a10 = (a0 + a1) / 2;\n        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;\n        else da1 = 0, a01 = a11 = (a0 + a1) / 2;\n      }\n\n      var x01 = r1 * Math.cos(a01),\n          y01 = r1 * Math.sin(a01),\n          x10 = r0 * Math.cos(a10),\n          y10 = r0 * Math.sin(a10);\n\n      // Apply rounded corners?\n      if (rc > epsilon) {\n        var x11 = r1 * Math.cos(a11),\n            y11 = r1 * Math.sin(a11),\n            x00 = r0 * Math.cos(a00),\n            y00 = r0 * Math.sin(a00);\n\n        // Restrict the corner radius according to the sector angle.\n        if (da < pi) {\n          var oc = da0 > epsilon ? intersect(x01, y01, x00, y00, x11, y11, x10, y10) : [x10, y10],\n              ax = x01 - oc[0],\n              ay = y01 - oc[1],\n              bx = x11 - oc[0],\n              by = y11 - oc[1],\n              kc = 1 / Math.sin(Math.acos((ax * bx + ay * by) / (Math.sqrt(ax * ax + ay * ay) * Math.sqrt(bx * bx + by * by))) / 2),\n              lc = Math.sqrt(oc[0] * oc[0] + oc[1] * oc[1]);\n          rc0 = Math.min(rc, (r0 - lc) / (kc - 1));\n          rc1 = Math.min(rc, (r1 - lc) / (kc + 1));\n        }\n      }\n\n      // Is the sector collapsed to a line?\n      if (!(da1 > epsilon)) context.moveTo(x01, y01);\n\n      // Does the sectors outer ring have rounded corners?\n      else if (rc1 > epsilon) {\n        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);\n        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);\n\n        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, Math.atan2(t0.y01, t0.x01), Math.atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc1, Math.atan2(t0.y01, t0.x01), Math.atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r1, Math.atan2(t0.cy + t0.y11, t0.cx + t0.x11), Math.atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(t1.cx, t1.cy, rc1, Math.atan2(t1.y11, t1.x11), Math.atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the outer ring just a circular arc?\n      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);\n\n      // Is there no inner ring, and its a circular sector?\n      // Or perhaps its an annular sector collapsed due to padding?\n      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);\n\n      // Does the sectors inner ring (or point) have rounded corners?\n      else if (rc0 > epsilon) {\n        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);\n        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);\n\n        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, Math.atan2(t0.y01, t0.x01), Math.atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc0, Math.atan2(t0.y01, t0.x01), Math.atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r0, Math.atan2(t0.cy + t0.y11, t0.cx + t0.x11), Math.atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(t1.cx, t1.cy, rc0, Math.atan2(t1.y11, t1.x11), Math.atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the inner ring just a circular arc?\n      else context.arc(0, 0, r0, a10, a00, cw);\n    }\n\n    context.closePath();\n\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  arc.centroid = function() {\n    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,\n        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;\n    return [Math.cos(a) * r, Math.sin(a) * r];\n  };\n\n  arc.innerRadius = function(_) {\n    return arguments.length ? (innerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : innerRadius;\n  };\n\n  arc.outerRadius = function(_) {\n    return arguments.length ? (outerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : outerRadius;\n  };\n\n  arc.cornerRadius = function(_) {\n    return arguments.length ? (cornerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : cornerRadius;\n  };\n\n  arc.padRadius = function(_) {\n    return arguments.length ? (padRadius = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), arc) : padRadius;\n  };\n\n  arc.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : startAngle;\n  };\n\n  arc.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : endAngle;\n  };\n\n  arc.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : padAngle;\n  };\n\n  arc.context = function(_) {\n    return arguments.length ? ((context = _ == null ? null : _), arc) : context;\n  };\n\n  return arc;\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import curveLinear from \"./linear\";\n\nexport var curveRadialLinear = curveRadial(curveLinear);\n\nfunction Radial(curve) {\n  this._curve = curve;\n}\n\nRadial.prototype = {\n  areaStart: function() {\n    this._curve.areaStart();\n  },\n  areaEnd: function() {\n    this._curve.areaEnd();\n  },\n  lineStart: function() {\n    this._curve.lineStart();\n  },\n  lineEnd: function() {\n    this._curve.lineEnd();\n  },\n  point: function(a, r) {\n    this._curve.point(r * Math.sin(a), r * -Math.cos(a));\n  }\n};\n\nexport default function curveRadial(curve) {\n\n  function radial(context) {\n    return new Radial(curve(context));\n  }\n\n  radial._curve = curve;\n\n  return radial;\n}\n","var tan30 = Math.sqrt(1 / 3),\n    tan30_2 = tan30 * 2;\n\nexport default {\n  draw: function(context, size) {\n    var y = Math.sqrt(size / tan30_2),\n        x = y * tan30;\n    context.moveTo(0, -y);\n    context.lineTo(x, 0);\n    context.lineTo(0, y);\n    context.lineTo(-x, 0);\n    context.closePath();\n  }\n};\n","import {pi, tau} from \"../math\";\n\nvar ka = 0.89081309152928522810,\n    kr = Math.sin(pi / 10) / Math.sin(7 * pi / 10),\n    kx = Math.sin(tau / 10) * kr,\n    ky = -Math.cos(tau / 10) * kr;\n\nexport default {\n  draw: function(context, size) {\n    var r = Math.sqrt(size * ka),\n        x = kx * r,\n        y = ky * r;\n    context.moveTo(0, -r);\n    context.lineTo(x, y);\n    for (var i = 1; i < 5; ++i) {\n      var a = tau * i / 5,\n          c = Math.cos(a),\n          s = Math.sin(a);\n      context.lineTo(s * r, -c * r);\n      context.lineTo(c * x - s * y, s * x + c * y);\n    }\n    context.closePath();\n  }\n};\n","var sqrt3 = Math.sqrt(3);\n\nexport default {\n  draw: function(context, size) {\n    var y = -Math.sqrt(size / (sqrt3 * 3));\n    context.moveTo(0, y * 2);\n    context.lineTo(-sqrt3 * y, -y);\n    context.lineTo(sqrt3 * y, -y);\n    context.closePath();\n  }\n};\n","var c = -0.5,\n    s = Math.sqrt(3) / 2,\n    k = 1 / Math.sqrt(12),\n    a = (k / 2 + 1) * 3;\n\nexport default {\n  draw: function(context, size) {\n    var r = Math.sqrt(size / a),\n        x0 = r / 2,\n        y0 = r * k,\n        x1 = x0,\n        y1 = r * k + r,\n        x2 = -x1,\n        y2 = y1;\n    context.moveTo(x0, y0);\n    context.lineTo(x1, y1);\n    context.lineTo(x2, y2);\n    context.lineTo(c * x0 - s * y0, s * x0 + c * y0);\n    context.lineTo(c * x1 - s * y1, s * x1 + c * y1);\n    context.lineTo(c * x2 - s * y2, s * x2 + c * y2);\n    context.lineTo(c * x0 + s * y0, c * y0 - s * x0);\n    context.lineTo(c * x1 + s * y1, c * y1 - s * x1);\n    context.lineTo(c * x2 + s * y2, c * y2 - s * x2);\n    context.closePath();\n  }\n};\n","export default function() {}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // proceed\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","import noop from \"../noop\";\nimport {point} from \"./basis\";\n\nfunction BasisClosed(context) {\n  this._context = context;\n}\n\nBasisClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x2, this._y2);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3);\n        this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x2, this._y2);\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x2 = x, this._y2 = y; break;\n      case 1: this._point = 2; this._x3 = x, this._y3 = y; break;\n      case 2: this._point = 3; this._x4 = x, this._y4 = y; this._context.moveTo((this._x0 + 4 * this._x1 + x) / 6, (this._y0 + 4 * this._y1 + y) / 6); break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisClosed(context);\n}\n","import {point} from \"./basis\";\n\nfunction BasisOpen(context) {\n  this._context = context;\n}\n\nBasisOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; var x0 = (this._x0 + 4 * this._x1 + x) / 6, y0 = (this._y0 + 4 * this._y1 + y) / 6; this._line ? this._context.lineTo(x0, y0) : this._context.moveTo(x0, y0); break;\n      case 3: this._point = 4; // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisOpen(context);\n}\n","import {Basis} from \"./basis\";\n\nfunction Bundle(context, beta) {\n  this._basis = new Basis(context);\n  this._beta = beta;\n}\n\nBundle.prototype = {\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n    this._basis.lineStart();\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        j = x.length - 1;\n\n    if (j > 0) {\n      var x0 = x[0],\n          y0 = y[0],\n          dx = x[j] - x0,\n          dy = y[j] - y0,\n          i = -1,\n          t;\n\n      while (++i <= j) {\n        t = i / j;\n        this._basis.point(\n          this._beta * x[i] + (1 - this._beta) * (x0 + t * dx),\n          this._beta * y[i] + (1 - this._beta) * (y0 + t * dy)\n        );\n      }\n    }\n\n    this._x = this._y = null;\n    this._basis.lineEnd();\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\nexport default (function custom(beta) {\n\n  function bundle(context) {\n    return beta === 1 ? new Basis(context) : new Bundle(context, beta);\n  }\n\n  bundle.beta = function(beta) {\n    return custom(+beta);\n  };\n\n  return bundle;\n})(0.85);\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import noop from \"../noop\";\nimport {point} from \"./cardinal\";\n\nexport function CardinalClosed(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalClosed(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {point} from \"./cardinal\";\n\nexport function CardinalOpen(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalOpen(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {epsilon} from \"../math\";\nimport {Cardinal} from \"./cardinal\";\n\nexport function point(that, x, y) {\n  var x1 = that._x1,\n      y1 = that._y1,\n      x2 = that._x2,\n      y2 = that._y2;\n\n  if (that._l01_a > epsilon) {\n    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,\n        n = 3 * that._l01_a * (that._l01_a + that._l12_a);\n    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;\n    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;\n  }\n\n  if (that._l23_a > epsilon) {\n    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,\n        m = 3 * that._l23_a * (that._l23_a + that._l12_a);\n    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;\n    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;\n  }\n\n  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);\n}\n\nfunction CatmullRom(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRom.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: this.point(this._x2, this._y2); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalClosed} from \"./cardinalClosed\";\nimport noop from \"../noop\";\nimport {point} from \"./catmullRom\";\n\nfunction CatmullRomClosed(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomClosed(context, alpha) : new CardinalClosed(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalOpen} from \"./cardinalOpen\";\nimport {point} from \"./catmullRom\";\n\nfunction CatmullRomOpen(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // proceed\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomOpen(context, alpha) : new CardinalOpen(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import noop from \"../noop\";\n\nfunction LinearClosed(context) {\n  this._context = context;\n}\n\nLinearClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._point) this._context.closePath();\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    if (this._point) this._context.lineTo(x, y);\n    else this._point = 1, this._context.moveTo(x, y);\n  }\n};\n\nexport default function(context) {\n  return new LinearClosed(context);\n}\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic Bzier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","function Natural(context) {\n  this._context = context;\n}\n\nNatural.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        n = x.length;\n\n    if (n) {\n      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);\n      if (n === 2) {\n        this._context.lineTo(x[1], y[1]);\n      } else {\n        var px = controlPoints(x),\n            py = controlPoints(y);\n        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {\n          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);\n        }\n      }\n    }\n\n    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n    this._x = this._y = null;\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\n// See https://www.particleincell.com/2012/bezier-splines/ for derivation.\nfunction controlPoints(x) {\n  var i,\n      n = x.length - 1,\n      m,\n      a = new Array(n),\n      b = new Array(n),\n      r = new Array(n);\n  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];\n  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];\n  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];\n  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];\n  a[n - 1] = r[n - 1] / b[n - 1];\n  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];\n  b[n - 1] = (x[n] + a[n - 1]) / 2;\n  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];\n  return [a, b];\n}\n\nexport default function(context) {\n  return new Natural(context);\n}\n","function Step(context, t) {\n  this._context = context;\n  this._t = t;\n}\n\nStep.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = this._y = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: {\n        if (this._t <= 0) {\n          this._context.lineTo(this._x, y);\n          this._context.lineTo(x, y);\n        } else {\n          var x1 = this._x * (1 - this._t) + x * this._t;\n          this._context.lineTo(x1, this._y);\n          this._context.lineTo(x1, y);\n        }\n        break;\n      }\n    }\n    this._x = x, this._y = y;\n  }\n};\n\nexport default function(context) {\n  return new Step(context, 0.5);\n}\n\nexport function stepBefore(context) {\n  return new Step(context, 0);\n}\n\nexport function stepAfter(context) {\n  return new Step(context, 1);\n}\n","export var slice = Array.prototype.slice;\n","import { event, select } from 'd3-selection';\nimport { drag } from 'd3-drag';\nimport { arc, curveCatmullRom, curveLinear, line } from 'd3-shape';\nimport { dispatch } from 'd3-dispatch';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nvar Annotation = function () {\n  function Annotation(_ref) {\n    var _ref$x = _ref.x,\n        x = _ref$x === undefined ? 0 : _ref$x,\n        _ref$y = _ref.y,\n        y = _ref$y === undefined ? 0 : _ref$y,\n        nx = _ref.nx,\n        ny = _ref.ny,\n        _ref$dy = _ref.dy,\n        dy = _ref$dy === undefined ? 0 : _ref$dy,\n        _ref$dx = _ref.dx,\n        dx = _ref$dx === undefined ? 0 : _ref$dx,\n        _ref$color = _ref.color,\n        color = _ref$color === undefined ? \"grey\" : _ref$color,\n        data = _ref.data,\n        type = _ref.type,\n        subject = _ref.subject,\n        connector = _ref.connector,\n        note = _ref.note,\n        disable = _ref.disable,\n        id = _ref.id,\n        className = _ref.className;\n    classCallCheck(this, Annotation);\n\n    this._dx = nx !== undefined ? nx - x : dx;\n    this._dy = ny !== undefined ? ny - y : dy;\n    this._x = x;\n    this._y = y;\n    this._color = color;\n    this.id = id;\n    this._className = className || \"\";\n\n    this._type = type || \"\";\n    this.data = data;\n\n    this.note = note || {};\n    this.connector = connector || {};\n    this.subject = subject || {};\n\n    this.disable = disable || [];\n  }\n\n  createClass(Annotation, [{\n    key: \"updatePosition\",\n    value: function updatePosition() {\n      if (this.type.setPosition) {\n        this.type.setPosition();\n        if (this.type.subject && this.type.subject.selectAll(\":not(.handle)\").nodes().length !== 0) {\n          this.type.redrawSubject();\n        }\n      }\n    }\n  }, {\n    key: \"clearComponents\",\n    value: function clearComponents() {\n      this.type.clearComponents && this.type.clearComponents();\n    }\n  }, {\n    key: \"updateOffset\",\n    value: function updateOffset() {\n      if (this.type.setOffset) {\n        this.type.setOffset();\n\n        if (this.type.connector.selectAll(\":not(.handle)\").nodes().length !== 0) {\n          this.type.redrawConnector();\n        }\n\n        this.type.redrawNote();\n      }\n    }\n  }, {\n    key: \"className\",\n    get: function get$$1() {\n      return this._className;\n    },\n    set: function set$$1(className) {\n      this._className = className;\n      if (this.type.setClassName) this.type.setClassName();\n    }\n  }, {\n    key: \"type\",\n    get: function get$$1() {\n      return this._type;\n    },\n    set: function set$$1(type) {\n      this._type = type;\n      this.clearComponents();\n    }\n  }, {\n    key: \"x\",\n    get: function get$$1() {\n      return this._x;\n    },\n    set: function set$$1(x) {\n      this._x = x;\n      this.updatePosition();\n    }\n  }, {\n    key: \"y\",\n    get: function get$$1() {\n      return this._y;\n    },\n    set: function set$$1(y) {\n      this._y = y;\n      this.updatePosition();\n    }\n  }, {\n    key: \"color\",\n    get: function get$$1() {\n      return this._color;\n    },\n    set: function set$$1(color) {\n      this._color = color;\n      this.updatePosition();\n    }\n  }, {\n    key: \"dx\",\n    get: function get$$1() {\n      return this._dx;\n    },\n    set: function set$$1(dx) {\n      this._dx = dx;\n      this.updateOffset();\n    }\n  }, {\n    key: \"dy\",\n    get: function get$$1() {\n      return this._dy;\n    },\n    set: function set$$1(dy) {\n      this._dy = dy;\n      this.updateOffset();\n    }\n  }, {\n    key: \"nx\",\n    set: function set$$1(nx) {\n      this._dx = nx - this._x;\n      this.updateOffset();\n    }\n  }, {\n    key: \"ny\",\n    set: function set$$1(ny) {\n      this._dy = ny - this._y;\n      this.updateOffset();\n    }\n  }, {\n    key: \"offset\",\n    get: function get$$1() {\n      return { x: this._dx, y: this._dy };\n    },\n    set: function set$$1(_ref2) {\n      var x = _ref2.x,\n          y = _ref2.y;\n\n      this._dx = x;\n      this._dy = y;\n      this.updateOffset();\n    }\n  }, {\n    key: \"position\",\n    get: function get$$1() {\n      return { x: this._x, y: this._y };\n    },\n    set: function set$$1(_ref3) {\n      var x = _ref3.x,\n          y = _ref3.y;\n\n      this._x = x;\n      this._y = y;\n      this.updatePosition();\n    }\n  }, {\n    key: \"translation\",\n    get: function get$$1() {\n      return {\n        x: this._x + this._dx,\n        y: this._y + this._dy\n      };\n    }\n  }, {\n    key: \"json\",\n    get: function get$$1() {\n      var json = {\n        x: this._x,\n        y: this._y,\n        dx: this._dx,\n        dy: this._dy\n      };\n\n      if (this.data && Object.keys(this.data).length > 0) json.data = this.data;\n      if (this.type) json.type = this.type;\n      if (this._className) json.className = this._className;\n\n      if (Object.keys(this.connector).length > 0) json.connector = this.connector;\n      if (Object.keys(this.subject).length > 0) json.subject = this.subject;\n      if (Object.keys(this.note).length > 0) json.note = this.note;\n\n      return json;\n    }\n  }]);\n  return Annotation;\n}();\n\nvar AnnotationCollection = function () {\n  function AnnotationCollection(_ref) {\n    var annotations = _ref.annotations,\n        accessors = _ref.accessors,\n        accessorsInverse = _ref.accessorsInverse;\n    classCallCheck(this, AnnotationCollection);\n\n    this.accessors = accessors;\n    this.accessorsInverse = accessorsInverse;\n    this.annotations = annotations;\n  }\n\n  createClass(AnnotationCollection, [{\n    key: \"clearTypes\",\n    value: function clearTypes(newSettings) {\n      this.annotations.forEach(function (d) {\n        d.type = undefined;\n        d.subject = newSettings && newSettings.subject || d.subject;\n        d.connector = newSettings && newSettings.connector || d.connector;\n        d.note = newSettings && newSettings.note || d.note;\n      });\n    }\n  }, {\n    key: \"setPositionWithAccessors\",\n    value: function setPositionWithAccessors() {\n      var _this = this;\n\n      this.annotations.forEach(function (d) {\n        d.type.setPositionWithAccessors(_this.accessors);\n      });\n    }\n  }, {\n    key: \"editMode\",\n    value: function editMode(_editMode) {\n      this.annotations.forEach(function (a) {\n        if (a.type) {\n          a.type.editMode = _editMode;\n          a.type.updateEditMode();\n        }\n      });\n    }\n  }, {\n    key: \"updateDisable\",\n    value: function updateDisable(disable) {\n      this.annotations.forEach(function (a) {\n        a.disable = disable;\n        if (a.type) {\n          disable.forEach(function (d) {\n            if (a.type[d]) {\n              a.type[d].remove && a.type[d].remove();\n              a.type[d] = undefined;\n            }\n          });\n        }\n      });\n    }\n  }, {\n    key: \"updateTextWrap\",\n    value: function updateTextWrap(textWrap) {\n      this.annotations.forEach(function (a) {\n        if (a.type && a.type.updateTextWrap) {\n          a.type.updateTextWrap(textWrap);\n        }\n      });\n    }\n  }, {\n    key: \"updateText\",\n    value: function updateText() {\n      this.annotations.forEach(function (a) {\n        if (a.type && a.type.drawText) {\n          a.type.drawText();\n        }\n      });\n    }\n  }, {\n    key: \"updateNotePadding\",\n    value: function updateNotePadding(notePadding) {\n      this.annotations.forEach(function (a) {\n        if (a.type) {\n          a.type.notePadding = notePadding;\n        }\n      });\n    }\n  }, {\n    key: \"json\",\n    get: function get$$1() {\n      var _this2 = this;\n\n      return this.annotations.map(function (a) {\n        var json = a.json;\n        if (_this2.accessorsInverse && a.data) {\n          json.data = {};\n          Object.keys(_this2.accessorsInverse).forEach(function (k) {\n            json.data[k] = _this2.accessorsInverse[k]({ x: a.x, y: a.y });\n\n            //TODO make this feasible to map back to data for other types of subjects\n          });\n        }\n        return json;\n      });\n    }\n  }, {\n    key: \"noteNodes\",\n    get: function get$$1() {\n      return this.annotations.map(function (a) {\n        return _extends({}, a.type.getNoteBBoxOffset(), { positionX: a.x, positionY: a.y });\n      });\n    }\n\n    //TODO: come back and rethink if a.x and a.y are applicable in all situations\n    // get connectorNodes() {\n    //   return this.annotations.map(a => ({ ...a.type.getConnectorBBox(), startX: a.x, startY: a.y}))\n    // }\n\n    // get subjectNodes() {\n    //   return this.annotations.map(a => ({ ...a.type.getSubjectBBox(), startX: a.x, startY: a.y}))\n    // }\n\n    // get annotationNodes() {\n    //   return this.annotations.map(a => ({ ...a.type.getAnnotationBBox(), startX: a.x, startY: a.y}))\n    // }\n\n  }]);\n  return AnnotationCollection;\n}();\n\nvar pointHandle = function pointHandle(_ref) {\n  var _ref$cx = _ref.cx,\n      cx = _ref$cx === undefined ? 0 : _ref$cx,\n      _ref$cy = _ref.cy,\n      cy = _ref$cy === undefined ? 0 : _ref$cy;\n\n  return { move: { x: cx, y: cy } };\n};\n\nvar circleHandles = function circleHandles(_ref2) {\n  var _ref2$cx = _ref2.cx,\n      cx = _ref2$cx === undefined ? 0 : _ref2$cx,\n      _ref2$cy = _ref2.cy,\n      cy = _ref2$cy === undefined ? 0 : _ref2$cy,\n      r1 = _ref2.r1,\n      r2 = _ref2.r2,\n      padding = _ref2.padding;\n\n  var h = { move: { x: cx, y: cy } };\n\n  if (r1 !== undefined) {\n    h.r1 = { x: cx + r1 / Math.sqrt(2), y: cy + r1 / Math.sqrt(2) };\n  }\n\n  if (r2 !== undefined) {\n    h.r2 = { x: cx + r2 / Math.sqrt(2), y: cy + r2 / Math.sqrt(2) };\n  }\n\n  if (padding !== undefined) {\n    h.padding = { x: cx + r1 + padding, y: cy };\n  }\n\n  return h;\n};\n\n\n\n\n\n//arc handles\nvar addHandles = function addHandles(_ref5) {\n  var group = _ref5.group,\n      handles = _ref5.handles,\n      _ref5$r = _ref5.r,\n      r = _ref5$r === undefined ? 10 : _ref5$r;\n\n  //give it a group and x,y to draw handles\n  //then give it instructions on what the handles change\n  var h = group.selectAll(\"circle.handle\").data(handles);\n\n  h.enter().append(\"circle\").attr(\"class\", \"handle\").attr(\"fill\", \"grey\").attr(\"fill-opacity\", 0.1).attr(\"cursor\", \"move\").attr(\"stroke-dasharray\", 5).attr(\"stroke\", \"grey\").call(drag().container(select(\"g.annotations\").node()).on(\"start\", function (d) {\n    return d.start && d.start(d);\n  }).on(\"drag\", function (d) {\n    return d.drag && d.drag(d);\n  }).on(\"end\", function (d) {\n    return d.end && d.end(d);\n  }));\n\n  group.selectAll(\"circle.handle\").attr(\"cx\", function (d) {\n    return d.x;\n  }).attr(\"cy\", function (d) {\n    return d.y;\n  }).attr(\"r\", function (d) {\n    return d.r || r;\n  }).attr(\"class\", function (d) {\n    return \"handle \" + (d.className || \"\");\n  });\n\n  h.exit().remove();\n};\n\nvar leftRightDynamic = function leftRightDynamic(align, y) {\n  if (align === \"dynamic\" || align === \"left\" || align === \"right\") {\n    if (y < 0) {\n      align = \"top\";\n    } else {\n      align = \"bottom\";\n    }\n  }\n  return align;\n};\n\nvar topBottomDynamic = function topBottomDynamic(align, x) {\n  if (align === \"dynamic\" || align === \"top\" || align === \"bottom\") {\n    if (x < 0) {\n      align = \"right\";\n    } else {\n      align = \"left\";\n    }\n  }\n  return align;\n};\n\nvar orientationTopBottom = [\"topBottom\", \"top\", \"bottom\"];\nvar orientationLeftRight = [\"leftRight\", \"left\", \"right\"];\n\nvar noteAlignment = (function (_ref) {\n  var _ref$padding = _ref.padding,\n      padding = _ref$padding === undefined ? 0 : _ref$padding,\n      _ref$bbox = _ref.bbox,\n      bbox = _ref$bbox === undefined ? { x: 0, y: 0, width: 0, height: 0 } : _ref$bbox,\n      align = _ref.align,\n      orientation = _ref.orientation,\n      _ref$offset = _ref.offset,\n      offset = _ref$offset === undefined ? { x: 0, y: 0 } : _ref$offset;\n\n  var x = -bbox.x;\n  var y = 0; //-bbox.y\n  if (orientationTopBottom.indexOf(orientation) !== -1) {\n    align = topBottomDynamic(align, offset.x);\n    if (offset.y < 0 && orientation === \"topBottom\" || orientation === \"top\") {\n      y -= bbox.height + padding;\n    } else {\n      y += padding;\n    }\n\n    if (align === \"middle\") {\n      x -= bbox.width / 2;\n    } else if (align === \"right\") {\n      x -= bbox.width;\n    }\n  } else if (orientationLeftRight.indexOf(orientation) !== -1) {\n    align = leftRightDynamic(align, offset.y);\n    if (offset.x < 0 && orientation === \"leftRight\" || orientation === \"left\") {\n      x -= bbox.width + padding;\n    } else {\n      x += padding;\n    }\n\n    if (align === \"middle\") {\n      y -= bbox.height / 2;\n    } else if (align === \"top\") {\n      y -= bbox.height;\n    }\n  }\n\n  return { x: x, y: y };\n});\n\nvar lineBuilder = function lineBuilder(_ref) {\n  var data = _ref.data,\n      _ref$curve = _ref.curve,\n      curve = _ref$curve === undefined ? curveLinear : _ref$curve,\n      canvasContext = _ref.canvasContext,\n      className = _ref.className,\n      classID = _ref.classID;\n\n  var lineGen = line().curve(curve);\n\n  var builder = {\n    type: 'path',\n    className: className,\n    classID: classID,\n    data: data\n  };\n\n  if (canvasContext) {\n    lineGen.context(canvasContext);\n    builder.pathMethods = lineGen;\n  } else {\n    builder.attrs = {\n      d: lineGen(data)\n    };\n  }\n\n  return builder;\n};\n\nvar arcBuilder = function arcBuilder(_ref2) {\n  var data = _ref2.data,\n      canvasContext = _ref2.canvasContext,\n      className = _ref2.className,\n      classID = _ref2.classID;\n\n\n  var builder = {\n    type: 'path',\n    className: className,\n    classID: classID,\n    data: data\n  };\n\n  var arcShape = arc().innerRadius(data.innerRadius || 0).outerRadius(data.outerRadius || data.radius || 2).startAngle(data.startAngle || 0).endAngle(data.endAngle || 2 * Math.PI);\n\n  if (canvasContext) {\n    arcShape.context(canvasContext);\n    builder.pathMethods = lineGen;\n  } else {\n\n    builder.attrs = {\n      d: arcShape()\n    };\n  }\n\n  return builder;\n};\n\nvar noteVertical = (function (_ref) {\n  var align = _ref.align,\n      _ref$x = _ref.x,\n      x = _ref$x === undefined ? 0 : _ref$x,\n      _ref$y = _ref.y,\n      y = _ref$y === undefined ? 0 : _ref$y,\n      bbox = _ref.bbox,\n      offset = _ref.offset;\n\n  align = leftRightDynamic(align, offset.y);\n\n  if (align === \"top\") {\n    y -= bbox.height;\n  } else if (align === \"middle\") {\n    y -= bbox.height / 2;\n  }\n\n  var data = [[x, y], [x, y + bbox.height]];\n  return { components: [lineBuilder({ data: data, className: \"note-line\" })] };\n});\n\nvar noteHorizontal = (function (_ref) {\n  var align = _ref.align,\n      _ref$x = _ref.x,\n      x = _ref$x === undefined ? 0 : _ref$x,\n      _ref$y = _ref.y,\n      y = _ref$y === undefined ? 0 : _ref$y,\n      offset = _ref.offset,\n      bbox = _ref.bbox;\n\n  align = topBottomDynamic(align, offset.x);\n\n  if (align === \"right\") {\n    x -= bbox.width;\n  } else if (align === \"middle\") {\n    x -= bbox.width / 2;\n  }\n\n  var data = [[x, y], [x + bbox.width, y]];\n  return { components: [lineBuilder({ data: data, className: \"note-line\" })] };\n});\n\nvar lineSetup = function lineSetup(_ref) {\n  var type = _ref.type,\n      subjectType = _ref.subjectType;\n\n  var annotation = type.annotation;\n  var offset = annotation.position;\n\n  var x1 = annotation.x - offset.x,\n      x2 = x1 + annotation.dx,\n      y1 = annotation.y - offset.y,\n      y2 = y1 + annotation.dy;\n\n  var subjectData = annotation.subject;\n\n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\n    var h = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n    var angle = Math.asin(-y2 / h);\n    var r = subjectData.outerRadius || subjectData.radius + (subjectData.radiusPadding || 0);\n\n    x1 = Math.abs(Math.cos(angle) * r) * (x2 < 0 ? -1 : 1);\n    y1 = Math.abs(Math.sin(angle) * r) * (y2 < 0 ? -1 : 1);\n  }\n\n  if (subjectType === \"rect\") {\n    var width = subjectData.width,\n        height = subjectData.height;\n\n\n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width / 2;else x1 = width;\n    }\n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height / 2;else y1 = height;\n    }\n    if (x1 === width / 2 && y1 === height / 2) {\n      x1 = x2;y1 = y2;\n    }\n  }\n\n  return [[x1, y1], [x2, y2]];\n};\n\nvar connectorLine = (function (connectorData) {\n  var data = lineSetup(connectorData);\n  return { components: [lineBuilder({ data: data, className: \"connector\" })] };\n});\n\nvar connectorElbow = (function (_ref) {\n  var type = _ref.type,\n      subjectType = _ref.subjectType;\n\n\n  var annotation = type.annotation;\n  var offset = annotation.position;\n\n  var x1 = annotation.x - offset.x,\n      x2 = x1 + annotation.dx,\n      y1 = annotation.y - offset.y,\n      y2 = y1 + annotation.dy;\n\n  var subjectData = annotation.subject;\n\n  if (subjectType === \"rect\") {\n    var width = subjectData.width,\n        height = subjectData.height;\n\n\n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width / 2;else x1 = width;\n    }\n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height / 2;else y1 = height;\n    }\n    if (x1 === width / 2 && y1 === height / 2) {\n      x1 = x2;y1 = y2;\n    }\n  }\n\n  var data = [[x1, y1], [x2, y2]];\n\n  var diffY = y2 - y1;\n  var diffX = x2 - x1;\n  var xe = x2;\n  var ye = y2;\n  var opposite = y2 < y1 && x2 > x1 || x2 < x1 && y2 > y1 ? -1 : 1;\n\n  if (Math.abs(diffX) < Math.abs(diffY)) {\n    xe = x2;\n    ye = y1 + diffX * opposite;\n  } else {\n    ye = y2;\n    xe = x1 + diffY * opposite;\n  }\n\n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\n    var r = (subjectData.outerRadius || subjectData.radius) + (subjectData.radiusPadding || 0);\n    var length = r / Math.sqrt(2);\n\n    if (Math.abs(diffX) > length && Math.abs(diffY) > length) {\n      x1 = length * (x2 < 0 ? -1 : 1);\n      y1 = length * (y2 < 0 ? -1 : 1);\n      data = [[x1, y1], [xe, ye], [x2, y2]];\n    } else if (Math.abs(diffX) > Math.abs(diffY)) {\n      var angle = Math.asin(-y2 / r);\n      x1 = Math.abs(Math.cos(angle) * r) * (x2 < 0 ? -1 : 1);\n      data = [[x1, y2], [x2, y2]];\n    } else {\n      var _angle = Math.acos(x2 / r);\n      y1 = Math.abs(Math.sin(_angle) * r) * (y2 < 0 ? -1 : 1);\n      data = [[x2, y1], [x2, y2]];\n    }\n  } else {\n    data = [[x1, y1], [xe, ye], [x2, y2]];\n  }\n\n  return { components: [lineBuilder({ data: data, className: \"connector\" })] };\n});\n\nvar connectorCurve = (function (_ref) {\n  var type = _ref.type,\n      connectorData = _ref.connectorData,\n      subjectType = _ref.subjectType;\n\n\n  if (!connectorData) {\n    connectorData = {};\n  }\n  if (!connectorData.points || typeof connectorData.points === \"number\") {\n    connectorData.points = createPoints(type.annotation.offset, connectorData.points);\n  }\n  if (!connectorData.curve) {\n    connectorData.curve = curveCatmullRom;\n  }\n\n  var handles = [];\n\n  if (type.editMode) {\n    var cHandles = connectorData.points.map(function (c, i) {\n      return _extends({}, pointHandle({ cx: c[0], cy: c[1] }), { index: i });\n    });\n\n    var updatePoint = function updatePoint(index) {\n      connectorData.points[index][0] += event.dx;\n      connectorData.points[index][1] += event.dy;\n      type.redrawConnector();\n    };\n\n    handles = type.mapHandles(cHandles.map(function (h) {\n      return _extends({}, h.move, { drag: updatePoint.bind(type, h.index) });\n    }));\n  }\n\n  var data = lineSetup({ type: type, subjectType: subjectType });\n  data = [data[0]].concat(toConsumableArray(connectorData.points), [data[1]]);\n  var components = [lineBuilder({ data: data, curve: connectorData.curve, className: \"connector\" })];\n\n  return { components: components, handles: handles };\n});\n\nvar createPoints = function createPoints(offset) {\n  var anchors = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;\n\n  var diff = { x: offset.x / (anchors + 1), y: offset.y / (anchors + 1) };\n  var p = [];\n\n  var i = 1;\n  for (; i <= anchors; i++) {\n    p.push([diff.x * i + i % 2 * 20, diff.y * i - i % 2 * 20]);\n  }\n  return p;\n};\n\nvar connectorArrow = (function (_ref) {\n  var annotation = _ref.annotation,\n      start = _ref.start,\n      end = _ref.end,\n      _ref$scale = _ref.scale,\n      scale = _ref$scale === undefined ? 1 : _ref$scale;\n\n  var offset = annotation.position;\n  if (!start) {\n    start = [annotation.dx, annotation.dy];\n  } else {\n    start = [-end[0] + start[0], -end[1] + start[1]];\n  }\n  if (!end) {\n    end = [annotation.x - offset.x, annotation.y - offset.y];\n  }\n\n  var x1 = end[0],\n      y1 = end[1];\n\n  var dx = start[0];\n  var dy = start[1];\n\n  var size = 10 * scale;\n  var angleOffset = 16 / 180 * Math.PI;\n  var angle = Math.atan(dy / dx);\n\n  if (dx < 0) {\n    angle += Math.PI;\n  }\n\n  var data = [[x1, y1], [Math.cos(angle + angleOffset) * size + x1, Math.sin(angle + angleOffset) * size + y1], [Math.cos(angle - angleOffset) * size + x1, Math.sin(angle - angleOffset) * size + y1], [x1, y1]];\n\n  //TODO add in reverse\n  // if (canvasContext.arrowReverse){\n  //   data = [[x1, y1],\n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // } else {\n  //   data = [[x1, y1],\n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // }\n\n  return {\n    components: [lineBuilder({\n      data: data,\n      className: \"connector-end connector-arrow\",\n      classID: \"connector-end\"\n    })]\n  };\n});\n\nvar connectorDot = (function (_ref) {\n  var line$$1 = _ref.line,\n      _ref$scale = _ref.scale,\n      scale = _ref$scale === undefined ? 1 : _ref$scale;\n\n  var dot = arcBuilder({\n    className: \"connector-end connector-dot\",\n    classID: \"connector-end\",\n    data: { radius: 3 * Math.sqrt(scale) }\n  });\n  dot.attrs.transform = \"translate(\" + line$$1.data[0][0] + \", \" + line$$1.data[0][1] + \")\";\n\n  return { components: [dot] };\n});\n\nvar subjectCircle = (function (_ref) {\n  var subjectData = _ref.subjectData,\n      type = _ref.type;\n\n  if (!subjectData.radius && !subjectData.outerRadius) {\n    subjectData.radius = 20;\n  }\n\n  var handles = [];\n  var c = arcBuilder({ data: subjectData, className: \"subject\" });\n  if (type.editMode) {\n    var h = circleHandles({\n      r1: c.data.outerRadius || c.data.radius,\n      r2: c.data.innerRadius,\n      padding: subjectData.radiusPadding\n    });\n\n    var updateRadius = function updateRadius(attr) {\n      var r = subjectData[attr] + event.dx * Math.sqrt(2);\n      subjectData[attr] = r;\n      type.redrawSubject();\n      type.redrawConnector();\n    };\n\n    var cHandles = [_extends({}, h.r1, {\n      drag: updateRadius.bind(type, subjectData.outerRadius !== undefined ? \"outerRadius\" : \"radius\")\n    })];\n\n    if (subjectData.innerRadius) {\n      cHandles.push(_extends({}, h.r2, { drag: updateRadius.bind(type, \"innerRadius\") }));\n    }\n    handles = type.mapHandles(cHandles);\n  }\n\n  c.attrs[\"fill-opacity\"] = 0;\n\n  return { components: [c], handles: handles };\n});\n\nvar subjectRect = (function (_ref) {\n  var subjectData = _ref.subjectData,\n      type = _ref.type;\n\n  if (!subjectData.width) {\n    subjectData.width = 100;\n  }\n  if (!subjectData.height) {\n    subjectData.height = 100;\n  }\n\n  var handles = [];\n  var width = subjectData.width,\n      height = subjectData.height;\n\n\n  var data = [[0, 0], [width, 0], [width, height], [0, height], [0, 0]];\n  var rect = lineBuilder({ data: data, className: \"subject\" });\n\n  if (type.editMode) {\n    var updateWidth = function updateWidth() {\n      subjectData.width = event.x;\n      type.redrawSubject();\n      type.redrawConnector();\n    };\n\n    var updateHeight = function updateHeight() {\n      subjectData.height = event.y;\n      type.redrawSubject();\n      type.redrawConnector();\n    };\n\n    var rHandles = [{ x: width, y: height / 2, drag: updateWidth.bind(type) }, { x: width / 2, y: height, drag: updateHeight.bind(type) }];\n\n    handles = type.mapHandles(rHandles);\n  }\n  rect.attrs[\"fill-opacity\"] = 0.1;\n  return { components: [rect], handles: handles };\n});\n\nvar subjectThreshold = (function (_ref) {\n  var subjectData = _ref.subjectData,\n      type = _ref.type;\n\n  var offset = type.annotation.position;\n\n  var x1 = (subjectData.x1 !== undefined ? subjectData.x1 : offset.x) - offset.x,\n      x2 = (subjectData.x2 !== undefined ? subjectData.x2 : offset.x) - offset.x,\n      y1 = (subjectData.y1 !== undefined ? subjectData.y1 : offset.y) - offset.y,\n      y2 = (subjectData.y2 !== undefined ? subjectData.y2 : offset.y) - offset.y;\n\n  var data = [[x1, y1], [x2, y2]];\n  return { components: [lineBuilder({ data: data, className: 'subject' })] };\n});\n\nvar subjectBadge = (function (_ref) {\n  var _ref$subjectData = _ref.subjectData,\n      subjectData = _ref$subjectData === undefined ? {} : _ref$subjectData,\n      _ref$type = _ref.type,\n      type = _ref$type === undefined ? {} : _ref$type;\n  var annotation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var typeSettings = type.typeSettings && type.typeSettings.subject;\n\n  if (!subjectData.radius) {\n    if (typeSettings && typeSettings.radius) {\n      subjectData.radius = typeSettings.radius;\n    } else {\n      subjectData.radius = 14;\n    }\n  }\n  if (!subjectData.x) {\n    if (typeSettings && typeSettings.x) {\n      subjectData.x = typeSettings.x;\n    }\n  }\n  if (!subjectData.y) {\n    if (typeSettings && typeSettings.y) {\n      subjectData.y = typeSettings.y;\n    }\n  }\n\n  var handles = [];\n  var components = [];\n  var radius = subjectData.radius;\n  var innerRadius = radius * 0.7;\n  var x = 0;\n  var y = 0;\n\n  var notCornerOffset = Math.sqrt(2) * radius;\n  var placement = {\n    xleftcorner: -radius,\n    xrightcorner: radius,\n    ytopcorner: -radius,\n    ybottomcorner: radius,\n    xleft: -notCornerOffset,\n    xright: notCornerOffset,\n    ytop: -notCornerOffset,\n    ybottom: notCornerOffset\n  };\n\n  if (subjectData.x && !subjectData.y) {\n    x = placement[\"x\" + subjectData.x];\n  } else if (subjectData.y && !subjectData.x) {\n    y = placement[\"y\" + subjectData.y];\n  } else if (subjectData.x && subjectData.y) {\n    x = placement[\"x\" + subjectData.x + \"corner\"];\n    y = placement[\"y\" + subjectData.y + \"corner\"];\n  }\n\n  var transform = \"translate(\" + x + \", \" + y + \")\";\n  var circlebg = arcBuilder({ className: \"subject\", data: { radius: radius } });\n  circlebg.attrs.transform = transform;\n  circlebg.attrs.fill = annotation.color;\n  circlebg.attrs[\"stroke-linecap\"] = \"round\";\n  circlebg.attrs[\"stroke-width\"] = \"3px\";\n\n  var circle = arcBuilder({\n    className: \"subject-ring\",\n    data: { outerRadius: radius, innerRadius: innerRadius }\n  });\n\n  circle.attrs.transform = transform;\n  // circle.attrs.fill = annotation.color\n  circle.attrs[\"stroke-width\"] = \"3px\";\n  circle.attrs.fill = \"white\";\n\n  var pointer = void 0;\n  if (x && y || !x && !y) {\n    pointer = lineBuilder({\n      className: \"subject-pointer\",\n      data: [[0, 0], [x || 0, 0], [0, y || 0], [0, 0]]\n    });\n  } else if (x || y) {\n    var notCornerPointerXY = function notCornerPointerXY(v) {\n      var sign = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      return v && v / Math.sqrt(2) / Math.sqrt(2) || sign * radius / Math.sqrt(2);\n    };\n\n    pointer = lineBuilder({\n      className: \"subject-pointer\",\n      data: [[0, 0], [notCornerPointerXY(x), notCornerPointerXY(y)], [notCornerPointerXY(x, -1), notCornerPointerXY(y, -1)], [0, 0]]\n    });\n  }\n\n  if (pointer) {\n    pointer.attrs.fill = annotation.color;\n    pointer.attrs[\"stroke-linecap\"] = \"round\";\n    pointer.attrs[\"stroke-width\"] = \"3px\";\n    components.push(pointer);\n  }\n\n  if (type.editMode) {\n    var dragBadge = function dragBadge() {\n      subjectData.x = event.x < -radius * 2 ? \"left\" : event.x > radius * 2 ? \"right\" : undefined;\n      subjectData.y = event.y < -radius * 2 ? \"top\" : event.y > radius * 2 ? \"bottom\" : undefined;\n\n      type.redrawSubject();\n    };\n\n    var bHandles = { x: x * 2, y: y * 2, drag: dragBadge.bind(type) };\n    if (!bHandles.x && !bHandles.y) {\n      bHandles.y = -radius;\n    }\n\n    handles = type.mapHandles([bHandles]);\n  }\n\n  var text = void 0;\n  if (subjectData.text) {\n    text = {\n      type: \"text\",\n      className: \"badge-text\",\n      attrs: {\n        fill: \"white\",\n        stroke: \"none\",\n        \"font-size\": \".7em\",\n        text: subjectData.text,\n        \"text-anchor\": \"middle\",\n        dy: \".25em\",\n        x: x,\n        y: y\n      }\n    };\n  }\n\n  components.push(circlebg);\n  components.push(circle);\n  components.push(text);\n\n  return { components: components, handles: handles };\n});\n\n//Note options\n//Connector options\n//Subject options\nvar Type = function () {\n  function Type(_ref) {\n    var a = _ref.a,\n        annotation = _ref.annotation,\n        editMode = _ref.editMode,\n        dispatcher = _ref.dispatcher,\n        notePadding = _ref.notePadding,\n        accessors = _ref.accessors;\n    classCallCheck(this, Type);\n\n    this.a = a;\n\n    this.note = annotation.disable.indexOf(\"note\") === -1 && a.select(\"g.annotation-note\");\n    this.noteContent = this.note && a.select(\"g.annotation-note-content\");\n    this.connector = annotation.disable.indexOf(\"connector\") === -1 && a.select(\"g.annotation-connector\");\n    this.subject = annotation.disable.indexOf(\"subject\") === -1 && a.select(\"g.annotation-subject\");\n    this.dispatcher = dispatcher;\n\n    if (dispatcher) {\n      var handler = addHandlers.bind(null, dispatcher, annotation);\n      handler({ component: this.note, name: \"note\" });\n      handler({ component: this.connector, name: \"connector\" });\n      handler({ component: this.subject, name: \"subject\" });\n    }\n\n    this.annotation = annotation;\n    this.editMode = annotation.editMode || editMode;\n    this.notePadding = notePadding !== undefined ? notePadding : 3;\n    this.offsetCornerX = 0;\n    this.offsetCornerY = 0;\n\n    if (accessors && annotation.data) {\n      this.init(accessors);\n    }\n  }\n\n  createClass(Type, [{\n    key: \"init\",\n    value: function init(accessors) {\n      if (!this.annotation.x) {\n        this.mapX(accessors);\n      }\n      if (!this.annotation.y) {\n        this.mapY(accessors);\n      }\n    }\n  }, {\n    key: \"mapY\",\n    value: function mapY(accessors) {\n      if (accessors.y) {\n        this.annotation.y = accessors.y(this.annotation.data);\n      }\n    }\n  }, {\n    key: \"mapX\",\n    value: function mapX(accessors) {\n      if (accessors.x) {\n        this.annotation.x = accessors.x(this.annotation.data);\n      }\n    }\n  }, {\n    key: \"updateEditMode\",\n    value: function updateEditMode() {\n      this.a.selectAll(\"circle.handle\").remove();\n    }\n  }, {\n    key: \"drawOnSVG\",\n    value: function drawOnSVG(component, builders) {\n      var _this = this;\n\n      if (!Array.isArray(builders)) {\n        builders = [builders];\n      }\n\n      builders.filter(function (b) {\n        return b;\n      }).forEach(function (_ref2) {\n        var type = _ref2.type,\n            className = _ref2.className,\n            attrs = _ref2.attrs,\n            handles = _ref2.handles,\n            classID = _ref2.classID;\n\n        if (type === \"handle\") {\n          addHandles({ group: component, r: attrs && attrs.r, handles: handles });\n        } else {\n          newWithClass(component, [_this.annotation], type, className, classID);\n          var el = component.select(type + \".\" + (classID || className));\n          var addAttrs = Object.keys(attrs);\n          var removeAttrs = [];\n\n          var currentAttrs = el.node().attributes;\n          for (var i = currentAttrs.length - 1; i >= 0; i--) {\n            var name = currentAttrs[i].name;\n            if (addAttrs.indexOf(name) === -1 && name !== \"class\") removeAttrs.push(name);\n          }\n\n          addAttrs.forEach(function (attr) {\n            if (attr === \"text\") {\n              el.text(attrs[attr]);\n            } else {\n              el.attr(attr, attrs[attr]);\n            }\n          });\n\n          removeAttrs.forEach(function (attr) {\n            return el.attr(attr, null);\n          });\n        }\n      });\n    }\n\n    //TODO: how to extend this to a drawOnCanvas mode?\n\n  }, {\n    key: \"getNoteBBox\",\n    value: function getNoteBBox() {\n      return bboxWithoutHandles(this.note, \".annotation-note-content text\");\n    }\n  }, {\n    key: \"getNoteBBoxOffset\",\n    value: function getNoteBBoxOffset() {\n      var bbox = bboxWithoutHandles(this.note, \".annotation-note-content\");\n      var transform = this.noteContent.attr(\"transform\").split(/\\(|\\,|\\)/g);\n      bbox.offsetCornerX = parseFloat(transform[1]) + this.annotation.dx;\n      bbox.offsetCornerY = parseFloat(transform[2]) + this.annotation.dy;\n      bbox.offsetX = this.annotation.dx;\n      bbox.offsetY = this.annotation.dy;\n      return bbox;\n    }\n  }, {\n    key: \"drawSubject\",\n    value: function drawSubject() {\n      var _this2 = this;\n\n      var context = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var subjectData = this.annotation.subject;\n      var type = context.type;\n      var subjectParams = { type: this, subjectData: subjectData };\n\n      var subject = {};\n      if (type === \"circle\") subject = subjectCircle(subjectParams);else if (type === \"rect\") subject = subjectRect(subjectParams);else if (type === \"threshold\") subject = subjectThreshold(subjectParams);else if (type === \"badge\") subject = subjectBadge(subjectParams, this.annotation);\n\n      var _subject = subject,\n          _subject$components = _subject.components,\n          components = _subject$components === undefined ? [] : _subject$components,\n          _subject$handles = _subject.handles,\n          handles = _subject$handles === undefined ? [] : _subject$handles;\n\n      components.forEach(function (c) {\n        if (c && c.attrs && !c.attrs.stroke) {\n          c.attrs.stroke = _this2.annotation.color;\n        }\n      });\n\n      if (this.editMode) {\n        handles = handles.concat(this.mapHandles([{ drag: this.dragSubject.bind(this) }]));\n        components.push({ type: \"handle\", handles: handles });\n      }\n\n      return components;\n    }\n  }, {\n    key: \"drawConnector\",\n    value: function drawConnector() {\n      var _this3 = this;\n\n      var context = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var connectorData = this.annotation.connector;\n      var type = connectorData.type || context.type;\n      var connectorParams = { type: this, connectorData: connectorData };\n      connectorParams.subjectType = this.typeSettings && this.typeSettings.subject && this.typeSettings.subject.type;\n\n      var connector = {};\n      if (type === \"curve\") connector = connectorCurve(connectorParams);else if (type === \"elbow\") connector = connectorElbow(connectorParams);else connector = connectorLine(connectorParams);\n      var _connector = connector,\n          _connector$components = _connector.components,\n          components = _connector$components === undefined ? [] : _connector$components,\n          _connector$handles = _connector.handles,\n          handles = _connector$handles === undefined ? [] : _connector$handles;\n\n      var line$$1 = components[0];\n      //TODO: genericize this into fill t/f stroke t/f\n      if (line$$1) {\n        line$$1.attrs.stroke = this.annotation.color;\n        line$$1.attrs.fill = \"none\";\n      }\n      var endType = connectorData.end || context.end;\n      var end = {};\n      if (endType === \"arrow\") {\n        var s = line$$1.data[1];\n        var e = line$$1.data[0];\n        var distance = Math.sqrt(Math.pow(s[0] - e[0], 2) + Math.pow(s[1] - e[1], 2));\n        if (distance < 5 && line$$1.data[2]) {\n          s = line$$1.data[2];\n        }\n        end = connectorArrow({\n          annotation: this.annotation,\n          start: s,\n          end: e,\n          scale: connectorData.endScale\n        });\n      } else if (endType === \"dot\") {\n        end = connectorDot({ line: line$$1, scale: connectorData.endScale });\n      } else if (!endType || endType === \"none\") {\n        this.connector && this.connector.select(\".connector-end\").remove();\n      }\n\n      if (end.components) {\n        end.components.forEach(function (c) {\n          c.attrs.fill = _this3.annotation.color;\n          c.attrs.stroke = _this3.annotation.color;\n        });\n        components = components.concat(end.components);\n      }\n\n      if (this.editMode) {\n        if (handles.length !== 0) components.push({ type: \"handle\", handles: handles });\n      }\n      return components;\n    }\n  }, {\n    key: \"drawNote\",\n    value: function drawNote() {\n      var _this4 = this;\n\n      var context = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var noteData = this.annotation.note;\n      var align = noteData.align || context.align || \"dynamic\";\n      var noteParams = {\n        bbox: context.bbox,\n        align: align,\n        offset: this.annotation.offset\n      };\n      var lineType = noteData.lineType || context.lineType;\n      var note = {};\n      if (lineType === \"vertical\") note = noteVertical(noteParams);else if (lineType === \"horizontal\") note = noteHorizontal(noteParams);\n\n      var _note = note,\n          _note$components = _note.components,\n          components = _note$components === undefined ? [] : _note$components,\n          _note$handles = _note.handles,\n          handles = _note$handles === undefined ? [] : _note$handles;\n\n      components.forEach(function (c) {\n        c.attrs.stroke = _this4.annotation.color;\n      });\n\n      if (this.editMode) {\n        handles = this.mapHandles([{ x: 0, y: 0, drag: this.dragNote.bind(this) }]);\n        components.push({ type: \"handle\", handles: handles });\n\n        var dragging = this.dragNote.bind(this),\n            start = this.dragstarted.bind(this),\n            end = this.dragended.bind(this);\n        this.note.call(drag().container(select(\"g.annotations\").node()).on(\"start\", function (d) {\n          return start(d);\n        }).on(\"drag\", function (d) {\n          return dragging(d);\n        }).on(\"end\", function (d) {\n          return end(d);\n        }));\n      } else {\n        this.note.on(\"mousedown.drag\", null);\n      }\n      return components;\n    }\n  }, {\n    key: \"drawNoteContent\",\n    value: function drawNoteContent(context) {\n      var noteData = this.annotation.note;\n      var padding = noteData.padding !== undefined ? noteData.padding : this.notePadding;\n      var orientation = noteData.orientation || context.orientation || \"topBottom\";\n      var lineType = noteData.lineType || context.lineType;\n      var align = noteData.align || context.align || \"dynamic\";\n\n      if (lineType === \"vertical\") orientation = \"leftRight\";else if (lineType === \"horizontal\") orientation = \"topBottom\";\n\n      var noteParams = {\n        padding: padding,\n        bbox: context.bbox,\n        offset: this.annotation.offset,\n        orientation: orientation,\n        align: align\n      };\n\n      var _noteAlignment = noteAlignment(noteParams),\n          x = _noteAlignment.x,\n          y = _noteAlignment.y;\n\n      this.offsetCornerX = x + this.annotation.dx;\n      this.offsetCornerY = y + this.annotation.dy;\n      this.note && this.noteContent.attr(\"transform\", \"translate(\" + x + \", \" + y + \")\");\n\n      return [];\n    }\n  }, {\n    key: \"drawOnScreen\",\n    value: function drawOnScreen(component, drawFunction) {\n      return this.drawOnSVG(component, drawFunction);\n    }\n  }, {\n    key: \"redrawSubject\",\n    value: function redrawSubject() {\n      this.subject && this.drawOnScreen(this.subject, this.drawSubject());\n    }\n  }, {\n    key: \"redrawConnector\",\n    value: function redrawConnector() {\n      this.connector && this.drawOnScreen(this.connector, this.drawConnector());\n    }\n  }, {\n    key: \"redrawNote\",\n    value: function redrawNote() {\n      var bbox = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.getNoteBBox();\n\n      this.noteContent && this.drawOnScreen(this.noteContent, this.drawNoteContent({ bbox: bbox }));\n      this.note && this.drawOnScreen(this.note, this.drawNote({ bbox: bbox }));\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition() {\n      var position = this.annotation.position;\n      this.a.attr(\"transform\", \"translate(\" + position.x + \", \" + position.y + \")\");\n    }\n  }, {\n    key: \"clearComponents\",\n    value: function clearComponents() {\n      this.subject && this.subject.select(\"*\").remove();\n      this.connector && this.connector.select(\"*\").remove();\n      // this.note && this.note.select(\"*\").remove()\n    }\n  }, {\n    key: \"setOffset\",\n    value: function setOffset() {\n      if (this.note) {\n        var offset = this.annotation.offset;\n        this.note.attr(\"transform\", \"translate(\" + offset.x + \", \" + offset.y + \")\");\n      }\n    }\n  }, {\n    key: \"setPositionWithAccessors\",\n    value: function setPositionWithAccessors(accessors) {\n      if (accessors && this.annotation.data) {\n        this.mapX(accessors);\n        this.mapY(accessors);\n      }\n      this.setPosition();\n    }\n  }, {\n    key: \"setClassName\",\n    value: function setClassName() {\n      this.a.attr(\"class\", \"annotation \" + (this.className && this.className()) + \" \" + (this.editMode ? \"editable\" : \"\") + \" \" + (this.annotation.className || \"\"));\n    }\n  }, {\n    key: \"draw\",\n    value: function draw() {\n      this.setClassName();\n      this.setPosition();\n      this.setOffset();\n      this.redrawSubject();\n      this.redrawConnector();\n      this.redrawNote();\n    }\n  }, {\n    key: \"dragstarted\",\n    value: function dragstarted() {\n      event.sourceEvent.stopPropagation();\n      this.dispatcher && this.dispatcher.call(\"dragstart\", this.a, this.annotation);\n      this.a.classed(\"dragging\", true);\n      this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"none\");\n    }\n  }, {\n    key: \"dragended\",\n    value: function dragended() {\n      this.dispatcher && this.dispatcher.call(\"dragend\", this.a, this.annotation);\n      this.a.classed(\"dragging\", false);\n      this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"all\");\n    }\n  }, {\n    key: \"dragSubject\",\n    value: function dragSubject() {\n      var position = this.annotation.position;\n      position.x += event.dx;\n      position.y += event.dy;\n      this.annotation.position = position;\n    }\n  }, {\n    key: \"dragNote\",\n    value: function dragNote() {\n      var offset = this.annotation.offset;\n      offset.x += event.dx;\n      offset.y += event.dy;\n      this.annotation.offset = offset;\n    }\n  }, {\n    key: \"mapHandles\",\n    value: function mapHandles(handles) {\n      var _this5 = this;\n\n      return handles.map(function (h) {\n        return _extends({}, h, {\n          start: _this5.dragstarted.bind(_this5),\n          end: _this5.dragended.bind(_this5)\n        });\n      });\n    }\n  }]);\n  return Type;\n}();\n\nvar customType = function customType(initialType, typeSettings, _init) {\n  return function (_initialType) {\n    inherits(customType, _initialType);\n\n    function customType(settings) {\n      classCallCheck(this, customType);\n\n      var _this6 = possibleConstructorReturn(this, (customType.__proto__ || Object.getPrototypeOf(customType)).call(this, settings));\n\n      _this6.typeSettings = typeSettings;\n\n      if (typeSettings.disable) {\n        typeSettings.disable.forEach(function (d) {\n          _this6[d] && _this6[d].remove();\n\n          _this6[d] = undefined;\n          if (d === \"note\") {\n            _this6.noteContent = undefined;\n          }\n        });\n      }\n      return _this6;\n    }\n\n    createClass(customType, [{\n      key: \"className\",\n      value: function className() {\n        return \"\" + (typeSettings.className || get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"className\", this) && get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"className\", this).call(this) || \"\");\n      }\n    }, {\n      key: \"drawSubject\",\n      value: function drawSubject(context) {\n        this.typeSettings.subject = _extends({}, typeSettings.subject, this.typeSettings.subject);\n        return get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"drawSubject\", this).call(this, _extends({}, context, this.typeSettings.subject));\n      }\n    }, {\n      key: \"drawConnector\",\n      value: function drawConnector(context) {\n        this.typeSettings.connector = _extends({}, typeSettings.connector, this.typeSettings.connector);\n        return get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"drawConnector\", this).call(this, _extends({}, context, typeSettings.connector, this.typeSettings.connector));\n      }\n    }, {\n      key: \"drawNote\",\n      value: function drawNote(context) {\n        this.typeSettings.note = _extends({}, typeSettings.note, this.typeSettings.note);\n        return get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"drawNote\", this).call(this, _extends({}, context, typeSettings.note, this.typeSettings.note));\n      }\n    }, {\n      key: \"drawNoteContent\",\n      value: function drawNoteContent(context) {\n        return get(customType.prototype.__proto__ || Object.getPrototypeOf(customType.prototype), \"drawNoteContent\", this).call(this, _extends({}, context, typeSettings.note, this.typeSettings.note));\n      }\n    }], [{\n      key: \"init\",\n      value: function init(annotation, accessors) {\n        get(customType.__proto__ || Object.getPrototypeOf(customType), \"init\", this).call(this, annotation, accessors);\n        if (_init) {\n          annotation = _init(annotation, accessors);\n        }\n        return annotation;\n      }\n    }]);\n    return customType;\n  }(initialType);\n};\n\nvar d3NoteText = function (_Type) {\n  inherits(d3NoteText, _Type);\n\n  function d3NoteText(params) {\n    classCallCheck(this, d3NoteText);\n\n    var _this7 = possibleConstructorReturn(this, (d3NoteText.__proto__ || Object.getPrototypeOf(d3NoteText)).call(this, params));\n\n    _this7.textWrap = params.textWrap || 120;\n    _this7.drawText();\n    return _this7;\n  }\n\n  createClass(d3NoteText, [{\n    key: \"updateTextWrap\",\n    value: function updateTextWrap(textWrap) {\n      this.textWrap = textWrap;\n      this.drawText();\n    }\n\n    //TODO: add update text functionality\n\n  }, {\n    key: \"drawText\",\n    value: function drawText() {\n      if (this.note) {\n        newWithClass(this.note, [this.annotation], \"g\", \"annotation-note-content\");\n\n        var noteContent = this.note.select(\"g.annotation-note-content\");\n        newWithClass(noteContent, [this.annotation], \"rect\", \"annotation-note-bg\");\n        newWithClass(noteContent, [this.annotation], \"text\", \"annotation-note-label\");\n        newWithClass(noteContent, [this.annotation], \"text\", \"annotation-note-title\");\n\n        var titleBBox = { height: 0 };\n        var label = this.a.select(\"text.annotation-note-label\");\n        var wrapLength = this.annotation.note && this.annotation.note.wrap || this.typeSettings && this.typeSettings.note && this.typeSettings.note.wrap || this.textWrap;\n\n        var wrapSplitter = this.annotation.note && this.annotation.note.wrapSplitter || this.typeSettings && this.typeSettings.note && this.typeSettings.note.wrapSplitter;\n\n        var bgPadding = this.annotation.note && this.annotation.note.bgPadding || this.typeSettings && this.typeSettings.note && this.typeSettings.note.bgPadding;\n\n        var bgPaddingFinal = { top: 0, bottom: 0, left: 0, right: 0 };\n        if (typeof bgPadding === \"number\") {\n          bgPaddingFinal = {\n            top: bgPadding,\n            bottom: bgPadding,\n            left: bgPadding,\n            right: bgPadding\n          };\n        } else if (bgPadding && (typeof bgPadding === \"undefined\" ? \"undefined\" : _typeof(bgPadding)) === \"object\") {\n          bgPaddingFinal = _extends(bgPaddingFinal, bgPadding);\n        }\n\n        if (this.annotation.note.title) {\n          var title = this.a.select(\"text.annotation-note-title\");\n          title.text(this.annotation.note.title);\n          title.attr(\"fill\", this.annotation.color);\n          title.attr(\"font-weight\", \"bold\");\n          title.call(wrap, wrapLength, wrapSplitter);\n          titleBBox = title.node().getBBox();\n        }\n\n        label.text(this.annotation.note.label).attr(\"dx\", \"0\");\n        label.call(wrap, wrapLength, wrapSplitter);\n\n        label.attr(\"y\", titleBBox.height * 1.1 || 0);\n        label.attr(\"fill\", this.annotation.color);\n\n        var bbox = this.getNoteBBox();\n\n        this.a.select(\"rect.annotation-note-bg\").attr(\"width\", bbox.width + bgPaddingFinal.left + bgPaddingFinal.right).attr(\"height\", bbox.height + bgPaddingFinal.top + bgPaddingFinal.bottom).attr(\"x\", bbox.x - bgPaddingFinal.left).attr(\"y\", -bgPaddingFinal.top).attr(\"fill\", \"white\").attr(\"fill-opacity\", 0);\n      }\n    }\n  }]);\n  return d3NoteText;\n}(Type);\n\nvar d3Label = customType(d3NoteText, {\n  className: \"label\",\n  note: { align: \"middle\" }\n});\n\nvar d3Callout = customType(d3NoteText, {\n  className: \"callout\",\n  note: { lineType: \"horizontal\" }\n});\n\nvar d3CalloutElbow = customType(d3Callout, {\n  className: \"callout elbow\",\n  connector: { type: \"elbow\" }\n});\n\nvar d3CalloutCurve = customType(d3Callout, {\n  className: \"callout curve\",\n  connector: { type: \"curve\" }\n});\n\nvar d3Badge = customType(Type, {\n  className: \"badge\",\n  subject: { type: \"badge\" },\n  disable: [\"connector\", \"note\"]\n});\n\nvar d3CalloutCircle = customType(d3NoteText, {\n  className: \"callout circle\",\n  subject: { type: \"circle\" },\n  note: { lineType: \"horizontal\" },\n  connector: { type: \"elbow\" }\n});\n\nvar d3CalloutRect = customType(d3NoteText, {\n  className: \"callout rect\",\n  subject: { type: \"rect\" },\n  note: { lineType: \"horizontal\" },\n  connector: { type: \"elbow\" }\n});\n\nvar ThresholdMap = function (_d3Callout) {\n  inherits(ThresholdMap, _d3Callout);\n\n  function ThresholdMap() {\n    classCallCheck(this, ThresholdMap);\n    return possibleConstructorReturn(this, (ThresholdMap.__proto__ || Object.getPrototypeOf(ThresholdMap)).apply(this, arguments));\n  }\n\n  createClass(ThresholdMap, [{\n    key: \"mapY\",\n    value: function mapY(accessors) {\n      get(ThresholdMap.prototype.__proto__ || Object.getPrototypeOf(ThresholdMap.prototype), \"mapY\", this).call(this, accessors);\n      var a = this.annotation;\n      if ((a.subject.x1 || a.subject.x2) && a.data && accessors.y) {\n        a.y = accessors.y(a.data);\n      }\n      if ((a.subject.x1 || a.subject.x2) && !a.x) {\n        a.x = a.subject.x1 || a.subject.x2;\n      }\n    }\n  }, {\n    key: \"mapX\",\n    value: function mapX(accessors) {\n      get(ThresholdMap.prototype.__proto__ || Object.getPrototypeOf(ThresholdMap.prototype), \"mapX\", this).call(this, accessors);\n      var a = this.annotation;\n      if ((a.subject.y1 || a.subject.y2) && a.data && accessors.x) {\n        a.x = accessors.x(a.data);\n      }\n      if ((a.subject.y1 || a.subject.y2) && !a.y) {\n        a.y = a.subject.y1 || a.subject.y2;\n      }\n    }\n  }]);\n  return ThresholdMap;\n}(d3Callout);\n\nvar d3XYThreshold = customType(ThresholdMap, {\n  className: \"callout xythreshold\",\n  subject: { type: \"threshold\" }\n});\n\nvar newWithClass = function newWithClass(a, d, type, className, classID) {\n  var group = a.selectAll(type + \".\" + (classID || className)).data(d);\n  group.enter().append(type).merge(group).attr(\"class\", className);\n\n  group.exit().remove();\n  return a;\n};\n\nvar addHandlers = function addHandlers(dispatcher, annotation, _ref3) {\n  var component = _ref3.component,\n      name = _ref3.name;\n\n  if (component) {\n    component.on(\"mouseover.annotations\", function () {\n      dispatcher.call(name + \"over\", component, annotation);\n    }).on(\"mouseout.annotations\", function () {\n      return dispatcher.call(name + \"out\", component, annotation);\n    }).on(\"click.annotations\", function () {\n      return dispatcher.call(name + \"click\", component, annotation);\n    });\n  }\n};\n\n//Text wrapping code adapted from Mike Bostock\nvar wrap = function wrap(text, width, wrapSplitter) {\n  var lineHeight = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1.2;\n\n  text.each(function () {\n    var text = select(this),\n        words = text.text().split(wrapSplitter || /[ \\t\\r\\n]+/).reverse().filter(function (w) {\n      return w !== \"\";\n    });\n    var word = void 0,\n        line$$1 = [],\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"dy\", 0.8 + \"em\");\n\n    while (word = words.pop()) {\n      line$$1.push(word);\n      tspan.text(line$$1.join(\" \"));\n      if (tspan.node().getComputedTextLength() > width && line$$1.length > 1) {\n        line$$1.pop();\n        tspan.text(line$$1.join(\" \"));\n        line$$1 = [word];\n        tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"dy\", lineHeight + \"em\").text(word);\n      }\n    }\n  });\n};\n\nvar bboxWithoutHandles = function bboxWithoutHandles(selection) {\n  var selector = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \":not(.handle)\";\n\n  if (!selection) {\n    return { x: 0, y: 0, width: 0, height: 0 };\n  }\n\n  return selection.selectAll(selector).nodes().reduce(function (p, c) {\n    var bbox = c.getBBox();\n    p.x = Math.min(p.x, bbox.x);\n    p.y = Math.min(p.y, bbox.y);\n    p.width = Math.max(p.width, bbox.width);\n\n    var yOffset = c && c.attributes && c.attributes.y;\n    p.height = Math.max(p.height, (yOffset && parseFloat(yOffset.value) || 0) + bbox.height);\n    return p;\n  }, { x: 0, y: 0, width: 0, height: 0 });\n};\n\nfunction annotation() {\n  var annotations = [],\n      collection = void 0,\n      context = void 0,\n      //TODO: add canvas functionality\n  disable = [],\n      accessors = {},\n      accessorsInverse = {},\n      editMode = false,\n      ids = void 0,\n      type = d3Callout,\n      textWrap = void 0,\n      notePadding = void 0,\n      annotationDispatcher = dispatch(\"subjectover\", \"subjectout\", \"subjectclick\", \"connectorover\", \"connectorout\", \"connectorclick\", \"noteover\", \"noteout\", \"noteclick\", \"dragend\", \"dragstart\"),\n      sel = void 0;\n\n  var annotation = function annotation(selection) {\n    sel = selection;\n    //TODO: check to see if this is still needed\n    if (!editMode) {\n      selection.selectAll(\"circle.handle\").remove();\n    }\n\n    var translatedAnnotations = annotations.map(function (a) {\n      if (!a.type) {\n        a.type = type;\n      }\n      if (!a.disable) {\n        a.disable = disable;\n      }\n      return new Annotation(a);\n    });\n\n    collection = collection || new AnnotationCollection({\n      annotations: translatedAnnotations,\n      accessors: accessors,\n      accessorsInverse: accessorsInverse,\n      ids: ids\n    });\n\n    var annotationG = selection.selectAll(\"g\").data([collection]);\n    annotationG.enter().append(\"g\").attr(\"class\", \"annotations\");\n\n    var group = selection.select(\"g.annotations\");\n    newWithClass(group, collection.annotations, \"g\", \"annotation\");\n\n    var annotation = group.selectAll(\"g.annotation\");\n\n    annotation.each(function (d) {\n      var a = select(this);\n\n      a.attr(\"class\", \"annotation\");\n\n      newWithClass(a, [d], \"g\", \"annotation-connector\");\n      newWithClass(a, [d], \"g\", \"annotation-subject\");\n      newWithClass(a, [d], \"g\", \"annotation-note\");\n      newWithClass(a.select(\"g.annotation-note\"), [d], \"g\", \"annotation-note-content\");\n      d.type = d.type.toString() === \"[object Object]\" ? d.type : new d.type({\n        a: a,\n        annotation: d,\n        textWrap: textWrap,\n        notePadding: notePadding,\n        editMode: editMode,\n        dispatcher: annotationDispatcher,\n        accessors: accessors\n      });\n      d.type.draw();\n      d.type.drawText && d.type.drawText();\n    });\n  };\n\n  annotation.json = function () {\n    /* eslint-disable no-console */\n    console.log(\"Annotations JSON was copied to your clipboard. Please note the annotation type is not JSON compatible. It appears in the objects array in the console, but not in the copied JSON.\", collection.json);\n    /* eslint-enable no-console */\n    window.copy(JSON.stringify(collection.json.map(function (a) {\n      delete a.type;\n      return a;\n    })));\n    return annotation;\n  };\n\n  annotation.update = function () {\n    if (annotations && collection) {\n      annotations = collection.annotations.map(function (a) {\n        a.type.draw();\n        return a;\n      });\n    }\n    return annotation;\n  };\n\n  annotation.updateText = function () {\n    if (collection) {\n      collection.updateText(textWrap);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.updatedAccessors = function () {\n    collection.setPositionWithAccessors();\n    annotations = collection.annotations;\n    return annotation;\n  };\n\n  annotation.disable = function (_) {\n    if (!arguments.length) return disable;\n    disable = _;\n    if (collection) {\n      collection.updateDisable(disable);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.textWrap = function (_) {\n    if (!arguments.length) return textWrap;\n    textWrap = _;\n    if (collection) {\n      collection.updateTextWrap(textWrap);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.notePadding = function (_) {\n    if (!arguments.length) return notePadding;\n    notePadding = _;\n    if (collection) {\n      collection.updateNotePadding(notePadding);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n  //todo think of how to handle when undefined is sent\n  annotation.type = function (_, settings) {\n    if (!arguments.length) return type;\n    type = _;\n    if (collection) {\n      collection.annotations.map(function (a) {\n        a.type.note && a.type.note.selectAll(\"*:not(.annotation-note-content)\").remove();\n        a.type.noteContent && a.type.noteContent.selectAll(\"*\").remove();\n        a.type.subject && a.type.subject.selectAll(\"*\").remove();\n        a.type.connector && a.type.connector.selectAll(\"*\").remove();\n        a.type.typeSettings = {};\n        a.type = type;\n\n        a.subject = settings && settings.subject || a.subject;\n        a.connector = settings && settings.connector || a.connector;\n        a.note = settings && settings.note || a.note;\n      });\n\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.annotations = function (_) {\n    if (!arguments.length) return collection && collection.annotations || annotations;\n    annotations = _;\n\n    if (collection && collection.annotations) {\n      var rerun = annotations.some(function (d) {\n        return !d.type || d.type.toString() !== \"[object Object]\";\n      });\n\n      if (rerun) {\n        collection = null;\n        annotation(sel);\n      } else {\n        collection.annotations = annotations;\n      }\n    }\n    return annotation;\n  };\n\n  annotation.context = function (_) {\n    if (!arguments.length) return context;\n    context = _;\n    return annotation;\n  };\n\n  annotation.accessors = function (_) {\n    if (!arguments.length) return accessors;\n    accessors = _;\n    return annotation;\n  };\n\n  annotation.accessorsInverse = function (_) {\n    if (!arguments.length) return accessorsInverse;\n    accessorsInverse = _;\n    return annotation;\n  };\n\n  annotation.ids = function (_) {\n    if (!arguments.length) return ids;\n    ids = _;\n    return annotation;\n  };\n\n  annotation.editMode = function (_) {\n    if (!arguments.length) return editMode;\n    editMode = _;\n\n    if (sel) {\n      sel.selectAll(\"g.annotation\").classed(\"editable\", editMode);\n    }\n\n    if (collection) {\n      collection.editMode(editMode);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.collection = function (_) {\n    if (!arguments.length) return collection;\n    collection = _;\n    return annotation;\n  };\n\n  annotation.on = function () {\n    var value = annotationDispatcher.on.apply(annotationDispatcher, arguments);\n    return value === annotationDispatcher ? annotation : value;\n  };\n\n  return annotation;\n}\n\nvar index = {\n  annotation: annotation,\n  annotationTypeBase: Type,\n  annotationLabel: d3Label,\n  annotationCallout: d3Callout,\n  annotationCalloutCurve: d3CalloutCurve,\n  annotationCalloutElbow: d3CalloutElbow,\n  annotationCalloutCircle: d3CalloutCircle,\n  annotationCalloutRect: d3CalloutRect,\n  annotationXYThreshold: d3XYThreshold,\n  annotationBadge: d3Badge,\n  annotationCustomType: customType\n};\n\nexport { annotation, Type as annotationTypeBase, d3Label as annotationLabel, d3Callout as annotationCallout, d3CalloutCurve as annotationCalloutCurve, d3CalloutElbow as annotationCalloutElbow, d3CalloutCircle as annotationCalloutCircle, d3CalloutRect as annotationCalloutRect, d3XYThreshold as annotationXYThreshold, d3Badge as annotationBadge, customType as annotationCustomType };export default index;\n//# sourceMappingURL=indexRollupNext.js.map\n","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport curveLinear from \"./curve/linear\";\nimport {x as pointX, y as pointY} from \"./point\";\n\nexport default function() {\n  var x = pointX,\n      y = pointY,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  function line(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import {\r\n    annotation,\r\n    annotationLabel,\r\n    annotationCallout,\r\n    annotationCalloutRect,\r\n    annotationCalloutCircle,\r\n    annotationXYThreshold,\r\n} from 'd3-svg-annotation'\r\n\r\nexport function appendAnnotations(map) {\r\n    if (map.svg_) {\r\n        const zoomGroup = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n        //clear previous\r\n        zoomGroup.selectAll('.em-annotations').remove()\r\n\r\n        const annotationsConfig = map.annotations_\r\n\r\n        if (annotationsConfig) {\r\n            // Define a map that maps the type string to the corresponding annotation function\r\n            const annotationTypeMap = {\r\n                annotationLabel: annotationLabel,\r\n                annotationCallout: annotationCallout,\r\n                annotationCalloutRect: annotationCalloutRect,\r\n                annotationCalloutCircle: annotationCalloutCircle,\r\n                annotationXYThreshold: annotationXYThreshold, // Add any other types you need\r\n            }\r\n\r\n            // Map annotations data to ensure each annotation has the proper function\r\n            const annotationsWithTypes = annotationsConfig.annotations.map((d) => {\r\n                // Replace the 'type' string with the corresponding annotation function\r\n                const annotationType = annotationTypeMap[d.type] || annotationLabel // Default to annotationLabel\r\n                return { ...d, type: annotationType } // Update 'type' with the function reference\r\n            })\r\n            const makeAnnotations = annotation().type(annotationLabel).annotations(annotationsWithTypes).editMode(annotationsConfig.editMode)\r\n\r\n            // append new\r\n            zoomGroup.append('g').attr('id', 'em-annotations').attr('class', 'em-annotations').call(makeAnnotations)\r\n        }\r\n    }\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { spaceAsThousandSeparator, executeForAllInsets, ensureGroup } from './utils'\r\n\r\n// handles all map labels e.g. stat values, or labels specified in map.labels({labels:[text:'myLabel', x:123, y: 123]})\r\n\r\n/**\r\n * @function addLabelsToMap\r\n * @param map eurostatmap map instance\r\n * @param zg zoomgroup (d3 selection of zoomable elements)\r\n * @description appends text labels to the map. Labels can be countries, country codes, ocean names or statistical values\r\n */\r\nexport const addLabelsToMap = function (map, zg) {\r\n    // set defaults\r\n    if (!map.labels_.config) map.labels_.config = DEFAULTLABELS\r\n    if (!map.labels_.statLabelsPositions) map.labels_.statLabelsPositions = DEFAULTSTATLABELPOSITIONS\r\n\r\n    //define formatter\r\n    map._statLabelFormatter = map.labels_.valuesFormatter ? map.labels_.valuesFormatter : spaceAsThousandSeparator\r\n\r\n    // use existing or append new container\r\n    let existing = zg.select('#em-labels')\r\n    let labelsContainer = existing.empty() ? zg.append('g').attr('id', 'em-labels').attr('class', 'em-labels') : existing\r\n\r\n    //for statistical values on maps without centroids, we need to add centroids initially, then add text to them later once the stat data is loaded\r\n    if (map.labels_?.values && map._mapType !== 'ps') appendStatLabelCentroidsToMap(map, labelsContainer)\r\n\r\n    // get labels array\r\n    let labelsArray = map.labels_?.labels || DEFAULTLABELS[`${map.geo}_${map.proj_}.cc`]\r\n\r\n    // append other labels to map\r\n    if (labelsArray) {\r\n        // create or reuse containers\r\n        const shadowg = ensureGroup(labelsContainer, 'em-label-shadows');\r\n        const labelg = ensureGroup(labelsContainer, 'em-labels');\r\n\r\n        //SHADOWS\r\n        if (map.labels_?.shadows) {\r\n            let shadows = shadowg\r\n                .selectAll('text')\r\n                .data(labelsArray)\r\n                .enter()\r\n                .append('text')\r\n                .attr('id', (d) => 'em-label-shadow-' + d.text.replace(/\\s+/g, '-'))\r\n                .attr('class', (d) => 'em-label-shadow em-label-shadow-' + d.class)\r\n                .attr('x', function (d) {\r\n                    if (d.rotate) {\r\n                        return 0 //for rotated text, x and y positions must be specified in the transform property\r\n                    }\r\n                    return map._projection([d.x, d.y])[0]\r\n                })\r\n                .attr('y', function (d) {\r\n                    if (d.rotate) {\r\n                        return 0 //for rotated text, x and y positions must be specified in the transform property\r\n                    }\r\n                    return map._projection([d.x, d.y])[1]\r\n                })\r\n                .attr('dy', -7) // set y position of bottom of text\r\n                .attr('transform', (d) => {\r\n                    if (d.rotate) {\r\n                        let pos = map._projection([d.x, d.y])\r\n                        let x = pos[0]\r\n                        let y = pos[1]\r\n                        return `translate(${x},${y}) rotate(${d.rotate})`\r\n                    } else {\r\n                        return 'rotate(0)'\r\n                    }\r\n                })\r\n                .text(function (d) {\r\n                    return d.text\r\n                }) // define the text to display\r\n        }\r\n\r\n        //LABEL texts\r\n        labelg\r\n            .selectAll('text')\r\n            .data(labelsArray)\r\n            .enter()\r\n            .append('text')\r\n            .attr('id', (d) => 'em-label-' + d.text.replace(/\\s+/g, '-'))\r\n            .attr('class', (d) => 'em-label em-label-' + d.class)\r\n            //position label\r\n            .attr('x', function (d) {\r\n                if (d.rotate) {\r\n                    return 0 //for rotated text, x and y positions must be specified in the transform property\r\n                }\r\n                return map._projection([d.x, d.y])[0]\r\n            })\r\n            .attr('y', function (d) {\r\n                if (d.rotate) {\r\n                    return 0 //for rotated text, x and y positions must be specified in the transform property\r\n                }\r\n                return map._projection([d.x, d.y])[1]\r\n            })\r\n            .attr('dy', -7) // set y position of bottom of text\r\n            //transform labels which have a \"rotate\" property in the labels config. For rotated labels, their X,Y must also be set in the transform.\r\n            // note: dont apply to country code labels\r\n            .attr('transform', (d) => {\r\n                if (d.rotate) {\r\n                    let pos = map._projection([d.x, d.y])\r\n                    let x = pos[0]\r\n                    let y = pos[1]\r\n                    return `translate(${x},${y}) rotate(${d.rotate})`\r\n                } else {\r\n                    return 'rotate(0)'\r\n                }\r\n            })\r\n            .text(function (d) {\r\n                return d.text\r\n            }) // define the text to display\r\n    }\r\n}\r\n\r\n/**\r\n* Add labels for data points.\r\n* @param {Object} svg - D3 selection of the SVG element.\r\n*/\r\nexport function addFlowValueLabels(out, svg) {\r\n    // use existing or append new container\r\n    let existing = svg.select('#em-labels')\r\n    let labelsContainer = existing.empty() ? svg.append('g').attr('id', 'em-labels') : existing\r\n    // Filter the nodes\r\n    const nodes = out.flowGraph_.nodes\r\n    const filteredNodes = nodes.filter((node) => node.targetLinks && node.sourceLinks.length === 0)\r\n    // create or reuse container\r\n    const container = ensureGroup(labelsContainer, 'em-flow-labels');\r\n\r\n    // Add halo effect\r\n    if (out.labels_?.shadows) {\r\n        const labelsShadowGroup = container.append('g').attr('class', 'em-flow-label-shadow')\r\n        labelsShadowGroup\r\n            .selectAll('text')\r\n            .data(filteredNodes)\r\n            .join('text')\r\n            .attr('text-anchor', (d) => (d.x > d.targetLinks[0].source.x ? 'start' : 'end'))\r\n            .attr('x', (d) => (d.x > d.targetLinks[0].source.x ? d.x + out.flowLabelOffsets_.x : d.x - out.flowLabelOffsets_.x))\r\n            .attr('y', (d) => d.y + out.flowLabelOffsets_.y)\r\n            .text((d) => out._statLabelFormatter(d.value))\r\n    }\r\n\r\n    // Add labels\r\n    const labelsGroup = container.append('g').attr('class', 'em-flow-label')\r\n    //add background\r\n    // Add background rectangles and text\r\n    const labelElements = labelsGroup\r\n        .selectAll('g') // Use a group for each label to combine rect and text\r\n        .data(filteredNodes)\r\n        .join('g') // Append a group for each label\r\n        .attr('transform', (d) => `translate(${d.x}, ${d.y})`) // Position group at the node\r\n\r\n    // Add text first to calculate its size\r\n    labelElements\r\n        .append('text')\r\n        .attr('class', 'em-label-text')\r\n        .attr('text-anchor', (d) => (d.x > d.targetLinks[0].source.x ? 'start' : 'end'))\r\n        .attr('x', (d) => (d.x > d.targetLinks[0].source.x ? out.flowLabelOffsets_.x : -out.flowLabelOffsets_.x))\r\n        .attr('y', out.flowLabelOffsets_.y)\r\n        .text((d) => out._statLabelFormatter(d.value))\r\n\r\n    // Add background rectangles after text is rendered\r\n\r\n    if (out.labels_.backgrounds) {\r\n        labelElements.each(function () {\r\n            const textElement = select(this).select('text')\r\n            const bbox = textElement.node().getBBox() // Get bounding box of the text\r\n\r\n            const paddingX = 5 // Horizontal padding\r\n            const paddingY = 2 // Vertical padding\r\n\r\n            // Add rectangle centered behind the text\r\n            select(this)\r\n                .insert('rect', 'text') // Insert rect before text in DOM\r\n                .attr('class', 'em-label-background')\r\n                .attr('x', bbox.x - paddingX)\r\n                .attr('y', bbox.y - paddingY)\r\n                .attr('width', bbox.width + 2 * paddingX)\r\n                .attr('height', bbox.height + 2 * paddingY)\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * @function updateLabels\r\n * @description update existing map labels\r\n */\r\nexport const updateLabels = function (map) {\r\n    if (map.svg_) {\r\n        // Clear previous labels\r\n        let prevLabels = map.svg_.selectAll('#em-labels > *')\r\n        if (prevLabels) prevLabels.remove()\r\n\r\n        // Main map\r\n        if (map.labels_) {\r\n            const masterConfig = map.labels_\r\n            let zg = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n            addLabelsToMap(map, zg)\r\n            if (masterConfig.values && map.updateValuesLabels) {\r\n                map.updateValuesLabels(map)\r\n            }\r\n\r\n            // Define the callback to apply to each inset\r\n            const applyLabelsCallback = (map) => {\r\n                if (masterConfig) {\r\n                    let zg = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n                    if (map.labels_) addLabelsToMap(map, zg)\r\n                    if (masterConfig.values && map.updateValuesLabels) {\r\n                        map.updateValuesLabels(map)\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Apply labels to all insets using the executeForAllInsets function\r\n            if (map.insetTemplates_) {\r\n                executeForAllInsets(map.insetTemplates_, map.svgId_, applyLabelsCallback)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @description update the statistical values labels on the map\r\n * @param {Object} map eurostat-map map instance\r\n * @return {map} out\r\n * NOTE: THIS FUNCTION IS NOT CALLED FOR PROPORTIONAL SYMBOL MAPS\r\n */\r\nexport const updateValuesLabels = function (map) {\r\n    if (!map) {\r\n        console.warn('No map specified')\r\n        return\r\n    }\r\n\r\n    //clear previous labels\r\n    let prevLabels = map.svg_.selectAll('g.em-stat-label > *')\r\n    prevLabels.remove()\r\n    let prevShadows = map.svg_.selectAll('g.em-stat-label-shadow > *')\r\n    prevShadows.remove()\r\n    let statLabels = map.svg_.selectAll('g.em-stat-label')\r\n\r\n    // filter stat-label elements to only show those with data\r\n    const filterFunction = map.labels_?.statLabelsFilterFunction ? map.labels_?.statLabelsFilterFunction : defaultStatLabelFilter\r\n    const statData = map.statData()\r\n    statLabels\r\n        .filter((rg) => filterFunction(rg, map))\r\n        // .append('text')\r\n        .each(function (d) {\r\n            const sel = select(this)\r\n            const labelText = statLabelsTextFunction(d, statData, map) // Use 'd' directly for the label text\r\n\r\n            // Append rectangle behind label\r\n            if (map.labels_.backgrounds) appendRect(labelText, sel)\r\n\r\n            // Append text after the rectangle\r\n            sel.append('text').text(labelText).attr('class', 'em-stat-label-text')\r\n        })\r\n\r\n    // Function to append a rectangle behind the label\r\n    function appendRect(labelText, container) {\r\n        const paddingX = 5 // Add some padding around the text\r\n        const paddingY = 2 // Add some padding around the text\r\n\r\n        // Create a temporary text element to get the size\r\n        const bbox = container\r\n            .append('text')\r\n            .attr('visibility', 'hidden') // Make the temporary text invisible\r\n            .text(labelText) // Set the label text to get its bounding box\r\n            .node()\r\n            .getBBox() // Get the bounding box of the text\r\n\r\n        const labelWidth = bbox.width\r\n        const labelHeight = bbox.height\r\n\r\n        // Remove the temporary text element after getting the bounding box\r\n        container.select('text[visibility=\"hidden\"]').remove()\r\n\r\n        // Calculate the position of the rectangle to be centered on the text\r\n        const x = -labelWidth / 2 - paddingX // Center the rect horizontally\r\n        const y = -labelHeight / 2 - paddingY // Center the rect vertically\r\n\r\n        // Append rectangle with padding\r\n        container\r\n            .append('rect')\r\n            .attr('x', x) // Position rect horizontally\r\n            .attr('y', y) // Position rect vertically\r\n            .attr('width', labelWidth + 2 * paddingX) // Width of the rect with padding\r\n            .attr('height', labelHeight + 2 * paddingY) // Height of the rect with padding\r\n            .attr('class', 'em-label-background')\r\n    }\r\n\r\n    //add shadows to labels\r\n    if (map.labels_?.shadows) {\r\n        map.svg_\r\n            .selectAll('g.em-stat-label-shadow')\r\n            .filter((rg) => filterFunction(rg, map))\r\n            .append('text')\r\n            .text((d) => statLabelsTextFunction(d, statData, map)) // Use 'd' directly for the label text)\r\n    }\r\n    return map\r\n}\r\n\r\n/**\r\n * @description text function for statistical labelling\r\n * @param {Object} d d3 selection json data element\r\n * @return {string}\r\n */\r\nexport const statLabelsTextFunction = (d, statData, map) => {\r\n    if (statData && statData?.get) {\r\n        const sv = statData.get(d.properties.id)\r\n        if (!sv || (!sv.value && sv !== 0 && sv.value !== 0)) {\r\n            return ''\r\n        } else {\r\n            if (sv.value !== ':') {\r\n                return map._statLabelFormatter ? map._statLabelFormatter(sv.value) : spaceAsThousandSeparator(sv.value)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @description function for filtering statistical labels\r\n * @param {Object} d d3 selection json data element\r\n * @return {boolean}\r\n */\r\nconst defaultStatLabelFilter = (region, map) => {\r\n    const s = map.statData()\r\n    const sv = s.get(region.properties.id)\r\n    if (!sv || (!sv.value && sv !== 0 && sv.value !== 0)) {\r\n        return false\r\n    } else {\r\n        return true\r\n    }\r\n}\r\n\r\nconst appendStatLabelCentroidsToMap = function (map, labelsContainer) {\r\n    //values label shadows parent <g>\r\n    // create or reuse container\r\n    const gsls = ensureGroup(labelsContainer, 'em-stat-labels-shadows');\r\n\r\n    // values labels parent <g>\r\n    const statLabelsGroup = ensureGroup(labelsContainer, 'em-stat-labels');\r\n\r\n    // our features array\r\n    let statLabelRegions = map.Geometries.getAllRegionFeatures()\r\n    \r\n\r\n    //TODO: dont add labels for regions that are not visible? what about panning and zooming though. Only really an issue for mixed NUTS.\r\n\r\n    // stats labels\r\n    const filteredRegions = statLabelRegions.filter((d, i, self) => i === self.findIndex((t) => t.properties.id === d.properties.id))\r\n    statLabelsGroup\r\n        .selectAll('g')\r\n        .data(filteredRegions)\r\n        .enter()\r\n        .append('g')\r\n        .attr('transform', function (d) {\r\n            // use predefined label positioning\r\n            if (map.labels_.statLabelsPositions[d.properties.id]) {\r\n                const position = map.labels_.statLabelsPositions[d.properties.id]\r\n                let pos = map._projection([position.x, position.y])\r\n                let x = pos[0].toFixed(3)\r\n                let y = pos[1].toFixed(3)\r\n                return `translate(${x},${y})`\r\n            } else {\r\n                let centroid = map._pathFunction.centroid(d)\r\n\r\n                if (map.labels_.processValueLabelCentroids) {\r\n                    centroid = map.labels_.processValueLabelCentroids(d, centroid)\r\n                }\r\n                // otherwise we calculate centroids\r\n                return 'translate(' + centroid + ')'\r\n            }\r\n        })\r\n        .attr('class', 'em-stat-label')\r\n\r\n    // stat labels shadows\r\n    if (map.labels_?.shadows) {\r\n        gsls.selectAll('g')\r\n            .data(statLabelRegions)\r\n            .enter()\r\n            .append('g')\r\n            .attr('transform', function (d) {\r\n                // use predefined label positioning\r\n                if (map.labels_.statLabelsPositions[d.properties.id]) {\r\n                    let pos = map._projection([\r\n                        map.labels_.statLabelsPositions[d.properties.id].x,\r\n                        map.labels_.statLabelsPositions[d.properties.id].y,\r\n                    ])\r\n                    let x = pos[0].toFixed(3)\r\n                    let y = pos[1].toFixed(3)\r\n                    return `translate(${x},${y})`\r\n                } else {\r\n                    let centroid = map._pathFunction.centroid(d)\r\n\r\n                    if (map.labels_.processValueLabelCentroids) {\r\n                        centroid = map.labels_.processValueLabelCentroids(d, centroid)\r\n                    }\r\n                    // otherwise we calculate centroids\r\n                    return 'translate(' + centroid + ')'\r\n                }\r\n            })\r\n\r\n            .attr('class', 'em-stat-label-shadow')\r\n    }\r\n}\r\n\r\n/**\r\n * Default labels for country / geographical names.\r\n * Using centroids would clash with proportional symbols, and are generally not ideal placements, so labels are positioned independently\r\n * Labels are provided for all supported languages: \"en\",\"fr\" and \"de\" (defined using map.language())\r\n */\r\nexport const DEFAULTLABELS = {\r\n    EUR_3035: {\r\n        cc: [\r\n            { text: 'AL', x: 5150000, y: 2060000, class: 'cc', size: 7 },\r\n            { text: 'AT', x: 4670000, y: 2690000, class: 'cc', size: 18 },\r\n            { text: 'BE', x: 3930000, y: 3010000, class: 'cc', size: 17 },\r\n            { text: 'BG', x: 5567000, y: 2250000, class: 'cc', size: 22 },\r\n            { text: 'HR', x: 4840000, y: 2480000, class: 'cc', size: 10 },\r\n            { text: 'CY', x: 6426000, y: 1480000, class: 'cc', size: 10 },\r\n            { text: 'CZ', x: 4707000, y: 2920000, class: 'cc', size: 18 },\r\n            { text: 'DK', x: 4316000, y: 3621000, class: 'cc', size: 20 },\r\n            { text: 'EE', x: 5220000, y: 3990000, class: 'cc', size: 12 },\r\n            { text: 'FI', x: 5150000, y: 4424000, class: 'cc', size: 20 },\r\n            { text: 'FR', x: 3767740, y: 2662817, class: 'cc', size: 22 },\r\n            { text: 'DE', x: 4347284, y: 3093276, class: 'cc', size: 22 },\r\n            { text: 'EL', x: 5370000, y: 1750000, class: 'cc', size: 22 },\r\n            { text: 'HU', x: 5020000, y: 2630000, class: 'cc', size: 17 },\r\n            { text: 'IS', x: 3040000, y: 4833000, class: 'cc', size: 10 },\r\n            { text: 'IE', x: 3136000, y: 3394000, class: 'cc', size: 17 },\r\n            { text: 'IT', x: 4469967, y: 2181963, class: 'cc', size: 22 },\r\n            { text: 'LV', x: 5290000, y: 3800000, class: 'cc', size: 12 },\r\n            { text: 'LT', x: 5190000, y: 3630000, class: 'cc', size: 12 },\r\n            { text: 'LU', x: 4120000, y: 2940000, class: 'cc', size: 12 },\r\n            { text: 'MT', x: 4731000, y: 1300000, class: 'cc', size: 10 },\r\n            { text: 'ME', x: 5073000, y: 2185000, class: 'cc', size: 7 },\r\n            { text: 'GE', x: 6942680, y: 2660000, class: 'cc' },\r\n            { text: 'UA', x: 5890000, y: 3050000, class: 'cc' },\r\n            { text: 'BA', x: 4949262, y: 2338688, class: 'cc' },\r\n            { text: 'MD', x: 5740000, y: 2790000, class: 'cc' },\r\n\r\n            { text: 'MK', x: 5300000, y: 2080000, class: 'cc', size: 10 },\r\n            { text: 'NL', x: 4020000, y: 3208000, class: 'cc', size: 17 },\r\n            { text: 'NO', x: 4300000, y: 4147000, class: 'cc', size: 20 },\r\n            { text: 'PL', x: 4964000, y: 3200000, class: 'cc', size: 22 },\r\n            { text: 'PT', x: 2770000, y: 1990000, class: 'cc', size: 18 },\r\n            { text: 'RO', x: 5451000, y: 2600000, class: 'cc', size: 22 },\r\n            { text: 'RS', x: 5200000, y: 2350000, class: 'cc', size: 10 },\r\n            { text: 'SK', x: 5040000, y: 2860000, class: 'cc', size: 12 },\r\n            { text: 'SI', x: 4675000, y: 2500000, class: 'cc', size: 10 },\r\n            { text: 'ES', x: 3160096, y: 1900000, class: 'cc', size: 22 },\r\n            { text: 'SE', x: 4630000, y: 4000000, class: 'cc', size: 20 },\r\n            { text: 'CH', x: 4170000, y: 2600000, class: 'cc', size: 16 },\r\n            { text: 'TR', x: 6510000, y: 2100000, class: 'cc', size: 22 },\r\n            { text: 'UK', x: 3558000, y: 3250000, class: 'cc', size: 17 },\r\n        ],\r\n        en: [\r\n            { text: 'MEDITERRANEAN SEA', x: 3980000, y: 1600000, class: 'seas', size: 12, letterSpacing: 7 },\r\n            { text: 'ATLANTIC OCEAN', x: 2820000, y: 2540000, class: 'seas', size: 12, letterSpacing: 2 },\r\n            { text: 'NORTH SEA', x: 3915000, y: 3700000, class: 'seas', size: 12 },\r\n            { text: 'BALTIC SEA', x: 4900000, y: 3730000, class: 'seas', size: 10, rotate: -50 },\r\n            { text: 'NORWEGIAN SEA', x: 3850000, y: 4800000, class: 'seas', size: 12, letterSpacing: 1 },\r\n            { text: 'BLACK SEA', x: 6300000, y: 2500000, class: 'seas', size: 12, letterSpacing: 4 },\r\n            { text: 'ALBANIA', cc: 'AL', x: 5100000, y: 2060000, class: 'countries', size: 7, rotate: 80 },\r\n            { text: 'AUSTRIA', cc: 'AT', x: 4670000, y: 2629000, class: 'countries', size: 10 },\r\n            { text: 'BELGIUM', cc: 'BE', x: 3900000, y: 3030000, class: 'countries', size: 7, rotate: 30 },\r\n            { text: 'BULGARIA', cc: 'BG', x: 5567000, y: 2256000, class: 'countries', size: 12 },\r\n            { text: 'CROATIA', cc: 'HR', x: 4876000, y: 2455000, class: 'countries', size: 7 },\r\n            { text: 'CYPRUS', cc: 'CY', x: 6426000, y: 1480000, class: 'countries', size: 10 },\r\n            { text: 'CZECHIA', cc: 'CZ', x: 4707000, y: 2885000, class: 'countries', size: 12 },\r\n            { text: 'DENMARK', cc: 'DK', x: 4316000, y: 3621000, class: 'countries', size: 10 },\r\n            { text: 'ESTONIA', cc: 'EE', x: 5220000, y: 3990000, class: 'countries', size: 7 },\r\n            { text: 'FINLAND', cc: 'FI', x: 5150000, y: 4424000, class: 'countries', size: 12 },\r\n            { text: 'FRANCE', cc: 'FR', x: 3767740, y: 2662817, class: 'countries', size: 12 },\r\n            { text: 'GERMANY', cc: 'DE', x: 4347284, y: 3093276, class: 'countries', size: 12 },\r\n            { text: 'GREECE', cc: 'EL', x: 5470000, y: 1860000, class: 'countries', size: 12 },\r\n            { text: 'HUNGARY', cc: 'HU', x: 5020000, y: 2630000, class: 'countries', size: 10 },\r\n            { text: 'ICELAND', cc: 'IS', x: 3040000, y: 4833000, class: 'countries', size: 10 },\r\n            { text: 'IRELAND', cc: 'IE', x: 3136000, y: 3394000, class: 'countries', size: 10 },\r\n            { text: 'ITALY', cc: 'IT', x: 4469967, y: 2181963, class: 'countries', size: 12 },\r\n            { text: 'LATVIA', cc: 'LV', x: 5290000, y: 3800000, class: 'countries', size: 7 },\r\n            { text: 'LITHUANIA', cc: 'LT', x: 5190000, y: 3630000, class: 'countries', size: 7 },\r\n            { text: 'LUX.', cc: 'LU', x: 4120000, y: 2940000, class: 'countries', size: 7 },\r\n            { text: 'MALTA', cc: 'MT', x: 4731000, y: 1330000, class: 'countries', size: 7 },\r\n            { text: 'MONT.', cc: 'ME', x: 5073000, y: 2185000, class: 'countries', size: 7 },\r\n            { text: 'N. MACEDONIA', cc: 'MK', x: 5300000, y: 2082000, class: 'countries', size: 7 },\r\n            { text: 'NETHERLANDS', cc: 'NL', x: 3977000, y: 3208000, class: 'countries', size: 7 },\r\n            { text: 'NORWAY', cc: 'NO', x: 4330000, y: 4147000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'POLAND', cc: 'PL', x: 4964000, y: 3269000, class: 'countries', size: 12 },\r\n            { text: 'PORTUGAL', cc: 'PT', x: 2830000, y: 1990000, class: 'countries', size: 10, rotate: -75 },\r\n            { text: 'ROMANIA', cc: 'RO', x: 5451000, y: 2600000, class: 'countries', size: 12 },\r\n            { text: 'SERBIA', cc: 'RS', x: 5200000, y: 2300000, class: 'countries', size: 7 },\r\n            { text: 'SLOVAKIA', cc: 'SK', x: 5040000, y: 2835000, class: 'countries', size: 7, rotate: -30 },\r\n            { text: 'SLOVENIA', cc: 'SI', x: 4735000, y: 2522000, class: 'countries', size: 7, rotate: -30 },\r\n            { text: 'SPAIN', cc: 'ES', x: 3160096, y: 1850000, class: 'countries', size: 12 },\r\n            { text: 'SWEDEN', cc: 'SE', x: 4630000, y: 4100000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'SWITZERLAND', cc: 'CH', x: 4200000, y: 2564000, class: 'countries', size: 7 },\r\n            { text: 'TRKIYE', cc: 'TR', x: 6510000, y: 2100000, class: 'countries', size: 12 },\r\n            { text: 'U.K.', cc: 'UK', x: 3558000, y: 3250000, class: 'countries', size: 12 },\r\n            { text: 'UKRAINE', cc: 'UA', x: 5890000, y: 3050000, class: 'countries' },\r\n        ],\r\n        fr: [\r\n            { text: 'MER MDITERRANE', x: 5472000, y: 1242000, class: 'seas', size: 12 },\r\n            { text: 'OCAN ATLANTIQUE', x: 2820000, y: 2540000, class: 'seas', size: 12 },\r\n            { text: 'MER DU NORD', x: 3915000, y: 3700000, class: 'seas', size: 12 },\r\n            { text: 'MER BALTIQUE', x: 4900000, y: 3672000, class: 'seas', size: 10, rotate: -50 },\r\n            { text: 'MER DE NORVGE', x: 3850000, y: 4800000, class: 'seas', size: 12 },\r\n            { text: 'MER NOIRE', x: 6265000, y: 2472000, class: 'seas', size: 12 },\r\n            { text: 'ALBANIE', x: 5100000, y: 2060000, class: 'countries', size: 7, rotate: 80 },\r\n            { text: 'AUTRICHE', x: 4670000, y: 2629000, class: 'countries', size: 10 },\r\n            { text: 'BELGIQUE', x: 3900000, y: 3030000, class: 'countries', size: 7, rotate: 30 },\r\n            { text: 'BULGARIE', x: 5567000, y: 2256000, class: 'countries', size: 12 },\r\n            { text: 'CROATIE', x: 4876000, y: 2455000, class: 'countries', size: 7 },\r\n            { text: 'CHYPRE', x: 6426000, y: 1480000, class: 'countries', size: 10 },\r\n            { text: 'TCHQUIE', x: 4707000, y: 2885000, class: 'countries', size: 12 },\r\n            { text: 'DANEMARK', x: 4316000, y: 3621000, class: 'countries', size: 10 },\r\n            { text: 'ESTONIE', x: 5220000, y: 3990000, class: 'countries', size: 10 },\r\n            { text: 'FINLANDE', x: 5125000, y: 4424000, class: 'countries', size: 12 },\r\n            { text: 'FRANCE', x: 3767740, y: 2662817, class: 'countries', size: 12 },\r\n            { text: 'ALLEMAGNE', x: 4347284, y: 3093276, class: 'countries', size: 12 },\r\n            { text: 'GRCE', x: 5420000, y: 1860000, class: 'countries', size: 12 },\r\n            { text: 'HONGRIE', x: 5020000, y: 2654000, class: 'countries', size: 10 },\r\n            { text: 'ISLANDE', x: 3040000, y: 4833000, class: 'countries', size: 10 },\r\n            { text: 'IRLANDE', x: 3136000, y: 3394000, class: 'countries', size: 10 },\r\n            { text: 'ITALIE', x: 4500000, y: 2181963, class: 'countries', size: 12 },\r\n            { text: 'LETTONIE', x: 5290000, y: 3776000, class: 'countries', size: 10 },\r\n            { text: 'LITUANIE', x: 5190000, y: 3630000, class: 'countries', size: 10 },\r\n            { text: 'LUX.', x: 4120000, y: 2940000, class: 'countries', size: 7 },\r\n            { text: 'MALTE', x: 4731000, y: 1335000, class: 'countries', size: 7 },\r\n            { text: 'MONT.', x: 5073000, y: 2185000, class: 'countries', size: 7 },\r\n            { text: 'MAC. DU NORD', x: 5300000, y: 2082000, class: 'countries', size: 7 },\r\n            { text: 'PAYS-BAS', x: 3977000, y: 3208000, class: 'countries', size: 7 },\r\n            { text: 'NORVEGE', x: 4330000, y: 4147000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'POLOGNE', x: 4964000, y: 3269000, class: 'countries', size: 12 },\r\n            { text: 'PORTUGAL', x: 2836136, y: 1956179, class: 'countries', size: 10, rotate: -75 },\r\n            { text: 'ROUMANIE', x: 5451000, y: 2600000, class: 'countries', size: 12 },\r\n            { text: 'SERBIE', x: 5200000, y: 2300000, class: 'countries', size: 7 },\r\n            { text: 'SLOVAQUIE', x: 5040000, y: 2835000, class: 'countries', size: 7, rotate: -30 },\r\n            { text: 'SLOVNIE', x: 4735000, y: 2522000, class: 'countries', size: 7, rotate: -35 },\r\n            { text: 'ESPAGNE', x: 3160096, y: 1850000, class: 'countries', size: 12 },\r\n            { text: 'SUDE', x: 4700000, y: 4401000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'SUISSE', x: 4200000, y: 2564000, class: 'countries', size: 7 },\r\n            { text: 'TURQUIE', x: 6510000, y: 2100000, class: 'countries', size: 12 },\r\n            { text: 'ROYAUME-UNI', x: 3558000, y: 3250000, class: 'countries', size: 10 },\r\n        ],\r\n        de: [\r\n            { text: 'MITTELMEER', x: 5472000, y: 1200000, class: 'seas', size: 12, letterSpacing: 7 },\r\n            { text: 'ATLANTISCHER OZEAN', x: 2820000, y: 2540000, class: 'seas', size: 12 },\r\n            { text: 'NORDSEE', x: 3915000, y: 3700000, class: 'seas', size: 12 },\r\n            { text: 'OSTSEE', x: 4900000, y: 3672000, class: 'seas', size: 10, rotate: -50 },\r\n            { text: 'NORWEGISCHE MEER', x: 3850000, y: 4800000, class: 'seas', size: 12 },\r\n            { text: 'SCHWARZE MEER', x: 6300000, y: 2500000, class: 'seas', size: 12, letterSpacing: 1 },\r\n            { text: 'ALBANIEN', x: 5100000, y: 2060000, class: 'countries', size: 7, rotate: 80 },\r\n            { text: 'STERREICH', x: 4650000, y: 2629000, class: 'countries', size: 7 },\r\n            { text: 'BELGIEN', x: 3900000, y: 3030000, class: 'countries', size: 7, rotate: 30 },\r\n            { text: 'BULGARIEN', x: 5567000, y: 2256000, class: 'countries', size: 10 },\r\n            { text: 'KROATIEN', x: 4876000, y: 2455000, class: 'countries', size: 7 },\r\n            { text: 'ZYPERN', x: 6426000, y: 1480000, class: 'countries', size: 10 },\r\n            { text: 'TSCHECHIEN', x: 4707000, y: 2885000, class: 'countries', size: 7 },\r\n            { text: 'DNEMARK', x: 4316000, y: 3621000, class: 'countries', size: 10 },\r\n            { text: 'ESTLAND', x: 5220000, y: 3990000, class: 'countries', size: 7 },\r\n            { text: 'FINNLAND', x: 5150000, y: 4424000, class: 'countries', size: 12 },\r\n            { text: 'FRANKREICH', x: 3767740, y: 2662817, class: 'countries', size: 12 },\r\n            { text: 'DEUTSCHLAND', x: 4347284, y: 3093276, class: 'countries', size: 10 },\r\n            { text: 'GRIECHENLAND', x: 5550000, y: 1500000, class: 'countries', size: 10 },\r\n            { text: 'UNGARN', x: 5020000, y: 2630000, class: 'countries', size: 10 },\r\n            { text: 'ISLAND', x: 3040000, y: 4833000, class: 'countries', size: 10 },\r\n            { text: 'IRLAND', x: 3136000, y: 3394000, class: 'countries', size: 10 },\r\n            { text: 'ITALIEN', x: 4469967, y: 2181963, class: 'countries', size: 12, rotate: 35 },\r\n            { text: 'LETTLAND', x: 5290000, y: 3800000, class: 'countries', size: 7 },\r\n            { text: 'LITAUEN', x: 5190000, y: 3630000, class: 'countries', size: 7 },\r\n            { text: 'LUX.', x: 4120000, y: 2940000, class: 'countries', size: 7 },\r\n            { text: 'MALTA', x: 4731000, y: 1330000, class: 'countries', size: 7 },\r\n            { text: 'MONT.', x: 5073000, y: 2185000, class: 'countries', size: 7 },\r\n            { text: 'NORDMAZEDONIEN', x: 5350000, y: 2082000, class: 'countries', size: 7 },\r\n            { text: 'NIEDERLANDE', x: 3977000, y: 3208000, class: 'countries', size: 7 },\r\n            { text: 'NORWEGEN', x: 4330000, y: 4147000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'POLEN', x: 4964000, y: 3269000, class: 'countries', size: 12 },\r\n            { text: 'PORTUGAL', x: 2836136, y: 1956179, class: 'countries', size: 10, rotate: -75 },\r\n            { text: 'RUMNIEN', x: 5451000, y: 2600000, class: 'countries', size: 12 },\r\n            { text: 'SERBIEN', x: 5200000, y: 2300000, class: 'countries', size: 7 },\r\n            { text: 'SLOWAKEI', x: 5040000, y: 2835000, class: 'countries', size: 7, rotate: -30 },\r\n            { text: 'SLOWENIEN', x: 4735000, y: 2522000, class: 'countries', size: 7, rotate: -30 },\r\n            { text: 'SPANIEN', x: 3160096, y: 1850000, class: 'countries', size: 12 },\r\n            { text: 'SCHWEDEN', x: 4670000, y: 4180000, class: 'countries', size: 12, rotate: -75 },\r\n            { text: 'SCHWEIZ', x: 4200000, y: 2564000, class: 'countries', size: 7 },\r\n            { text: 'TRUTHAHN', x: 6510000, y: 2100000, class: 'countries', size: 12 },\r\n            { text: 'VEREINIGTES', x: 3550000, y: 3520000, class: 'countries', size: 10 },\r\n            { text: 'KNIGREICH', x: 3550000, y: 3420000, class: 'countries', size: 10 },\r\n        ],\r\n    },\r\n    IC_32628: {\r\n        cc: [{ text: 'ES', x: 420468, y: 3180647, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Canary Islands', x: 420468, y: 3180647, class: 'countries', size: 12 }],\r\n        fr: [{ text: 'Les les Canaries', x: 420468, y: 3180647, class: 'countries', size: 12 }],\r\n        de: [{ text: 'Kanarische Inseln', x: 410000, y: 3180647, class: 'countries', size: 12 }],\r\n    },\r\n    GP_32620: {\r\n        cc: [{ text: 'FR', x: 667000, y: 1740000, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Guadeloupe', x: 700000, y: 1810000, class: 'countries', size: 12 }],\r\n    },\r\n    MQ_32620: {\r\n        cc: [{ text: 'FR', x: 716521, y: 1621322, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Martinique', x: 716521, y: 1621322, class: 'countries', size: 12 }],\r\n    },\r\n    GF_32622: {\r\n        cc: [{ text: 'FR', x: 266852, y: 444074, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Guyane', x: 266852, y: 444074, class: 'countries', size: 12 }],\r\n        de: [{ text: 'Guayana', x: 266852, y: 444074, class: 'countries', size: 12 }],\r\n    },\r\n    RE_32740: {\r\n        cc: [{ text: 'FR', x: 348011, y: 7680000, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Runion', x: 348011, y: 7680000, class: 'countries', size: 10 }],\r\n    },\r\n    YT_32738: {\r\n        cc: [{ text: 'FR', x: 516549, y: 8593920, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Mayotte', x: 516549, y: 8593920, class: 'countries', size: 10 }],\r\n    },\r\n    MT_3035: {\r\n        cc: [{ text: 'MT', x: 4719755, y: 1410701, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Malta', x: 4719755, y: 1410701, class: 'countries', size: 10 }],\r\n    },\r\n    PT20_32626: {\r\n        cc: [{ text: 'PT', x: 397418, y: 4320000, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Azores', x: 397418, y: 4320000, class: 'countries', size: 10 }],\r\n        fr: [{ text: 'Aores', x: 397418, y: 4271471, class: 'countries', size: 10 }],\r\n        de: [{ text: 'Azoren', x: 397418, y: 4271471, class: 'countries', size: 10 }],\r\n    },\r\n    PT30_32628: {\r\n        cc: [{ text: 'PT', x: 333586, y: 3624000, class: 'cc', size: 10, rotate: 30 }],\r\n        en: [{ text: 'Madeira', x: 333586, y: 3624000, class: 'countries', size: 10, rotate: 30 }],\r\n        fr: [{ text: 'Madre', x: 333586, y: 3624000, class: 'countries', size: 10, rotate: 30 }],\r\n    },\r\n    LI_3035: {\r\n        cc: [{ text: 'LI', x: 4287060, y: 2660000, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Liechtenstein', x: 4287060, y: 2679000, class: 'countries', size: 7 }],\r\n    },\r\n    IS_3035: {\r\n        cc: [{ text: 'IS', x: 3011804, y: 4960000, class: 'cc', size: 12 }],\r\n        en: [{ text: 'Iceland', x: 3011804, y: 4960000, class: 'countries', size: 12 }],\r\n        fr: [{ text: 'Islande', x: 3011804, y: 4960000, class: 'countries', size: 12 }],\r\n        de: [{ text: 'Island', x: 3011804, y: 4960000, class: 'countries', size: 12 }],\r\n    },\r\n    SJ_SV_3035: {\r\n        cc: [{ text: 'NO', x: 4570000, y: 6260000, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Svalbard', x: 4570000, y: 6260000, class: 'countries', size: 10 }],\r\n        de: [{ text: 'Spitzbergen', x: 4570000, y: 6260000, class: 'countries', size: 7 }],\r\n    },\r\n    SJ_JM_3035: {\r\n        cc: [{ text: 'NO', x: 3647762, y: 5420300, class: 'cc', size: 10 }],\r\n        en: [{ text: 'Jan Mayen', x: 3647762, y: 5420300, class: 'countries', size: 7 }],\r\n    },\r\n    CARIB_32620: {\r\n        cc: [\r\n            { text: 'FR', x: 700000, y: 1810000, class: 'cc', size: 10 },\r\n            { text: 'FR', x: 640000, y: 1590000, class: 'cc', size: 10 },\r\n            { text: 'FR', x: 540000, y: 1962000, class: 'cc', size: 7 },\r\n        ],\r\n        en: [\r\n            { text: 'Guadeloupe', x: 700000, y: 1810000, class: 'countries', size: 10 },\r\n            { text: 'Martinique', x: 570000, y: 1590000, class: 'countries', size: 10 },\r\n            { text: 'Saint Martin', x: 597000, y: 1962000, class: 'countries', size: 7 },\r\n        ],\r\n    },\r\n    // note: WORLD x/y are in EPSG:4326 then reprojected by d3 to EPSG:54030\r\n    WORLD_54030: {\r\n        en: [\r\n            { text: 'NORTH ATLANTIC', x: -45, y: 25, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'SOUTH ATLANTIC', x: -15, y: -25, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'SOUTH PACIFIC', x: -126, y: -25, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'NORTH', x: -136, y: 25, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'PACIFIC', x: -134, y: 20, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'INDIAN OCEAN', x: 80, y: -25, class: 'seas', size: 10, letterSpacing: 1 },\r\n            { text: 'SOUTHERN OCEAN', x: -5, y: -67, class: 'seas', size: 10, letterSpacing: 6 },\r\n        ],\r\n    },\r\n}\r\n\r\nconst DEFAULTSTATLABELPOSITIONS = {\r\n    AL: { x: 5150000, y: 2000000 },\r\n    AT: { x: 4670000, y: 2740000 },\r\n    BE: { x: 3930000, y: 3060000 },\r\n    BG: { x: 5567000, y: 2300000 },\r\n    HR: { x: 4657718, y: 2400243 },\r\n    CY: { x: 6426000, y: 1570000 },\r\n    CH: { x: 4170000, y: 2600000 },\r\n    CZ: { x: 4707000, y: 2950000 },\r\n    DK: { x: 4316000, y: 3621000 },\r\n    EE: { x: 5220000, y: 4050000 },\r\n    FI: { x: 5150000, y: 4424000 },\r\n    FR: { x: 3767740, y: 2662817 },\r\n    DE: { x: 4347284, y: 3093276 },\r\n    EL: { x: 5370000, y: 1750000 },\r\n    HU: { x: 5020000, y: 2670000 },\r\n    IS: { x: 3040000, y: 4833000 },\r\n    IE: { x: 3136000, y: 3394000 },\r\n    IT: { x: 4500000, y: 2181963 },\r\n    LV: { x: 5290000, y: 3840000 },\r\n    LT: { x: 5190000, y: 3670000 },\r\n    LU: { x: 4120000, y: 2940000 },\r\n    MT: { x: 4880000, y: 1480000 },\r\n    GE: { x: 6912680, y: 2696554 },\r\n    UA: { x: 5865507, y: 3130158 },\r\n    BA: { x: 4959262, y: 2368688 },\r\n    MD: { x: 5736016, y: 2835957 },\r\n    ME: { x: 5073000, y: 2230000 },\r\n    MK: { x: 5300000, y: 2130000 },\r\n    NL: { x: 4020000, y: 3208000 },\r\n    NO: { x: 4300000, y: 4147000 },\r\n    PL: { x: 4964000, y: 3200000 },\r\n    PT: { x: 2760000, y: 1990000 },\r\n    RO: { x: 5451000, y: 2600000 },\r\n    RS: { x: 5200000, y: 2370000 },\r\n    SK: { x: 5040000, y: 2890000 },\r\n    SI: { x: 4660000, y: 2550000 },\r\n    ES: { x: 3200000, y: 2000000 },\r\n    SE: { x: 4630000, y: 4000000 },\r\n    TR: { x: 6510000, y: 2100000 },\r\n    UK: { x: 3558000, y: 3250000 },\r\n    RU: { x: 6842086, y: 3230517 },\r\n}\r\n","function responseJson(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  if (response.status === 204 || response.status === 205) return;\n  return response.json();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseJson);\n}\n","export default function(x) {\n  return x;\n}\n","import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\n\nexport default function(topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","import identity from \"./identity.js\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","// mixed nuts dont draw nutsbn so we add them manually\r\nexport const kosovoBnFeatures = {\r\n  2021:{\r\n    3035: {\r\n      '03M':{\"type\":\"Topology\",\"arcs\":[[[3061,1303],[-152,-59],[-32,-66],[-65,72],[-96,7],[-16,59],[-64,19],[-56,-39],[-120,39],[-184,-19],[-16,26],[32,52],[-16,72],[24,40],[8,183]],[[2885,0],[-8,46],[-65,85],[-40,-7],[-40,40],[0,111],[80,13],[25,46],[72,13],[40,98],[-56,118],[144,196],[-24,79],[88,59],[-24,98],[-8,20],[24,39],[8,52],[48,72],[-88,125]],[[825,2638],[-112,-98],[-72,-7],[-88,-118],[-176,-39],[56,-91],[88,-33],[24,-53],[56,-39],[24,-91],[-56,-46],[24,-105],[-56,-92],[-104,0],[-48,-104],[-16,-40],[-57,7],[-40,-53],[-16,-78],[113,-118],[-97,-65],[-88,-99],[-80,20],[-80,-39],[-24,-13]],[[1098,2304],[-193,66],[24,39],[-16,39],[65,13],[0,33],[-65,79],[-88,65]],[[2308,1689],[-153,-20],[-64,59],[-40,7],[-96,-27],[-104,138],[-8,92],[-32,78],[-64,26],[-32,-59],[-24,0],[-56,86],[-40,137],[-25,65],[-56,0],[-56,46],[-64,-72],[-120,53],[-88,-40],[-88,46]]],\"transform\":{\"scale\":[37.761044752777565,38.54734205626113],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":1000004,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":1000005,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":1000001,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":1000002,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":1000003,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '10M':{\"type\":\"Topology\",\"arcs\":[[[962,0],[-29,75],[48,131],[21,35],[11,38],[32,117],[-24,44]],[[1021,440],[-64,-29],[-70,36],[-120,2],[3,121]],[[770,570],[-126,16],[-40,91],[-45,4],[-51,93],[-142,4]],[[275,891],[-131,-99],[30,-36],[24,-31],[-6,-86],[-98,-86],[13,-64],[-27,-38],[-80,-31]],[[366,778],[-37,22],[-54,91]]],\"transform\":{\"scale\":[113.2099448513097,114.12782081303801],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":1000005,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":1000004,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":1000003,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":1000001,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":1000002,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}}]}}},\r\n      '20M':{\"type\":\"Topology\",\"arcs\":[[[536,0],[-24,45],[15,30],[45,92],[-1,44],[-2,37]],[[569,248],[-130,9],[-10,64]],[[429,321],[-64,10],[-78,94],[-83,13]],[[153,502],[-73,-51],[26,-84],[-48,-53],[-3,-52],[-55,-25]],[[204,438],[-51,64]]],\"transform\":{\"scale\":[203.12309601494124,202.56551463031246],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":1000005,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":1000004,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":1000003,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":1000001,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":1000002,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}}]}}},\r\n      '60M':{\"type\":\"Topology\",\"arcs\":[[[310,138],[-36,-2],[-40,42]],[[234,178],[-123,65]],[[84,278],[-84,-147]],[[111,243],[-27,35]],[[292,0],[18,138]]],\"transform\":{\"scale\":[372.84281730215633,364.87611898580536],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":1000004,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":1000003,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":1000001,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":1000002,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":1000005,\"lvl\":1,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"T\",\"co\":\"F\"}}]}}}\r\n    },\r\n    4326: {\r\n      '03M':{\"type\":\"Topology\",\"arcs\":[[[1900,1275],[-30,27],[-27,-13],[-34,23],[-87,6],[25,59],[1,70],[20,34],[24,167]],[[1792,1648],[-116,1],[-62,77],[-89,-8],[-60,148],[7,86],[-4,15],[-13,60],[-45,28],[-33,-48],[-26,4],[-31,142],[-11,53],[5,43],[-19,44],[-39,8],[-40,49],[-52,-59],[-93,71],[-38,-6],[-16,-26]],[[945,2388],[-54,27],[-20,28],[-22,-3],[-17,22],[-25,1],[-10,10],[4,17],[27,14],[-15,29],[1,16],[68,1],[-8,16],[-5,30],[-14,29],[-27,42],[-25,22],[-30,41]],[[773,2730],[-89,-69],[-64,-4],[-82,-92],[-133,-15],[27,-93],[64,-43],[16,-50],[38,-44],[9,-75],[-48,-51],[5,-41],[6,-50],[-52,-84],[-78,14],[-35,-66],[-33,-61],[-45,11],[-35,-42],[-18,-72],[33,-71],[48,-55]],[[1017,2330],[-72,58]],[[307,1677],[-36,-12],[-25,-21],[-26,-10],[-76,-90],[-17,4],[-30,31],[-52,-14],[-26,-23],[-19,1]],[[2319,1185],[-116,-32],[-39,-52],[-42,70],[-68,23],[-12,58],[-43,23],[-42,-23],[-57,23]],[[2044,0],[-4,43],[-38,82],[-34,9],[-24,43],[13,97],[61,4],[32,41],[49,0],[37,82],[-26,118],[130,167],[-8,73],[74,46],[-2,18],[-9,92],[24,35],[7,49],[48,52],[-55,134]]],\"transform\":{\"scale\":[0.0006038339283908974,0.00036983475567765975],\"translate\":[20.35292839300007,42.26281764300006]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000002,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000001,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000003,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000004,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000005,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000006,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000007,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000008,\"co\":\"F\",\"oth\":\"F\",}}]}}},\r\n      '10M':{\"type\":\"Topology\",\"arcs\":[[[659,439],[-54,17],[17,111]],[[622,567],[-93,31],[-25,92],[-36,11],[-29,97],[-23,1],[-63,3]],[[328,822],[-33,74],[-27,44]],[[268,940],[-72,-44],[-38,-31],[27,-86],[-14,-65],[-81,-78],[16,-58]],[[353,802],[-25,20]],[[106,578],[-41,-19],[-65,-28]],[[805,408],[-54,-21],[-92,52]],[[709,0],[-22,72],[0,17],[40,36],[18,67],[53,101],[16,64],[-9,51]]],\"transform\":{\"scale\":[0.001740521547911524,0.0010740945563829907],\"translate\":[20.35292839300007,42.26281764300006]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000002,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000003,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000004,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000005,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000006,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000007,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000001,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000008,\"co\":\"F\",\"oth\":\"F\",}}]}}},\r\n      '20M':{\"type\":\"Topology\",\"arcs\":[[[380,252],[-21,26],[0,48]],[[359,326],[-49,17],[-56,107],[-51,11]],[[189,472],[-34,68]],[[155,540],[-66,-39],[18,-66],[-54,-68],[8,-35]],[[61,332],[-21,-13],[-10,-12],[-13,5],[-17,-7]],[[464,234],[-84,18]],[[409,0],[-14,46],[61,110],[8,78]]],\"transform\":{\"scale\":[0.003018276831896498,0.0018697201537037245],\"translate\":[20.35292839300007,42.26281764300006]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000002,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000003,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000004,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000005,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000007,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000001,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000008,\"co\":\"F\",\"oth\":\"F\",}}]}}},\r\n      '60M':{\"type\":\"Topology\",\"arcs\":[[[235,156],[-13,46]],[[222,202],[-96,84]],[[117,293],[-21,42]],[[96,335],[-58,-129]],[[126,286],[-9,7]],[[38,206],[-38,-17]],[[287,145],[-52,11]],[[253,0],[34,145]]],\"transform\":{\"scale\":[0.004879722822299564,0.0030138772626866006],\"translate\":[20.352928393000074,42.26281764300006]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000002,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000003,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000004,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000005,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000006,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000001,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000007,\"co\":\"F\",\"oth\":\"F\",}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"lvl\":0,\"id\":1000008,\"co\":\"F\",\"oth\":\"F\",}}]}}}\r\n    }\r\n  },\r\n  2024:{\r\n    3035: {\r\n      '03M':{\"type\":\"Topology\",\"arcs\":[[[728,1508],[-48,12],[-22,18],[-15,-5],[-16,13],[-22,-4],[-10,8],[0,13],[21,13],[-16,17],[0,13],[58,9],[-5,8],[-10,22],[-16,17],[-27,25],[-21,13],[-32,26]],[[1912,0],[-6,30],[-42,51],[-32,0],[-21,30],[0,69],[53,8],[21,35],[43,4],[26,60],[-37,81],[96,129],[-16,51],[58,43],[0,9],[-21,64],[16,26],[5,34],[32,43],[-58,85]],[[250,942],[-27,-13],[-21,-17],[-21,-8],[-59,-73],[-16,0],[-26,17],[-43,-13],[-21,-21],[-16,0]],[[1657,861],[-27,13],[-21,-13],[-32,13],[-74,-9],[16,47],[-6,47],[11,26],[5,120]],[[1529,1105],[-100,-17],[-64,47],[-75,-17],[-63,94],[-6,60],[-5,13],[-16,38],[-42,13],[-22,-38],[-21,0],[-42,94],[-16,34],[0,30],[-21,30],[-32,0],[-38,30],[-42,-47],[-85,39],[-32,-9],[-10,-21]],[[547,1726],[-69,-60],[-53,-13],[-59,-73],[-111,-25],[32,-60],[58,-22],[16,-34],[37,-26],[16,-51],[-37,-39],[5,-30],[11,-34],[-37,-64],[-64,4],[-26,-51],[-22,-47],[-42,4],[-21,-34],[-11,-52],[37,-47],[43,-30]],[[797,1478],[-69,30]],[[2029,852],[-96,-38],[-32,-39],[-42,43],[-59,4],[-16,39],[-42,13],[-32,-22],[-53,9]]],\"transform\":{\"scale\":[56.97629608361119,58.91534666536319],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '10M':{\"type\":\"Topology\",\"arcs\":[[[242,508],[-33,47],[-27,27]],[[637,0],[-25,46],[-2,12],[30,29],[7,47],[34,75],[7,45],[-12,33]],[[83,318],[-32,-18],[-51,-26]],[[552,290],[-46,5],[3,78]],[[509,373],[-79,8],[-30,59],[-30,3],[-34,62],[-19,-1],[-52,-6]],[[182,582],[-55,-39],[-28,-25],[30,-56],[-5,-45],[-59,-62],[18,-37]],[[265,498],[-23,10]],[[676,287],[-43,-21],[-81,24]]],\"transform\":{\"scale\":[171.07449827433382,174.72145763645509],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '20M':{\"type\":\"Topology\",\"arcs\":[[[50,191],[-17,-11],[-8,-10],[-11,1],[-14,-6]],[[305,224],[-44,6],[-58,68],[-44,2]],[[109,350],[-52,-36],[21,-45],[-38,-54],[10,-24]],[[159,300],[-14,6]],[[145,306],[-36,44]],[[381,0],[-17,31],[41,85],[-1,57]],[[404,173],[-74,2]],[[330,175],[-20,15],[-5,34]]],\"transform\":{\"scale\":[286.13294356075795,290.536823841191],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '60M':{\"type\":\"Topology\",\"arcs\":[[[258,111],[-47,1]],[[32,123],[-32,-17]],[[211,112],[-16,32]],[[195,144],[-94,49]],[[70,225],[-38,-102]],[[101,193],[-8,4]],[[93,197],[-23,28]],[[243,0],[15,111]]],\"transform\":{\"scale\":[447.98943164212585,451.9461704196305],\"translate\":[5167020.037451873,2202278.5103255166]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}}\r\n    },\r\n    4326: {\r\n      '03M':{\"type\":\"Topology\",\"arcs\":[[[1543,0],[-4,32],[-28,65],[-24,5],[-19,33],[10,70],[47,5],[23,33],[38,0],[28,59],[-19,92],[94,124],[-5,54],[56,37],[0,11],[-9,70],[19,27],[4,38],[38,38],[-42,102]],[[1750,895],[-85,-27],[-32,-37],[-29,54],[-56,16],[-5,43],[-32,16],[-33,-16],[-43,16]],[[1435,960],[-23,22],[-19,-11],[-28,16],[-66,5],[19,44],[0,54],[14,26],[19,125]],[[230,1262],[-24,-5],[-23,-16],[-19,-11],[-56,-65],[-14,0],[-24,27],[-37,-11],[-19,-21],[-14,5]],[[1351,1241],[-84,0],[-47,59],[-71,-6],[-42,114],[5,64],[-5,11],[-9,43],[-33,22],[-24,-38],[-23,6],[-23,108],[-5,37],[0,33],[-14,32],[-28,5],[-29,38],[-42,-43],[-70,54],[-28,-5],[-10,-22]],[[582,2055],[-66,-49],[-47,-5],[-61,-70],[-103,-11],[19,-70],[51,-32],[10,-38],[28,-32],[9,-54],[-37,-44],[4,-26],[5,-38],[-37,-65],[-61,11],[-29,-49],[-23,-48],[-33,11],[-28,-33],[-14,-54],[28,-54],[33,-43]],[[769,1753],[-56,48]],[[713,1801],[-42,17],[-14,21],[-19,0],[-9,16],[-19,0],[-10,6],[5,16],[19,11],[-9,21],[0,11],[51,0],[-5,11],[-4,22],[-10,26],[-23,27],[-19,22],[-23,27]]],\"transform\":{\"scale\":[0.0007994261320208862,0.0004913384355349169],\"translate\":[20.35361768088405,42.262163108155406]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '10M':{\"type\":\"Topology\",\"arcs\":[[[539,0],[-17,52],[0,13],[30,27],[13,48],[41,74],[13,47],[-8,38]],[[611,299],[-41,-16],[-69,37]],[[501,320],[-41,13],[12,81]],[[80,421],[-31,-12],[-49,-20]],[[472,414],[-71,24],[-18,66],[-28,7],[-21,72],[-18,0],[-47,2]],[[203,686],[-54,-32],[-29,-22],[21,-63],[-12,-47],[-60,-57],[11,-44]],[[269,585],[-20,16]],[[249,601],[-25,53],[-21,32]]],\"transform\":{\"scale\":[0.002290098349828638,0.0014718665962452685],\"translate\":[20.35361768088405,42.262163108155406]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '20M':{\"type\":\"Topology\",\"arcs\":[[[337,0],[-12,36],[51,84],[6,62]],[[382,182],[-69,13]],[[313,195],[-17,20],[-1,37]],[[50,256],[-17,-10],[-8,-8],[-11,3],[-14,-5]],[[295,252],[-40,13],[-46,82],[-41,9]],[[127,417],[-54,-30],[15,-51],[-44,-53],[6,-27]],[[168,356],[-12,10]],[[156,366],[-29,51]]],\"transform\":{\"scale\":[0.0036618323062750017,0.0024213440887871805],\"translate\":[20.35361768088405,42.262163108155406]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}},\r\n      '60M':{\"type\":\"Topology\",\"arcs\":[[[220,0],[29,116]],[[249,116],[-45,8]],[[204,124],[-12,37]],[[192,161],[-83,66]],[[109,227],[-8,6]],[[33,163],[-33,-12]],[[83,266],[-50,-103]],[[101,233],[-18,33]]],\"transform\":{\"scale\":[0.005617750767056427,0.003795866485053587],\"translate\":[20.35361768088405,42.262163108155406]},\"objects\":{\"nutsbn_1\":{\"type\":\"GeometryCollection\",\"geometries\":[{\"type\":\"LineString\",\"arcs\":[0],\"properties\":{\"id\":\"1000008\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[1],\"properties\":{\"id\":\"1000007\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[2],\"properties\":{\"id\":\"1000002\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[3],\"properties\":{\"id\":\"1000003\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[4],\"properties\":{\"id\":\"1000006\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[5],\"properties\":{\"id\":\"1000001\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[6],\"properties\":{\"id\":\"1000005\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}},{\"type\":\"LineString\",\"arcs\":[7],\"properties\":{\"id\":\"1000004\",\"lvl\":0,\"eu\":\"F\",\"efta\":\"F\",\"cc\":\"T\",\"oth\":\"F\",\"co\":\"F\"}}]}}}\r\n    }\r\n  }\r\n}","export default function range(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","import {range} from \"d3-array\";\nimport {abs, ceil, epsilon} from \"./math.js\";\n\nfunction graticuleX(y0, y1, dy) {\n  var y = range(y0, y1 - epsilon, dy).concat(y1);\n  return function(x) { return y.map(function(y) { return [x, y]; }); };\n}\n\nfunction graticuleY(x0, x1, dx) {\n  var x = range(x0, x1 - epsilon, dx).concat(x1);\n  return function(y) { return x.map(function(x) { return [x, y]; }); };\n}\n\nexport default function graticule() {\n  var x1, x0, X1, X0,\n      y1, y0, Y1, Y0,\n      dx = 10, dy = dx, DX = 90, DY = 360,\n      x, y, X, Y,\n      precision = 2.5;\n\n  function graticule() {\n    return {type: \"MultiLineString\", coordinates: lines()};\n  }\n\n  function lines() {\n    return range(ceil(X0 / DX) * DX, X1, DX).map(X)\n        .concat(range(ceil(Y0 / DY) * DY, Y1, DY).map(Y))\n        .concat(range(ceil(x0 / dx) * dx, x1, dx).filter(function(x) { return abs(x % DX) > epsilon; }).map(x))\n        .concat(range(ceil(y0 / dy) * dy, y1, dy).filter(function(y) { return abs(y % DY) > epsilon; }).map(y));\n  }\n\n  graticule.lines = function() {\n    return lines().map(function(coordinates) { return {type: \"LineString\", coordinates: coordinates}; });\n  };\n\n  graticule.outline = function() {\n    return {\n      type: \"Polygon\",\n      coordinates: [\n        X(X0).concat(\n        Y(Y1).slice(1),\n        X(X1).reverse().slice(1),\n        Y(Y0).reverse().slice(1))\n      ]\n    };\n  };\n\n  graticule.extent = function(_) {\n    if (!arguments.length) return graticule.extentMinor();\n    return graticule.extentMajor(_).extentMinor(_);\n  };\n\n  graticule.extentMajor = function(_) {\n    if (!arguments.length) return [[X0, Y0], [X1, Y1]];\n    X0 = +_[0][0], X1 = +_[1][0];\n    Y0 = +_[0][1], Y1 = +_[1][1];\n    if (X0 > X1) _ = X0, X0 = X1, X1 = _;\n    if (Y0 > Y1) _ = Y0, Y0 = Y1, Y1 = _;\n    return graticule.precision(precision);\n  };\n\n  graticule.extentMinor = function(_) {\n    if (!arguments.length) return [[x0, y0], [x1, y1]];\n    x0 = +_[0][0], x1 = +_[1][0];\n    y0 = +_[0][1], y1 = +_[1][1];\n    if (x0 > x1) _ = x0, x0 = x1, x1 = _;\n    if (y0 > y1) _ = y0, y0 = y1, y1 = _;\n    return graticule.precision(precision);\n  };\n\n  graticule.step = function(_) {\n    if (!arguments.length) return graticule.stepMinor();\n    return graticule.stepMajor(_).stepMinor(_);\n  };\n\n  graticule.stepMajor = function(_) {\n    if (!arguments.length) return [DX, DY];\n    DX = +_[0], DY = +_[1];\n    return graticule;\n  };\n\n  graticule.stepMinor = function(_) {\n    if (!arguments.length) return [dx, dy];\n    dx = +_[0], dy = +_[1];\n    return graticule;\n  };\n\n  graticule.precision = function(_) {\n    if (!arguments.length) return precision;\n    precision = +_;\n    x = graticuleX(y0, y1, 90);\n    y = graticuleY(x0, x1, precision);\n    X = graticuleX(Y0, Y1, 90);\n    Y = graticuleY(X0, X1, precision);\n    return graticule;\n  };\n\n  return graticule\n      .extentMajor([[-180, -90 + epsilon], [180, 90 - epsilon]])\n      .extentMinor([[-180, -80 - epsilon], [180, 80 + epsilon]]);\n}\n\nexport function graticule10() {\n  return graticule()();\n}\n","function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    let dbp;\n    const getDB = () => {\n        if (dbp)\n            return dbp;\n        const request = indexedDB.open(dbName);\n        request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n        dbp = promisifyRequest(request);\n        dbp.then((db) => {\n            // It seems like Safari sometimes likes to just close the connection.\n            // It's supposed to fire this event when that happens. Let's hope it does!\n            db.onclose = () => (dbp = undefined);\n        }, () => { });\n        return dbp;\n    };\n    return (txMode, callback) => getDB().then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic  if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n","// takes care of the map's geometries\r\nimport { json } from 'd3-fetch'\r\nimport { feature } from 'topojson-client'\r\nimport { executeForAllInsets } from './utils'\r\nimport { kosovoBnFeatures } from './kosovo'\r\nimport { geoGraticule } from 'd3-geo'\r\nimport { get, set } from 'idb-keyval'\r\nimport { hideSpinner, showSpinner } from './spinner'\r\n\r\n//helpers for when indexedDB is not supported\r\nconst memCache = new Map()\r\nconst TTL_MS = 24 * 60 * 60 * 1000 // 24h\r\nfunction canUseIDB() {\r\n    if (typeof window === 'undefined') return false\r\n    // Allow HTTPS or localhost only. IndexedDB can also be blocked in iframes.\r\n    const secure = window.isSecureContext === true || location.hostname === 'localhost' || location.hostname === '127.0.0.1'\r\n    // If you're embedding, storage may still be blocked even if secure.\r\n    return secure && typeof indexedDB !== 'undefined'\r\n}\r\nasync function safeGetIDB(key) {\r\n    if (!canUseIDB()) return null\r\n    try {\r\n        return await get(key)\r\n    } catch (e) {\r\n        // SecurityError / \"operation is insecure\" shows up here; ignore it.\r\n        console.warn('[IDB] read skipped:', e?.name || e)\r\n        return null\r\n    }\r\n}\r\nasync function safeSetIDB(key, value) {\r\n    if (!canUseIDB()) return false\r\n    try {\r\n        await set(key, value)\r\n        return true\r\n    } catch (e) {\r\n        console.warn('[IDB] write skipped:', e?.name || e)\r\n        return false\r\n    }\r\n}\r\n\r\n// Geometries class wrapped as a function\r\nexport const Geometries = function (map, withCenterPoints) {\r\n    let out = {}\r\n\r\n    // defaults\r\n    out.defaultGeoData = undefined\r\n    out.allNUTSGeoData = undefined\r\n    out.geoJSONs = {\r\n        mixed: { rg0: undefined, rg1: undefined, rg2: undefined, rg3: undefined },\r\n        cntbn: undefined,\r\n        cntrg: undefined,\r\n        nutsbn: undefined,\r\n        nutsrg: undefined,\r\n        gra: undefined,\r\n        worldrg: undefined,\r\n        worldbn: undefined,\r\n        kosovo: undefined,\r\n    }\r\n\r\n    // user defined geometries (layers)\r\n    out.userGeometries = undefined\r\n\r\n    // user defined statistical regions\r\n    out.statisticalRegions = undefined\r\n\r\n    //centroids for prop symbols etc\r\n    out.centroidsData = undefined // raw TopoJSON centroids (all levels)\r\n    out.centroidsFeatures = undefined // filtered + projected centroids for rendering\r\n    out._allCentroidsFeatures = undefined // unfiltered master copy for rebuilding\r\n\r\n    // get geojson features of all statistical regions\r\n    out.getRegionFeatures = function () {\r\n        if (map.geo_ == 'WORLD') {\r\n            return out.geoJSONs.worldrg\r\n        } else {\r\n            if (map.nutsLevel_ === 'mixed') {\r\n                return [out.geoJSONs.mixed.rg0, out.geoJSONs.mixed.rg1, out.geoJSONs.mixed.rg2, out.geoJSONs.mixed.rg3]\r\n            } else {\r\n                return out.geoJSONs.nutsrg.concat(out.geoJSONs.cntrg)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Retrieves and parses 'default' geo data (for NUTS or World maps)\r\n     */\r\n    out.getDefaultGeoData = function (geo, filterGeometriesFunction, nutsLevel) {\r\n        const promises = out.getDefaultGeoDataPromise()\r\n        return Promise.all(promises)\r\n            .then((results) => {\r\n                const filtered = typeof filterGeometriesFunction === 'function' ? filterGeometriesFunction(results) : results\r\n                out.allNUTSGeoData = filtered\r\n                out.defaultGeoData = filtered[0]\r\n\r\n                if (withCenterPoints) {\r\n                    out.centroidsData = nutsLevel === 'mixed' ? [filtered[4], filtered[5], filtered[6], filtered[7]] : filtered[1]\r\n                }\r\n\r\n                const isWorld = geo === 'WORLD'\r\n                // Decode TopoJSON to GeoJSON\r\n                if (isWorld) {\r\n                    out.geoJSONs.worldrg = feature(out.defaultGeoData, out.defaultGeoData.objects.CNTR_RG_20M_2020_4326).features\r\n                    out.geoJSONs.worldbn = feature(out.defaultGeoData, out.defaultGeoData.objects.CNTR_BN_20M_2020_4326).features\r\n                    out.geoJSONs.kosovo = feature(out.defaultGeoData, out.defaultGeoData.objects.NUTS_BN_20M_2021_RS_XK_border).features\r\n                    out.geoJSONs.graticule = [geoGraticule().step([30, 30])()]\r\n                } else {\r\n                    out.geoJSONs.graticule = feature(out.defaultGeoData, out.defaultGeoData.objects.gra).features\r\n                    out.geoJSONs.nutsrg = feature(out.defaultGeoData, out.defaultGeoData.objects.nutsrg).features\r\n                    out.geoJSONs.nutsbn = feature(out.defaultGeoData, out.defaultGeoData.objects.nutsbn).features\r\n                    out.geoJSONs.cntrg = feature(out.defaultGeoData, out.defaultGeoData.objects.cntrg).features\r\n                    out.geoJSONs.cntbn = feature(out.defaultGeoData, out.defaultGeoData.objects.cntbn).features\r\n                }\r\n\r\n                return filtered\r\n            })\r\n            .catch((err) => {\r\n                return Promise.reject(err)\r\n            })\r\n    }\r\n\r\n    /**\r\n     * Returns an array of promises for Nuts2JSON topojson data.\r\n     */\r\n    out.getDefaultGeoDataPromise = function () {\r\n        const nutsLevels = [0, 1, 2, 3]\r\n        const promises = []\r\n\r\n        const buildUrl = (base, year, geo, proj, scale, level, withCenter = false) => {\r\n            let path = `${base}/${year}`\r\n            if (geo && geo !== 'EUR' && geo !== 'WORLD') path += `/${geo}`\r\n            path += `/${geo == 'WORLD' ? '4326' : proj}`\r\n            if (!withCenter && scale) path += `/${scale}`\r\n            path += `/${withCenter ? 'nutspt_' : ''}${level}.json`\r\n            return path\r\n        }\r\n\r\n        const fetchWithCache = async (url) => {\r\n            const cacheKey = `geojson-cache:${url}`\r\n\r\n            // 1) In-memory cache (fastest)\r\n            const mem = memCache.get(cacheKey)\r\n            if (mem && Date.now() - mem.timestamp < TTL_MS) {\r\n                return mem.data\r\n            }\r\n\r\n            // 2) IndexedDB (best-effort; never throw)\r\n            const cached = await safeGetIDB(cacheKey)\r\n            if (cached && Date.now() - cached.timestamp < TTL_MS) {\r\n                // refresh mem\r\n                memCache.set(cacheKey, cached)\r\n                return cached.data\r\n            }\r\n\r\n            // 3) Network\r\n            const data = await json(url).catch((err) => {\r\n                // If IDB had a stale record, consider using it as a last resort\r\n                if (cached?.data) return cached.data\r\n                throw new Error(`Fetch failed for ${url}: ${err?.message || err}`)\r\n            })\r\n\r\n            const record = { timestamp: Date.now(), data }\r\n            memCache.set(cacheKey, record) // always keep in-memory\r\n            await safeSetIDB(cacheKey, record) // best-effort; ignore failures\r\n\r\n            return data\r\n        }\r\n\r\n        if (!map || !map.nuts2jsonBaseURL_) {\r\n            throw new Error('Missing required map context or configuration')\r\n        }\r\n\r\n        if (map.nutsLevel_ === 'mixed' && map.geo_ !== 'WORLD') {\r\n            nutsLevels.forEach((lvl) => {\r\n                const url = buildUrl(map.nuts2jsonBaseURL_, map.nutsYear_, map.geo_, map.proj_, map.scale_, lvl)\r\n                promises.push(fetchWithCache(url))\r\n            })\r\n            if (withCenterPoints) {\r\n                nutsLevels.forEach((lvl) => {\r\n                    const url = buildUrl(map.nuts2jsonBaseURL_, map.nutsYear_, map.geo_, map.proj_, map.scale_, lvl, true)\r\n                    promises.push(fetchWithCache(url))\r\n                })\r\n            }\r\n        } else if (map.geo_ === 'WORLD') {\r\n            const worldMapTopojsonURL = window.location.hostname.includes('ec.europa.eu')\r\n                ? 'https://ec.europa.eu/assets/estat/E/E4/gisco/IMAGE/WORLD_4326.json'\r\n                : 'https://raw.githubusercontent.com/eurostat/eurostat-map/master/src/assets/topojson/WORLD_4326.json'\r\n\r\n            promises.push(fetchWithCache(worldMapTopojsonURL))\r\n        } else {\r\n            const mainUrl = buildUrl(map.nuts2jsonBaseURL_, map.nutsYear_, map.geo_, map.proj_, map.scale_, map.nutsLevel_)\r\n            promises.push(fetchWithCache(mainUrl))\r\n\r\n            if (withCenterPoints) {\r\n                const ptUrl = buildUrl(map.nuts2jsonBaseURL_, map.nutsYear_, map.geo_, map.proj_, map.scale_, map.nutsLevel_, true)\r\n                promises.push(fetchWithCache(ptUrl))\r\n            }\r\n        }\r\n\r\n        return promises\r\n    }\r\n\r\n    /** Checks if all geo data is ready */\r\n    out.isGeoReady = function () {\r\n        if (!out.defaultGeoData && !out.userGeometries) return false\r\n\r\n        let allReady = true\r\n\r\n        executeForAllInsets(map.insetTemplates_, null, (inset) => {\r\n            if (!inset.Geometries.isGeoReady()) {\r\n                allReady = false\r\n            }\r\n        })\r\n\r\n        return allReady\r\n    }\r\n\r\n    out.setUserGeometries = function (geometries) {\r\n        this.userGeometries = geometries\r\n\r\n        // get regions that are linked to the statistics\r\n        geometries.forEach((geometry) => {\r\n            if (geometry.statisticalRegions) {\r\n                this.statisticalRegions = geometry\r\n            }\r\n        })\r\n    }\r\n\r\n    out.addDefaultGeometriesToMap = function (container, drawGraticule, pathFunction, nutsLevel, nutsYear, geo, proj, scale) {\r\n        if (this.geoJSONs.graticule && drawGraticule) {\r\n            //draw graticule\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-graticule')\r\n                .attr('class', 'em-graticule')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.graticule)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n        }\r\n\r\n        //draw country regions\r\n        if (this.geoJSONs.cntrg) {\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-cntrg')\r\n                .attr('class', 'em-cntrg')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.cntrg)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n                .attr('id', (cntrg) => {\r\n                    // add ids for RS and EL so that we can choose not to add statistical data to them.\r\n                    const id = cntrg.properties.id\r\n                    if (id == 'RS' || id == 'EL') {\r\n                        return 'em-cntrg-' + id\r\n                    }\r\n                })\r\n        }\r\n\r\n        //draw world map\r\n        if (this.geoJSONs.worldrg) {\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-worldrg')\r\n                .attr('class', 'em-worldrg')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.worldrg)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n        }\r\n\r\n        //draw NUTS regions\r\n        if (this.geoJSONs.nutsrg) {\r\n            let regions\r\n            if (nutsLevel == 'mixed') {\r\n                this.geoJSONs.mixed.rg0 = this.geoJSONs.nutsrg\r\n                this.geoJSONs.mixed.rg1 = feature(out.allNUTSGeoData[1], out.allNUTSGeoData[1].objects.nutsrg).features\r\n                this.geoJSONs.mixed.rg2 = feature(out.allNUTSGeoData[2], out.allNUTSGeoData[2].objects.nutsrg).features\r\n                this.geoJSONs.mixed.rg3 = feature(out.allNUTSGeoData[3], out.allNUTSGeoData[3].objects.nutsrg).features\r\n\r\n                //for mixed NUTS, we add every NUTS region across all levels and hide level 1,2,3 by default, only showing them when they have stat data\r\n                // see updateClassification and updateStyle in map-choropleth.js for hiding/showing\r\n                ;[this.geoJSONs.mixed.rg0, this.geoJSONs.mixed.rg1, this.geoJSONs.mixed.rg2, this.geoJSONs.mixed.rg3].forEach((r, i) => {\r\n                    //append each nuts level to map\r\n                    regions = container\r\n                        .append('g')\r\n                        .attr('id', 'em-nutsrg')\r\n                        .attr('class', `em-nutsrg em-nutsrg-${i}`)\r\n                        .selectAll('path')\r\n                        .data(r)\r\n                        .enter()\r\n                        .append('path')\r\n                        .attr('d', pathFunction)\r\n                        .attr('lvl', i) //to be able to distinguish nuts levels\r\n\r\n                    attachClickEventToRegions(regions, map)\r\n                })\r\n\r\n                //add kosovo\r\n                if (geo == 'EUR' && (proj == '3035' || proj == '4326')) {\r\n                    // add kosovo manually\r\n                    addKosovoBorder(container, pathFunction, proj, scale, nutsYear)\r\n                }\r\n            } else {\r\n                // when nutsLevel is not 'mixed'\r\n                regions = container\r\n                    .append('g')\r\n                    .attr('id', 'em-nutsrg')\r\n                    .attr('class', 'em-nutsrg')\r\n                    .selectAll('path')\r\n                    .data(this.geoJSONs.nutsrg)\r\n                    .enter()\r\n                    .append('path')\r\n                    .attr('d', pathFunction)\r\n\r\n                attachClickEventToRegions(regions, map)\r\n            }\r\n        }\r\n\r\n        // draw country boundary halo (underneath)\r\n        if (this.geoJSONs.cntbn) {\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-cntbn-halo')\r\n                .attr('class', 'em-cntbn-halo')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.cntbn)\r\n                .enter()\r\n                .append('path')\r\n                .filter(function (bn) {\r\n                    if (bn.properties.eu == 'T') return bn\r\n                    if (bn.properties.efta == 'T') return bn\r\n                    if (bn.properties.cc == 'T') return bn\r\n                    if (bn.properties.oth == 'T') return bn\r\n                    if (bn.properties.co == 'T') return bn\r\n                })\r\n                .attr('d', pathFunction)\r\n                .attr('id', (bn) => 'em-bn-' + bn.properties.id + '-halo')\r\n                .attr('class', function (bn) {\r\n                    let classList = []\r\n                    if (bn.properties.eu === 'T') classList.push('em-bn-eu')\r\n                    if (bn.properties.efta === 'T') classList.push('em-bn-efta')\r\n                    if (bn.properties.cc === 'T') classList.push('em-bn-cc')\r\n                    if (bn.properties.oth === 'T') classList.push('em-bn-oth')\r\n                    if (bn.properties.co === 'T') classList.push('em-bn-co')\r\n                    return classList.join(' ') // Use join with a space to create a valid class string\r\n                })\r\n        }\r\n\r\n        //draw country boundaries\r\n        if (this.geoJSONs.cntbn) {\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-cntbn')\r\n                .attr('class', 'em-cntbn')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.cntbn)\r\n                .enter()\r\n                .append('path')\r\n                .filter(function (bn) {\r\n                    if (bn.properties.eu == 'T') return bn\r\n                    if (bn.properties.efta == 'T') return bn\r\n                    if (bn.properties.cc == 'T') return bn\r\n                    if (bn.properties.oth == 'T') return bn\r\n                    if (bn.properties.co == 'T') return bn\r\n                })\r\n                .attr('d', pathFunction)\r\n                .attr('id', (bn) => 'em-bn-' + bn.properties.id)\r\n                .attr('class', function (bn) {\r\n                    let classList = []\r\n                    if (bn.properties.eu === 'T') classList.push('em-bn-eu')\r\n                    if (bn.properties.efta === 'T') classList.push('em-bn-efta')\r\n                    if (bn.properties.cc === 'T') classList.push('em-bn-cc')\r\n                    if (bn.properties.oth === 'T') classList.push('em-bn-oth')\r\n                    if (bn.properties.co === 'T') classList.push('em-bn-co')\r\n                    return classList.join(' ') // Use join with a space to create a valid class string\r\n                })\r\n        }\r\n\r\n        //draw NUTS boundaries\r\n        if (this.geoJSONs.nutsbn && nutsLevel !== 'mixed') {\r\n            this.geoJSONs.nutsbn.sort(function (bn1, bn2) {\r\n                return bn2.properties.lvl - bn1.properties.lvl\r\n            })\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-nutsbn')\r\n                .attr('class', 'em-nutsbn')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.nutsbn)\r\n                .enter()\r\n                .filter(function (bn) {\r\n                    if (bn.properties.eu == 'T') return bn\r\n                    if (bn.properties.efta == 'T') return bn\r\n                    if (bn.properties.cc == 'T') return bn\r\n                    if (bn.properties.oth == 'T') return bn\r\n                    if (bn.properties.co == 'T') return bn\r\n                })\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n                .attr('class', function (bn) {\r\n                    let props = bn.properties\r\n                    //KOSOVO\r\n                    if (props.id > 100000) {\r\n                        return 'em-kosovo-bn'\r\n                    }\r\n                    if (props.co === 'T') return 'em-bn-co'\r\n                    const cl = ['em-bn-' + props.lvl]\r\n                    //if (bn.oth === \"T\") cl.push(\"bn-oth\");\r\n                    return cl.join(' ')\r\n                })\r\n        }\r\n\r\n        //draw world boundaries\r\n        if (this.geoJSONs.worldbn) {\r\n            // draw world boundary halo (underneath)\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-worldbn-halo')\r\n                .attr('class', 'em-worldbn-halo')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.worldbn)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n                .attr('class', function (bn) {\r\n                    if (bn.properties.POL_STAT > 0) {\r\n                        //disputed\r\n                        return 'em-bn-d em-worldbn-halo'\r\n                    }\r\n                    return bn.properties.COAS_FLAG === 'T' ? 'em-bn-co' : 'em-worldbn-halo'\r\n                })\r\n            //draw world boundaries\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-worldbn')\r\n                .attr('class', 'em-worldbn')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.worldbn)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n                .attr('class', function (bn) {\r\n                    if (bn.properties.POL_STAT > 0) {\r\n                        //disputed\r\n                        return 'em-bn-d'\r\n                    }\r\n                    return bn.properties.COAS_FLAG === 'T' ? 'em-bn-co' : 'em-worldbn'\r\n                })\r\n            //.attr(\"id\", (bn) => bn.properties.CNTR_BN_ID)\r\n        }\r\n\r\n        if (this.geoJSONs.kosovo) {\r\n            //add kosovo to world maps\r\n            container\r\n                .append('g')\r\n                .attr('id', 'em-kosovo-bn')\r\n                .attr('class', 'em-kosovo-bn')\r\n                .selectAll('path')\r\n                .data(this.geoJSONs.kosovo)\r\n                .enter()\r\n                .append('path')\r\n                .attr('d', pathFunction)\r\n        }\r\n    }\r\n\r\n    function addKosovoBorder(container, pathFunction, proj, scale, nutsYear) {\r\n        let kosovoFeature = kosovoBnFeatures[nutsYear] ? kosovoBnFeatures[nutsYear][proj][scale] : kosovoBnFeatures[2024][proj][scale]\r\n        let kosovoBn = feature(kosovoFeature, 'nutsbn_1').features\r\n        container\r\n            .append('g')\r\n            .attr('id', 'em-kosovo-bn')\r\n            .attr('class', 'em-kosovo-bn em-bn-cc')\r\n            .selectAll('path')\r\n            .data(kosovoBn)\r\n            .enter()\r\n            .append('path')\r\n            .attr('d', pathFunction)\r\n    }\r\n\r\n    /**\r\n     * @description Adds user-defined geometries to the map\r\n     * E.g.\r\n     * map.geometries([\r\n     *  { id: 'regions', features: geoJSON.features, class: (feature) => 'region' },\r\n     *  { id: 'borders', features: bordersData, class: (feature) => 'border' }\r\n     * ])\r\n     * @param geometries array of objects, each containing an array of geoJSON features\r\n     * @param container d3 selection of the parent that we append the geometries to\r\n     * @param pathFunction d3 path function\r\n     */\r\n    out.addUserGeometriesToMap = function (geometries, container, pathFunction) {\r\n        geometries.forEach((geometry) => {\r\n            let group = container\r\n                .append('g')\r\n                .attr('id', geometry.statisticalRegions ? 'em-user-regions' : '')\r\n                .attr('class', geometry.class ? geometry.class : '')\r\n\r\n            let elements = group.selectAll('path').data(geometry.features).enter().append('path').attr('d', pathFunction)\r\n\r\n            // Allow custom call chain modifications through onEach\r\n            if (typeof geometry.onEach === 'function') {\r\n                geometry.onEach(elements)\r\n            }\r\n        })\r\n    }\r\n\r\n    // get all statistical region features (e.g. for statistical labelling)\r\n    out.getAllRegionFeatures = function () {\r\n        let features = []\r\n        if (out.geoJSONs.nutsrg) {\r\n            //allow for stat label positioning by adding a g element here, then adding the values in the mapType updateValuesLabels function\r\n            if (map.nutsLevel_ == 'mixed') {\r\n                features = out.geoJSONs.mixed.rg0.concat(\r\n                    out.geoJSONs.mixed.rg1,\r\n                    out.geoJSONs.mixed.rg2,\r\n                    out.geoJSONs.mixed.rg3,\r\n                    out.geoJSONs.cntrg // NEW: allow labels for cntrg\r\n                )\r\n            } else {\r\n                features = out.geoJSONs.nutsrg.concat(out.geoJSONs.cntrg)\r\n            }\r\n        } else if (out.userGeometries) {\r\n            // user defined geometries\r\n            features = out.statisticalRegions.features\r\n        }\r\n\r\n        return features\r\n    }\r\n\r\n    return out\r\n}\r\n\r\nfunction attachClickEventToRegions(regions, map) {\r\n    regions.on('click', function (e, rg) {\r\n        if (map.tooltip_.omitRegions?.includes(rg.properties?.id)) return\r\n        if (map.onRegionClick_) map.onRegionClick_(e, rg, this, map)\r\n    })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { mapTemplate } from './map-template'\r\n\r\n/**\r\n * Build inset maps for a map template\r\n */\r\nexport const buildInsets = function (out, withCenterPoints, mapType) {\r\n        // Early return if no insets to build\r\n    if (!out.insets_ || out.insets_.length === 0) {\r\n        return out\r\n    }\r\n\r\n    \r\n    if (!out.insetBoxPosition_) {\r\n        out.insetBoxPosition_ = [out.width_ - out.insetBoxWidth_ - 2 * out.insetBoxPadding_, 2 * out.insetBoxPadding_]\r\n    }\r\n\r\n    let svg = select('#' + out.svgId_)\r\n    let drawingGroup = svg.select('#em-drawing-' + out.svgId_)\r\n    \r\n    \r\n    const insetsGroup = drawingGroup\r\n        .append('g')\r\n        .attr('id', 'em-insets-group')\r\n        .attr('class', 'em-insets')\r\n        .attr('transform', 'translate(' + out.insetBoxPosition_[0] + ',' + out.insetBoxPosition_[1] + ')')\r\n\r\n    if (out.insets_ === 'default') {\r\n        out.insets_ = defaultInsetConfig(out.insetBoxWidth_, out.insetBoxPadding_)\r\n    }\r\n\r\n\r\n    for (let i = 0; i < out.insets_.length; i++) {\r\n        const config = out.insets_[i]\r\n        \r\n        config.svgId = config.svgId || 'inset' + config.geo + Math.random().toString(36).substring(7)\r\n\r\n        let svg = select('#' + config.svgId)\r\n\r\n\r\n        if (svg.size() == 0) {\r\n            const x = config.x == undefined ? out.insetBoxPadding_ : config.x\r\n            const y = config.y == undefined ? out.insetBoxPadding_ + i * (out.insetBoxPadding_ + out.insetBoxWidth_) : config.y\r\n            const ggeo = insetsGroup\r\n                .append('g')\r\n                .attr('id', 'em-inset-' + config.svgId)\r\n                .attr('class', 'em-inset')\r\n                .attr('transform', 'translate(' + x + ',' + y + ')')\r\n            ggeo.append('svg').attr('id', config.svgId)\r\n        }\r\n\r\n         // GISCO-2676 - PT azores inset has 2 insets with the same Geo, so second was overriding first:\r\n        if (out.insetTemplates_[config.geo]) {\r\n            //if inset already exists in map with same geo, then push both to an array\r\n            let inset = buildInset(config, out, withCenterPoints, mapType)\r\n            inset.buildMapTemplateBase()\r\n            out.insetTemplates_[config.geo] = [out.insetTemplates_[config.geo], inset]\r\n        } else {\r\n            let inset = buildInset(config, out, withCenterPoints, mapType)\r\n            let drawnInset = inset.buildMapTemplateBase()\r\n            out.insetTemplates_[config.geo] = drawnInset\r\n        }\r\n    }\r\n    \r\n    return out\r\n}\r\n/** Build template for inset, based on main one */\r\nconst buildInset = function (config, out, withCenterPoints, mapType) {\r\n    //TODO find a better way to do that\r\n\r\n    //copy map\r\n    //for(let key__ in map) {\r\n    //mt[key__] = map[key__];\r\n    //}\r\n\r\n    const mt = mapTemplate(config, withCenterPoints, mapType)\r\n\r\n    //define default values for inset configs\r\n    config = config || {}\r\n    config.proj = config.proj || _defaultCRS[config.geo]\r\n    config.scale = config.scale || out.insetScale_\r\n    config.footnote = config.footnote || ''\r\n    config.showSourceLink = config.showSourceLink || false\r\n    config.zoomExtent = config.zoomExtent || out.insetZoomExtent_\r\n    config.width = config.width || out.insetBoxWidth_\r\n    config.height = config.height || out.insetBoxWidth_\r\n    config.insets = config.insets || []\r\n    config.insetTemplates = config.insetTemplates || {}\r\n    config.callback = config.callback || out.callback_\r\n\r\n        //copy main map attributes\r\n        ;[\r\n            'nutsLevel_',\r\n            'nutsYear_',\r\n            'hoverColor_',\r\n            //'nutsbnStroke_', // DEPRECATED\r\n            // 'nutsbnStrokeWidth_', // DEPRECATED\r\n            'cntrgFillStyle_', // DEPRECATED\r\n            'cntbnStroke_', // DEPRECATED\r\n            'cntbnStrokeWidth_', // DEPRECATED\r\n            'seaFillStyle_', // DEPRECATED\r\n            'drawCoastalMargin_',\r\n            'coastalMarginColor_', // DEPRECATED\r\n            'coastalMarginWidth_', // DEPRECATED\r\n            'coastalMarginStdDev_',\r\n            'graticuleStroke_', // DEPRECATED\r\n            'graticuleStrokeWidth_', // DEPRECATED\r\n            'lg_',\r\n            'projectionFunction_',\r\n            'filterGeometriesFunction_',\r\n            'processCentroids_',\r\n        ].forEach(function (att) {\r\n            mt[att] = out[att]\r\n        })\r\n\r\n        //copy stat map attributes/methods\r\n        ;['stat', 'statData', 'legend', 'legendObj', 'noDataText', 'language', 'transitionDuration', 'tooltip_', 'classToText_'].forEach(function (att) {\r\n            mt[att] = out[att]\r\n        })\r\n\r\n    //apply config values for inset\r\n    for (let key in config) mt[key + '_'] = config[key]\r\n\r\n    mt.isInset = true // flag for inset-specific settings e.g. CSS class for titles\r\n    return mt\r\n}\r\n\r\n/**\r\n * Remove insets maps from the DOM\r\n */\r\nexport const removeInsets = function (out) {\r\n    if (out.insetTemplates_) {\r\n        for (let template in out.insetTemplates_) {\r\n            let id = out.insetTemplates_[template].svgId_\r\n            let existing = select('#' + id)\r\n            // if (existing) existing.remove()\r\n            if (existing) existing.html('') // empty them, but dont remove them.\r\n        }\r\n        out.insetTemplates_ = {} //  GISCO-2676\r\n    }\r\n}\r\n\r\n/**\r\n * Default inset setting.\r\n * @param {*} s The width of the inset box\r\n * @param {*} p The padding\r\n */\r\nconst defaultInsetConfig = function (s, p) {\r\n    const out = [\r\n        { geo: 'IC', x: 0, y: 0, width: s, height: 0.3 * s },\r\n        { geo: 'CARIB', x: 0, y: 0.3 * s + p, width: 0.5 * s, height: s },\r\n        { geo: 'GF', x: 0.5 * s, y: 0.3 * s + p, width: 0.5 * s, height: 0.75 * s },\r\n        {\r\n            geo: 'YT',\r\n            x: 0.5 * s,\r\n            y: 1.05 * s + p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        {\r\n            geo: 'RE',\r\n            x: 0.75 * s,\r\n            y: 1.05 * s + p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        {\r\n            geo: 'PT20',\r\n            x: 0,\r\n            y: 1.3 * s + 2 * p,\r\n            width: 0.75 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        {\r\n            geo: 'PT30',\r\n            x: 0.75 * s,\r\n            y: 1.3 * s + 2 * p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        { geo: 'MT', x: 0, y: 1.55 * s + 3 * p, width: 0.25 * s, height: 0.25 * s },\r\n        {\r\n            geo: 'LI',\r\n            x: 0.25 * s,\r\n            y: 1.55 * s + 3 * p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        {\r\n            geo: 'SJ_SV',\r\n            x: 0.5 * s,\r\n            y: 1.55 * s + 3 * p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        {\r\n            geo: 'SJ_JM',\r\n            x: 0.75 * s,\r\n            y: 1.55 * s + 3 * p,\r\n            width: 0.25 * s,\r\n            height: 0.25 * s,\r\n        },\r\n        /*{geo:\"IC\", x:0, y:0}, {geo:\"RE\", x:dd, y:0}, {geo:\"YT\", x:2*dd, y:0},\r\n        {geo:\"GP\", x:0, y:dd}, {geo:\"MQ\", x:dd, y:dd}, {geo:\"GF\",scale:\"10M\", x:2*dd, y:dd},\r\n        {geo:\"PT20\", x:0, y:2*dd}, {geo:\"PT30\", x:dd, y:2*dd}, {geo:\"MT\", x:2*dd, y:2*dd},\r\n        {geo:\"LI\",scale:\"01M\", x:0, y:3*dd}, {geo:\"SJ_SV\", x:dd, y:3*dd}, {geo:\"SJ_JM\",scale:\"01M\", x:2*dd, y:3*dd},*/\r\n        //{geo:\"CARIB\", x:0, y:330}, {geo:\"IS\", x:dd, y:330}\r\n    ]\r\n    //hide graticule for insets\r\n    for (let i = 0; i < out.length; i++) out[i].drawGraticule = false\r\n    return out\r\n}\r\n\r\n/** Default CRS for each geo area */\r\nconst _defaultCRS = {\r\n    EUR: '3035',\r\n    IC: '32628',\r\n    GP: '32620',\r\n    MQ: '32620',\r\n    GF: '32622',\r\n    RE: '32740',\r\n    YT: '32738',\r\n    MT: '3035',\r\n    PT20: '32626',\r\n    PT30: '32628',\r\n    LI: '3035',\r\n    IS: '3035',\r\n    SJ_SV: '3035',\r\n    SJ_JM: '3035',\r\n    CARIB: '32620',\r\n    WORLD: '54030',\r\n}\r\n","export const appendStamp = (stampConfig, map) => {\r\n    if (map.svg_) {\r\n        const existing = map.svg_.select('#em-stamp')\r\n        existing.remove()\r\n\r\n        if (stampConfig) {\r\n            const container = map.svg_.append('g').attr('id', 'em-stamp')\r\n\r\n            // Set defaults\r\n            if (!stampConfig.size) stampConfig.size = 60\r\n            if (!stampConfig.x) stampConfig.x = 230\r\n            if (!stampConfig.y) stampConfig.y = 100\r\n            if (!stampConfig.textColor) stampConfig.textColor = '#000'\r\n            if (!stampConfig.stampColor) stampConfig.stampColor = '#000'\r\n            if (!stampConfig.strokeWidth) stampConfig.strokeWidth = 1\r\n            if (!stampConfig.lineHeight) stampConfig.lineHeight = 15\r\n\r\n            // Draw the circle\r\n            container\r\n                .append('circle')\r\n                .attr('r', stampConfig.size)\r\n                .attr('cx', stampConfig.x)\r\n                .attr('cy', stampConfig.y)\r\n                .attr('id', 'em-stamp-circle')\r\n                .attr('fill', 'none')\r\n                .attr('stroke', stampConfig.stampColor)\r\n                .attr('stroke-width', stampConfig.strokeWidth)\r\n\r\n            // Handle text\r\n            const text = stampConfig.text\r\n            const targetWidth = Math.sqrt(measureWidth(text.trim()) * stampConfig.lineHeight)\r\n            const lines = getLines(getWords(text.trim()), targetWidth)\r\n            const textRadius = getTextRadius(lines, stampConfig.lineHeight)\r\n\r\n            // Append inside circle\r\n            container\r\n                .append('text')\r\n                .attr('text-anchor', 'middle')\r\n                .attr('fill', stampConfig.textColor)\r\n                .attr('id', 'em-stamp-text')\r\n                .attr('transform', `translate(${stampConfig.x},${stampConfig.y}) scale(${stampConfig.size / textRadius})`)\r\n                .selectAll('tspan')\r\n                .data(lines)\r\n                .enter()\r\n                .append('tspan')\r\n                .attr('x', 0)\r\n                .attr('y', (d, i) => (i - lines.length / 2 + 0.8) * stampConfig.lineHeight)\r\n                .text((d) => d.text.replaceAll('~', ' ').replaceAll('', '')) // Removes  (line breaker) and ~ (non breaking space)\r\n        }\r\n    }\r\n}\r\n\r\n// Splitting by both spaces and pilcrows\r\nconst getWords = (text) => {\r\n    return text\r\n        .split(/(?<=)|\\s+/g)\r\n        .map((word) => word.trim())\r\n        .filter((word) => word.length > 0)\r\n}\r\n\r\n// Computes text width\r\nconst measureWidth = (text) => {\r\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n    const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text')\r\n\r\n    textElement.textContent = text\r\n    svg.appendChild(textElement)\r\n    document.body.appendChild(svg)\r\n\r\n    const width = textElement.getComputedTextLength()\r\n    document.body.removeChild(svg)\r\n\r\n    return width + 10\r\n}\r\n\r\n// Compute text radius\r\nconst getTextRadius = (lines, lineHeight) => {\r\n    let radius = 0\r\n    for (let i = 0, n = lines.length; i < n; ++i) {\r\n        const dy = (Math.abs(i - n / 2 + 0.5) + 0.5) * lineHeight\r\n        const dx = lines[i].width / 2\r\n        radius = Math.max(radius, Math.sqrt(dx ** 2 + dy ** 2))\r\n    }\r\n    return radius\r\n}\r\n\r\n// Handles forced line breaks\r\nconst getLines = (words, targetWidth) => {\r\n    let lines = []\r\n    let line = { width: 0, text: '' }\r\n\r\n    for (let i = 0, n = words.length; i < n; ++i) {\r\n        if (words[i] === '') {\r\n            // Push current line (if it has text)\r\n            if (line.text) lines.push(line)\r\n            // Start a new empty line\r\n            line = { width: 0, text: '' }\r\n            continue\r\n        }\r\n\r\n        let lineText1 = (line.text ? line.text + ' ' : '') + words[i]\r\n        let lineWidth1 = measureWidth(lineText1)\r\n\r\n        if ((line.width + lineWidth1) / 2 < targetWidth) {\r\n            line.width = lineWidth1\r\n            line.text = lineText1\r\n        } else {\r\n            lines.push(line)\r\n            line = { width: measureWidth(words[i]), text: words[i] }\r\n        }\r\n    }\r\n\r\n    if (line.text) lines.push(line) // Push last line if it exists\r\n\r\n    return lines\r\n}\r\n","var EOL = {},\n    EOF = {},\n    QUOTE = 34,\n    NEWLINE = 10,\n    RETURN = 13;\n\nfunction objectConverter(columns) {\n  return new Function(\"d\", \"return {\" + columns.map(function(name, i) {\n    return JSON.stringify(name) + \": d[\" + i + \"] || \\\"\\\"\";\n  }).join(\",\") + \"}\");\n}\n\nfunction customConverter(columns, f) {\n  var object = objectConverter(columns);\n  return function(row, i) {\n    return f(object(row), i, columns);\n  };\n}\n\n// Compute unique columns in order of discovery.\nfunction inferColumns(rows) {\n  var columnSet = Object.create(null),\n      columns = [];\n\n  rows.forEach(function(row) {\n    for (var column in row) {\n      if (!(column in columnSet)) {\n        columns.push(columnSet[column] = column);\n      }\n    }\n  });\n\n  return columns;\n}\n\nfunction pad(value, width) {\n  var s = value + \"\", length = s.length;\n  return length < width ? new Array(width - length + 1).join(0) + s : s;\n}\n\nfunction formatYear(year) {\n  return year < 0 ? \"-\" + pad(-year, 6)\n    : year > 9999 ? \"+\" + pad(year, 6)\n    : pad(year, 4);\n}\n\nfunction formatDate(date) {\n  var hours = date.getUTCHours(),\n      minutes = date.getUTCMinutes(),\n      seconds = date.getUTCSeconds(),\n      milliseconds = date.getUTCMilliseconds();\n  return isNaN(date) ? \"Invalid Date\"\n      : formatYear(date.getUTCFullYear(), 4) + \"-\" + pad(date.getUTCMonth() + 1, 2) + \"-\" + pad(date.getUTCDate(), 2)\n      + (milliseconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \".\" + pad(milliseconds, 3) + \"Z\"\n      : seconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \"Z\"\n      : minutes || hours ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \"Z\"\n      : \"\");\n}\n\nexport default function(delimiter) {\n  var reFormat = new RegExp(\"[\\\"\" + delimiter + \"\\n\\r]\"),\n      DELIMITER = delimiter.charCodeAt(0);\n\n  function parse(text, f) {\n    var convert, columns, rows = parseRows(text, function(row, i) {\n      if (convert) return convert(row, i - 1);\n      columns = row, convert = f ? customConverter(row, f) : objectConverter(row);\n    });\n    rows.columns = columns || [];\n    return rows;\n  }\n\n  function parseRows(text, f) {\n    var rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // current line number\n        t, // current token\n        eof = N <= 0, // current token followed by EOF?\n        eol = false; // current token followed by EOL?\n\n    // Strip the trailing newline.\n    if (text.charCodeAt(N - 1) === NEWLINE) --N;\n    if (text.charCodeAt(N - 1) === RETURN) --N;\n\n    function token() {\n      if (eof) return EOF;\n      if (eol) return eol = false, EOL;\n\n      // Unescape quotes.\n      var i, j = I, c;\n      if (text.charCodeAt(j) === QUOTE) {\n        while (I++ < N && text.charCodeAt(I) !== QUOTE || text.charCodeAt(++I) === QUOTE);\n        if ((i = I) >= N) eof = true;\n        else if ((c = text.charCodeAt(I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        return text.slice(j + 1, i - 1).replace(/\"\"/g, \"\\\"\");\n      }\n\n      // Find next delimiter or newline.\n      while (I < N) {\n        if ((c = text.charCodeAt(i = I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        else if (c !== DELIMITER) continue;\n        return text.slice(j, i);\n      }\n\n      // Return last token before EOF.\n      return eof = true, text.slice(j, N);\n    }\n\n    while ((t = token()) !== EOF) {\n      var row = [];\n      while (t !== EOL && t !== EOF) row.push(t), t = token();\n      if (f && (row = f(row, n++)) == null) continue;\n      rows.push(row);\n    }\n\n    return rows;\n  }\n\n  function preformatBody(rows, columns) {\n    return rows.map(function(row) {\n      return columns.map(function(column) {\n        return formatValue(row[column]);\n      }).join(delimiter);\n    });\n  }\n\n  function format(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return [columns.map(formatValue).join(delimiter)].concat(preformatBody(rows, columns)).join(\"\\n\");\n  }\n\n  function formatBody(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return preformatBody(rows, columns).join(\"\\n\");\n  }\n\n  function formatRows(rows) {\n    return rows.map(formatRow).join(\"\\n\");\n  }\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(value) {\n    return value == null ? \"\"\n        : value instanceof Date ? formatDate(value)\n        : reFormat.test(value += \"\") ? \"\\\"\" + value.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\"\n        : value;\n  }\n\n  return {\n    parse: parse,\n    parseRows: parseRows,\n    format: format,\n    formatBody: formatBody,\n    formatRows: formatRows,\n    formatRow: formatRow,\n    formatValue: formatValue\n  };\n}\n","import dsv from \"./dsv.js\";\n\nvar csv = dsv(\",\");\n\nexport var csvParse = csv.parse;\nexport var csvParseRows = csv.parseRows;\nexport var csvFormat = csv.format;\nexport var csvFormatBody = csv.formatBody;\nexport var csvFormatRows = csv.formatRows;\nexport var csvFormatRow = csv.formatRow;\nexport var csvFormatValue = csv.formatValue;\n","import { select, selectAll } from 'd3-selection'\r\nimport { csvParseRows } from 'd3-dsv'\r\n\r\n// draw grid cartogram geometries\r\nexport const buildGridCartogramBase = function (out) {\r\n    const zoomGroup = select(`#em-zoom-group-${out.svgId_}`)\r\n    const gridGroup = zoomGroup.append('g').attr('id', 'em-grid-container')\r\n\r\n    // Ensure margins exist with default values\r\n    out.gridCartogramMargins_ = out.gridCartogramMargins_ || { top: 80, right: 80, bottom: 80, left: 80 }\r\n\r\n    // Get grid layout\r\n    const gridLayout = getGridLayout(out)\r\n    const position = parseGridLayout(gridLayout)\r\n    const gridData = getGridData(position, out)\r\n\r\n    // Draw the appropriate grid\r\n    if (out.gridCartogramShape_ === 'hexagon') {\r\n        drawHexagonGrid(gridGroup, gridData, out)\r\n    } else {\r\n        drawSquareGrid(gridGroup, gridData, out)\r\n    }\r\n\r\n    // Center the grid\r\n    centerGrid(gridGroup, out.width_, out.height_, out.gridCartogramMargins_)\r\n}\r\n\r\n/** Determines the grid layout based on settings */\r\nconst getGridLayout = (out) => {\r\n    const squareGrid = `\r\n        ,IS,  ,  ,NO,SE,FI,  ,  ,  ,  ,  ,\r\n        ,  ,  ,  ,  ,  ,  ,EE,  ,  ,  ,  ,\r\n        ,  ,  ,  ,  ,  ,  ,LV,  ,  ,  ,  ,\r\n        ,IE,UK,  ,  ,DK,  ,LT,  ,  ,  ,  ,\r\n        ,  ,  ,  ,NL,DE,PL,  ,  ,  ,  ,  ,\r\n        ,  ,  ,BE,LU,CZ,SK,UA,  ,  ,  ,  ,\r\n        ,  ,FR,CH,LI,AT,HU,RO,MD,  ,  ,  ,\r\n        ,PT,ES,  ,IT,SI,HR,RS,BG,  ,  ,  ,\r\n        ,  ,  ,  ,  ,  ,BA,ME,MK,  ,  ,  ,  \r\n        ,  ,  ,  ,  ,  ,  ,AL,EL,TR,GE,  ,  \r\n        ,  ,  ,  ,MT,  ,  ,  ,  ,CY,  ,  ,  `\r\n\r\n    const hexagonGrid = `\r\n        ,IS,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,\r\n        ,  ,  ,  ,NO,SE,FI,EE,  ,  ,  ,  ,\r\n        ,  ,  ,  ,  ,  ,  ,LV,  ,  ,  ,  ,\r\n        ,IE,UK,  ,  ,DK,  ,LT,  ,  ,  ,  ,\r\n        ,  ,  ,  ,NL,DE,PL,  ,  ,  ,  ,  ,\r\n        ,  ,  ,BE,LU,CZ,SK,UA,  ,  ,  ,  ,\r\n        ,  ,FR,CH,LI,AT,HU,RO,MD,  ,  ,  ,\r\n        ,PT,ES,  ,IT,SI,HR,RS,BG,  ,  ,  ,\r\n        ,  ,  ,  ,  ,  ,BA,ME,MK,  ,  ,  ,  \r\n        ,  ,  ,  ,  ,  ,  ,AL,EL,TR,GE,  ,  \r\n        ,  ,  ,  ,MT,  ,  ,  ,  ,CY,  ,  ,  `\r\n\r\n    return out.gridCartogramPositions_ || (out.gridCartogramShape_ === 'hexagon' ? hexagonGrid : squareGrid)\r\n}\r\n\r\n/** Parses the grid layout and maps each ID to its position */\r\nconst parseGridLayout = (gridLayout) => {\r\n    const positionById = new Map()\r\n    csvParseRows(gridLayout.trim(), (row, j) => {\r\n        row.forEach((id, i) => {\r\n            if ((id = id.trim())) {\r\n                positionById.set(id, [i, j])\r\n            }\r\n        })\r\n    })\r\n    return positionById\r\n}\r\n\r\n/** Converts parsed positions into structured grid data */\r\nconst getGridData = (position, out) => {\r\n    return Array.from(position, ([id, [col, row]]) => {\r\n        const feature = out.Geometries.geoJSONs.nutsrg.find((rg) => rg.properties.id == id)\r\n        return {\r\n            id,\r\n            col,\r\n            row,\r\n            properties: {\r\n                id: id,\r\n                name: feature ? feature.properties.na : '',\r\n            },\r\n        }\r\n    })\r\n}\r\n\r\n/** Draws a square grid */\r\nconst drawSquareGrid = (gridGroup, gridData, out) => {\r\n    const numCols = Math.max(...gridData.map((d) => d.col)) + 1\r\n    const numRows = Math.max(...gridData.map((d) => d.row)) + 1\r\n\r\n    const margins = out.gridCartogramMargins_\r\n    const cellPadding = out.gridCartogramCellPadding_ || 0 // Keep cell padding\r\n\r\n    const cellWidth = (out.width_ - margins.left - margins.right) / numCols - cellPadding\r\n    const cellHeight = (out.height_ - margins.top - margins.bottom) / numRows - cellPadding\r\n    const cellSize = Math.min(cellWidth, cellHeight)\r\n\r\n    gridGroup\r\n        .selectAll('.em-grid-cell')\r\n        .data(gridData)\r\n        .enter()\r\n        .append('g')\r\n        .attr('class', 'em-grid-cell')\r\n        .attr('transform', (d) => `translate(${d.col * (cellSize + cellPadding) + margins.left}, ${d.row * (cellSize + cellPadding) + margins.top})`)\r\n        .each(function (d) {\r\n            select(this).append('rect').attr('width', cellSize).attr('height', cellSize).attr('class', 'em-grid-rect')\r\n\r\n            select(this)\r\n                .append('text')\r\n                .attr('class', 'em-grid-text')\r\n                .attr('text-anchor', 'middle')\r\n                .attr('font-size', 15)\r\n                .style('pointer-events', 'none')\r\n                .attr('fill', 'black')\r\n                .text(d.id)\r\n                .attr('x', cellSize / 2)\r\n                .attr('y', cellSize / 2 + 5)\r\n        })\r\n}\r\n\r\n/** Draws a hexagon grid */\r\nconst drawHexagonGrid = (gridGroup, gridData, out) => {\r\n    const numCols = Math.max(...gridData.map((d) => d.col)) + 1\r\n    const numRows = Math.max(...gridData.map((d) => d.row)) + 1\r\n\r\n    const margins = out.gridCartogramMargins_\r\n    const cellPadding = out.gridCartogramCellPadding_ || 0 // Keep cell padding\r\n\r\n    const baseHexRadius = Math.min(\r\n        (out.width_ - margins.left - margins.right) / (numCols * 1.5),\r\n        (out.height_ - margins.top - margins.bottom) / (numRows * Math.sqrt(3))\r\n    )\r\n\r\n    const hexRadius = baseHexRadius\r\n    const hexHeight = Math.sqrt(3) * hexRadius\r\n\r\n    gridGroup\r\n        .selectAll('.em-grid-cell')\r\n        .data(gridData)\r\n        .enter()\r\n        .append('g')\r\n        .attr('class', 'em-grid-cell')\r\n        .attr('transform', (d) => {\r\n            const x = d.col * (1.5 * hexRadius + cellPadding) + margins.left\r\n            const y = d.row * (hexHeight + cellPadding) + (d.col % 2 === 1 ? (hexHeight + cellPadding) / 2 : 0) + margins.top\r\n            return `translate(${x}, ${y})`\r\n        })\r\n        .each(function (d) {\r\n            select(this).append('path').attr('d', drawHexagon(hexRadius)).attr('class', 'em-grid-hexagon')\r\n\r\n            select(this)\r\n                .append('text')\r\n                .attr('class', 'em-grid-text')\r\n                .attr('text-anchor', 'middle')\r\n                .attr('font-size', 15)\r\n                .style('pointer-events', 'none')\r\n                .attr('fill', 'black')\r\n                .text(d.id)\r\n                .attr('y', 5)\r\n        })\r\n}\r\n\r\n/** Generates the hexagon path */\r\nconst drawHexagon = (r) => {\r\n    const angle = Math.PI / 3\r\n    return (\r\n        Array.from({ length: 6 }, (_, i) => {\r\n            const x = r * Math.cos(angle * i)\r\n            const y = r * Math.sin(angle * i)\r\n            return `${i === 0 ? 'M' : 'L'}${x},${y}`\r\n        }).join(' ') + ' Z'\r\n    )\r\n}\r\n\r\n/** Centers the grid within the SVG */\r\nconst centerGrid = (gridGroup, svgWidth, svgHeight, margins) => {\r\n    gridGroup.each(function () {\r\n        const bbox = this.getBBox()\r\n        const dx = (svgWidth - margins.left - margins.right - bbox.width) / 2 - bbox.x + margins.left\r\n        const dy = (svgHeight - margins.top - margins.bottom - bbox.height) / 2 - bbox.y + margins.top\r\n        gridGroup.attr('transform', `translate(${dx}, ${dy})`)\r\n    })\r\n}\r\n","import {asin, atan2, cos, sin, sqrt} from \"./math.js\";\n\nexport function spherical(cartesian) {\n  return [atan2(cartesian[1], cartesian[0]), asin(cartesian[2])];\n}\n\nexport function cartesian(spherical) {\n  var lambda = spherical[0], phi = spherical[1], cosPhi = cos(phi);\n  return [cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi)];\n}\n\nexport function cartesianDot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nexport function cartesianCross(a, b) {\n  return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\n}\n\n// TODO return a\nexport function cartesianAddInPlace(a, b) {\n  a[0] += b[0], a[1] += b[1], a[2] += b[2];\n}\n\nexport function cartesianScale(vector, k) {\n  return [vector[0] * k, vector[1] * k, vector[2] * k];\n}\n\n// TODO return d\nexport function cartesianNormalizeInPlace(d) {\n  var l = sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);\n  d[0] /= l, d[1] /= l, d[2] /= l;\n}\n","import {Adder} from \"d3-array\";\nimport {cartesian, cartesianCross, cartesianNormalizeInPlace} from \"./cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, epsilon2, halfPi, pi, quarterPi, sign, sin, tau} from \"./math.js\";\n\nfunction longitude(point) {\n  return abs(point[0]) <= pi ? point[0] : sign(point[0]) * ((abs(point[0]) + pi) % tau - pi);\n}\n\nexport default function(polygon, point) {\n  var lambda = longitude(point),\n      phi = point[1],\n      sinPhi = sin(phi),\n      normal = [sin(lambda), -cos(lambda), 0],\n      angle = 0,\n      winding = 0;\n\n  var sum = new Adder();\n\n  if (sinPhi === 1) phi = halfPi + epsilon;\n  else if (sinPhi === -1) phi = -halfPi - epsilon;\n\n  for (var i = 0, n = polygon.length; i < n; ++i) {\n    if (!(m = (ring = polygon[i]).length)) continue;\n    var ring,\n        m,\n        point0 = ring[m - 1],\n        lambda0 = longitude(point0),\n        phi0 = point0[1] / 2 + quarterPi,\n        sinPhi0 = sin(phi0),\n        cosPhi0 = cos(phi0);\n\n    for (var j = 0; j < m; ++j, lambda0 = lambda1, sinPhi0 = sinPhi1, cosPhi0 = cosPhi1, point0 = point1) {\n      var point1 = ring[j],\n          lambda1 = longitude(point1),\n          phi1 = point1[1] / 2 + quarterPi,\n          sinPhi1 = sin(phi1),\n          cosPhi1 = cos(phi1),\n          delta = lambda1 - lambda0,\n          sign = delta >= 0 ? 1 : -1,\n          absDelta = sign * delta,\n          antimeridian = absDelta > pi,\n          k = sinPhi0 * sinPhi1;\n\n      sum.add(atan2(k * sign * sin(absDelta), cosPhi0 * cosPhi1 + k * cos(absDelta)));\n      angle += antimeridian ? delta + sign * tau : delta;\n\n      // Are the longitudes either side of the points meridian (lambda),\n      // and are the latitudes smaller than the parallel (phi)?\n      if (antimeridian ^ lambda0 >= lambda ^ lambda1 >= lambda) {\n        var arc = cartesianCross(cartesian(point0), cartesian(point1));\n        cartesianNormalizeInPlace(arc);\n        var intersection = cartesianCross(normal, arc);\n        cartesianNormalizeInPlace(intersection);\n        var phiArc = (antimeridian ^ delta >= 0 ? -1 : 1) * asin(intersection[2]);\n        if (phi > phiArc || phi === phiArc && (arc[0] || arc[1])) {\n          winding += antimeridian ^ delta >= 0 ? 1 : -1;\n        }\n      }\n    }\n  }\n\n  // First, determine whether the South pole is inside or outside:\n  //\n  // It is inside if:\n  // * the polygon winds around it in a clockwise direction.\n  // * the polygon does not (cumulatively) wind around it, but has a negative\n  //   (counter-clockwise) area.\n  //\n  // Second, count the (signed) number of times a segment crosses a lambda\n  // from the point to the South pole.  If it is zero, then the point is the\n  // same side as the South pole.\n\n  return (angle < -epsilon || angle < epsilon && sum < -epsilon2) ^ (winding & 1);\n}\n","import clipBuffer from \"./buffer.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {epsilon, halfPi} from \"../math.js\";\nimport polygonContains from \"../polygonContains.js\";\nimport {merge} from \"d3-array\";\n\nexport default function(pointVisible, clipLine, interpolate, start) {\n  return function(sink) {\n    var line = clipLine(sink),\n        ringBuffer = clipBuffer(),\n        ringSink = clipLine(ringBuffer),\n        polygonStarted = false,\n        polygon,\n        segments,\n        ring;\n\n    var clip = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() {\n        clip.point = pointRing;\n        clip.lineStart = ringStart;\n        clip.lineEnd = ringEnd;\n        segments = [];\n        polygon = [];\n      },\n      polygonEnd: function() {\n        clip.point = point;\n        clip.lineStart = lineStart;\n        clip.lineEnd = lineEnd;\n        segments = merge(segments);\n        var startInside = polygonContains(polygon, start);\n        if (segments.length) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          clipRejoin(segments, compareIntersection, startInside, interpolate, sink);\n        } else if (startInside) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          interpolate(null, null, 1, sink);\n          sink.lineEnd();\n        }\n        if (polygonStarted) sink.polygonEnd(), polygonStarted = false;\n        segments = polygon = null;\n      },\n      sphere: function() {\n        sink.polygonStart();\n        sink.lineStart();\n        interpolate(null, null, 1, sink);\n        sink.lineEnd();\n        sink.polygonEnd();\n      }\n    };\n\n    function point(lambda, phi) {\n      if (pointVisible(lambda, phi)) sink.point(lambda, phi);\n    }\n\n    function pointLine(lambda, phi) {\n      line.point(lambda, phi);\n    }\n\n    function lineStart() {\n      clip.point = pointLine;\n      line.lineStart();\n    }\n\n    function lineEnd() {\n      clip.point = point;\n      line.lineEnd();\n    }\n\n    function pointRing(lambda, phi) {\n      ring.push([lambda, phi]);\n      ringSink.point(lambda, phi);\n    }\n\n    function ringStart() {\n      ringSink.lineStart();\n      ring = [];\n    }\n\n    function ringEnd() {\n      pointRing(ring[0][0], ring[0][1]);\n      ringSink.lineEnd();\n\n      var clean = ringSink.clean(),\n          ringSegments = ringBuffer.result(),\n          i, n = ringSegments.length, m,\n          segment,\n          point;\n\n      ring.pop();\n      polygon.push(ring);\n      ring = null;\n\n      if (!n) return;\n\n      // No intersections.\n      if (clean & 1) {\n        segment = ringSegments[0];\n        if ((m = segment.length - 1) > 0) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          for (i = 0; i < m; ++i) sink.point((point = segment[i])[0], point[1]);\n          sink.lineEnd();\n        }\n        return;\n      }\n\n      // Rejoin connected segments.\n      // TODO reuse ringBuffer.rejoin()?\n      if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));\n\n      segments.push(ringSegments.filter(validSegment));\n    }\n\n    return clip;\n  };\n}\n\nfunction validSegment(segment) {\n  return segment.length > 1;\n}\n\n// Intersections are sorted along the clip edge. For both antimeridian cutting\n// and circle clipping, the same comparison is used.\nfunction compareIntersection(a, b) {\n  return ((a = a.x)[0] < 0 ? a[1] - halfPi - epsilon : halfPi - a[1])\n       - ((b = b.x)[0] < 0 ? b[1] - halfPi - epsilon : halfPi - b[1]);\n}\n","import clip from \"./index.js\";\nimport {abs, atan, cos, epsilon, halfPi, pi, sin} from \"../math.js\";\n\nexport default clip(\n  function() { return true; },\n  clipAntimeridianLine,\n  clipAntimeridianInterpolate,\n  [-pi, -halfPi]\n);\n\n// Takes a line and cuts into visible segments. Return values: 0 - there were\n// intersections or the line was empty; 1 - no intersections; 2 - there were\n// intersections, and the first and last segments should be rejoined.\nfunction clipAntimeridianLine(stream) {\n  var lambda0 = NaN,\n      phi0 = NaN,\n      sign0 = NaN,\n      clean; // no intersections\n\n  return {\n    lineStart: function() {\n      stream.lineStart();\n      clean = 1;\n    },\n    point: function(lambda1, phi1) {\n      var sign1 = lambda1 > 0 ? pi : -pi,\n          delta = abs(lambda1 - lambda0);\n      if (abs(delta - pi) < epsilon) { // line crosses a pole\n        stream.point(lambda0, phi0 = (phi0 + phi1) / 2 > 0 ? halfPi : -halfPi);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        stream.point(lambda1, phi0);\n        clean = 0;\n      } else if (sign0 !== sign1 && delta >= pi) { // line crosses antimeridian\n        if (abs(lambda0 - sign0) < epsilon) lambda0 -= sign0 * epsilon; // handle degeneracies\n        if (abs(lambda1 - sign1) < epsilon) lambda1 -= sign1 * epsilon;\n        phi0 = clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        clean = 0;\n      }\n      stream.point(lambda0 = lambda1, phi0 = phi1);\n      sign0 = sign1;\n    },\n    lineEnd: function() {\n      stream.lineEnd();\n      lambda0 = phi0 = NaN;\n    },\n    clean: function() {\n      return 2 - clean; // if intersections, rejoin first and last segments\n    }\n  };\n}\n\nfunction clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1) {\n  var cosPhi0,\n      cosPhi1,\n      sinLambda0Lambda1 = sin(lambda0 - lambda1);\n  return abs(sinLambda0Lambda1) > epsilon\n      ? atan((sin(phi0) * (cosPhi1 = cos(phi1)) * sin(lambda1)\n          - sin(phi1) * (cosPhi0 = cos(phi0)) * sin(lambda0))\n          / (cosPhi0 * cosPhi1 * sinLambda0Lambda1))\n      : (phi0 + phi1) / 2;\n}\n\nfunction clipAntimeridianInterpolate(from, to, direction, stream) {\n  var phi;\n  if (from == null) {\n    phi = direction * halfPi;\n    stream.point(-pi, phi);\n    stream.point(0, phi);\n    stream.point(pi, phi);\n    stream.point(pi, 0);\n    stream.point(pi, -phi);\n    stream.point(0, -phi);\n    stream.point(-pi, -phi);\n    stream.point(-pi, 0);\n    stream.point(-pi, phi);\n  } else if (abs(from[0] - to[0]) > epsilon) {\n    var lambda = from[0] < to[0] ? pi : -pi;\n    phi = direction * lambda / 2;\n    stream.point(-lambda, phi);\n    stream.point(0, phi);\n    stream.point(lambda, phi);\n  } else {\n    stream.point(to[0], to[1]);\n  }\n}\n","import {cartesian, cartesianNormalizeInPlace, spherical} from \"./cartesian.js\";\nimport constant from \"./constant.js\";\nimport {acos, cos, degrees, epsilon, radians, sin, tau} from \"./math.js\";\nimport {rotateRadians} from \"./rotation.js\";\n\n// Generates a circle centered at [0, 0], with a given radius and precision.\nexport function circleStream(stream, radius, delta, direction, t0, t1) {\n  if (!delta) return;\n  var cosRadius = cos(radius),\n      sinRadius = sin(radius),\n      step = direction * delta;\n  if (t0 == null) {\n    t0 = radius + direction * tau;\n    t1 = radius - step / 2;\n  } else {\n    t0 = circleRadius(cosRadius, t0);\n    t1 = circleRadius(cosRadius, t1);\n    if (direction > 0 ? t0 < t1 : t0 > t1) t0 += direction * tau;\n  }\n  for (var point, t = t0; direction > 0 ? t > t1 : t < t1; t -= step) {\n    point = spherical([cosRadius, -sinRadius * cos(t), -sinRadius * sin(t)]);\n    stream.point(point[0], point[1]);\n  }\n}\n\n// Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].\nfunction circleRadius(cosRadius, point) {\n  point = cartesian(point), point[0] -= cosRadius;\n  cartesianNormalizeInPlace(point);\n  var radius = acos(-point[1]);\n  return ((-point[2] < 0 ? -radius : radius) + tau - epsilon) % tau;\n}\n\nexport default function() {\n  var center = constant([0, 0]),\n      radius = constant(90),\n      precision = constant(2),\n      ring,\n      rotate,\n      stream = {point: point};\n\n  function point(x, y) {\n    ring.push(x = rotate(x, y));\n    x[0] *= degrees, x[1] *= degrees;\n  }\n\n  function circle() {\n    var c = center.apply(this, arguments),\n        r = radius.apply(this, arguments) * radians,\n        p = precision.apply(this, arguments) * radians;\n    ring = [];\n    rotate = rotateRadians(-c[0] * radians, -c[1] * radians, 0).invert;\n    circleStream(stream, r, p, 1);\n    c = {type: \"Polygon\", coordinates: [ring]};\n    ring = rotate = null;\n    return c;\n  }\n\n  circle.center = function(_) {\n    return arguments.length ? (center = typeof _ === \"function\" ? _ : constant([+_[0], +_[1]]), circle) : center;\n  };\n\n  circle.radius = function(_) {\n    return arguments.length ? (radius = typeof _ === \"function\" ? _ : constant(+_), circle) : radius;\n  };\n\n  circle.precision = function(_) {\n    return arguments.length ? (precision = typeof _ === \"function\" ? _ : constant(+_), circle) : precision;\n  };\n\n  return circle;\n}\n","export default function(a, b) {\n\n  function compose(x, y) {\n    return x = a(x, y), b(x[0], x[1]);\n  }\n\n  if (a.invert && b.invert) compose.invert = function(x, y) {\n    return x = b.invert(x, y), x && a.invert(x[0], x[1]);\n  };\n\n  return compose;\n}\n","import compose from \"./compose.js\";\nimport {abs, asin, atan2, cos, degrees, pi, radians, sin, tau} from \"./math.js\";\n\nfunction rotationIdentity(lambda, phi) {\n  if (abs(lambda) > pi) lambda -= Math.round(lambda / tau) * tau;\n  return [lambda, phi];\n}\n\nrotationIdentity.invert = rotationIdentity;\n\nexport function rotateRadians(deltaLambda, deltaPhi, deltaGamma) {\n  return (deltaLambda %= tau) ? (deltaPhi || deltaGamma ? compose(rotationLambda(deltaLambda), rotationPhiGamma(deltaPhi, deltaGamma))\n    : rotationLambda(deltaLambda))\n    : (deltaPhi || deltaGamma ? rotationPhiGamma(deltaPhi, deltaGamma)\n    : rotationIdentity);\n}\n\nfunction forwardRotationLambda(deltaLambda) {\n  return function(lambda, phi) {\n    lambda += deltaLambda;\n    if (abs(lambda) > pi) lambda -= Math.round(lambda / tau) * tau;\n    return [lambda, phi];\n  };\n}\n\nfunction rotationLambda(deltaLambda) {\n  var rotation = forwardRotationLambda(deltaLambda);\n  rotation.invert = forwardRotationLambda(-deltaLambda);\n  return rotation;\n}\n\nfunction rotationPhiGamma(deltaPhi, deltaGamma) {\n  var cosDeltaPhi = cos(deltaPhi),\n      sinDeltaPhi = sin(deltaPhi),\n      cosDeltaGamma = cos(deltaGamma),\n      sinDeltaGamma = sin(deltaGamma);\n\n  function rotation(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaPhi + x * sinDeltaPhi;\n    return [\n      atan2(y * cosDeltaGamma - k * sinDeltaGamma, x * cosDeltaPhi - z * sinDeltaPhi),\n      asin(k * cosDeltaGamma + y * sinDeltaGamma)\n    ];\n  }\n\n  rotation.invert = function(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaGamma - y * sinDeltaGamma;\n    return [\n      atan2(y * cosDeltaGamma + z * sinDeltaGamma, x * cosDeltaPhi + k * sinDeltaPhi),\n      asin(k * cosDeltaPhi - x * sinDeltaPhi)\n    ];\n  };\n\n  return rotation;\n}\n\nexport default function(rotate) {\n  rotate = rotateRadians(rotate[0] * radians, rotate[1] * radians, rotate.length > 2 ? rotate[2] * radians : 0);\n\n  function forward(coordinates) {\n    coordinates = rotate(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  }\n\n  forward.invert = function(coordinates) {\n    coordinates = rotate.invert(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  };\n\n  return forward;\n}\n","import {cartesian} from \"../cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, radians, sqrt} from \"../math.js\";\nimport {transformer} from \"../transform.js\";\n\nvar maxDepth = 16, // maximum depth of subdivision\n    cosMinDistance = cos(30 * radians); // cos(minimum angular distance)\n\nexport default function(project, delta2) {\n  return +delta2 ? resample(project, delta2) : resampleNone(project);\n}\n\nfunction resampleNone(project) {\n  return transformer({\n    point: function(x, y) {\n      x = project(x, y);\n      this.stream.point(x[0], x[1]);\n    }\n  });\n}\n\nfunction resample(project, delta2) {\n\n  function resampleLineTo(x0, y0, lambda0, a0, b0, c0, x1, y1, lambda1, a1, b1, c1, depth, stream) {\n    var dx = x1 - x0,\n        dy = y1 - y0,\n        d2 = dx * dx + dy * dy;\n    if (d2 > 4 * delta2 && depth--) {\n      var a = a0 + a1,\n          b = b0 + b1,\n          c = c0 + c1,\n          m = sqrt(a * a + b * b + c * c),\n          phi2 = asin(c /= m),\n          lambda2 = abs(abs(c) - 1) < epsilon || abs(lambda0 - lambda1) < epsilon ? (lambda0 + lambda1) / 2 : atan2(b, a),\n          p = project(lambda2, phi2),\n          x2 = p[0],\n          y2 = p[1],\n          dx2 = x2 - x0,\n          dy2 = y2 - y0,\n          dz = dy * dx2 - dx * dy2;\n      if (dz * dz / d2 > delta2 // perpendicular projected distance\n          || abs((dx * dx2 + dy * dy2) / d2 - 0.5) > 0.3 // midpoint close to an end\n          || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) { // angular distance\n        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x2, y2, lambda2, a /= m, b /= m, c, depth, stream);\n        stream.point(x2, y2);\n        resampleLineTo(x2, y2, lambda2, a, b, c, x1, y1, lambda1, a1, b1, c1, depth, stream);\n      }\n    }\n  }\n  return function(stream) {\n    var lambda00, x00, y00, a00, b00, c00, // first point\n        lambda0, x0, y0, a0, b0, c0; // previous point\n\n    var resampleStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() { stream.polygonStart(); resampleStream.lineStart = ringStart; },\n      polygonEnd: function() { stream.polygonEnd(); resampleStream.lineStart = lineStart; }\n    };\n\n    function point(x, y) {\n      x = project(x, y);\n      stream.point(x[0], x[1]);\n    }\n\n    function lineStart() {\n      x0 = NaN;\n      resampleStream.point = linePoint;\n      stream.lineStart();\n    }\n\n    function linePoint(lambda, phi) {\n      var c = cartesian([lambda, phi]), p = project(lambda, phi);\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x0 = p[0], y0 = p[1], lambda0 = lambda, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);\n      stream.point(x0, y0);\n    }\n\n    function lineEnd() {\n      resampleStream.point = point;\n      stream.lineEnd();\n    }\n\n    function ringStart() {\n      lineStart();\n      resampleStream.point = ringPoint;\n      resampleStream.lineEnd = ringEnd;\n    }\n\n    function ringPoint(lambda, phi) {\n      linePoint(lambda00 = lambda, phi), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;\n      resampleStream.point = linePoint;\n    }\n\n    function ringEnd() {\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x00, y00, lambda00, a00, b00, c00, maxDepth, stream);\n      resampleStream.lineEnd = lineEnd;\n      lineEnd();\n    }\n\n    return resampleStream;\n  };\n}\n","import clipAntimeridian from \"../clip/antimeridian.js\";\nimport clipCircle from \"../clip/circle.js\";\nimport clipRectangle from \"../clip/rectangle.js\";\nimport compose from \"../compose.js\";\nimport identity from \"../identity.js\";\nimport {cos, degrees, radians, sin, sqrt} from \"../math.js\";\nimport {rotateRadians} from \"../rotation.js\";\nimport {transformer} from \"../transform.js\";\nimport {fitExtent, fitSize, fitWidth, fitHeight} from \"./fit.js\";\nimport resample from \"./resample.js\";\n\nvar transformRadians = transformer({\n  point: function(x, y) {\n    this.stream.point(x * radians, y * radians);\n  }\n});\n\nfunction transformRotate(rotate) {\n  return transformer({\n    point: function(x, y) {\n      var r = rotate(x, y);\n      return this.stream.point(r[0], r[1]);\n    }\n  });\n}\n\nfunction scaleTranslate(k, dx, dy, sx, sy) {\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [dx + k * x, dy - k * y];\n  }\n  transform.invert = function(x, y) {\n    return [(x - dx) / k * sx, (dy - y) / k * sy];\n  };\n  return transform;\n}\n\nfunction scaleTranslateRotate(k, dx, dy, sx, sy, alpha) {\n  if (!alpha) return scaleTranslate(k, dx, dy, sx, sy);\n  var cosAlpha = cos(alpha),\n      sinAlpha = sin(alpha),\n      a = cosAlpha * k,\n      b = sinAlpha * k,\n      ai = cosAlpha / k,\n      bi = sinAlpha / k,\n      ci = (sinAlpha * dy - cosAlpha * dx) / k,\n      fi = (sinAlpha * dx + cosAlpha * dy) / k;\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [a * x - b * y + dx, dy - b * x - a * y];\n  }\n  transform.invert = function(x, y) {\n    return [sx * (ai * x - bi * y + ci), sy * (fi - bi * x - ai * y)];\n  };\n  return transform;\n}\n\nexport default function projection(project) {\n  return projectionMutator(function() { return project; })();\n}\n\nexport function projectionMutator(projectAt) {\n  var project,\n      k = 150, // scale\n      x = 480, y = 250, // translate\n      lambda = 0, phi = 0, // center\n      deltaLambda = 0, deltaPhi = 0, deltaGamma = 0, rotate, // pre-rotate\n      alpha = 0, // post-rotate angle\n      sx = 1, // reflectX\n      sy = 1, // reflectX\n      theta = null, preclip = clipAntimeridian, // pre-clip angle\n      x0 = null, y0, x1, y1, postclip = identity, // post-clip extent\n      delta2 = 0.5, // precision\n      projectResample,\n      projectTransform,\n      projectRotateTransform,\n      cache,\n      cacheStream;\n\n  function projection(point) {\n    return projectRotateTransform(point[0] * radians, point[1] * radians);\n  }\n\n  function invert(point) {\n    point = projectRotateTransform.invert(point[0], point[1]);\n    return point && [point[0] * degrees, point[1] * degrees];\n  }\n\n  projection.stream = function(stream) {\n    return cache && cacheStream === stream ? cache : cache = transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream = stream)))));\n  };\n\n  projection.preclip = function(_) {\n    return arguments.length ? (preclip = _, theta = undefined, reset()) : preclip;\n  };\n\n  projection.postclip = function(_) {\n    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;\n  };\n\n  projection.clipAngle = function(_) {\n    return arguments.length ? (preclip = +_ ? clipCircle(theta = _ * radians) : (theta = null, clipAntimeridian), reset()) : theta * degrees;\n  };\n\n  projection.clipExtent = function(_) {\n    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];\n  };\n\n  projection.scale = function(_) {\n    return arguments.length ? (k = +_, recenter()) : k;\n  };\n\n  projection.translate = function(_) {\n    return arguments.length ? (x = +_[0], y = +_[1], recenter()) : [x, y];\n  };\n\n  projection.center = function(_) {\n    return arguments.length ? (lambda = _[0] % 360 * radians, phi = _[1] % 360 * radians, recenter()) : [lambda * degrees, phi * degrees];\n  };\n\n  projection.rotate = function(_) {\n    return arguments.length ? (deltaLambda = _[0] % 360 * radians, deltaPhi = _[1] % 360 * radians, deltaGamma = _.length > 2 ? _[2] % 360 * radians : 0, recenter()) : [deltaLambda * degrees, deltaPhi * degrees, deltaGamma * degrees];\n  };\n\n  projection.angle = function(_) {\n    return arguments.length ? (alpha = _ % 360 * radians, recenter()) : alpha * degrees;\n  };\n\n  projection.reflectX = function(_) {\n    return arguments.length ? (sx = _ ? -1 : 1, recenter()) : sx < 0;\n  };\n\n  projection.reflectY = function(_) {\n    return arguments.length ? (sy = _ ? -1 : 1, recenter()) : sy < 0;\n  };\n\n  projection.precision = function(_) {\n    return arguments.length ? (projectResample = resample(projectTransform, delta2 = _ * _), reset()) : sqrt(delta2);\n  };\n\n  projection.fitExtent = function(extent, object) {\n    return fitExtent(projection, extent, object);\n  };\n\n  projection.fitSize = function(size, object) {\n    return fitSize(projection, size, object);\n  };\n\n  projection.fitWidth = function(width, object) {\n    return fitWidth(projection, width, object);\n  };\n\n  projection.fitHeight = function(height, object) {\n    return fitHeight(projection, height, object);\n  };\n\n  function recenter() {\n    var center = scaleTranslateRotate(k, 0, 0, sx, sy, alpha).apply(null, project(lambda, phi)),\n        transform = scaleTranslateRotate(k, x - center[0], y - center[1], sx, sy, alpha);\n    rotate = rotateRadians(deltaLambda, deltaPhi, deltaGamma);\n    projectTransform = compose(project, transform);\n    projectRotateTransform = compose(rotate, projectTransform);\n    projectResample = resample(projectTransform, delta2);\n    return reset();\n  }\n\n  function reset() {\n    cache = cacheStream = null;\n    return projection;\n  }\n\n  return function() {\n    project = projectAt.apply(this, arguments);\n    projection.invert = project.invert && invert;\n    return recenter();\n  };\n}\n","import {cartesian, cartesianAddInPlace, cartesianCross, cartesianDot, cartesianScale, spherical} from \"../cartesian.js\";\nimport {circleStream} from \"../circle.js\";\nimport {abs, cos, epsilon, pi, radians, sqrt} from \"../math.js\";\nimport pointEqual from \"../pointEqual.js\";\nimport clip from \"./index.js\";\n\nexport default function(radius) {\n  var cr = cos(radius),\n      delta = 2 * radians,\n      smallRadius = cr > 0,\n      notHemisphere = abs(cr) > epsilon; // TODO optimise for this common case\n\n  function interpolate(from, to, direction, stream) {\n    circleStream(stream, radius, delta, direction, from, to);\n  }\n\n  function visible(lambda, phi) {\n    return cos(lambda) * cos(phi) > cr;\n  }\n\n  // Takes a line and cuts into visible segments. Return values used for polygon\n  // clipping: 0 - there were intersections or the line was empty; 1 - no\n  // intersections 2 - there were intersections, and the first and last segments\n  // should be rejoined.\n  function clipLine(stream) {\n    var point0, // previous point\n        c0, // code for previous point\n        v0, // visibility of previous point\n        v00, // visibility of first point\n        clean; // no intersections\n    return {\n      lineStart: function() {\n        v00 = v0 = false;\n        clean = 1;\n      },\n      point: function(lambda, phi) {\n        var point1 = [lambda, phi],\n            point2,\n            v = visible(lambda, phi),\n            c = smallRadius\n              ? v ? 0 : code(lambda, phi)\n              : v ? code(lambda + (lambda < 0 ? pi : -pi), phi) : 0;\n        if (!point0 && (v00 = v0 = v)) stream.lineStart();\n        if (v !== v0) {\n          point2 = intersect(point0, point1);\n          if (!point2 || pointEqual(point0, point2) || pointEqual(point1, point2))\n            point1[2] = 1;\n        }\n        if (v !== v0) {\n          clean = 0;\n          if (v) {\n            // outside going in\n            stream.lineStart();\n            point2 = intersect(point1, point0);\n            stream.point(point2[0], point2[1]);\n          } else {\n            // inside going out\n            point2 = intersect(point0, point1);\n            stream.point(point2[0], point2[1], 2);\n            stream.lineEnd();\n          }\n          point0 = point2;\n        } else if (notHemisphere && point0 && smallRadius ^ v) {\n          var t;\n          // If the codes for two points are different, or are both zero,\n          // and there this segment intersects with the small circle.\n          if (!(c & c0) && (t = intersect(point1, point0, true))) {\n            clean = 0;\n            if (smallRadius) {\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1]);\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n            } else {\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1], 3);\n            }\n          }\n        }\n        if (v && (!point0 || !pointEqual(point0, point1))) {\n          stream.point(point1[0], point1[1]);\n        }\n        point0 = point1, v0 = v, c0 = c;\n      },\n      lineEnd: function() {\n        if (v0) stream.lineEnd();\n        point0 = null;\n      },\n      // Rejoin first and last segments if there were intersections and the first\n      // and last points were visible.\n      clean: function() {\n        return clean | ((v00 && v0) << 1);\n      }\n    };\n  }\n\n  // Intersects the great circle between a and b with the clip circle.\n  function intersect(a, b, two) {\n    var pa = cartesian(a),\n        pb = cartesian(b);\n\n    // We have two planes, n1.p = d1 and n2.p = d2.\n    // Find intersection line p(t) = c1 n1 + c2 n2 + t (n1  n2).\n    var n1 = [1, 0, 0], // normal\n        n2 = cartesianCross(pa, pb),\n        n2n2 = cartesianDot(n2, n2),\n        n1n2 = n2[0], // cartesianDot(n1, n2),\n        determinant = n2n2 - n1n2 * n1n2;\n\n    // Two polar points.\n    if (!determinant) return !two && a;\n\n    var c1 =  cr * n2n2 / determinant,\n        c2 = -cr * n1n2 / determinant,\n        n1xn2 = cartesianCross(n1, n2),\n        A = cartesianScale(n1, c1),\n        B = cartesianScale(n2, c2);\n    cartesianAddInPlace(A, B);\n\n    // Solve |p(t)|^2 = 1.\n    var u = n1xn2,\n        w = cartesianDot(A, u),\n        uu = cartesianDot(u, u),\n        t2 = w * w - uu * (cartesianDot(A, A) - 1);\n\n    if (t2 < 0) return;\n\n    var t = sqrt(t2),\n        q = cartesianScale(u, (-w - t) / uu);\n    cartesianAddInPlace(q, A);\n    q = spherical(q);\n\n    if (!two) return q;\n\n    // Two intersection points.\n    var lambda0 = a[0],\n        lambda1 = b[0],\n        phi0 = a[1],\n        phi1 = b[1],\n        z;\n\n    if (lambda1 < lambda0) z = lambda0, lambda0 = lambda1, lambda1 = z;\n\n    var delta = lambda1 - lambda0,\n        polar = abs(delta - pi) < epsilon,\n        meridian = polar || delta < epsilon;\n\n    if (!polar && phi1 < phi0) z = phi0, phi0 = phi1, phi1 = z;\n\n    // Check that the first point is between a and b.\n    if (meridian\n        ? polar\n          ? phi0 + phi1 > 0 ^ q[1] < (abs(q[0] - lambda0) < epsilon ? phi0 : phi1)\n          : phi0 <= q[1] && q[1] <= phi1\n        : delta > pi ^ (lambda0 <= q[0] && q[0] <= lambda1)) {\n      var q1 = cartesianScale(u, (-w + t) / uu);\n      cartesianAddInPlace(q1, A);\n      return [q, spherical(q1)];\n    }\n  }\n\n  // Generates a 4-bit vector representing the location of a point relative to\n  // the small circle's bounding box.\n  function code(lambda, phi) {\n    var r = smallRadius ? radius : pi - radius,\n        code = 0;\n    if (lambda < -r) code |= 1; // left\n    else if (lambda > r) code |= 2; // right\n    if (phi < -r) code |= 4; // below\n    else if (phi > r) code |= 8; // above\n    return code;\n  }\n\n  return clip(visible, clipLine, interpolate, smallRadius ? [0, -radius] : [-pi, radius - pi]);\n}\n","import {asin, cos, epsilon, sin} from \"../math.js\";\nimport {azimuthalInvert} from \"./azimuthal.js\";\nimport projection from \"./index.js\";\n\nexport function orthographicRaw(x, y) {\n  return [cos(y) * sin(x), sin(y)];\n}\n\northographicRaw.invert = azimuthalInvert(asin);\n\nexport default function() {\n  return projection(orthographicRaw)\n      .scale(249.5)\n      .clipAngle(90 + epsilon);\n}\n","import {asin, atan2, cos, sin, sqrt} from \"../math.js\";\n\nexport function azimuthalRaw(scale) {\n  return function(x, y) {\n    var cx = cos(x),\n        cy = cos(y),\n        k = scale(cx * cy);\n        if (k === Infinity) return [2, 0];\n    return [\n      k * cy * sin(x),\n      k * sin(y)\n    ];\n  }\n}\n\nexport function azimuthalInvert(angle) {\n  return function(x, y) {\n    var z = sqrt(x * x + y * y),\n        c = angle(z),\n        sc = sin(c),\n        cc = cos(c);\n    return [\n      atan2(x * sc, z * cc),\n      asin(z && y * sc / z)\n    ];\n  }\n}\n","export var PJD_3PARAM = 1;\nexport var PJD_7PARAM = 2;\nexport var PJD_GRIDSHIFT = 3;\nexport var PJD_WGS84 = 4; // WGS84 or equivalent\nexport var PJD_NODATUM = 5; // WGS84 or equivalent\nexport var SRS_WGS84_SEMIMAJOR = 6378137.0; // only used in grid shift transforms\nexport var SRS_WGS84_SEMIMINOR = 6356752.314; // only used in grid shift transforms\nexport var SRS_WGS84_ESQUARED = 0.0066943799901413165; // only used in grid shift transforms\nexport var SEC_TO_RAD = 4.84813681109535993589914102357e-6;\nexport var HALF_PI = Math.PI / 2;\n// ellipoid pj_set_ell.c\nexport var SIXTH = 0.1666666666666666667;\n/* 1/6 */\nexport var RA4 = 0.04722222222222222222;\n/* 17/360 */\nexport var RA6 = 0.02215608465608465608;\nexport var EPSLN = 1.0e-10;\n// you'd think you could use Number.EPSILON above but that makes\n// Mollweide get into an infinate loop.\n\nexport var D2R = 0.01745329251994329577;\nexport var R2D = 57.29577951308232088;\nexport var FORTPI = Math.PI / 4;\nexport var TWO_PI = Math.PI * 2;\n// SPI is slightly greater than Math.PI, so values that exceed the -180..180\n// degree range by a tiny amount don't get wrapped. This prevents points that\n// have drifted from their original location along the 180th meridian (due to\n// floating point error) from changing their sign.\nexport var SPI = 3.14159265359;\n","var primeMeridian = {};\n\nprimeMeridian.greenwich = 0.0; // \"0dE\",\nprimeMeridian.lisbon = -9.131906111111; // \"9d07'54.862\\\"W\",\nprimeMeridian.paris = 2.337229166667; // \"2d20'14.025\\\"E\",\nprimeMeridian.bogota = -74.080916666667; // \"74d04'51.3\\\"W\",\nprimeMeridian.madrid = -3.687938888889; // \"3d41'16.58\\\"W\",\nprimeMeridian.rome = 12.452333333333; // \"12d27'8.4\\\"E\",\nprimeMeridian.bern = 7.439583333333; // \"7d26'22.5\\\"E\",\nprimeMeridian.jakarta = 106.807719444444; // \"106d48'27.79\\\"E\",\nprimeMeridian.ferro = -17.666666666667; // \"17d40'W\",\nprimeMeridian.brussels = 4.367975; // \"4d22'4.71\\\"E\",\nprimeMeridian.stockholm = 18.058277777778; // \"18d3'29.8\\\"E\",\nprimeMeridian.athens = 23.7163375; // \"23d42'58.815\\\"E\",\nprimeMeridian.oslo = 10.722916666667; // \"10d43'22.5\\\"E\"\n\nexport default primeMeridian;\n","export default {\n  mm: { to_meter: 0.001 },\n  cm: { to_meter: 0.01 },\n  ft: { to_meter: 0.3048 },\n  'us-ft': { to_meter: 1200 / 3937 },\n  fath: { to_meter: 1.8288 },\n  kmi: { to_meter: 1852 },\n  'us-ch': { to_meter: 20.1168402336805 },\n  'us-mi': { to_meter: 1609.34721869444 },\n  km: { to_meter: 1000 },\n  'ind-ft': { to_meter: 0.30479841 },\n  'ind-yd': { to_meter: 0.91439523 },\n  mi: { to_meter: 1609.344 },\n  yd: { to_meter: 0.9144 },\n  ch: { to_meter: 20.1168 },\n  link: { to_meter: 0.201168 },\n  dm: { to_meter: 0.1 },\n  in: { to_meter: 0.0254 },\n  'ind-ch': { to_meter: 20.11669506 },\n  'us-in': { to_meter: 0.025400050800101 },\n  'us-yd': { to_meter: 0.914401828803658 }\n};\n","var ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nexport default function match(obj, key) {\n  if (obj[key]) {\n    return obj[key];\n  }\n  var keys = Object.keys(obj);\n  var lkey = key.toLowerCase().replace(ignoredChar, '');\n  var i = -1;\n  var testkey, processedKey;\n  while (++i < keys.length) {\n    testkey = keys[i];\n    processedKey = testkey.toLowerCase().replace(ignoredChar, '');\n    if (processedKey === lkey) {\n      return obj[testkey];\n    }\n  }\n}\n","import { D2R } from './constants/values';\nimport PrimeMeridian from './constants/PrimeMeridian';\nimport units from './constants/units';\nimport match from './match';\n\n/**\n * @param {string} defData\n * @returns {import('./defs').ProjectionDefinition}\n */\nexport default function (defData) {\n  /** @type {import('./defs').ProjectionDefinition} */\n  var self = {};\n  var paramObj = defData.split('+').map(function (v) {\n    return v.trim();\n  }).filter(function (a) {\n    return a;\n  }).reduce(function (p, a) {\n    /** @type {Array<?>} */\n    var split = a.split('=');\n    split.push(true);\n    p[split[0].toLowerCase()] = split[1];\n    return p;\n  }, {});\n  var paramName, paramVal, paramOutname;\n  var params = {\n    proj: 'projName',\n    datum: 'datumCode',\n    rf: function (v) {\n      self.rf = parseFloat(v);\n    },\n    lat_0: function (v) {\n      self.lat0 = v * D2R;\n    },\n    lat_1: function (v) {\n      self.lat1 = v * D2R;\n    },\n    lat_2: function (v) {\n      self.lat2 = v * D2R;\n    },\n    lat_ts: function (v) {\n      self.lat_ts = v * D2R;\n    },\n    lon_0: function (v) {\n      self.long0 = v * D2R;\n    },\n    lon_1: function (v) {\n      self.long1 = v * D2R;\n    },\n    lon_2: function (v) {\n      self.long2 = v * D2R;\n    },\n    alpha: function (v) {\n      self.alpha = parseFloat(v) * D2R;\n    },\n    gamma: function (v) {\n      self.rectified_grid_angle = parseFloat(v) * D2R;\n    },\n    lonc: function (v) {\n      self.longc = v * D2R;\n    },\n    x_0: function (v) {\n      self.x0 = parseFloat(v);\n    },\n    y_0: function (v) {\n      self.y0 = parseFloat(v);\n    },\n    k_0: function (v) {\n      self.k0 = parseFloat(v);\n    },\n    k: function (v) {\n      self.k0 = parseFloat(v);\n    },\n    a: function (v) {\n      self.a = parseFloat(v);\n    },\n    b: function (v) {\n      self.b = parseFloat(v);\n    },\n    r: function (v) {\n      self.a = self.b = parseFloat(v);\n    },\n    r_a: function () {\n      self.R_A = true;\n    },\n    zone: function (v) {\n      self.zone = parseInt(v, 10);\n    },\n    south: function () {\n      self.utmSouth = true;\n    },\n    towgs84: function (v) {\n      self.datum_params = v.split(',').map(function (a) {\n        return parseFloat(a);\n      });\n    },\n    to_meter: function (v) {\n      self.to_meter = parseFloat(v);\n    },\n    units: function (v) {\n      self.units = v;\n      var unit = match(units, v);\n      if (unit) {\n        self.to_meter = unit.to_meter;\n      }\n    },\n    from_greenwich: function (v) {\n      self.from_greenwich = v * D2R;\n    },\n    pm: function (v) {\n      var pm = match(PrimeMeridian, v);\n      self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;\n    },\n    nadgrids: function (v) {\n      if (v === '@null') {\n        self.datumCode = 'none';\n      } else {\n        self.nadgrids = v;\n      }\n    },\n    axis: function (v) {\n      var legalAxis = 'ewnsud';\n      if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {\n        self.axis = v;\n      }\n    },\n    approx: function () {\n      self.approx = true;\n    }\n  };\n  for (paramName in paramObj) {\n    paramVal = paramObj[paramName];\n    if (paramName in params) {\n      paramOutname = params[paramName];\n      if (typeof paramOutname === 'function') {\n        paramOutname(paramVal);\n      } else {\n        self[paramOutname] = paramVal;\n      }\n    } else {\n      self[paramName] = paramVal;\n    }\n  }\n  if (typeof self.datumCode === 'string' && self.datumCode !== 'WGS84') {\n    self.datumCode = self.datumCode.toLowerCase();\n  }\n  return self;\n}\n","class PROJJSONBuilderBase {\n  static getId(node) {\n    const idNode = node.find((child) => Array.isArray(child) && child[0] === 'ID');\n    if (idNode && idNode.length >= 3) {\n      return {\n        authority: idNode[1],\n        code: parseInt(idNode[2], 10),\n      };\n    }\n    return null;\n  }\n\n  static convertUnit(node, type = 'unit') {\n    if (!node || node.length < 3) {\n      return { type, name: 'unknown', conversion_factor: null };\n    }\n\n    const name = node[1];\n    const conversionFactor = parseFloat(node[2]) || null;\n\n    const idNode = node.find((child) => Array.isArray(child) && child[0] === 'ID');\n    const id = idNode\n      ? {\n        authority: idNode[1],\n        code: parseInt(idNode[2], 10),\n      }\n      : null;\n\n    return {\n      type,\n      name,\n      conversion_factor: conversionFactor,\n      id,\n    };\n  }\n\n  static convertAxis(node) {\n    const name = node[1] || 'Unknown';\n\n    // Determine the direction\n    let direction;\n    const abbreviationMatch = name.match(/^\\((.)\\)$/); // Match abbreviations like \"(E)\" or \"(N)\"\n    if (abbreviationMatch) {\n      // Use the abbreviation to determine the direction\n      const abbreviation = abbreviationMatch[1].toUpperCase();\n      if (abbreviation === 'E') direction = 'east';\n      else if (abbreviation === 'N') direction = 'north';\n      else if (abbreviation === 'U') direction = 'up';\n      else throw new Error(`Unknown axis abbreviation: ${abbreviation}`);\n    } else {\n      // Use the explicit direction provided in the AXIS node\n      direction = node[2] ? node[2].toLowerCase() : 'unknown';\n    }\n\n    const orderNode = node.find((child) => Array.isArray(child) && child[0] === 'ORDER');\n    const order = orderNode ? parseInt(orderNode[1], 10) : null;\n\n    const unitNode = node.find(\n      (child) =>\n        Array.isArray(child) &&\n        (child[0] === 'LENGTHUNIT' || child[0] === 'ANGLEUNIT' || child[0] === 'SCALEUNIT')\n    );\n    const unit = this.convertUnit(unitNode);\n\n    return {\n      name,\n      direction, // Use the valid PROJJSON direction value\n      unit,\n      order,\n    };\n  }\n\n  static extractAxes(node) {\n    return node\n      .filter((child) => Array.isArray(child) && child[0] === 'AXIS')\n      .map((axis) => this.convertAxis(axis))\n      .sort((a, b) => (a.order || 0) - (b.order || 0)); // Sort by the \"order\" property\n  }\n\n  static convert(node, result = {}) {\n\n    switch (node[0]) {\n      case 'PROJCRS':\n        result.type = 'ProjectedCRS';\n        result.name = node[1];\n        result.base_crs = node.find((child) => Array.isArray(child) && child[0] === 'BASEGEOGCRS')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'BASEGEOGCRS'))\n          : null;\n        result.conversion = node.find((child) => Array.isArray(child) && child[0] === 'CONVERSION')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'CONVERSION'))\n          : null;\n\n        const csNode = node.find((child) => Array.isArray(child) && child[0] === 'CS');\n        if (csNode) {\n          result.coordinate_system = {\n            type: csNode[1],\n            axis: this.extractAxes(node),\n          };\n        }\n\n        const lengthUnitNode = node.find((child) => Array.isArray(child) && child[0] === 'LENGTHUNIT');\n        if (lengthUnitNode) {\n          const unit = this.convertUnit(lengthUnitNode);\n          result.coordinate_system.unit = unit; // Add unit to coordinate_system\n        }\n\n        result.id = this.getId(node);\n        break;\n\n      case 'BASEGEOGCRS':\n      case 'GEOGCRS':\n        result.type = 'GeographicCRS';\n        result.name = node[1];\n      \n        // Handle DATUM or ENSEMBLE\n        const datumOrEnsembleNode = node.find(\n          (child) => Array.isArray(child) && (child[0] === 'DATUM' || child[0] === 'ENSEMBLE')\n        );\n        if (datumOrEnsembleNode) {\n          const datumOrEnsemble = this.convert(datumOrEnsembleNode);\n          if (datumOrEnsembleNode[0] === 'ENSEMBLE') {\n            result.datum_ensemble = datumOrEnsemble;\n          } else {\n            result.datum = datumOrEnsemble;\n          }\n          const primem = node.find((child) => Array.isArray(child) && child[0] === 'PRIMEM');\n          if (primem && primem[1] !== 'Greenwich') {\n            datumOrEnsemble.prime_meridian = {\n              name: primem[1],\n              longitude: parseFloat(primem[2]),\n            }\n          }\n        }\n      \n        result.coordinate_system = {\n          type: 'ellipsoidal',\n          axis: this.extractAxes(node),\n        };\n      \n        result.id = this.getId(node);\n        break;\n\n      case 'DATUM':\n        result.type = 'GeodeticReferenceFrame';\n        result.name = node[1];\n        result.ellipsoid = node.find((child) => Array.isArray(child) && child[0] === 'ELLIPSOID')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'ELLIPSOID'))\n          : null;\n        break;\n      \n      case 'ENSEMBLE':\n        result.type = 'DatumEnsemble';\n        result.name = node[1];\n      \n        // Extract ensemble members\n        result.members = node\n          .filter((child) => Array.isArray(child) && child[0] === 'MEMBER')\n          .map((member) => ({\n            type: 'DatumEnsembleMember',\n            name: member[1],\n            id: this.getId(member), // Extract ID as { authority, code }\n          }));\n      \n        // Extract accuracy\n        const accuracyNode = node.find((child) => Array.isArray(child) && child[0] === 'ENSEMBLEACCURACY');\n        if (accuracyNode) {\n          result.accuracy = parseFloat(accuracyNode[1]);\n        }\n      \n        // Extract ellipsoid\n        const ellipsoidNode = node.find((child) => Array.isArray(child) && child[0] === 'ELLIPSOID');\n        if (ellipsoidNode) {\n          result.ellipsoid = this.convert(ellipsoidNode); // Convert the ellipsoid node\n        }\n      \n        // Extract identifier for the ensemble\n        result.id = this.getId(node);\n        break;\n\n      case 'ELLIPSOID':\n        result.type = 'Ellipsoid';\n        result.name = node[1];\n        result.semi_major_axis = parseFloat(node[2]);\n        result.inverse_flattening = parseFloat(node[3]);\n        const units = node.find((child) => Array.isArray(child) && child[0] === 'LENGTHUNIT')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'LENGTHUNIT'), result)\n          : null;\n        break;\n\n      case 'CONVERSION':\n        result.type = 'Conversion';\n        result.name = node[1];\n        result.method = node.find((child) => Array.isArray(child) && child[0] === 'METHOD')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'METHOD'))\n          : null;\n        result.parameters = node\n          .filter((child) => Array.isArray(child) && child[0] === 'PARAMETER')\n          .map((param) => this.convert(param));\n        break;\n\n      case 'METHOD':\n        result.type = 'Method';\n        result.name = node[1];\n        result.id = this.getId(node);\n        break;\n\n      case 'PARAMETER':\n        result.type = 'Parameter';\n        result.name = node[1];\n        result.value = parseFloat(node[2]);\n        result.unit = this.convertUnit(\n          node.find(\n            (child) =>\n              Array.isArray(child) &&\n              (child[0] === 'LENGTHUNIT' || child[0] === 'ANGLEUNIT' || child[0] === 'SCALEUNIT')\n          )\n        );\n        result.id = this.getId(node);\n        break;\n\n      case 'BOUNDCRS':\n        result.type = 'BoundCRS';\n\n        // Process SOURCECRS\n        const sourceCrsNode = node.find((child) => Array.isArray(child) && child[0] === 'SOURCECRS');\n        if (sourceCrsNode) {\n          const sourceCrsContent = sourceCrsNode.find((child) => Array.isArray(child));\n          result.source_crs = sourceCrsContent ? this.convert(sourceCrsContent) : null;\n        }\n\n        // Process TARGETCRS\n        const targetCrsNode = node.find((child) => Array.isArray(child) && child[0] === 'TARGETCRS');\n        if (targetCrsNode) {\n          const targetCrsContent = targetCrsNode.find((child) => Array.isArray(child));\n          result.target_crs = targetCrsContent ? this.convert(targetCrsContent) : null;\n        }\n\n        // Process ABRIDGEDTRANSFORMATION\n        const transformationNode = node.find((child) => Array.isArray(child) && child[0] === 'ABRIDGEDTRANSFORMATION');\n        if (transformationNode) {\n          result.transformation = this.convert(transformationNode);\n        } else {\n          result.transformation = null;\n        }\n        break;\n\n      case 'ABRIDGEDTRANSFORMATION':\n        result.type = 'Transformation';\n        result.name = node[1];\n        result.method = node.find((child) => Array.isArray(child) && child[0] === 'METHOD')\n          ? this.convert(node.find((child) => Array.isArray(child) && child[0] === 'METHOD'))\n          : null;\n\n        result.parameters = node\n          .filter((child) => Array.isArray(child) && (child[0] === 'PARAMETER' || child[0] === 'PARAMETERFILE'))\n          .map((param) => {\n            if (param[0] === 'PARAMETER') {\n              return this.convert(param);\n            } else if (param[0] === 'PARAMETERFILE') {\n              return {\n                name: param[1],\n                value: param[2],\n                id: {\n                  'authority': 'EPSG',\n                  'code': 8656\n                }\n              };\n            }\n          });\n\n        // Adjust the Scale difference parameter if present\n        if (result.parameters.length === 7) {\n          const scaleDifference = result.parameters[6];\n          if (scaleDifference.name === 'Scale difference') {\n            scaleDifference.value = Math.round((scaleDifference.value - 1) * 1e12) / 1e6;\n          }\n        }\n\n        result.id = this.getId(node);\n        break;\n      \n      case 'AXIS':\n        if (!result.coordinate_system) {\n          result.coordinate_system = { type: 'unspecified', axis: [] };\n        }\n        result.coordinate_system.axis.push(this.convertAxis(node));\n        break;\n      \n      case 'LENGTHUNIT':\n        const unit = this.convertUnit(node, 'LinearUnit');\n        if (result.coordinate_system && result.coordinate_system.axis) {\n          result.coordinate_system.axis.forEach((axis) => {\n            if (!axis.unit) {\n              axis.unit = unit;\n            }\n          });\n        }\n        if (unit.conversion_factor && unit.conversion_factor !== 1) {\n          if (result.semi_major_axis) {\n            result.semi_major_axis = {\n              value: result.semi_major_axis,\n              unit,\n            }\n          }\n        }\n        break;\n\n      default:\n        result.keyword = node[0];\n        break;\n    }\n\n    return result;\n  }\n}\n\nexport default PROJJSONBuilderBase;","import PROJJSONBuilderBase from './PROJJSONBuilderBase.js';\n\nclass PROJJSONBuilder2015 extends PROJJSONBuilderBase {\n  static convert(node, result = {}) {\n    super.convert(node, result);\n\n    // Skip `CS` and `USAGE` nodes for WKT2-2015\n    if (result.coordinate_system && result.coordinate_system.subtype === 'Cartesian') {\n      delete result.coordinate_system;\n    }\n    if (result.usage) {\n      delete result.usage;\n    }\n\n    return result;\n  }\n}\n\nexport default PROJJSONBuilder2015;","import PROJJSONBuilderBase from './PROJJSONBuilderBase.js';\n\nclass PROJJSONBuilder2019 extends PROJJSONBuilderBase {\n  static convert(node, result = {}) {\n    super.convert(node, result);\n\n    // Handle `CS` node for WKT2-2019\n    const csNode = node.find((child) => Array.isArray(child) && child[0] === 'CS');\n    if (csNode) {\n      result.coordinate_system = {\n        subtype: csNode[1],\n        axis: this.extractAxes(node),\n      };\n    }\n\n    // Handle `USAGE` node for WKT2-2019\n    const usageNode = node.find((child) => Array.isArray(child) && child[0] === 'USAGE');\n    if (usageNode) {\n      const scope = usageNode.find((child) => Array.isArray(child) && child[0] === 'SCOPE');\n      const area = usageNode.find((child) => Array.isArray(child) && child[0] === 'AREA');\n      const bbox = usageNode.find((child) => Array.isArray(child) && child[0] === 'BBOX');\n      result.usage = {};\n      if (scope) {\n        result.usage.scope = scope[1];\n      }\n      if (area) {\n        result.usage.area = area[1];\n      }\n      if (bbox) {\n        result.usage.bbox = bbox.slice(1);\n      }\n    }\n\n    return result;\n  }\n}\n\nexport default PROJJSONBuilder2019;","import PROJJSONBuilder2015 from './PROJJSONBuilder2015.js';\nimport PROJJSONBuilder2019 from './PROJJSONBuilder2019.js';\n\n/**\n * Detects the WKT2 version based on the structure of the WKT.\n * @param {Array} root The root WKT array node.\n * @returns {string} The detected version (\"2015\" or \"2019\").\n */\nfunction detectWKT2Version(root) {\n  // Check for WKT2-2019-specific nodes\n  if (root.find((child) => Array.isArray(child) && child[0] === 'USAGE')) {\n    return '2019'; // `USAGE` is specific to WKT2-2019\n  }\n\n  // Check for WKT2-2015-specific nodes\n  if (root.find((child) => Array.isArray(child) && child[0] === 'CS')) {\n    return '2015'; // `CS` is valid in both, but default to 2015 unless `USAGE` is present\n  }\n\n  if (root[0] === 'BOUNDCRS' || root[0] === 'PROJCRS' || root[0] === 'GEOGCRS') {\n    return '2015'; // These are valid in both, but default to 2015\n  }\n\n  // Default to WKT2-2015 if no specific indicators are found\n  return '2015';\n}\n\n/**\n * Builds a PROJJSON object from a WKT array structure.\n * @param {Array} root The root WKT array node.\n * @returns {Object} The PROJJSON object.\n */\nexport function buildPROJJSON(root) {\n  const version = detectWKT2Version(root);\n  const builder = version === '2019' ? PROJJSONBuilder2019 : PROJJSONBuilder2015;\n  return builder.convert(root);\n}\n","export default parseString;\n\nvar NEUTRAL = 1;\nvar KEYWORD = 2;\nvar NUMBER = 3;\nvar QUOTED = 4;\nvar AFTERQUOTE = 5;\nvar ENDED = -1;\nvar whitespace = /\\s/;\nvar latin = /[A-Za-z]/;\nvar keyword = /[A-Za-z84_]/;\nvar endThings = /[,\\]]/;\nvar digets = /[\\d\\.E\\-\\+]/;\n// const ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nfunction Parser(text) {\n  if (typeof text !== 'string') {\n    throw new Error('not a string');\n  }\n  this.text = text.trim();\n  this.level = 0;\n  this.place = 0;\n  this.root = null;\n  this.stack = [];\n  this.currentObject = null;\n  this.state = NEUTRAL;\n}\nParser.prototype.readCharicter = function() {\n  var char = this.text[this.place++];\n  if (this.state !== QUOTED) {\n    while (whitespace.test(char)) {\n      if (this.place >= this.text.length) {\n        return;\n      }\n      char = this.text[this.place++];\n    }\n  }\n  switch (this.state) {\n    case NEUTRAL:\n      return this.neutral(char);\n    case KEYWORD:\n      return this.keyword(char)\n    case QUOTED:\n      return this.quoted(char);\n    case AFTERQUOTE:\n      return this.afterquote(char);\n    case NUMBER:\n      return this.number(char);\n    case ENDED:\n      return;\n  }\n};\nParser.prototype.afterquote = function(char) {\n  if (char === '\"') {\n    this.word += '\"';\n    this.state = QUOTED;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = this.word.trim();\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in afterquote yet, index ' + this.place);\n};\nParser.prototype.afterItem = function(char) {\n  if (char === ',') {\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n    }\n    this.word = null;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (char === ']') {\n    this.level--;\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n      this.word = null;\n    }\n    this.state = NEUTRAL;\n    this.currentObject = this.stack.pop();\n    if (!this.currentObject) {\n      this.state = ENDED;\n    }\n\n    return;\n  }\n};\nParser.prototype.number = function(char) {\n  if (digets.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = parseFloat(this.word);\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in number yet, index ' + this.place);\n};\nParser.prototype.quoted = function(char) {\n  if (char === '\"') {\n    this.state = AFTERQUOTE;\n    return;\n  }\n  this.word += char;\n  return;\n};\nParser.prototype.keyword = function(char) {\n  if (keyword.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (char === '[') {\n    var newObjects = [];\n    newObjects.push(this.word);\n    this.level++;\n    if (this.root === null) {\n      this.root = newObjects;\n    } else {\n      this.currentObject.push(newObjects);\n    }\n    this.stack.push(this.currentObject);\n    this.currentObject = newObjects;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in keyword yet, index ' + this.place);\n};\nParser.prototype.neutral = function(char) {\n  if (latin.test(char)) {\n    this.word = char;\n    this.state = KEYWORD;\n    return;\n  }\n  if (char === '\"') {\n    this.word = '';\n    this.state = QUOTED;\n    return;\n  }\n  if (digets.test(char)) {\n    this.word = char;\n    this.state = NUMBER;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in neutral yet, index ' + this.place);\n};\nParser.prototype.output = function() {\n  while (this.place < this.text.length) {\n    this.readCharicter();\n  }\n  if (this.state === ENDED) {\n    return this.root;\n  }\n  throw new Error('unable to parse string \"' +this.text + '\". State is ' + this.state);\n};\n\nfunction parseString(txt) {\n  var parser = new Parser(txt);\n  return parser.output();\n}\n","\n\nfunction mapit(obj, key, value) {\n  if (Array.isArray(key)) {\n    value.unshift(key);\n    key = null;\n  }\n  var thing = key ? {} : obj;\n\n  var out = value.reduce(function(newObj, item) {\n    sExpr(item, newObj);\n    return newObj\n  }, thing);\n  if (key) {\n    obj[key] = out;\n  }\n}\n\nexport function sExpr(v, obj) {\n  if (!Array.isArray(v)) {\n    obj[v] = true;\n    return;\n  }\n  var key = v.shift();\n  if (key === 'PARAMETER') {\n    key = v.shift();\n  }\n  if (v.length === 1) {\n    if (Array.isArray(v[0])) {\n      obj[key] = {};\n      sExpr(v[0], obj[key]);\n      return;\n    }\n    obj[key] = v[0];\n    return;\n  }\n  if (!v.length) {\n    obj[key] = true;\n    return;\n  }\n  if (key === 'TOWGS84') {\n    obj[key] = v;\n    return;\n  }\n  if (key === 'AXIS') {\n    if (!(key in obj)) {\n      obj[key] = [];\n    }\n    obj[key].push(v);\n    return;\n  }\n  if (!Array.isArray(key)) {\n    obj[key] = {};\n  }\n\n  var i;\n  switch (key) {\n    case 'UNIT':\n    case 'PRIMEM':\n    case 'VERT_DATUM':\n      obj[key] = {\n        name: v[0].toLowerCase(),\n        convert: v[1]\n      };\n      if (v.length === 3) {\n        sExpr(v[2], obj[key]);\n      }\n      return;\n    case 'SPHEROID':\n    case 'ELLIPSOID':\n      obj[key] = {\n        name: v[0],\n        a: v[1],\n        rf: v[2]\n      };\n      if (v.length === 4) {\n        sExpr(v[3], obj[key]);\n      }\n      return;\n    case 'EDATUM':\n    case 'ENGINEERINGDATUM':\n    case 'LOCAL_DATUM':\n    case 'DATUM':\n    case 'VERT_CS':\n    case 'VERTCRS':\n    case 'VERTICALCRS':\n      v[0] = ['name', v[0]];\n      mapit(obj, key, v);\n      return;\n    case 'COMPD_CS':\n    case 'COMPOUNDCRS':\n    case 'FITTED_CS':\n    // the followings are the crs defined in\n    // https://github.com/proj4js/proj4js/blob/1da4ed0b865d0fcb51c136090569210cdcc9019e/lib/parseCode.js#L11\n    case 'PROJECTEDCRS':\n    case 'PROJCRS':\n    case 'GEOGCS':\n    case 'GEOCCS':\n    case 'PROJCS':\n    case 'LOCAL_CS':\n    case 'GEODCRS':\n    case 'GEODETICCRS':\n    case 'GEODETICDATUM':\n    case 'ENGCRS':\n    case 'ENGINEERINGCRS':\n      v[0] = ['name', v[0]];\n      mapit(obj, key, v);\n      obj[key].type = key;\n      return;\n    default:\n      i = -1;\n      while (++i < v.length) {\n        if (!Array.isArray(v[i])) {\n          return sExpr(v, obj[key]);\n        }\n      }\n      return mapit(obj, key, v);\n  }\n}\n","var D2R = 0.01745329251994329577;\n\nexport function d2r(input) {\n  return input * D2R;\n}\n\nexport function applyProjectionDefaults(wkt) {\n  // Normalize projName for WKT2 compatibility\n  const normalizedProjName = (wkt.projName || '').toLowerCase().replace(/_/g, ' ');\n\n  if (!wkt.long0 && wkt.longc && (normalizedProjName === 'albers conic equal area' || normalizedProjName === 'lambert azimuthal equal area')) {\n    wkt.long0 = wkt.longc;\n  }\n  if (!wkt.lat_ts && wkt.lat1 && (normalizedProjName === 'stereographic south pole' || normalizedProjName === 'polar stereographic (variant b)')) {\n    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n    wkt.lat_ts = wkt.lat1;\n    delete wkt.lat1;\n  } else if (!wkt.lat_ts && wkt.lat0 && (normalizedProjName === 'polar stereographic' || normalizedProjName === 'polar stereographic (variant a)')) {\n    wkt.lat_ts = wkt.lat0;\n    wkt.lat0 = d2r(wkt.lat0 > 0 ? 90 : -90);\n    delete wkt.lat1;\n  }\n}","import { applyProjectionDefaults } from './util.js';\n\n// Helper function to process units and to_meter\nfunction processUnit(unit) {\n  let result = { units: null, to_meter: undefined };\n\n  if (typeof unit === 'string') {\n    result.units = unit.toLowerCase();\n    if (result.units === 'metre') {\n      result.units = 'meter'; // Normalize 'metre' to 'meter'\n    }\n    if (result.units === 'meter') {\n      result.to_meter = 1; // Only set to_meter if units are 'meter'\n    }\n  } else if (unit && unit.name) {\n    result.units = unit.name.toLowerCase();\n    if (result.units === 'metre') {\n      result.units = 'meter'; // Normalize 'metre' to 'meter'\n    }\n    result.to_meter = unit.conversion_factor;\n  }\n\n  return result;\n}\n\nfunction toValue(valueOrObject) {\n  if (typeof valueOrObject === 'object') {\n    return valueOrObject.value * valueOrObject.unit.conversion_factor;\n  }\n  return valueOrObject;\n}\n\nfunction calculateEllipsoid(value, result) {\n  if (value.ellipsoid.radius) {\n    result.a = value.ellipsoid.radius;\n    result.rf = 0;\n  } else {\n    result.a = toValue(value.ellipsoid.semi_major_axis);\n    if (value.ellipsoid.inverse_flattening !== undefined) {\n      result.rf = value.ellipsoid.inverse_flattening;\n    } else if (value.ellipsoid.semi_major_axis !== undefined && value.ellipsoid.semi_minor_axis !== undefined) {\n      result.rf = result.a / (result.a - toValue(value.ellipsoid.semi_minor_axis));\n    }\n  }\n}\n\nexport function transformPROJJSON(projjson, result = {}) {\n  if (!projjson || typeof projjson !== 'object') {\n    return projjson; // Return primitive values as-is\n  }\n\n  if (projjson.type === 'BoundCRS') {\n    transformPROJJSON(projjson.source_crs, result);\n\n    if (projjson.transformation) {\n      if (projjson.transformation.method && projjson.transformation.method.name === 'NTv2') {\n        // Set nadgrids to the filename from the parameterfile\n        result.nadgrids = projjson.transformation.parameters[0].value;\n      } else {\n        // Populate datum_params if no parameterfile is found\n        result.datum_params = projjson.transformation.parameters.map((param) => param.value);\n      }\n    }\n    return result; // Return early for BoundCRS\n  }\n\n  // Handle specific keys in PROJJSON\n  Object.keys(projjson).forEach((key) => {\n    const value = projjson[key];\n    if (value === null) {\n      return;\n    }\n\n    switch (key) {\n      case 'name':\n        if (result.srsCode) {\n          break;\n        }\n        result.name = value;\n        result.srsCode = value; // Map `name` to `srsCode`\n        break;\n\n      case 'type':\n        if (value === 'GeographicCRS') {\n          result.projName = 'longlat';\n        } else if (value === 'ProjectedCRS' && projjson.conversion && projjson.conversion.method) {\n          result.projName = projjson.conversion.method.name; // Retain original capitalization\n        }\n        break;\n\n      case 'datum':\n      case 'datum_ensemble': // Handle both datum and ensemble\n        if (value.ellipsoid) {\n          // Extract ellipsoid properties\n          result.ellps = value.ellipsoid.name;\n          calculateEllipsoid(value, result);\n        }\n        if (value.prime_meridian) {\n          result.from_greenwich = value.prime_meridian.longitude * Math.PI / 180; // Convert to radians\n        }\n        break;\n\n      case 'ellipsoid':\n        result.ellps = value.name;\n        calculateEllipsoid(value, result);\n        break;\n\n      case 'prime_meridian':\n        result.long0 = (value.longitude || 0) * Math.PI / 180; // Convert to radians\n        break;\n\n      case 'coordinate_system':\n        if (value.axis) {\n          result.axis = value.axis\n            .map((axis) => {\n              const direction = axis.direction;\n              if (direction === 'east') return 'e';\n              if (direction === 'north') return 'n';\n              if (direction === 'west') return 'w';\n              if (direction === 'south') return 's';\n              throw new Error(`Unknown axis direction: ${direction}`);\n            })\n            .join('') + 'u'; // Combine into a single string (e.g., \"enu\")\n\n          if (value.unit) {\n            const { units, to_meter } = processUnit(value.unit);\n            result.units = units;\n            result.to_meter = to_meter;\n          } else if (value.axis[0] && value.axis[0].unit) {\n            const { units, to_meter } = processUnit(value.axis[0].unit);\n            result.units = units;\n            result.to_meter = to_meter;\n          }\n        }\n        break;\n        \n      case 'id':\n        if (value.authority && value.code) {\n          result.title = value.authority + ':' + value.code;\n        }\n        break;\n\n      case 'conversion':\n        if (value.method && value.method.name) {\n          result.projName = value.method.name; // Retain original capitalization\n        }\n        if (value.parameters) {\n          value.parameters.forEach((param) => {\n            const paramName = param.name.toLowerCase().replace(/\\s+/g, '_');\n            const paramValue = param.value;\n            if (param.unit && param.unit.conversion_factor) {\n              result[paramName] = paramValue * param.unit.conversion_factor; // Convert to radians or meters\n            } else if (param.unit === 'degree') {\n              result[paramName] = paramValue * Math.PI / 180; // Convert to radians\n            } else {\n              result[paramName] = paramValue;\n            }\n          });\n        }\n        break;\n\n      case 'unit':\n        if (value.name) {\n          result.units = value.name.toLowerCase();\n          if (result.units === 'metre') {\n            result.units = 'meter';\n          }\n        }\n        if (value.conversion_factor) {\n          result.to_meter = value.conversion_factor;\n        }\n        break;\n\n      case 'base_crs':\n        transformPROJJSON(value, result); // Pass `result` directly\n        result.datumCode = value.id ? value.id.authority + '_' + value.id.code : value.name; // Set datumCode\n        break;\n\n      default:\n        // Ignore irrelevant or unneeded properties\n        break;\n    }\n  });\n\n  // Additional calculated properties\n  if (result.latitude_of_false_origin !== undefined) {\n    result.lat0 = result.latitude_of_false_origin; // Already in radians\n  }\n  if (result.longitude_of_false_origin !== undefined) {\n    result.long0 = result.longitude_of_false_origin;\n  }\n  if (result.latitude_of_standard_parallel !== undefined) {\n    result.lat0 = result.latitude_of_standard_parallel;\n    result.lat1 = result.latitude_of_standard_parallel;\n  }\n  if (result.latitude_of_1st_standard_parallel !== undefined) {\n    result.lat1 = result.latitude_of_1st_standard_parallel;\n  }\n  if (result.latitude_of_2nd_standard_parallel !== undefined) {\n    result.lat2 = result.latitude_of_2nd_standard_parallel; \n  }\n  if (result.latitude_of_projection_centre !== undefined) {\n    result.lat0 = result.latitude_of_projection_centre;\n  }\n  if (result.longitude_of_projection_centre !== undefined) {\n    result.longc = result.longitude_of_projection_centre;\n  }\n  if (result.easting_at_false_origin !== undefined) {\n    result.x0 = result.easting_at_false_origin;\n  }\n  if (result.northing_at_false_origin !== undefined) {\n    result.y0 = result.northing_at_false_origin;\n  }\n  if (result.latitude_of_natural_origin !== undefined) {\n    result.lat0 = result.latitude_of_natural_origin;\n  }\n  if (result.longitude_of_natural_origin !== undefined) {\n    result.long0 = result.longitude_of_natural_origin;\n  }\n  if (result.longitude_of_origin !== undefined) {\n    result.long0 = result.longitude_of_origin;\n  }\n  if (result.false_easting !== undefined) {\n    result.x0 = result.false_easting;\n  }\n  if (result.easting_at_projection_centre) {\n    result.x0 = result.easting_at_projection_centre;\n  }\n  if (result.false_northing !== undefined) {\n    result.y0 = result.false_northing;\n  }\n  if (result.northing_at_projection_centre) {\n    result.y0 = result.northing_at_projection_centre;\n  }\n  if (result.standard_parallel_1 !== undefined) {\n    result.lat1 = result.standard_parallel_1;\n  }\n  if (result.standard_parallel_2 !== undefined) {\n    result.lat2 = result.standard_parallel_2;\n  }\n  if (result.scale_factor_at_natural_origin !== undefined) {\n    result.k0 = result.scale_factor_at_natural_origin;\n  }\n  if (result.scale_factor_at_projection_centre !== undefined) {\n    result.k0 = result.scale_factor_at_projection_centre;\n  }\n  if (result.scale_factor_on_pseudo_standard_parallel !== undefined) {  \n    result.k0 = result.scale_factor_on_pseudo_standard_parallel;\n  }\n  if (result.azimuth !== undefined) {\n    result.alpha = result.azimuth;\n  }\n  if (result.azimuth_at_projection_centre !== undefined) {\n    result.alpha = result.azimuth_at_projection_centre;\n  }\n  if (result.angle_from_rectified_to_skew_grid) {\n    result.rectified_grid_angle = result.angle_from_rectified_to_skew_grid;\n  }\n\n  // Apply projection defaults\n  applyProjectionDefaults(result);\n\n  return result;\n}","import { buildPROJJSON } from './buildPROJJSON.js';\nimport { detectWKTVersion } from './detectWKTVersion.js';\nimport parser from './parser.js';\nimport {sExpr} from './process.js';\nimport { transformPROJJSON } from './transformPROJJSON.js';\nimport { applyProjectionDefaults, d2r } from './util.js';\n\nvar knownTypes = ['PROJECTEDCRS', 'PROJCRS', 'GEOGCS', 'GEOCCS', 'PROJCS', 'LOCAL_CS', 'GEODCRS',\n  'GEODETICCRS', 'GEODETICDATUM', 'ENGCRS', 'ENGINEERINGCRS'];\n\nfunction rename(obj, params) {\n  var outName = params[0];\n  var inName = params[1];\n  if (!(outName in obj) && (inName in obj)) {\n    obj[outName] = obj[inName];\n    if (params.length === 3) {\n      obj[outName] = params[2](obj[outName]);\n    }\n  }\n}\n\nfunction cleanWKT(wkt) {\n  var keys = Object.keys(wkt);\n  for (var i = 0, ii = keys.length; i <ii; ++i) {\n    var key = keys[i];\n    // the followings are the crs defined in\n    // https://github.com/proj4js/proj4js/blob/1da4ed0b865d0fcb51c136090569210cdcc9019e/lib/parseCode.js#L11\n    if (knownTypes.indexOf(key) !== -1) {\n      setPropertiesFromWkt(wkt[key]);\n    }\n    if (typeof wkt[key] === 'object') {\n      cleanWKT(wkt[key]);\n    }\n  }\n}\n\nfunction setPropertiesFromWkt(wkt) {\n  if (wkt.AUTHORITY) {\n    var authority = Object.keys(wkt.AUTHORITY)[0];\n    if (authority && authority in wkt.AUTHORITY) {\n      wkt.title = authority + ':' + wkt.AUTHORITY[authority];\n    }\n  }\n  if (wkt.type === 'GEOGCS') {\n    wkt.projName = 'longlat';\n  } else if (wkt.type === 'LOCAL_CS') {\n    wkt.projName = 'identity';\n    wkt.local = true;\n  } else {\n    if (typeof wkt.PROJECTION === 'object') {\n      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n    } else {\n      wkt.projName = wkt.PROJECTION;\n    }\n  }\n  if (wkt.AXIS) {\n    var axisOrder = '';\n    for (var i = 0, ii = wkt.AXIS.length; i < ii; ++i) {\n      var axis = [wkt.AXIS[i][0].toLowerCase(), wkt.AXIS[i][1].toLowerCase()];\n      if (axis[0].indexOf('north') !== -1 || ((axis[0] === 'y' || axis[0] === 'lat') && axis[1] === 'north')) {\n        axisOrder += 'n';\n      } else if (axis[0].indexOf('south') !== -1 || ((axis[0] === 'y' || axis[0] === 'lat') && axis[1] === 'south')) {\n        axisOrder += 's';\n      } else if (axis[0].indexOf('east') !== -1 || ((axis[0] === 'x' || axis[0] === 'lon') && axis[1] === 'east')) {\n        axisOrder += 'e';\n      } else if (axis[0].indexOf('west') !== -1 || ((axis[0] === 'x' || axis[0] === 'lon') && axis[1] === 'west')) {\n        axisOrder += 'w';\n      }\n    }\n    if (axisOrder.length === 2) {\n      axisOrder += 'u';\n    }\n    if (axisOrder.length === 3) {\n      wkt.axis = axisOrder;\n    }\n  }\n  if (wkt.UNIT) {\n    wkt.units = wkt.UNIT.name.toLowerCase();\n    if (wkt.units === 'metre') {\n      wkt.units = 'meter';\n    }\n    if (wkt.UNIT.convert) {\n      if (wkt.type === 'GEOGCS') {\n        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;\n        }\n      } else {\n        wkt.to_meter = wkt.UNIT.convert;\n      }\n    }\n  }\n  var geogcs = wkt.GEOGCS;\n  if (wkt.type === 'GEOGCS') {\n    geogcs = wkt;\n  }\n  if (geogcs) {\n    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n    //}\n    if (geogcs.DATUM) {\n      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n    } else {\n      wkt.datumCode = geogcs.name.toLowerCase();\n    }\n    if (wkt.datumCode.slice(0, 2) === 'd_') {\n      wkt.datumCode = wkt.datumCode.slice(2);\n    }\n    if (wkt.datumCode === 'new_zealand_1949') {\n      wkt.datumCode = 'nzgd49';\n    }\n    if (wkt.datumCode === 'wgs_1984' || wkt.datumCode === 'world_geodetic_system_1984') {\n      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n        wkt.sphere = true;\n      }\n      wkt.datumCode = 'wgs84';\n    }\n    if (wkt.datumCode === 'belge_1972') {\n      wkt.datumCode = 'rnb72';\n    }\n    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n        wkt.ellps = 'intl';\n      }\n\n      wkt.a = geogcs.DATUM.SPHEROID.a;\n      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {\n      wkt.datum_params = geogcs.DATUM.TOWGS84;\n    }\n    if (~wkt.datumCode.indexOf('osgb_1936')) {\n      wkt.datumCode = 'osgb36';\n    }\n    if (~wkt.datumCode.indexOf('osni_1952')) {\n      wkt.datumCode = 'osni52';\n    }\n    if (~wkt.datumCode.indexOf('tm65')\n      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n      wkt.datumCode = 'ire65';\n    }\n    if (wkt.datumCode === 'ch1903+') {\n      wkt.datumCode = 'ch1903';\n    }\n    if (~wkt.datumCode.indexOf('israel')) {\n      wkt.datumCode = 'isr93';\n    }\n  }\n  if (wkt.b && !isFinite(wkt.b)) {\n    wkt.b = wkt.a;\n  }\n  if (wkt.rectified_grid_angle) {\n    wkt.rectified_grid_angle = d2r(wkt.rectified_grid_angle);\n  }\n\n  function toMeter(input) {\n    var ratio = wkt.to_meter || 1;\n    return input * ratio;\n  }\n  var renamer = function(a) {\n    return rename(wkt, a);\n  };\n  var list = [\n    ['standard_parallel_1', 'Standard_Parallel_1'],\n    ['standard_parallel_1', 'Latitude of 1st standard parallel'],\n    ['standard_parallel_2', 'Standard_Parallel_2'],\n    ['standard_parallel_2', 'Latitude of 2nd standard parallel'],\n    ['false_easting', 'False_Easting'],\n    ['false_easting', 'False easting'],\n    ['false-easting', 'Easting at false origin'],\n    ['false_northing', 'False_Northing'],\n    ['false_northing', 'False northing'],\n    ['false_northing', 'Northing at false origin'],\n    ['central_meridian', 'Central_Meridian'],\n    ['central_meridian', 'Longitude of natural origin'],\n    ['central_meridian', 'Longitude of false origin'],\n    ['latitude_of_origin', 'Latitude_Of_Origin'],\n    ['latitude_of_origin', 'Central_Parallel'],\n    ['latitude_of_origin', 'Latitude of natural origin'],\n    ['latitude_of_origin', 'Latitude of false origin'],\n    ['scale_factor', 'Scale_Factor'],\n    ['k0', 'scale_factor'],\n    ['latitude_of_center', 'Latitude_Of_Center'],\n    ['latitude_of_center', 'Latitude_of_center'],\n    ['lat0', 'latitude_of_center', d2r],\n    ['longitude_of_center', 'Longitude_Of_Center'],\n    ['longitude_of_center', 'Longitude_of_center'],\n    ['longc', 'longitude_of_center', d2r],\n    ['x0', 'false_easting', toMeter],\n    ['y0', 'false_northing', toMeter],\n    ['long0', 'central_meridian', d2r],\n    ['lat0', 'latitude_of_origin', d2r],\n    ['lat0', 'standard_parallel_1', d2r],\n    ['lat1', 'standard_parallel_1', d2r],\n    ['lat2', 'standard_parallel_2', d2r],\n    ['azimuth', 'Azimuth'],\n    ['alpha', 'azimuth', d2r],\n    ['srsCode', 'name']\n  ];\n  list.forEach(renamer);\n  applyProjectionDefaults(wkt);\n}\nexport default function(wkt) {\n  if (typeof wkt === 'object') {\n    return transformPROJJSON(wkt);\n  }\n  const version = detectWKTVersion(wkt);\n  var lisp = parser(wkt);\n  if (version === 'WKT2') {\n    const projjson = buildPROJJSON(lisp);\n    return transformPROJJSON(projjson);\n  }\n  var type = lisp[0];\n  var obj = {};\n  sExpr(lisp, obj);\n  cleanWKT(obj);\n  return obj[type];\n}\n","/**\n * Detects whether the WKT string is WKT1 or WKT2.\n * @param {string} wkt The WKT string.\n * @returns {string} The detected version (\"WKT1\" or \"WKT2\").\n */\nexport function detectWKTVersion(wkt) {\n  // Normalize the WKT string for easier keyword matching\n  const normalizedWKT = wkt.toUpperCase();\n\n  // Check for WKT2-specific keywords\n  if (\n    normalizedWKT.includes('PROJCRS') ||\n    normalizedWKT.includes('GEOGCRS') ||\n    normalizedWKT.includes('BOUNDCRS') ||\n    normalizedWKT.includes('VERTCRS') ||\n    normalizedWKT.includes('LENGTHUNIT') ||\n    normalizedWKT.includes('ANGLEUNIT') ||\n    normalizedWKT.includes('SCALEUNIT')\n  ) {\n    return 'WKT2';\n  }\n\n  // Check for WKT1-specific keywords\n  if (\n    normalizedWKT.includes('PROJCS') ||\n    normalizedWKT.includes('GEOGCS') ||\n    normalizedWKT.includes('LOCAL_CS') ||\n    normalizedWKT.includes('VERT_CS') ||\n    normalizedWKT.includes('UNIT')\n  ) {\n    return 'WKT1';\n  }\n\n  // Default to WKT1 if no specific indicators are found\n  return 'WKT1';\n}","import globals from './global';\nimport parseProj from './projString';\nimport wkt from 'wkt-parser';\n\n/**\n * @typedef {Object} ProjectionDefinition\n * @property {string} title\n * @property {string} [projName]\n * @property {string} [ellps]\n * @property {import('./Proj.js').DatumDefinition} [datum]\n * @property {string} [datumName]\n * @property {number} [rf]\n * @property {number} [lat0]\n * @property {number} [lat1]\n * @property {number} [lat2]\n * @property {number} [lat_ts]\n * @property {number} [long0]\n * @property {number} [long1]\n * @property {number} [long2]\n * @property {number} [alpha]\n * @property {number} [longc]\n * @property {number} [x0]\n * @property {number} [y0]\n * @property {number} [k0]\n * @property {number} [a]\n * @property {number} [b]\n * @property {true} [R_A]\n * @property {number} [zone]\n * @property {true} [utmSouth]\n * @property {string|Array<number>} [datum_params]\n * @property {number} [to_meter]\n * @property {string} [units]\n * @property {number} [from_greenwich]\n * @property {string} [datumCode]\n * @property {string} [nadgrids]\n * @property {string} [axis]\n * @property {boolean} [sphere]\n * @property {number} [rectified_grid_angle]\n * @property {boolean} [approx]\n * @property {<T extends import('./core').TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} inverse\n * @property {<T extends import('./core').TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} forward\n */\n\n/**\n * @overload\n * @param {string} name\n * @param {string|ProjectionDefinition|import('./core.js').PROJJSONDefinition} projection\n * @returns {void}\n */\n/**\n * @overload\n * @param {Array<[string, string]>} name\n * @returns {Array<ProjectionDefinition|undefined>}\n */\n/**\n * @overload\n * @param {string} name\n * @returns {ProjectionDefinition}\n */\n\n/**\n * @param {string | Array<Array<string>> | Partial<Record<'EPSG'|'ESRI'|'IAU2000', ProjectionDefinition>>} name\n * @returns {ProjectionDefinition | Array<ProjectionDefinition|undefined> | void}\n */\nfunction defs(name) {\n  /* global console */\n  var that = this;\n  if (arguments.length === 2) {\n    var def = arguments[1];\n    if (typeof def === 'string') {\n      if (def.charAt(0) === '+') {\n        defs[/** @type {string} */ (name)] = parseProj(arguments[1]);\n      } else {\n        defs[/** @type {string} */ (name)] = wkt(arguments[1]);\n      }\n    } else {\n      defs[/** @type {string} */ (name)] = def;\n    }\n  } else if (arguments.length === 1) {\n    if (Array.isArray(name)) {\n      return name.map(function (v) {\n        if (Array.isArray(v)) {\n          return defs.apply(that, v);\n        } else {\n          return defs(v);\n        }\n      });\n    } else if (typeof name === 'string') {\n      if (name in defs) {\n        return defs[name];\n      }\n    } else if ('EPSG' in name) {\n      defs['EPSG:' + name.EPSG] = name;\n    } else if ('ESRI' in name) {\n      defs['ESRI:' + name.ESRI] = name;\n    } else if ('IAU2000' in name) {\n      defs['IAU2000:' + name.IAU2000] = name;\n    } else {\n      console.log(name);\n    }\n    return;\n  }\n}\nglobals(defs);\nexport default defs;\n","export default function (defs) {\n  defs('EPSG:4326', '+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees');\n  defs('EPSG:4269', '+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees');\n  defs('EPSG:3857', '+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs');\n  // UTM WGS84\n  for (var i = 1; i <= 60; ++i) {\n    defs('EPSG:' + (32600 + i), '+proj=utm +zone=' + i + ' +datum=WGS84 +units=m');\n    defs('EPSG:' + (32700 + i), '+proj=utm +zone=' + i + ' +south +datum=WGS84 +units=m');\n  }\n\n  defs.WGS84 = defs['EPSG:4326'];\n  defs['EPSG:3785'] = defs['EPSG:3857']; // maintain backward compat, official code is 3857\n  defs.GOOGLE = defs['EPSG:3857'];\n  defs['EPSG:900913'] = defs['EPSG:3857'];\n  defs['EPSG:102113'] = defs['EPSG:3857'];\n}\n","import defs from './defs';\nimport wkt from 'wkt-parser';\nimport projStr from './projString';\nimport match from './match';\nfunction testObj(code) {\n  return typeof code === 'string';\n}\nfunction testDef(code) {\n  return code in defs;\n}\nfunction testWKT(code) {\n  return (code.indexOf('+') !== 0 && code.indexOf('[') !== -1) || (typeof code === 'object' && !('srsCode' in code));\n}\nvar codes = ['3857', '900913', '3785', '102113'];\nfunction checkMercator(item) {\n  var auth = match(item, 'authority');\n  if (!auth) {\n    return;\n  }\n  var code = match(auth, 'epsg');\n  return code && codes.indexOf(code) > -1;\n}\nfunction checkProjStr(item) {\n  var ext = match(item, 'extension');\n  if (!ext) {\n    return;\n  }\n  return match(ext, 'proj4');\n}\nfunction testProj(code) {\n  return code[0] === '+';\n}\n/**\n * @param {string | import('./core').PROJJSONDefinition | import('./defs').ProjectionDefinition} code\n * @returns {import('./defs').ProjectionDefinition}\n */\nfunction parse(code) {\n  if (testObj(code)) {\n    // check to see if this is a WKT string\n    if (testDef(code)) {\n      return defs[code];\n    }\n    if (testWKT(code)) {\n      var out = wkt(code);\n      // test of spetial case, due to this being a very common and often malformed\n      if (checkMercator(out)) {\n        return defs['EPSG:3857'];\n      }\n      var maybeProjStr = checkProjStr(out);\n      if (maybeProjStr) {\n        return projStr(maybeProjStr);\n      }\n      return out;\n    }\n    if (testProj(code)) {\n      return projStr(code);\n    }\n  } else if (!('projName' in code)) {\n    return wkt(code);\n  } else {\n    return code;\n  }\n}\n\nexport default parse;\n","export default function (destination, source) {\n  destination = destination || {};\n  var value, property;\n  if (!source) {\n    return destination;\n  }\n  for (property in source) {\n    value = source[property];\n    if (value !== undefined) {\n      destination[property] = value;\n    }\n  }\n  return destination;\n}\n","export default function (eccent, sinphi, cosphi) {\n  var con = eccent * sinphi;\n  return cosphi / (Math.sqrt(1 - con * con));\n}\n","export default function (x) {\n  return x < 0 ? -1 : 1;\n}\n","import { TWO_PI, SPI } from '../constants/values';\nimport sign from './sign';\n\nexport default function (x) {\n  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));\n}\n","import { HALF_PI } from '../constants/values';\n\nexport default function (eccent, phi, sinphi) {\n  var con = eccent * sinphi;\n  var com = 0.5 * eccent;\n  con = Math.pow(((1 - con) / (1 + con)), com);\n  return (Math.tan(0.5 * (HALF_PI - phi)) / con);\n}\n","import { HALF_PI } from '../constants/values';\n\nexport default function (eccent, ts) {\n  var eccnth = 0.5 * eccent;\n  var con, dphi;\n  var phi = HALF_PI - 2 * Math.atan(ts);\n  for (var i = 0; i <= 15; i++) {\n    con = eccent * Math.sin(phi);\n    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n  // console.log(\"phi2z has NoConvergence\");\n  return -9999;\n}\n","import msfnz from '../common/msfnz';\n\nimport adjust_lon from '../common/adjust_lon';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport { FORTPI, R2D, EPSLN, HALF_PI } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} es\n * @property {number} e\n * @property {number} k\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  var con = this.b / this.a;\n  this.es = 1 - con * con;\n  if (!('x0' in this)) {\n    this.x0 = 0;\n  }\n  if (!('y0' in this)) {\n    this.y0 = 0;\n  }\n  this.e = Math.sqrt(this.es);\n  if (this.lat_ts) {\n    if (this.sphere) {\n      this.k0 = Math.cos(this.lat_ts);\n    } else {\n      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n    }\n  } else {\n    if (!this.k0) {\n      if (this.k) {\n        this.k0 = this.k;\n      } else {\n        this.k0 = 1;\n      }\n    }\n  }\n}\n\n/* Mercator forward equations--mapping lat,long to x,y\n  -------------------------------------------------- */\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  // convert to radians\n  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {\n    return null;\n  }\n\n  var x, y;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    return null;\n  } else {\n    if (this.sphere) {\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));\n    } else {\n      var sinphi = Math.sin(lat);\n      var ts = tsfnz(this.e, lat, sinphi);\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 - this.a * this.k0 * Math.log(ts);\n    }\n    p.x = x;\n    p.y = y;\n    return p;\n  }\n}\n\n/* Mercator inverse equations--mapping x,y to lat/long\n  -------------------------------------------------- */\nexport function inverse(p) {\n  var x = p.x - this.x0;\n  var y = p.y - this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));\n  } else {\n    var ts = Math.exp(-y / (this.a * this.k0));\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  lon = adjust_lon(this.long0 + x / (this.a * this.k0));\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Mercator', 'Popular Visualisation Pseudo Mercator', 'Mercator_1SP', 'Mercator_Auxiliary_Sphere', 'Mercator_Variant_A', 'merc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export function init() {\n  // no-op for longlat\n}\n\nfunction identity(pt) {\n  return pt;\n}\nexport { identity as forward };\nexport { identity as inverse };\nexport var names = ['longlat', 'identity'];\nexport default {\n  init: init,\n  forward: identity,\n  inverse: identity,\n  names: names\n};\n","import merc from './projections/merc';\nimport longlat from './projections/longlat';\n/** @type {Array<Partial<import('./Proj').default>>} */\nvar projs = [merc, longlat];\nvar names = {};\nvar projStore = [];\n\n/**\n * @param {import('./Proj').default} proj\n * @param {number} i\n */\nexport function add(proj, i) {\n  var len = projStore.length;\n  if (!proj.names) {\n    console.log(i);\n    return true;\n  }\n  projStore[len] = proj;\n  proj.names.forEach(function (n) {\n    names[n.toLowerCase()] = len;\n  });\n  return this;\n}\n\nexport function getNormalizedProjName(n) {\n  return n.replace(/[-\\(\\)\\s]+/g, ' ').trim().replace(/ /g, '_');\n}\n\n/**\n * Get a projection by name.\n * @param {string} name\n * @returns {import('./Proj').default|false}\n */\nexport function get(name) {\n  if (!name) {\n    return false;\n  }\n  var n = name.toLowerCase();\n  if (typeof names[n] !== 'undefined' && projStore[names[n]]) {\n    return projStore[names[n]];\n  }\n  n = getNormalizedProjName(n);\n  if (n in names && projStore[names[n]]) {\n    return projStore[names[n]];\n  }\n}\n\nexport function start() {\n  projs.forEach(add);\n}\nexport default {\n  start: start,\n  add: add,\n  get: get\n};\n","var ellipsoids = {\n  MERIT: {\n    a: 6378137,\n    rf: 298.257,\n    ellipseName: 'MERIT 1983'\n  },\n  SGS85: {\n    a: 6378136,\n    rf: 298.257,\n    ellipseName: 'Soviet Geodetic System 85'\n  },\n  GRS80: {\n    a: 6378137,\n    rf: 298.257222101,\n    ellipseName: 'GRS 1980(IUGG, 1980)'\n  },\n  IAU76: {\n    a: 6378140,\n    rf: 298.257,\n    ellipseName: 'IAU 1976'\n  },\n  airy: {\n    a: 6377563.396,\n    b: 6356256.91,\n    ellipseName: 'Airy 1830'\n  },\n  APL4: {\n    a: 6378137,\n    rf: 298.25,\n    ellipseName: 'Appl. Physics. 1965'\n  },\n  NWL9D: {\n    a: 6378145,\n    rf: 298.25,\n    ellipseName: 'Naval Weapons Lab., 1965'\n  },\n  mod_airy: {\n    a: 6377340.189,\n    b: 6356034.446,\n    ellipseName: 'Modified Airy'\n  },\n  andrae: {\n    a: 6377104.43,\n    rf: 300,\n    ellipseName: 'Andrae 1876 (Den., Iclnd.)'\n  },\n  aust_SA: {\n    a: 6378160,\n    rf: 298.25,\n    ellipseName: 'Australian Natl & S. Amer. 1969'\n  },\n  GRS67: {\n    a: 6378160,\n    rf: 298.247167427,\n    ellipseName: 'GRS 67(IUGG 1967)'\n  },\n  bessel: {\n    a: 6377397.155,\n    rf: 299.1528128,\n    ellipseName: 'Bessel 1841'\n  },\n  bess_nam: {\n    a: 6377483.865,\n    rf: 299.1528128,\n    ellipseName: 'Bessel 1841 (Namibia)'\n  },\n  clrk66: {\n    a: 6378206.4,\n    b: 6356583.8,\n    ellipseName: 'Clarke 1866'\n  },\n  clrk80: {\n    a: 6378249.145,\n    rf: 293.4663,\n    ellipseName: 'Clarke 1880 mod.'\n  },\n  clrk80ign: {\n    a: 6378249.2,\n    b: 6356515,\n    rf: 293.4660213,\n    ellipseName: 'Clarke 1880 (IGN)'\n  },\n  clrk58: {\n    a: 6378293.645208759,\n    rf: 294.2606763692654,\n    ellipseName: 'Clarke 1858'\n  },\n  CPM: {\n    a: 6375738.7,\n    rf: 334.29,\n    ellipseName: 'Comm. des Poids et Mesures 1799'\n  },\n  delmbr: {\n    a: 6376428,\n    rf: 311.5,\n    ellipseName: 'Delambre 1810 (Belgium)'\n  },\n  engelis: {\n    a: 6378136.05,\n    rf: 298.2566,\n    ellipseName: 'Engelis 1985'\n  },\n  evrst30: {\n    a: 6377276.345,\n    rf: 300.8017,\n    ellipseName: 'Everest 1830'\n  },\n  evrst48: {\n    a: 6377304.063,\n    rf: 300.8017,\n    ellipseName: 'Everest 1948'\n  },\n  evrst56: {\n    a: 6377301.243,\n    rf: 300.8017,\n    ellipseName: 'Everest 1956'\n  },\n  evrst69: {\n    a: 6377295.664,\n    rf: 300.8017,\n    ellipseName: 'Everest 1969'\n  },\n  evrstSS: {\n    a: 6377298.556,\n    rf: 300.8017,\n    ellipseName: 'Everest (Sabah & Sarawak)'\n  },\n  fschr60: {\n    a: 6378166,\n    rf: 298.3,\n    ellipseName: 'Fischer (Mercury Datum) 1960'\n  },\n  fschr60m: {\n    a: 6378155,\n    rf: 298.3,\n    ellipseName: 'Fischer 1960'\n  },\n  fschr68: {\n    a: 6378150,\n    rf: 298.3,\n    ellipseName: 'Fischer 1968'\n  },\n  helmert: {\n    a: 6378200,\n    rf: 298.3,\n    ellipseName: 'Helmert 1906'\n  },\n  hough: {\n    a: 6378270,\n    rf: 297,\n    ellipseName: 'Hough'\n  },\n  intl: {\n    a: 6378388,\n    rf: 297,\n    ellipseName: 'International 1909 (Hayford)'\n  },\n  kaula: {\n    a: 6378163,\n    rf: 298.24,\n    ellipseName: 'Kaula 1961'\n  },\n  lerch: {\n    a: 6378139,\n    rf: 298.257,\n    ellipseName: 'Lerch 1979'\n  },\n  mprts: {\n    a: 6397300,\n    rf: 191,\n    ellipseName: 'Maupertius 1738'\n  },\n  new_intl: {\n    a: 6378157.5,\n    b: 6356772.2,\n    ellipseName: 'New International 1967'\n  },\n  plessis: {\n    a: 6376523,\n    rf: 6355863,\n    ellipseName: 'Plessis 1817 (France)'\n  },\n  krass: {\n    a: 6378245,\n    rf: 298.3,\n    ellipseName: 'Krassovsky, 1942'\n  },\n  SEasia: {\n    a: 6378155,\n    b: 6356773.3205,\n    ellipseName: 'Southeast Asia'\n  },\n  walbeck: {\n    a: 6376896,\n    b: 6355834.8467,\n    ellipseName: 'Walbeck'\n  },\n  WGS60: {\n    a: 6378165,\n    rf: 298.3,\n    ellipseName: 'WGS 60'\n  },\n  WGS66: {\n    a: 6378145,\n    rf: 298.25,\n    ellipseName: 'WGS 66'\n  },\n  WGS7: {\n    a: 6378135,\n    rf: 298.26,\n    ellipseName: 'WGS 72'\n  },\n  WGS84: {\n    a: 6378137,\n    rf: 298.257223563,\n    ellipseName: 'WGS 84'\n  },\n  sphere: {\n    a: 6370997,\n    b: 6370997,\n    ellipseName: 'Normal Sphere (r=6370997)'\n  }\n};\n\nexport default ellipsoids;\n","import { SIXTH, RA4, RA6, EPSLN } from './constants/values';\nimport { default as Ellipsoid } from './constants/Ellipsoid';\nimport match from './match';\n\nconst WGS84 = Ellipsoid.WGS84; // default ellipsoid\n\nexport function eccentricity(a, b, rf, R_A) {\n  var a2 = a * a; // used in geocentric\n  var b2 = b * b; // used in geocentric\n  var es = (a2 - b2) / a2; // e ^ 2\n  var e = 0;\n  if (R_A) {\n    a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));\n    a2 = a * a;\n    es = 0;\n  } else {\n    e = Math.sqrt(es); // eccentricity\n  }\n  var ep2 = (a2 - b2) / b2; // used in geocentric\n  return {\n    es: es,\n    e: e,\n    ep2: ep2\n  };\n}\nexport function sphere(a, b, rf, ellps, sphere) {\n  if (!a) { // do we have an ellipsoid?\n    var ellipse = match(Ellipsoid, ellps);\n    if (!ellipse) {\n      ellipse = WGS84;\n    }\n    a = ellipse.a;\n    b = ellipse.b;\n    rf = ellipse.rf;\n  }\n\n  if (rf && !b) {\n    b = (1.0 - 1.0 / rf) * a;\n  }\n  if (rf === 0 || Math.abs(a - b) < EPSLN) {\n    sphere = true;\n    b = a;\n  }\n  return {\n    a: a,\n    b: b,\n    rf: rf,\n    sphere: sphere\n  };\n}\n","var datums = {\n  wgs84: {\n    towgs84: '0,0,0',\n    ellipse: 'WGS84',\n    datumName: 'WGS84'\n  },\n  ch1903: {\n    towgs84: '674.374,15.056,405.346',\n    ellipse: 'bessel',\n    datumName: 'swiss'\n  },\n  ggrs87: {\n    towgs84: '-199.87,74.79,246.62',\n    ellipse: 'GRS80',\n    datumName: 'Greek_Geodetic_Reference_System_1987'\n  },\n  nad83: {\n    towgs84: '0,0,0',\n    ellipse: 'GRS80',\n    datumName: 'North_American_Datum_1983'\n  },\n  nad27: {\n    nadgrids: '@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat',\n    ellipse: 'clrk66',\n    datumName: 'North_American_Datum_1927'\n  },\n  potsdam: {\n    towgs84: '598.1,73.7,418.2,0.202,0.045,-2.455,6.7',\n    ellipse: 'bessel',\n    datumName: 'Potsdam Rauenberg 1950 DHDN'\n  },\n  carthage: {\n    towgs84: '-263.0,6.0,431.0',\n    ellipse: 'clark80',\n    datumName: 'Carthage 1934 Tunisia'\n  },\n  hermannskogel: {\n    towgs84: '577.326,90.129,463.919,5.137,1.474,5.297,2.4232',\n    ellipse: 'bessel',\n    datumName: 'Hermannskogel'\n  },\n  mgi: {\n    towgs84: '577.326,90.129,463.919,5.137,1.474,5.297,2.4232',\n    ellipse: 'bessel',\n    datumName: 'Militar-Geographische Institut'\n  },\n  osni52: {\n    towgs84: '482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15',\n    ellipse: 'airy',\n    datumName: 'Irish National'\n  },\n  ire65: {\n    towgs84: '482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15',\n    ellipse: 'mod_airy',\n    datumName: 'Ireland 1965'\n  },\n  rassadiran: {\n    towgs84: '-133.63,-157.5,-158.62',\n    ellipse: 'intl',\n    datumName: 'Rassadiran'\n  },\n  nzgd49: {\n    towgs84: '59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993',\n    ellipse: 'intl',\n    datumName: 'New Zealand Geodetic Datum 1949'\n  },\n  osgb36: {\n    towgs84: '446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894',\n    ellipse: 'airy',\n    datumName: 'Ordnance Survey of Great Britain 1936'\n  },\n  s_jtsk: {\n    towgs84: '589,76,480',\n    ellipse: 'bessel',\n    datumName: 'S-JTSK (Ferro)'\n  },\n  beduaram: {\n    towgs84: '-106,-87,188',\n    ellipse: 'clrk80',\n    datumName: 'Beduaram'\n  },\n  gunung_segara: {\n    towgs84: '-403,684,41',\n    ellipse: 'bessel',\n    datumName: 'Gunung Segara Jakarta'\n  },\n  rnb72: {\n    towgs84: '106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1',\n    ellipse: 'intl',\n    datumName: 'Reseau National Belge 1972'\n  },\n  EPSG_5451: {\n    towgs84: '6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649'\n  },\n  IGNF_LURESG: {\n    towgs84: '-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43'\n  },\n  EPSG_4614: {\n    towgs84: '-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065'\n  },\n  EPSG_4615: {\n    towgs84: '-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748'\n  },\n  ESRI_37241: {\n    towgs84: '-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031'\n  },\n  ESRI_37249: {\n    towgs84: '-440.296,58.548,296.265,1.128,10.202,4.559,-0.438'\n  },\n  ESRI_37245: {\n    towgs84: '-511.151,-181.269,139.609,1.05,2.703,1.798,3.071'\n  },\n  EPSG_4178: {\n    towgs84: '24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01'\n  },\n  EPSG_4622: {\n    towgs84: '-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984'\n  },\n  EPSG_4625: {\n    towgs84: '126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227'\n  },\n  EPSG_5252: {\n    towgs84: '0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439'\n  },\n  EPSG_4314: {\n    towgs84: '597.1,71.4,412.1,0.894,0.068,-1.563,7.58'\n  },\n  EPSG_4282: {\n    towgs84: '-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166'\n  },\n  EPSG_4231: {\n    towgs84: '-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218'\n  },\n  EPSG_4274: {\n    towgs84: '-230.994,102.591,25.199,0.633,-0.239,0.9,1.95'\n  },\n  EPSG_4134: {\n    towgs84: '-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006'\n  },\n  EPSG_4254: {\n    towgs84: '18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013'\n  },\n  EPSG_4159: {\n    towgs84: '-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175'\n  },\n  EPSG_4687: {\n    towgs84: '0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093'\n  },\n  EPSG_4227: {\n    towgs84: '-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225'\n  },\n  EPSG_4746: {\n    towgs84: '599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46'\n  },\n  EPSG_4745: {\n    towgs84: '612.4,77,440.2,-0.054,0.057,-2.797,2.55'\n  },\n  EPSG_6311: {\n    towgs84: '8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926'\n  },\n  EPSG_4289: {\n    towgs84: '565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244'\n  },\n  EPSG_4230: {\n    towgs84: '-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4'\n  },\n  EPSG_4154: {\n    towgs84: '-123.02,-158.95,-168.47'\n  },\n  EPSG_4156: {\n    towgs84: '570.8,85.7,462.8,4.998,1.587,5.261,3.56'\n  },\n  EPSG_4299: {\n    towgs84: '482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15'\n  },\n  EPSG_4179: {\n    towgs84: '33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84'\n  },\n  EPSG_4313: {\n    towgs84: '-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747'\n  },\n  EPSG_4194: {\n    towgs84: '163.511,127.533,-159.789'\n  },\n  EPSG_4195: {\n    towgs84: '105,326,-102.5'\n  },\n  EPSG_4196: {\n    towgs84: '-45,417,-3.5'\n  },\n  EPSG_4611: {\n    towgs84: '-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246'\n  },\n  EPSG_4633: {\n    towgs84: '137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824'\n  },\n  EPSG_4641: {\n    towgs84: '-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993'\n  },\n  EPSG_4643: {\n    towgs84: '-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002'\n  },\n  EPSG_4300: {\n    towgs84: '482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15'\n  },\n  EPSG_4188: {\n    towgs84: '482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15'\n  },\n  EPSG_4660: {\n    towgs84: '982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805'\n  },\n  EPSG_4662: {\n    towgs84: '97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259'\n  },\n  EPSG_3906: {\n    towgs84: '577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664'\n  },\n  EPSG_4307: {\n    towgs84: '-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547'\n  },\n  EPSG_6892: {\n    towgs84: '-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686'\n  },\n  EPSG_4690: {\n    towgs84: '221.597,152.441,176.523,2.403,1.3893,0.884,11.4648'\n  },\n  EPSG_4691: {\n    towgs84: '218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817'\n  },\n  EPSG_4629: {\n    towgs84: '72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653'\n  },\n  EPSG_4630: {\n    towgs84: '165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111'\n  },\n  EPSG_4692: {\n    towgs84: '217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093'\n  },\n  EPSG_9333: {\n    towgs84: '0,0,0,-8.393,0.749,-10.276,0'\n  },\n  EPSG_9059: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4312: {\n    towgs84: '601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887'\n  },\n  EPSG_4123: {\n    towgs84: '-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496'\n  },\n  EPSG_4309: {\n    towgs84: '-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365'\n  },\n  ESRI_104106: {\n    towgs84: '-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058'\n  },\n  EPSG_4281: {\n    towgs84: '-219.247,-73.802,269.529'\n  },\n  EPSG_4322: {\n    towgs84: '0,0,4.5'\n  },\n  EPSG_4324: {\n    towgs84: '0,0,1.9'\n  },\n  EPSG_4284: {\n    towgs84: '43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549'\n  },\n  EPSG_4277: {\n    towgs84: '446.448,-125.157,542.06,0.15,0.247,0.842,-20.489'\n  },\n  EPSG_4207: {\n    towgs84: '-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46'\n  },\n  EPSG_4688: {\n    towgs84: '347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647'\n  },\n  EPSG_4689: {\n    towgs84: '410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218'\n  },\n  EPSG_4720: {\n    towgs84: '0,0,4.5'\n  },\n  EPSG_4273: {\n    towgs84: '278.3,93,474.5,7.889,0.05,-6.61,6.21'\n  },\n  EPSG_4240: {\n    towgs84: '204.64,834.74,293.8'\n  },\n  EPSG_4817: {\n    towgs84: '278.3,93,474.5,7.889,0.05,-6.61,6.21'\n  },\n  ESRI_104131: {\n    towgs84: '426.62,142.62,460.09,4.98,4.49,-12.42,-17.1'\n  },\n  EPSG_4265: {\n    towgs84: '-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68'\n  },\n  EPSG_4263: {\n    towgs84: '-111.92,-87.85,114.5,1.875,0.202,0.219,0.032'\n  },\n  EPSG_4298: {\n    towgs84: '-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536'\n  },\n  EPSG_4270: {\n    towgs84: '-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424'\n  },\n  EPSG_4229: {\n    towgs84: '-121.8,98.1,-10.7'\n  },\n  EPSG_4220: {\n    towgs84: '-55.5,-348,-229.2'\n  },\n  EPSG_4214: {\n    towgs84: '12.646,-155.176,-80.863'\n  },\n  EPSG_4232: {\n    towgs84: '-345,3,223'\n  },\n  EPSG_4238: {\n    towgs84: '-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037'\n  },\n  EPSG_4168: {\n    towgs84: '-170,33,326'\n  },\n  EPSG_4131: {\n    towgs84: '199,931,318.9'\n  },\n  EPSG_4152: {\n    towgs84: '-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0'\n  },\n  EPSG_5228: {\n    towgs84: '572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378'\n  },\n  EPSG_8351: {\n    towgs84: '485.021,169.465,483.839,7.786342,4.397554,4.102655,0'\n  },\n  EPSG_4683: {\n    towgs84: '-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06'\n  },\n  EPSG_4133: {\n    towgs84: '0,0,0'\n  },\n  EPSG_7373: {\n    towgs84: '0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693'\n  },\n  EPSG_9075: {\n    towgs84: '-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0'\n  },\n  EPSG_9072: {\n    towgs84: '-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0'\n  },\n  EPSG_9294: {\n    towgs84: '1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388'\n  },\n  EPSG_4212: {\n    towgs84: '-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492'\n  },\n  EPSG_4191: {\n    towgs84: '-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703'\n  },\n  EPSG_4237: {\n    towgs84: '52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191'\n  },\n  EPSG_4740: {\n    towgs84: '-1.08,-0.27,-0.9'\n  },\n  EPSG_4124: {\n    towgs84: '419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496'\n  },\n  EPSG_5681: {\n    towgs84: '584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922'\n  },\n  EPSG_4141: {\n    towgs84: '23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262'\n  },\n  EPSG_4204: {\n    towgs84: '-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194'\n  },\n  EPSG_4319: {\n    towgs84: '226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798'\n  },\n  EPSG_4200: {\n    towgs84: '24.82,-131.21,-82.66'\n  },\n  EPSG_4130: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4127: {\n    towgs84: '-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359'\n  },\n  EPSG_4149: {\n    towgs84: '674.374,15.056,405.346'\n  },\n  EPSG_4617: {\n    towgs84: '-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0'\n  },\n  EPSG_4663: {\n    towgs84: '-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485'\n  },\n  EPSG_4664: {\n    towgs84: '-211.939,137.626,58.3,-0.089,0.251,0.079,0.384'\n  },\n  EPSG_4665: {\n    towgs84: '-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048'\n  },\n  EPSG_4666: {\n    towgs84: '631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43'\n  },\n  EPSG_4756: {\n    towgs84: '-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188'\n  },\n  EPSG_4723: {\n    towgs84: '-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925'\n  },\n  EPSG_4726: {\n    towgs84: '8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081'\n  },\n  EPSG_4267: {\n    towgs84: '-8.0,160.0,176.0'\n  },\n  EPSG_5365: {\n    towgs84: '-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693'\n  },\n  EPSG_4218: {\n    towgs84: '304.5,306.5,-318.1'\n  },\n  EPSG_4242: {\n    towgs84: '-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95'\n  },\n  EPSG_4216: {\n    towgs84: '-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289'\n  },\n  ESRI_104105: {\n    towgs84: '631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43'\n  },\n  ESRI_104129: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4673: {\n    towgs84: '174.05,-25.49,112.57'\n  },\n  EPSG_4202: {\n    towgs84: '-124,-60,154'\n  },\n  EPSG_4203: {\n    towgs84: '-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191'\n  },\n  EPSG_3819: {\n    towgs84: '595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408'\n  },\n  EPSG_8694: {\n    towgs84: '-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169'\n  },\n  EPSG_4145: {\n    towgs84: '275.57,676.78,229.6'\n  },\n  EPSG_4283: {\n    towgs84: '61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994'\n  },\n  EPSG_4317: {\n    towgs84: '2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266'\n  },\n  EPSG_4272: {\n    towgs84: '59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993'\n  },\n  EPSG_4248: {\n    towgs84: '-307.7,265.3,-363.5'\n  },\n  EPSG_5561: {\n    towgs84: '24,-121,-76'\n  },\n  EPSG_5233: {\n    towgs84: '-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338'\n  },\n  ESRI_104130: {\n    towgs84: '-86,-98,-119'\n  },\n  ESRI_104102: {\n    towgs84: '682,-203,480'\n  },\n  ESRI_37207: {\n    towgs84: '7,-10,-26'\n  },\n  EPSG_4675: {\n    towgs84: '59.935,118.4,-10.871'\n  },\n  ESRI_104109: {\n    towgs84: '-89.121,-348.182,260.871'\n  },\n  ESRI_104112: {\n    towgs84: '-185.583,-230.096,281.361'\n  },\n  ESRI_104113: {\n    towgs84: '25.1,-275.6,222.6'\n  },\n  IGNF_WGS72G: {\n    towgs84: '0,12,6'\n  },\n  IGNF_NTFG: {\n    towgs84: '-168,-60,320'\n  },\n  IGNF_EFATE57G: {\n    towgs84: '-127,-769,472'\n  },\n  IGNF_PGP50G: {\n    towgs84: '324.8,153.6,172.1'\n  },\n  IGNF_REUN47G: {\n    towgs84: '94,-948,-1262'\n  },\n  IGNF_CSG67G: {\n    towgs84: '-186,230,110'\n  },\n  IGNF_GUAD48G: {\n    towgs84: '-467,-16,-300'\n  },\n  IGNF_TAHI51G: {\n    towgs84: '162,117,154'\n  },\n  IGNF_TAHAAG: {\n    towgs84: '65,342,77'\n  },\n  IGNF_NUKU72G: {\n    towgs84: '84,274,65'\n  },\n  IGNF_PETRELS72G: {\n    towgs84: '365,194,166'\n  },\n  IGNF_WALL78G: {\n    towgs84: '253,-133,-127'\n  },\n  IGNF_MAYO50G: {\n    towgs84: '-382,-59,-262'\n  },\n  IGNF_TANNAG: {\n    towgs84: '-139,-967,436'\n  },\n  IGNF_IGN72G: {\n    towgs84: '-13,-348,292'\n  },\n  IGNF_ATIGG: {\n    towgs84: '1118,23,66'\n  },\n  IGNF_FANGA84G: {\n    towgs84: '150.57,158.33,118.32'\n  },\n  IGNF_RUSAT84G: {\n    towgs84: '202.13,174.6,-15.74'\n  },\n  IGNF_KAUE70G: {\n    towgs84: '126.74,300.1,-75.49'\n  },\n  IGNF_MOP90G: {\n    towgs84: '-10.8,-1.8,12.77'\n  },\n  IGNF_MHPF67G: {\n    towgs84: '338.08,212.58,-296.17'\n  },\n  IGNF_TAHI79G: {\n    towgs84: '160.61,116.05,153.69'\n  },\n  IGNF_ANAA92G: {\n    towgs84: '1.5,3.84,4.81'\n  },\n  IGNF_MARQUI72G: {\n    towgs84: '330.91,-13.92,58.56'\n  },\n  IGNF_APAT86G: {\n    towgs84: '143.6,197.82,74.05'\n  },\n  IGNF_TUBU69G: {\n    towgs84: '237.17,171.61,-77.84'\n  },\n  IGNF_STPM50G: {\n    towgs84: '11.363,424.148,373.13'\n  },\n  EPSG_4150: {\n    towgs84: '674.374,15.056,405.346'\n  },\n  EPSG_4754: {\n    towgs84: '-208.4058,-109.8777,-2.5764'\n  },\n  ESRI_104101: {\n    towgs84: '374,150,588'\n  },\n  EPSG_4693: {\n    towgs84: '0,-0.15,0.68'\n  },\n  EPSG_6207: {\n    towgs84: '293.17,726.18,245.36'\n  },\n  EPSG_4153: {\n    towgs84: '-133.63,-157.5,-158.62'\n  },\n  EPSG_4132: {\n    towgs84: '-241.54,-163.64,396.06'\n  },\n  EPSG_4221: {\n    towgs84: '-154.5,150.7,100.4'\n  },\n  EPSG_4266: {\n    towgs84: '-80.7,-132.5,41.1'\n  },\n  EPSG_4193: {\n    towgs84: '-70.9,-151.8,-41.4'\n  },\n  EPSG_5340: {\n    towgs84: '-0.41,0.46,-0.35'\n  },\n  EPSG_4246: {\n    towgs84: '-294.7,-200.1,525.5'\n  },\n  EPSG_4318: {\n    towgs84: '-3.2,-5.7,2.8'\n  },\n  EPSG_4121: {\n    towgs84: '-199.87,74.79,246.62'\n  },\n  EPSG_4223: {\n    towgs84: '-260.1,5.5,432.2'\n  },\n  EPSG_4158: {\n    towgs84: '-0.465,372.095,171.736'\n  },\n  EPSG_4285: {\n    towgs84: '-128.16,-282.42,21.93'\n  },\n  EPSG_4613: {\n    towgs84: '-404.78,685.68,45.47'\n  },\n  EPSG_4607: {\n    towgs84: '195.671,332.517,274.607'\n  },\n  EPSG_4475: {\n    towgs84: '-381.788,-57.501,-256.673'\n  },\n  EPSG_4208: {\n    towgs84: '-157.84,308.54,-146.6'\n  },\n  EPSG_4743: {\n    towgs84: '70.995,-335.916,262.898'\n  },\n  EPSG_4710: {\n    towgs84: '-323.65,551.39,-491.22'\n  },\n  EPSG_7881: {\n    towgs84: '-0.077,0.079,0.086'\n  },\n  EPSG_4682: {\n    towgs84: '283.729,735.942,261.143'\n  },\n  EPSG_4739: {\n    towgs84: '-156,-271,-189'\n  },\n  EPSG_4679: {\n    towgs84: '-80.01,253.26,291.19'\n  },\n  EPSG_4750: {\n    towgs84: '-56.263,16.136,-22.856'\n  },\n  EPSG_4644: {\n    towgs84: '-10.18,-350.43,291.37'\n  },\n  EPSG_4695: {\n    towgs84: '-103.746,-9.614,-255.95'\n  },\n  EPSG_4292: {\n    towgs84: '-355,21,72'\n  },\n  EPSG_4302: {\n    towgs84: '-61.702,284.488,472.052'\n  },\n  EPSG_4143: {\n    towgs84: '-124.76,53,466.79'\n  },\n  EPSG_4606: {\n    towgs84: '-153,153,307'\n  },\n  EPSG_4699: {\n    towgs84: '-770.1,158.4,-498.2'\n  },\n  EPSG_4247: {\n    towgs84: '-273.5,110.6,-357.9'\n  },\n  EPSG_4160: {\n    towgs84: '8.88,184.86,106.69'\n  },\n  EPSG_4161: {\n    towgs84: '-233.43,6.65,173.64'\n  },\n  EPSG_9251: {\n    towgs84: '-9.5,122.9,138.2'\n  },\n  EPSG_9253: {\n    towgs84: '-78.1,101.6,133.3'\n  },\n  EPSG_4297: {\n    towgs84: '-198.383,-240.517,-107.909'\n  },\n  EPSG_4269: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4301: {\n    towgs84: '-147,506,687'\n  },\n  EPSG_4618: {\n    towgs84: '-59,-11,-52'\n  },\n  EPSG_4612: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4678: {\n    towgs84: '44.585,-131.212,-39.544'\n  },\n  EPSG_4250: {\n    towgs84: '-130,29,364'\n  },\n  EPSG_4144: {\n    towgs84: '214,804,268'\n  },\n  EPSG_4147: {\n    towgs84: '-17.51,-108.32,-62.39'\n  },\n  EPSG_4259: {\n    towgs84: '-254.1,-5.36,-100.29'\n  },\n  EPSG_4164: {\n    towgs84: '-76,-138,67'\n  },\n  EPSG_4211: {\n    towgs84: '-378.873,676.002,-46.255'\n  },\n  EPSG_4182: {\n    towgs84: '-422.651,-172.995,84.02'\n  },\n  EPSG_4224: {\n    towgs84: '-143.87,243.37,-33.52'\n  },\n  EPSG_4225: {\n    towgs84: '-205.57,168.77,-4.12'\n  },\n  EPSG_5527: {\n    towgs84: '-67.35,3.88,-38.22'\n  },\n  EPSG_4752: {\n    towgs84: '98,390,-22'\n  },\n  EPSG_4310: {\n    towgs84: '-30,190,89'\n  },\n  EPSG_9248: {\n    towgs84: '-192.26,65.72,132.08'\n  },\n  EPSG_4680: {\n    towgs84: '124.5,-63.5,-281'\n  },\n  EPSG_4701: {\n    towgs84: '-79.9,-158,-168.9'\n  },\n  EPSG_4706: {\n    towgs84: '-146.21,112.63,4.05'\n  },\n  EPSG_4805: {\n    towgs84: '682,-203,480'\n  },\n  EPSG_4201: {\n    towgs84: '-165,-11,206'\n  },\n  EPSG_4210: {\n    towgs84: '-157,-2,-299'\n  },\n  EPSG_4183: {\n    towgs84: '-104,167,-38'\n  },\n  EPSG_4139: {\n    towgs84: '11,72,-101'\n  },\n  EPSG_4668: {\n    towgs84: '-86,-98,-119'\n  },\n  EPSG_4717: {\n    towgs84: '-2,151,181'\n  },\n  EPSG_4732: {\n    towgs84: '102,52,-38'\n  },\n  EPSG_4280: {\n    towgs84: '-377,681,-50'\n  },\n  EPSG_4209: {\n    towgs84: '-138,-105,-289'\n  },\n  EPSG_4261: {\n    towgs84: '31,146,47'\n  },\n  EPSG_4658: {\n    towgs84: '-73,46,-86'\n  },\n  EPSG_4721: {\n    towgs84: '265.025,384.929,-194.046'\n  },\n  EPSG_4222: {\n    towgs84: '-136,-108,-292'\n  },\n  EPSG_4601: {\n    towgs84: '-255,-15,71'\n  },\n  EPSG_4602: {\n    towgs84: '725,685,536'\n  },\n  EPSG_4603: {\n    towgs84: '72,213.7,93'\n  },\n  EPSG_4605: {\n    towgs84: '9,183,236'\n  },\n  EPSG_4621: {\n    towgs84: '137,248,-430'\n  },\n  EPSG_4657: {\n    towgs84: '-28,199,5'\n  },\n  EPSG_4316: {\n    towgs84: '103.25,-100.4,-307.19'\n  },\n  EPSG_4642: {\n    towgs84: '-13,-348,292'\n  },\n  EPSG_4698: {\n    towgs84: '145,-187,103'\n  },\n  EPSG_4192: {\n    towgs84: '-206.1,-174.7,-87.7'\n  },\n  EPSG_4311: {\n    towgs84: '-265,120,-358'\n  },\n  EPSG_4135: {\n    towgs84: '58,-283,-182'\n  },\n  ESRI_104138: {\n    towgs84: '198,-226,-347'\n  },\n  EPSG_4245: {\n    towgs84: '-11,851,5'\n  },\n  EPSG_4142: {\n    towgs84: '-125,53,467'\n  },\n  EPSG_4213: {\n    towgs84: '-106,-87,188'\n  },\n  EPSG_4253: {\n    towgs84: '-133,-77,-51'\n  },\n  EPSG_4129: {\n    towgs84: '-132,-110,-335'\n  },\n  EPSG_4713: {\n    towgs84: '-77,-128,142'\n  },\n  EPSG_4239: {\n    towgs84: '217,823,299'\n  },\n  EPSG_4146: {\n    towgs84: '295,736,257'\n  },\n  EPSG_4155: {\n    towgs84: '-83,37,124'\n  },\n  EPSG_4165: {\n    towgs84: '-173,253,27'\n  },\n  EPSG_4672: {\n    towgs84: '175,-38,113'\n  },\n  EPSG_4236: {\n    towgs84: '-637,-549,-203'\n  },\n  EPSG_4251: {\n    towgs84: '-90,40,88'\n  },\n  EPSG_4271: {\n    towgs84: '-2,374,172'\n  },\n  EPSG_4175: {\n    towgs84: '-88,4,101'\n  },\n  EPSG_4716: {\n    towgs84: '298,-304,-375'\n  },\n  EPSG_4315: {\n    towgs84: '-23,259,-9'\n  },\n  EPSG_4744: {\n    towgs84: '-242.2,-144.9,370.3'\n  },\n  EPSG_4244: {\n    towgs84: '-97,787,86'\n  },\n  EPSG_4293: {\n    towgs84: '616,97,-251'\n  },\n  EPSG_4714: {\n    towgs84: '-127,-769,472'\n  },\n  EPSG_4736: {\n    towgs84: '260,12,-147'\n  },\n  EPSG_6883: {\n    towgs84: '-235,-110,393'\n  },\n  EPSG_6894: {\n    towgs84: '-63,176,185'\n  },\n  EPSG_4205: {\n    towgs84: '-43,-163,45'\n  },\n  EPSG_4256: {\n    towgs84: '41,-220,-134'\n  },\n  EPSG_4262: {\n    towgs84: '639,405,60'\n  },\n  EPSG_4604: {\n    towgs84: '174,359,365'\n  },\n  EPSG_4169: {\n    towgs84: '-115,118,426'\n  },\n  EPSG_4620: {\n    towgs84: '-106,-129,165'\n  },\n  EPSG_4184: {\n    towgs84: '-203,141,53'\n  },\n  EPSG_4616: {\n    towgs84: '-289,-124,60'\n  },\n  EPSG_9403: {\n    towgs84: '-307,-92,127'\n  },\n  EPSG_4684: {\n    towgs84: '-133,-321,50'\n  },\n  EPSG_4708: {\n    towgs84: '-491,-22,435'\n  },\n  EPSG_4707: {\n    towgs84: '114,-116,-333'\n  },\n  EPSG_4709: {\n    towgs84: '145,75,-272'\n  },\n  EPSG_4712: {\n    towgs84: '-205,107,53'\n  },\n  EPSG_4711: {\n    towgs84: '124,-234,-25'\n  },\n  EPSG_4718: {\n    towgs84: '230,-199,-752'\n  },\n  EPSG_4719: {\n    towgs84: '211,147,111'\n  },\n  EPSG_4724: {\n    towgs84: '208,-435,-229'\n  },\n  EPSG_4725: {\n    towgs84: '189,-79,-202'\n  },\n  EPSG_4735: {\n    towgs84: '647,1777,-1124'\n  },\n  EPSG_4722: {\n    towgs84: '-794,119,-298'\n  },\n  EPSG_4728: {\n    towgs84: '-307,-92,127'\n  },\n  EPSG_4734: {\n    towgs84: '-632,438,-609'\n  },\n  EPSG_4727: {\n    towgs84: '912,-58,1227'\n  },\n  EPSG_4729: {\n    towgs84: '185,165,42'\n  },\n  EPSG_4730: {\n    towgs84: '170,42,84'\n  },\n  EPSG_4733: {\n    towgs84: '276,-57,149'\n  },\n  ESRI_37218: {\n    towgs84: '230,-199,-752'\n  },\n  ESRI_37240: {\n    towgs84: '-7,215,225'\n  },\n  ESRI_37221: {\n    towgs84: '252,-209,-751'\n  },\n  ESRI_4305: {\n    towgs84: '-123,-206,219'\n  },\n  ESRI_104139: {\n    towgs84: '-73,-247,227'\n  },\n  EPSG_4748: {\n    towgs84: '51,391,-36'\n  },\n  EPSG_4219: {\n    towgs84: '-384,664,-48'\n  },\n  EPSG_4255: {\n    towgs84: '-333,-222,114'\n  },\n  EPSG_4257: {\n    towgs84: '-587.8,519.75,145.76'\n  },\n  EPSG_4646: {\n    towgs84: '-963,510,-359'\n  },\n  EPSG_6881: {\n    towgs84: '-24,-203,268'\n  },\n  EPSG_6882: {\n    towgs84: '-183,-15,273'\n  },\n  EPSG_4715: {\n    towgs84: '-104,-129,239'\n  },\n  IGNF_RGF93GDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGM04GDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGSPM06GDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGTAAF07GDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGFG95GDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGNCG: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGPFGDD: {\n    towgs84: '0,0,0'\n  },\n  IGNF_ETRS89G: {\n    towgs84: '0,0,0'\n  },\n  IGNF_RGR92GDD: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4173: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4180: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4619: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4667: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4075: {\n    towgs84: '0,0,0'\n  },\n  EPSG_6706: {\n    towgs84: '0,0,0'\n  },\n  EPSG_7798: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4661: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4669: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8685: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4151: {\n    towgs84: '0,0,0'\n  },\n  EPSG_9702: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4758: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4761: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4765: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8997: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4023: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4670: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4694: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4148: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4163: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4167: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4189: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4190: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4176: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4659: {\n    towgs84: '0,0,0'\n  },\n  EPSG_3824: {\n    towgs84: '0,0,0'\n  },\n  EPSG_3889: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4046: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4081: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4558: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4483: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5013: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5264: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5324: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5354: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5371: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5373: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5381: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5393: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5489: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5593: {\n    towgs84: '0,0,0'\n  },\n  EPSG_6135: {\n    towgs84: '0,0,0'\n  },\n  EPSG_6365: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5246: {\n    towgs84: '0,0,0'\n  },\n  EPSG_7886: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8431: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8427: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8699: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8818: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4757: {\n    towgs84: '0,0,0'\n  },\n  EPSG_9140: {\n    towgs84: '0,0,0'\n  },\n  EPSG_8086: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4686: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4737: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4702: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4747: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4749: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4674: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4755: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4759: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4762: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4763: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4764: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4166: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4170: {\n    towgs84: '0,0,0'\n  },\n  EPSG_5546: {\n    towgs84: '0,0,0'\n  },\n  EPSG_7844: {\n    towgs84: '0,0,0'\n  },\n  EPSG_4818: {\n    towgs84: '589,76,480'\n  }\n};\n\nfor (var key in datums) {\n  var datum = datums[key];\n  if (!datum.datumName) {\n    continue;\n  }\n  datums[datum.datumName] = datum;\n}\n\nexport default datums;\n","import { PJD_3PARAM, PJD_7PARAM, PJD_GRIDSHIFT, PJD_WGS84, PJD_NODATUM, SEC_TO_RAD } from './constants/values';\n\nfunction datum(datumCode, datum_params, a, b, es, ep2, nadgrids) {\n  var out = {};\n\n  if (datumCode === undefined || datumCode === 'none') {\n    out.datum_type = PJD_NODATUM;\n  } else {\n    out.datum_type = PJD_WGS84;\n  }\n\n  if (datum_params) {\n    out.datum_params = datum_params.map(parseFloat);\n    if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {\n      out.datum_type = PJD_3PARAM;\n    }\n    if (out.datum_params.length > 3) {\n      if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {\n        out.datum_type = PJD_7PARAM;\n        out.datum_params[3] *= SEC_TO_RAD;\n        out.datum_params[4] *= SEC_TO_RAD;\n        out.datum_params[5] *= SEC_TO_RAD;\n        out.datum_params[6] = (out.datum_params[6] / 1000000.0) + 1.0;\n      }\n    }\n  }\n\n  if (nadgrids) {\n    out.datum_type = PJD_GRIDSHIFT;\n    out.grids = nadgrids;\n  }\n  out.a = a; // datum object also uses these values\n  out.b = b;\n  out.es = es;\n  out.ep2 = ep2;\n  return out;\n}\n\nexport default datum;\n","/**\n * Resources for details of NTv2 file formats:\n * - https://web.archive.org/web/20140127204822if_/http://www.mgs.gov.on.ca:80/stdprodconsume/groups/content/@mgs/@iandit/documents/resourcelist/stel02_047447.pdf\n * - http://mimaka.com/help/gs/html/004_NTV2%20Data%20Format.htm\n */\n\n/**\n * @typedef {Object} NadgridInfo\n * @property {string} name The name of the NAD grid or 'null' if not specified.\n * @property {boolean} mandatory Indicates if the grid is mandatory (true) or optional (false).\n * @property {*} grid The loaded NAD grid object, or null if not loaded or not applicable.\n * @property {boolean} isNull True if the grid is explicitly 'null', otherwise false.\n */\n\n/**\n * @typedef {Object} NTV2GridOptions\n * @property {boolean} [includeErrorFields=true] Whether to include error fields in the subgrids.\n */\n\n/**\n * @typedef {Object} NadgridHeader\n * @property {number} [nFields] Number of fields in the header.\n * @property {number} [nSubgridFields] Number of fields in each subgrid header.\n * @property {number} nSubgrids Number of subgrids in the file.\n * @property {string} [shiftType] Type of shift (e.g., \"SECONDS\").\n * @property {number} [fromSemiMajorAxis] Source ellipsoid semi-major axis.\n * @property {number} [fromSemiMinorAxis] Source ellipsoid semi-minor axis.\n * @property {number} [toSemiMajorAxis] Target ellipsoid semi-major axis.\n * @property {number} [toSemiMinorAxis] Target ellipsoid semi-minor axis.\n */\n\n/**\n * @typedef {Object} Subgrid\n * @property {Array<number>} ll Lower left corner of the grid in radians [longitude, latitude].\n * @property {Array<number>} del Grid spacing in radians [longitude interval, latitude interval].\n * @property {Array<number>} lim Number of columns in the grid [longitude columns, latitude columns].\n * @property {number} [count] Total number of grid nodes.\n * @property {Array} cvs Mapped node values for the grid.\n */\n\n/** @typedef {{header: NadgridHeader, subgrids: Array<Subgrid>}} NADGrid */\n\n/**\n * @typedef {Object} GeoTIFF\n * @property {() => Promise<number>} getImageCount - Returns the number of images in the GeoTIFF.\n * @property {(index: number) => Promise<GeoTIFFImage>} getImage - Returns a GeoTIFFImage for the given index.\n */\n\n/**\n * @typedef {Object} GeoTIFFImage\n * @property {() => number} getWidth - Returns the width of the image.\n * @property {() => number} getHeight - Returns the height of the image.\n * @property {() => number[]} getBoundingBox - Returns the bounding box as [minX, minY, maxX, maxY] in degrees.\n * @property {() => Promise<ArrayLike<ArrayLike<number>>>} readRasters - Returns the raster data as an array of bands.\n * @property {Object} fileDirectory - The file directory object containing metadata.\n * @property {Object} fileDirectory.ModelPixelScale - The pixel scale array [scaleX, scaleY, scaleZ] in degrees.\n */\n\nvar loadedNadgrids = {};\n\n/**\n * @overload\n * @param {string} key - The key to associate with the loaded grid.\n * @param {ArrayBuffer} data - The NTv2 grid data as an ArrayBuffer.\n * @param {NTV2GridOptions} [options] - Optional parameters for loading the grid.\n * @returns {NADGrid} - The loaded NAD grid information.\n */\n/**\n * @overload\n * @param {string} key - The key to associate with the loaded grid.\n * @param {GeoTIFF} data - The GeoTIFF instance to read the grid from.\n * @returns {{ready: Promise<NADGrid>}} - A promise that resolves to the loaded grid information.\n */\n/**\n * Load either a NTv2 file (.gsb) or a Geotiff (.tif) to a key that can be used in a proj string like +nadgrids=<key>. Pass the NTv2 file\n * as an ArrayBuffer. Pass Geotiff as a GeoTIFF instance from the geotiff.js library.\n * @param {string} key - The key to associate with the loaded grid.\n * @param {ArrayBuffer|GeoTIFF} data The data to load, either an ArrayBuffer for NTv2 or a GeoTIFF instance.\n * @param {NTV2GridOptions} [options] Optional parameters.\n * @returns {{ready: Promise<NADGrid>}|NADGrid} - A promise that resolves to the loaded grid information.\n */\nexport default function nadgrid(key, data, options) {\n  if (data instanceof ArrayBuffer) {\n    return readNTV2Grid(key, data, options);\n  }\n  return { ready: readGeotiffGrid(key, data) };\n}\n\n/**\n * @param {string} key The key to associate with the loaded grid.\n * @param {ArrayBuffer} data The NTv2 grid data as an ArrayBuffer.\n * @param {NTV2GridOptions} [options] Optional parameters for loading the grid.\n * @returns {NADGrid} The loaded NAD grid information.\n */\nfunction readNTV2Grid(key, data, options) {\n  var includeErrorFields = true;\n  if (options !== undefined && options.includeErrorFields === false) {\n    includeErrorFields = false;\n  }\n  var view = new DataView(data);\n  var isLittleEndian = detectLittleEndian(view);\n  var header = readHeader(view, isLittleEndian);\n  var subgrids = readSubgrids(view, header, isLittleEndian, includeErrorFields);\n  var nadgrid = { header: header, subgrids: subgrids };\n  loadedNadgrids[key] = nadgrid;\n  return nadgrid;\n}\n\n/**\n * @param {string} key The key to associate with the loaded grid.\n * @param {GeoTIFF} tiff The GeoTIFF instance to read the grid from.\n * @returns {Promise<NADGrid>} A promise that resolves to the loaded NAD grid information.\n */\nasync function readGeotiffGrid(key, tiff) {\n  var subgrids = [];\n  var subGridCount = await tiff.getImageCount();\n  // proj produced tiff grid shift files appear to organize lower res subgrids first, higher res/ child subgrids last.\n  for (var subgridIndex = subGridCount - 1; subgridIndex >= 0; subgridIndex--) {\n    var image = await tiff.getImage(subgridIndex);\n\n    var rasters = await image.readRasters();\n    var data = rasters;\n    var lim = [image.getWidth(), image.getHeight()];\n    var imageBBoxRadians = image.getBoundingBox().map(degreesToRadians);\n    var del = [image.fileDirectory.ModelPixelScale[0], image.fileDirectory.ModelPixelScale[1]].map(degreesToRadians);\n\n    var maxX = imageBBoxRadians[0] + (lim[0] - 1) * del[0];\n    var minY = imageBBoxRadians[3] - (lim[1] - 1) * del[1];\n\n    var latitudeOffsetBand = data[0];\n    var longitudeOffsetBand = data[1];\n    var nodes = [];\n\n    for (let i = lim[1] - 1; i >= 0; i--) {\n      for (let j = lim[0] - 1; j >= 0; j--) {\n        var index = i * lim[0] + j;\n        nodes.push([-secondsToRadians(longitudeOffsetBand[index]), secondsToRadians(latitudeOffsetBand[index])]);\n      }\n    }\n\n    subgrids.push({\n      del: del,\n      lim: lim,\n      ll: [-maxX, minY],\n      cvs: nodes\n    });\n  }\n\n  var tifGrid = {\n    header: {\n      nSubgrids: subGridCount\n    },\n    subgrids: subgrids\n  };\n  loadedNadgrids[key] = tifGrid;\n  return tifGrid;\n};\n\n/**\n * Given a proj4 value for nadgrids, return an array of loaded grids\n * @param {string} nadgrids A comma-separated list of grid names, optionally prefixed with '@' to indicate optional grids.\n * @returns\n */\nexport function getNadgrids(nadgrids) {\n  // Format details: http://proj.maptools.org/gen_parms.html\n  if (nadgrids === undefined) {\n    return null;\n  }\n  var grids = nadgrids.split(',');\n  return grids.map(parseNadgridString);\n}\n\n/**\n * @param {string} value The nadgrid string to get information for.\n * @returns {NadgridInfo|null} An object with grid information, or null if the input is empty.\n */\nfunction parseNadgridString(value) {\n  if (value.length === 0) {\n    return null;\n  }\n  var optional = value[0] === '@';\n  if (optional) {\n    value = value.slice(1);\n  }\n  if (value === 'null') {\n    return { name: 'null', mandatory: !optional, grid: null, isNull: true };\n  }\n  return {\n    name: value,\n    mandatory: !optional,\n    grid: loadedNadgrids[value] || null,\n    isNull: false\n  };\n}\n\nfunction degreesToRadians(degrees) {\n  return (degrees) * Math.PI / 180;\n}\n\nfunction secondsToRadians(seconds) {\n  return (seconds / 3600) * Math.PI / 180;\n}\n\nfunction detectLittleEndian(view) {\n  var nFields = view.getInt32(8, false);\n  if (nFields === 11) {\n    return false;\n  }\n  nFields = view.getInt32(8, true);\n  if (nFields !== 11) {\n    console.warn('Failed to detect nadgrid endian-ness, defaulting to little-endian');\n  }\n  return true;\n}\n\nfunction readHeader(view, isLittleEndian) {\n  return {\n    nFields: view.getInt32(8, isLittleEndian),\n    nSubgridFields: view.getInt32(24, isLittleEndian),\n    nSubgrids: view.getInt32(40, isLittleEndian),\n    shiftType: decodeString(view, 56, 56 + 8).trim(),\n    fromSemiMajorAxis: view.getFloat64(120, isLittleEndian),\n    fromSemiMinorAxis: view.getFloat64(136, isLittleEndian),\n    toSemiMajorAxis: view.getFloat64(152, isLittleEndian),\n    toSemiMinorAxis: view.getFloat64(168, isLittleEndian)\n  };\n}\n\nfunction decodeString(view, start, end) {\n  return String.fromCharCode.apply(null, new Uint8Array(view.buffer.slice(start, end)));\n}\n\nfunction readSubgrids(view, header, isLittleEndian, includeErrorFields) {\n  var gridOffset = 176;\n  var grids = [];\n  for (var i = 0; i < header.nSubgrids; i++) {\n    var subHeader = readGridHeader(view, gridOffset, isLittleEndian);\n    var nodes = readGridNodes(view, gridOffset, subHeader, isLittleEndian, includeErrorFields);\n    var lngColumnCount = Math.round(\n      1 + (subHeader.upperLongitude - subHeader.lowerLongitude) / subHeader.longitudeInterval);\n    var latColumnCount = Math.round(\n      1 + (subHeader.upperLatitude - subHeader.lowerLatitude) / subHeader.latitudeInterval);\n    // Proj4 operates on radians whereas the coordinates are in seconds in the grid\n    grids.push({\n      ll: [secondsToRadians(subHeader.lowerLongitude), secondsToRadians(subHeader.lowerLatitude)],\n      del: [secondsToRadians(subHeader.longitudeInterval), secondsToRadians(subHeader.latitudeInterval)],\n      lim: [lngColumnCount, latColumnCount],\n      count: subHeader.gridNodeCount,\n      cvs: mapNodes(nodes)\n    });\n    var rowSize = 16;\n    if (includeErrorFields === false) {\n      rowSize = 8;\n    }\n    gridOffset += 176 + subHeader.gridNodeCount * rowSize;\n  }\n  return grids;\n}\n\n/**\n * @param {*} nodes\n * @returns Array<Array<number>>\n */\nfunction mapNodes(nodes) {\n  return nodes.map(function (r) {\n    return [secondsToRadians(r.longitudeShift), secondsToRadians(r.latitudeShift)];\n  });\n}\n\nfunction readGridHeader(view, offset, isLittleEndian) {\n  return {\n    name: decodeString(view, offset + 8, offset + 16).trim(),\n    parent: decodeString(view, offset + 24, offset + 24 + 8).trim(),\n    lowerLatitude: view.getFloat64(offset + 72, isLittleEndian),\n    upperLatitude: view.getFloat64(offset + 88, isLittleEndian),\n    lowerLongitude: view.getFloat64(offset + 104, isLittleEndian),\n    upperLongitude: view.getFloat64(offset + 120, isLittleEndian),\n    latitudeInterval: view.getFloat64(offset + 136, isLittleEndian),\n    longitudeInterval: view.getFloat64(offset + 152, isLittleEndian),\n    gridNodeCount: view.getInt32(offset + 168, isLittleEndian)\n  };\n}\n\nfunction readGridNodes(view, offset, gridHeader, isLittleEndian, includeErrorFields) {\n  var nodesOffset = offset + 176;\n  var gridRecordLength = 16;\n\n  if (includeErrorFields === false) {\n    gridRecordLength = 8;\n  }\n\n  var gridShiftRecords = [];\n  for (var i = 0; i < gridHeader.gridNodeCount; i++) {\n    var record = {\n      latitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength, isLittleEndian),\n      longitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength + 4, isLittleEndian)\n\n    };\n\n    if (includeErrorFields !== false) {\n      record.latitudeAccuracy = view.getFloat32(nodesOffset + i * gridRecordLength + 8, isLittleEndian);\n      record.longitudeAccuracy = view.getFloat32(nodesOffset + i * gridRecordLength + 12, isLittleEndian);\n    }\n\n    gridShiftRecords.push(record);\n  }\n  return gridShiftRecords;\n}\n","import parseCode from './parseCode';\nimport extend from './extend';\nimport projections from './projections';\nimport { sphere as dc_sphere, eccentricity as dc_eccentricity } from './deriveConstants';\nimport Datum from './constants/Datum';\nimport datum from './datum';\nimport match from './match';\nimport { getNadgrids } from './nadgrid';\n\n/**\n * @typedef {Object} DatumDefinition\n * @property {number} datum_type - The type of datum.\n * @property {number} a - Semi-major axis of the ellipsoid.\n * @property {number} b - Semi-minor axis of the ellipsoid.\n * @property {number} es - Eccentricity squared of the ellipsoid.\n * @property {number} ep2 - Second eccentricity squared of the ellipsoid.\n */\n\n/**\n * @param {string | import('./core').PROJJSONDefinition | import('./defs').ProjectionDefinition} srsCode\n * @param {(errorMessage?: string, instance?: Projection) => void} [callback]\n */\nfunction Projection(srsCode, callback) {\n  if (!(this instanceof Projection)) {\n    return new Projection(srsCode);\n  }\n  /** @type {<T extends import('./core').TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} */\n  this.forward = null;\n  /** @type {<T extends import('./core').TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} */\n  this.inverse = null;\n  /** @type {function(): void} */\n  this.init = null;\n  /** @type {string} */\n  this.name;\n  /** @type {Array<string>} */\n  this.names = null;\n  /** @type {string} */\n  this.title;\n  callback = callback || function (error) {\n    if (error) {\n      throw error;\n    }\n  };\n  var json = parseCode(srsCode);\n  if (typeof json !== 'object') {\n    callback('Could not parse to valid json: ' + srsCode);\n    return;\n  }\n  var ourProj = Projection.projections.get(json.projName);\n  if (!ourProj) {\n    callback('Could not get projection name from: ' + srsCode);\n    return;\n  }\n  if (json.datumCode && json.datumCode !== 'none') {\n    var datumDef = match(Datum, json.datumCode);\n    if (datumDef) {\n      json.datum_params = json.datum_params || (datumDef.towgs84 ? datumDef.towgs84.split(',') : null);\n      json.ellps = datumDef.ellipse;\n      json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;\n    }\n  }\n  json.k0 = json.k0 || 1.0;\n  json.axis = json.axis || 'enu';\n  json.ellps = json.ellps || 'wgs84';\n  json.lat1 = json.lat1 || json.lat0; // Lambert_Conformal_Conic_1SP, for example, needs this\n\n  var sphere_ = dc_sphere(json.a, json.b, json.rf, json.ellps, json.sphere);\n  var ecc = dc_eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);\n  var nadgrids = getNadgrids(json.nadgrids);\n  /** @type {DatumDefinition} */\n  var datumObj = json.datum || datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2,\n    nadgrids);\n\n  extend(this, json); // transfer everything over from the projection because we don't know what we'll need\n  extend(this, ourProj); // transfer all the methods from the projection\n\n  // copy the 4 things over we calculated in deriveConstants.sphere\n  this.a = sphere_.a;\n  this.b = sphere_.b;\n  this.rf = sphere_.rf;\n  this.sphere = sphere_.sphere;\n\n  // copy the 3 things we calculated in deriveConstants.eccentricity\n  this.es = ecc.es;\n  this.e = ecc.e;\n  this.ep2 = ecc.ep2;\n\n  // add in the datum object\n  this.datum = datumObj;\n\n  // init the projection\n  if ('init' in this && typeof this.init === 'function') {\n    this.init();\n  }\n\n  // legecy callback from back in the day when it went to spatialreference.org\n  callback(null, this);\n}\nProjection.projections = projections;\nProjection.projections.start();\nexport default Projection;\n","'use strict';\nimport { PJD_3PARAM, PJD_7PARAM, HALF_PI } from './constants/values';\nexport function compareDatums(source, dest) {\n  if (source.datum_type !== dest.datum_type) {\n    return false; // false, datums are not equal\n  } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 0.000000000050) {\n    // the tolerance for es is to ensure that GRS80 and WGS84\n    // are considered identical\n    return false;\n  } else if (source.datum_type === PJD_3PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2]);\n  } else if (source.datum_type === PJD_7PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6]);\n  } else {\n    return true; // datums are equal\n  }\n} // cs_compare_datums()\n\n/*\n * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n * according to the current ellipsoid parameters.\n *\n *    Latitude  : Geodetic latitude in radians                     (input)\n *    Longitude : Geodetic longitude in radians                    (input)\n *    Height    : Geodetic height, in meters                       (input)\n *    X         : Calculated Geocentric X coordinate, in meters    (output)\n *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n *\n */\nexport function geodeticToGeocentric(p, es, a) {\n  var Longitude = p.x;\n  var Latitude = p.y;\n  var Height = p.z ? p.z : 0; // Z value not always supplied\n\n  var Rn; /*  Earth radius at location  */\n  var Sin_Lat; /*  Math.sin(Latitude)  */\n  var Sin2_Lat; /*  Square of Math.sin(Latitude)  */\n  var Cos_Lat; /*  Math.cos(Latitude)  */\n\n  /*\n   ** Don't blow up if Latitude is just a little out of the value\n   ** range as it may just be a rounding issue.  Also removed longitude\n   ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n   */\n  if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {\n    Latitude = -HALF_PI;\n  } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {\n    Latitude = HALF_PI;\n  } else if (Latitude < -HALF_PI) {\n    /* Latitude out of range */\n    // ..reportError('geocent:lat out of range:' + Latitude);\n    return { x: -Infinity, y: -Infinity, z: p.z };\n  } else if (Latitude > HALF_PI) {\n    /* Latitude out of range */\n    return { x: Infinity, y: Infinity, z: p.z };\n  }\n\n  if (Longitude > Math.PI) {\n    Longitude -= (2 * Math.PI);\n  }\n  Sin_Lat = Math.sin(Latitude);\n  Cos_Lat = Math.cos(Latitude);\n  Sin2_Lat = Sin_Lat * Sin_Lat;\n  Rn = a / (Math.sqrt(1.0e0 - es * Sin2_Lat));\n  return {\n    x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),\n    y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),\n    z: ((Rn * (1 - es)) + Height) * Sin_Lat\n  };\n} // cs_geodetic_to_geocentric()\n\nexport function geocentricToGeodetic(p, es, a, b) {\n  /* local defintions and variables */\n  /* end-criterium of loop, accuracy of sin(Latitude) */\n  var genau = 1e-12;\n  var genau2 = (genau * genau);\n  var maxiter = 30;\n\n  var P; /* distance between semi-minor axis and location */\n  var RR; /* distance between center and location */\n  var CT; /* sin of geocentric latitude */\n  var ST; /* cos of geocentric latitude */\n  var RX;\n  var RK;\n  var RN; /* Earth radius at location */\n  var CPHI0; /* cos of start or old geodetic latitude in iterations */\n  var SPHI0; /* sin of start or old geodetic latitude in iterations */\n  var CPHI; /* cos of searched geodetic latitude */\n  var SPHI; /* sin of searched geodetic latitude */\n  var SDPHI; /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n  var iter; /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n  var X = p.x;\n  var Y = p.y;\n  var Z = p.z ? p.z : 0.0; // Z value not always supplied\n  var Longitude;\n  var Latitude;\n  var Height;\n\n  P = Math.sqrt(X * X + Y * Y);\n  RR = Math.sqrt(X * X + Y * Y + Z * Z);\n\n  /*      special cases for latitude and longitude */\n  if (P / a < genau) {\n    /*  special case, if P=0. (X=0., Y=0.) */\n    Longitude = 0.0;\n\n    /*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n     *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n    if (RR / a < genau) {\n      Latitude = HALF_PI;\n      Height = -b;\n      return {\n        x: p.x,\n        y: p.y,\n        z: p.z\n      };\n    }\n  } else {\n    /*  ellipsoidal (geodetic) longitude\n     *  interval: -PI < Longitude <= +PI */\n    Longitude = Math.atan2(Y, X);\n  }\n\n  /* --------------------------------------------------------------\n   * Following iterative algorithm was developped by\n   * \"Institut for Erdmessung\", University of Hannover, July 1988.\n   * Internet: www.ife.uni-hannover.de\n   * Iterative computation of CPHI,SPHI and Height.\n   * Iteration of CPHI and SPHI to 10**-12 radian resp.\n   * 2*10**-7 arcsec.\n   * --------------------------------------------------------------\n   */\n  CT = Z / RR;\n  ST = P / RR;\n  RX = 1.0 / Math.sqrt(1.0 - es * (2.0 - es) * ST * ST);\n  CPHI0 = ST * (1.0 - es) * RX;\n  SPHI0 = CT * RX;\n  iter = 0;\n\n  /* loop to find sin(Latitude) resp. Latitude\n   * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n  do {\n    iter++;\n    RN = a / Math.sqrt(1.0 - es * SPHI0 * SPHI0);\n\n    /*  ellipsoidal (geodetic) height */\n    Height = P * CPHI0 + Z * SPHI0 - RN * (1.0 - es * SPHI0 * SPHI0);\n\n    RK = es * RN / (RN + Height);\n    RX = 1.0 / Math.sqrt(1.0 - RK * (2.0 - RK) * ST * ST);\n    CPHI = ST * (1.0 - RK) * RX;\n    SPHI = CT * RX;\n    SDPHI = SPHI * CPHI0 - CPHI * SPHI0;\n    CPHI0 = CPHI;\n    SPHI0 = SPHI;\n  }\n  while (SDPHI * SDPHI > genau2 && iter < maxiter);\n\n  /*      ellipsoidal (geodetic) latitude */\n  Latitude = Math.atan(SPHI / Math.abs(CPHI));\n  return {\n    x: Longitude,\n    y: Latitude,\n    z: Height\n  };\n} // cs_geocentric_to_geodetic()\n\n/****************************************************************/\n// pj_geocentic_to_wgs84( p )\n//  p = point to transform in geocentric coordinates (x,y,z)\n\n/** point object, nothing fancy, just allows values to be\n    passed back and forth by reference rather than by value.\n    Other point classes may be used as long as they have\n    x and y properties, which will get modified in the transform method.\n*/\nexport function geocentricToWgs84(p, datum_type, datum_params) {\n  if (datum_type === PJD_3PARAM) {\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x + datum_params[0],\n      y: p.y + datum_params[1],\n      z: p.z + datum_params[2]\n    };\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,\n      y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,\n      z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF\n    };\n  }\n} // cs_geocentric_to_wgs84\n\n/****************************************************************/\n// pj_geocentic_from_wgs84()\n//  coordinate system definition,\n//  point to transform in geocentric coordinates (x,y,z)\nexport function geocentricFromWgs84(p, datum_type, datum_params) {\n  if (datum_type === PJD_3PARAM) {\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x - datum_params[0],\n      y: p.y - datum_params[1],\n      z: p.z - datum_params[2]\n    };\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    var x_tmp = (p.x - Dx_BF) / M_BF;\n    var y_tmp = (p.y - Dy_BF) / M_BF;\n    var z_tmp = (p.z - Dz_BF) / M_BF;\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n\n    return {\n      x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,\n      y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,\n      z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp\n    };\n  } // cs_geocentric_from_wgs84()\n}\n","import {\n  PJD_3PARAM,\n  PJD_7PARAM,\n  PJD_GRIDSHIFT,\n  PJD_NODATUM,\n  R2D,\n  SRS_WGS84_ESQUARED,\n  SRS_WGS84_SEMIMAJOR, SRS_WGS84_SEMIMINOR\n} from './constants/values';\n\nimport { geodeticToGeocentric, geocentricToGeodetic, geocentricToWgs84, geocentricFromWgs84, compareDatums } from './datumUtils';\nimport adjust_lon from './common/adjust_lon';\nfunction checkParams(type) {\n  return (type === PJD_3PARAM || type === PJD_7PARAM);\n}\n\nexport default function (source, dest, point) {\n  // Short cut if the datums are identical.\n  if (compareDatums(source, dest)) {\n    return point; // in this case, zero is sucess,\n    // whereas cs_compare_datums returns 1 to indicate TRUE\n    // confusing, should fix this\n  }\n\n  // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n  if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {\n    return point;\n  }\n\n  // If this datum requires grid shifts, then apply it to geodetic coordinates.\n  var source_a = source.a;\n  var source_es = source.es;\n  if (source.datum_type === PJD_GRIDSHIFT) {\n    var gridShiftCode = applyGridShift(source, false, point);\n    if (gridShiftCode !== 0) {\n      return undefined;\n    }\n    source_a = SRS_WGS84_SEMIMAJOR;\n    source_es = SRS_WGS84_ESQUARED;\n  }\n\n  var dest_a = dest.a;\n  var dest_b = dest.b;\n  var dest_es = dest.es;\n  if (dest.datum_type === PJD_GRIDSHIFT) {\n    dest_a = SRS_WGS84_SEMIMAJOR;\n    dest_b = SRS_WGS84_SEMIMINOR;\n    dest_es = SRS_WGS84_ESQUARED;\n  }\n\n  // Do we need to go through geocentric coordinates?\n  if (source_es === dest_es && source_a === dest_a && !checkParams(source.datum_type) && !checkParams(dest.datum_type)) {\n    return point;\n  }\n\n  // Convert to geocentric coordinates.\n  point = geodeticToGeocentric(point, source_es, source_a);\n  // Convert between datums\n  if (checkParams(source.datum_type)) {\n    point = geocentricToWgs84(point, source.datum_type, source.datum_params);\n  }\n  if (checkParams(dest.datum_type)) {\n    point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);\n  }\n  point = geocentricToGeodetic(point, dest_es, dest_a, dest_b);\n\n  if (dest.datum_type === PJD_GRIDSHIFT) {\n    var destGridShiftResult = applyGridShift(dest, true, point);\n    if (destGridShiftResult !== 0) {\n      return undefined;\n    }\n  }\n\n  return point;\n}\n\nexport function applyGridShift(source, inverse, point) {\n  if (source.grids === null || source.grids.length === 0) {\n    console.log('Grid shift grids not found');\n    return -1;\n  }\n  var input = { x: -point.x, y: point.y };\n  var output = { x: Number.NaN, y: Number.NaN };\n  var attemptedGrids = [];\n  outer:\n  for (var i = 0; i < source.grids.length; i++) {\n    var grid = source.grids[i];\n    attemptedGrids.push(grid.name);\n    if (grid.isNull) {\n      output = input;\n      break;\n    }\n    if (grid.grid === null) {\n      if (grid.mandatory) {\n        console.log('Unable to find mandatory grid \\'' + grid.name + '\\'');\n        return -1;\n      }\n      continue;\n    }\n    var subgrids = grid.grid.subgrids;\n    for (var j = 0, jj = subgrids.length; j < jj; j++) {\n      var subgrid = subgrids[j];\n      // skip tables that don't match our point at all\n      var epsilon = (Math.abs(subgrid.del[1]) + Math.abs(subgrid.del[0])) / 10000.0;\n      var minX = subgrid.ll[0] - epsilon;\n      var minY = subgrid.ll[1] - epsilon;\n      var maxX = subgrid.ll[0] + (subgrid.lim[0] - 1) * subgrid.del[0] + epsilon;\n      var maxY = subgrid.ll[1] + (subgrid.lim[1] - 1) * subgrid.del[1] + epsilon;\n      if (minY > input.y || minX > input.x || maxY < input.y || maxX < input.x) {\n        continue;\n      }\n      output = applySubgridShift(input, inverse, subgrid);\n      if (!isNaN(output.x)) {\n        break outer;\n      }\n    }\n  }\n  if (isNaN(output.x)) {\n    console.log('Failed to find a grid shift table for location \\''\n      + -input.x * R2D + ' ' + input.y * R2D + ' tried: \\'' + attemptedGrids + '\\'');\n    return -1;\n  }\n  point.x = -output.x;\n  point.y = output.y;\n  return 0;\n}\n\nfunction applySubgridShift(pin, inverse, ct) {\n  var val = { x: Number.NaN, y: Number.NaN };\n  if (isNaN(pin.x)) {\n    return val;\n  }\n  var tb = { x: pin.x, y: pin.y };\n  tb.x -= ct.ll[0];\n  tb.y -= ct.ll[1];\n  tb.x = adjust_lon(tb.x - Math.PI) + Math.PI;\n  var t = nadInterpolate(tb, ct);\n  if (inverse) {\n    if (isNaN(t.x)) {\n      return val;\n    }\n    t.x = tb.x - t.x;\n    t.y = tb.y - t.y;\n    var i = 9, tol = 1e-12;\n    var dif, del;\n    do {\n      del = nadInterpolate(t, ct);\n      if (isNaN(del.x)) {\n        console.log('Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.');\n        break;\n      }\n      dif = { x: tb.x - (del.x + t.x), y: tb.y - (del.y + t.y) };\n      t.x += dif.x;\n      t.y += dif.y;\n    } while (i-- && Math.abs(dif.x) > tol && Math.abs(dif.y) > tol);\n    if (i < 0) {\n      console.log('Inverse grid shift iterator failed to converge.');\n      return val;\n    }\n    val.x = adjust_lon(t.x + ct.ll[0]);\n    val.y = t.y + ct.ll[1];\n  } else {\n    if (!isNaN(t.x)) {\n      val.x = pin.x + t.x;\n      val.y = pin.y + t.y;\n    }\n  }\n  return val;\n}\n\nfunction nadInterpolate(pin, ct) {\n  var t = { x: pin.x / ct.del[0], y: pin.y / ct.del[1] };\n  var indx = { x: Math.floor(t.x), y: Math.floor(t.y) };\n  var frct = { x: t.x - 1.0 * indx.x, y: t.y - 1.0 * indx.y };\n  var val = { x: Number.NaN, y: Number.NaN };\n  var inx;\n  if (indx.x < 0 || indx.x >= ct.lim[0]) {\n    return val;\n  }\n  if (indx.y < 0 || indx.y >= ct.lim[1]) {\n    return val;\n  }\n  inx = (indx.y * ct.lim[0]) + indx.x;\n  var f00 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };\n  inx++;\n  var f10 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };\n  inx += ct.lim[0];\n  var f11 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };\n  inx--;\n  var f01 = { x: ct.cvs[inx][0], y: ct.cvs[inx][1] };\n  var m11 = frct.x * frct.y, m10 = frct.x * (1.0 - frct.y),\n    m00 = (1.0 - frct.x) * (1.0 - frct.y), m01 = (1.0 - frct.x) * frct.y;\n  val.x = (m00 * f00.x + m10 * f10.x + m01 * f01.x + m11 * f11.x);\n  val.y = (m00 * f00.y + m10 * f10.y + m01 * f01.y + m11 * f11.y);\n  return val;\n}\n","export default function (crs, denorm, point) {\n  var xin = point.x,\n    yin = point.y,\n    zin = point.z || 0.0;\n  var v, t, i;\n  /** @type {import(\"./core\").InterfaceCoordinates} */\n  var out = {};\n  for (i = 0; i < 3; i++) {\n    if (denorm && i === 2 && point.z === undefined) {\n      continue;\n    }\n    if (i === 0) {\n      v = xin;\n      if ('ew'.indexOf(crs.axis[i]) !== -1) {\n        t = 'x';\n      } else {\n        t = 'y';\n      }\n    } else if (i === 1) {\n      v = yin;\n      if ('ns'.indexOf(crs.axis[i]) !== -1) {\n        t = 'y';\n      } else {\n        t = 'x';\n      }\n    } else {\n      v = zin;\n      t = 'z';\n    }\n    switch (crs.axis[i]) {\n      case 'e':\n        out[t] = v;\n        break;\n      case 'w':\n        out[t] = -v;\n        break;\n      case 'n':\n        out[t] = v;\n        break;\n      case 's':\n        out[t] = -v;\n        break;\n      case 'u':\n        if (point[t] !== undefined) {\n          out.z = v;\n        }\n        break;\n      case 'd':\n        if (point[t] !== undefined) {\n          out.z = -v;\n        }\n        break;\n      default:\n      // console.log(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n        return null;\n    }\n  }\n  return out;\n}\n","/**\n * @param {Array<number>} array\n * @returns {import(\"../core\").InterfaceCoordinates}\n */\nexport default function (array) {\n  var out = {\n    x: array[0],\n    y: array[1]\n  };\n  if (array.length > 2) {\n    out.z = array[2];\n  }\n  if (array.length > 3) {\n    out.m = array[3];\n  }\n  return out;\n}\n","export default function (point) {\n  checkCoord(point.x);\n  checkCoord(point.y);\n}\nfunction checkCoord(num) {\n  if (typeof Number.isFinite === 'function') {\n    if (Number.isFinite(num)) {\n      return;\n    }\n    throw new TypeError('coordinates must be finite numbers');\n  }\n  if (typeof num !== 'number' || num !== num || !isFinite(num)) {\n    throw new TypeError('coordinates must be finite numbers');\n  }\n}\n","import { D2R, R2D, PJD_3PARAM, PJD_7PARAM, PJD_GRIDSHIFT } from './constants/values';\nimport datum_transform from './datum_transform';\nimport adjust_axis from './adjust_axis';\nimport proj from './Proj';\nimport toPoint from './common/toPoint';\nimport checkSanity from './checkSanity';\n\nfunction checkNotWGS(source, dest) {\n  return (\n    (source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM || source.datum.datum_type === PJD_GRIDSHIFT) && dest.datumCode !== 'WGS84')\n  || ((dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM || dest.datum.datum_type === PJD_GRIDSHIFT) && source.datumCode !== 'WGS84');\n}\n\n/**\n * @param {import('./defs').ProjectionDefinition} source\n * @param {import('./defs').ProjectionDefinition} dest\n * @param {import('./core').TemplateCoordinates} point\n * @param {boolean} enforceAxis\n * @returns {import('./core').InterfaceCoordinates | undefined}\n */\nexport default function transform(source, dest, point, enforceAxis) {\n  var wgs84;\n  if (Array.isArray(point)) {\n    point = toPoint(point);\n  } else {\n    // Clone the point object so inputs don't get modified\n    point = {\n      x: point.x,\n      y: point.y,\n      z: point.z,\n      m: point.m\n    };\n  }\n  var hasZ = point.z !== undefined;\n  checkSanity(point);\n  // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n  if (source.datum && dest.datum && checkNotWGS(source, dest)) {\n    wgs84 = new proj('WGS84');\n    point = transform(source, wgs84, point, enforceAxis);\n    source = wgs84;\n  }\n  // DGR, 2010/11/12\n  if (enforceAxis && source.axis !== 'enu') {\n    point = adjust_axis(source, false, point);\n  }\n  // Transform source points to long/lat, if they aren't already.\n  if (source.projName === 'longlat') {\n    point = {\n      x: point.x * D2R,\n      y: point.y * D2R,\n      z: point.z || 0\n    };\n  } else {\n    if (source.to_meter) {\n      point = {\n        x: point.x * source.to_meter,\n        y: point.y * source.to_meter,\n        z: point.z || 0\n      };\n    }\n    point = source.inverse(point); // Convert Cartesian to longlat\n    if (!point) {\n      return;\n    }\n  }\n  // Adjust for the prime meridian if necessary\n  if (source.from_greenwich) {\n    point.x += source.from_greenwich;\n  }\n\n  // Convert datums if needed, and if possible.\n  point = datum_transform(source.datum, dest.datum, point);\n  if (!point) {\n    return;\n  }\n\n  point = /** @type {import('./core').InterfaceCoordinates} */ (point);\n\n  // Adjust for the prime meridian if necessary\n  if (dest.from_greenwich) {\n    point = {\n      x: point.x - dest.from_greenwich,\n      y: point.y,\n      z: point.z || 0\n    };\n  }\n\n  if (dest.projName === 'longlat') {\n    // convert radians to decimal degrees\n    point = {\n      x: point.x * R2D,\n      y: point.y * R2D,\n      z: point.z || 0\n    };\n  } else { // else project\n    point = dest.forward(point);\n    if (dest.to_meter) {\n      point = {\n        x: point.x / dest.to_meter,\n        y: point.y / dest.to_meter,\n        z: point.z || 0\n      };\n    }\n  }\n\n  // DGR, 2010/11/12\n  if (enforceAxis && dest.axis !== 'enu') {\n    return adjust_axis(dest, true, point);\n  }\n\n  if (point && !hasZ) {\n    delete point.z;\n  }\n  return point;\n}\n","import proj from './Proj';\nimport transform from './transform';\nvar wgs84 = proj('WGS84');\n\n/**\n * @typedef {{x: number, y: number, z?: number, m?: number}} InterfaceCoordinates\n */\n\n/**\n * @typedef {Array<number> | InterfaceCoordinates} TemplateCoordinates\n */\n\n/**\n * @typedef {Object} Converter\n * @property {<T extends TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} forward\n * @property {<T extends TemplateCoordinates>(coordinates: T, enforceAxis?: boolean) => T} inverse\n * @property {proj} [oProj]\n */\n\n/**\n * @typedef {Object} PROJJSONDefinition\n * @property {string} [$schema]\n * @property {string} type\n * @property {string} [name]\n * @property {{authority: string, code: number}} [id]\n * @property {string} [scope]\n * @property {string} [area]\n * @property {{south_latitude: number, west_longitude: number, north_latitude: number, east_longitude: number}} [bbox]\n * @property {PROJJSONDefinition[]} [components]\n * @property {{type: string, name: string}} [datum]\n * @property {{\n *   name: string,\n *   members: Array<{\n *     name: string,\n *     id?: {authority: string, code: number}\n *   }>,\n *   ellipsoid?: {\n *     name: string,\n *     semi_major_axis: number,\n *     inverse_flattening?: number\n *   },\n *   accuracy?: string,\n *   id?: {authority: string, code: number}\n * }} [datum_ensemble]\n * @property {{\n *   subtype: string,\n *   axis: Array<{\n *     name: string,\n *     abbreviation?: string,\n *     direction: string,\n *     unit: string\n *   }>\n * }} [coordinate_system]\n * @property {{\n *   name: string,\n *   method: {name: string},\n *   parameters: Array<{\n *     name: string,\n *     value: number,\n *     unit?: string\n *   }>\n * }} [conversion]\n * @property {{\n *   name: string,\n *   method: {name: string},\n *   parameters: Array<{\n *     name: string,\n *     value: number,\n *     unit?: string,\n *     type?: string,\n *     file_name?: string\n *   }>\n * }} [transformation]\n */\n\n/**\n * @template {TemplateCoordinates} T\n * @param {proj} from\n * @param {proj} to\n * @param {T} coords\n * @param {boolean} [enforceAxis]\n * @returns {T}\n */\nfunction transformer(from, to, coords, enforceAxis) {\n  var transformedArray, out, keys;\n  if (Array.isArray(coords)) {\n    transformedArray = transform(from, to, coords, enforceAxis) || { x: NaN, y: NaN };\n    if (coords.length > 2) {\n      if ((typeof from.name !== 'undefined' && from.name === 'geocent') || (typeof to.name !== 'undefined' && to.name === 'geocent')) {\n        if (typeof transformedArray.z === 'number') {\n          return /** @type {T} */ ([transformedArray.x, transformedArray.y, transformedArray.z].concat(coords.slice(3)));\n        } else {\n          return /** @type {T} */ ([transformedArray.x, transformedArray.y, coords[2]].concat(coords.slice(3)));\n        }\n      } else {\n        return /** @type {T} */ ([transformedArray.x, transformedArray.y].concat(coords.slice(2)));\n      }\n    } else {\n      return /** @type {T} */ ([transformedArray.x, transformedArray.y]);\n    }\n  } else {\n    out = transform(from, to, coords, enforceAxis);\n    keys = Object.keys(coords);\n    if (keys.length === 2) {\n      return /** @type {T} */ (out);\n    }\n    keys.forEach(function (key) {\n      if ((typeof from.name !== 'undefined' && from.name === 'geocent') || (typeof to.name !== 'undefined' && to.name === 'geocent')) {\n        if (key === 'x' || key === 'y' || key === 'z') {\n          return;\n        }\n      } else {\n        if (key === 'x' || key === 'y') {\n          return;\n        }\n      }\n      out[key] = coords[key];\n    });\n    return /** @type {T} */ (out);\n  }\n}\n\n/**\n * @param {proj | string | PROJJSONDefinition | Converter} item\n * @returns {import('./Proj').default}\n */\nfunction checkProj(item) {\n  if (item instanceof proj) {\n    return item;\n  }\n  if (typeof item === 'object' && 'oProj' in item) {\n    return item.oProj;\n  }\n  return proj(/** @type {string | PROJJSONDefinition} */ (item));\n}\n\n/**\n * @overload\n * @param {string | PROJJSONDefinition | proj} toProj\n * @returns {Converter}\n */\n/**\n * @overload\n * @param {string | PROJJSONDefinition | proj} fromProj\n * @param {string | PROJJSONDefinition | proj} toProj\n * @returns {Converter}\n */\n/**\n * @template {TemplateCoordinates} T\n * @overload\n * @param {string | PROJJSONDefinition | proj} toProj\n * @param {T} coord\n * @returns {T}\n */\n/**\n * @template {TemplateCoordinates} T\n * @overload\n * @param {string | PROJJSONDefinition | proj} fromProj\n * @param {string | PROJJSONDefinition | proj} toProj\n * @param {T} coord\n * @returns {T}\n */\n/**\n * @template {TemplateCoordinates} T\n * @param {string | PROJJSONDefinition | proj} fromProjOrToProj\n * @param {string | PROJJSONDefinition | proj | TemplateCoordinates} [toProjOrCoord]\n * @param {T} [coord]\n * @returns {T|Converter}\n */\nfunction proj4(fromProjOrToProj, toProjOrCoord, coord) {\n  /** @type {proj} */\n  var fromProj;\n  /** @type {proj} */\n  var toProj;\n  var single = false;\n  /** @type {Converter} */\n  var obj;\n  if (typeof toProjOrCoord === 'undefined') {\n    toProj = checkProj(fromProjOrToProj);\n    fromProj = wgs84;\n    single = true;\n  } else if (typeof /** @type {?} */ (toProjOrCoord).x !== 'undefined' || Array.isArray(toProjOrCoord)) {\n    coord = /** @type {T} */ (/** @type {?} */ (toProjOrCoord));\n    toProj = checkProj(fromProjOrToProj);\n    fromProj = wgs84;\n    single = true;\n  }\n  if (!fromProj) {\n    fromProj = checkProj(fromProjOrToProj);\n  }\n  if (!toProj) {\n    toProj = checkProj(/** @type {string | PROJJSONDefinition | proj } */ (toProjOrCoord));\n  }\n  if (coord) {\n    return transformer(fromProj, toProj, coord);\n  } else {\n    obj = {\n      /**\n       * @template {TemplateCoordinates} T\n       * @param {T} coords\n       * @param {boolean=} enforceAxis\n       * @returns {T}\n       */\n      forward: function (coords, enforceAxis) {\n        return transformer(fromProj, toProj, coords, enforceAxis);\n      },\n      /**\n       * @template {TemplateCoordinates} T\n       * @param {T} coords\n       * @param {boolean=} enforceAxis\n       * @returns {T}\n       */\n      inverse: function (coords, enforceAxis) {\n        return transformer(toProj, fromProj, coords, enforceAxis);\n      }\n    };\n    if (single) {\n      obj.oProj = toProj;\n    }\n    return obj;\n  }\n}\n\nexport default proj4;\n","\n\n\n/**\n * UTM zones are grouped, and assigned to one of a group of 6\n * sets.\n *\n * {int} @private\n */\nvar NUM_100K_SETS = 6;\n\n/**\n * The column letters (for easting) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';\n\n/**\n * The row letters (for northing) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_ROW_LETTERS = 'AFAFAF';\n\nvar A = 65; // A\nvar I = 73; // I\nvar O = 79; // O\nvar V = 86; // V\nvar Z = 90; // Z\nexport default {\n  forward: forward,\n  inverse: inverse,\n  toPoint: toPoint\n};\n/**\n * Conversion of lat/lon to MGRS.\n *\n * @param {object} ll Object literal with lat and lon properties on a\n *     WGS84 ellipsoid.\n * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for\n *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.\n * @return {string} the MGRS string for the given location and accuracy.\n */\nexport function forward(ll, accuracy) {\n  accuracy = accuracy || 5; // default accuracy 1m\n  return encode(LLtoUTM({\n    lat: ll[1],\n    lon: ll[0]\n  }), accuracy);\n};\n\n/**\n * Conversion of MGRS to lat/lon.\n *\n * @param {string} mgrs MGRS string.\n * @return {array} An array with left (longitude), bottom (latitude), right\n *     (longitude) and top (latitude) values in WGS84, representing the\n *     bounding box for the provided MGRS reference.\n */\nexport function inverse(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];\n  }\n  return [bbox.left, bbox.bottom, bbox.right, bbox.top];\n};\n\nexport function toPoint(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat];\n  }\n  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];\n};\n/**\n * Conversion from degrees to radians.\n *\n * @private\n * @param {number} deg the angle in degrees.\n * @return {number} the angle in radians.\n */\nfunction degToRad(deg) {\n  return (deg * (Math.PI / 180.0));\n}\n\n/**\n * Conversion from radians to degrees.\n *\n * @private\n * @param {number} rad the angle in radians.\n * @return {number} the angle in degrees.\n */\nfunction radToDeg(rad) {\n  return (180.0 * (rad / Math.PI));\n}\n\n/**\n * Converts a set of Longitude and Latitude co-ordinates to UTM\n * using the WGS84 ellipsoid.\n *\n * @private\n * @param {object} ll Object literal with lat and lon properties\n *     representing the WGS84 coordinate to be converted.\n * @return {object} Object literal containing the UTM value with easting,\n *     northing, zoneNumber and zoneLetter properties, and an optional\n *     accuracy property in digits. Returns null if the conversion failed.\n */\nfunction LLtoUTM(ll) {\n  var Lat = ll.lat;\n  var Long = ll.lon;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var k0 = 0.9996;\n  var LongOrigin;\n  var eccPrimeSquared;\n  var N, T, C, A, M;\n  var LatRad = degToRad(Lat);\n  var LongRad = degToRad(Long);\n  var LongOriginRad;\n  var ZoneNumber;\n  // (int)\n  ZoneNumber = Math.floor((Long + 180) / 6) + 1;\n\n  //Make sure the longitude 180.00 is in Zone 60\n  if (Long === 180) {\n    ZoneNumber = 60;\n  }\n\n  // Special zone for Norway\n  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {\n    ZoneNumber = 32;\n  }\n\n  // Special zones for Svalbard\n  if (Lat >= 72.0 && Lat < 84.0) {\n    if (Long >= 0.0 && Long < 9.0) {\n      ZoneNumber = 31;\n    }\n    else if (Long >= 9.0 && Long < 21.0) {\n      ZoneNumber = 33;\n    }\n    else if (Long >= 21.0 && Long < 33.0) {\n      ZoneNumber = 35;\n    }\n    else if (Long >= 33.0 && Long < 42.0) {\n      ZoneNumber = 37;\n    }\n  }\n\n  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin\n  // in middle of\n  // zone\n  LongOriginRad = degToRad(LongOrigin);\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));\n  T = Math.tan(LatRad) * Math.tan(LatRad);\n  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);\n  A = Math.cos(LatRad) * (LongRad - LongOriginRad);\n\n  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));\n\n  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);\n\n  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));\n  if (Lat < 0.0) {\n    UTMNorthing += 10000000.0; //10000000 meter offset for\n    // southern hemisphere\n  }\n\n  return {\n    northing: Math.round(UTMNorthing),\n    easting: Math.round(UTMEasting),\n    zoneNumber: ZoneNumber,\n    zoneLetter: getLetterDesignator(Lat)\n  };\n}\n\n/**\n * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience\n * class where the Zone can be specified as a single string eg.\"60N\" which\n * is then broken down into the ZoneNumber and ZoneLetter.\n *\n * @private\n * @param {object} utm An object literal with northing, easting, zoneNumber\n *     and zoneLetter properties. If an optional accuracy property is\n *     provided (in meters), a bounding box will be returned instead of\n *     latitude and longitude.\n * @return {object} An object literal containing either lat and lon values\n *     (if no accuracy was provided), or top, right, bottom and left values\n *     for the bounding box calculated according to the provided accuracy.\n *     Returns null if the conversion failed.\n */\nfunction UTMtoLL(utm) {\n\n  var UTMNorthing = utm.northing;\n  var UTMEasting = utm.easting;\n  var zoneLetter = utm.zoneLetter;\n  var zoneNumber = utm.zoneNumber;\n  // check the ZoneNummber is valid\n  if (zoneNumber < 0 || zoneNumber > 60) {\n    return null;\n  }\n\n  var k0 = 0.9996;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var eccPrimeSquared;\n  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));\n  var N1, T1, C1, R1, D, M;\n  var LongOrigin;\n  var mu, phi1Rad;\n\n  // remove 500,000 meter offset for longitude\n  var x = UTMEasting - 500000.0;\n  var y = UTMNorthing;\n\n  // We must know somehow if we are in the Northern or Southern\n  // hemisphere, this is the only time we use the letter So even\n  // if the Zone letter isn't exactly correct it should indicate\n  // the hemisphere correctly\n  if (zoneLetter < 'N') {\n    y -= 10000000.0; // remove 10,000,000 meter offset used\n    // for southern hemisphere\n  }\n\n  // There are 60 zones with zone 1 being at West -180 to -174\n  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin\n  // in middle of\n  // zone\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  M = y / k0;\n  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));\n\n  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);\n  // double phi1 = ProjMath.radToDeg(phi1Rad);\n\n  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));\n  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);\n  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);\n  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);\n  D = x / (N1 * k0);\n\n  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);\n  lat = radToDeg(lat);\n\n  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);\n  lon = LongOrigin + radToDeg(lon);\n\n  var result;\n  if (utm.accuracy) {\n    var topRight = UTMtoLL({\n      northing: utm.northing + utm.accuracy,\n      easting: utm.easting + utm.accuracy,\n      zoneLetter: utm.zoneLetter,\n      zoneNumber: utm.zoneNumber\n    });\n    result = {\n      top: topRight.lat,\n      right: topRight.lon,\n      bottom: lat,\n      left: lon\n    };\n  }\n  else {\n    result = {\n      lat: lat,\n      lon: lon\n    };\n  }\n  return result;\n}\n\n/**\n * Calculates the MGRS letter designator for the given latitude.\n *\n * @private\n * @param {number} lat The latitude in WGS84 to get the letter designator\n *     for.\n * @return {char} The letter designator.\n */\nfunction getLetterDesignator(lat) {\n  //This is here as an error flag to show that the Latitude is\n  //outside MGRS limits\n  var LetterDesignator = 'Z';\n\n  if ((84 >= lat) && (lat >= 72)) {\n    LetterDesignator = 'X';\n  }\n  else if ((72 > lat) && (lat >= 64)) {\n    LetterDesignator = 'W';\n  }\n  else if ((64 > lat) && (lat >= 56)) {\n    LetterDesignator = 'V';\n  }\n  else if ((56 > lat) && (lat >= 48)) {\n    LetterDesignator = 'U';\n  }\n  else if ((48 > lat) && (lat >= 40)) {\n    LetterDesignator = 'T';\n  }\n  else if ((40 > lat) && (lat >= 32)) {\n    LetterDesignator = 'S';\n  }\n  else if ((32 > lat) && (lat >= 24)) {\n    LetterDesignator = 'R';\n  }\n  else if ((24 > lat) && (lat >= 16)) {\n    LetterDesignator = 'Q';\n  }\n  else if ((16 > lat) && (lat >= 8)) {\n    LetterDesignator = 'P';\n  }\n  else if ((8 > lat) && (lat >= 0)) {\n    LetterDesignator = 'N';\n  }\n  else if ((0 > lat) && (lat >= -8)) {\n    LetterDesignator = 'M';\n  }\n  else if ((-8 > lat) && (lat >= -16)) {\n    LetterDesignator = 'L';\n  }\n  else if ((-16 > lat) && (lat >= -24)) {\n    LetterDesignator = 'K';\n  }\n  else if ((-24 > lat) && (lat >= -32)) {\n    LetterDesignator = 'J';\n  }\n  else if ((-32 > lat) && (lat >= -40)) {\n    LetterDesignator = 'H';\n  }\n  else if ((-40 > lat) && (lat >= -48)) {\n    LetterDesignator = 'G';\n  }\n  else if ((-48 > lat) && (lat >= -56)) {\n    LetterDesignator = 'F';\n  }\n  else if ((-56 > lat) && (lat >= -64)) {\n    LetterDesignator = 'E';\n  }\n  else if ((-64 > lat) && (lat >= -72)) {\n    LetterDesignator = 'D';\n  }\n  else if ((-72 > lat) && (lat >= -80)) {\n    LetterDesignator = 'C';\n  }\n  return LetterDesignator;\n}\n\n/**\n * Encodes a UTM location as MGRS string.\n *\n * @private\n * @param {object} utm An object literal with easting, northing,\n *     zoneLetter, zoneNumber\n * @param {number} accuracy Accuracy in digits (1-5).\n * @return {string} MGRS string for the given UTM location.\n */\nfunction encode(utm, accuracy) {\n  // prepend with leading zeroes\n  var seasting = \"00000\" + utm.easting,\n    snorthing = \"00000\" + utm.northing;\n\n  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);\n}\n\n/**\n * Get the two letter 100k designator for a given UTM easting,\n * northing and zone number value.\n *\n * @private\n * @param {number} easting\n * @param {number} northing\n * @param {number} zoneNumber\n * @return the two letter 100k designator for the given UTM location.\n */\nfunction get100kID(easting, northing, zoneNumber) {\n  var setParm = get100kSetForZone(zoneNumber);\n  var setColumn = Math.floor(easting / 100000);\n  var setRow = Math.floor(northing / 100000) % 20;\n  return getLetter100kID(setColumn, setRow, setParm);\n}\n\n/**\n * Given a UTM zone number, figure out the MGRS 100K set it is in.\n *\n * @private\n * @param {number} i An UTM zone number.\n * @return {number} the 100k set the UTM zone is in.\n */\nfunction get100kSetForZone(i) {\n  var setParm = i % NUM_100K_SETS;\n  if (setParm === 0) {\n    setParm = NUM_100K_SETS;\n  }\n\n  return setParm;\n}\n\n/**\n * Get the two-letter MGRS 100k designator given information\n * translated from the UTM northing, easting and zone number.\n *\n * @private\n * @param {number} column the column index as it relates to the MGRS\n *        100k set spreadsheet, created from the UTM easting.\n *        Values are 1-8.\n * @param {number} row the row index as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM northing value. Values\n *        are from 0-19.\n * @param {number} parm the set block, as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM zone. Values are from\n *        1-60.\n * @return two letter MGRS 100k code.\n */\nfunction getLetter100kID(column, row, parm) {\n  // colOrigin and rowOrigin are the letters at the origin of the set\n  var index = parm - 1;\n  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);\n  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);\n\n  // colInt and rowInt are the letters to build to return\n  var colInt = colOrigin + column - 1;\n  var rowInt = rowOrigin + row;\n  var rollover = false;\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n    rollover = true;\n  }\n\n  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {\n    colInt++;\n  }\n\n  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {\n    colInt++;\n\n    if (colInt === I) {\n      colInt++;\n    }\n  }\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n    rollover = true;\n  }\n  else {\n    rollover = false;\n  }\n\n  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {\n    rowInt++;\n  }\n\n  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {\n    rowInt++;\n\n    if (rowInt === I) {\n      rowInt++;\n    }\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n  }\n\n  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);\n  return twoLetter;\n}\n\n/**\n * Decode the UTM parameters from a MGRS string.\n *\n * @private\n * @param {string} mgrsString an UPPERCASE coordinate string is expected.\n * @return {object} An object literal with easting, northing, zoneLetter,\n *     zoneNumber and accuracy (in meters) properties.\n */\nfunction decode(mgrsString) {\n\n  if (mgrsString && mgrsString.length === 0) {\n    throw (\"MGRSPoint coverting from nothing\");\n  }\n\n  var length = mgrsString.length;\n\n  var hunK = null;\n  var sb = \"\";\n  var testChar;\n  var i = 0;\n\n  // get Zone number\n  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {\n    if (i >= 2) {\n      throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n    }\n    sb += testChar;\n    i++;\n  }\n\n  var zoneNumber = parseInt(sb, 10);\n\n  if (i === 0 || i + 3 > length) {\n    // A good MGRS string has to be 4-5 digits long,\n    // ##AAA/#AAA at least.\n    throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n  }\n\n  var zoneLetter = mgrsString.charAt(i++);\n\n  // Should we check the zone letter here? Why not.\n  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {\n    throw (\"MGRSPoint zone letter \" + zoneLetter + \" not handled: \" + mgrsString);\n  }\n\n  hunK = mgrsString.substring(i, i += 2);\n\n  var set = get100kSetForZone(zoneNumber);\n\n  var east100k = getEastingFromChar(hunK.charAt(0), set);\n  var north100k = getNorthingFromChar(hunK.charAt(1), set);\n\n  // We have a bug where the northing may be 2000000 too low.\n  // How\n  // do we know when to roll over?\n\n  while (north100k < getMinNorthing(zoneLetter)) {\n    north100k += 2000000;\n  }\n\n  // calculate the char index for easting/northing separator\n  var remainder = length - i;\n\n  if (remainder % 2 !== 0) {\n    throw (\"MGRSPoint has to have an even number \\nof digits after the zone letter and two 100km letters - front \\nhalf for easting meters, second half for \\nnorthing meters\" + mgrsString);\n  }\n\n  var sep = remainder / 2;\n\n  var sepEasting = 0.0;\n  var sepNorthing = 0.0;\n  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;\n  if (sep > 0) {\n    accuracyBonus = 100000.0 / Math.pow(10, sep);\n    sepEastingString = mgrsString.substring(i, i + sep);\n    sepEasting = parseFloat(sepEastingString) * accuracyBonus;\n    sepNorthingString = mgrsString.substring(i + sep);\n    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;\n  }\n\n  easting = sepEasting + east100k;\n  northing = sepNorthing + north100k;\n\n  return {\n    easting: easting,\n    northing: northing,\n    zoneLetter: zoneLetter,\n    zoneNumber: zoneNumber,\n    accuracy: accuracyBonus\n  };\n}\n\n/**\n * Given the first letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the easting value that\n * should be added to the other, secondary easting value.\n *\n * @private\n * @param {char} e The first letter from a two-letter MGRS 100k zone.\n * @param {number} set The MGRS table set for the zone number.\n * @return {number} The easting value for the given letter and set.\n */\nfunction getEastingFromChar(e, set) {\n  // colOrigin is the letter at the origin of the set for the\n  // column\n  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);\n  var eastingValue = 100000.0;\n  var rewindMarker = false;\n\n  while (curCol !== e.charCodeAt(0)) {\n    curCol++;\n    if (curCol === I) {\n      curCol++;\n    }\n    if (curCol === O) {\n      curCol++;\n    }\n    if (curCol > Z) {\n      if (rewindMarker) {\n        throw (\"Bad character: \" + e);\n      }\n      curCol = A;\n      rewindMarker = true;\n    }\n    eastingValue += 100000.0;\n  }\n\n  return eastingValue;\n}\n\n/**\n * Given the second letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the northing value that\n * should be added to the other, secondary northing value. You have to\n * remember that Northings are determined from the equator, and the vertical\n * cycle of letters mean a 2000000 additional northing meters. This happens\n * approx. every 18 degrees of latitude. This method does *NOT* count any\n * additional northings. You have to figure out how many 2000000 meters need\n * to be added for the zone letter of the MGRS coordinate.\n *\n * @private\n * @param {char} n Second letter of the MGRS 100k zone\n * @param {number} set The MGRS table set number, which is dependent on the\n *     UTM zone number.\n * @return {number} The northing value for the given letter and set.\n */\nfunction getNorthingFromChar(n, set) {\n\n  if (n > 'V') {\n    throw (\"MGRSPoint given invalid Northing \" + n);\n  }\n\n  // rowOrigin is the letter at the origin of the set for the\n  // column\n  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);\n  var northingValue = 0.0;\n  var rewindMarker = false;\n\n  while (curRow !== n.charCodeAt(0)) {\n    curRow++;\n    if (curRow === I) {\n      curRow++;\n    }\n    if (curRow === O) {\n      curRow++;\n    }\n    // fixing a bug making whole application hang in this loop\n    // when 'n' is a wrong character\n    if (curRow > V) {\n      if (rewindMarker) { // making sure that this loop ends\n        throw (\"Bad character: \" + n);\n      }\n      curRow = A;\n      rewindMarker = true;\n    }\n    northingValue += 100000.0;\n  }\n\n  return northingValue;\n}\n\n/**\n * The function getMinNorthing returns the minimum northing value of a MGRS\n * zone.\n *\n * Ported from Geotrans' c Lattitude_Band_Value structure table.\n *\n * @private\n * @param {char} zoneLetter The MGRS zone to get the min northing for.\n * @return {number}\n */\nfunction getMinNorthing(zoneLetter) {\n  var northing;\n  switch (zoneLetter) {\n  case 'C':\n    northing = 1100000.0;\n    break;\n  case 'D':\n    northing = 2000000.0;\n    break;\n  case 'E':\n    northing = 2800000.0;\n    break;\n  case 'F':\n    northing = 3700000.0;\n    break;\n  case 'G':\n    northing = 4600000.0;\n    break;\n  case 'H':\n    northing = 5500000.0;\n    break;\n  case 'J':\n    northing = 6400000.0;\n    break;\n  case 'K':\n    northing = 7300000.0;\n    break;\n  case 'L':\n    northing = 8200000.0;\n    break;\n  case 'M':\n    northing = 9100000.0;\n    break;\n  case 'N':\n    northing = 0.0;\n    break;\n  case 'P':\n    northing = 800000.0;\n    break;\n  case 'Q':\n    northing = 1700000.0;\n    break;\n  case 'R':\n    northing = 2600000.0;\n    break;\n  case 'S':\n    northing = 3500000.0;\n    break;\n  case 'T':\n    northing = 4400000.0;\n    break;\n  case 'U':\n    northing = 5300000.0;\n    break;\n  case 'V':\n    northing = 6200000.0;\n    break;\n  case 'W':\n    northing = 7000000.0;\n    break;\n  case 'X':\n    northing = 7900000.0;\n    break;\n  default:\n    northing = -1.0;\n  }\n  if (northing >= 0.0) {\n    return northing;\n  }\n  else {\n    throw (\"Invalid zone letter: \" + zoneLetter);\n  }\n\n}\n","import { toPoint, forward } from 'mgrs';\n\n/**\n * @deprecated v3.0.0 - use proj4.toPoint instead\n * @param {number | import('./core').TemplateCoordinates | string} x\n * @param {number} [y]\n * @param {number} [z]\n */\nfunction Point(x, y, z) {\n  if (!(this instanceof Point)) {\n    return new Point(x, y, z);\n  }\n  if (Array.isArray(x)) {\n    this.x = x[0];\n    this.y = x[1];\n    this.z = x[2] || 0.0;\n  } else if (typeof x === 'object') {\n    this.x = x.x;\n    this.y = x.y;\n    this.z = x.z || 0.0;\n  } else if (typeof x === 'string' && typeof y === 'undefined') {\n    var coords = x.split(',');\n    this.x = parseFloat(coords[0]);\n    this.y = parseFloat(coords[1]);\n    this.z = parseFloat(coords[2]) || 0.0;\n  } else {\n    this.x = x;\n    this.y = y;\n    this.z = z || 0.0;\n  }\n  console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');\n}\n\nPoint.fromMGRS = function (mgrsStr) {\n  return new Point(toPoint(mgrsStr));\n};\nPoint.prototype.toMGRS = function (accuracy) {\n  return forward([this.x, this.y], accuracy);\n};\nexport default Point;\n","var C00 = 1;\nvar C02 = 0.25;\nvar C04 = 0.046875;\nvar C06 = 0.01953125;\nvar C08 = 0.01068115234375;\nvar C22 = 0.75;\nvar C44 = 0.46875;\nvar C46 = 0.01302083333333333333;\nvar C48 = 0.00712076822916666666;\nvar C66 = 0.36458333333333333333;\nvar C68 = 0.00569661458333333333;\nvar C88 = 0.3076171875;\n\nexport default function (es) {\n  var en = [];\n  en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));\n  en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));\n  var t = es * es;\n  en[2] = t * (C44 - es * (C46 + es * C48));\n  t *= es;\n  en[3] = t * (C66 - es * C68);\n  en[4] = t * es * C88;\n  return en;\n}\n","export default function (phi, sphi, cphi, en) {\n  cphi *= sphi;\n  sphi *= sphi;\n  return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));\n}\n","import pj_mlfn from './pj_mlfn';\nimport { EPSLN } from '../constants/values';\n\nvar MAX_ITER = 20;\n\nexport default function (arg, es, en) {\n  var k = 1 / (1 - es);\n  var phi = arg;\n  for (var i = MAX_ITER; i; --i) { /* rarely goes over 2 iterations */\n    var s = Math.sin(phi);\n    var t = 1 - es * s * s;\n    // t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n    // phi -= t * (t * Math.sqrt(t)) * k;\n    t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n    phi -= t;\n    if (Math.abs(t) < EPSLN) {\n      return phi;\n    }\n  }\n  // ..reportError(\"cass:pj_inv_mlfn: Convergence error\");\n  return phi;\n}\n","// Heavily based on this tmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/tmerc.js\n\nimport pj_enfn from '../common/pj_enfn';\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport adjust_lon from '../common/adjust_lon';\n\nimport { EPSLN, HALF_PI } from '../constants/values';\nimport sign from '../common/sign';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} es\n * @property {Array<number>} en\n * @property {number} ml0\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  if (this.es) {\n    this.en = pj_enfn(this.es);\n    this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);\n  }\n}\n\n/**\n    Transverse Mercator Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var con;\n  var x, y;\n  var sin_phi = Math.sin(lat);\n  var cos_phi = Math.cos(lat);\n\n  if (!this.es) {\n    var b = cos_phi * Math.sin(delta_lon);\n\n    if ((Math.abs(Math.abs(b) - 1)) < EPSLN) {\n      return (93);\n    } else {\n      x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;\n      y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));\n      b = Math.abs(y);\n\n      if (b >= 1) {\n        if ((b - 1) > EPSLN) {\n          return (93);\n        } else {\n          y = 0;\n        }\n      } else {\n        y = Math.acos(y);\n      }\n\n      if (lat < 0) {\n        y = -y;\n      }\n\n      y = this.a * this.k0 * (y - this.lat0) + this.y0;\n    }\n  } else {\n    var al = cos_phi * delta_lon;\n    var als = Math.pow(al, 2);\n    var c = this.ep2 * Math.pow(cos_phi, 2);\n    var cs = Math.pow(c, 2);\n    var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;\n    var t = Math.pow(tq, 2);\n    var ts = Math.pow(t, 2);\n    con = 1 - this.es * Math.pow(sin_phi, 2);\n    al = al / Math.sqrt(con);\n    var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);\n\n    x = this.a * (this.k0 * al * (1\n      + als / 6 * (1 - t + c\n        + als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c\n          + als / 42 * (61 + 179 * ts - ts * t - 479 * t)))))\n        + this.x0;\n\n    y = this.a * (this.k0 * (ml - this.ml0\n      + sin_phi * delta_lon * al / 2 * (1\n        + als / 12 * (5 - t + 9 * c + 4 * cs\n          + als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c\n            + als / 56 * (1385 + 543 * ts - ts * t - 3111 * t))))))\n          + this.y0;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\n/**\n    Transverse Mercator Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var con, phi;\n  var lat, lon;\n  var x = (p.x - this.x0) * (1 / this.a);\n  var y = (p.y - this.y0) * (1 / this.a);\n\n  if (!this.es) {\n    var f = Math.exp(x / this.k0);\n    var g = 0.5 * (f - 1 / f);\n    var temp = this.lat0 + y / this.k0;\n    var h = Math.cos(temp);\n    con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));\n    lat = Math.asin(con);\n\n    if (y < 0) {\n      lat = -lat;\n    }\n\n    if ((g === 0) && (h === 0)) {\n      lon = 0;\n    } else {\n      lon = adjust_lon(Math.atan2(g, h) + this.long0);\n    }\n  } else { // ellipsoidal form\n    con = this.ml0 + y / this.k0;\n    phi = pj_inv_mlfn(con, this.es, this.en);\n\n    if (Math.abs(phi) < HALF_PI) {\n      var sin_phi = Math.sin(phi);\n      var cos_phi = Math.cos(phi);\n      var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;\n      var c = this.ep2 * Math.pow(cos_phi, 2);\n      var cs = Math.pow(c, 2);\n      var t = Math.pow(tan_phi, 2);\n      var ts = Math.pow(t, 2);\n      con = 1 - this.es * Math.pow(sin_phi, 2);\n      var d = x * Math.sqrt(con) / this.k0;\n      var ds = Math.pow(d, 2);\n      con = con * tan_phi;\n\n      lat = phi - (con * ds / (1 - this.es)) * 0.5 * (1\n        - ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs\n          - ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c\n            - ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));\n\n      lon = adjust_lon(this.long0 + (d * (1\n        - ds / 6 * (1 + 2 * t + c\n          - ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c\n            - ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi));\n    } else {\n      lat = HALF_PI * sign(y);\n      lon = 0;\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = ['Fast_Transverse_Mercator', 'Fast Transverse Mercator'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function (x) {\n  var r = Math.exp(x);\n  r = (r - 1 / r) / 2;\n  return r;\n}\n","export default function (x, y) {\n  x = Math.abs(x);\n  y = Math.abs(y);\n  var a = Math.max(x, y);\n  var b = Math.min(x, y) / (a ? a : 1);\n\n  return a * Math.sqrt(1 + Math.pow(b, 2));\n}\n","import hypot from './hypot';\nimport log1py from './log1py';\n\nexport default function (x) {\n  var y = Math.abs(x);\n  y = log1py(y * (1 + y / (hypot(1, y) + 1)));\n\n  return x < 0 ? -y : y;\n}\n","export default function (x) {\n  var y = 1 + x;\n  var z = y - 1;\n\n  return z === 0 ? x : x * Math.log(y) / z;\n}\n","export default function (pp, B) {\n  var cos_2B = 2 * Math.cos(2 * B);\n  var i = pp.length - 1;\n  var h1 = pp[i];\n  var h2 = 0;\n  var h;\n\n  while (--i >= 0) {\n    h = -h2 + cos_2B * h1 + pp[i];\n    h2 = h1;\n    h1 = h;\n  }\n\n  return (B + h * Math.sin(2 * B));\n}\n","import sinh from './sinh';\nimport cosh from './cosh';\n\nexport default function (pp, arg_r, arg_i) {\n  var sin_arg_r = Math.sin(arg_r);\n  var cos_arg_r = Math.cos(arg_r);\n  var sinh_arg_i = sinh(arg_i);\n  var cosh_arg_i = cosh(arg_i);\n  var r = 2 * cos_arg_r * cosh_arg_i;\n  var i = -2 * sin_arg_r * sinh_arg_i;\n  var j = pp.length - 1;\n  var hr = pp[j];\n  var hi1 = 0;\n  var hr1 = 0;\n  var hi = 0;\n  var hr2;\n  var hi2;\n\n  while (--j >= 0) {\n    hr2 = hr1;\n    hi2 = hi1;\n    hr1 = hr;\n    hi1 = hi;\n    hr = -hr2 + r * hr1 - i * hi1 + pp[j];\n    hi = -hi2 + i * hr1 + r * hi1;\n  }\n\n  r = sin_arg_r * cosh_arg_i;\n  i = cos_arg_r * sinh_arg_i;\n\n  return [r * hr - i * hi, r * hi + i * hr];\n}\n","export default function (x) {\n  var r = Math.exp(x);\n  r = (r + 1 / r) / 2;\n  return r;\n}\n","// Heavily based on this etmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/etmerc.js\n\nimport tmerc from '../projections/tmerc';\nimport sinh from '../common/sinh';\nimport hypot from '../common/hypot';\nimport asinhy from '../common/asinhy';\nimport gatg from '../common/gatg';\nimport clens from '../common/clens';\nimport clens_cmplx from '../common/clens_cmplx';\nimport adjust_lon from '../common/adjust_lon';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} es\n * @property {Array<number>} cbg\n * @property {Array<number>} cgb\n * @property {Array<number>} utg\n * @property {Array<number>} gtu\n * @property {number} Qn\n * @property {number} Zb\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  if (!this.approx && (isNaN(this.es) || this.es <= 0)) {\n    throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION[\"Fast_Transverse_Mercator\"] in the WKT.');\n  }\n  if (this.approx) {\n    // When '+approx' is set, use tmerc instead\n    tmerc.init.apply(this);\n    this.forward = tmerc.forward;\n    this.inverse = tmerc.inverse;\n  }\n\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  this.cgb = [];\n  this.cbg = [];\n  this.utg = [];\n  this.gtu = [];\n\n  var f = this.es / (1 + Math.sqrt(1 - this.es));\n  var n = f / (2 - f);\n  var np = n;\n\n  this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675))))));\n  this.cbg[0] = n * (-2 + n * (2 / 3 + n * (4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));\n\n  np = np * n;\n  this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));\n  this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * (-13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));\n\n  np = np * n;\n  this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));\n  this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));\n\n  np = np * n;\n  this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));\n  this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * (-24832 / 14175)));\n\n  np = np * n;\n  this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));\n  this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));\n\n  np = np * n;\n  this.cgb[5] = np * (601676 / 22275);\n  this.cbg[5] = np * (444337 / 155925);\n\n  np = Math.pow(n, 2);\n  this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));\n\n  this.utg[0] = n * (-0.5 + n * (2 / 3 + n * (-37 / 96 + n * (1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));\n  this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));\n\n  this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));\n  this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));\n\n  np = np * n;\n  this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720))));\n  this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));\n\n  np = np * n;\n  this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));\n  this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));\n\n  np = np * n;\n  this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));\n  this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));\n\n  np = np * n;\n  this.utg[5] = np * (-20648693 / 638668800);\n  this.gtu[5] = np * (212378941 / 319334400);\n\n  var Z = gatg(this.cbg, this.lat0);\n  this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));\n}\n\nexport function forward(p) {\n  var Ce = adjust_lon(p.x - this.long0);\n  var Cn = p.y;\n\n  Cn = gatg(this.cbg, Cn);\n  var sin_Cn = Math.sin(Cn);\n  var cos_Cn = Math.cos(Cn);\n  var sin_Ce = Math.sin(Ce);\n  var cos_Ce = Math.cos(Ce);\n\n  Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);\n  Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));\n  Ce = asinhy(Math.tan(Ce));\n\n  var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);\n\n  Cn = Cn + tmp[0];\n  Ce = Ce + tmp[1];\n\n  var x;\n  var y;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    x = this.a * (this.Qn * Ce) + this.x0;\n    y = this.a * (this.Qn * Cn + this.Zb) + this.y0;\n  } else {\n    x = Infinity;\n    y = Infinity;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\nexport function inverse(p) {\n  var Ce = (p.x - this.x0) * (1 / this.a);\n  var Cn = (p.y - this.y0) * (1 / this.a);\n\n  Cn = (Cn - this.Zb) / this.Qn;\n  Ce = Ce / this.Qn;\n\n  var lon;\n  var lat;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);\n\n    Cn = Cn + tmp[0];\n    Ce = Ce + tmp[1];\n    Ce = Math.atan(sinh(Ce));\n\n    var sin_Cn = Math.sin(Cn);\n    var cos_Cn = Math.cos(Cn);\n    var sin_Ce = Math.sin(Ce);\n    var cos_Ce = Math.cos(Ce);\n\n    Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));\n    Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);\n\n    lon = adjust_lon(Ce + this.long0);\n    lat = gatg(this.cgb, Cn);\n  } else {\n    lon = Infinity;\n    lat = Infinity;\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = ['Extended_Transverse_Mercator', 'Extended Transverse Mercator', 'etmerc', 'Transverse_Mercator', 'Transverse Mercator', 'Gauss Kruger', 'Gauss_Kruger', 'tmerc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function (pp, arg_r) {\n  var r = 2 * Math.cos(arg_r);\n  var i = pp.length - 1;\n  var hr1 = pp[i];\n  var hr2 = 0;\n  var hr;\n\n  while (--i >= 0) {\n    hr = -hr2 + r * hr1 + pp[i];\n    hr2 = hr1;\n    hr1 = hr;\n  }\n\n  return Math.sin(arg_r) * hr;\n}\n","import adjust_zone from '../common/adjust_zone';\nimport etmerc from './etmerc';\nexport var dependsOn = 'etmerc';\nimport { D2R } from '../constants/values';\n\n/** @this {import('../defs.js').ProjectionDefinition} */\nexport function init() {\n  var zone = adjust_zone(this.zone, this.long0);\n  if (zone === undefined) {\n    throw new Error('unknown utm zone');\n  }\n  this.lat0 = 0;\n  this.long0 = ((6 * Math.abs(zone)) - 183) * D2R;\n  this.x0 = 500000;\n  this.y0 = this.utmSouth ? 10000000 : 0;\n  this.k0 = 0.9996;\n\n  etmerc.init.apply(this);\n  this.forward = etmerc.forward;\n  this.inverse = etmerc.inverse;\n}\n\nexport var names = ['Universal Transverse Mercator System', 'utm'];\nexport default {\n  init: init,\n  names: names,\n  dependsOn: dependsOn\n};\n","import adjust_lon from './adjust_lon';\n\nexport default function (zone, lon) {\n  if (zone === undefined) {\n    zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;\n\n    if (zone < 0) {\n      return 0;\n    } else if (zone > 60) {\n      return 60;\n    }\n  }\n  return zone;\n}\n","export default function (esinp, exp) {\n  return (Math.pow((1 - esinp) / (1 + esinp), exp));\n}\n","import srat from '../common/srat';\nvar MAX_ITER = 20;\nimport { HALF_PI, FORTPI } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} rc\n * @property {number} C\n * @property {number} phic0\n * @property {number} ratexp\n * @property {number} K\n * @property {number} e\n * @property {number} es\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  var sphi = Math.sin(this.lat0);\n  var cphi = Math.cos(this.lat0);\n  cphi *= cphi;\n  this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);\n  this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));\n  this.phic0 = Math.asin(sphi / this.C);\n  this.ratexp = 0.5 * this.C * this.e;\n  this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;\n  p.x = this.C * lon;\n  return p;\n}\n\nexport function inverse(p) {\n  var DEL_TOL = 1e-14;\n  var lon = p.x / this.C;\n  var lat = p.y;\n  var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);\n  for (var i = MAX_ITER; i > 0; --i) {\n    lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), -0.5 * this.e)) - HALF_PI;\n    if (Math.abs(lat - p.y) < DEL_TOL) {\n      break;\n    }\n    p.y = lat;\n  }\n  /* convergence failed */\n  if (!i) {\n    return null;\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['gauss'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import gauss from './gauss';\nimport adjust_lon from '../common/adjust_lon';\nimport hypot from '../common/hypot';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} sinc0\n * @property {number} cosc0\n * @property {number} R2\n * @property {number} rc\n * @property {number} phic0\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  gauss.init.apply(this);\n  if (!this.rc) {\n    return;\n  }\n  this.sinc0 = Math.sin(this.phic0);\n  this.cosc0 = Math.cos(this.phic0);\n  this.R2 = 2 * this.rc;\n  if (!this.title) {\n    this.title = 'Oblique Stereographic Alternative';\n  }\n}\n\nexport function forward(p) {\n  var sinc, cosc, cosl, k;\n  p.x = adjust_lon(p.x - this.long0);\n  gauss.forward.apply(this, [p]);\n  sinc = Math.sin(p.y);\n  cosc = Math.cos(p.y);\n  cosl = Math.cos(p.x);\n  k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);\n  p.x = k * cosc * Math.sin(p.x);\n  p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);\n  p.x = this.a * p.x + this.x0;\n  p.y = this.a * p.y + this.y0;\n  return p;\n}\n\nexport function inverse(p) {\n  var sinc, cosc, lon, lat, rho;\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n  if ((rho = hypot(p.x, p.y))) {\n    var c = 2 * Math.atan2(rho, this.R2);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n    lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);\n    lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);\n  } else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  gauss.inverse.apply(this, [p]);\n  p.x = adjust_lon(p.x + this.long0);\n  return p;\n}\n\nexport var names = ['Stereographic_North_Pole', 'Oblique_Stereographic', 'sterea', 'Oblique Stereographic Alternative', 'Double_Stereographic'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import { EPSLN, HALF_PI } from '../constants/values';\n\nimport sign from '../common/sign';\nimport msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport adjust_lon from '../common/adjust_lon';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} coslat0\n * @property {number} sinlat0\n * @property {number} ms1\n * @property {number} X0\n * @property {number} cosX0\n * @property {number} sinX0\n * @property {number} con\n * @property {number} cons\n * @property {number} e\n */\n\nexport function ssfn_(phit, sinphi, eccen) {\n  sinphi *= eccen;\n  return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));\n}\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  // setting default parameters\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n\n  this.coslat0 = Math.cos(this.lat0);\n  this.sinlat0 = Math.sin(this.lat0);\n  if (this.sphere) {\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n      this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));\n    }\n  } else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (this.lat0 > 0) {\n        // North pole\n        // trace('stere:north pole');\n        this.con = 1;\n      } else {\n        // South pole\n        // trace('stere:south pole');\n        this.con = -1;\n      }\n    }\n    this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN && Math.abs(Math.cos(this.lat_ts)) > EPSLN) {\n      // When k0 is 1 (default value) and lat_ts is a vaild number and lat0 is at a pole and lat_ts is not at a pole\n      // Recalculate k0 using formula 21-35 from p161 of Snyder, 1987\n      this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));\n    }\n    this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);\n    this.X0 = 2 * Math.atan(ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;\n    this.cosX0 = Math.cos(this.X0);\n    this.sinX0 = Math.sin(this.X0);\n  }\n}\n\n// Stereographic forward equations--mapping lat,long to x,y\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinlat = Math.sin(lat);\n  var coslat = Math.cos(lat);\n  var A, X, sinX, cosX, ts, rh;\n  var dlon = adjust_lon(lon - this.long0);\n\n  if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {\n    // case of the origine point\n    // trace('stere:this is the origin point');\n    p.x = NaN;\n    p.y = NaN;\n    return p;\n  }\n  if (this.sphere) {\n    // trace('stere:sphere case');\n    A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));\n    p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;\n    p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;\n    return p;\n  } else {\n    X = 2 * Math.atan(ssfn_(lat, sinlat, this.e)) - HALF_PI;\n    cosX = Math.cos(X);\n    sinX = Math.sin(X);\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      ts = tsfnz(this.e, lat * this.con, this.con * sinlat);\n      rh = 2 * this.a * this.k0 * ts / this.cons;\n      p.x = this.x0 + rh * Math.sin(lon - this.long0);\n      p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);\n      // trace(p.toString());\n      return p;\n    } else if (Math.abs(this.sinlat0) < EPSLN) {\n      // Eq\n      // trace('stere:equateur');\n      A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));\n      p.y = A * sinX;\n    } else {\n      // other case\n      // trace('stere:normal case');\n      A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));\n      p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;\n    }\n    p.x = A * cosX * Math.sin(dlon) + this.x0;\n  }\n  // trace(p.toString());\n  return p;\n}\n\n//* Stereographic inverse equations--mapping x,y to lat/long\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat, ts, ce, Chi;\n  var rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  if (this.sphere) {\n    var c = 2 * Math.atan(rh / (2 * this.a * this.k0));\n    lon = this.long0;\n    lat = this.lat0;\n    if (rh <= EPSLN) {\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);\n    if (Math.abs(this.coslat0) < EPSLN) {\n      if (this.lat0 > 0) {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y));\n      } else {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      }\n    } else {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  } else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (rh <= EPSLN) {\n        lat = this.lat0;\n        lon = this.long0;\n        p.x = lon;\n        p.y = lat;\n        // trace(p.toString());\n        return p;\n      }\n      p.x *= this.con;\n      p.y *= this.con;\n      ts = rh * this.cons / (2 * this.a * this.k0);\n      lat = this.con * phi2z(this.e, ts);\n      lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, -1 * p.y));\n    } else {\n      ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));\n      lon = this.long0;\n      if (rh <= EPSLN) {\n        Chi = this.X0;\n      } else {\n        Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));\n      }\n      lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n\n  // trace(p.toString());\n  return p;\n}\n\nexport var names = ['stere', 'Stereographic_South_Pole', 'Polar_Stereographic_variant_A', 'Polar_Stereographic_variant_B', 'Polar_Stereographic'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  ssfn_: ssfn_\n};\n","/*\n  references:\n    Formules et constantes pour le Calcul pour la\n    projection cylindrique conforme  axe oblique et pour la transformation entre\n    des systmes de rfrence.\n    http://www.swisstopo.admin.ch/internet/swisstopo/fr/home/topics/survey/sys/refsys/switzerland.parsysrelated1.31216.downloadList.77004.DownloadFile.tmp/swissprojectionfr.pdf\n  */\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} lambda0\n * @property {number} e\n * @property {number} R\n * @property {number} b0\n * @property {number} K\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  var phy0 = this.lat0;\n  this.lambda0 = this.long0;\n  var sinPhy0 = Math.sin(phy0);\n  var semiMajorAxis = this.a;\n  var invF = this.rf;\n  var flattening = 1 / invF;\n  var e2 = 2 * flattening - Math.pow(flattening, 2);\n  var e = this.e = Math.sqrt(e2);\n  this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));\n  this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));\n  this.b0 = Math.asin(sinPhy0 / this.alpha);\n  var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));\n  var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));\n  var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));\n  this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;\n}\n\nexport function forward(p) {\n  var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));\n  var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));\n  var S = -this.alpha * (Sa1 + Sa2) + this.K;\n\n  // spheric latitude\n  var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);\n\n  // spheric longitude\n  var I = this.alpha * (p.x - this.lambda0);\n\n  // psoeudo equatorial rotation\n  var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));\n\n  var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));\n\n  p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;\n  p.x = this.R * rotI + this.x0;\n  return p;\n}\n\nexport function inverse(p) {\n  var Y = p.x - this.x0;\n  var X = p.y - this.y0;\n\n  var rotI = Y / this.R;\n  var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);\n\n  var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));\n  var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));\n\n  var lambda = this.lambda0 + I / this.alpha;\n\n  var S = 0;\n  var phy = b;\n  var prevPhy = -1000;\n  var iteration = 0;\n  while (Math.abs(phy - prevPhy) > 0.0000001) {\n    if (++iteration > 20) {\n      // ...reportError(\"omercFwdInfinity\");\n      return;\n    }\n    // S = Math.log(Math.tan(Math.PI / 4 + phy / 2));\n    S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));\n    prevPhy = phy;\n    phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;\n  }\n\n  p.x = lambda;\n  p.y = phy;\n  return p;\n}\n\nexport var names = ['somerc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import tsfnz from '../common/tsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport { EPSLN, HALF_PI, TWO_PI, FORTPI } from '../constants/values';\nimport { getNormalizedProjName } from '../projections';\n\n/**\n * @typedef {Object} LocalThis\n * @property {boolean} no_off\n * @property {boolean} no_rot\n * @property {number} rectified_grid_angle\n * @property {number} es\n * @property {number} A\n * @property {number} B\n * @property {number} E\n * @property {number} e\n * @property {number} lam0\n * @property {number} singam\n * @property {number} cosgam\n * @property {number} sinrot\n * @property {number} cosrot\n * @property {number} rB\n * @property {number} ArB\n * @property {number} BrA\n * @property {number} u_0\n * @property {number} v_pole_n\n * @property {number} v_pole_s\n */\n\nvar TOL = 1e-7;\n\nfunction isTypeA(P) {\n  var typeAProjections = ['Hotine_Oblique_Mercator', 'Hotine_Oblique_Mercator_variant_A', 'Hotine_Oblique_Mercator_Azimuth_Natural_Origin'];\n  var projectionName = typeof P.projName === 'object' ? Object.keys(P.projName)[0] : P.projName;\n\n  return 'no_uoff' in P || 'no_off' in P || typeAProjections.indexOf(projectionName) !== -1 || typeAProjections.indexOf(getNormalizedProjName(projectionName)) !== -1;\n}\n\n/**\n * Initialize the Oblique Mercator  projection\n * @this {import('../defs.js').ProjectionDefinition & LocalThis}\n */\nexport function init() {\n  var con, com, cosph0, D, F, H, L, sinph0, p, J, gamma = 0,\n    gamma0, lamc = 0, lam1 = 0, lam2 = 0, phi1 = 0, phi2 = 0, alpha_c = 0;\n\n  // only Type A uses the no_off or no_uoff property\n  // https://github.com/OSGeo/proj.4/issues/104\n  this.no_off = isTypeA(this);\n  this.no_rot = 'no_rot' in this;\n\n  var alp = false;\n  if ('alpha' in this) {\n    alp = true;\n  }\n\n  var gam = false;\n  if ('rectified_grid_angle' in this) {\n    gam = true;\n  }\n\n  if (alp) {\n    alpha_c = this.alpha;\n  }\n\n  if (gam) {\n    gamma = this.rectified_grid_angle;\n  }\n\n  if (alp || gam) {\n    lamc = this.longc;\n  } else {\n    lam1 = this.long1;\n    phi1 = this.lat1;\n    lam2 = this.long2;\n    phi2 = this.lat2;\n\n    if (Math.abs(phi1 - phi2) <= TOL || (con = Math.abs(phi1)) <= TOL\n      || Math.abs(con - HALF_PI) <= TOL || Math.abs(Math.abs(this.lat0) - HALF_PI) <= TOL\n      || Math.abs(Math.abs(phi2) - HALF_PI) <= TOL) {\n      throw new Error();\n    }\n  }\n\n  var one_es = 1.0 - this.es;\n  com = Math.sqrt(one_es);\n\n  if (Math.abs(this.lat0) > EPSLN) {\n    sinph0 = Math.sin(this.lat0);\n    cosph0 = Math.cos(this.lat0);\n    con = 1 - this.es * sinph0 * sinph0;\n    this.B = cosph0 * cosph0;\n    this.B = Math.sqrt(1 + this.es * this.B * this.B / one_es);\n    this.A = this.B * this.k0 * com / con;\n    D = this.B * com / (cosph0 * Math.sqrt(con));\n    F = D * D - 1;\n\n    if (F <= 0) {\n      F = 0;\n    } else {\n      F = Math.sqrt(F);\n      if (this.lat0 < 0) {\n        F = -F;\n      }\n    }\n\n    this.E = F += D;\n    this.E *= Math.pow(tsfnz(this.e, this.lat0, sinph0), this.B);\n  } else {\n    this.B = 1 / com;\n    this.A = this.k0;\n    this.E = D = F = 1;\n  }\n\n  if (alp || gam) {\n    if (alp) {\n      gamma0 = Math.asin(Math.sin(alpha_c) / D);\n      if (!gam) {\n        gamma = alpha_c;\n      }\n    } else {\n      gamma0 = gamma;\n      alpha_c = Math.asin(D * Math.sin(gamma0));\n    }\n    this.lam0 = lamc - Math.asin(0.5 * (F - 1 / F) * Math.tan(gamma0)) / this.B;\n  } else {\n    H = Math.pow(tsfnz(this.e, phi1, Math.sin(phi1)), this.B);\n    L = Math.pow(tsfnz(this.e, phi2, Math.sin(phi2)), this.B);\n    F = this.E / H;\n    p = (L - H) / (L + H);\n    J = this.E * this.E;\n    J = (J - L * H) / (J + L * H);\n    con = lam1 - lam2;\n\n    if (con < -Math.PI) {\n      lam2 -= TWO_PI;\n    } else if (con > Math.PI) {\n      lam2 += TWO_PI;\n    }\n\n    this.lam0 = adjust_lon(0.5 * (lam1 + lam2) - Math.atan(J * Math.tan(0.5 * this.B * (lam1 - lam2)) / p) / this.B);\n    gamma0 = Math.atan(2 * Math.sin(this.B * adjust_lon(lam1 - this.lam0)) / (F - 1 / F));\n    gamma = alpha_c = Math.asin(D * Math.sin(gamma0));\n  }\n\n  this.singam = Math.sin(gamma0);\n  this.cosgam = Math.cos(gamma0);\n  this.sinrot = Math.sin(gamma);\n  this.cosrot = Math.cos(gamma);\n\n  this.rB = 1 / this.B;\n  this.ArB = this.A * this.rB;\n  this.BrA = 1 / this.ArB;\n\n  if (this.no_off) {\n    this.u_0 = 0;\n  } else {\n    this.u_0 = Math.abs(this.ArB * Math.atan(Math.sqrt(D * D - 1) / Math.cos(alpha_c)));\n\n    if (this.lat0 < 0) {\n      this.u_0 = -this.u_0;\n    }\n  }\n\n  F = 0.5 * gamma0;\n  this.v_pole_n = this.ArB * Math.log(Math.tan(FORTPI - F));\n  this.v_pole_s = this.ArB * Math.log(Math.tan(FORTPI + F));\n}\n\n/* Oblique Mercator forward equations--mapping lat,long to x,y\n    ---------------------------------------------------------- */\nexport function forward(p) {\n  var coords = {};\n  var S, T, U, V, W, temp, u, v;\n  p.x = p.x - this.lam0;\n\n  if (Math.abs(Math.abs(p.y) - HALF_PI) > EPSLN) {\n    W = this.E / Math.pow(tsfnz(this.e, p.y, Math.sin(p.y)), this.B);\n\n    temp = 1 / W;\n    S = 0.5 * (W - temp);\n    T = 0.5 * (W + temp);\n    V = Math.sin(this.B * p.x);\n    U = (S * this.singam - V * this.cosgam) / T;\n\n    if (Math.abs(Math.abs(U) - 1.0) < EPSLN) {\n      throw new Error();\n    }\n\n    v = 0.5 * this.ArB * Math.log((1 - U) / (1 + U));\n    temp = Math.cos(this.B * p.x);\n\n    if (Math.abs(temp) < TOL) {\n      u = this.A * p.x;\n    } else {\n      u = this.ArB * Math.atan2((S * this.cosgam + V * this.singam), temp);\n    }\n  } else {\n    v = p.y > 0 ? this.v_pole_n : this.v_pole_s;\n    u = this.ArB * p.y;\n  }\n\n  if (this.no_rot) {\n    coords.x = u;\n    coords.y = v;\n  } else {\n    u -= this.u_0;\n    coords.x = v * this.cosrot + u * this.sinrot;\n    coords.y = u * this.cosrot - v * this.sinrot;\n  }\n\n  coords.x = (this.a * coords.x + this.x0);\n  coords.y = (this.a * coords.y + this.y0);\n\n  return coords;\n}\n\nexport function inverse(p) {\n  var u, v, Qp, Sp, Tp, Vp, Up;\n  var coords = {};\n\n  p.x = (p.x - this.x0) * (1.0 / this.a);\n  p.y = (p.y - this.y0) * (1.0 / this.a);\n\n  if (this.no_rot) {\n    v = p.y;\n    u = p.x;\n  } else {\n    v = p.x * this.cosrot - p.y * this.sinrot;\n    u = p.y * this.cosrot + p.x * this.sinrot + this.u_0;\n  }\n\n  Qp = Math.exp(-this.BrA * v);\n  Sp = 0.5 * (Qp - 1 / Qp);\n  Tp = 0.5 * (Qp + 1 / Qp);\n  Vp = Math.sin(this.BrA * u);\n  Up = (Vp * this.cosgam + Sp * this.singam) / Tp;\n\n  if (Math.abs(Math.abs(Up) - 1) < EPSLN) {\n    coords.x = 0;\n    coords.y = Up < 0 ? -HALF_PI : HALF_PI;\n  } else {\n    coords.y = this.E / Math.sqrt((1 + Up) / (1 - Up));\n    coords.y = phi2z(this.e, Math.pow(coords.y, 1 / this.B));\n\n    if (coords.y === Infinity) {\n      throw new Error();\n    }\n\n    coords.x = -this.rB * Math.atan2((Sp * this.cosgam - Vp * this.singam), Math.cos(this.BrA * u));\n  }\n\n  coords.x += this.lam0;\n\n  return coords;\n}\n\nexport var names = ['Hotine_Oblique_Mercator', 'Hotine Oblique Mercator', 'Hotine_Oblique_Mercator_variant_A', 'Hotine_Oblique_Mercator_Variant_B', 'Hotine_Oblique_Mercator_Azimuth_Natural_Origin', 'Hotine_Oblique_Mercator_Two_Point_Natural_Origin', 'Hotine_Oblique_Mercator_Azimuth_Center', 'Oblique_Mercator', 'omerc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport sign from '../common/sign';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport { HALF_PI, EPSLN } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} e\n * @property {number} ns\n * @property {number} f0\n * @property {number} rh\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  // double lat0;                    /* the reference latitude               */\n  // double long0;                   /* the reference longitude              */\n  // double lat1;                    /* first standard parallel              */\n  // double lat2;                    /* second standard parallel             */\n  // double r_maj;                   /* major axis                           */\n  // double r_min;                   /* minor axis                           */\n  // double false_east;              /* x offset in meters                   */\n  // double false_north;             /* y offset in meters                   */\n\n  // the above value can be set with proj4.defs\n  // example: proj4.defs(\"EPSG:2154\",\"+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\");\n\n  if (!this.lat2) {\n    this.lat2 = this.lat1;\n  } // if lat2 is not defined\n  if (!this.k0) {\n    this.k0 = 1;\n  }\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n\n  var temp = this.b / this.a;\n  this.e = Math.sqrt(1 - temp * temp);\n\n  var sin1 = Math.sin(this.lat1);\n  var cos1 = Math.cos(this.lat1);\n  var ms1 = msfnz(this.e, sin1, cos1);\n  var ts1 = tsfnz(this.e, this.lat1, sin1);\n\n  var sin2 = Math.sin(this.lat2);\n  var cos2 = Math.cos(this.lat2);\n  var ms2 = msfnz(this.e, sin2, cos2);\n  var ts2 = tsfnz(this.e, this.lat2, sin2);\n\n  var ts0 = Math.abs(Math.abs(this.lat0) - HALF_PI) < EPSLN\n    ? 0 // Handle poles by setting ts0 to 0\n    : tsfnz(this.e, this.lat0, Math.sin(this.lat0));\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);\n  } else {\n    this.ns = sin1;\n  }\n  if (isNaN(this.ns)) {\n    this.ns = sin1;\n  }\n  this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));\n  this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);\n  if (!this.title) {\n    this.title = 'Lambert Conformal Conic';\n  }\n}\n\n// Lambert Conformal conic forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  // singular cases :\n  if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {\n    lat = sign(lat) * (HALF_PI - 2 * EPSLN);\n  }\n\n  var con = Math.abs(Math.abs(lat) - HALF_PI);\n  var ts, rh1;\n  if (con > EPSLN) {\n    ts = tsfnz(this.e, lat, Math.sin(lat));\n    rh1 = this.a * this.f0 * Math.pow(ts, this.ns);\n  } else {\n    con = lat * this.ns;\n    if (con <= 0) {\n      return null;\n    }\n    rh1 = 0;\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;\n  p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;\n\n  return p;\n}\n\n// Lambert Conformal Conic inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n  var rh1, con, ts;\n  var lat, lon;\n  var x = (p.x - this.x0) / this.k0;\n  var y = (this.rh - (p.y - this.y0) / this.k0);\n  if (this.ns > 0) {\n    rh1 = Math.sqrt(x * x + y * y);\n    con = 1;\n  } else {\n    rh1 = -Math.sqrt(x * x + y * y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2((con * x), (con * y));\n  }\n  if ((rh1 !== 0) || (this.ns > 0)) {\n    con = 1 / this.ns;\n    ts = Math.pow((rh1 / (this.a * this.f0)), con);\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  } else {\n    lat = -HALF_PI;\n  }\n  lon = adjust_lon(theta / this.ns + this.long0);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\n  'Lambert Tangential Conformal Conic Projection',\n  'Lambert_Conformal_Conic',\n  'Lambert_Conformal_Conic_1SP',\n  'Lambert_Conformal_Conic_2SP',\n  'lcc',\n  'Lambert Conic Conformal (1SP)',\n  'Lambert Conic Conformal (2SP)'\n];\n\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  this.a = 6377397.155;\n  this.es = 0.006674372230614;\n  this.e = Math.sqrt(this.es);\n  if (!this.lat0) {\n    this.lat0 = 0.863937979737193;\n  }\n  if (!this.long0) {\n    this.long0 = 0.7417649320975901 - 0.308341501185665;\n  }\n  /* if scale not set default to 0.9999 */\n  if (!this.k0) {\n    this.k0 = 0.9999;\n  }\n  this.s45 = 0.785398163397448; /* 45 */\n  this.s90 = 2 * this.s45;\n  this.fi0 = this.lat0;\n  this.e2 = this.es;\n  this.e = Math.sqrt(this.e2);\n  this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));\n  this.uq = 1.04216856380474;\n  this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);\n  this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);\n  this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;\n  this.k1 = this.k0;\n  this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));\n  this.s0 = 1.37008346281555;\n  this.n = Math.sin(this.s0);\n  this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);\n  this.ad = this.s90 - this.uq;\n}\n\n/* ellipsoid */\n/* calculate xy from lat/lon */\n/* Constants, identical to inverse transform function */\nexport function forward(p) {\n  var gfi, u, deltav, s, d, eps, ro;\n  var lon = p.x;\n  var lat = p.y;\n  var delta_lon = adjust_lon(lon - this.long0);\n  /* Transformation */\n  gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));\n  u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);\n  deltav = -delta_lon * this.alfa;\n  s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));\n  d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));\n  eps = this.n * d;\n  ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);\n  p.y = ro * Math.cos(eps) / 1;\n  p.x = ro * Math.sin(eps) / 1;\n\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  return (p);\n}\n\n/* calculate lat/lon from xy */\nexport function inverse(p) {\n  var u, deltav, s, d, eps, ro, fi1;\n  var ok;\n\n  /* Transformation */\n  /* revert y, x */\n  var tmp = p.x;\n  p.x = p.y;\n  p.y = tmp;\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  ro = Math.sqrt(p.x * p.x + p.y * p.y);\n  eps = Math.atan2(p.y, p.x);\n  d = eps / Math.sin(this.s0);\n  s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);\n  u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));\n  deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));\n  p.x = this.long0 - deltav / this.alfa;\n  fi1 = u;\n  ok = 0;\n  var iter = 0;\n  do {\n    p.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);\n    if (Math.abs(fi1 - p.y) < 0.0000000001) {\n      ok = 1;\n    }\n    fi1 = p.y;\n    iter += 1;\n  } while (ok === 0 && iter < 15);\n  if (iter >= 15) {\n    return null;\n  }\n\n  return (p);\n}\n\nexport var names = ['Krovak', 'krovak'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function (e0, e1, e2, e3, phi) {\n  return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));\n}\n","export default function (x) {\n  return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));\n}\n","export default function (x) {\n  return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));\n}\n","export default function (x) {\n  return (0.05859375 * x * x * (1 + 0.75 * x));\n}\n","export default function (x) {\n  return (x * x * x * (35 / 3072));\n}\n","export default function (a, e, sinphi) {\n  var temp = e * sinphi;\n  return a / Math.sqrt(1 - temp * temp);\n}\n","import { HALF_PI } from '../constants/values';\nimport sign from './sign';\n\nexport default function (x) {\n  return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));\n}\n","export default function (ml, e0, e1, e2, e3) {\n  var phi;\n  var dphi;\n\n  phi = ml / e0;\n  for (var i = 0; i < 15; i++) {\n    dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  // ..reportError(\"IMLFN-CONV:Latitude failed to converge after 15 iterations\");\n  return NaN;\n}\n","import mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport gN from '../common/gN';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport { HALF_PI, EPSLN } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} es\n * @property {number} e0\n * @property {number} e1\n * @property {number} e2\n * @property {number} e3\n * @property {number} ml0\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  if (!this.sphere) {\n    this.e0 = e0fn(this.es);\n    this.e1 = e1fn(this.es);\n    this.e2 = e2fn(this.es);\n    this.e3 = e3fn(this.es);\n    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  }\n}\n\n/* Cassini forward equations--mapping lat,long to x,y\n  ----------------------------------------------------------------------- */\nexport function forward(p) {\n  /* Forward equations\n      ----------------- */\n  var x, y;\n  var lam = p.x;\n  var phi = p.y;\n  lam = adjust_lon(lam - this.long0);\n\n  if (this.sphere) {\n    x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));\n    y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);\n  } else {\n    // ellipsoid\n    var sinphi = Math.sin(phi);\n    var cosphi = Math.cos(phi);\n    var nl = gN(this.a, this.e, sinphi);\n    var tl = Math.tan(phi) * Math.tan(phi);\n    var al = lam * Math.cos(phi);\n    var asq = al * al;\n    var cl = this.es * cosphi * cosphi / (1 - this.es);\n    var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n\n    x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));\n    y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);\n  }\n\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  ----------------- */\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var phi, lam;\n\n  if (this.sphere) {\n    var dd = y + this.lat0;\n    phi = Math.asin(Math.sin(dd) * Math.cos(x));\n    lam = Math.atan2(Math.tan(x), Math.cos(dd));\n  } else {\n    /* ellipsoid */\n    var ml1 = this.ml0 / this.a + y;\n    var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);\n    if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {\n      p.x = this.long0;\n      p.y = HALF_PI;\n      if (y < 0) {\n        p.y *= -1;\n      }\n      return p;\n    }\n    var nl1 = gN(this.a, this.e, Math.sin(phi1));\n\n    var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);\n    var tl1 = Math.pow(Math.tan(phi1), 2);\n    var dl = x * this.a / nl1;\n    var dsq = dl * dl;\n    phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);\n    lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);\n  }\n\n  p.x = adjust_lon(lam + this.long0);\n  p.y = adjust_lat(phi);\n  return p;\n}\n\nexport var names = ['Cassini', 'Cassini_Soldner', 'cass'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function (eccent, sinphi) {\n  var con;\n  if (eccent > 1.0e-7) {\n    con = eccent * sinphi;\n    return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));\n  } else {\n    return (2 * sinphi);\n  }\n}\n","import { HALF_PI, EPSLN, FORTPI } from '../constants/values';\n\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} mode\n * @property {Array<number>} apa\n * @property {number} dd\n * @property {number} e\n * @property {number} es\n * @property {number} mmf\n * @property {number} rq\n * @property {number} qp\n * @property {number} sinb1\n * @property {number} cosb1\n * @property {number} ymf\n * @property {number} xmf\n * @property {number} sinph0\n * @property {number} cosph0\n */\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\nexport var S_POLE = 1;\nexport var N_POLE = 2;\nexport var EQUIT = 3;\nexport var OBLIQ = 4;\n\n/**\n * Initialize the Lambert Azimuthal Equal Area projection\n * @this {import('../defs.js').ProjectionDefinition & LocalThis}\n */\nexport function init() {\n  var t = Math.abs(this.lat0);\n  if (Math.abs(t - HALF_PI) < EPSLN) {\n    this.mode = this.lat0 < 0 ? S_POLE : N_POLE;\n  } else if (Math.abs(t) < EPSLN) {\n    this.mode = EQUIT;\n  } else {\n    this.mode = OBLIQ;\n  }\n  if (this.es > 0) {\n    var sinphi;\n\n    this.qp = qsfnz(this.e, 1);\n    this.mmf = 0.5 / (1 - this.es);\n    this.apa = authset(this.es);\n    switch (this.mode) {\n      case N_POLE:\n        this.dd = 1;\n        break;\n      case S_POLE:\n        this.dd = 1;\n        break;\n      case EQUIT:\n        this.rq = Math.sqrt(0.5 * this.qp);\n        this.dd = 1 / this.rq;\n        this.xmf = 1;\n        this.ymf = 0.5 * this.qp;\n        break;\n      case OBLIQ:\n        this.rq = Math.sqrt(0.5 * this.qp);\n        sinphi = Math.sin(this.lat0);\n        this.sinb1 = qsfnz(this.e, sinphi) / this.qp;\n        this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);\n        this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);\n        this.ymf = (this.xmf = this.rq) / this.dd;\n        this.xmf *= this.dd;\n        break;\n    }\n  } else {\n    if (this.mode === OBLIQ) {\n      this.sinph0 = Math.sin(this.lat0);\n      this.cosph0 = Math.cos(this.lat0);\n    }\n  }\n}\n\n/* Lambert Azimuthal Equal Area forward equations--mapping lat,long to x,y\n  ----------------------------------------------------------------------- */\nexport function forward(p) {\n  /* Forward equations\n      ----------------- */\n  var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;\n  var lam = p.x;\n  var phi = p.y;\n\n  lam = adjust_lon(lam - this.long0);\n  if (this.sphere) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    coslam = Math.cos(lam);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;\n      if (y <= EPSLN) {\n        return null;\n      }\n      y = Math.sqrt(2 / y);\n      x = y * cosphi * Math.sin(lam);\n      y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;\n    } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        coslam = -coslam;\n      }\n      if (Math.abs(phi + this.lat0) < EPSLN) {\n        return null;\n      }\n      y = FORTPI - phi * 0.5;\n      y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));\n      x = y * Math.sin(lam);\n      y *= coslam;\n    }\n  } else {\n    sinb = 0;\n    cosb = 0;\n    b = 0;\n    coslam = Math.cos(lam);\n    sinlam = Math.sin(lam);\n    sinphi = Math.sin(phi);\n    q = qsfnz(this.e, sinphi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinb = q / this.qp;\n      cosb = Math.sqrt(1 - sinb * sinb);\n    }\n    switch (this.mode) {\n      case this.OBLIQ:\n        b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;\n        break;\n      case this.EQUIT:\n        b = 1 + cosb * coslam;\n        break;\n      case this.N_POLE:\n        b = HALF_PI + phi;\n        q = this.qp - q;\n        break;\n      case this.S_POLE:\n        b = phi - HALF_PI;\n        q = this.qp + q;\n        break;\n    }\n    if (Math.abs(b) < EPSLN) {\n      return null;\n    }\n    switch (this.mode) {\n      case this.OBLIQ:\n      case this.EQUIT:\n        b = Math.sqrt(2 / b);\n        if (this.mode === this.OBLIQ) {\n          y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);\n        } else {\n          y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;\n        }\n        x = this.xmf * b * cosb * sinlam;\n        break;\n      case this.N_POLE:\n      case this.S_POLE:\n        if (q >= 0) {\n          x = (b = Math.sqrt(q)) * sinlam;\n          y = coslam * ((this.mode === this.S_POLE) ? b : -b);\n        } else {\n          x = y = 0;\n        }\n        break;\n    }\n  }\n\n  p.x = this.a * x + this.x0;\n  p.y = this.a * y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  ----------------- */\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var lam, phi, cCe, sCe, q, rho, ab;\n  if (this.sphere) {\n    var cosz = 0,\n      rh, sinz = 0;\n\n    rh = Math.sqrt(x * x + y * y);\n    phi = rh * 0.5;\n    if (phi > 1) {\n      return null;\n    }\n    phi = 2 * Math.asin(phi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinz = Math.sin(phi);\n      cosz = Math.cos(phi);\n    }\n    switch (this.mode) {\n      case this.EQUIT:\n        phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);\n        x *= sinz;\n        y = cosz * rh;\n        break;\n      case this.OBLIQ:\n        phi = (Math.abs(rh) <= EPSLN) ? this.lat0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);\n        x *= sinz * this.cosph0;\n        y = (cosz - Math.sin(phi) * this.sinph0) * rh;\n        break;\n      case this.N_POLE:\n        y = -y;\n        phi = HALF_PI - phi;\n        break;\n      case this.S_POLE:\n        phi -= HALF_PI;\n        break;\n    }\n    lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);\n  } else {\n    ab = 0;\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      x /= this.dd;\n      y *= this.dd;\n      rho = Math.sqrt(x * x + y * y);\n      if (rho < EPSLN) {\n        p.x = this.long0;\n        p.y = this.lat0;\n        return p;\n      }\n      sCe = 2 * Math.asin(0.5 * rho / this.rq);\n      cCe = Math.cos(sCe);\n      x *= (sCe = Math.sin(sCe));\n      if (this.mode === this.OBLIQ) {\n        ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;\n        q = this.qp * ab;\n        y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;\n      } else {\n        ab = y * sCe / rho;\n        q = this.qp * ab;\n        y = rho * cCe;\n      }\n    } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        y = -y;\n      }\n      q = (x * x + y * y);\n      if (!q) {\n        p.x = this.long0;\n        p.y = this.lat0;\n        return p;\n      }\n      ab = 1 - q / this.qp;\n      if (this.mode === this.S_POLE) {\n        ab = -ab;\n      }\n    }\n    lam = Math.atan2(x, y);\n    phi = authlat(Math.asin(ab), this.apa);\n  }\n\n  p.x = adjust_lon(this.long0 + lam);\n  p.y = phi;\n  return p;\n}\n\n/* determine latitude from authalic latitude */\nvar P00 = 0.33333333333333333333;\n\nvar P01 = 0.17222222222222222222;\nvar P02 = 0.10257936507936507936;\nvar P10 = 0.06388888888888888888;\nvar P11 = 0.06640211640211640211;\nvar P20 = 0.01641501294219154443;\n\nfunction authset(es) {\n  var t;\n  var APA = [];\n  APA[0] = es * P00;\n  t = es * es;\n  APA[0] += t * P01;\n  APA[1] = t * P10;\n  t *= es;\n  APA[0] += t * P02;\n  APA[1] += t * P11;\n  APA[2] = t * P20;\n  return APA;\n}\n\nfunction authlat(beta, APA) {\n  var t = beta + beta;\n  return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));\n}\n\nexport var names = ['Lambert Azimuthal Equal Area', 'Lambert_Azimuthal_Equal_Area', 'laea'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  S_POLE: S_POLE,\n  N_POLE: N_POLE,\n  EQUIT: EQUIT,\n  OBLIQ: OBLIQ\n};\n","export default function (x) {\n  if (Math.abs(x) > 1) {\n    x = (x > 1) ? 1 : -1;\n  }\n  return Math.asin(x);\n}\n","import msfnz from '../common/msfnz';\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport { EPSLN } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} temp\n * @property {number} es\n * @property {number} e3\n * @property {number} sin_po\n * @property {number} cos_po\n * @property {number} t1\n * @property {number} con\n * @property {number} ms1\n * @property {number} qs1\n * @property {number} t2\n * @property {number} ms2\n * @property {number} qs2\n * @property {number} t3\n * @property {number} qs0\n * @property {number} ns0\n * @property {number} c\n * @property {number} rh\n * @property {number} sin_phi\n * @property {number} cos_phi\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e3 = Math.sqrt(this.es);\n\n  this.sin_po = Math.sin(this.lat1);\n  this.cos_po = Math.cos(this.lat1);\n  this.t1 = this.sin_po;\n  this.con = this.sin_po;\n  this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs1 = qsfnz(this.e3, this.sin_po);\n\n  this.sin_po = Math.sin(this.lat2);\n  this.cos_po = Math.cos(this.lat2);\n  this.t2 = this.sin_po;\n  this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs2 = qsfnz(this.e3, this.sin_po);\n\n  this.sin_po = Math.sin(this.lat0);\n  this.cos_po = Math.cos(this.lat0);\n  this.t3 = this.sin_po;\n  this.qs0 = qsfnz(this.e3, this.sin_po);\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);\n  } else {\n    this.ns0 = this.con;\n  }\n  this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;\n  this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;\n}\n\n/* Albers Conical Equal Area forward equations--mapping lat,long to x,y\n  ------------------------------------------------------------------- */\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  this.sin_phi = Math.sin(lat);\n  this.cos_phi = Math.cos(lat);\n\n  var qs = qsfnz(this.e3, this.sin_phi);\n  var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;\n  var theta = this.ns0 * adjust_lon(lon - this.long0);\n  var x = rh1 * Math.sin(theta) + this.x0;\n  var y = this.rh - rh1 * Math.cos(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh1, qs, con, theta, lon, lat;\n\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  if (this.ns0 >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  } else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n  con = rh1 * this.ns0 / this.a;\n  if (this.sphere) {\n    lat = Math.asin((this.c - con * con) / (2 * this.ns0));\n  } else {\n    qs = (this.c - con * con) / this.ns0;\n    lat = this.phi1z(this.e3, qs);\n  }\n\n  lon = adjust_lon(theta / this.ns0 + this.long0);\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\n/* Function to compute phi1, the latitude for the inverse of the\n   Albers Conical Equal-Area projection.\n------------------------------------------- */\nexport function phi1z(eccent, qs) {\n  var sinphi, cosphi, con, com, dphi;\n  var phi = asinz(0.5 * qs);\n  if (eccent < EPSLN) {\n    return phi;\n  }\n\n  var eccnts = eccent * eccent;\n  for (var i = 1; i <= 25; i++) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    con = eccent * sinphi;\n    com = 1 - con * con;\n    dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi = phi + dphi;\n    if (Math.abs(dphi) <= 1e-7) {\n      return phi;\n    }\n  }\n  return null;\n}\n\nexport var names = ['Albers_Conic_Equal_Area', 'Albers_Equal_Area', 'Albers', 'aea'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  phi1z: phi1z\n};\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport { EPSLN } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} sin_p14\n * @property {number} cos_p14\n * @property {number} infinity_dist\n * @property {number} rc\n */\n\n/**\n  reference:\n    Wolfram Mathworld \"Gnomonic Projection\"\n    http://mathworld.wolfram.com/GnomonicProjection.html\n    Accessed: 12th November 2009\n   @this {import('../defs.js').ProjectionDefinition & LocalThis}\n */\nexport function init() {\n  /* Place parameters in static storage for common use\n      ------------------------------------------------- */\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n  // Approximation for projecting points to the horizon (infinity)\n  this.infinity_dist = 1000 * this.a;\n  this.rc = 1;\n}\n\n/* Gnomonic forward equations--mapping lat,long to x,y\n    --------------------------------------------------- */\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g;\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      ----------------- */\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;\n  } else {\n    // Point is in the opposing hemisphere and is unprojectable\n    // We still need to return a reasonable point, so we project\n    // to infinity, on a bearing\n    // equivalent to the northern hemisphere equivalent\n    // This is a reasonable approximation for short shapes and lines that\n    // straddle the horizon.\n\n    x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);\n    y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* Rho */\n  var sinc, cosc;\n  var c;\n  var lon, lat;\n\n  /* Inverse equations\n      ----------------- */\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n\n  if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {\n    c = Math.atan2(rh, this.rc);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n\n    lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh);\n    lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);\n    lon = adjust_lon(this.long0 + lon);\n  } else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['gnom'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport qsfnz from '../common/qsfnz';\nimport msfnz from '../common/msfnz';\nimport iqsfnz from '../common/iqsfnz';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} e\n */\n\n/**\n  reference:\n    \"Cartographic Projection Procedures for the UNIX Environment-\n    A User's Manual\" by Gerald I. Evenden,\n    USGS Open File Report 90-284and Release 4 Interim Reports (2003)\n  @this {import('../defs.js').ProjectionDefinition & LocalThis}\n*/\nexport function init() {\n  // no-op\n  if (!this.sphere) {\n    this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n  }\n}\n\n/* Cylindrical Equal Area forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------ */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y;\n  /* Forward equations\n      ----------------- */\n  var dlon = adjust_lon(lon - this.long0);\n  if (this.sphere) {\n    x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);\n    y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);\n  } else {\n    var qs = qsfnz(this.e, Math.sin(lat));\n    x = this.x0 + this.a * this.k0 * dlon;\n    y = this.y0 + this.a * qs * 0.5 / this.k0;\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Cylindrical Equal Area inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------ */\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts));\n    lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));\n  } else {\n    lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);\n    lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['cea'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import { HALF_PI } from '../constants/values';\n\nexport default function (eccent, q) {\n  var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));\n  if (Math.abs(Math.abs(q) - temp) < 1.0E-6) {\n    if (q < 0) {\n      return (-1 * HALF_PI);\n    } else {\n      return HALF_PI;\n    }\n  }\n  // var phi = 0.5* q/(1-eccent*eccent);\n  var phi = Math.asin(0.5 * q);\n  var dphi;\n  var sin_phi;\n  var cos_phi;\n  var con;\n  for (var i = 0; i < 30; i++) {\n    sin_phi = Math.sin(phi);\n    cos_phi = Math.cos(phi);\n    con = eccent * sin_phi;\n    dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  // console.log(\"IQSFN-CONV:Latitude failed to converge after 30 iterations\");\n  return NaN;\n}\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\n\nexport function init() {\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || 'Equidistant Cylindrical (Plate Carre)';\n\n  this.rc = Math.cos(this.lat_ts);\n}\n\n// forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  var dlon = adjust_lon(lon - this.long0);\n  var dlat = adjust_lat(lat - this.lat0);\n  p.x = this.x0 + (this.a * dlon * this.rc);\n  p.y = this.y0 + (this.a * dlat);\n  return p;\n}\n\n// inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n  var x = p.x;\n  var y = p.y;\n\n  p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));\n  p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a)));\n  return p;\n}\n\nexport var names = ['Equirectangular', 'Equidistant_Cylindrical', 'Equidistant_Cylindrical_Spherical', 'eqc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport mlfn from '../common/mlfn';\nimport { EPSLN } from '../constants/values';\n\nimport gN from '../common/gN';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} temp\n * @property {number} es\n * @property {number} e\n * @property {number} e0\n * @property {number} e1\n * @property {number} e2\n * @property {number} e3\n * @property {number} ml0\n */\n\nvar MAX_ITER = 20;\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  /* Place parameters in static storage for common use\n      ------------------------------------------------- */\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2); // devait etre dans tmerc.js mais n y est pas donc je commente sinon retour de valeurs nulles\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n  this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0); // si que des zeros le calcul ne se fait pas\n}\n\n/* Polyconic forward equations--mapping lat,long to x,y\n    --------------------------------------------------- */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y, el;\n  var dlon = adjust_lon(lon - this.long0);\n  el = dlon * Math.sin(lat);\n  if (this.sphere) {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.a * this.lat0;\n    } else {\n      x = this.a * Math.sin(el) / Math.tan(lat);\n      y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));\n    }\n  } else {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.ml0;\n    } else {\n      var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);\n      x = nl * Math.sin(el);\n      y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));\n    }\n  }\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  ----------------- */\nexport function inverse(p) {\n  var lon, lat, x, y, i;\n  var al, bl;\n  var phi, dphi;\n  x = p.x - this.x0;\n  y = p.y - this.y0;\n\n  if (this.sphere) {\n    if (Math.abs(y + this.a * this.lat0) <= EPSLN) {\n      lon = adjust_lon(x / this.a + this.long0);\n      lat = 0;\n    } else {\n      al = this.lat0 + y / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var tanphi;\n      for (i = MAX_ITER; i; --i) {\n        tanphi = Math.tan(phi);\n        dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);\n        phi += dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n      lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));\n    }\n  } else {\n    if (Math.abs(y + this.ml0) <= EPSLN) {\n      lat = 0;\n      lon = adjust_lon(this.long0 + x / this.a);\n    } else {\n      al = (this.ml0 + y) / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var cl, mln, mlnp, ma;\n      var con;\n      for (i = MAX_ITER; i; --i) {\n        con = this.e * Math.sin(phi);\n        cl = Math.sqrt(1 - con * con) * Math.tan(phi);\n        mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n        mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);\n        ma = mln / this.a;\n        dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);\n        phi -= dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n\n      // lat=phi4z(this.e,this.e0,this.e1,this.e2,this.e3,al,bl,0,0);\n      cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);\n      lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Polyconic', 'American_Polyconic', 'poly'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import { SEC_TO_RAD } from '../constants/values';\n\n/*\n  reference\n    Department of Land and Survey Technical Circular 1973/32\n      http://www.linz.govt.nz/docs/miscellaneous/nz-map-definition.pdf\n    OSG Technical Report 4.1\n      http://www.linz.govt.nz/docs/miscellaneous/nzmg.pdf\n  */\n\n/**\n * iterations: Number of iterations to refine inverse transform.\n *     0 -> km accuracy\n *     1 -> m accuracy -- suitable for most mapping applications\n *     2 -> mm accuracy\n */\nexport var iterations = 1;\n\nexport function init() {\n  this.A = [];\n  this.A[1] = 0.6399175073;\n  this.A[2] = -0.1358797613;\n  this.A[3] = 0.063294409;\n  this.A[4] = -0.02526853;\n  this.A[5] = 0.0117879;\n  this.A[6] = -0.0055161;\n  this.A[7] = 0.0026906;\n  this.A[8] = -0.001333;\n  this.A[9] = 0.00067;\n  this.A[10] = -0.00034;\n\n  this.B_re = [];\n  this.B_im = [];\n  this.B_re[1] = 0.7557853228;\n  this.B_im[1] = 0;\n  this.B_re[2] = 0.249204646;\n  this.B_im[2] = 0.003371507;\n  this.B_re[3] = -0.001541739;\n  this.B_im[3] = 0.041058560;\n  this.B_re[4] = -0.10162907;\n  this.B_im[4] = 0.01727609;\n  this.B_re[5] = -0.26623489;\n  this.B_im[5] = -0.36249218;\n  this.B_re[6] = -0.6870983;\n  this.B_im[6] = -1.1651967;\n\n  this.C_re = [];\n  this.C_im = [];\n  this.C_re[1] = 1.3231270439;\n  this.C_im[1] = 0;\n  this.C_re[2] = -0.577245789;\n  this.C_im[2] = -0.007809598;\n  this.C_re[3] = 0.508307513;\n  this.C_im[3] = -0.112208952;\n  this.C_re[4] = -0.15094762;\n  this.C_im[4] = 0.18200602;\n  this.C_re[5] = 1.01418179;\n  this.C_im[5] = 1.64497696;\n  this.C_re[6] = 1.9660549;\n  this.C_im[6] = 2.5127645;\n\n  this.D = [];\n  this.D[1] = 1.5627014243;\n  this.D[2] = 0.5185406398;\n  this.D[3] = -0.03333098;\n  this.D[4] = -0.1052906;\n  this.D[5] = -0.0368594;\n  this.D[6] = 0.007317;\n  this.D[7] = 0.01220;\n  this.D[8] = 0.00394;\n  this.D[9] = -0.0013;\n}\n\n/**\n    New Zealand Map Grid Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var n;\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lat = lat - this.lat0;\n  var delta_lon = lon - this.long0;\n\n  // 1. Calculate d_phi and d_psi    ...                          // and d_lambda\n  // For this algorithm, delta_latitude is in seconds of arc x 10-5, so we need to scale to those units. Longitude is radians.\n  var d_phi = delta_lat / SEC_TO_RAD * 1E-5;\n  var d_lambda = delta_lon;\n  var d_phi_n = 1; // d_phi^0\n\n  var d_psi = 0;\n  for (n = 1; n <= 10; n++) {\n    d_phi_n = d_phi_n * d_phi;\n    d_psi = d_psi + this.A[n] * d_phi_n;\n  }\n\n  // 2. Calculate theta\n  var th_re = d_psi;\n  var th_im = d_lambda;\n\n  // 3. Calculate z\n  var th_n_re = 1;\n  var th_n_im = 0; // theta^0\n  var th_n_re1;\n  var th_n_im1;\n\n  var z_re = 0;\n  var z_im = 0;\n  for (n = 1; n <= 6; n++) {\n    th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n    th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n    th_n_re = th_n_re1;\n    th_n_im = th_n_im1;\n    z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;\n    z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;\n  }\n\n  // 4. Calculate easting and northing\n  p.x = (z_im * this.a) + this.x0;\n  p.y = (z_re * this.a) + this.y0;\n\n  return p;\n}\n\n/**\n    New Zealand Map Grid Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var n;\n  var x = p.x;\n  var y = p.y;\n\n  var delta_x = x - this.x0;\n  var delta_y = y - this.y0;\n\n  // 1. Calculate z\n  var z_re = delta_y / this.a;\n  var z_im = delta_x / this.a;\n\n  // 2a. Calculate theta - first approximation gives km accuracy\n  var z_n_re = 1;\n  var z_n_im = 0; // z^0\n  var z_n_re1;\n  var z_n_im1;\n\n  var th_re = 0;\n  var th_im = 0;\n  for (n = 1; n <= 6; n++) {\n    z_n_re1 = z_n_re * z_re - z_n_im * z_im;\n    z_n_im1 = z_n_im * z_re + z_n_re * z_im;\n    z_n_re = z_n_re1;\n    z_n_im = z_n_im1;\n    th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;\n    th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;\n  }\n\n  // 2b. Iterate to refine the accuracy of the calculation\n  //        0 iterations gives km accuracy\n  //        1 iteration gives m accuracy -- good enough for most mapping applications\n  //        2 iterations bives mm accuracy\n  for (var i = 0; i < this.iterations; i++) {\n    var th_n_re = th_re;\n    var th_n_im = th_im;\n    var th_n_re1;\n    var th_n_im1;\n\n    var num_re = z_re;\n    var num_im = z_im;\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    th_n_re = 1;\n    th_n_im = 0;\n    var den_re = this.B_re[1];\n    var den_im = this.B_im[1];\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    // Complex division\n    var den2 = den_re * den_re + den_im * den_im;\n    th_re = (num_re * den_re + num_im * den_im) / den2;\n    th_im = (num_im * den_re - num_re * den_im) / den2;\n  }\n\n  // 3. Calculate d_phi              ...                                    // and d_lambda\n  var d_psi = th_re;\n  var d_lambda = th_im;\n  var d_psi_n = 1; // d_psi^0\n\n  var d_phi = 0;\n  for (n = 1; n <= 9; n++) {\n    d_psi_n = d_psi_n * d_psi;\n    d_phi = d_phi + this.D[n] * d_psi_n;\n  }\n\n  // 4. Calculate latitude and longitude\n  // d_phi is calcuated in second of arc * 10^-5, so we need to scale back to radians. d_lambda is in radians.\n  var lat = this.lat0 + (d_phi * SEC_TO_RAD * 1E5);\n  var lon = this.long0 + d_lambda;\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = ['New_Zealand_Map_Grid', 'nzmg'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\n/* Initialize the Miller Cylindrical projection\n  ------------------------------------------- */\nexport function init() {\n  // no-op\n}\n\n/* Miller Cylindrical forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------ */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      ----------------- */\n  var dlon = adjust_lon(lon - this.long0);\n  var x = this.x0 + this.a * dlon;\n  var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Miller Cylindrical inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------ */\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n\n  var lon = adjust_lon(this.long0 + p.x / this.a);\n  var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Miller_Cylindrical', 'mill'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport pj_enfn from '../common/pj_enfn';\nvar MAX_ITER = 20;\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport { EPSLN, HALF_PI } from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n/**\n * @typedef {Object} LocalThis\n * @property {Array<number>} en\n * @property {number} n\n * @property {number} m\n * @property {number} C_y\n * @property {number} C_x\n * @property {number} es\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  /* Place parameters in static storage for common use\n    ------------------------------------------------- */\n\n  if (!this.sphere) {\n    this.en = pj_enfn(this.es);\n  } else {\n    this.n = 1;\n    this.m = 0;\n    this.es = 0;\n    this.C_y = Math.sqrt((this.m + 1) / this.n);\n    this.C_x = this.C_y / (this.m + 1);\n  }\n}\n\n/* Sinusoidal forward equations--mapping lat,long to x,y\n  ----------------------------------------------------- */\nexport function forward(p) {\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    ----------------- */\n  lon = adjust_lon(lon - this.long0);\n\n  if (this.sphere) {\n    if (!this.m) {\n      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n    } else {\n      var k = this.n * Math.sin(lat);\n      for (var i = MAX_ITER; i; --i) {\n        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n        lat -= V;\n        if (Math.abs(V) < EPSLN) {\n          break;\n        }\n      }\n    }\n    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n    y = this.a * this.C_y * lat;\n  } else {\n    var s = Math.sin(lat);\n    var c = Math.cos(lat);\n    y = this.a * pj_mlfn(lat, s, c, this.en);\n    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var lat, temp, lon, s;\n\n  p.x -= this.x0;\n  lon = p.x / this.a;\n  p.y -= this.y0;\n  lat = p.y / this.a;\n\n  if (this.sphere) {\n    lat /= this.C_y;\n    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n    if (this.m) {\n      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n    } else if (this.n !== 1) {\n      lat = asinz(Math.sin(lat) / this.n);\n    }\n    lon = adjust_lon(lon + this.long0);\n    lat = adjust_lat(lat);\n  } else {\n    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n    s = Math.abs(lat);\n    if (s < HALF_PI) {\n      s = Math.sin(lat);\n      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));\n      // temp = this.long0 + p.x / (this.a * Math.cos(lat));\n      lon = adjust_lon(temp);\n    } else if ((s - EPSLN) < HALF_PI) {\n      lon = this.long0;\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Sinusoidal', 'sinu'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nexport function init() {}\nimport { EPSLN } from '../constants/values';\n/* Mollweide forward equations--mapping lat,long to x,y\n    ---------------------------------------------------- */\nexport function forward(p) {\n  /* Forward equations\n      ----------------- */\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var theta = lat;\n  var con = Math.PI * Math.sin(lat);\n\n  /* Iterate using the Newton-Raphson method to find theta\n      ----------------------------------------------------- */\n  while (true) {\n    var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));\n    theta += delta_theta;\n    if (Math.abs(delta_theta) < EPSLN) {\n      break;\n    }\n  }\n  theta /= 2;\n\n  /* If the latitude is 90 deg, force the x coordinate to be \"0 + false easting\"\n       this is done here because of precision problems with \"cos(theta)\"\n       -------------------------------------------------------------------------- */\n  if (Math.PI / 2 - Math.abs(lat) < EPSLN) {\n    delta_lon = 0;\n  }\n  var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;\n  var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var theta;\n  var arg;\n\n  /* Inverse equations\n      ----------------- */\n  p.x -= this.x0;\n  p.y -= this.y0;\n  arg = p.y / (1.4142135623731 * this.a);\n\n  /* Because of division by zero problems, 'arg' can not be 1.  Therefore\n       a number very close to one is used instead.\n       ------------------------------------------------------------------- */\n  if (Math.abs(arg) > 0.999999999999) {\n    arg = 0.999999999999;\n  }\n  theta = Math.asin(arg);\n  var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));\n  if (lon < (-Math.PI)) {\n    lon = -Math.PI;\n  }\n  if (lon > Math.PI) {\n    lon = Math.PI;\n  }\n  arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;\n  if (Math.abs(arg) > 1) {\n    arg = 1;\n  }\n  var lat = Math.asin(arg);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Mollweide', 'moll'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport msfnz from '../common/msfnz';\nimport mlfn from '../common/mlfn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport { EPSLN } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} temp\n * @property {number} es\n * @property {number} e\n * @property {number} e0\n * @property {number} e1\n * @property {number} e2\n * @property {number} e3\n * @property {number} sin_phi\n * @property {number} cos_phi\n * @property {number} ms1\n * @property {number} ml1\n * @property {number} ms2\n * @property {number} ml2\n * @property {number} ns\n * @property {number} g\n * @property {number} ml0\n * @property {number} rh\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  /* Place parameters in static storage for common use\n      ------------------------------------------------- */\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.lat2 = this.lat2 || this.lat1;\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n\n  this.sin_phi = Math.sin(this.lat1);\n  this.cos_phi = Math.cos(this.lat1);\n\n  this.ms1 = msfnz(this.e, this.sin_phi, this.cos_phi);\n  this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);\n\n  if (Math.abs(this.lat1 - this.lat2) < EPSLN) {\n    this.ns = this.sin_phi;\n  } else {\n    this.sin_phi = Math.sin(this.lat2);\n    this.cos_phi = Math.cos(this.lat2);\n    this.ms2 = msfnz(this.e, this.sin_phi, this.cos_phi);\n    this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);\n    this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);\n  }\n  this.g = this.ml1 + this.ms1 / this.ns;\n  this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  this.rh = this.a * (this.g - this.ml0);\n}\n\n/* Equidistant Conic forward equations--mapping lat,long to x,y\n  ----------------------------------------------------------- */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var rh1;\n\n  /* Forward equations\n      ----------------- */\n  if (this.sphere) {\n    rh1 = this.a * (this.g - lat);\n  } else {\n    var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);\n    rh1 = this.a * (this.g - ml);\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  var x = this.x0 + rh1 * Math.sin(theta);\n  var y = this.y0 + this.rh - rh1 * Math.cos(theta);\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Inverse equations\n  ----------------- */\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  var con, rh1, lat, lon;\n  if (this.ns >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  } else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    lat = adjust_lat(this.g - rh1 / this.a);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  } else {\n    var ml = this.g - rh1 / this.a;\n    lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n}\n\nexport var names = ['Equidistant_Conic', 'eqdc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nimport { HALF_PI, EPSLN } from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} R - Radius of the Earth\n */\n\n/**\n * Initialize the Van Der Grinten projection\n * @this {import('../defs.js').ProjectionDefinition & LocalThis}\n */\nexport function init() {\n  // this.R = 6370997; //Radius of earth\n  this.R = this.a;\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  /* Forward equations\n    ----------------- */\n  var dlon = adjust_lon(lon - this.long0);\n  var x, y;\n\n  if (Math.abs(lat) <= EPSLN) {\n    x = this.x0 + this.R * dlon;\n    y = this.y0;\n  }\n  var theta = asinz(2 * Math.abs(lat / Math.PI));\n  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {\n    x = this.x0;\n    if (lat >= 0) {\n      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n    } else {\n      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n    }\n    //  return(OK);\n  }\n  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));\n  var asq = al * al;\n  var sinth = Math.sin(theta);\n  var costh = Math.cos(theta);\n\n  var g = costh / (sinth + costh - 1);\n  var gsq = g * g;\n  var m = g * (2 / sinth - 1);\n  var msq = m * m;\n  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n  if (dlon < 0) {\n    con = -con;\n  }\n  x = this.x0 + con;\n  // con = Math.abs(con / (Math.PI * this.R));\n  var q = asq + g;\n  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n  if (lat >= 0) {\n    // y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 + con;\n  } else {\n    // y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 - con;\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Van Der Grinten inverse equations--mapping x,y to lat/long\n  --------------------------------------------------------- */\nexport function inverse(p) {\n  var lon, lat;\n  var xx, yy, xys, c1, c2, c3;\n  var a1;\n  var m1;\n  var con;\n  var th1;\n  var d;\n\n  /* inverse equations\n    ----------------- */\n  p.x -= this.x0;\n  p.y -= this.y0;\n  con = Math.PI * this.R;\n  xx = p.x / con;\n  yy = p.y / con;\n  xys = xx * xx + yy * yy;\n  c1 = -Math.abs(yy) * (1 + xys);\n  c2 = c1 - 2 * yy * yy + xx * xx;\n  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n  m1 = 2 * Math.sqrt(-a1 / 3);\n  con = ((3 * d) / a1) / m1;\n  if (Math.abs(con) > 1) {\n    if (con >= 0) {\n      con = 1;\n    } else {\n      con = -1;\n    }\n  }\n  th1 = Math.acos(con) / 3;\n  if (p.y >= 0) {\n    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  } else {\n    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n\n  if (Math.abs(xx) < EPSLN) {\n    lon = this.long0;\n  } else {\n    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['Van_der_Grinten_I', 'VanDerGrinten', 'Van_der_Grinten', 'vandg'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport { HALF_PI, EPSLN } from '../constants/values';\nimport mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport asinz from '../common/asinz';\nimport imlfn from '../common/imlfn';\nimport { vincentyDirect, vincentyInverse } from '../common/vincenty';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} es\n * @property {number} sin_p12\n * @property {number} cos_p12\n * @property {number} a\n * @property {number} f\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  this.sin_p12 = Math.sin(this.lat0);\n  this.cos_p12 = Math.cos(this.lat0);\n  // flattening for ellipsoid\n  this.f = this.es / (1 + Math.sqrt(1 - this.es));\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinphi = Math.sin(p.y);\n  var cosphi = Math.cos(p.y);\n  var dlon = adjust_lon(lon - this.long0);\n  var e0, e1, e2, e3, Mlp, Ml, c, kp, cos_c, vars, azi1;\n  if (this.sphere) {\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      // North Pole case\n      p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);\n      p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);\n      return p;\n    } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      // South Pole case\n      p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);\n      p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);\n      return p;\n    } else {\n      // default case\n      cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);\n      c = Math.acos(cos_c);\n      kp = c ? c / Math.sin(c) : 1;\n      p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);\n      p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));\n      return p;\n    }\n  } else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      // North Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);\n      p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);\n      return p;\n    } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      // South Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);\n      p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);\n      return p;\n    } else {\n      // Default case\n      if (Math.abs(lon) < EPSLN && Math.abs(lat - this.lat0) < EPSLN) {\n        p.x = p.y = 0;\n        return p;\n      }\n      vars = vincentyInverse(this.lat0, this.long0, lat, lon, this.a, this.f);\n      azi1 = vars.azi1;\n      p.x = vars.s12 * Math.sin(azi1);\n      p.y = vars.s12 * Math.cos(azi1);\n      return p;\n    }\n  }\n}\n\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, azi1, s12, vars;\n  if (this.sphere) {\n    rh = Math.sqrt(p.x * p.x + p.y * p.y);\n    if (rh > (2 * HALF_PI * this.a)) {\n      return;\n    }\n    z = rh / this.a;\n\n    sinz = Math.sin(z);\n    cosz = Math.cos(z);\n\n    lon = this.long0;\n    if (Math.abs(rh) <= EPSLN) {\n      lat = this.lat0;\n    } else {\n      lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);\n      con = Math.abs(this.lat0) - HALF_PI;\n      if (Math.abs(con) <= EPSLN) {\n        if (this.lat0 >= 0) {\n          lon = adjust_lon(this.long0 + Math.atan2(p.x, -p.y));\n        } else {\n          lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n        }\n      } else {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));\n      }\n    }\n\n    p.x = lon;\n    p.y = lat;\n    return p;\n  } else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      // North pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = Mlp - rh;\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      // South pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = rh - Mlp;\n\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    } else {\n      // default case\n      azi1 = Math.atan2(p.x, p.y);\n      s12 = Math.sqrt(p.x * p.x + p.y * p.y);\n      vars = vincentyDirect(this.lat0, this.long0, azi1, s12, this.a, this.f);\n\n      p.x = vars.lon2;\n      p.y = vars.lat2;\n      return p;\n    }\n  }\n}\n\nexport var names = ['Azimuthal_Equidistant', 'aeqd'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","/**\n * Calculates the inverse geodesic problem using Vincenty's formulae.\n * Computes the forward azimuth and ellipsoidal distance between two points\n * specified by latitude and longitude on the surface of an ellipsoid.\n *\n * @param {number} lat1 Latitude of the first point in radians.\n * @param {number} lon1 Longitude of the first point in radians.\n * @param {number} lat2 Latitude of the second point in radians.\n * @param {number} lon2 Longitude of the second point in radians.\n * @param {number} a Semi-major axis of the ellipsoid (meters).\n * @param {number} f Flattening of the ellipsoid.\n * @returns {{ azi1: number, s12: number }} An object containing:\n *   - azi1: Forward azimuth from the first point to the second point (radians).\n *   - s12: Ellipsoidal distance between the two points (meters).\n */\nexport function vincentyInverse(lat1, lon1, lat2, lon2, a, f) {\n  const L = lon2 - lon1;\n  const U1 = Math.atan((1 - f) * Math.tan(lat1));\n  const U2 = Math.atan((1 - f) * Math.tan(lat2));\n  const sinU1 = Math.sin(U1), cosU1 = Math.cos(U1);\n  const sinU2 = Math.sin(U2), cosU2 = Math.cos(U2);\n\n  let lambda = L, lambdaP, iterLimit = 100;\n  let sinLambda, cosLambda, sinSigma, cosSigma, sigma, sinAlpha, cos2Alpha, cos2SigmaM, C;\n  let uSq, A, B, deltaSigma, s;\n\n  do {\n    sinLambda = Math.sin(lambda);\n    cosLambda = Math.cos(lambda);\n    sinSigma = Math.sqrt(\n      (cosU2 * sinLambda) * (cosU2 * sinLambda)\n      + (cosU1 * sinU2 - sinU1 * cosU2 * cosLambda)\n      * (cosU1 * sinU2 - sinU1 * cosU2 * cosLambda)\n    );\n    if (sinSigma === 0) {\n      return { azi1: 0, s12: 0 }; // coincident points\n    }\n    cosSigma = sinU1 * sinU2 + cosU1 * cosU2 * cosLambda;\n    sigma = Math.atan2(sinSigma, cosSigma);\n    sinAlpha = cosU1 * cosU2 * sinLambda / sinSigma;\n    cos2Alpha = 1 - sinAlpha * sinAlpha;\n    cos2SigmaM = (cos2Alpha !== 0) ? (cosSigma - 2 * sinU1 * sinU2 / cos2Alpha) : 0;\n    C = f / 16 * cos2Alpha * (4 + f * (4 - 3 * cos2Alpha));\n    lambdaP = lambda;\n    lambda = L + (1 - C) * f * sinAlpha\n    * (sigma + C * sinSigma * (cos2SigmaM + C * cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM)));\n  } while (Math.abs(lambda - lambdaP) > 1e-12 && --iterLimit > 0);\n\n  if (iterLimit === 0) {\n    return { azi1: NaN, s12: NaN }; // formula failed to converge\n  }\n\n  uSq = cos2Alpha * (a * a - (a * (1 - f)) * (a * (1 - f))) / ((a * (1 - f)) * (a * (1 - f)));\n  A = 1 + uSq / 16384 * (4096 + uSq * (-768 + uSq * (320 - 175 * uSq)));\n  B = uSq / 1024 * (256 + uSq * (-128 + uSq * (74 - 47 * uSq)));\n  deltaSigma = B * sinSigma * (cos2SigmaM + B / 4 * (cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM)\n    - B / 6 * cos2SigmaM * (-3 + 4 * sinSigma * sinSigma) * (-3 + 4 * cos2SigmaM * cos2SigmaM)));\n\n  s = (a * (1 - f)) * A * (sigma - deltaSigma);\n\n  // Forward azimuth\n  const azi1 = Math.atan2(cosU2 * sinLambda, cosU1 * sinU2 - sinU1 * cosU2 * cosLambda);\n\n  return { azi1, s12: s };\n}\n\n/**\n * Solves the direct geodetic problem using Vincenty's formulae.\n * Given a starting point, initial azimuth, and distance, computes the destination point on the ellipsoid.\n *\n * @param {number} lat1 Latitude of the starting point in radians.\n * @param {number} lon1 Longitude of the starting point in radians.\n * @param {number} azi1 Initial azimuth (forward azimuth) in radians.\n * @param {number} s12 Distance to travel from the starting point in meters.\n * @param {number} a Semi-major axis of the ellipsoid in meters.\n * @param {number} f Flattening of the ellipsoid.\n * @returns {{lat2: number, lon2: number}} The latitude and longitude (in radians) of the destination point.\n */\nexport function vincentyDirect(lat1, lon1, azi1, s12, a, f) {\n  const U1 = Math.atan((1 - f) * Math.tan(lat1));\n  const sinU1 = Math.sin(U1), cosU1 = Math.cos(U1);\n  const sinAlpha1 = Math.sin(azi1), cosAlpha1 = Math.cos(azi1);\n\n  const sigma1 = Math.atan2(sinU1, cosU1 * cosAlpha1);\n  const sinAlpha = cosU1 * sinAlpha1;\n  const cos2Alpha = 1 - sinAlpha * sinAlpha;\n  const uSq = cos2Alpha * (a * a - (a * (1 - f)) * (a * (1 - f))) / ((a * (1 - f)) * (a * (1 - f)));\n  const A = 1 + uSq / 16384 * (4096 + uSq * (-768 + uSq * (320 - 175 * uSq)));\n  const B = uSq / 1024 * (256 + uSq * (-128 + uSq * (74 - 47 * uSq)));\n\n  let sigma = s12 / ((a * (1 - f)) * A), sigmaP, iterLimit = 100;\n  let cos2SigmaM, sinSigma, cosSigma, deltaSigma;\n\n  do {\n    cos2SigmaM = Math.cos(2 * sigma1 + sigma);\n    sinSigma = Math.sin(sigma);\n    cosSigma = Math.cos(sigma);\n    deltaSigma = B * sinSigma * (cos2SigmaM + B / 4 * (cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM)\n      - B / 6 * cos2SigmaM * (-3 + 4 * sinSigma * sinSigma) * (-3 + 4 * cos2SigmaM * cos2SigmaM)));\n    sigmaP = sigma;\n    sigma = s12 / ((a * (1 - f)) * A) + deltaSigma;\n  } while (Math.abs(sigma - sigmaP) > 1e-12 && --iterLimit > 0);\n\n  if (iterLimit === 0) {\n    return { lat2: NaN, lon2: NaN };\n  }\n\n  const tmp = sinU1 * sinSigma - cosU1 * cosSigma * cosAlpha1;\n  const lat2 = Math.atan2(\n    sinU1 * cosSigma + cosU1 * sinSigma * cosAlpha1,\n    (1 - f) * Math.sqrt(sinAlpha * sinAlpha + tmp * tmp)\n  );\n  const lambda = Math.atan2(\n    sinSigma * sinAlpha1,\n    cosU1 * cosSigma - sinU1 * sinSigma * cosAlpha1\n  );\n  const C = f / 16 * cos2Alpha * (4 + f * (4 - 3 * cos2Alpha));\n  const L = lambda - (1 - C) * f * sinAlpha\n    * (sigma + C * sinSigma * (cos2SigmaM + C * cosSigma * (-1 + 2 * cos2SigmaM * cos2SigmaM)));\n  const lon2 = lon1 + L;\n\n  return { lat2, lon2 };\n}\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport { EPSLN, HALF_PI } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} sin_p14\n * @property {number} cos_p14\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  // double temp;      /* temporary variable    */\n\n  /* Place parameters in static storage for common use\n      ------------------------------------------------- */\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n}\n\n/* Orthographic forward equations--mapping lat,long to x,y\n    --------------------------------------------------- */\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g, x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      ----------------- */\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.a * ksp * cosphi * Math.sin(dlon);\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* height above ellipsoid      */\n  var z; /* angle          */\n  var sinz, cosz; /* sin of z and cos of z      */\n  var con;\n  var lon, lat;\n  /* Inverse equations\n      ----------------- */\n  p.x -= this.x0;\n  p.y -= this.y0;\n  rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  z = asinz(rh / this.a);\n\n  sinz = Math.sin(z);\n  cosz = Math.cos(z);\n\n  lon = this.long0;\n  if (Math.abs(rh) <= EPSLN) {\n    lat = this.lat0;\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lat = asinz(cosz * this.sin_p14 + (p.y * sinz * this.cos_p14) / rh);\n  con = Math.abs(this.lat0) - HALF_PI;\n  if (Math.abs(con) <= EPSLN) {\n    if (this.lat0 >= 0) {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, -p.y));\n    } else {\n      lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz), rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = ['ortho'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","// QSC projection rewritten from the original PROJ4\n// https://github.com/OSGeo/proj.4/blob/master/src/PJ_qsc.c\n\nimport { EPSLN, TWO_PI, SPI, HALF_PI, FORTPI } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} face\n * @property {number} x0\n * @property {number} y0\n * @property {number} es\n * @property {number} one_minus_f\n * @property {number} one_minus_f_squared\n */\n\n/* constants */\nvar FACE_ENUM = {\n  FRONT: 1,\n  RIGHT: 2,\n  BACK: 3,\n  LEFT: 4,\n  TOP: 5,\n  BOTTOM: 6\n};\n\nvar AREA_ENUM = {\n  AREA_0: 1,\n  AREA_1: 2,\n  AREA_2: 3,\n  AREA_3: 4\n};\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || 'Quadrilateralized Spherical Cube';\n\n  /* Determine the cube face from the center of projection. */\n  if (this.lat0 >= HALF_PI - FORTPI / 2.0) {\n    this.face = FACE_ENUM.TOP;\n  } else if (this.lat0 <= -(HALF_PI - FORTPI / 2.0)) {\n    this.face = FACE_ENUM.BOTTOM;\n  } else if (Math.abs(this.long0) <= FORTPI) {\n    this.face = FACE_ENUM.FRONT;\n  } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {\n    this.face = this.long0 > 0.0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;\n  } else {\n    this.face = FACE_ENUM.BACK;\n  }\n\n  /* Fill in useful values for the ellipsoid <-> sphere shift\n   * described in [LK12]. */\n  if (this.es !== 0) {\n    this.one_minus_f = 1 - (this.a - this.b) / this.a;\n    this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;\n  }\n}\n\n// QSC forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n  var xy = { x: 0, y: 0 };\n  var lat, lon;\n  var theta, phi;\n  var t, mu;\n  /* nu; */\n  var area = { value: 0 };\n\n  // move lon according to projection's lon\n  p.x -= this.long0;\n\n  /* Convert the geodetic latitude to a geocentric latitude.\n   * This corresponds to the shift from the ellipsoid to the sphere\n   * described in [LK12]. */\n  if (this.es !== 0) { // if (P->es != 0) {\n    lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));\n  } else {\n    lat = p.y;\n  }\n\n  /* Convert the input lat, lon into theta, phi as used by QSC.\n   * This depends on the cube face and the area on it.\n   * For the top and bottom face, we can compute theta and phi\n   * directly from phi, lam. For the other faces, we must use\n   * unit sphere cartesian coordinates as an intermediate step. */\n  lon = p.x; // lon = lp.lam;\n  if (this.face === FACE_ENUM.TOP) {\n    phi = HALF_PI - lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = lon - HALF_PI;\n    } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = (lon > 0.0 ? lon - SPI : lon + SPI);\n    } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = lon + HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = lon;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = HALF_PI + lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = -lon + HALF_PI;\n    } else if (lon < FORTPI && lon >= -FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = -lon;\n    } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = -lon - HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = (lon > 0.0 ? -lon + SPI : -lon - SPI);\n    }\n  } else {\n    var q, r, s;\n    var sinlat, coslat;\n    var sinlon, coslon;\n\n    if (this.face === FACE_ENUM.RIGHT) {\n      lon = qsc_shift_lon_origin(lon, +HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lon = qsc_shift_lon_origin(lon, +SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lon = qsc_shift_lon_origin(lon, -HALF_PI);\n    }\n    sinlat = Math.sin(lat);\n    coslat = Math.cos(lat);\n    sinlon = Math.sin(lon);\n    coslon = Math.cos(lon);\n    q = coslat * coslon;\n    r = coslat * sinlon;\n    s = sinlat;\n\n    if (this.face === FACE_ENUM.FRONT) {\n      phi = Math.acos(q);\n      theta = qsc_fwd_equat_face_theta(phi, s, r, area);\n    } else if (this.face === FACE_ENUM.RIGHT) {\n      phi = Math.acos(r);\n      theta = qsc_fwd_equat_face_theta(phi, s, -q, area);\n    } else if (this.face === FACE_ENUM.BACK) {\n      phi = Math.acos(-q);\n      theta = qsc_fwd_equat_face_theta(phi, s, -r, area);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      phi = Math.acos(-r);\n      theta = qsc_fwd_equat_face_theta(phi, s, q, area);\n    } else {\n      /* Impossible */\n      phi = theta = 0;\n      area.value = AREA_ENUM.AREA_0;\n    }\n  }\n\n  /* Compute mu and nu for the area of definition.\n   * For mu, see Eq. (3-21) in [OL76], but note the typos:\n   * compare with Eq. (3-14). For nu, see Eq. (3-38). */\n  mu = Math.atan((12 / SPI) * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));\n  t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));\n\n  /* Apply the result to the real area. */\n  if (area.value === AREA_ENUM.AREA_1) {\n    mu += HALF_PI;\n  } else if (area.value === AREA_ENUM.AREA_2) {\n    mu += SPI;\n  } else if (area.value === AREA_ENUM.AREA_3) {\n    mu += 1.5 * SPI;\n  }\n\n  /* Now compute x, y from mu and nu */\n  xy.x = t * Math.cos(mu);\n  xy.y = t * Math.sin(mu);\n  xy.x = xy.x * this.a + this.x0;\n  xy.y = xy.y * this.a + this.y0;\n\n  p.x = xy.x;\n  p.y = xy.y;\n  return p;\n}\n\n// QSC inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n  var lp = { lam: 0, phi: 0 };\n  var mu, nu, cosmu, tannu;\n  var tantheta, theta, cosphi, phi;\n  var t;\n  var area = { value: 0 };\n\n  /* de-offset */\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  /* Convert the input x, y to the mu and nu angles as used by QSC.\n   * This depends on the area of the cube face. */\n  nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));\n  mu = Math.atan2(p.y, p.x);\n  if (p.x >= 0.0 && p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_0;\n  } else if (p.y >= 0.0 && p.y >= Math.abs(p.x)) {\n    area.value = AREA_ENUM.AREA_1;\n    mu -= HALF_PI;\n  } else if (p.x < 0.0 && -p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_2;\n    mu = (mu < 0.0 ? mu + SPI : mu - SPI);\n  } else {\n    area.value = AREA_ENUM.AREA_3;\n    mu += HALF_PI;\n  }\n\n  /* Compute phi and theta for the area of definition.\n   * The inverse projection is not described in the original paper, but some\n   * good hints can be found here (as of 2011-12-14):\n   * http://fits.gsfc.nasa.gov/fitsbits/saf.93/saf.9302\n   * (search for \"Message-Id: <9302181759.AA25477 at fits.cv.nrao.edu>\") */\n  t = (SPI / 12) * Math.tan(mu);\n  tantheta = Math.sin(t) / (Math.cos(t) - (1 / Math.sqrt(2)));\n  theta = Math.atan(tantheta);\n  cosmu = Math.cos(mu);\n  tannu = Math.tan(nu);\n  cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));\n  if (cosphi < -1) {\n    cosphi = -1;\n  } else if (cosphi > +1) {\n    cosphi = +1;\n  }\n\n  /* Apply the result to the real area on the cube face.\n   * For the top and bottom face, we can compute phi and lam directly.\n   * For the other faces, we must use unit sphere cartesian coordinates\n   * as an intermediate step. */\n  if (this.face === FACE_ENUM.TOP) {\n    phi = Math.acos(cosphi);\n    lp.phi = HALF_PI - phi;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = (theta < 0.0 ? theta + SPI : theta - SPI);\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = theta;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = Math.acos(cosphi);\n    lp.phi = phi - HALF_PI;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = -theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = -theta;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = -theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = (theta < 0.0 ? -theta - SPI : -theta + SPI);\n    }\n  } else {\n    /* Compute phi and lam via cartesian unit sphere coordinates. */\n    var q, r, s;\n    q = cosphi;\n    t = q * q;\n    if (t >= 1) {\n      s = 0;\n    } else {\n      s = Math.sqrt(1 - t) * Math.sin(theta);\n    }\n    t += s * s;\n    if (t >= 1) {\n      r = 0;\n    } else {\n      r = Math.sqrt(1 - t);\n    }\n    /* Rotate q,r,s into the correct area. */\n    if (area.value === AREA_ENUM.AREA_1) {\n      t = r;\n      r = -s;\n      s = t;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      r = -r;\n      s = -s;\n    } else if (area.value === AREA_ENUM.AREA_3) {\n      t = r;\n      r = s;\n      s = -t;\n    }\n    /* Rotate q,r,s into the correct cube face. */\n    if (this.face === FACE_ENUM.RIGHT) {\n      t = q;\n      q = -r;\n      r = t;\n    } else if (this.face === FACE_ENUM.BACK) {\n      q = -q;\n      r = -r;\n    } else if (this.face === FACE_ENUM.LEFT) {\n      t = q;\n      q = r;\n      r = -t;\n    }\n    /* Now compute phi and lam from the unit sphere coordinates. */\n    lp.phi = Math.acos(-s) - HALF_PI;\n    lp.lam = Math.atan2(r, q);\n    if (this.face === FACE_ENUM.RIGHT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);\n    }\n  }\n\n  /* Apply the shift from the sphere to the ellipsoid as described\n   * in [LK12]. */\n  if (this.es !== 0) {\n    var invert_sign;\n    var tanphi, xa;\n    invert_sign = (lp.phi < 0 ? 1 : 0);\n    tanphi = Math.tan(lp.phi);\n    xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);\n    lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));\n    if (invert_sign) {\n      lp.phi = -lp.phi;\n    }\n  }\n\n  lp.lam += this.long0;\n  p.x = lp.lam;\n  p.y = lp.phi;\n  return p;\n}\n\n/* Helper function for forward projection: compute the theta angle\n * and determine the area number. */\nfunction qsc_fwd_equat_face_theta(phi, y, x, area) {\n  var theta;\n  if (phi < EPSLN) {\n    area.value = AREA_ENUM.AREA_0;\n    theta = 0.0;\n  } else {\n    theta = Math.atan2(y, x);\n    if (Math.abs(theta) <= FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n    } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta -= HALF_PI;\n    } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = (theta >= 0.0 ? theta - SPI : theta + SPI);\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta += HALF_PI;\n    }\n  }\n  return theta;\n}\n\n/* Helper function: shift the longitude. */\nfunction qsc_shift_lon_origin(lon, offset) {\n  var slon = lon + offset;\n  if (slon < -SPI) {\n    slon += TWO_PI;\n  } else if (slon > +SPI) {\n    slon -= TWO_PI;\n  }\n  return slon;\n}\n\nexport var names = ['Quadrilateralized Spherical Cube', 'Quadrilateralized_Spherical_Cube', 'qsc'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","// Robinson projection\n// Based on https://github.com/OSGeo/proj.4/blob/master/src/PJ_robin.c\n// Polynomial coeficients from http://article.gmane.org/gmane.comp.gis.proj-4.devel/6039\n\nimport { HALF_PI, D2R, R2D, EPSLN } from '../constants/values';\nimport adjust_lon from '../common/adjust_lon';\n\nvar COEFS_X = [\n  [1.0000, 2.2199e-17, -7.15515e-05, 3.1103e-06],\n  [0.9986, -0.000482243, -2.4897e-05, -1.3309e-06],\n  [0.9954, -0.00083103, -4.48605e-05, -9.86701e-07],\n  [0.9900, -0.00135364, -5.9661e-05, 3.6777e-06],\n  [0.9822, -0.00167442, -4.49547e-06, -5.72411e-06],\n  [0.9730, -0.00214868, -9.03571e-05, 1.8736e-08],\n  [0.9600, -0.00305085, -9.00761e-05, 1.64917e-06],\n  [0.9427, -0.00382792, -6.53386e-05, -2.6154e-06],\n  [0.9216, -0.00467746, -0.00010457, 4.81243e-06],\n  [0.8962, -0.00536223, -3.23831e-05, -5.43432e-06],\n  [0.8679, -0.00609363, -0.000113898, 3.32484e-06],\n  [0.8350, -0.00698325, -6.40253e-05, 9.34959e-07],\n  [0.7986, -0.00755338, -5.00009e-05, 9.35324e-07],\n  [0.7597, -0.00798324, -3.5971e-05, -2.27626e-06],\n  [0.7186, -0.00851367, -7.01149e-05, -8.6303e-06],\n  [0.6732, -0.00986209, -0.000199569, 1.91974e-05],\n  [0.6213, -0.010418, 8.83923e-05, 6.24051e-06],\n  [0.5722, -0.00906601, 0.000182, 6.24051e-06],\n  [0.5322, -0.00677797, 0.000275608, 6.24051e-06]\n];\n\nvar COEFS_Y = [\n  [-5.20417e-18, 0.0124, 1.21431e-18, -8.45284e-11],\n  [0.0620, 0.0124, -1.26793e-09, 4.22642e-10],\n  [0.1240, 0.0124, 5.07171e-09, -1.60604e-09],\n  [0.1860, 0.0123999, -1.90189e-08, 6.00152e-09],\n  [0.2480, 0.0124002, 7.10039e-08, -2.24e-08],\n  [0.3100, 0.0123992, -2.64997e-07, 8.35986e-08],\n  [0.3720, 0.0124029, 9.88983e-07, -3.11994e-07],\n  [0.4340, 0.0123893, -3.69093e-06, -4.35621e-07],\n  [0.4958, 0.0123198, -1.02252e-05, -3.45523e-07],\n  [0.5571, 0.0121916, -1.54081e-05, -5.82288e-07],\n  [0.6176, 0.0119938, -2.41424e-05, -5.25327e-07],\n  [0.6769, 0.011713, -3.20223e-05, -5.16405e-07],\n  [0.7346, 0.0113541, -3.97684e-05, -6.09052e-07],\n  [0.7903, 0.0109107, -4.89042e-05, -1.04739e-06],\n  [0.8435, 0.0103431, -6.4615e-05, -1.40374e-09],\n  [0.8936, 0.00969686, -6.4636e-05, -8.547e-06],\n  [0.9394, 0.00840947, -0.000192841, -4.2106e-06],\n  [0.9761, 0.00616527, -0.000256, -4.2106e-06],\n  [1.0000, 0.00328947, -0.000319159, -4.2106e-06]\n];\n\nvar FXC = 0.8487;\nvar FYC = 1.3523;\nvar C1 = R2D / 5; // rad to 5-degree interval\nvar RC1 = 1 / C1;\nvar NODES = 18;\n\nvar poly3_val = function (coefs, x) {\n  return coefs[0] + x * (coefs[1] + x * (coefs[2] + x * coefs[3]));\n};\n\nvar poly3_der = function (coefs, x) {\n  return coefs[1] + x * (2 * coefs[2] + x * 3 * coefs[3]);\n};\n\nfunction newton_rapshon(f_df, start, max_err, iters) {\n  var x = start;\n  for (; iters; --iters) {\n    var upd = f_df(x);\n    x -= upd;\n    if (Math.abs(upd) < max_err) {\n      break;\n    }\n  }\n  return x;\n}\n\nexport function init() {\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.long0 = this.long0 || 0;\n  this.es = 0;\n  this.title = this.title || 'Robinson';\n}\n\nexport function forward(ll) {\n  var lon = adjust_lon(ll.x - this.long0);\n\n  var dphi = Math.abs(ll.y);\n  var i = Math.floor(dphi * C1);\n  if (i < 0) {\n    i = 0;\n  } else if (i >= NODES) {\n    i = NODES - 1;\n  }\n  dphi = R2D * (dphi - RC1 * i);\n  var xy = {\n    x: poly3_val(COEFS_X[i], dphi) * lon,\n    y: poly3_val(COEFS_Y[i], dphi)\n  };\n  if (ll.y < 0) {\n    xy.y = -xy.y;\n  }\n\n  xy.x = xy.x * this.a * FXC + this.x0;\n  xy.y = xy.y * this.a * FYC + this.y0;\n  return xy;\n}\n\nexport function inverse(xy) {\n  var ll = {\n    x: (xy.x - this.x0) / (this.a * FXC),\n    y: Math.abs(xy.y - this.y0) / (this.a * FYC)\n  };\n\n  if (ll.y >= 1) { // pathologic case\n    ll.x /= COEFS_X[NODES][0];\n    ll.y = xy.y < 0 ? -HALF_PI : HALF_PI;\n  } else {\n    // find table interval\n    var i = Math.floor(ll.y * NODES);\n    if (i < 0) {\n      i = 0;\n    } else if (i >= NODES) {\n      i = NODES - 1;\n    }\n    for (;;) {\n      if (COEFS_Y[i][0] > ll.y) {\n        --i;\n      } else if (COEFS_Y[i + 1][0] <= ll.y) {\n        ++i;\n      } else {\n        break;\n      }\n    }\n    // linear interpolation in 5 degree interval\n    var coefs = COEFS_Y[i];\n    var t = 5 * (ll.y - coefs[0]) / (COEFS_Y[i + 1][0] - coefs[0]);\n    // find t so that poly3_val(coefs, t) = ll.y\n    t = newton_rapshon(function (x) {\n      return (poly3_val(coefs, x) - ll.y) / poly3_der(coefs, x);\n    }, t, EPSLN, 100);\n\n    ll.x /= poly3_val(COEFS_X[i], t);\n    ll.y = (5 * i + t) * D2R;\n    if (xy.y < 0) {\n      ll.y = -ll.y;\n    }\n  }\n\n  ll.x = adjust_lon(ll.x + this.long0);\n  return ll;\n}\n\nexport var names = ['Robinson', 'robin'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {\n  geodeticToGeocentric,\n  geocentricToGeodetic\n} from '../datumUtils';\n\nexport function init() {\n  this.name = 'geocent';\n}\n\nexport function forward(p) {\n  var point = geodeticToGeocentric(p, this.es, this.a);\n  return point;\n}\n\nexport function inverse(p) {\n  var point = geocentricToGeodetic(p, this.es, this.a, this.b);\n  return point;\n}\n\nexport var names = ['Geocentric', 'geocentric', 'geocent', 'Geocent'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import { D2R, HALF_PI, EPSLN } from '../constants/values';\nimport hypot from '../common/hypot';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} mode\n * @property {number} sinph0\n * @property {number} cosph0\n * @property {number} pn1\n * @property {number} h\n * @property {number} rp\n * @property {number} p\n * @property {number} h1\n * @property {number} pfact\n * @property {number} es\n * @property {number} tilt\n * @property {number} azi\n * @property {number} cg\n * @property {number} sg\n * @property {number} cw\n * @property {number} sw\n */\n\nvar mode = {\n  N_POLE: 0,\n  S_POLE: 1,\n  EQUIT: 2,\n  OBLIQ: 3\n};\n\nvar params = {\n  h: { def: 100000, num: true }, // default is Karman line, no default in PROJ.7\n  azi: { def: 0, num: true, degrees: true }, // default is North\n  tilt: { def: 0, num: true, degrees: true }, // default is Nadir\n  long0: { def: 0, num: true }, // default is Greenwich, conversion to rad is automatic\n  lat0: { def: 0, num: true } // default is Equator, conversion to rad is automatic\n};\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  Object.keys(params).forEach(function (p) {\n    if (typeof this[p] === 'undefined') {\n      this[p] = params[p].def;\n    } else if (params[p].num && isNaN(this[p])) {\n      throw new Error('Invalid parameter value, must be numeric ' + p + ' = ' + this[p]);\n    } else if (params[p].num) {\n      this[p] = parseFloat(this[p]);\n    }\n    if (params[p].degrees) {\n      this[p] = this[p] * D2R;\n    }\n  }.bind(this));\n\n  if (Math.abs((Math.abs(this.lat0) - HALF_PI)) < EPSLN) {\n    this.mode = this.lat0 < 0 ? mode.S_POLE : mode.N_POLE;\n  } else if (Math.abs(this.lat0) < EPSLN) {\n    this.mode = mode.EQUIT;\n  } else {\n    this.mode = mode.OBLIQ;\n    this.sinph0 = Math.sin(this.lat0);\n    this.cosph0 = Math.cos(this.lat0);\n  }\n\n  this.pn1 = this.h / this.a; // Normalize relative to the Earth's radius\n\n  if (this.pn1 <= 0 || this.pn1 > 1e10) {\n    throw new Error('Invalid height');\n  }\n\n  this.p = 1 + this.pn1;\n  this.rp = 1 / this.p;\n  this.h1 = 1 / this.pn1;\n  this.pfact = (this.p + 1) * this.h1;\n  this.es = 0;\n\n  var omega = this.tilt;\n  var gamma = this.azi;\n  this.cg = Math.cos(gamma);\n  this.sg = Math.sin(gamma);\n  this.cw = Math.cos(omega);\n  this.sw = Math.sin(omega);\n}\n\nexport function forward(p) {\n  p.x -= this.long0;\n  var sinphi = Math.sin(p.y);\n  var cosphi = Math.cos(p.y);\n  var coslam = Math.cos(p.x);\n  var x, y;\n  switch (this.mode) {\n    case mode.OBLIQ:\n      y = this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;\n      break;\n    case mode.EQUIT:\n      y = cosphi * coslam;\n      break;\n    case mode.S_POLE:\n      y = -sinphi;\n      break;\n    case mode.N_POLE:\n      y = sinphi;\n      break;\n  }\n  y = this.pn1 / (this.p - y);\n  x = y * cosphi * Math.sin(p.x);\n\n  switch (this.mode) {\n    case mode.OBLIQ:\n      y *= this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;\n      break;\n    case mode.EQUIT:\n      y *= sinphi;\n      break;\n    case mode.N_POLE:\n      y *= -(cosphi * coslam);\n      break;\n    case mode.S_POLE:\n      y *= cosphi * coslam;\n      break;\n  }\n\n  // Tilt\n  var yt, ba;\n  yt = y * this.cg + x * this.sg;\n  ba = 1 / (yt * this.sw * this.h1 + this.cw);\n  x = (x * this.cg - y * this.sg) * this.cw * ba;\n  y = yt * ba;\n\n  p.x = x * this.a;\n  p.y = y * this.a;\n  return p;\n}\n\nexport function inverse(p) {\n  p.x /= this.a;\n  p.y /= this.a;\n  var r = { x: p.x, y: p.y };\n\n  // Un-Tilt\n  var bm, bq, yt;\n  yt = 1 / (this.pn1 - p.y * this.sw);\n  bm = this.pn1 * p.x * yt;\n  bq = this.pn1 * p.y * this.cw * yt;\n  p.x = bm * this.cg + bq * this.sg;\n  p.y = bq * this.cg - bm * this.sg;\n\n  var rh = hypot(p.x, p.y);\n  if (Math.abs(rh) < EPSLN) {\n    r.x = 0;\n    r.y = p.y;\n  } else {\n    var cosz, sinz;\n    sinz = 1 - rh * rh * this.pfact;\n    sinz = (this.p - Math.sqrt(sinz)) / (this.pn1 / rh + rh / this.pn1);\n    cosz = Math.sqrt(1 - sinz * sinz);\n    switch (this.mode) {\n      case mode.OBLIQ:\n        r.y = Math.asin(cosz * this.sinph0 + p.y * sinz * this.cosph0 / rh);\n        p.y = (cosz - this.sinph0 * Math.sin(r.y)) * rh;\n        p.x *= sinz * this.cosph0;\n        break;\n      case mode.EQUIT:\n        r.y = Math.asin(p.y * sinz / rh);\n        p.y = cosz * rh;\n        p.x *= sinz;\n        break;\n      case mode.N_POLE:\n        r.y = Math.asin(cosz);\n        p.y = -p.y;\n        break;\n      case mode.S_POLE:\n        r.y = -Math.asin(cosz);\n        break;\n    }\n    r.x = Math.atan2(p.x, p.y);\n  }\n\n  p.x = r.x + this.long0;\n  p.y = r.y;\n  return p;\n}\n\nexport var names = ['Tilted_Perspective', 'tpers'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import hypot from '../common/hypot';\n\n/**\n * @typedef {Object} LocalThis\n * @property {1 | 0} flip_axis\n * @property {number} h\n * @property {number} radius_g_1\n * @property {number} radius_g\n * @property {number} radius_p\n * @property {number} radius_p2\n * @property {number} radius_p_inv2\n * @property {'ellipse'|'sphere'} shape\n * @property {number} C\n * @property {string} sweep\n * @property {number} es\n */\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  this.flip_axis = (this.sweep === 'x' ? 1 : 0);\n  this.h = Number(this.h);\n  this.radius_g_1 = this.h / this.a;\n\n  if (this.radius_g_1 <= 0 || this.radius_g_1 > 1e10) {\n    throw new Error();\n  }\n\n  this.radius_g = 1.0 + this.radius_g_1;\n  this.C = this.radius_g * this.radius_g - 1.0;\n\n  if (this.es !== 0.0) {\n    var one_es = 1.0 - this.es;\n    var rone_es = 1 / one_es;\n\n    this.radius_p = Math.sqrt(one_es);\n    this.radius_p2 = one_es;\n    this.radius_p_inv2 = rone_es;\n\n    this.shape = 'ellipse'; // Use as a condition in the forward and inverse functions.\n  } else {\n    this.radius_p = 1.0;\n    this.radius_p2 = 1.0;\n    this.radius_p_inv2 = 1.0;\n\n    this.shape = 'sphere'; // Use as a condition in the forward and inverse functions.\n  }\n\n  if (!this.title) {\n    this.title = 'Geostationary Satellite View';\n  }\n}\n\nfunction forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var tmp, v_x, v_y, v_z;\n  lon = lon - this.long0;\n\n  if (this.shape === 'ellipse') {\n    lat = Math.atan(this.radius_p2 * Math.tan(lat));\n    var r = this.radius_p / hypot(this.radius_p * Math.cos(lat), Math.sin(lat));\n\n    v_x = r * Math.cos(lon) * Math.cos(lat);\n    v_y = r * Math.sin(lon) * Math.cos(lat);\n    v_z = r * Math.sin(lat);\n\n    if (((this.radius_g - v_x) * v_x - v_y * v_y - v_z * v_z * this.radius_p_inv2) < 0.0) {\n      p.x = Number.NaN;\n      p.y = Number.NaN;\n      return p;\n    }\n\n    tmp = this.radius_g - v_x;\n    if (this.flip_axis) {\n      p.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));\n      p.y = this.radius_g_1 * Math.atan(v_z / tmp);\n    } else {\n      p.x = this.radius_g_1 * Math.atan(v_y / tmp);\n      p.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));\n    }\n  } else if (this.shape === 'sphere') {\n    tmp = Math.cos(lat);\n    v_x = Math.cos(lon) * tmp;\n    v_y = Math.sin(lon) * tmp;\n    v_z = Math.sin(lat);\n    tmp = this.radius_g - v_x;\n\n    if (this.flip_axis) {\n      p.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));\n      p.y = this.radius_g_1 * Math.atan(v_z / tmp);\n    } else {\n      p.x = this.radius_g_1 * Math.atan(v_y / tmp);\n      p.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));\n    }\n  }\n  p.x = p.x * this.a;\n  p.y = p.y * this.a;\n  return p;\n}\n\nfunction inverse(p) {\n  var v_x = -1.0;\n  var v_y = 0.0;\n  var v_z = 0.0;\n  var a, b, det, k;\n\n  p.x = p.x / this.a;\n  p.y = p.y / this.a;\n\n  if (this.shape === 'ellipse') {\n    if (this.flip_axis) {\n      v_z = Math.tan(p.y / this.radius_g_1);\n      v_y = Math.tan(p.x / this.radius_g_1) * hypot(1.0, v_z);\n    } else {\n      v_y = Math.tan(p.x / this.radius_g_1);\n      v_z = Math.tan(p.y / this.radius_g_1) * hypot(1.0, v_y);\n    }\n\n    var v_zp = v_z / this.radius_p;\n    a = v_y * v_y + v_zp * v_zp + v_x * v_x;\n    b = 2 * this.radius_g * v_x;\n    det = (b * b) - 4 * a * this.C;\n\n    if (det < 0.0) {\n      p.x = Number.NaN;\n      p.y = Number.NaN;\n      return p;\n    }\n\n    k = (-b - Math.sqrt(det)) / (2.0 * a);\n    v_x = this.radius_g + k * v_x;\n    v_y *= k;\n    v_z *= k;\n\n    p.x = Math.atan2(v_y, v_x);\n    p.y = Math.atan(v_z * Math.cos(p.x) / v_x);\n    p.y = Math.atan(this.radius_p_inv2 * Math.tan(p.y));\n  } else if (this.shape === 'sphere') {\n    if (this.flip_axis) {\n      v_z = Math.tan(p.y / this.radius_g_1);\n      v_y = Math.tan(p.x / this.radius_g_1) * Math.sqrt(1.0 + v_z * v_z);\n    } else {\n      v_y = Math.tan(p.x / this.radius_g_1);\n      v_z = Math.tan(p.y / this.radius_g_1) * Math.sqrt(1.0 + v_y * v_y);\n    }\n\n    a = v_y * v_y + v_z * v_z + v_x * v_x;\n    b = 2 * this.radius_g * v_x;\n    det = (b * b) - 4 * a * this.C;\n    if (det < 0.0) {\n      p.x = Number.NaN;\n      p.y = Number.NaN;\n      return p;\n    }\n\n    k = (-b - Math.sqrt(det)) / (2.0 * a);\n    v_x = this.radius_g + k * v_x;\n    v_y *= k;\n    v_z *= k;\n\n    p.x = Math.atan2(v_y, v_x);\n    p.y = Math.atan(v_z * Math.cos(p.x) / v_x);\n  }\n  p.x = p.x + this.long0;\n  return p;\n}\n\nexport var names = ['Geostationary Satellite View', 'Geostationary_Satellite', 'geos'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","/**\n * Copyright 2018 Bernie Jenny, Monash University, Melbourne, Australia.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * Equal Earth is a projection inspired by the Robinson projection, but unlike\n * the Robinson projection retains the relative size of areas. The projection\n * was designed in 2018 by Bojan Savric, Tom Patterson and Bernhard Jenny.\n *\n * Publication:\n * Bojan Savric, Tom Patterson & Bernhard Jenny (2018). The Equal Earth map\n * projection, International Journal of Geographical Information Science,\n * DOI: 10.1080/13658816.2018.1504949\n *\n * Code released August 2018\n * Ported to JavaScript and adapted for mapshaper-proj by Matthew Bloch August 2018\n * Modified for proj4js by Andreas Hocevar by Andreas Hocevar March 2024\n */\n\nimport adjust_lon from '../common/adjust_lon';\n\nvar A1 = 1.340264,\n  A2 = -0.081106,\n  A3 = 0.000893,\n  A4 = 0.003796,\n  M = Math.sqrt(3) / 2.0;\n\nexport function init() {\n  this.es = 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n}\n\nexport function forward(p) {\n  var lam = adjust_lon(p.x - this.long0);\n  var phi = p.y;\n  var paramLat = Math.asin(M * Math.sin(phi)),\n    paramLatSq = paramLat * paramLat,\n    paramLatPow6 = paramLatSq * paramLatSq * paramLatSq;\n  p.x = lam * Math.cos(paramLat)\n    / (M * (A1 + 3 * A2 * paramLatSq + paramLatPow6 * (7 * A3 + 9 * A4 * paramLatSq)));\n  p.y = paramLat * (A1 + A2 * paramLatSq + paramLatPow6 * (A3 + A4 * paramLatSq));\n\n  p.x = this.a * p.x + this.x0;\n  p.y = this.a * p.y + this.y0;\n  return p;\n}\n\nexport function inverse(p) {\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  var EPS = 1e-9,\n    NITER = 12,\n    paramLat = p.y,\n    paramLatSq, paramLatPow6, fy, fpy, dlat, i;\n\n  for (i = 0; i < NITER; ++i) {\n    paramLatSq = paramLat * paramLat;\n    paramLatPow6 = paramLatSq * paramLatSq * paramLatSq;\n    fy = paramLat * (A1 + A2 * paramLatSq + paramLatPow6 * (A3 + A4 * paramLatSq)) - p.y;\n    fpy = A1 + 3 * A2 * paramLatSq + paramLatPow6 * (7 * A3 + 9 * A4 * paramLatSq);\n    paramLat -= dlat = fy / fpy;\n    if (Math.abs(dlat) < EPS) {\n      break;\n    }\n  }\n  paramLatSq = paramLat * paramLat;\n  paramLatPow6 = paramLatSq * paramLatSq * paramLatSq;\n  p.x = M * p.x * (A1 + 3 * A2 * paramLatSq + paramLatPow6 * (7 * A3 + 9 * A4 * paramLatSq))\n    / Math.cos(paramLat);\n  p.y = Math.asin(Math.sin(paramLat) / M);\n\n  p.x = adjust_lon(p.x + this.long0);\n  return p;\n}\n\nexport var names = ['eqearth', 'Equal Earth', 'Equal_Earth'];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lat from '../common/adjust_lat';\nimport adjust_lon from '../common/adjust_lon';\nimport hypot from '../common/hypot';\nimport pj_enfn from '../common/pj_enfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport pj_mlfn from '../common/pj_mlfn';\nimport { HALF_PI } from '../constants/values';\n\n/**\n * @typedef {Object} LocalThis\n * @property {number} phi1\n * @property {number} cphi1\n * @property {number} es\n * @property {Array<number>} en\n * @property {number} m1\n * @property {number} am1\n */\n\nvar EPS10 = 1e-10;\n\n/** @this {import('../defs.js').ProjectionDefinition & LocalThis} */\nexport function init() {\n  var c;\n\n  this.phi1 = this.lat1;\n  if (Math.abs(this.phi1) < EPS10) {\n    throw new Error();\n  }\n  if (this.es) {\n    this.en = pj_enfn(this.es);\n    this.m1 = pj_mlfn(this.phi1, this.am1 = Math.sin(this.phi1),\n      c = Math.cos(this.phi1), this.en);\n    this.am1 = c / (Math.sqrt(1 - this.es * this.am1 * this.am1) * this.am1);\n    this.inverse = e_inv;\n    this.forward = e_fwd;\n  } else {\n    if (Math.abs(this.phi1) + EPS10 >= HALF_PI) {\n      this.cphi1 = 0;\n    } else {\n      this.cphi1 = 1 / Math.tan(this.phi1);\n    }\n    this.inverse = s_inv;\n    this.forward = s_fwd;\n  }\n}\n\nfunction e_fwd(p) {\n  var lam = adjust_lon(p.x - (this.long0 || 0));\n  var phi = p.y;\n  var rh, E, c;\n  rh = this.am1 + this.m1 - pj_mlfn(phi, E = Math.sin(phi), c = Math.cos(phi), this.en);\n  E = c * lam / (rh * Math.sqrt(1 - this.es * E * E));\n  p.x = rh * Math.sin(E);\n  p.y = this.am1 - rh * Math.cos(E);\n\n  p.x = this.a * p.x + (this.x0 || 0);\n  p.y = this.a * p.y + (this.y0 || 0);\n  return p;\n}\n\nfunction e_inv(p) {\n  p.x = (p.x - (this.x0 || 0)) / this.a;\n  p.y = (p.y - (this.y0 || 0)) / this.a;\n\n  var s, rh, lam, phi;\n  rh = hypot(p.x, p.y = this.am1 - p.y);\n  phi = pj_inv_mlfn(this.am1 + this.m1 - rh, this.es, this.en);\n  if ((s = Math.abs(phi)) < HALF_PI) {\n    s = Math.sin(phi);\n    lam = rh * Math.atan2(p.x, p.y) * Math.sqrt(1 - this.es * s * s) / Math.cos(phi);\n  } else if (Math.abs(s - HALF_PI) <= EPS10) {\n    lam = 0;\n  } else {\n    throw new Error();\n  }\n  p.x = adjust_lon(lam + (this.long0 || 0));\n  p.y = adjust_lat(phi);\n  return p;\n}\n\nfunction s_fwd(p) {\n  var lam = adjust_lon(p.x - (this.long0 || 0));\n  var phi = p.y;\n  var E, rh;\n  rh = this.cphi1 + this.phi1 - phi;\n  if (Math.abs(rh) > EPS10) {\n    p.x = rh * Math.sin(E = lam * Math.cos(phi) / rh);\n    p.y = this.cphi1 - rh * Math.cos(E);\n  } else {\n    p.x = p.y = 0;\n  }\n\n  p.x = this.a * p.x + (this.x0 || 0);\n  p.y = this.a * p.y + (this.y0 || 0);\n  return p;\n}\n\nfunction s_inv(p) {\n  p.x = (p.x - (this.x0 || 0)) / this.a;\n  p.y = (p.y - (this.y0 || 0)) / this.a;\n\n  var lam, phi;\n  var rh = hypot(p.x, p.y = this.cphi1 - p.y);\n  phi = this.cphi1 + this.phi1 - rh;\n  if (Math.abs(phi) > HALF_PI) {\n    throw new Error();\n  }\n  if (Math.abs(Math.abs(phi) - HALF_PI) <= EPS10) {\n    lam = 0;\n  } else {\n    lam = rh * Math.atan2(p.x, p.y) / Math.cos(phi);\n  }\n  p.x = adjust_lon(lam + (this.long0 || 0));\n  p.y = adjust_lat(phi);\n  return p;\n}\n\nexport var names = ['bonne', 'Bonne (Werner lat_1=90)'];\nexport default {\n  init: init,\n  names: names\n};\n","import core from './core';\nimport Proj from './Proj';\nimport Point from './Point';\nimport common from './common/toPoint';\nimport defs from './defs';\nimport nadgrid from './nadgrid';\nimport transform from './transform';\nimport mgrs from 'mgrs';\nimport includedProjections from '../projs';\n\n/**\n * @typedef {Object} Mgrs\n * @property {(lonlat: [number, number]) => string} forward\n * @property {(mgrsString: string) => [number, number, number, number]} inverse\n * @property {(mgrsString: string) => [number, number]} toPoint\n */\n\n/**\n * @typedef {import('./defs').ProjectionDefinition} ProjectionDefinition\n * @typedef {import('./core').TemplateCoordinates} TemplateCoordinates\n * @typedef {import('./core').InterfaceCoordinates} InterfaceCoordinates\n * @typedef {import('./core').Converter} Converter\n * @typedef {import('./Proj').DatumDefinition} DatumDefinition\n */\n\n/**\n * @template {import('./core').TemplateCoordinates} T\n * @type {core<T> & {defaultDatum: string, Proj: typeof Proj, WGS84: Proj, Point: typeof Point, toPoint: typeof common, defs: typeof defs, nadgrid: typeof nadgrid, transform: typeof transform, mgrs: Mgrs, version: string}}\n */\nconst proj4 = Object.assign(core, {\n  defaultDatum: 'WGS84',\n  Proj,\n  WGS84: new Proj('WGS84'),\n  Point,\n  toPoint: common,\n  defs,\n  nadgrid,\n  transform,\n  mgrs,\n  version: '__VERSION__'\n});\nincludedProjections(proj4);\nexport default proj4;\n","import tmerc from './lib/projections/tmerc';\nimport etmerc from './lib/projections/etmerc';\nimport utm from './lib/projections/utm';\nimport sterea from './lib/projections/sterea';\nimport stere from './lib/projections/stere';\nimport somerc from './lib/projections/somerc';\nimport omerc from './lib/projections/omerc';\nimport lcc from './lib/projections/lcc';\nimport krovak from './lib/projections/krovak';\nimport cass from './lib/projections/cass';\nimport laea from './lib/projections/laea';\nimport aea from './lib/projections/aea';\nimport gnom from './lib/projections/gnom';\nimport cea from './lib/projections/cea';\nimport eqc from './lib/projections/eqc';\nimport poly from './lib/projections/poly';\nimport nzmg from './lib/projections/nzmg';\nimport mill from './lib/projections/mill';\nimport sinu from './lib/projections/sinu';\nimport moll from './lib/projections/moll';\nimport eqdc from './lib/projections/eqdc';\nimport vandg from './lib/projections/vandg';\nimport aeqd from './lib/projections/aeqd';\nimport ortho from './lib/projections/ortho';\nimport qsc from './lib/projections/qsc';\nimport robin from './lib/projections/robin';\nimport geocent from './lib/projections/geocent';\nimport tpers from './lib/projections/tpers';\nimport geos from './lib/projections/geos';\nimport eqearth from './lib/projections/eqearth';\nimport bonne from './lib/projections/bonne';\nexport default function (proj4) {\n  proj4.Proj.projections.add(tmerc);\n  proj4.Proj.projections.add(etmerc);\n  proj4.Proj.projections.add(utm);\n  proj4.Proj.projections.add(sterea);\n  proj4.Proj.projections.add(stere);\n  proj4.Proj.projections.add(somerc);\n  proj4.Proj.projections.add(omerc);\n  proj4.Proj.projections.add(lcc);\n  proj4.Proj.projections.add(krovak);\n  proj4.Proj.projections.add(cass);\n  proj4.Proj.projections.add(laea);\n  proj4.Proj.projections.add(aea);\n  proj4.Proj.projections.add(gnom);\n  proj4.Proj.projections.add(cea);\n  proj4.Proj.projections.add(eqc);\n  proj4.Proj.projections.add(poly);\n  proj4.Proj.projections.add(nzmg);\n  proj4.Proj.projections.add(mill);\n  proj4.Proj.projections.add(sinu);\n  proj4.Proj.projections.add(moll);\n  proj4.Proj.projections.add(eqdc);\n  proj4.Proj.projections.add(vandg);\n  proj4.Proj.projections.add(aeqd);\n  proj4.Proj.projections.add(ortho);\n  proj4.Proj.projections.add(qsc);\n  proj4.Proj.projections.add(robin);\n  proj4.Proj.projections.add(geocent);\n  proj4.Proj.projections.add(tpers);\n  proj4.Proj.projections.add(geos);\n  proj4.Proj.projections.add(eqearth);\n  proj4.Proj.projections.add(bonne);\n}\n","import { geoOrthographic, geoPath } from 'd3-geo'\r\nimport { feature } from 'topojson-client'\r\nimport { json } from 'd3-fetch'\r\nimport proj4 from 'proj4'\r\n\r\nexport const appendMinimap = (map) => {\r\n    if (!map.svg_) return\r\n    if (!map.minimap_.size) map.minimap_.size = 150\r\n\r\n    // Load geometries\r\n    if (map.Geometries.geoJSONs.worldrg) {\r\n        drawMinimap(map)\r\n    } else {\r\n        const worldMapTopojsonURL = window.location.hostname.includes('ec.europa.eu')\r\n            ? 'https://ec.europa.eu/assets/estat/E/E4/gisco/eurostat-map/world-topo-2024-60M-4326.json'\r\n            : 'https://raw.githubusercontent.com/eurostat/eurostat-map/master/src/assets/topojson/world-topo-60M.json'\r\n        json(worldMapTopojsonURL)\r\n            .then((topoData) => {\r\n                const features = feature(topoData, topoData.objects.CNTR_RG_60M_2024_4326).features\r\n                map.Geometries.geoJSONs.worldrg = features\r\n                drawMinimap(map)\r\n            })\r\n            .catch((err) => console.error('Failed to load world-topo-60M.json', err))\r\n    }\r\n\r\n    // Listen for zoom/pan events\r\n    window.addEventListener(\r\n        'estatmap:zoomed-' + map.svgId_,\r\n        debounce((e) => onMiniUpdate(e.detail), map.minimap_?.debounce || 3)\r\n    )\r\n}\r\n\r\nconst onMiniUpdate = (map) => {\r\n    //console.log('Updating minimap...')\r\n    applyMinimapRotation(map)\r\n    applyMinimapScale(map)\r\n    map._minimapGlobe.selectAll('path').attr('d', map._minimapPath)\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n\r\nfunction normalizeLon(lon) {\r\n    return ((lon + 540) % 360) - 180\r\n}\r\n\r\n// Convert main map's projected center to lon/lat if needed\r\nfunction getLonLatFromMapPosition(map) {\r\n    let lon = map.position_?.x\r\n    let lat = map.position_?.y\r\n\r\n    if (!Number.isFinite(lon) || !Number.isFinite(lat)) return null\r\n\r\n    // If map uses a projected CRS, convert to EPSG:4326\r\n    if (map.proj_ === '3035') {\r\n        ;[lon, lat] = proj4('EPSG:3035', 'EPSG:4326', [lon, lat])\r\n    } else if (map.proj_ === '54030') {\r\n        ;[lon, lat] = proj4('EPSG:54030', 'EPSG:4326', [lon, lat])\r\n    }\r\n\r\n    return [lon, lat]\r\n}\r\n\r\nfunction applyMinimapRotation(map) {\r\n    const coords = getLonLatFromMapPosition(map)\r\n    if (!coords) return\r\n    const [lon, lat] = coords\r\n    map._minimapProjection.rotate([-normalizeLon(lon), -lat, 0])\r\n}\r\n\r\nfunction applyMinimapScale(map) {\r\n    const S0 = map._minimapBaseScale || map._minimapProjection.scale()\r\n    const k = map._lastZoomK || map.__lastTransform?.k || 1\r\n    const exponent = 0.65\r\n    const offset = 0.9\r\n    const s = S0 * Math.pow(k, exponent) * offset\r\n    const MIN = S0 * 0.35\r\n    const MAX = S0 * 5\r\n    map._minimapProjection.scale(Math.max(MIN, Math.min(MAX, s)))\r\n}\r\n\r\nconst defineMinimapProjection = (map) => {\r\n    const z = map.minimap_?.z || 160\r\n    map._minimapProjection = geoOrthographic().scale(z).translate([0, 0])\r\n\r\n    map._minimapPath = geoPath().projection(map._minimapProjection)\r\n    map._minimapBaseScale = map._minimapProjection.scale()\r\n\r\n    applyMinimapRotation(map)\r\n    applyMinimapScale(map)\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n\r\nconst drawMinimap = (map) => {\r\n    try {\r\n        const minimapConfig = map.minimap_ || {}\r\n        const x = minimapConfig.x || 80\r\n        const y = minimapConfig.y || 80\r\n        const color = minimapConfig.color || '#929292ff'\r\n        const size = minimapConfig.size || 160\r\n        const geometries = map.Geometries.geoJSONs.worldrg\r\n\r\n        // Container\r\n        map._minimapContainer = map.svg_.append('g').attr('id', 'em-minimap').attr('transform', `translate(${x},${y})`)\r\n\r\n        // Inner circle (white background)\r\n        map._minimapContainer\r\n            .append('circle')\r\n            .attr('class', 'em-minimap-inner-circle')\r\n            .attr('r', size / 2)\r\n            .attr('cx', 0)\r\n            .attr('cy', 0)\r\n            .attr('fill', 'white')\r\n            .attr('filter', 'url(#em-minimap-inner-shadow)')\r\n\r\n        // Projection\r\n        defineMinimapProjection(map)\r\n\r\n        // Clip\r\n        addDefsToMinimap(map, size)\r\n\r\n        // Globe\r\n        map._minimapGlobe = map._minimapContainer.append('g').attr('class', 'em-minimap-globe').attr('clip-path', 'url(#minimap-clip)')\r\n\r\n        // Countries\r\n        map._minimapGlobe.selectAll('path.country').data(geometries).enter().append('path').attr('d', map._minimapPath).attr('fill', '#e0e0e0')\r\n\r\n        // Highlight\r\n        if (minimapConfig.highlightIds && Array.isArray(minimapConfig.highlightIds)) {\r\n            const targets = geometries.filter((d) => minimapConfig.highlightIds.includes(d.id))\r\n            if (targets.length) {\r\n                targets.forEach((target) => {\r\n                    map._minimapGlobe\r\n                        .append('path')\r\n                        .datum(target)\r\n                        .attr('d', map._minimapPath)\r\n                        .attr('fill', color)\r\n                        .attr('stroke', color)\r\n                        .attr('stroke-width', 0.5)\r\n                })\r\n            }\r\n        }\r\n\r\n        // Outer circle\r\n        map._minimapContainer\r\n            .append('circle')\r\n            .attr('class', 'em-minimap-outer-circle')\r\n            .attr('r', size / 2)\r\n            .attr('cx', 0)\r\n            .attr('cy', 0)\r\n            .attr('fill', 'none')\r\n            .attr('stroke', color)\r\n            .attr('stroke-width', 3)\r\n\r\n        // First sync\r\n        onMiniUpdate(map)\r\n    } catch (error) {\r\n        console.error('Error drawing minimap:', error)\r\n    }\r\n}\r\n\r\nfunction addDefsToMinimap(map, size) {\r\n    const defs = map._minimapContainer.append('defs')\r\n    addInnerShadowToDefs(defs)\r\n\r\n    defs.append('clipPath')\r\n        .attr('id', 'minimap-clip')\r\n        .append('circle')\r\n        .attr('r', size / 2 - 3)\r\n        .attr('cx', 0)\r\n        .attr('cy', 0)\r\n}\r\n\r\nfunction addInnerShadowToDefs(defs) {\r\n    const innerShadow = defs\r\n        .append('filter')\r\n        .attr('id', 'em-minimap-inner-shadow')\r\n        .attr('x', '-50%')\r\n        .attr('y', '-50%')\r\n        .attr('width', '200%')\r\n        .attr('height', '200%')\r\n        .attr('color-interpolation-filters', 'sRGB')\r\n\r\n    innerShadow.append('feGaussianBlur').attr('in', 'SourceAlpha').attr('stdDeviation', 3).attr('result', 'blur')\r\n\r\n    innerShadow.append('feOffset').attr('in', 'blur').attr('dx', 0).attr('dy', 0).attr('result', 'off')\r\n\r\n    // Keep only the blurred rim that lies INSIDE the circle\r\n    innerShadow\r\n        .append('feComposite')\r\n        .attr('in', 'SourceAlpha')\r\n        .attr('in2', 'off')\r\n        .attr('operator', 'arithmetic')\r\n        .attr('k2', '1') // + SourceAlpha\r\n        .attr('k3', '-1') // - blurred offset\r\n        .attr('result', 'inner')\r\n\r\n    innerShadow.append('feFlood').attr('flood-color', '#000').attr('flood-opacity', 0.4)\r\n\r\n    innerShadow.append('feComposite').attr('in2', 'inner').attr('operator', 'in').attr('result', 'shadow')\r\n\r\n    // Put shadow ON TOP of the fill (multiply for natural darkening)\r\n    innerShadow.append('feBlend').attr('in', 'SourceGraphic').attr('in2', 'shadow').attr('mode', 'multiply')\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n\r\nfunction debounce(func, wait) {\r\n    let timeout\r\n    return function (...args) {\r\n        clearTimeout(timeout)\r\n        timeout = setTimeout(() => func(...args), wait)\r\n    }\r\n}\r\n","import { zoom, zoomIdentity } from 'd3-zoom'\r\nimport { select } from 'd3-selection'\r\n\r\nexport const defineMapZoom = function (map) {\r\n    const svg = select('#' + map.svgId())\r\n    let previousT = zoomIdentity\r\n    let panUnlocked = !map.lockPanUntilZoom_\r\n    let snappingBack = false\r\n    const zoomExtent = map.zoomExtent_ || [0, 0]\r\n\r\n    // If the user allows zoom < 1 (e.g. [0.1, 10]), pad translateExtent based on kmin.\r\n    // This keeps panning possible even when zoomed out.\r\n    const kmin = Math.max(zoomExtent[0] || 1, 0.01)\r\n    const needsPad = kmin < 1\r\n    const panPadFactor = map.panPadFactor_ ?? 0.1\r\n    const padX = needsPad ? panPadFactor * (1 / kmin - 1) * map.width_ : map.width_\r\n    const padY = needsPad ? panPadFactor * (1 / kmin - 1) * map.height_ : map.height_\r\n\r\n    const translateExtent = map.translateExtent_\r\n        ? map.translateExtent_\r\n        : needsPad ? [[-padX, -padY], [map.width_ + padX, map.height_ + padY]] : [[0, 0], [map.width_, map.height_]]\r\n\r\n\r\n\r\n    map.__zoomBehavior = zoom()\r\n        .filter((e) => !e.target.closest('.em-zoom-buttons') && !e.target.closest('.em-button'))\r\n        .extent([\r\n            [0, 0],\r\n            [map.width_, map.height_],\r\n        ])\r\n        .scaleExtent(zoomExtent)\r\n        .translateExtent(translateExtent)\r\n\r\n        .on('start', (e) => {\r\n            if (e.sourceEvent && e.sourceEvent.type !== 'wheel') {\r\n                svg.classed('em-dragging', true);\r\n            }\r\n        })\r\n\r\n        .on('zoom', (e) => {\r\n            const t = e.transform\r\n            const zoomGroup = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n\r\n            if (snappingBack) {\r\n                snappingBack = false\r\n                return\r\n            }\r\n\r\n            map.__lastTransform = t\r\n\r\n            if (t.k !== previousT.k) {\r\n                if (map.lockPanUntilZoom_) panUnlocked = true\r\n                zoomHandler(e, previousT, map)\r\n                zoomGroup.attr('data-zoom', t.k).attr('transform', t)\r\n                previousT = t\r\n            } else if (!map.lockPanUntilZoom_ || panUnlocked) {\r\n                panHandler(e, map)\r\n                zoomGroup.attr('transform', t)\r\n                previousT = t\r\n            } else {\r\n                snappingBack = true\r\n                svg.call(map.__zoomBehavior.transform, previousT)\r\n            }\r\n        })\r\n        .on('end', (e) => {\r\n            svg.classed('em-dragging', false);\r\n            map.onZoomEnd_?.(e, map);\r\n            window.dispatchEvent(new CustomEvent('estatmap:zoomend-' + map.svgId_, { detail: map }))\r\n        });\r\n\r\n    map.__lastTransform = previousT\r\n\r\n    // Compute baseline metres per pixel (k=1) from left/right edges\r\n    if (!map.__baseZ) {\r\n        const centerY = map.height_ / 2\r\n        const [geoLeftX] = map._projection.invert([0, centerY])\r\n        const [geoRightX] = map._projection.invert([map.width_, centerY])\r\n        map.__baseZ = (geoRightX - geoLeftX) / map.width_\r\n    }\r\n\r\n    svg.call(map.__zoomBehavior)\r\n}\r\n\r\nexport function setMapView(map, pos) {\r\n    if (!map.svg_ || !map.__zoomBehavior) return\r\n    const svg = map.svg_\r\n    const zoomGroup = svg.select('#em-zoom-group-' + map.svgId_)\r\n\r\n    const k = map.__baseZ / pos.z\r\n    const [projX, projY] = map._projection([pos.x, pos.y])\r\n    const tx = map.width_ / 2 - projX * k\r\n    const ty = map.height_ / 2 - projY * k\r\n\r\n    const newTransform = zoomIdentity.translate(tx, ty).scale(k)\r\n    map.__programmaticZoom = { x: pos.x, y: pos.y, z: pos.z }\r\n    map.__lastTransform = newTransform\r\n\r\n    svg.call(map.__zoomBehavior.transform, newTransform)\r\n    zoomGroup.attr('data-zoom', k)\r\n\r\n    map.position_.x = pos.x\r\n    map.position_.y = pos.y\r\n    map.position_.z = pos.z\r\n}\r\n\r\nconst panHandler = (event, map) => {\r\n    const t = event.transform\r\n    const cx = (map.width_ / 2 - t.x) / t.k\r\n    const cy = (map.height_ / 2 - t.y) / t.k\r\n    const [geoX, geoY] = map._projection.invert([cx, cy])\r\n\r\n    map.position_.x = geoX\r\n    map.position_.y = geoY\r\n\r\n    window.dispatchEvent(new CustomEvent('estatmap:zoomed-' + map.svgId_, { detail: map }))\r\n    if (typeof map.onZoom_ === 'function') map.onZoom_(event, map) // <--- new hook. user defined\r\n}\r\n\r\nconst zoomHandler = (event, previousT, map) => {\r\n    const t = event.transform\r\n    const cx = (map.width_ / 2 - t.x) / t.k\r\n    const cy = (map.height_ / 2 - t.y) / t.k\r\n    const [projectedX, projectedY] = map._projection.invert([cx, cy])\r\n\r\n    if (map.__programmaticZoom) {\r\n        const p = map.__programmaticZoom\r\n        map.position_.x = p.x\r\n        map.position_.y = p.y\r\n        map.position_.z = p.z\r\n        delete map.__programmaticZoom\r\n    } else {\r\n        map.position_.x = projectedX\r\n        map.position_.y = projectedY\r\n        map.position_.z = map.__baseZ / t.k\r\n    }\r\n\r\n    //  Store current zoom scale for later use (hover, click, etc.)\r\n    map._lastZoomK = t.k;\r\n\r\n    scaleStrokeWidths(t, map)\r\n    if (map.labels_?.values) scaleLabelTexts(t, map)\r\n    if (map.labels_?.backgrounds) scaleLabelBackgrounds(t, map)\r\n\r\n    window.dispatchEvent(new CustomEvent('estatmap:zoomed-' + map.svgId_, { detail: map }))\r\n    if (typeof map.onZoom_ === 'function') map.onZoom_(event, map) // <--- new hook. user defined\r\n}\r\n\r\n/**\r\n * @description adjusts text elements dynamically according to zoom\r\n * @param {*} transform\r\n */\r\nconst scaleLabelBackgrounds = function (transform, map) {\r\n    const zoomGroup = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n    const elements = zoomGroup.selectAll('.em-label-background')\r\n    const zoomFactor = transform.k\r\n    const updates = []\r\n\r\n    elements.each(function () {\r\n        const element = select(this)\r\n        // Get the original width, height, x, and y from data attributes or current attributes\r\n        const originalWidth = parseFloat(element.attr('data-width')) || parseFloat(element.attr('width'))\r\n        const originalHeight = parseFloat(element.attr('data-height')) || parseFloat(element.attr('height'))\r\n        const originalX = parseFloat(element.attr('data-x')) || parseFloat(element.attr('x'))\r\n        const originalY = parseFloat(element.attr('data-y')) || parseFloat(element.attr('y'))\r\n\r\n        // Only process elements that have valid width, height, x, and y\r\n        if (originalWidth > 0 && originalHeight > 0 && !isNaN(originalX) && !isNaN(originalY)) {\r\n            // Store the original width, height, x, and y for the first time if not already stored\r\n            if (!element.attr('data-width')) {\r\n                element.attr('data-width', originalWidth)\r\n                element.attr('data-height', originalHeight)\r\n                element.attr('data-x', originalX)\r\n                element.attr('data-y', originalY)\r\n            }\r\n\r\n            // Calculate the target width, height, x, and y based on zoom factor (inverse scaling)\r\n            const targetWidth = originalWidth * (1 / zoomFactor) // Inverse scaling\r\n            const targetHeight = originalHeight * (1 / zoomFactor) // Inverse scaling\r\n            const targetX = originalX * (1 / zoomFactor) // Adjust x position\r\n            const targetY = originalY * (1 / zoomFactor) // Adjust y position\r\n\r\n            // Add the style change to a batch array\r\n            updates.push({ element, targetWidth, targetHeight, targetX, targetY })\r\n        }\r\n    })\r\n\r\n    // Apply all style changes at once\r\n    updates.forEach(({ element, targetWidth, targetHeight, targetX, targetY }) => {\r\n        element.attr('width', targetWidth).attr('height', targetHeight).attr('x', targetX).attr('y', targetY)\r\n    })\r\n}\r\n/**\r\n * @description adjusts text elements dynamically according to zoom\r\n * @param {*} transform\r\n */\r\nconst scaleLabelTexts = function (transform, map) {\r\n    const zoomGroup = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n    const labels = zoomGroup.select('#em-labels')\r\n    const elements = labels.selectAll('*') // Select all labels\r\n    const zoomFactor = transform.k\r\n    const updates = []\r\n\r\n    elements.each(function () {\r\n        const element = select(this)\r\n        const computedStyle = window.getComputedStyle(this)\r\n\r\n        // Get font-size from inline or computed style\r\n        const inlineFontSize = element.attr('font-size')\r\n        const cssFontSize = computedStyle.fontSize\r\n        const fontSize = inlineFontSize || cssFontSize\r\n\r\n        // Only process elements that have a font size defined\r\n        if (fontSize && parseFloat(fontSize) > 0) {\r\n            const originalFontSize = parseFloat(element.attr('data-fs')) || parseFloat(inlineFontSize) || parseFloat(cssFontSize)\r\n\r\n            // Store the original font size for the first time\r\n            if (!element.attr('data-fs')) {\r\n                element.attr('data-fs', originalFontSize)\r\n            }\r\n\r\n            // Calculate the target font size based on zoom factor\r\n            const targetFontSize = originalFontSize / zoomFactor\r\n\r\n            // Add the style change to a batch array\r\n            updates.push({ element: this, targetFontSize })\r\n        }\r\n    })\r\n\r\n    // Apply all style changes at once\r\n    updates.forEach(({ element, targetFontSize }) => {\r\n        element.style.setProperty('font-size', `${targetFontSize}px`, 'important')\r\n    })\r\n}\r\n\r\n/**\r\n * @description adjusts all stroke-widths dynamically according to zoom\r\n * @param {*} transform\r\n */\r\nconst scaleStrokeWidths = function (transform, map) {\r\n    const zoomGroup = map.svg_.select('#em-zoom-group-' + map.svgId_)\r\n    const elements = zoomGroup.selectAll('*') // Select all elements in the zoom group\r\n    const zoomFactor = transform.k\r\n    const updates = []\r\n\r\n    elements.each(function () {\r\n        const element = select(this)\r\n        const computedStyle = window.getComputedStyle(this)\r\n\r\n        // Get stroke-width from inline or computed style\r\n        const inlineStrokeWidth = element.attr('stroke-width')\r\n        const cssStrokeWidth = computedStyle.strokeWidth\r\n        const strokeWidth = inlineStrokeWidth || cssStrokeWidth\r\n\r\n        // Only process elements that have a stroke width defined\r\n        if (strokeWidth && parseFloat(strokeWidth) > 0) {\r\n            const originalStrokeWidth = parseFloat(element.attr('data-sw')) || parseFloat(inlineStrokeWidth) || parseFloat(cssStrokeWidth)\r\n\r\n            // Store the original stroke width for the first time\r\n            if (!element.attr('data-sw')) {\r\n                element.attr('data-sw', originalStrokeWidth)\r\n            }\r\n\r\n            // Calculate the target stroke width\r\n            const targetStrokeWidth = originalStrokeWidth / zoomFactor\r\n\r\n            // Add the style change to a batch array\r\n            updates.push({ element: this, targetStrokeWidth })\r\n        }\r\n    })\r\n\r\n    // Apply all style changes at once\r\n    updates.forEach(({ element, targetStrokeWidth }) => {\r\n        element.style.setProperty('stroke-width', `${targetStrokeWidth}px`, 'important')\r\n    })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { getCSSPropertyFromClass } from '../utils'\r\n\r\nexport const appendInsetsButton = (map) => {\r\n    const svg = select('#' + map.svgId())\r\n\r\n    const buttonSize = parseInt(getCSSPropertyFromClass('em-button', 'width')) || 30 // Default to 30px if not set\r\n\r\n    const insetButton = svg.append('g').attr('class', 'em-insets-button em-button').attr('id', 'em-insets-button')\r\n    //tooltip\r\n    insetButton.append('title').text('Show/hide inset maps')\r\n    // Add rectangle for button background\r\n    insetButton.append('rect').attr('width', buttonSize).attr('height', buttonSize)\r\n    // Add Font Awesome copyright comment\r\n    const comment = document.createComment(\r\n        '!Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.'\r\n    )\r\n    insetButton.node().appendChild(comment)\r\n    // Add globe icon\r\n    const scale = buttonSize / 700\r\n    const iconCenter = 256\r\n    insetButton\r\n        .append('path')\r\n        .attr(\r\n            'd',\r\n            'M266.3 48.3L232.5 73.6c-5.4 4-8.5 10.4-8.5 17.1l0 9.1c0 6.8 5.5 12.3 12.3 12.3c2.4 0 4.8-.7 6.8-2.1l41.8-27.9c2-1.3 4.4-2.1 6.8-2.1l1 0c6.2 0 11.3 5.1 11.3 11.3c0 3-1.2 5.9-3.3 8l-19.9 19.9c-5.8 5.8-12.9 10.2-20.7 12.8l-26.5 8.8c-5.8 1.9-9.6 7.3-9.6 13.4c0 3.7-1.5 7.3-4.1 10l-17.9 17.9c-6.4 6.4-9.9 15-9.9 24l0 4.3c0 16.4 13.6 29.7 29.9 29.7c11 0 21.2-6.2 26.1-16l4-8.1c2.4-4.8 7.4-7.9 12.8-7.9c4.5 0 8.7 2.1 11.4 5.7l16.3 21.7c2.1 2.9 5.5 4.5 9.1 4.5c8.4 0 13.9-8.9 10.1-16.4l-1.1-2.3c-3.5-7 0-15.5 7.5-18l21.2-7.1c7.6-2.5 12.7-9.6 12.7-17.6c0-10.3 8.3-18.6 18.6-18.6l29.4 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-20.7 0c-7.2 0-14.2 2.9-19.3 8l-4.7 4.7c-2.1 2.1-3.3 5-3.3 8c0 6.2 5.1 11.3 11.3 11.3l11.3 0c6 0 11.8 2.4 16 6.6l6.5 6.5c1.8 1.8 2.8 4.3 2.8 6.8s-1 5-2.8 6.8l-7.5 7.5C386 262 384 266.9 384 272s2 10 5.7 13.7L408 304c10.2 10.2 24.1 16 38.6 16l7.3 0c6.5-20.2 10-41.7 10-64c0-111.4-87.6-202.4-197.7-207.7zm172 307.9c-3.7-2.6-8.2-4.1-13-4.1c-6 0-11.8-2.4-16-6.6L396 332c-7.7-7.7-18-12-28.9-12c-9.7 0-19.2-3.5-26.6-9.8L314 287.4c-11.6-9.9-26.4-15.4-41.7-15.4l-20.9 0c-12.6 0-25 3.7-35.5 10.7L188.5 301c-17.8 11.9-28.5 31.9-28.5 53.3l0 3.2c0 17 6.7 33.3 18.7 45.3l16 16c8.5 8.5 20 13.3 32 13.3l21.3 0c13.3 0 24 10.7 24 24c0 2.5 .4 5 1.1 7.3c71.3-5.8 132.5-47.6 165.2-107.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM187.3 100.7c-6.2-6.2-16.4-6.2-22.6 0l-32 32c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0l32-32c6.2-6.2 6.2-16.4 0-22.6z'\r\n        )\r\n        .attr('transform', `translate(${buttonSize / 2}, ${buttonSize / 2}) scale(${scale}) translate(${-iconCenter}, ${-iconCenter})`)\r\n        .attr('fill', '#333') // Adjust as needed\r\n        .attr('pointer-events', 'none') // So the path doesn't interfere with click\r\n\r\n    insetButton.on('click', function (event) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        //show or hide insets\r\n        let container = svg.select('#em-insets-group')\r\n        if (container.style('display') === 'none' || container.style('display') === '') {\r\n            container.style('display', 'block')\r\n        } else {\r\n            container.style('display', 'none')\r\n        }\r\n    })\r\n}\r\n","import dsv from \"./dsv.js\";\n\nvar tsv = dsv(\"\\t\");\n\nexport var tsvParse = tsv.parse;\nexport var tsvParseRows = tsv.parseRows;\nexport var tsvFormat = tsv.format;\nexport var tsvFormatBody = tsv.formatBody;\nexport var tsvFormatRows = tsv.formatRows;\nexport var tsvFormatRow = tsv.formatRow;\nexport var tsvFormatValue = tsv.formatValue;\n","function responseText(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  return response.text();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseText);\n}\n","import {csvParse, dsvFormat, tsvParse} from \"d3-dsv\";\nimport text from \"./text.js\";\n\nfunction dsvParse(parse) {\n  return function(input, init, row) {\n    if (arguments.length === 2 && typeof init === \"function\") row = init, init = undefined;\n    return text(input, init).then(function(response) {\n      return parse(response, row);\n    });\n  };\n}\n\nexport default function dsv(delimiter, input, init, row) {\n  if (arguments.length === 3 && typeof init === \"function\") row = init, init = undefined;\n  var format = dsvFormat(delimiter);\n  return text(input, init).then(function(response) {\n    return format.parse(response, row);\n  });\n}\n\nexport var csv = dsvParse(csvParse);\nexport var tsv = dsvParse(tsvParse);\n","import proj4 from 'proj4'\r\n\r\nexport function initProj4() {\r\n    // Load proj4 definitions for dynamic minimaps that are linked to the main map view and also for placename labels\r\n\r\n    // 3035 LAEA projection\r\n    proj4.defs('EPSG:3035', '+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs')\r\n\r\n    // 54030 Robinson projection\r\n    proj4.defs('EPSG:54030', '+proj=robin +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs')\r\n}\r\n\r\n// Export helper for convenience\r\nexport const projectToMap = (map, lon, lat) => {\r\n    switch (map.proj_) {\r\n        case '3035':\r\n            return proj4('EPSG:4326', 'EPSG:3035', [lon, lat])\r\n        case '54030':\r\n            return proj4('EPSG:4326', 'EPSG:54030', [lon, lat])\r\n        default:\r\n            return [lon, lat] // already in map coords\r\n    }\r\n}\r\n\r\n// Optionally also export the inverse for things like minimap center\r\nexport const projectFromMap = (map, x, y) => {\r\n    switch (map.proj_) {\r\n        case '3035':\r\n            return proj4('EPSG:3035', 'EPSG:4326', [x, y])\r\n        case '54030':\r\n            return proj4('EPSG:54030', 'EPSG:4326', [x, y])\r\n        default:\r\n            return [x, y]\r\n    }\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { csv } from 'd3-fetch'\r\nimport { projectToMap } from './proj4'\r\nimport { get } from 'idb-keyval'\r\n\r\nconst PLACENAMESURL = window.location.hostname.includes('ec.europa.eu')\r\n    ? 'https://ec.europa.eu/assets/estat/E/E4/gisco/pub/euronym/v3/UTF_LATIN/50/EUR.csv'\r\n    : 'https://raw.githubusercontent.com/eurostat/euronym/main/pub/v3/UTF_LATIN/50/EUR.csv'\r\n\r\n// Load once and store all labels\r\nexport async function loadPlacenames(out, url = PLACENAMESURL) {\r\n    const raw = await csv(url)\r\n    let filtered = raw\r\n    if (out.placenamesFilter_) filtered = out.placenamesFilter_(raw)\r\n    out._placenameLabels = filtered\r\n    return filtered\r\n}\r\n\r\nexport async function addPlacenameLabels(out) {\r\n    if (!out._placenameLabels) {\r\n        await loadPlacenames(out)\r\n    }\r\n\r\n    // Initial append\r\n    appendPlacenameLabels(out)\r\n\r\n    // Update on zoom/pan\r\n    window.addEventListener('estatmap:zoomend-' + out.svgId_, (e) => {\r\n        updatePlacenameLabels(e.detail, e.detail.__lastTransform)\r\n    })\r\n}\r\n\r\n/**\r\n * Append filtered placenames to SVG and scale immediately based on zoom.\r\n */\r\nexport function appendPlacenameLabels(out) {\r\n    const svg = out.svg_\r\n    const zoomFactor = out.__lastTransform?.k || 1 // current zoom scale\r\n\r\n    const filtered = getFilteredPlacenames(out)\r\n    console.log(`Filtered ${filtered.length} placenames for zoom level ${zoomFactor}`)\r\n\r\n    // Remove old\r\n    svg.select('#em-placenames').remove()\r\n\r\n    // Append group\r\n    const group = svg\r\n        .select('#em-zoom-group-' + out.svgId_)\r\n        .append('g')\r\n        .attr('id', 'em-placenames')\r\n        .attr('class', 'em-placenames')\r\n        .attr('pointer-events', 'none')\r\n\r\n    // Join texts\r\n    const texts = group\r\n        .selectAll('text')\r\n        .data(filtered)\r\n        .join('text')\r\n        .attr('x', (d) => d.screenX)\r\n        .attr('y', (d) => d.screenY)\r\n        .text((d) => d.name)\r\n        .attr('class', 'em-placename')\r\n        // Font-size scaled immediately based on zoom\r\n        .attr('font-size', (d) => `${(13 * d.sizeFactor) / zoomFactor}px`)\r\n        .attr('font-weight', (d) => (d.sizeFactor > 1 ? 'bold' : 'normal'))\r\n        .attr('dy', '-0.35em')\r\n\r\n    // Halo for readability, scaled with zoom\r\n    const baseStrokeWidth = 3\r\n    texts\r\n        .clone(true)\r\n        .lower()\r\n        .attr('class', 'em-placename-halo')\r\n        .attr('stroke-width', baseStrokeWidth / zoomFactor)\r\n\r\n    out.placenameGroup_ = group\r\n}\r\n\r\nconst getFilteredPlacenames = function (out) {\r\n    if (!out._placenameLabels) return []\r\n\r\n    const projection = out._projection\r\n    const width = out.width_\r\n    const height = out.height_\r\n    const resolution = out.position_.z\r\n    const padding = 30\r\n    const maxLabels = 500\r\n\r\n    const t = out.__lastTransform || { k: 1, x: 0, y: 0 }\r\n\r\n    // --- visible viewport in BASE SVG COORDS ---\r\n    const x0 = t.invertX(0) - padding\r\n    const y0 = t.invertY(0) - padding\r\n    const x1 = t.invertX(width) + padding\r\n    const y1 = t.invertY(height) + padding\r\n\r\n    const filtered = []\r\n\r\n    for (const d of out._placenameLabels) {\r\n        const rs = +d.rs\r\n        const r1 = +d.r1\r\n        if (!rs || resolution > rs) continue\r\n\r\n        const lon = +d.lon\r\n        const lat = +d.lat\r\n\r\n        // 4326  map CRS  base SVG\r\n        const [xMap, yMap] = projectToMap(out, lon, lat)\r\n        const [sx, sy] = projection([xMap, yMap])\r\n\r\n        // viewport test in BASE coords\r\n        if (sx < x0 || sx > x1 || sy < y0 || sy > y1) continue\r\n\r\n        filtered.push({\r\n            ...d,\r\n            screenX: sx,   // unchanged\r\n            screenY: sy,   // unchanged\r\n            sizeFactor: resolution > r1 ? 1 : 1.1,\r\n        })\r\n\r\n        if (filtered.length >= maxLabels) break\r\n    }\r\n\r\n    console.log(`After filtering, ${filtered.length} placenames remain.`)\r\n    return filtered\r\n}\r\n\r\n\r\n/**\r\n * Recompute label positions & size on zoom/pan\r\n */\r\nexport function updatePlacenameLabels(out, transform, maxLabels = 2000, padding = 10) {\r\n    if (!out._placenameLabels || !out._projection) return\r\n    appendPlacenameLabels(out, maxLabels, padding)\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { executeForAllInsets } from './utils'\r\n\r\nexport function appendCoastalMargin(out) {\r\n    if (!out.svg_ || !out._pathFunction) return\r\n\r\n    const draw = (map) => {\r\n        const zg = select('#em-zoom-group-' + map.svgId_)\r\n        if (zg.empty()) return\r\n\r\n        // Remove only within THIS zoom group\r\n        zg.select('.em-coastal-margin').remove()\r\n\r\n        if (!map.drawCoastalMargin_) return\r\n\r\n        // Ensure filter once (SVG-level)\r\n        ensureCoastalMarginFilter(map.svg_, map.coastalMarginSettings_)\r\n\r\n        // Create margin group\r\n        const cg = zg\r\n            .append('g')\r\n            .attr('class', 'em-coastal-margin')\r\n            .attr('filter', 'url(#em-coastal-margin-filter)')\r\n            .attr('fill', 'none')\r\n            .style('stroke', map.coastalMarginSettings_.color)\r\n            .style('stroke-width', map.coastalMarginSettings_.strokeWidth)\r\n            .style('opacity', map.coastalMarginSettings_.opacity)\r\n            .attr('pointer-events', 'none')\r\n\r\n        // Helper\r\n        const drawPaths = (features, predicate, cls) => {\r\n            if (!features) return\r\n            cg.append('g').attr('class', cls).selectAll('path').data(features.filter(predicate)).enter().append('path').attr('d', map._pathFunction)\r\n        }\r\n\r\n        drawPaths(map.Geometries.geoJSONs.cntbn, (d) => d.properties.co === 'T', 'em-coastal-margin-cnt')\r\n\r\n        drawPaths(map.Geometries.geoJSONs.nutsbn, (d) => d.properties.co === 'T', 'em-coastal-margin-nuts')\r\n\r\n        drawPaths(map.Geometries.geoJSONs.worldbn, (d) => d.properties.COAS_FLAG === 'T', 'em-coastal-margin-world')\r\n\r\n        // Z-order: above sea, below land\r\n        const parent = cg.node().parentNode\r\n        const refIndex = map.geo_ === 'WORLD' ? 3 : 1\r\n        if (parent.childNodes[refIndex]) {\r\n            parent.insertBefore(cg.node(), parent.childNodes[refIndex])\r\n        }\r\n    }\r\n\r\n    // Insets first (their own SVGs)\r\n    if (out.insetTemplates_) {\r\n        executeForAllInsets(out.insetTemplates_, out.svgId_, draw)\r\n    }\r\n\r\n    // Main map\r\n    draw(out)\r\n}\r\n\r\nfunction ensureCoastalMarginFilter(svg, settings) {\r\n    const defs = svg.select('defs').empty() ? svg.append('defs') : svg.select('defs')\r\n\r\n    if (!defs.select('#em-coastal-margin-filter').empty()) return\r\n\r\n    const filter = defs\r\n        .append('filter')\r\n        .attr('id', 'em-coastal-margin-filter')\r\n        .attr('x', '-50%')\r\n        .attr('y', '-50%')\r\n        .attr('width', '200%')\r\n        .attr('height', '200%')\r\n\r\n    // Outer glow\r\n    filter.append('feGaussianBlur').attr('in', 'SourceGraphic').attr('stdDeviation', settings.standardDeviation).attr('result', 'blur')\r\n\r\n    // Fade it\r\n    filter\r\n        .append('feColorMatrix')\r\n        .attr('in', 'blur')\r\n        .attr('type', 'matrix')\r\n        .attr(\r\n            'values',\r\n            `\r\n            1 0 0 0 0\r\n            0 1 0 0 0\r\n            0 0 1 0 0\r\n            0 0 0 ${settings.opacity ?? 0.4} 0\r\n        `\r\n        )\r\n        .attr('result', 'blurred')\r\n\r\n    // Merge sharp line back on top\r\n    const merge = filter.append('feMerge')\r\n    merge.append('feMergeNode').attr('in', 'blurred')\r\n    merge.append('feMergeNode').attr('in', 'SourceGraphic')\r\n}\r\n","/**\r\n * @function addScalebarToMap\r\n * @description appends an SVG scalebar to the map. Uses pixelSize to calculate units in km\r\n */\r\nexport const addScalebarToMap = function (out) {\r\n    // Julien's nice scalebars\r\n    const marginLeft = 5\r\n    const maxLengthPix = out.scalebarMaxWidth_\r\n    const textOffsetX = out.scalebarTextOffset_[0]\r\n    const textOffsetY = out.scalebarTextOffset_[1]\r\n    const pixelSizeM = out.position_.z\r\n    const maxLengthM = maxLengthPix * pixelSizeM\r\n    const niceLengthM = niceScaleBarLength(maxLengthM)\r\n    const niceLengthPixel = niceLengthM[0] / pixelSizeM\r\n    const scaleBarStartDigit = niceLengthM[1]\r\n    const subdivisionNbs = {\r\n        1: 4,\r\n        2: 2,\r\n        5: 5,\r\n    }\r\n\r\n    const scalebarGroup = out\r\n        .svg()\r\n        .append('g')\r\n        .attr('class', 'em-scalebar')\r\n        .attr('transform', `translate(${out.scalebarPosition_[0]},${out.scalebarPosition_[1]})`)\r\n        .attr('width', maxLengthPix + 20)\r\n        .attr('height', out.scalebarHeight_)\r\n\r\n    // top line full width\r\n    // scalebarGroup\r\n    //     .append('line')\r\n    //     .attr('class', 'em-scalebar-line')\r\n    //     .attr('x1', marginLeft)\r\n    //     .attr('y1', 1)\r\n    //     .attr('x2', niceLengthPixel + marginLeft)\r\n    //     .attr('y2', 1)\r\n\r\n    //bottom line full width\r\n    // scalebarGroup\r\n    //     .append('line')\r\n    //     .attr('class', 'em-scalebar-line')\r\n    //     .attr('x1', marginLeft)\r\n    //     .attr('y1', out.scalebarSegmentHeight_)\r\n    //     .attr('x2', niceLengthPixel + marginLeft)\r\n    //     .attr('y2', out.scalebarSegmentHeight_)\r\n\r\n    //first tick\r\n    scalebarGroup\r\n        .append('line')\r\n        .attr('class', 'em-scalebar-line')\r\n        .attr('x1', marginLeft)\r\n        .attr('y1', 1)\r\n        .attr('x2', marginLeft)\r\n        .attr('y2', out.scalebarTickHeight_)\r\n\r\n    scalebarGroup\r\n        .append('text')\r\n        .attr('class', 'em-scalebar-label')\r\n        .attr('x', marginLeft + textOffsetX)\r\n        .attr('y', out.scalebarTickHeight_ + textOffsetY)\r\n        .text('0')\r\n\r\n    //middle ticks\r\n    const subdivisionNb = subdivisionNbs[scaleBarStartDigit]\r\n    const divisionWidth = niceLengthPixel / subdivisionNb\r\n    const divisionMinWidth = 15\r\n    const midlineY = out.scalebarSegmentHeight_ / 2 + 1\r\n    if (divisionWidth >= divisionMinWidth) {\r\n        for (let i = 1; i < subdivisionNb; i++) {\r\n            scalebarGroup\r\n                .append('line')\r\n                .attr('class', 'em-scalebar-line')\r\n                .attr('x1', marginLeft + out.scalebarStrokeWidth_ / 2 + i * divisionWidth)\r\n                .attr('y1', 1)\r\n                .attr('x2', marginLeft + out.scalebarStrokeWidth_ / 2 + i * divisionWidth)\r\n                .attr('y2', out.scalebarTickHeight_)\r\n            scalebarGroup\r\n                .append('text')\r\n                .attr('class', 'em-scalebar-label')\r\n                .attr('x', marginLeft + textOffsetX + i * divisionWidth)\r\n                .attr('y', out.scalebarTickHeight_ + textOffsetY)\r\n                .text(getScalebarLabel((niceLengthM[0] / subdivisionNb) * i))\r\n\r\n            if (i == 1) {\r\n                scalebarGroup\r\n                    .append('line')\r\n                    .attr('class', 'em-scalebar-line em-scalebar-midline')\r\n                    .attr('x1', marginLeft + out.scalebarStrokeWidth_ - 1)\r\n                    .attr('y1', midlineY)\r\n                    .attr('x2', marginLeft + out.scalebarStrokeWidth_ / 2 + i * divisionWidth)\r\n                    .attr('y2', midlineY)\r\n            } else {\r\n                let x1 = marginLeft + out.scalebarStrokeWidth_ / 2 + (i - 1) * divisionWidth\r\n                if (x1 > 0) {\r\n                    scalebarGroup\r\n                        .append('line')\r\n                        .attr('class', 'em-scalebar-line em-scalebar-midline')\r\n                        .attr('x1', x1)\r\n                        .attr('y1', midlineY)\r\n                        .attr('x2', marginLeft + out.scalebarStrokeWidth_ / 2 + i * divisionWidth)\r\n                        .attr('y2', midlineY)\r\n                }\r\n            }\r\n        }\r\n\r\n        // Draw final midline segment (last segment)\r\n        if (divisionWidth >= divisionMinWidth) {\r\n            scalebarGroup\r\n                .append('line')\r\n                .attr('class', 'em-scalebar-line em-scalebar-midline')\r\n                .attr('x1', marginLeft + (subdivisionNb - 1) * divisionWidth)\r\n                .attr('y1', midlineY)\r\n                .attr('x2', marginLeft + subdivisionNb * divisionWidth)\r\n                .attr('y2', midlineY)\r\n        }\r\n    } else {\r\n        // single full-length horizontal mid-line\r\n        scalebarGroup\r\n            .append('line')\r\n            .attr('class', 'em-scalebar-line em-scalebar-midline')\r\n            .attr('x1', marginLeft + out.scalebarStrokeWidth_ - 1)\r\n            .attr('y1', midlineY)\r\n            .attr('x2', marginLeft + out.scalebarStrokeWidth_ / 2 + divisionWidth * subdivisionNb)\r\n            .attr('y2', midlineY)\r\n    }\r\n\r\n    //last tick\r\n    scalebarGroup\r\n        .append('line')\r\n        .attr('class', 'em-scalebar-line')\r\n        .attr('x1', niceLengthPixel + marginLeft)\r\n        .attr('y1', 1)\r\n        .attr('x2', niceLengthPixel + marginLeft)\r\n        .attr('y2', out.scalebarTickHeight_)\r\n    scalebarGroup\r\n        .append('text')\r\n        .attr('class', 'em-scalebar-label')\r\n        .attr('x', niceLengthPixel + marginLeft + textOffsetX)\r\n        .attr('y', out.scalebarTickHeight_ + textOffsetY)\r\n        .text(getScalebarLabel(niceLengthM[0]) + out.scalebarUnits_)\r\n}\r\n\r\nconst niceScaleBarLength = function (scaleBarLength) {\r\n    //compute the 'nice' power of ten\r\n    const pow10 = Math.pow(10, Math.floor(Math.log(scaleBarLength) / Math.log(10)))\r\n\r\n    //check if 5 times this value fits\r\n    if (5 * pow10 <= scaleBarLength) return [5 * pow10, 5]\r\n\r\n    //check if 2 times this value fits\r\n    if (2 * pow10 <= scaleBarLength) return [2 * pow10, 2]\r\n\r\n    //returns the power of ten\r\n    return [pow10, 1]\r\n}\r\n\r\nconst getScalebarLabel = function (valueM) {\r\n    if (valueM < 0.01) return valueM * 1000 + 'mm'\r\n    if (valueM < 1) return valueM * 100 + 'cm'\r\n    if (valueM < 1000) return valueM * 1 + 'm'\r\n    return valueM / 1000\r\n}","/**\n * [Simple linear regression](http://en.wikipedia.org/wiki/Simple_linear_regression)\n * is a simple way to find a fitted line\n * between a set of coordinates. This algorithm finds the slope and y-intercept of a regression line\n * using the least sum of squares.\n *\n * @param {Array<Array<number>>} data an array of two-element of arrays,\n * like `[[0, 1], [2, 3]]`\n * @returns {Object} object containing slope and intersect of regression line\n * @example\n * linearRegression([[0, 0], [1, 1]]); // => { m: 1, b: 0 }\n */\nfunction linearRegression(data) {\n    var m;\n    var b;\n\n    // Store data length in a local variable to reduce\n    // repeated object property lookups\n    var dataLength = data.length;\n\n    //if there's only one point, arbitrarily choose a slope of 0\n    //and a y-intercept of whatever the y of the initial point is\n    if (dataLength === 1) {\n        m = 0;\n        b = data[0][1];\n    } else {\n        // Initialize our sums and scope the `m` and `b`\n        // variables that define the line.\n        var sumX = 0;\n        var sumY = 0;\n        var sumXX = 0;\n        var sumXY = 0;\n\n        // Use local variables to grab point values\n        // with minimal object property lookups\n        var point;\n        var x;\n        var y;\n\n        // Gather the sum of all x values, the sum of all\n        // y values, and the sum of x^2 and (x*y) for each\n        // value.\n        //\n        // In math notation, these would be SS_x, SS_y, SS_xx, and SS_xy\n        for (var i = 0; i < dataLength; i++) {\n            point = data[i];\n            x = point[0];\n            y = point[1];\n\n            sumX += x;\n            sumY += y;\n\n            sumXX += x * x;\n            sumXY += x * y;\n        }\n\n        // `m` is the slope of the regression line\n        m =\n            (dataLength * sumXY - sumX * sumY) /\n            (dataLength * sumXX - sumX * sumX);\n\n        // `b` is the y-intercept of the line.\n        b = sumY / dataLength - (m * sumX) / dataLength;\n    }\n\n    // Return both values as an object.\n    return {\n        m: m,\n        b: b\n    };\n}\n\n/**\n * Given the output of `linearRegression`: an object\n * with `m` and `b` values indicating slope and intercept,\n * respectively, generate a line function that translates\n * x values into y values.\n *\n * @param {Object} mb object with `m` and `b` members, representing\n * slope and intersect of desired line\n * @returns {Function} method that computes y-value at any given\n * x-value on the line.\n * @example\n * var l = linearRegressionLine(linearRegression([[0, 0], [1, 1]]));\n * l(0) // = 0\n * l(2) // = 2\n * linearRegressionLine({ b: 0, m: 1 })(1); // => 1\n * linearRegressionLine({ b: 1, m: 1 })(1); // => 2\n */\nfunction linearRegressionLine(mb /*: { b: number, m: number }*/) {\n    // Return a function that computes a `y` value for each\n    // x value it is given, based on the values of `b` and `a`\n    // that we just computed.\n    return function (x) {\n        return mb.b + mb.m * x;\n    };\n}\n\n/**\n * Our default sum is the [Kahan-Babuska algorithm](https://pdfs.semanticscholar.org/1760/7d467cda1d0277ad272deb2113533131dc09.pdf).\n * This method is an improvement over the classical\n * [Kahan summation algorithm](https://en.wikipedia.org/wiki/Kahan_summation_algorithm).\n * It aims at computing the sum of a list of numbers while correcting for\n * floating-point errors. Traditionally, sums are calculated as many\n * successive additions, each one with its own floating-point roundoff. These\n * losses in precision add up as the number of numbers increases. This alternative\n * algorithm is more accurate than the simple way of calculating sums by simple\n * addition.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x input\n * @return {number} sum of all input numbers\n * @example\n * sum([1, 2, 3]); // => 6\n */\nfunction sum(x) {\n    // If the array is empty, we needn't bother computing its sum\n    if (x.length === 0) {\n        return 0;\n    }\n\n    // Initializing the sum as the first number in the array\n    var sum = x[0];\n\n    // Keeping track of the floating-point error correction\n    var correction = 0;\n\n    var transition;\n\n    if (typeof sum !== \"number\") {\n        return Number.NaN;\n    }\n\n    for (var i = 1; i < x.length; i++) {\n        if (typeof x[i] !== \"number\") {\n            return Number.NaN;\n        }\n        transition = sum + x[i];\n\n        // Here we need to update the correction in a different fashion\n        // if the new absolute value is greater than the absolute sum\n        if (Math.abs(sum) >= Math.abs(x[i])) {\n            correction += sum - transition + x[i];\n        } else {\n            correction += x[i] - transition + sum;\n        }\n\n        sum = transition;\n    }\n\n    // Returning the corrected sum\n    return sum + correction;\n}\n\n/**\n * The mean, _also known as average_,\n * is the sum of all values over the number of values.\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @throws {Error} if the length of x is less than one\n * @returns {number} mean\n * @example\n * mean([0, 10]); // => 5\n */\nfunction mean(x) {\n    if (x.length === 0) {\n        throw new Error(\"mean requires at least one data point\");\n    }\n\n    return sum(x) / x.length;\n}\n\n/**\n * The sum of deviations to the Nth power.\n * When n=2 it's the sum of squared deviations.\n * When n=3 it's the sum of cubed deviations.\n *\n * @param {Array<number>} x\n * @param {number} n power\n * @returns {number} sum of nth power deviations\n *\n * @example\n * var input = [1, 2, 3];\n * // since the variance of a set is the mean squared\n * // deviations, we can calculate that with sumNthPowerDeviations:\n * sumNthPowerDeviations(input, 2) / input.length;\n */\nfunction sumNthPowerDeviations(x, n) {\n    var meanValue = mean(x);\n    var sum = 0;\n    var tempValue;\n    var i;\n\n    // This is an optimization: when n is 2 (we're computing a number squared),\n    // multiplying the number by itself is significantly faster than using\n    // the Math.pow method.\n    if (n === 2) {\n        for (i = 0; i < x.length; i++) {\n            tempValue = x[i] - meanValue;\n            sum += tempValue * tempValue;\n        }\n    } else {\n        for (i = 0; i < x.length; i++) {\n            sum += Math.pow(x[i] - meanValue, n);\n        }\n    }\n\n    return sum;\n}\n\n/**\n * The [variance](http://en.wikipedia.org/wiki/Variance)\n * is the sum of squared deviations from the mean.\n *\n * This is an implementation of variance, not sample variance:\n * see the `sampleVariance` method if you want a sample measure.\n *\n * @param {Array<number>} x a population of one or more data points\n * @returns {number} variance: a value greater than or equal to zero.\n * zero indicates that all values are identical.\n * @throws {Error} if x's length is 0\n * @example\n * variance([1, 2, 3, 4, 5, 6]); // => 2.9166666666666665\n */\nfunction variance(x) {\n    if (x.length === 0) {\n        throw new Error(\"variance requires at least one data point\");\n    }\n\n    // Find the mean of squared deviations between the\n    // mean value and each value.\n    return sumNthPowerDeviations(x, 2) / x.length;\n}\n\n/**\n * The [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)\n * is the square root of the variance. This is also known as the population\n * standard deviation. It's useful for measuring the amount\n * of variation or dispersion in a set of values.\n *\n * Standard deviation is only appropriate for full-population knowledge: for\n * samples of a population, {@link sampleStandardDeviation} is\n * more appropriate.\n *\n * @param {Array<number>} x input\n * @returns {number} standard deviation\n * @example\n * variance([2, 4, 4, 4, 5, 5, 7, 9]); // => 4\n * standardDeviation([2, 4, 4, 4, 5, 5, 7, 9]); // => 2\n */\nfunction standardDeviation(x) {\n    if (x.length === 1) {\n        return 0;\n    }\n    var v = variance(x);\n    return Math.sqrt(v);\n}\n\n/**\n * The [R Squared](http://en.wikipedia.org/wiki/Coefficient_of_determination)\n * value of data compared with a function `f`\n * is the sum of the squared differences between the prediction\n * and the actual value.\n *\n * @param {Array<Array<number>>} x input data: this should be doubly-nested\n * @param {Function} func function called on `[i][0]` values within the dataset\n * @returns {number} r-squared value\n * @example\n * var samples = [[0, 0], [1, 1]];\n * var regressionLine = linearRegressionLine(linearRegression(samples));\n * rSquared(samples, regressionLine); // = 1 this line is a perfect fit\n */\nfunction rSquared(x, func) {\n    if (x.length < 2) {\n        return 1;\n    }\n\n    // Compute the average y value for the actual\n    // data set in order to compute the\n    // _total sum of squares_\n    var sum = 0;\n    for (var i = 0; i < x.length; i++) {\n        sum += x[i][1];\n    }\n    var average = sum / x.length;\n\n    // Compute the total sum of squares - the\n    // squared difference between each point\n    // and the average of all points.\n    var sumOfSquares = 0;\n    for (var j = 0; j < x.length; j++) {\n        sumOfSquares += Math.pow(average - x[j][1], 2);\n    }\n\n    // Finally estimate the error: the squared\n    // difference between the estimate and the actual data\n    // value at each point.\n    var err = 0;\n    for (var k = 0; k < x.length; k++) {\n        err += Math.pow(x[k][1] - func(x[k][0]), 2);\n    }\n\n    // As the error grows larger, its ratio to the\n    // sum of squares increases and the r squared\n    // value grows lower.\n    return 1 - err / sumOfSquares;\n}\n\n/**\n * The [mode](https://en.wikipedia.org/wiki/Mode_%28statistics%29) is the number\n * that appears in a list the highest number of times.\n * There can be multiple modes in a list: in the event of a tie, this\n * algorithm will return the most recently seen mode.\n *\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * This runs in `O(n)` because the input is sorted.\n *\n * @param {Array<number>} sorted a sample of one or more data points\n * @returns {number} mode\n * @throws {Error} if sorted is empty\n * @example\n * modeSorted([0, 0, 1]); // => 0\n */\nfunction modeSorted(sorted) {\n    // Handle edge cases:\n    // The mode of an empty list is undefined\n    if (sorted.length === 0) {\n        throw new Error(\"mode requires at least one data point\");\n    }\n    if (sorted.length === 1) {\n        return sorted[0];\n    }\n\n    // This assumes it is dealing with an array of size > 1, since size\n    // 0 and 1 are handled immediately. Hence it starts at index 1 in the\n    // array.\n    var last = sorted[0];\n    // store the mode as we find new modes\n    var value = Number.NaN;\n    // store how many times we've seen the mode\n    var maxSeen = 0;\n    // how many times the current candidate for the mode\n    // has been seen\n    var seenThis = 1;\n\n    // end at sorted.length + 1 to fix the case in which the mode is\n    // the highest number that occurs in the sequence. the last iteration\n    // compares sorted[i], which is undefined, to the highest number\n    // in the series\n    for (var i = 1; i < sorted.length + 1; i++) {\n        // we're seeing a new number pass by\n        if (sorted[i] !== last) {\n            // the last number is the new mode since we saw it more\n            // often than the old one\n            if (seenThis > maxSeen) {\n                maxSeen = seenThis;\n                value = last;\n            }\n            seenThis = 1;\n            last = sorted[i];\n            // if this isn't a new number, it's one more occurrence of\n            // the potential mode\n        } else {\n            seenThis++;\n        }\n    }\n    return value;\n}\n\n/**\n * Sort an array of numbers by their numeric value, ensuring that the\n * array is not changed in place.\n *\n * This is necessary because the default behavior of .sort\n * in JavaScript is to sort arrays as string values\n *\n *     [1, 10, 12, 102, 20].sort()\n *     // output\n *     [1, 10, 102, 12, 20]\n *\n * @param {Array<number>} x input array\n * @return {Array<number>} sorted array\n * @private\n * @example\n * numericSort([3, 2, 1]) // => [1, 2, 3]\n */\nfunction numericSort(x) {\n    return (\n        x\n            // ensure the array is not changed in-place\n            .slice()\n            // comparator function that treats input as numeric\n            .sort(function (a, b) {\n                return a - b;\n            })\n    );\n}\n\n/**\n * The [mode](https://en.wikipedia.org/wiki/Mode_%28statistics%29) is the number\n * that appears in a list the highest number of times.\n * There can be multiple modes in a list: in the event of a tie, this\n * algorithm will return the most recently seen mode.\n *\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * This runs in `O(n log(n))` because it needs to sort the array internally\n * before running an `O(n)` search to find the mode.\n *\n * @param {Array<number>} x input\n * @returns {number} mode\n * @example\n * mode([0, 0, 1]); // => 0\n */\nfunction mode(x) {\n    // Sorting the array lets us iterate through it below and be sure\n    // that every time we see a new number it's new and we'll never\n    // see the same number twice\n    return modeSorted(numericSort(x));\n}\n\n/* globals Map: false */\n\n/**\n * The [mode](https://en.wikipedia.org/wiki/Mode_%28statistics%29) is the number\n * that appears in a list the highest number of times.\n * There can be multiple modes in a list: in the event of a tie, this\n * algorithm will return the most recently seen mode.\n *\n * modeFast uses a Map object to keep track of the mode, instead of the approach\n * used with `mode`, a sorted array. As a result, it is faster\n * than `mode` and supports any data type that can be compared with `==`.\n * It also requires a\n * [JavaScript environment with support for Map](https://kangax.github.io/compat-table/es6/#test-Map),\n * and will throw an error if Map is not available.\n *\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * @param {Array<*>} x a sample of one or more data points\n * @returns {?*} mode\n * @throws {ReferenceError} if the JavaScript environment doesn't support Map\n * @throws {Error} if x is empty\n * @example\n * modeFast(['rabbits', 'rabbits', 'squirrels']); // => 'rabbits'\n */\nfunction modeFast(x) {\n    // This index will reflect the incidence of different values, indexing\n    // them like\n    // { value: count }\n    var index = new Map();\n\n    // A running `mode` and the number of times it has been encountered.\n    var mode;\n    var modeCount = 0;\n\n    for (var i = 0; i < x.length; i++) {\n        var newCount = index.get(x[i]);\n        if (newCount === undefined) {\n            newCount = 1;\n        } else {\n            newCount++;\n        }\n        if (newCount > modeCount) {\n            mode = x[i];\n            modeCount = newCount;\n        }\n        index.set(x[i], newCount);\n    }\n\n    if (modeCount === 0) {\n        throw new Error(\"mode requires at last one data point\");\n    }\n\n    return mode;\n}\n\n/**\n * The min is the lowest number in the array.\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @throws {Error} if the length of x is less than one\n * @returns {number} minimum value\n * @example\n * min([1, 5, -10, 100, 2]); // => -10\n */\nfunction min(x) {\n    if (x.length === 0) {\n        throw new Error(\"min requires at least one data point\");\n    }\n\n    var value = x[0];\n    for (var i = 1; i < x.length; i++) {\n        if (x[i] < value) {\n            value = x[i];\n        }\n    }\n    return value;\n}\n\n/**\n * This computes the maximum number in an array.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @returns {number} maximum value\n * @throws {Error} if the length of x is less than one\n * @example\n * max([1, 2, 3, 4]);\n * // => 4\n */\nfunction max(x) {\n    if (x.length === 0) {\n        throw new Error(\"max requires at least one data point\");\n    }\n\n    var value = x[0];\n    for (var i = 1; i < x.length; i++) {\n        if (x[i] > value) {\n            value = x[i];\n        }\n    }\n    return value;\n}\n\n/**\n * This computes the minimum & maximum number in an array.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @returns {Array<number>} minimum & maximum value\n * @throws {Error} if the length of x is less than one\n * @example\n * extent([1, 2, 3, 4]);\n * // => [1, 4]\n */\nfunction extent(x) {\n    if (x.length === 0) {\n        throw new Error(\"extent requires at least one data point\");\n    }\n\n    var min = x[0];\n    var max = x[0];\n    for (var i = 1; i < x.length; i++) {\n        if (x[i] > max) {\n            max = x[i];\n        }\n        if (x[i] < min) {\n            min = x[i];\n        }\n    }\n    return [min, max];\n}\n\n/**\n * The minimum is the lowest number in the array. With a sorted array,\n * the first element in the array is always the smallest, so this calculation\n * can be done in one step, or constant time.\n *\n * @param {Array<number>} x input\n * @returns {number} minimum value\n * @example\n * minSorted([-100, -10, 1, 2, 5]); // => -100\n */\nfunction minSorted(x) {\n    return x[0];\n}\n\n/**\n * The maximum is the highest number in the array. With a sorted array,\n * the last element in the array is always the largest, so this calculation\n * can be done in one step, or constant time.\n *\n * @param {Array<number>} x input\n * @returns {number} maximum value\n * @example\n * maxSorted([-100, -10, 1, 2, 5]); // => 5\n */\nfunction maxSorted(x) {\n    return x[x.length - 1];\n}\n\n/**\n * The extent is the lowest & highest number in the array. With a sorted array,\n * the first element in the array is always the lowest while the last element is always the largest, so this calculation\n * can be done in one step, or constant time.\n *\n * @param {Array<number>} x input\n * @returns {Array<number>} minimum & maximum value\n * @example\n * extentSorted([-100, -10, 1, 2, 5]); // => [-100, 5]\n */\nfunction extentSorted(x) {\n    return [x[0], x[x.length - 1]];\n}\n\n/**\n * The simple [sum](https://en.wikipedia.org/wiki/Summation) of an array\n * is the result of adding all numbers together, starting from zero.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x input\n * @return {number} sum of all input numbers\n * @example\n * sumSimple([1, 2, 3]); // => 6\n */\nfunction sumSimple(x) {\n    var value = 0;\n    for (var i = 0; i < x.length; i++) {\n        if (typeof x[i] !== \"number\") {\n            return Number.NaN;\n        }\n        value += x[i];\n    }\n    return value;\n}\n\n/**\n * The [product](https://en.wikipedia.org/wiki/Product_(mathematics)) of an array\n * is the result of multiplying all numbers together, starting using one as the multiplicative identity.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x input\n * @return {number} product of all input numbers\n * @example\n * product([1, 2, 3, 4]); // => 24\n */\nfunction product(x) {\n    var value = 1;\n    for (var i = 0; i < x.length; i++) {\n        value *= x[i];\n    }\n    return value;\n}\n\n/**\n * This is the internal implementation of quantiles: when you know\n * that the order is sorted, you don't need to re-sort it, and the computations\n * are faster.\n *\n * @param {Array<number>} x sample of one or more data points\n * @param {number} p desired quantile: a number between 0 to 1, inclusive\n * @returns {number} quantile value\n * @throws {Error} if p ix outside of the range from 0 to 1\n * @throws {Error} if x is empty\n * @example\n * quantileSorted([3, 6, 7, 8, 8, 9, 10, 13, 15, 16, 20], 0.5); // => 9\n */\nfunction quantileSorted(x, p) {\n    var idx = x.length * p;\n    if (x.length === 0) {\n        throw new Error(\"quantile requires at least one data point.\");\n    } else if (p < 0 || p > 1) {\n        throw new Error(\"quantiles must be between 0 and 1\");\n    } else if (p === 1) {\n        // If p is 1, directly return the last element\n        return x[x.length - 1];\n    } else if (p === 0) {\n        // If p is 0, directly return the first element\n        return x[0];\n    } else if (idx % 1 !== 0) {\n        // If p is not integer, return the next element in array\n        return x[Math.ceil(idx) - 1];\n    } else if (x.length % 2 === 0) {\n        // If the list has even-length, we'll take the average of this number\n        // and the next value, if there is one\n        return (x[idx - 1] + x[idx]) / 2;\n    } else {\n        // Finally, in the simple case of an integer value\n        // with an odd-length list, return the x value at the index.\n        return x[idx];\n    }\n}\n\n/**\n * Rearrange items in `arr` so that all items in `[left, k]` range are the smallest.\n * The `k`-th element will have the `(k - left + 1)`-th smallest value in `[left, right]`.\n *\n * Implements Floyd-Rivest selection algorithm https://en.wikipedia.org/wiki/Floyd-Rivest_algorithm\n *\n * @param {Array<number>} arr input array\n * @param {number} k pivot index\n * @param {number} [left] left index\n * @param {number} [right] right index\n * @returns {void} mutates input array\n * @example\n * var arr = [65, 28, 59, 33, 21, 56, 22, 95, 50, 12, 90, 53, 28, 77, 39];\n * quickselect(arr, 8);\n * // = [39, 28, 28, 33, 21, 12, 22, 50, 53, 56, 59, 65, 90, 77, 95]\n */\nfunction quickselect(arr, k, left, right) {\n    left = left || 0;\n    right = right || arr.length - 1;\n\n    while (right > left) {\n        // 600 and 0.5 are arbitrary constants chosen in the original paper to minimize execution time\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp((2 * z) / 3);\n            var sd = 0.5 * Math.sqrt((z * s * (n - s)) / n);\n            if (m - n / 2 < 0) { sd *= -1; }\n            var newLeft = Math.max(left, Math.floor(k - (m * s) / n + sd));\n            var newRight = Math.min(\n                right,\n                Math.floor(k + ((n - m) * s) / n + sd)\n            );\n            quickselect(arr, k, newLeft, newRight);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (arr[right] > t) { swap(arr, left, right); }\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (arr[i] < t) { i++; }\n            while (arr[j] > t) { j--; }\n        }\n\n        if (arr[left] === t) { swap(arr, left, j); }\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) { left = j + 1; }\n        if (k <= j) { right = j - 1; }\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\n/**\n * The [quantile](https://en.wikipedia.org/wiki/Quantile):\n * this is a population quantile, since we assume to know the entire\n * dataset in this library. This is an implementation of the\n * [Quantiles of a Population](http://en.wikipedia.org/wiki/Quantile#Quantiles_of_a_population)\n * algorithm from wikipedia.\n *\n * Sample is a one-dimensional array of numbers,\n * and p is either a decimal number from 0 to 1 or an array of decimal\n * numbers from 0 to 1.\n * In terms of a k/q quantile, p = k/q - it's just dealing with fractions or dealing\n * with decimal values.\n * When p is an array, the result of the function is also an array containing the appropriate\n * quantiles in input order\n *\n * @param {Array<number>} x sample of one or more numbers\n * @param {Array<number> | number} p the desired quantile, as a number between 0 and 1\n * @returns {number} quantile\n * @example\n * quantile([3, 6, 7, 8, 8, 9, 10, 13, 15, 16, 20], 0.5); // => 9\n */\nfunction quantile(x, p) {\n    var copy = x.slice();\n\n    if (Array.isArray(p)) {\n        // rearrange elements so that each element corresponding to a requested\n        // quantile is on a place it would be if the array was fully sorted\n        multiQuantileSelect(copy, p);\n        // Initialize the result array\n        var results = [];\n        // For each requested quantile\n        for (var i = 0; i < p.length; i++) {\n            results[i] = quantileSorted(copy, p[i]);\n        }\n        return results;\n    } else {\n        var idx = quantileIndex(copy.length, p);\n        quantileSelect(copy, idx, 0, copy.length - 1);\n        return quantileSorted(copy, p);\n    }\n}\n\nfunction quantileSelect(arr, k, left, right) {\n    if (k % 1 === 0) {\n        quickselect(arr, k, left, right);\n    } else {\n        k = Math.floor(k);\n        quickselect(arr, k, left, right);\n        quickselect(arr, k + 1, k + 1, right);\n    }\n}\n\nfunction multiQuantileSelect(arr, p) {\n    var indices = [0];\n    for (var i = 0; i < p.length; i++) {\n        indices.push(quantileIndex(arr.length, p[i]));\n    }\n    indices.push(arr.length - 1);\n    indices.sort(compare);\n\n    var stack = [0, indices.length - 1];\n\n    while (stack.length) {\n        var r = Math.ceil(stack.pop());\n        var l = Math.floor(stack.pop());\n        if (r - l <= 1) { continue; }\n\n        var m = Math.floor((l + r) / 2);\n        quantileSelect(\n            arr,\n            indices[m],\n            Math.floor(indices[l]),\n            Math.ceil(indices[r])\n        );\n\n        stack.push(l, m, m, r);\n    }\n}\n\nfunction compare(a, b) {\n    return a - b;\n}\n\nfunction quantileIndex(len, p) {\n    var idx = len * p;\n    if (p === 1) {\n        // If p is 1, directly return the last index\n        return len - 1;\n    } else if (p === 0) {\n        // If p is 0, directly return the first index\n        return 0;\n    } else if (idx % 1 !== 0) {\n        // If index is not integer, return the next index in array\n        return Math.ceil(idx) - 1;\n    } else if (len % 2 === 0) {\n        // If the list has even-length, we'll return the middle of two indices\n        // around quantile to indicate that we need an average value of the two\n        return idx - 0.5;\n    } else {\n        // Finally, in the simple case of an integer index\n        // with an odd-length list, return the index\n        return idx;\n    }\n}\n\n/* eslint no-bitwise: 0 */\n\n/**\n * This function returns the quantile in which one would find the given value in\n * the given array. With a sorted array, leveraging binary search, we can find\n * this information in logarithmic time.\n *\n * @param {Array<number>} x input\n * @returns {number} value value\n * @example\n * quantileRankSorted([1, 2, 3, 4], 3); // => 0.75\n * quantileRankSorted([1, 2, 3, 3, 4], 3); // => 0.7\n * quantileRankSorted([1, 2, 3, 4], 6); // => 1\n * quantileRankSorted([1, 2, 3, 3, 5], 4); // => 0.8\n */\nfunction quantileRankSorted(x, value) {\n    // Value is lesser than any value in the array\n    if (value < x[0]) {\n        return 0;\n    }\n\n    // Value is greater than any value in the array\n    if (value > x[x.length - 1]) {\n        return 1;\n    }\n\n    var l = lowerBound(x, value);\n\n    // Value is not in the array\n    if (x[l] !== value) {\n        return l / x.length;\n    }\n\n    l++;\n\n    var u = upperBound(x, value);\n\n    // The value exists only once in the array\n    if (u === l) {\n        return l / x.length;\n    }\n\n    // Here, we are basically computing the mean of the range of indices\n    // containing our searched value. But, instead, of initializing an\n    // array and looping over it, there is a dedicated math formula that\n    // we apply below to get the result.\n    var r = u - l + 1;\n    var sum = (r * (u + l)) / 2;\n    var mean = sum / r;\n\n    return mean / x.length;\n}\n\nfunction lowerBound(x, value) {\n    var mid = 0;\n    var lo = 0;\n    var hi = x.length;\n\n    while (lo < hi) {\n        mid = (lo + hi) >>> 1;\n\n        if (value <= x[mid]) {\n            hi = mid;\n        } else {\n            lo = -~mid;\n        }\n    }\n\n    return lo;\n}\n\nfunction upperBound(x, value) {\n    var mid = 0;\n    var lo = 0;\n    var hi = x.length;\n\n    while (lo < hi) {\n        mid = (lo + hi) >>> 1;\n\n        if (value >= x[mid]) {\n            lo = -~mid;\n        } else {\n            hi = mid;\n        }\n    }\n\n    return lo;\n}\n\n/**\n * This function returns the quantile in which one would find the given value in\n * the given array. It will copy and sort your array before each run, so\n * if you know your array is already sorted, you should use `quantileRankSorted`\n * instead.\n *\n * @param {Array<number>} x input\n * @returns {number} value value\n * @example\n * quantileRank([4, 3, 1, 2], 3); // => 0.75\n * quantileRank([4, 3, 2, 3, 1], 3); // => 0.7\n * quantileRank([2, 4, 1, 3], 6); // => 1\n * quantileRank([5, 3, 1, 2, 3], 4); // => 0.8\n */\nfunction quantileRank(x, value) {\n    // Cloning and sorting the array\n    var sortedCopy = numericSort(x);\n\n    return quantileRankSorted(sortedCopy, value);\n}\n\n/**\n * The [Interquartile range](http://en.wikipedia.org/wiki/Interquartile_range) is\n * a measure of statistical dispersion, or how scattered, spread, or\n * concentrated a distribution is. It's computed as the difference between\n * the third quartile and first quartile.\n *\n * @param {Array<number>} x sample of one or more numbers\n * @returns {number} interquartile range: the span between lower and upper quartile,\n * 0.25 and 0.75\n * @example\n * interquartileRange([0, 1, 2, 3]); // => 2\n */\nfunction interquartileRange(x) {\n    // Interquartile range is the span between the upper quartile,\n    // at `0.75`, and lower quartile, `0.25`\n    var q1 = quantile(x, 0.75);\n    var q2 = quantile(x, 0.25);\n\n    if (typeof q1 === \"number\" && typeof q2 === \"number\") {\n        return q1 - q2;\n    }\n}\n\n/**\n * The [median](http://en.wikipedia.org/wiki/Median) is\n * the middle number of a list. This is often a good indicator of 'the middle'\n * when there are outliers that skew the `mean()` value.\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * The median isn't necessarily one of the elements in the list: the value\n * can be the average of two elements if the list has an even length\n * and the two central values are different.\n *\n * @param {Array<number>} x input\n * @returns {number} median value\n * @example\n * median([10, 2, 5, 100, 2, 1]); // => 3.5\n */\nfunction median(x) {\n    return +quantile(x, 0.5);\n}\n\n/**\n * The [Median Absolute Deviation](http://en.wikipedia.org/wiki/Median_absolute_deviation) is\n * a robust measure of statistical\n * dispersion. It is more resilient to outliers than the standard deviation.\n *\n * @param {Array<number>} x input array\n * @returns {number} median absolute deviation\n * @example\n * medianAbsoluteDeviation([1, 1, 2, 2, 4, 6, 9]); // => 1\n */\nfunction medianAbsoluteDeviation(x) {\n    var medianValue = median(x);\n    var medianAbsoluteDeviations = [];\n\n    // Make a list of absolute deviations from the median\n    for (var i = 0; i < x.length; i++) {\n        medianAbsoluteDeviations.push(Math.abs(x[i] - medianValue));\n    }\n\n    // Find the median value of that list\n    return median(medianAbsoluteDeviations);\n}\n\n/**\n * Split an array into chunks of a specified size. This function\n * has the same behavior as [PHP's array_chunk](http://php.net/manual/en/function.array-chunk.php)\n * function, and thus will insert smaller-sized chunks at the end if\n * the input size is not divisible by the chunk size.\n *\n * `x` is expected to be an array, and `chunkSize` a number.\n * The `x` array can contain any kind of data.\n *\n * @param {Array} x a sample\n * @param {number} chunkSize size of each output array. must be a positive integer\n * @returns {Array<Array>} a chunked array\n * @throws {Error} if chunk size is less than 1 or not an integer\n * @example\n * chunk([1, 2, 3, 4, 5, 6], 2);\n * // => [[1, 2], [3, 4], [5, 6]]\n */\nfunction chunk(x, chunkSize) {\n    // a list of result chunks, as arrays in an array\n    var output = [];\n\n    // `chunkSize` must be zero or higher - otherwise the loop below,\n    // in which we call `start += chunkSize`, will loop infinitely.\n    // So, we'll detect and throw in that case to indicate\n    // invalid input.\n    if (chunkSize < 1) {\n        throw new Error(\"chunk size must be a positive number\");\n    }\n\n    if (Math.floor(chunkSize) !== chunkSize) {\n        throw new Error(\"chunk size must be an integer\");\n    }\n\n    // `start` is the index at which `.slice` will start selecting\n    // new array elements\n    for (var start = 0; start < x.length; start += chunkSize) {\n        // for each chunk, slice that part of the array and add it\n        // to the output. The `.slice` function does not change\n        // the original array.\n        output.push(x.slice(start, start + chunkSize));\n    }\n    return output;\n}\n\n/**\n * Sampling with replacement is a type of sampling that allows the same\n * item to be picked out of a population more than once.\n *\n * @param {Array<*>} x an array of any kind of value\n * @param {number} n count of how many elements to take\n * @param {Function} [randomSource=Math.random] an optional entropy source that\n * returns numbers between 0 inclusive and 1 exclusive: the range [0, 1)\n * @return {Array} n sampled items from the population\n * @example\n * var values = [1, 2, 3, 4];\n * sampleWithReplacement(values, 2); // returns 2 random values, like [2, 4];\n */\nfunction sampleWithReplacement(x, n, randomSource) {\n    if (x.length === 0) {\n        return [];\n    }\n\n    // a custom random number source can be provided if you want to use\n    // a fixed seed or another random number generator, like\n    // [random-js](https://www.npmjs.org/package/random-js)\n    randomSource = randomSource || Math.random;\n\n    var length = x.length;\n    var sample = [];\n\n    for (var i = 0; i < n; i++) {\n        var index = Math.floor(randomSource() * length);\n\n        sample.push(x[index]);\n    }\n\n    return sample;\n}\n\n/**\n * A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)\n * in-place - which means that it **will change the order of the original\n * array by reference**.\n *\n * This is an algorithm that generates a random [permutation](https://en.wikipedia.org/wiki/Permutation)\n * of a set.\n *\n * @param {Array} x sample of one or more numbers\n * @param {Function} [randomSource=Math.random] an optional entropy source that\n * returns numbers between 0 inclusive and 1 exclusive: the range [0, 1)\n * @returns {Array} x\n * @example\n * var x = [1, 2, 3, 4];\n * shuffleInPlace(x);\n * // x is shuffled to a value like [2, 1, 4, 3]\n */\nfunction shuffleInPlace(x, randomSource) {\n    // a custom random number source can be provided if you want to use\n    // a fixed seed or another random number generator, like\n    // [random-js](https://www.npmjs.org/package/random-js)\n    randomSource = randomSource || Math.random;\n\n    // store the current length of the x to determine\n    // when no elements remain to shuffle.\n    var length = x.length;\n\n    // temporary is used to hold an item when it is being\n    // swapped between indices.\n    var temporary;\n\n    // The index to swap at each stage.\n    var index;\n\n    // While there are still items to shuffle\n    while (length > 0) {\n        // choose a random index within the subset of the array\n        // that is not yet shuffled\n        index = Math.floor(randomSource() * length--);\n\n        // store the value that we'll move temporarily\n        temporary = x[length];\n\n        // swap the value at `x[length]` with `x[index]`\n        x[length] = x[index];\n        x[index] = temporary;\n    }\n\n    return x;\n}\n\n/**\n * A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)\n * is a fast way to create a random permutation of a finite set. This is\n * a function around `shuffle_in_place` that adds the guarantee that\n * it will not modify its input.\n *\n * @param {Array} x sample of 0 or more numbers\n * @param {Function} [randomSource=Math.random] an optional entropy source that\n * returns numbers between 0 inclusive and 1 exclusive: the range [0, 1)\n * @return {Array} shuffled version of input\n * @example\n * var shuffled = shuffle([1, 2, 3, 4]);\n * shuffled; // = [2, 3, 1, 4] or any other random permutation\n */\nfunction shuffle(x, randomSource) {\n    // slice the original array so that it is not modified\n    var sample = x.slice();\n\n    // and then shuffle that shallow-copied array, in place\n    return shuffleInPlace(sample, randomSource);\n}\n\n/**\n * Create a [simple random sample](http://en.wikipedia.org/wiki/Simple_random_sample)\n * from a given array of `n` elements.\n *\n * The sampled values will be in any order, not necessarily the order\n * they appear in the input.\n *\n * @param {Array<any>} x input array. can contain any type\n * @param {number} n count of how many elements to take\n * @param {Function} [randomSource=Math.random] an optional entropy source that\n * returns numbers between 0 inclusive and 1 exclusive: the range [0, 1)\n * @return {Array} subset of n elements in original array\n *\n * @example\n * var values = [1, 2, 4, 5, 6, 7, 8, 9];\n * sample(values, 3); // returns 3 random values, like [2, 5, 8];\n */\nfunction sample(x, n, randomSource) {\n    // shuffle the original array using a fisher-yates shuffle\n    var shuffled = shuffle(x, randomSource);\n\n    // and then return a subset of it - the first `n` elements.\n    return shuffled.slice(0, n);\n}\n\n/**\n * Create a new column x row matrix.\n *\n * @private\n * @param {number} columns\n * @param {number} rows\n * @return {Array<Array<number>>} matrix\n * @example\n * makeMatrix(10, 10);\n */\nfunction makeMatrix(columns, rows) {\n    var matrix = [];\n    for (var i = 0; i < columns; i++) {\n        var column = [];\n        for (var j = 0; j < rows; j++) {\n            column.push(0);\n        }\n        matrix.push(column);\n    }\n    return matrix;\n}\n\n/**\n * For a sorted input, counting the number of unique values\n * is possible in constant time and constant memory. This is\n * a simple implementation of the algorithm.\n *\n * Values are compared with `===`, so objects and non-primitive objects\n * are not handled in any special way.\n *\n * @param {Array<*>} x an array of any kind of value\n * @returns {number} count of unique values\n * @example\n * uniqueCountSorted([1, 2, 3]); // => 3\n * uniqueCountSorted([1, 1, 1]); // => 1\n */\nfunction uniqueCountSorted(x) {\n    var uniqueValueCount = 0;\n    var lastSeenValue;\n    for (var i = 0; i < x.length; i++) {\n        if (i === 0 || x[i] !== lastSeenValue) {\n            lastSeenValue = x[i];\n            uniqueValueCount++;\n        }\n    }\n    return uniqueValueCount;\n}\n\n/**\n * Generates incrementally computed values based on the sums and sums of\n * squares for the data array\n *\n * @private\n * @param {number} j\n * @param {number} i\n * @param {Array<number>} sums\n * @param {Array<number>} sumsOfSquares\n * @return {number}\n * @example\n * ssq(0, 1, [-1, 0, 2], [1, 1, 5]);\n */\nfunction ssq(j, i, sums, sumsOfSquares) {\n    var sji; // s(j, i)\n    if (j > 0) {\n        var muji = (sums[i] - sums[j - 1]) / (i - j + 1); // mu(j, i)\n        sji =\n            sumsOfSquares[i] - sumsOfSquares[j - 1] - (i - j + 1) * muji * muji;\n    } else {\n        sji = sumsOfSquares[i] - (sums[i] * sums[i]) / (i + 1);\n    }\n    if (sji < 0) {\n        return 0;\n    }\n    return sji;\n}\n\n/**\n * Function that recursively divides and conquers computations\n * for cluster j\n *\n * @private\n * @param {number} iMin Minimum index in cluster to be computed\n * @param {number} iMax Maximum index in cluster to be computed\n * @param {number} cluster Index of the cluster currently being computed\n * @param {Array<Array<number>>} matrix\n * @param {Array<Array<number>>} backtrackMatrix\n * @param {Array<number>} sums\n * @param {Array<number>} sumsOfSquares\n */\nfunction fillMatrixColumn(\n    iMin,\n    iMax,\n    cluster,\n    matrix,\n    backtrackMatrix,\n    sums,\n    sumsOfSquares\n) {\n    if (iMin > iMax) {\n        return;\n    }\n\n    // Start at midpoint between iMin and iMax\n    var i = Math.floor((iMin + iMax) / 2);\n\n    matrix[cluster][i] = matrix[cluster - 1][i - 1];\n    backtrackMatrix[cluster][i] = i;\n\n    var jlow = cluster; // the lower end for j\n\n    if (iMin > cluster) {\n        jlow = Math.max(jlow, backtrackMatrix[cluster][iMin - 1] || 0);\n    }\n    jlow = Math.max(jlow, backtrackMatrix[cluster - 1][i] || 0);\n\n    var jhigh = i - 1; // the upper end for j\n    if (iMax < matrix[0].length - 1) {\n        /* c8 ignore start */\n        jhigh = Math.min(jhigh, backtrackMatrix[cluster][iMax + 1] || 0);\n        /* c8 ignore end */\n    }\n\n    var sji;\n    var sjlowi;\n    var ssqjlow;\n    var ssqj;\n    for (var j = jhigh; j >= jlow; --j) {\n        sji = ssq(j, i, sums, sumsOfSquares);\n\n        if (sji + matrix[cluster - 1][jlow - 1] >= matrix[cluster][i]) {\n            break;\n        }\n\n        // Examine the lower bound of the cluster border\n        sjlowi = ssq(jlow, i, sums, sumsOfSquares);\n\n        ssqjlow = sjlowi + matrix[cluster - 1][jlow - 1];\n\n        if (ssqjlow < matrix[cluster][i]) {\n            // Shrink the lower bound\n            matrix[cluster][i] = ssqjlow;\n            backtrackMatrix[cluster][i] = jlow;\n        }\n        jlow++;\n\n        ssqj = sji + matrix[cluster - 1][j - 1];\n        if (ssqj < matrix[cluster][i]) {\n            matrix[cluster][i] = ssqj;\n            backtrackMatrix[cluster][i] = j;\n        }\n    }\n\n    fillMatrixColumn(\n        iMin,\n        i - 1,\n        cluster,\n        matrix,\n        backtrackMatrix,\n        sums,\n        sumsOfSquares\n    );\n    fillMatrixColumn(\n        i + 1,\n        iMax,\n        cluster,\n        matrix,\n        backtrackMatrix,\n        sums,\n        sumsOfSquares\n    );\n}\n\n/**\n * Initializes the main matrices used in Ckmeans and kicks\n * off the divide and conquer cluster computation strategy\n *\n * @private\n * @param {Array<number>} data sorted array of values\n * @param {Array<Array<number>>} matrix\n * @param {Array<Array<number>>} backtrackMatrix\n */\nfunction fillMatrices(data, matrix, backtrackMatrix) {\n    var nValues = matrix[0].length;\n\n    // Shift values by the median to improve numeric stability\n    var shift = data[Math.floor(nValues / 2)];\n\n    // Cumulative sum and cumulative sum of squares for all values in data array\n    var sums = [];\n    var sumsOfSquares = [];\n\n    // Initialize first column in matrix & backtrackMatrix\n    for (var i = 0, shiftedValue = (void 0); i < nValues; ++i) {\n        shiftedValue = data[i] - shift;\n        if (i === 0) {\n            sums.push(shiftedValue);\n            sumsOfSquares.push(shiftedValue * shiftedValue);\n        } else {\n            sums.push(sums[i - 1] + shiftedValue);\n            sumsOfSquares.push(\n                sumsOfSquares[i - 1] + shiftedValue * shiftedValue\n            );\n        }\n\n        // Initialize for cluster = 0\n        matrix[0][i] = ssq(0, i, sums, sumsOfSquares);\n        backtrackMatrix[0][i] = 0;\n    }\n\n    // Initialize the rest of the columns\n    var iMin;\n    for (var cluster = 1; cluster < matrix.length; ++cluster) {\n        if (cluster < matrix.length - 1) {\n            iMin = cluster;\n        } else {\n            // No need to compute matrix[K-1][0] ... matrix[K-1][N-2]\n            iMin = nValues - 1;\n        }\n\n        fillMatrixColumn(\n            iMin,\n            nValues - 1,\n            cluster,\n            matrix,\n            backtrackMatrix,\n            sums,\n            sumsOfSquares\n        );\n    }\n}\n\n/**\n * Ckmeans clustering is an improvement on heuristic-based clustering\n * approaches like Jenks. The algorithm was developed in\n * [Haizhou Wang and Mingzhou Song](http://journal.r-project.org/archive/2011-2/RJournal_2011-2_Wang+Song.pdf)\n * as a [dynamic programming](https://en.wikipedia.org/wiki/Dynamic_programming) approach\n * to the problem of clustering numeric data into groups with the least\n * within-group sum-of-squared-deviations.\n *\n * Minimizing the difference within groups - what Wang & Song refer to as\n * `withinss`, or within sum-of-squares, means that groups are optimally\n * homogenous within and the data is split into representative groups.\n * This is very useful for visualization, where you may want to represent\n * a continuous variable in discrete color or style groups. This function\n * can provide groups that emphasize differences between data.\n *\n * Being a dynamic approach, this algorithm is based on two matrices that\n * store incrementally-computed values for squared deviations and backtracking\n * indexes.\n *\n * This implementation is based on Ckmeans 3.4.6, which introduced a new divide\n * and conquer approach that improved runtime from O(kn^2) to O(kn log(n)).\n *\n * Unlike the [original implementation](https://cran.r-project.org/web/packages/Ckmeans.1d.dp/index.html),\n * this implementation does not include any code to automatically determine\n * the optimal number of clusters: this information needs to be explicitly\n * provided.\n *\n * ### References\n * _Ckmeans.1d.dp: Optimal k-means Clustering in One Dimension by Dynamic\n * Programming_ Haizhou Wang and Mingzhou Song ISSN 2073-4859\n *\n * from The R Journal Vol. 3/2, December 2011\n * @param {Array<number>} x input data, as an array of number values\n * @param {number} nClusters number of desired classes. This cannot be\n * greater than the number of values in the data array.\n * @returns {Array<Array<number>>} clustered input\n * @throws {Error} if the number of requested clusters is higher than the size of the data\n * @example\n * ckmeans([-1, 2, -1, 2, 4, 5, 6, -1, 2, -1], 3);\n * // The input, clustered into groups of similar numbers.\n * //= [[-1, -1, -1, -1], [2, 2, 2], [4, 5, 6]]);\n */\nfunction ckmeans(x, nClusters) {\n    if (nClusters > x.length) {\n        throw new Error(\n            \"cannot generate more classes than there are data values\"\n        );\n    }\n\n    var sorted = numericSort(x);\n    // we'll use this as the maximum number of clusters\n    var uniqueCount = uniqueCountSorted(sorted);\n\n    // if all of the input values are identical, there's one cluster\n    // with all of the input in it.\n    if (uniqueCount === 1) {\n        return [sorted];\n    }\n\n    // named 'S' originally\n    var matrix = makeMatrix(nClusters, sorted.length);\n    // named 'J' originally\n    var backtrackMatrix = makeMatrix(nClusters, sorted.length);\n\n    // This is a dynamic programming way to solve the problem of minimizing\n    // within-cluster sum of squares. It's similar to linear regression\n    // in this way, and this calculation incrementally computes the\n    // sum of squares that are later read.\n    fillMatrices(sorted, matrix, backtrackMatrix);\n\n    // The real work of Ckmeans clustering happens in the matrix generation:\n    // the generated matrices encode all possible clustering combinations, and\n    // once they're generated we can solve for the best clustering groups\n    // very quickly.\n    var clusters = [];\n    var clusterRight = backtrackMatrix[0].length - 1;\n\n    // Backtrack the clusters from the dynamic programming matrix. This\n    // starts at the bottom-right corner of the matrix (if the top-left is 0, 0),\n    // and moves the cluster target with the loop.\n    for (var cluster = backtrackMatrix.length - 1; cluster >= 0; cluster--) {\n        var clusterLeft = backtrackMatrix[cluster][clusterRight];\n\n        // fill the cluster from the sorted input by taking a slice of the\n        // array. the backtrack matrix makes this easy - it stores the\n        // indexes where the cluster should start and end.\n        clusters[cluster] = sorted.slice(clusterLeft, clusterRight + 1);\n\n        if (cluster > 0) {\n            clusterRight = clusterLeft - 1;\n        }\n    }\n\n    return clusters;\n}\n\n/*\n * Pull Breaks Values for Jenks\n *\n * the second part of the jenks recipe: take the calculated matrices\n * and derive an array of n breaks.\n *\n * @private\n */\nfunction jenksBreaks(data, lowerClassLimits, nClasses) {\n    var k = data.length;\n    var kclass = [];\n    var countNum = nClasses;\n\n    // the calculation of classes will never include the upper\n    // bound, so we need to explicitly set it\n    kclass[nClasses] = data[data.length - 1];\n\n    // the lowerClassLimits matrix is used as indices into itself\n    // here: the `k` variable is reused in each iteration.\n    while (countNum > 0) {\n        kclass[countNum - 1] = data[lowerClassLimits[k][countNum] - 1];\n        k = lowerClassLimits[k][countNum] - 1;\n        countNum--;\n    }\n\n    return kclass;\n}\n\n/*\n * Compute Matrices for Jenks\n *\n * Compute the matrices required for Jenks breaks. These matrices\n * can be used for any classing of data with `classes <= nClasses`\n *\n * @private\n */\nfunction jenksMatrices(data, nClasses) {\n    // in the original implementation, these matrices are referred to\n    // as `LC` and `OP`\n    //\n    // * lowerClassLimits (LC): optimal lower class limits\n    // * varianceCombinations (OP): optimal variance combinations for all classes\n    var lowerClassLimits = [];\n    var varianceCombinations = [];\n    // loop counters\n    var i;\n    var j;\n    // the variance, as computed at each step in the calculation\n    var variance = 0;\n\n    // Initialize and fill each matrix with zeroes\n    for (i = 0; i < data.length + 1; i++) {\n        var tmp1 = [];\n        var tmp2 = [];\n        // despite these arrays having the same values, we need\n        // to keep them separate so that changing one does not change\n        // the other\n        for (j = 0; j < nClasses + 1; j++) {\n            tmp1.push(0);\n            tmp2.push(0);\n        }\n        lowerClassLimits.push(tmp1);\n        varianceCombinations.push(tmp2);\n    }\n\n    for (i = 1; i < nClasses + 1; i++) {\n        lowerClassLimits[1][i] = 1;\n        varianceCombinations[1][i] = 0;\n        // in the original implementation, 9999999 is used but\n        // since Javascript has `Infinity`, we use that.\n        for (j = 2; j < data.length + 1; j++) {\n            varianceCombinations[j][i] = Number.POSITIVE_INFINITY;\n        }\n    }\n\n    for (var l = 2; l < data.length + 1; l++) {\n        // `SZ` originally. this is the sum of the values seen thus\n        // far when calculating variance.\n        var sum = 0;\n        // `ZSQ` originally. the sum of squares of values seen\n        // thus far\n        var sumSquares = 0;\n        // `WT` originally. This is the number of\n        var w = 0;\n        // `IV` originally\n        var i4 = 0;\n\n        // in several instances, you could say `Math.pow(x, 2)`\n        // instead of `x * x`, but this is slower in some browsers\n        // introduces an unnecessary concept.\n        for (var m = 1; m < l + 1; m++) {\n            // `III` originally\n            var lowerClassLimit = l - m + 1;\n            var val = data[lowerClassLimit - 1];\n\n            // here we're estimating variance for each potential classing\n            // of the data, for each potential number of classes. `w`\n            // is the number of data points considered so far.\n            w++;\n\n            // increase the current sum and sum-of-squares\n            sum += val;\n            sumSquares += val * val;\n\n            // the variance at this point in the sequence is the difference\n            // between the sum of squares and the total x 2, over the number\n            // of samples.\n            variance = sumSquares - (sum * sum) / w;\n\n            i4 = lowerClassLimit - 1;\n\n            if (i4 !== 0) {\n                for (j = 2; j < nClasses + 1; j++) {\n                    // if adding this element to an existing class\n                    // will increase its variance beyond the limit, break\n                    // the class at this point, setting the `lowerClassLimit`\n                    // at this point.\n                    if (\n                        varianceCombinations[l][j] >=\n                        variance + varianceCombinations[i4][j - 1]\n                    ) {\n                        lowerClassLimits[l][j] = lowerClassLimit;\n                        varianceCombinations[l][j] =\n                            variance + varianceCombinations[i4][j - 1];\n                    }\n                }\n            }\n        }\n\n        lowerClassLimits[l][1] = 1;\n        varianceCombinations[l][1] = variance;\n    }\n\n    // return the two matrices. for just providing breaks, only\n    // `lowerClassLimits` is needed, but variances can be useful to\n    // evaluate goodness of fit.\n    return {\n        lowerClassLimits: lowerClassLimits,\n        varianceCombinations: varianceCombinations\n    };\n}\n\n/**\n * The **[jenks natural breaks optimization](http://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)**\n * is an algorithm commonly used in cartography and visualization to decide\n * upon groupings of data values that minimize variance within themselves\n * and maximize variation between themselves.\n *\n * For instance, cartographers often use jenks in order to choose which\n * values are assigned to which colors in a [choropleth](https://en.wikipedia.org/wiki/Choropleth_map)\n * map.\n *\n * @param {Array<number>} data input data, as an array of number values\n * @param {number} nClasses number of desired classes\n * @returns {Array<number>} array of class break positions\n * // split data into 3 break points\n * jenks([1, 2, 4, 5, 7, 9, 10, 20], 3) // = [1, 7, 20, 20]\n */\nfunction jenks(data, nClasses) {\n    if (nClasses > data.length) {\n        return null;\n    }\n\n    // sort data in numerical order, since this is expected\n    // by the matrices function\n    data = data.slice().sort(function (a, b) {\n        return a - b;\n    });\n\n    // get our basic matrices\n    var matrices = jenksMatrices(data, nClasses);\n    // we only need lower class limits here\n    var lowerClassLimits = matrices.lowerClassLimits;\n\n    // extract nClasses out of the computed matrices\n    return jenksBreaks(data, lowerClassLimits, nClasses);\n}\n\n/**\n * Given an array of x, this will find the extent of the\n * x and return an array of breaks that can be used\n * to categorize the x into a number of classes. The\n * returned array will always be 1 longer than the number of\n * classes because it includes the minimum value.\n *\n * @param {Array<number>} x an array of number values\n * @param {number} nClasses number of desired classes\n * @returns {Array<number>} array of class break positions\n * @example\n * equalIntervalBreaks([1, 2, 3, 4, 5, 6], 4); // => [1, 2.25, 3.5, 4.75, 6]\n */\nfunction equalIntervalBreaks(x, nClasses) {\n    if (x.length < 2) {\n        return x;\n    }\n\n    var theMin = min(x);\n    var theMax = max(x);\n\n    // the first break will always be the minimum value\n    // in the xset\n    var breaks = [theMin];\n\n    // The size of each break is the full range of the x\n    // divided by the number of classes requested\n    var breakSize = (theMax - theMin) / nClasses;\n\n    // In the case of nClasses = 1, this loop won't run\n    // and the returned breaks will be [min, max]\n    for (var i = 1; i < nClasses; i++) {\n        breaks.push(breaks[0] + breakSize * i);\n    }\n\n    // the last break will always be the\n    // maximum.\n    breaks.push(theMax);\n\n    return breaks;\n}\n\n/**\n * [Sample covariance](https://en.wikipedia.org/wiki/Sample_mean_and_covariance) of two datasets:\n * how much do the two datasets move together?\n * x and y are two datasets, represented as arrays of numbers.\n *\n * @param {Array<number>} x a sample of two or more data points\n * @param {Array<number>} y a sample of two or more data points\n * @throws {Error} if x and y do not have equal lengths\n * @throws {Error} if x or y have length of one or less\n * @returns {number} sample covariance\n * @example\n * sampleCovariance([1, 2, 3, 4, 5, 6], [6, 5, 4, 3, 2, 1]); // => -3.5\n */\nfunction sampleCovariance(x, y) {\n    // The two datasets must have the same length which must be more than 1\n    if (x.length !== y.length) {\n        throw new Error(\"sampleCovariance requires samples with equal lengths\");\n    }\n\n    if (x.length < 2) {\n        throw new Error(\n            \"sampleCovariance requires at least two data points in each sample\"\n        );\n    }\n\n    // determine the mean of each dataset so that we can judge each\n    // value of the dataset fairly as the difference from the mean. this\n    // way, if one dataset is [1, 2, 3] and [2, 3, 4], their covariance\n    // does not suffer because of the difference in absolute values\n    var xmean = mean(x);\n    var ymean = mean(y);\n    var sum = 0;\n\n    // for each pair of values, the covariance increases when their\n    // difference from the mean is associated - if both are well above\n    // or if both are well below\n    // the mean, the covariance increases significantly.\n    for (var i = 0; i < x.length; i++) {\n        sum += (x[i] - xmean) * (y[i] - ymean);\n    }\n\n    // this is Bessels' Correction: an adjustment made to sample statistics\n    // that allows for the reduced degree of freedom entailed in calculating\n    // values from samples rather than complete populations.\n    var besselsCorrection = x.length - 1;\n\n    // the covariance is weighted by the length of the datasets.\n    return sum / besselsCorrection;\n}\n\n/**\n * The [sample variance](https://en.wikipedia.org/wiki/Variance#Sample_variance)\n * is the sum of squared deviations from the mean. The sample variance\n * is distinguished from the variance by the usage of [Bessel's Correction](https://en.wikipedia.org/wiki/Bessel's_correction):\n * instead of dividing the sum of squared deviations by the length of the input,\n * it is divided by the length minus one. This corrects the bias in estimating\n * a value from a set that you don't know if full.\n *\n * References:\n * * [Wolfram MathWorld on Sample Variance](http://mathworld.wolfram.com/SampleVariance.html)\n *\n * @param {Array<number>} x a sample of two or more data points\n * @throws {Error} if the length of x is less than 2\n * @return {number} sample variance\n * @example\n * sampleVariance([1, 2, 3, 4, 5]); // => 2.5\n */\nfunction sampleVariance(x) {\n    if (x.length < 2) {\n        throw new Error(\"sampleVariance requires at least two data points\");\n    }\n\n    var sumSquaredDeviationsValue = sumNthPowerDeviations(x, 2);\n\n    // this is Bessels' Correction: an adjustment made to sample statistics\n    // that allows for the reduced degree of freedom entailed in calculating\n    // values from samples rather than complete populations.\n    var besselsCorrection = x.length - 1;\n\n    // Find the mean value of that list\n    return sumSquaredDeviationsValue / besselsCorrection;\n}\n\n/**\n * The [sample standard deviation](http://en.wikipedia.org/wiki/Standard_deviation#Sample_standard_deviation)\n * is the square root of the sample variance.\n *\n * @param {Array<number>} x input array\n * @returns {number} sample standard deviation\n * @example\n * sampleStandardDeviation([2, 4, 4, 4, 5, 5, 7, 9]).toFixed(2);\n * // => '2.14'\n */\nfunction sampleStandardDeviation(x) {\n    var sampleVarianceX = sampleVariance(x);\n    return Math.sqrt(sampleVarianceX);\n}\n\n/**\n * The [correlation](http://en.wikipedia.org/wiki/Correlation_and_dependence) is\n * a measure of how correlated two datasets are, between -1 and 1\n *\n * @param {Array<number>} x first input\n * @param {Array<number>} y second input\n * @returns {number} sample correlation\n * @example\n * sampleCorrelation([1, 2, 3, 4, 5, 6], [2, 2, 3, 4, 5, 60]).toFixed(2);\n * // => '0.69'\n */\nfunction sampleCorrelation(x, y) {\n    var cov = sampleCovariance(x, y);\n    var xstd = sampleStandardDeviation(x);\n    var ystd = sampleStandardDeviation(y);\n\n    return cov / xstd / ystd;\n}\n\n/**\n * The [rank correlation](https://en.wikipedia.org/wiki/Rank_correlation) is\n * a measure of the strength of monotonic relationship between two arrays\n *\n * @param {Array<number>} x first input\n * @param {Array<number>} y second input\n * @returns {number} sample rank correlation\n */\nfunction sampleRankCorrelation(x, y) {\n    var xIndexes = x\n        .map(function (value, index) { return [value, index]; })\n        .sort(function (a, b) { return a[0] - b[0]; })\n        .map(function (pair) { return pair[1]; });\n    var yIndexes = y\n        .map(function (value, index) { return [value, index]; })\n        .sort(function (a, b) { return a[0] - b[0]; })\n        .map(function (pair) { return pair[1]; });\n\n    // At this step, we have an array of indexes\n    // that map from sorted numbers to their original indexes. We reverse\n    // that so that it is an array of the sorted destination index.\n    var xRanks = Array(xIndexes.length);\n    var yRanks = Array(xIndexes.length);\n    for (var i = 0; i < xIndexes.length; i++) {\n        xRanks[xIndexes[i]] = i;\n        yRanks[yIndexes[i]] = i;\n    }\n\n    return sampleCorrelation(xRanks, yRanks);\n}\n\n/**\n * [Skewness](http://en.wikipedia.org/wiki/Skewness) is\n * a measure of the extent to which a probability distribution of a\n * real-valued random variable \"leans\" to one side of the mean.\n * The skewness value can be positive or negative, or even undefined.\n *\n * Implementation is based on the adjusted Fisher-Pearson standardized\n * moment coefficient, which is the version found in Excel and several\n * statistical packages including Minitab, SAS and SPSS.\n *\n * @since 4.1.0\n * @param {Array<number>} x a sample of 3 or more data points\n * @returns {number} sample skewness\n * @throws {Error} if x has length less than 3\n * @example\n * sampleSkewness([2, 4, 6, 3, 1]); // => 0.590128656384365\n */\nfunction sampleSkewness(x) {\n    if (x.length < 3) {\n        throw new Error(\"sampleSkewness requires at least three data points\");\n    }\n\n    var meanValue = mean(x);\n    var tempValue;\n    var sumSquaredDeviations = 0;\n    var sumCubedDeviations = 0;\n\n    for (var i = 0; i < x.length; i++) {\n        tempValue = x[i] - meanValue;\n        sumSquaredDeviations += tempValue * tempValue;\n        sumCubedDeviations += tempValue * tempValue * tempValue;\n    }\n\n    // this is Bessels' Correction: an adjustment made to sample statistics\n    // that allows for the reduced degree of freedom entailed in calculating\n    // values from samples rather than complete populations.\n    var besselsCorrection = x.length - 1;\n\n    // Find the mean value of that list\n    var theSampleStandardDeviation = Math.sqrt(\n        sumSquaredDeviations / besselsCorrection\n    );\n\n    var n = x.length;\n    var cubedS = Math.pow(theSampleStandardDeviation, 3);\n\n    return (n * sumCubedDeviations) / ((n - 1) * (n - 2) * cubedS);\n}\n\n/**\n * [Kurtosis](http://en.wikipedia.org/wiki/Kurtosis) is\n * a measure of the heaviness of a distribution's tails relative to its\n * variance. The kurtosis value can be positive or negative, or even undefined.\n *\n * Implementation is based on Fisher's excess kurtosis definition and uses\n * unbiased moment estimators. This is the version found in Excel and available\n * in several statistical packages, including SAS and SciPy.\n *\n * @param {Array<number>} x a sample of 4 or more data points\n * @returns {number} sample kurtosis\n * @throws {Error} if x has length less than 4\n * @example\n * sampleKurtosis([1, 2, 2, 3, 5]); // => 1.4555765595463122\n */\nfunction sampleKurtosis(x) {\n    var n = x.length;\n\n    if (n < 4) {\n        throw new Error(\"sampleKurtosis requires at least four data points\");\n    }\n\n    var meanValue = mean(x);\n    var tempValue;\n    var secondCentralMoment = 0;\n    var fourthCentralMoment = 0;\n\n    for (var i = 0; i < n; i++) {\n        tempValue = x[i] - meanValue;\n        secondCentralMoment += tempValue * tempValue;\n        fourthCentralMoment += tempValue * tempValue * tempValue * tempValue;\n    }\n\n    return (\n        ((n - 1) / ((n - 2) * (n - 3))) *\n        ((n * (n + 1) * fourthCentralMoment) /\n            (secondCentralMoment * secondCentralMoment) -\n            3 * (n - 1))\n    );\n}\n\n/**\n * Implementation of [Heap's Algorithm](https://en.wikipedia.org/wiki/Heap%27s_algorithm)\n * for generating permutations.\n *\n * @param {Array} elements any type of data\n * @returns {Array<Array>} array of permutations\n */\nfunction permutationsHeap(elements) {\n    var indexes = new Array(elements.length);\n    var permutations = [elements.slice()];\n\n    for (var i = 0; i < elements.length; i++) {\n        indexes[i] = 0;\n    }\n\n    for (var i$1 = 0; i$1 < elements.length; ) {\n        if (indexes[i$1] < i$1) {\n            // At odd indexes, swap from indexes[i] instead\n            // of from the beginning of the array\n            var swapFrom = 0;\n            if (i$1 % 2 !== 0) {\n                swapFrom = indexes[i$1];\n            }\n\n            // swap between swapFrom and i, using\n            // a temporary variable as storage.\n            var temp = elements[swapFrom];\n            elements[swapFrom] = elements[i$1];\n            elements[i$1] = temp;\n\n            permutations.push(elements.slice());\n            indexes[i$1]++;\n            i$1 = 0;\n        } else {\n            indexes[i$1] = 0;\n            i$1++;\n        }\n    }\n\n    return permutations;\n}\n\n/**\n * Implementation of Combinations\n * Combinations are unique subsets of a collection - in this case, k x from a collection at a time.\n * https://en.wikipedia.org/wiki/Combination\n * @param {Array} x any type of data\n * @param {int} k the number of objects in each group (without replacement)\n * @returns {Array<Array>} array of permutations\n * @example\n * combinations([1, 2, 3], 2); // => [[1,2], [1,3], [2,3]]\n */\n\nfunction combinations(x, k) {\n    var i;\n    var subI;\n    var combinationList = [];\n    var subsetCombinations;\n    var next;\n\n    for (i = 0; i < x.length; i++) {\n        if (k === 1) {\n            combinationList.push([x[i]]);\n        } else {\n            subsetCombinations = combinations(x.slice(i + 1, x.length), k - 1);\n            for (subI = 0; subI < subsetCombinations.length; subI++) {\n                next = subsetCombinations[subI];\n                next.unshift(x[i]);\n                combinationList.push(next);\n            }\n        }\n    }\n    return combinationList;\n}\n\n/**\n * Implementation of [Combinations](https://en.wikipedia.org/wiki/Combination) with replacement\n * Combinations are unique subsets of a collection - in this case, k x from a collection at a time.\n * 'With replacement' means that a given element can be chosen multiple times.\n * Unlike permutation, order doesn't matter for combinations.\n *\n * @param {Array} x any type of data\n * @param {int} k the number of objects in each group (without replacement)\n * @returns {Array<Array>} array of permutations\n * @example\n * combinationsReplacement([1, 2], 2); // => [[1, 1], [1, 2], [2, 2]]\n */\nfunction combinationsReplacement(x, k) {\n    var combinationList = [];\n\n    for (var i = 0; i < x.length; i++) {\n        if (k === 1) {\n            // If we're requested to find only one element, we don't need\n            // to recurse: just push `x[i]` onto the list of combinations.\n            combinationList.push([x[i]]);\n        } else {\n            // Otherwise, recursively find combinations, given `k - 1`. Note that\n            // we request `k - 1`, so if you were looking for k=3 combinations, we're\n            // requesting k=2. This -1 gets reversed in the for loop right after this\n            // code, since we concatenate `x[i]` onto the selected combinations,\n            // bringing `k` back up to your requested level.\n            // This recursion may go many levels deep, since it only stops once\n            // k=1.\n            var subsetCombinations = combinationsReplacement(\n                x.slice(i, x.length),\n                k - 1\n            );\n\n            for (var j = 0; j < subsetCombinations.length; j++) {\n                combinationList.push([x[i]].concat(subsetCombinations[j]));\n            }\n        }\n    }\n\n    return combinationList;\n}\n\n/**\n * When adding a new value to a list, one does not have to necessary\n * recompute the mean of the list in linear time. They can instead use\n * this function to compute the new mean by providing the current mean,\n * the number of elements in the list that produced it and the new\n * value to add.\n *\n * @since 2.5.0\n * @param {number} mean current mean\n * @param {number} n number of items in the list\n * @param {number} newValue the added value\n * @returns {number} the new mean\n *\n * @example\n * addToMean(14, 5, 53); // => 20.5\n */\nfunction addToMean(mean, n, newValue) {\n    return mean + (newValue - mean) / (n + 1);\n}\n\n/**\n * When combining two lists of values for which one already knows the means,\n * one does not have to necessary recompute the mean of the combined lists in\n * linear time. They can instead use this function to compute the combined\n * mean by providing the mean & number of values of the first list and the mean\n * & number of values of the second list.\n *\n * @since 3.0.0\n * @param {number} mean1 mean of the first list\n * @param {number} n1 number of items in the first list\n * @param {number} mean2 mean of the second list\n * @param {number} n2 number of items in the second list\n * @returns {number} the combined mean\n *\n * @example\n * combineMeans(5, 3, 4, 3); // => 4.5\n */\nfunction combineMeans(mean1, n1, mean2, n2) {\n    return (mean1 * n1 + mean2 * n2) / (n1 + n2);\n}\n\n/**\n * When combining two lists of values for which one already knows the variances,\n * one does not have to necessary recompute the variance of the combined lists\n * in linear time. They can instead use this function to compute the combined\n * variance by providing the variance, mean & number of values of the first list\n * and the variance, mean & number of values of the second list.\n *\n * @since 3.0.0\n * @param {number} variance1 variance of the first list\n * @param {number} mean1 mean of the first list\n * @param {number} n1 number of items in the first list\n * @param {number} variance2 variance of the second list\n * @param {number} mean2 mean of the second list\n * @param {number} n2 number of items in the second list\n * @returns {number} the combined mean\n *\n * @example\n * combineVariances(14 / 3, 5, 3, 8 / 3, 4, 3); // => 47 / 12\n */\nfunction combineVariances(variance1, mean1, n1, variance2, mean2, n2) {\n    var newMean = combineMeans(mean1, n1, mean2, n2);\n\n    return (\n        (n1 * (variance1 + Math.pow(mean1 - newMean, 2)) +\n            n2 * (variance2 + Math.pow(mean2 - newMean, 2))) /\n        (n1 + n2)\n    );\n}\n\n/**\n * The [Geometric Mean](https://en.wikipedia.org/wiki/Geometric_mean) is\n * a mean function that is more useful for numbers in different\n * ranges.\n *\n * This is the nth root of the input numbers multiplied by each other.\n *\n * The geometric mean is often useful for\n * **[proportional growth](https://en.wikipedia.org/wiki/Geometric_mean#Proportional_growth)**: given\n * growth rates for multiple years, like _80%, 16.66% and 42.85%_, a simple\n * mean will incorrectly estimate an average growth rate, whereas a geometric\n * mean will correctly estimate a growth rate that, over those years,\n * will yield the same end value.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @returns {number} geometric mean\n * @throws {Error} if x is empty\n * @throws {Error} if x contains a negative number\n * @example\n * var growthRates = [1.80, 1.166666, 1.428571];\n * var averageGrowth = ss.geometricMean(growthRates);\n * var averageGrowthRates = [averageGrowth, averageGrowth, averageGrowth];\n * var startingValue = 10;\n * var startingValueMean = 10;\n * growthRates.forEach(function(rate) {\n *   startingValue *= rate;\n * });\n * averageGrowthRates.forEach(function(rate) {\n *   startingValueMean *= rate;\n * });\n * startingValueMean === startingValue;\n */\nfunction geometricMean(x) {\n    if (x.length === 0) {\n        throw new Error(\"geometricMean requires at least one data point\");\n    }\n\n    // the starting value.\n    var value = 1;\n\n    for (var i = 0; i < x.length; i++) {\n        // the geometric mean is only valid for positive numbers\n        if (x[i] < 0) {\n            throw new Error(\n                \"geometricMean requires only non-negative numbers as input\"\n            );\n        }\n\n        // repeatedly multiply the value by each number\n        value *= x[i];\n    }\n\n    return Math.pow(value, 1 / x.length);\n}\n\n/**\n * The [log average](https://en.wikipedia.org/wiki/https://en.wikipedia.org/wiki/Geometric_mean#Relationship_with_logarithms)\n * is an equivalent way of computing the geometric mean of an array suitable for large or small products.\n *\n * It's found by calculating the average logarithm of the elements and exponentiating.\n *\n * @param {Array<number>} x sample of one or more data points\n * @returns {number} geometric mean\n * @throws {Error} if x is empty\n * @throws {Error} if x contains a negative number\n */\nfunction logAverage(x) {\n    if (x.length === 0) {\n        throw new Error(\"logAverage requires at least one data point\");\n    }\n\n    var value = 0;\n    for (var i = 0; i < x.length; i++) {\n        if (x[i] < 0) {\n            throw new Error(\n                \"logAverage requires only non-negative numbers as input\"\n            );\n        }\n        value += Math.log(x[i]);\n    }\n\n    return Math.exp(value / x.length);\n}\n\n/**\n * The [Harmonic Mean](https://en.wikipedia.org/wiki/Harmonic_mean) is\n * a mean function typically used to find the average of rates.\n * This mean is calculated by taking the reciprocal of the arithmetic mean\n * of the reciprocals of the input numbers.\n *\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x sample of one or more data points\n * @returns {number} harmonic mean\n * @throws {Error} if x is empty\n * @throws {Error} if x contains a negative number\n * @example\n * harmonicMean([2, 3]).toFixed(2) // => '2.40'\n */\nfunction harmonicMean(x) {\n    if (x.length === 0) {\n        throw new Error(\"harmonicMean requires at least one data point\");\n    }\n\n    var reciprocalSum = 0;\n\n    for (var i = 0; i < x.length; i++) {\n        // the harmonic mean is only valid for positive numbers\n        if (x[i] <= 0) {\n            throw new Error(\n                \"harmonicMean requires only positive numbers as input\"\n            );\n        }\n\n        reciprocalSum += 1 / x[i];\n    }\n\n    // divide n by the reciprocal sum\n    return x.length / reciprocalSum;\n}\n\n/**\n * The mean, _also known as average_,\n * is the sum of all values over the number of values.\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * The simple mean uses the successive addition method internally\n * to calculate it's result. Errors in floating-point addition are\n * not accounted for, so if precision is required, the standard {@link mean}\n * method should be used instead.\n *\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n *\n * @param {Array<number>} x sample of one or more data points\n * @throws {Error} if the length of x is less than one\n * @returns {number} mean\n * @example\n * mean([0, 10]); // => 5\n */\nfunction meanSimple(x) {\n    if (x.length === 0) {\n        throw new Error(\"meanSimple requires at least one data point\");\n    }\n\n    return sumSimple(x) / x.length;\n}\n\n/**\n * The [median](http://en.wikipedia.org/wiki/Median) is\n * the middle number of a list. This is often a good indicator of 'the middle'\n * when there are outliers that skew the `mean()` value.\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\n * a method of finding a typical or central value of a set of numbers.\n *\n * The median isn't necessarily one of the elements in the list: the value\n * can be the average of two elements if the list has an even length\n * and the two central values are different.\n *\n * @param {Array<number>} sorted input\n * @returns {number} median value\n * @example\n * medianSorted([10, 2, 5, 100, 2, 1]); // => 52.5\n */\nfunction medianSorted(sorted) {\n    return quantileSorted(sorted, 0.5);\n}\n\n/**\n * When removing a value from a list, one does not have to necessary\n * recompute the mean of the list in linear time. They can instead use\n * this function to compute the new mean by providing the current mean,\n * the number of elements in the list that produced it and the value to remove.\n *\n * @since 3.0.0\n * @param {number} mean current mean\n * @param {number} n number of items in the list\n * @param {number} value the value to remove\n * @returns {number} the new mean\n *\n * @example\n * subtractFromMean(20.5, 6, 53); // => 14\n */\nfunction subtractFromMean(mean, n, value) {\n    return (mean * n - value) / (n - 1);\n}\n\n/**\n * The Root Mean Square (RMS) is\n * a mean function used as a measure of the magnitude of a set\n * of numbers, regardless of their sign.\n * This is the square root of the mean of the squares of the\n * input numbers.\n * This runs in `O(n)`, linear time, with respect to the length of the array.\n *\n * @param {Array<number>} x a sample of one or more data points\n * @returns {number} root mean square\n * @throws {Error} if x is empty\n * @example\n * rootMeanSquare([-1, 1, -1, 1]); // => 1\n */\nfunction rootMeanSquare(x) {\n    if (x.length === 0) {\n        throw new Error(\"rootMeanSquare requires at least one data point\");\n    }\n\n    var sumOfSquares = 0;\n    for (var i = 0; i < x.length; i++) {\n        sumOfSquares += Math.pow(x[i], 2);\n    }\n\n    return Math.sqrt(sumOfSquares / x.length);\n}\n\n/**\n * The`coefficient of variation`_ is the ratio of the standard deviation to the mean.\n * .._`coefficient of variation`: https://en.wikipedia.org/wiki/Coefficient_of_variation\n *\n *\n * @param {Array} x input\n * @returns {number} coefficient of variation\n * @example\n * coefficientOfVariation([1, 2, 3, 4]).toFixed(3); // => 0.516\n * coefficientOfVariation([1, 2, 3, 4, 5]).toFixed(3); // => 0.527\n * coefficientOfVariation([-1, 0, 1, 2, 3, 4]).toFixed(3); // => 1.247\n */\nfunction coefficientOfVariation(x) {\n    return sampleStandardDeviation(x) / mean(x);\n}\n\n/**\n * This is to compute [a one-sample t-test](https://en.wikipedia.org/wiki/Student%27s_t-test#One-sample_t-test), comparing the mean\n * of a sample to a known value, x.\n *\n * in this case, we're trying to determine whether the\n * population mean is equal to the value that we know, which is `x`\n * here. Usually the results here are used to look up a\n * [p-value](http://en.wikipedia.org/wiki/P-value), which, for\n * a certain level of significance, will let you determine that the\n * null hypothesis can or cannot be rejected.\n *\n * @param {Array<number>} x sample of one or more numbers\n * @param {number} expectedValue expected value of the population mean\n * @returns {number} value\n * @example\n * tTest([1, 2, 3, 4, 5, 6], 3.385).toFixed(2); // => '0.16'\n */\nfunction tTest(x, expectedValue) {\n    // The mean of the sample\n    var sampleMean = mean(x);\n\n    // The standard deviation of the sample\n    var sd = standardDeviation(x);\n\n    // Square root the length of the sample\n    var rootN = Math.sqrt(x.length);\n\n    // returning the t value\n    return (sampleMean - expectedValue) / (sd / rootN);\n}\n\n/**\n * This is to compute [two sample t-test](http://en.wikipedia.org/wiki/Student's_t-test).\n * Tests whether \"mean(X)-mean(Y) = difference\", (\n * in the most common case, we often have `difference == 0` to test if two samples\n * are likely to be taken from populations with the same mean value) with\n * no prior knowledge on standard deviations of both samples\n * other than the fact that they have the same standard deviation.\n *\n * Usually the results here are used to look up a\n * [p-value](http://en.wikipedia.org/wiki/P-value), which, for\n * a certain level of significance, will let you determine that the\n * null hypothesis can or cannot be rejected.\n *\n * `diff` can be omitted if it equals 0.\n *\n * [This is used to reject](https://en.wikipedia.org/wiki/Exclusion_of_the_null_hypothesis)\n * a null hypothesis that the two populations that have been sampled into\n * `sampleX` and `sampleY` are equal to each other.\n *\n * @param {Array<number>} sampleX a sample as an array of numbers\n * @param {Array<number>} sampleY a sample as an array of numbers\n * @param {number} [difference=0]\n * @returns {number|null} test result\n *\n * @example\n * tTestTwoSample([1, 2, 3, 4], [3, 4, 5, 6], 0); // => -2.1908902300206643\n */\nfunction tTestTwoSample(sampleX, sampleY, difference) {\n    var n = sampleX.length;\n    var m = sampleY.length;\n\n    // If either sample doesn't actually have any values, we can't\n    // compute this at all, so we return `null`.\n    if (!n || !m) {\n        return null;\n    }\n\n    // default difference (mu) is zero\n    if (!difference) {\n        difference = 0;\n    }\n\n    var meanX = mean(sampleX);\n    var meanY = mean(sampleY);\n    var sampleVarianceX = sampleVariance(sampleX);\n    var sampleVarianceY = sampleVariance(sampleY);\n\n    if (\n        typeof meanX === \"number\" &&\n        typeof meanY === \"number\" &&\n        typeof sampleVarianceX === \"number\" &&\n        typeof sampleVarianceY === \"number\"\n    ) {\n        var weightedVariance =\n            ((n - 1) * sampleVarianceX + (m - 1) * sampleVarianceY) /\n            (n + m - 2);\n\n        return (\n            (meanX - meanY - difference) /\n            Math.sqrt(weightedVariance * (1 / n + 1 / m))\n        );\n    }\n}\n\n/**\n * This function calculates the Wilcoxon rank sum statistic for the first sample\n * with respect to the second. The Wilcoxon rank sum test is a non-parametric\n * alternative to the t-test which is equivalent to the\n * [Mann-Whitney U test](https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test).\n * The statistic is calculated by pooling all the observations together, ranking them,\n * and then summing the ranks associated with one of the samples. If this rank sum is\n * sufficiently large or small we reject the hypothesis that the two samples come\n * from the same distribution in favor of the alternative that one is shifted with\n * respect to the other.\n *\n * @param {Array<number>} sampleX a sample as an array of numbers\n * @param {Array<number>} sampleY a sample as an array of numbers\n * @returns {number} rank sum for sampleX\n *\n * @example\n * wilcoxonRankSum([1, 4, 8], [9, 12, 15]); // => 6\n */\nfunction wilcoxonRankSum(sampleX, sampleY) {\n    if (!sampleX.length || !sampleY.length) {\n        throw new Error(\"Neither sample can be empty\");\n    }\n\n    var pooledSamples = sampleX\n        .map(function (x) { return ({ label: \"x\", value: x }); })\n        .concat(sampleY.map(function (y) { return ({ label: \"y\", value: y }); }))\n        .sort(function (a, b) { return a.value - b.value; });\n\n    for (var rank = 0; rank < pooledSamples.length; rank++) {\n        pooledSamples[rank].rank = rank;\n    }\n\n    var tiedRanks = [pooledSamples[0].rank];\n    for (var i = 1; i < pooledSamples.length; i++) {\n        if (pooledSamples[i].value === pooledSamples[i - 1].value) {\n            tiedRanks.push(pooledSamples[i].rank);\n            if (i === pooledSamples.length - 1) {\n                replaceRanksInPlace(pooledSamples, tiedRanks);\n            }\n        } else if (tiedRanks.length > 1) {\n            replaceRanksInPlace(pooledSamples, tiedRanks);\n        } else {\n            tiedRanks = [pooledSamples[i].rank];\n        }\n    }\n\n    function replaceRanksInPlace(pooledSamples, tiedRanks) {\n        var average = (tiedRanks[0] + tiedRanks[tiedRanks.length - 1]) / 2;\n        for (var i = 0; i < tiedRanks.length; i++) {\n            pooledSamples[tiedRanks[i]].rank = average;\n        }\n    }\n\n    var rankSum = 0;\n\n    for (var i$1 = 0; i$1 < pooledSamples.length; i$1++) {\n        var sample = pooledSamples[i$1];\n        if (sample.label === \"x\") {\n            rankSum += sample.rank + 1;\n        }\n    }\n\n    return rankSum;\n}\n\n/**\n * [Bayesian Classifier](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)\n *\n * This is a nave bayesian classifier that takes\n * singly-nested objects.\n *\n * @class\n * @example\n * var bayes = new BayesianClassifier();\n * bayes.train({\n *   species: 'Cat'\n * }, 'animal');\n * var result = bayes.score({\n *   species: 'Cat'\n * })\n * // result\n * // {\n * //   animal: 1\n * // }\n */\nvar BayesianClassifier = function BayesianClassifier() {\n    // The number of items that are currently\n    // classified in the model\n    this.totalCount = 0;\n    // Every item classified in the model\n    this.data = {};\n};\n\n/**\n * Train the classifier with a new item, which has a single\n * dimension of Javascript literal keys and values.\n *\n * @param {Object} item an object with singly-deep properties\n * @param {string} category the category this item belongs to\n * @return {undefined} adds the item to the classifier\n */\nBayesianClassifier.prototype.train = function train (item, category) {\n    // If the data object doesn't have any values\n    // for this category, create a new object for it.\n    if (!this.data[category]) {\n        this.data[category] = {};\n    }\n\n    // Iterate through each key in the item.\n    for (var k in item) {\n        var v = item[k];\n        // Initialize the nested object `data[category][k][item[k]]`\n        // with an object of keys that equal 0.\n        if (this.data[category][k] === undefined) {\n            this.data[category][k] = {};\n        }\n        if (this.data[category][k][v] === undefined) {\n            this.data[category][k][v] = 0;\n        }\n\n        // And increment the key for this key/value combination.\n        this.data[category][k][v]++;\n    }\n\n    // Increment the number of items classified\n    this.totalCount++;\n};\n\n/**\n * Generate a score of how well this item matches all\n * possible categories based on its attributes\n *\n * @param {Object} item an item in the same format as with train\n * @returns {Object} of probabilities that this item belongs to a\n * given category.\n */\nBayesianClassifier.prototype.score = function score (item) {\n    // Initialize an empty array of odds per category.\n    var odds = {};\n    var category;\n    // Iterate through each key in the item,\n    // then iterate through each category that has been used\n    // in previous calls to `.train()`\n    for (var k in item) {\n        var v = item[k];\n        for (category in this.data) {\n            // Create an empty object for storing key - value combinations\n            // for this category.\n            odds[category] = {};\n\n            // If this item doesn't even have a property, it counts for nothing,\n            // but if it does have the property that we're looking for from\n            // the item to categorize, it counts based on how popular it is\n            // versus the whole population.\n            if (this.data[category][k]) {\n                odds[category][k + \"_\" + v] =\n                    (this.data[category][k][v] || 0) / this.totalCount;\n            } else {\n                odds[category][k + \"_\" + v] = 0;\n            }\n        }\n    }\n\n    // Set up a new object that will contain sums of these odds by category\n    var oddsSums = {};\n\n    for (category in odds) {\n        // Tally all of the odds for each category-combination pair -\n        // the non-existence of a category does not add anything to the\n        // score.\n        oddsSums[category] = 0;\n        for (var combination in odds[category]) {\n            oddsSums[category] += odds[category][combination];\n        }\n    }\n\n    return oddsSums;\n};\n\n/**\n * This is a single-layer [Perceptron Classifier](http://en.wikipedia.org/wiki/Perceptron) that takes\n * arrays of numbers and predicts whether they should be classified\n * as either 0 or 1 (negative or positive examples).\n * @class\n * @example\n * // Create the model\n * var p = new PerceptronModel();\n * // Train the model with input with a diagonal boundary.\n * for (var i = 0; i < 5; i++) {\n *     p.train([1, 1], 1);\n *     p.train([0, 1], 0);\n *     p.train([1, 0], 0);\n *     p.train([0, 0], 0);\n * }\n * p.predict([0, 0]); // 0\n * p.predict([0, 1]); // 0\n * p.predict([1, 0]); // 0\n * p.predict([1, 1]); // 1\n */\nvar PerceptronModel = function PerceptronModel() {\n    // The weights, or coefficients of the model;\n    // weights are only populated when training with data.\n    this.weights = [];\n    // The bias term, or intercept; it is also a weight but\n    // it's stored separately for convenience as it is always\n    // multiplied by one.\n    this.bias = 0;\n};\n/**\n * **Predict**: Use an array of features with the weight array and bias\n * to predict whether an example is labeled 0 or 1.\n *\n * @param {Array<number>} features an array of features as numbers\n * @returns {number} 1 if the score is over 0, otherwise 0\n */\nPerceptronModel.prototype.predict = function predict (features) {\n    // Only predict if previously trained\n    // on the same size feature array(s).\n    if (features.length !== this.weights.length) {\n        return null;\n    }\n\n    // Calculate the sum of features times weights,\n    // with the bias added (implicitly times one).\n    var score = 0;\n    for (var i = 0; i < this.weights.length; i++) {\n        score += this.weights[i] * features[i];\n    }\n    score += this.bias;\n\n    // Classify as 1 if the score is over 0, otherwise 0.\n    if (score > 0) {\n        return 1;\n    } else {\n        return 0;\n    }\n};\n\n/**\n * **Train** the classifier with a new example, which is\n * a numeric array of features and a 0 or 1 label.\n *\n * @param {Array<number>} features an array of features as numbers\n * @param {number} label either 0 or 1\n * @returns {PerceptronModel} this\n */\nPerceptronModel.prototype.train = function train (features, label) {\n    // Require that only labels of 0 or 1 are considered.\n    if (label !== 0 && label !== 1) {\n        return null;\n    }\n    // The length of the feature array determines\n    // the length of the weight array.\n    // The perceptron will continue learning as long as\n    // it keeps seeing feature arrays of the same length.\n    // When it sees a new data shape, it initializes.\n    if (features.length !== this.weights.length) {\n        this.weights = features;\n        this.bias = 1;\n    }\n    // Make a prediction based on current weights.\n    var prediction = this.predict(features);\n    // Update the weights if the prediction is wrong.\n    if (typeof prediction === \"number\" && prediction !== label) {\n        var gradient = label - prediction;\n        for (var i = 0; i < this.weights.length; i++) {\n            this.weights[i] += gradient * features[i];\n        }\n        this.bias += gradient;\n    }\n    return this;\n};\n\n/**\n * We use ``, epsilon, as a stopping criterion when we want to iterate\n * until we're \"close enough\". Epsilon is a very small number: for\n * simple statistics, that number is **0.0001**\n *\n * This is used in calculations like the binomialDistribution, in which\n * the process of finding a value is [iterative](https://en.wikipedia.org/wiki/Iterative_method):\n * it progresses until it is close enough.\n *\n * Below is an example of using epsilon in [gradient descent](https://en.wikipedia.org/wiki/Gradient_descent),\n * where we're trying to find a local minimum of a function's derivative,\n * given by the `fDerivative` method.\n *\n * @example\n * // From calculation, we expect that the local minimum occurs at x=9/4\n * var x_old = 0;\n * // The algorithm starts at x=6\n * var x_new = 6;\n * var stepSize = 0.01;\n *\n * function fDerivative(x) {\n *   return 4 * Math.pow(x, 3) - 9 * Math.pow(x, 2);\n * }\n *\n * // The loop runs until the difference between the previous\n * // value and the current value is smaller than epsilon - a rough\n * // meaure of 'close enough'\n * while (Math.abs(x_new - x_old) > ss.epsilon) {\n *   x_old = x_new;\n *   x_new = x_old - stepSize * fDerivative(x_old);\n * }\n *\n * console.log('Local minimum occurs at', x_new);\n */\nvar epsilon = 0.0001;\n\n/**\n * A [Factorial](https://en.wikipedia.org/wiki/Factorial), usually written n!, is the product of all positive\n * integers less than or equal to n. Often factorial is implemented\n * recursively, but this iterative approach is significantly faster\n * and simpler.\n *\n * @param {number} n input, must be an integer number 1 or greater\n * @returns {number} factorial: n!\n * @throws {Error} if n is less than 0 or not an integer\n * @example\n * factorial(5); // => 120\n */\nfunction factorial(n) {\n    // factorial is mathematically undefined for negative numbers\n    if (n < 0) {\n        throw new Error(\"factorial requires a non-negative value\");\n    }\n\n    if (Math.floor(n) !== n) {\n        throw new Error(\"factorial requires an integer input\");\n    }\n\n    // typically you'll expand the factorial function going down, like\n    // 5! = 5 * 4 * 3 * 2 * 1. This is going in the opposite direction,\n    // counting from 2 up to the number in question, and since anything\n    // multiplied by 1 is itself, the loop only needs to start at 2.\n    var accumulator = 1;\n    for (var i = 2; i <= n; i++) {\n        // for each number up to and including the number `n`, multiply\n        // the accumulator my that number.\n        accumulator *= i;\n    }\n    return accumulator;\n}\n\n/**\n * Compute the [gamma function](https://en.wikipedia.org/wiki/Gamma_function) of a value using Nemes' approximation.\n * The gamma of n is equivalent to (n-1)!, but unlike the factorial function, gamma is defined for all real n except zero\n * and negative integers (where NaN is returned). Note, the gamma function is also well-defined for complex numbers,\n * though this implementation currently does not handle complex numbers as input values.\n * Nemes' approximation is defined [here](https://arxiv.org/abs/1003.6020) as Theorem 2.2.\n * Negative values use [Euler's reflection formula](https://en.wikipedia.org/wiki/Gamma_function#Properties) for computation.\n *\n * @param {number} n Any real number except for zero and negative integers.\n * @returns {number} The gamma of the input value.\n *\n * @example\n * gamma(11.5); // 11899423.084037038\n * gamma(-11.5); // 2.29575810481609e-8\n * gamma(5); // 24\n */\nfunction gamma(n) {\n    if (Number.isInteger(n)) {\n        if (n <= 0) {\n            // gamma not defined for zero or negative integers\n            return Number.NaN;\n        } else {\n            // use factorial for integer inputs\n            return factorial(n - 1);\n        }\n    }\n\n    // Decrement n, because approximation is defined for n - 1\n    n--;\n\n    if (n < 0) {\n        // Use Euler's reflection formula for negative inputs\n        // see:  https://en.wikipedia.org/wiki/Gamma_function#Properties\n        return Math.PI / (Math.sin(Math.PI * -n) * gamma(-n));\n    } else {\n        // Nemes' expansion approximation\n        var seriesCoefficient =\n            Math.pow(n / Math.E, n) * Math.sqrt(2 * Math.PI * (n + 1 / 6));\n\n        var seriesDenom = n + 1 / 4;\n\n        var seriesExpansion =\n            1 +\n            1 / 144 / Math.pow(seriesDenom, 2) -\n            1 / 12960 / Math.pow(seriesDenom, 3) -\n            257 / 207360 / Math.pow(seriesDenom, 4) -\n            52 / 2612736 / Math.pow(seriesDenom, 5) +\n            5741173 / 9405849600 / Math.pow(seriesDenom, 6) +\n            37529 / 18811699200 / Math.pow(seriesDenom, 7);\n\n        return seriesCoefficient * seriesExpansion;\n    }\n}\n\n// Define series coefficients\nvar COEFFICIENTS = [\n    0.99999999999999709182, 57.156235665862923517, -59.597960355475491248,\n    14.136097974741747174, -0.49191381609762019978, 0.33994649984811888699e-4,\n    0.46523628927048575665e-4, -0.98374475304879564677e-4,\n    0.15808870322491248884e-3, -0.21026444172410488319e-3,\n    0.2174396181152126432e-3, -0.16431810653676389022e-3,\n    0.84418223983852743293e-4, -0.2619083840158140867e-4,\n    0.36899182659531622704e-5\n];\n\nvar g = 607 / 128;\nvar LOGSQRT2PI = Math.log(Math.sqrt(2 * Math.PI));\n\n/**\n * Compute the logarithm of the [gamma function](https://en.wikipedia.org/wiki/Gamma_function) of a value using Lanczos' approximation.\n * This function takes as input any real-value n greater than 0.\n * This function is useful for values of n too large for the normal gamma function (n > 165).\n * The code is based on Lanczo's Gamma approximation, defined [here](http://my.fit.edu/~gabdo/gamma.txt).\n *\n * @param {number} n Any real number greater than zero.\n * @returns {number} The logarithm of gamma of the input value.\n *\n * @example\n * gammaln(500); // 2605.1158503617335\n * gammaln(2.4); // 0.21685932244884043\n */\nfunction gammaln(n) {\n    // Return infinity if value not in domain\n    if (n <= 0) {\n        return Number.POSITIVE_INFINITY;\n    }\n\n    // Decrement n, because approximation is defined for n - 1\n    n--;\n\n    // Create series approximation\n    var a = COEFFICIENTS[0];\n\n    for (var i = 1; i < 15; i++) {\n        a += COEFFICIENTS[i] / (n + i);\n    }\n\n    var tmp = g + 0.5 + n;\n\n    // Return natural logarithm of gamma(n)\n    return LOGSQRT2PI + Math.log(a) - tmp + (n + 0.5) * Math.log(tmp);\n}\n\n/**\n * The [Bernoulli distribution](http://en.wikipedia.org/wiki/Bernoulli_distribution)\n * is the probability discrete\n * distribution of a random variable which takes value 1 with success\n * probability `p` and value 0 with failure\n * probability `q` = 1 - `p`. It can be used, for example, to represent the\n * toss of a coin, where \"1\" is defined to mean \"heads\" and \"0\" is defined\n * to mean \"tails\" (or vice versa). It is\n * a special case of a Binomial Distribution\n * where `n` = 1.\n *\n * @param {number} p input value, between 0 and 1 inclusive\n * @returns {number[]} values of bernoulli distribution at this point\n * @throws {Error} if p is outside 0 and 1\n * @example\n * bernoulliDistribution(0.3); // => [0.7, 0.3]\n */\nfunction bernoulliDistribution(p) /*: number[] */ {\n    // Check that `p` is a valid probability (0  p  1)\n    if (p < 0 || p > 1) {\n        throw new Error(\n            \"bernoulliDistribution requires probability to be between 0 and 1 inclusive\"\n        );\n    }\n\n    return [1 - p, p];\n}\n\n/**\n * The [Binomial Distribution](http://en.wikipedia.org/wiki/Binomial_distribution) is the discrete probability\n * distribution of the number of successes in a sequence of n independent yes/no experiments, each of which yields\n * success with probability `probability`. Such a success/failure experiment is also called a Bernoulli experiment or\n * Bernoulli trial; when trials = 1, the Binomial Distribution is a Bernoulli Distribution.\n *\n * @param {number} trials number of trials to simulate\n * @param {number} probability\n * @returns {number[]} output\n */\nfunction binomialDistribution(trials, probability) /*: ?number[] */ {\n    // Check that `p` is a valid probability (0  p  1),\n    // that `n` is an integer, strictly positive.\n    if (probability < 0 || probability > 1 || trials <= 0 || trials % 1 !== 0) {\n        return undefined;\n    }\n\n    // We initialize `x`, the random variable, and `accumulator`, an accumulator\n    // for the cumulative distribution function to 0. `distribution_functions`\n    // is the object we'll return with the `probability_of_x` and the\n    // `cumulativeProbability_of_x`, as well as the calculated mean &\n    // variance. We iterate until the `cumulativeProbability_of_x` is\n    // within `epsilon` of 1.0.\n    var x = 0;\n    var cumulativeProbability = 0;\n    var cells = [];\n    var binomialCoefficient = 1;\n\n    // This algorithm iterates through each potential outcome,\n    // until the `cumulativeProbability` is very close to 1, at\n    // which point we've defined the vast majority of outcomes\n    do {\n        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)\n        cells[x] =\n            binomialCoefficient *\n            Math.pow(probability, x) *\n            Math.pow(1 - probability, trials - x);\n        cumulativeProbability += cells[x];\n        x++;\n        binomialCoefficient = (binomialCoefficient * (trials - x + 1)) / x;\n        // when the cumulativeProbability is nearly 1, we've calculated\n        // the useful range of this distribution\n    } while (cumulativeProbability < 1 - epsilon);\n\n    return cells;\n}\n\n/**\n * The [Poisson Distribution](http://en.wikipedia.org/wiki/Poisson_distribution)\n * is a discrete probability distribution that expresses the probability\n * of a given number of events occurring in a fixed interval of time\n * and/or space if these events occur with a known average rate and\n * independently of the time since the last event.\n *\n * The Poisson Distribution is characterized by the strictly positive\n * mean arrival or occurrence rate, ``.\n *\n * @param {number} lambda location poisson distribution\n * @returns {number[]} values of poisson distribution at that point\n */\nfunction poissonDistribution(lambda) /*: ?number[] */ {\n    // Check that lambda is strictly positive\n    if (lambda <= 0) {\n        return undefined;\n    }\n\n    // our current place in the distribution\n    var x = 0;\n    // and we keep track of the current cumulative probability, in\n    // order to know when to stop calculating chances.\n    var cumulativeProbability = 0;\n    // the calculated cells to be returned\n    var cells = [];\n    var factorialX = 1;\n\n    // This algorithm iterates through each potential outcome,\n    // until the `cumulativeProbability` is very close to 1, at\n    // which point we've defined the vast majority of outcomes\n    do {\n        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)\n        cells[x] = (Math.exp(-lambda) * Math.pow(lambda, x)) / factorialX;\n        cumulativeProbability += cells[x];\n        x++;\n        factorialX *= x;\n        // when the cumulativeProbability is nearly 1, we've calculated\n        // the useful range of this distribution\n    } while (cumulativeProbability < 1 - epsilon);\n\n    return cells;\n}\n\n/**\n * **Percentage Points of the 2 (Chi-Squared) Distribution**\n *\n * The [2 (Chi-Squared) Distribution](http://en.wikipedia.org/wiki/Chi-squared_distribution) is used in the common\n * chi-squared tests for goodness of fit of an observed distribution to a theoretical one, the independence of two\n * criteria of classification of qualitative data, and in confidence interval estimation for a population standard\n * deviation of a normal distribution from a sample standard deviation.\n *\n * Values from Appendix 1, Table III of William W. Hines & Douglas C. Montgomery, \"Probability and Statistics in\n * Engineering and Management Science\", Wiley (1980).\n */\nvar chiSquaredDistributionTable = {\n    1: {\n        0.995: 0,\n        0.99: 0,\n        0.975: 0,\n        0.95: 0,\n        0.9: 0.02,\n        0.5: 0.45,\n        0.1: 2.71,\n        0.05: 3.84,\n        0.025: 5.02,\n        0.01: 6.63,\n        0.005: 7.88\n    },\n    2: {\n        0.995: 0.01,\n        0.99: 0.02,\n        0.975: 0.05,\n        0.95: 0.1,\n        0.9: 0.21,\n        0.5: 1.39,\n        0.1: 4.61,\n        0.05: 5.99,\n        0.025: 7.38,\n        0.01: 9.21,\n        0.005: 10.6\n    },\n    3: {\n        0.995: 0.07,\n        0.99: 0.11,\n        0.975: 0.22,\n        0.95: 0.35,\n        0.9: 0.58,\n        0.5: 2.37,\n        0.1: 6.25,\n        0.05: 7.81,\n        0.025: 9.35,\n        0.01: 11.34,\n        0.005: 12.84\n    },\n    4: {\n        0.995: 0.21,\n        0.99: 0.3,\n        0.975: 0.48,\n        0.95: 0.71,\n        0.9: 1.06,\n        0.5: 3.36,\n        0.1: 7.78,\n        0.05: 9.49,\n        0.025: 11.14,\n        0.01: 13.28,\n        0.005: 14.86\n    },\n    5: {\n        0.995: 0.41,\n        0.99: 0.55,\n        0.975: 0.83,\n        0.95: 1.15,\n        0.9: 1.61,\n        0.5: 4.35,\n        0.1: 9.24,\n        0.05: 11.07,\n        0.025: 12.83,\n        0.01: 15.09,\n        0.005: 16.75\n    },\n    6: {\n        0.995: 0.68,\n        0.99: 0.87,\n        0.975: 1.24,\n        0.95: 1.64,\n        0.9: 2.2,\n        0.5: 5.35,\n        0.1: 10.65,\n        0.05: 12.59,\n        0.025: 14.45,\n        0.01: 16.81,\n        0.005: 18.55\n    },\n    7: {\n        0.995: 0.99,\n        0.99: 1.25,\n        0.975: 1.69,\n        0.95: 2.17,\n        0.9: 2.83,\n        0.5: 6.35,\n        0.1: 12.02,\n        0.05: 14.07,\n        0.025: 16.01,\n        0.01: 18.48,\n        0.005: 20.28\n    },\n    8: {\n        0.995: 1.34,\n        0.99: 1.65,\n        0.975: 2.18,\n        0.95: 2.73,\n        0.9: 3.49,\n        0.5: 7.34,\n        0.1: 13.36,\n        0.05: 15.51,\n        0.025: 17.53,\n        0.01: 20.09,\n        0.005: 21.96\n    },\n    9: {\n        0.995: 1.73,\n        0.99: 2.09,\n        0.975: 2.7,\n        0.95: 3.33,\n        0.9: 4.17,\n        0.5: 8.34,\n        0.1: 14.68,\n        0.05: 16.92,\n        0.025: 19.02,\n        0.01: 21.67,\n        0.005: 23.59\n    },\n    10: {\n        0.995: 2.16,\n        0.99: 2.56,\n        0.975: 3.25,\n        0.95: 3.94,\n        0.9: 4.87,\n        0.5: 9.34,\n        0.1: 15.99,\n        0.05: 18.31,\n        0.025: 20.48,\n        0.01: 23.21,\n        0.005: 25.19\n    },\n    11: {\n        0.995: 2.6,\n        0.99: 3.05,\n        0.975: 3.82,\n        0.95: 4.57,\n        0.9: 5.58,\n        0.5: 10.34,\n        0.1: 17.28,\n        0.05: 19.68,\n        0.025: 21.92,\n        0.01: 24.72,\n        0.005: 26.76\n    },\n    12: {\n        0.995: 3.07,\n        0.99: 3.57,\n        0.975: 4.4,\n        0.95: 5.23,\n        0.9: 6.3,\n        0.5: 11.34,\n        0.1: 18.55,\n        0.05: 21.03,\n        0.025: 23.34,\n        0.01: 26.22,\n        0.005: 28.3\n    },\n    13: {\n        0.995: 3.57,\n        0.99: 4.11,\n        0.975: 5.01,\n        0.95: 5.89,\n        0.9: 7.04,\n        0.5: 12.34,\n        0.1: 19.81,\n        0.05: 22.36,\n        0.025: 24.74,\n        0.01: 27.69,\n        0.005: 29.82\n    },\n    14: {\n        0.995: 4.07,\n        0.99: 4.66,\n        0.975: 5.63,\n        0.95: 6.57,\n        0.9: 7.79,\n        0.5: 13.34,\n        0.1: 21.06,\n        0.05: 23.68,\n        0.025: 26.12,\n        0.01: 29.14,\n        0.005: 31.32\n    },\n    15: {\n        0.995: 4.6,\n        0.99: 5.23,\n        0.975: 6.27,\n        0.95: 7.26,\n        0.9: 8.55,\n        0.5: 14.34,\n        0.1: 22.31,\n        0.05: 25,\n        0.025: 27.49,\n        0.01: 30.58,\n        0.005: 32.8\n    },\n    16: {\n        0.995: 5.14,\n        0.99: 5.81,\n        0.975: 6.91,\n        0.95: 7.96,\n        0.9: 9.31,\n        0.5: 15.34,\n        0.1: 23.54,\n        0.05: 26.3,\n        0.025: 28.85,\n        0.01: 32,\n        0.005: 34.27\n    },\n    17: {\n        0.995: 5.7,\n        0.99: 6.41,\n        0.975: 7.56,\n        0.95: 8.67,\n        0.9: 10.09,\n        0.5: 16.34,\n        0.1: 24.77,\n        0.05: 27.59,\n        0.025: 30.19,\n        0.01: 33.41,\n        0.005: 35.72\n    },\n    18: {\n        0.995: 6.26,\n        0.99: 7.01,\n        0.975: 8.23,\n        0.95: 9.39,\n        0.9: 10.87,\n        0.5: 17.34,\n        0.1: 25.99,\n        0.05: 28.87,\n        0.025: 31.53,\n        0.01: 34.81,\n        0.005: 37.16\n    },\n    19: {\n        0.995: 6.84,\n        0.99: 7.63,\n        0.975: 8.91,\n        0.95: 10.12,\n        0.9: 11.65,\n        0.5: 18.34,\n        0.1: 27.2,\n        0.05: 30.14,\n        0.025: 32.85,\n        0.01: 36.19,\n        0.005: 38.58\n    },\n    20: {\n        0.995: 7.43,\n        0.99: 8.26,\n        0.975: 9.59,\n        0.95: 10.85,\n        0.9: 12.44,\n        0.5: 19.34,\n        0.1: 28.41,\n        0.05: 31.41,\n        0.025: 34.17,\n        0.01: 37.57,\n        0.005: 40\n    },\n    21: {\n        0.995: 8.03,\n        0.99: 8.9,\n        0.975: 10.28,\n        0.95: 11.59,\n        0.9: 13.24,\n        0.5: 20.34,\n        0.1: 29.62,\n        0.05: 32.67,\n        0.025: 35.48,\n        0.01: 38.93,\n        0.005: 41.4\n    },\n    22: {\n        0.995: 8.64,\n        0.99: 9.54,\n        0.975: 10.98,\n        0.95: 12.34,\n        0.9: 14.04,\n        0.5: 21.34,\n        0.1: 30.81,\n        0.05: 33.92,\n        0.025: 36.78,\n        0.01: 40.29,\n        0.005: 42.8\n    },\n    23: {\n        0.995: 9.26,\n        0.99: 10.2,\n        0.975: 11.69,\n        0.95: 13.09,\n        0.9: 14.85,\n        0.5: 22.34,\n        0.1: 32.01,\n        0.05: 35.17,\n        0.025: 38.08,\n        0.01: 41.64,\n        0.005: 44.18\n    },\n    24: {\n        0.995: 9.89,\n        0.99: 10.86,\n        0.975: 12.4,\n        0.95: 13.85,\n        0.9: 15.66,\n        0.5: 23.34,\n        0.1: 33.2,\n        0.05: 36.42,\n        0.025: 39.36,\n        0.01: 42.98,\n        0.005: 45.56\n    },\n    25: {\n        0.995: 10.52,\n        0.99: 11.52,\n        0.975: 13.12,\n        0.95: 14.61,\n        0.9: 16.47,\n        0.5: 24.34,\n        0.1: 34.28,\n        0.05: 37.65,\n        0.025: 40.65,\n        0.01: 44.31,\n        0.005: 46.93\n    },\n    26: {\n        0.995: 11.16,\n        0.99: 12.2,\n        0.975: 13.84,\n        0.95: 15.38,\n        0.9: 17.29,\n        0.5: 25.34,\n        0.1: 35.56,\n        0.05: 38.89,\n        0.025: 41.92,\n        0.01: 45.64,\n        0.005: 48.29\n    },\n    27: {\n        0.995: 11.81,\n        0.99: 12.88,\n        0.975: 14.57,\n        0.95: 16.15,\n        0.9: 18.11,\n        0.5: 26.34,\n        0.1: 36.74,\n        0.05: 40.11,\n        0.025: 43.19,\n        0.01: 46.96,\n        0.005: 49.65\n    },\n    28: {\n        0.995: 12.46,\n        0.99: 13.57,\n        0.975: 15.31,\n        0.95: 16.93,\n        0.9: 18.94,\n        0.5: 27.34,\n        0.1: 37.92,\n        0.05: 41.34,\n        0.025: 44.46,\n        0.01: 48.28,\n        0.005: 50.99\n    },\n    29: {\n        0.995: 13.12,\n        0.99: 14.26,\n        0.975: 16.05,\n        0.95: 17.71,\n        0.9: 19.77,\n        0.5: 28.34,\n        0.1: 39.09,\n        0.05: 42.56,\n        0.025: 45.72,\n        0.01: 49.59,\n        0.005: 52.34\n    },\n    30: {\n        0.995: 13.79,\n        0.99: 14.95,\n        0.975: 16.79,\n        0.95: 18.49,\n        0.9: 20.6,\n        0.5: 29.34,\n        0.1: 40.26,\n        0.05: 43.77,\n        0.025: 46.98,\n        0.01: 50.89,\n        0.005: 53.67\n    },\n    40: {\n        0.995: 20.71,\n        0.99: 22.16,\n        0.975: 24.43,\n        0.95: 26.51,\n        0.9: 29.05,\n        0.5: 39.34,\n        0.1: 51.81,\n        0.05: 55.76,\n        0.025: 59.34,\n        0.01: 63.69,\n        0.005: 66.77\n    },\n    50: {\n        0.995: 27.99,\n        0.99: 29.71,\n        0.975: 32.36,\n        0.95: 34.76,\n        0.9: 37.69,\n        0.5: 49.33,\n        0.1: 63.17,\n        0.05: 67.5,\n        0.025: 71.42,\n        0.01: 76.15,\n        0.005: 79.49\n    },\n    60: {\n        0.995: 35.53,\n        0.99: 37.48,\n        0.975: 40.48,\n        0.95: 43.19,\n        0.9: 46.46,\n        0.5: 59.33,\n        0.1: 74.4,\n        0.05: 79.08,\n        0.025: 83.3,\n        0.01: 88.38,\n        0.005: 91.95\n    },\n    70: {\n        0.995: 43.28,\n        0.99: 45.44,\n        0.975: 48.76,\n        0.95: 51.74,\n        0.9: 55.33,\n        0.5: 69.33,\n        0.1: 85.53,\n        0.05: 90.53,\n        0.025: 95.02,\n        0.01: 100.42,\n        0.005: 104.22\n    },\n    80: {\n        0.995: 51.17,\n        0.99: 53.54,\n        0.975: 57.15,\n        0.95: 60.39,\n        0.9: 64.28,\n        0.5: 79.33,\n        0.1: 96.58,\n        0.05: 101.88,\n        0.025: 106.63,\n        0.01: 112.33,\n        0.005: 116.32\n    },\n    90: {\n        0.995: 59.2,\n        0.99: 61.75,\n        0.975: 65.65,\n        0.95: 69.13,\n        0.9: 73.29,\n        0.5: 89.33,\n        0.1: 107.57,\n        0.05: 113.14,\n        0.025: 118.14,\n        0.01: 124.12,\n        0.005: 128.3\n    },\n    100: {\n        0.995: 67.33,\n        0.99: 70.06,\n        0.975: 74.22,\n        0.95: 77.93,\n        0.9: 82.36,\n        0.5: 99.33,\n        0.1: 118.5,\n        0.05: 124.34,\n        0.025: 129.56,\n        0.01: 135.81,\n        0.005: 140.17\n    }\n};\n\n/**\n * The [2 (Chi-Squared) Goodness-of-Fit Test](http://en.wikipedia.org/wiki/Goodness_of_fit#Pearson.27s_chi-squared_test)\n * uses a measure of goodness of fit which is the sum of differences between observed and expected outcome frequencies\n * (that is, counts of observations), each squared and divided by the number of observations expected given the\n * hypothesized distribution. The resulting 2 statistic, `chiSquared`, can be compared to the chi-squared distribution\n * to determine the goodness of fit. In order to determine the degrees of freedom of the chi-squared distribution, one\n * takes the total number of observed frequencies and subtracts the number of estimated parameters. The test statistic\n * follows, approximately, a chi-square distribution with (k  c) degrees of freedom where `k` is the number of non-empty\n * cells and `c` is the number of estimated parameters for the distribution.\n *\n * @param {Array<number>} data\n * @param {Function} distributionType a function that returns a point in a distribution:\n * for instance, binomial, bernoulli, or poisson\n * @param {number} significance\n * @returns {number} chi squared goodness of fit\n * @example\n * // Data from Poisson goodness-of-fit example 10-19 in William W. Hines & Douglas C. Montgomery,\n * // \"Probability and Statistics in Engineering and Management Science\", Wiley (1980).\n * var data1019 = [\n *     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n *     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n *     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n *     2, 2, 2, 2, 2, 2, 2, 2, 2,\n *     3, 3, 3, 3\n * ];\n * ss.chiSquaredGoodnessOfFit(data1019, ss.poissonDistribution, 0.05); //= false\n */\nfunction chiSquaredGoodnessOfFit(data, distributionType, significance) {\n    // Estimate from the sample data, a weighted mean.\n    var inputMean = mean(data);\n    // Calculated value of the 2 statistic.\n    var chiSquared = 0;\n    // Number of hypothesized distribution parameters estimated, expected to be supplied in the distribution test.\n    // Lose one degree of freedom for estimating `lambda` from the sample data.\n    var c = 1;\n    // The hypothesized distribution.\n    // Generate the hypothesized distribution.\n    var hypothesizedDistribution = distributionType(inputMean);\n    var observedFrequencies = [];\n    var expectedFrequencies = [];\n\n    // Create an array holding a histogram from the sample data, of\n    // the form `{ value: numberOfOcurrences }`\n    for (var i = 0; i < data.length; i++) {\n        if (observedFrequencies[data[i]] === undefined) {\n            observedFrequencies[data[i]] = 0;\n        }\n        observedFrequencies[data[i]]++;\n    }\n\n    // The histogram we created might be sparse - there might be gaps\n    // between values. So we iterate through the histogram, making\n    // sure that instead of undefined, gaps have 0 values.\n    for (var i$1 = 0; i$1 < observedFrequencies.length; i$1++) {\n        if (observedFrequencies[i$1] === undefined) {\n            observedFrequencies[i$1] = 0;\n        }\n    }\n\n    // Create an array holding a histogram of expected data given the\n    // sample size and hypothesized distribution.\n    for (var k in hypothesizedDistribution) {\n        if (k in observedFrequencies) {\n            expectedFrequencies[+k] = hypothesizedDistribution[k] * data.length;\n        }\n    }\n\n    // Working backward through the expected frequencies, collapse classes\n    // if less than three observations are expected for a class.\n    // This transformation is applied to the observed frequencies as well.\n    for (var k$1 = expectedFrequencies.length - 1; k$1 >= 0; k$1--) {\n        if (expectedFrequencies[k$1] < 3) {\n            expectedFrequencies[k$1 - 1] += expectedFrequencies[k$1];\n            expectedFrequencies.pop();\n\n            observedFrequencies[k$1 - 1] += observedFrequencies[k$1];\n            observedFrequencies.pop();\n        }\n    }\n\n    // Iterate through the squared differences between observed & expected\n    // frequencies, accumulating the `chiSquared` statistic.\n    for (var k$2 = 0; k$2 < observedFrequencies.length; k$2++) {\n        chiSquared +=\n            Math.pow(observedFrequencies[k$2] - expectedFrequencies[k$2], 2) /\n            expectedFrequencies[k$2];\n    }\n\n    // Calculate degrees of freedom for this test and look it up in the\n    // `chiSquaredDistributionTable` in order to\n    // accept or reject the goodness-of-fit of the hypothesized distribution.\n    // Degrees of freedom, calculated as (number of class intervals -\n    // number of hypothesized distribution parameters estimated - 1)\n    var degreesOfFreedom = observedFrequencies.length - c - 1;\n    return (\n        chiSquaredDistributionTable[degreesOfFreedom][significance] < chiSquared\n    );\n}\n\nvar SQRT_2PI$1 = Math.sqrt(2 * Math.PI);\n\n/**\n * [Well-known kernels](https://en.wikipedia.org/wiki/Kernel_(statistics)#Kernel_functions_in_common_use)\n * @private\n */\nvar kernels = {\n    /**\n     * The gaussian kernel.\n     * @private\n     */\n    gaussian: function (u) {\n        return Math.exp(-0.5 * u * u) / SQRT_2PI$1;\n    }\n};\n\n/**\n * Well known bandwidth selection methods\n * @private\n */\nvar bandwidthMethods = {\n    /**\n     * The [\"normal reference distribution\"\n     * rule-of-thumb](https://stat.ethz.ch/R-manual/R-devel/library/MASS/html/bandwidth.nrd.html),\n     * a commonly used version of [Silverman's\n     * rule-of-thumb](https://en.wikipedia.org/wiki/Kernel_density_estimation#A_rule-of-thumb_bandwidth_estimator).\n     * @private\n     */\n    nrd: function (x) {\n        var s = sampleStandardDeviation(x);\n        var iqr = interquartileRange(x);\n        if (typeof iqr === \"number\") {\n            s = Math.min(s, iqr / 1.34);\n        }\n        return 1.06 * s * Math.pow(x.length, -0.2);\n    }\n};\n\n/**\n * [Kernel density estimation](https://en.wikipedia.org/wiki/Kernel_density_estimation)\n * is a useful tool for, among other things, estimating the shape of the\n * underlying probability distribution from a sample.\n *\n * @name kernelDensityEstimation\n * @param X sample values\n * @param kernel The kernel function to use. If a function is provided, it should return non-negative values and integrate to 1. Defaults to 'gaussian'.\n * @param bandwidthMethod The \"bandwidth selection\" method to use, or a fixed bandwidth value. Defaults to \"nrd\", the commonly-used [\"normal reference distribution\" rule-of-thumb](https://stat.ethz.ch/R-manual/R-devel/library/MASS/html/bandwidth.nrd.html).\n * @returns {Function} An estimated [probability density function](https://en.wikipedia.org/wiki/Probability_density_function) for the given sample. The returned function runs in `O(X.length)`.\n */\nfunction kernelDensityEstimation(X, kernel, bandwidthMethod) {\n    var kernelFn;\n    if (kernel === undefined) {\n        kernelFn = kernels.gaussian;\n    } else if (typeof kernel === \"string\") {\n        if (!kernels[kernel]) {\n            throw new Error('Unknown kernel \"' + kernel + '\"');\n        }\n        kernelFn = kernels[kernel];\n    } else {\n        kernelFn = kernel;\n    }\n\n    var bandwidth;\n    if (typeof bandwidthMethod === \"undefined\") {\n        bandwidth = bandwidthMethods.nrd(X);\n    } else if (typeof bandwidthMethod === \"string\") {\n        if (!bandwidthMethods[bandwidthMethod]) {\n            throw new Error(\n                'Unknown bandwidth method \"' + bandwidthMethod + '\"'\n            );\n        }\n        bandwidth = bandwidthMethods[bandwidthMethod](X);\n    } else {\n        bandwidth = bandwidthMethod;\n    }\n\n    return function (x) {\n        var i = 0;\n        var sum = 0;\n        for (i = 0; i < X.length; i++) {\n            sum += kernelFn((x - X[i]) / bandwidth);\n        }\n        return sum / bandwidth / X.length;\n    };\n}\n\n/**\n * The [Z-Score, or Standard Score](http://en.wikipedia.org/wiki/Standard_score).\n *\n * The standard score is the number of standard deviations an observation\n * or datum is above or below the mean. Thus, a positive standard score\n * represents a datum above the mean, while a negative standard score\n * represents a datum below the mean. It is a dimensionless quantity\n * obtained by subtracting the population mean from an individual raw\n * score and then dividing the difference by the population standard\n * deviation.\n *\n * The z-score is only defined if one knows the population parameters;\n * if one only has a sample set, then the analogous computation with\n * sample mean and sample standard deviation yields the\n * Student's t-statistic.\n *\n * @param {number} x\n * @param {number} mean\n * @param {number} standardDeviation\n * @return {number} z score\n * @example\n * zScore(78, 80, 5); // => -0.4\n */\nfunction zScore(x, mean, standardDeviation) {\n    return (x - mean) / standardDeviation;\n}\n\nvar SQRT_2PI = Math.sqrt(2 * Math.PI);\n\nfunction cumulativeDistribution(z) {\n    var sum = z;\n    var tmp = z;\n\n    // 15 iterations are enough for 4-digit precision\n    for (var i = 1; i < 15; i++) {\n        tmp *= (z * z) / (2 * i + 1);\n        sum += tmp;\n    }\n    return (\n        Math.round((0.5 + (sum / SQRT_2PI) * Math.exp((-z * z) / 2)) * 1e4) /\n        1e4\n    );\n}\n\n/**\n * A standard normal table, also called the unit normal table or Z table,\n * is a mathematical table for the values of  (phi), which are the values of\n * the [cumulative distribution function](https://en.wikipedia.org/wiki/Normal_distribution#Cumulative_distribution_function)\n * of the normal distribution. It is used to find the probability that a\n * statistic is observed below, above, or between values on the standard\n * normal distribution, and by extension, any normal distribution.\n */\nvar standardNormalTable = [];\n\nfor (var z = 0; z <= 3.09; z += 0.01) {\n    standardNormalTable.push(cumulativeDistribution(z));\n}\n\n/**\n * **[Cumulative Standard Normal Probability](http://en.wikipedia.org/wiki/Standard_normal_table)**\n *\n * Since probability tables cannot be\n * printed for every normal distribution, as there are an infinite variety\n * of normal distributions, it is common practice to convert a normal to a\n * standard normal and then use the standard normal table to find probabilities.\n *\n * You can use `.5 + .5 * errorFunction(x / Math.sqrt(2))` to calculate the probability\n * instead of looking it up in a table.\n *\n * @param {number} z\n * @returns {number} cumulative standard normal probability\n */\nfunction cumulativeStdNormalProbability(z) {\n    // Calculate the position of this value.\n    var absZ = Math.abs(z);\n    // Each row begins with a different\n    // significant digit: 0.5, 0.6, 0.7, and so on. Each value in the table\n    // corresponds to a range of 0.01 in the input values, so the value is\n    // multiplied by 100.\n    var index = Math.min(\n        Math.round(absZ * 100),\n        standardNormalTable.length - 1\n    );\n\n    // The index we calculate must be in the table as a positive value,\n    // but we still pay attention to whether the input is positive\n    // or negative, and flip the output value as a last step.\n    if (z >= 0) {\n        return standardNormalTable[index];\n    } else {\n        // due to floating-point arithmetic, values in the table with\n        // 4 significant figures can nevertheless end up as repeating\n        // fractions when they're computed here.\n        return Math.round((1 - standardNormalTable[index]) * 1e4) / 1e4;\n    }\n}\n\n/**\n * **[Logistic Cumulative Distribution Function](https://en.wikipedia.org/wiki/Logistic_distribution)**\n *\n * @param {number} x\n * @returns {number} cumulative standard logistic probability\n */\nfunction cumulativeStdLogisticProbability(x) {\n    return 1 / (Math.exp(-x) + 1);\n}\n\n/**\n * **[Gaussian error function](http://en.wikipedia.org/wiki/Error_function)**\n *\n * The `errorFunction(x/(sd * Math.sqrt(2)))` is the probability that a value in a\n * normal distribution with standard deviation sd is within x of the mean.\n *\n * This function returns a numerical approximation to the exact value.\n * It uses Horner's method to evaluate the polynomial of  (tau).\n *\n * @param {number} x input\n * @return {number} error estimation\n * @example\n * errorFunction(1).toFixed(2); // => '0.84'\n */\nfunction errorFunction(x) {\n    var t = 1 / (1 + 0.5 * Math.abs(x));\n    var tau =\n        t *\n        Math.exp(\n            -x * x +\n                ((((((((0.17087277 * t - 0.82215223) * t + 1.48851587) * t -\n                    1.13520398) *\n                    t +\n                    0.27886807) *\n                    t -\n                    0.18628806) *\n                    t +\n                    0.09678418) *\n                    t +\n                    0.37409196) *\n                    t +\n                    1.00002368) *\n                    t -\n                1.26551223\n        );\n    if (x >= 0) {\n        return 1 - tau;\n    } else {\n        return tau - 1;\n    }\n}\n\n/**\n * The Inverse [Gaussian error function](http://en.wikipedia.org/wiki/Error_function)\n * returns a numerical approximation to the value that would have caused\n * `errorFunction()` to return x.\n *\n * @param {number} x value of error function\n * @returns {number} estimated inverted value\n */\nfunction inverseErrorFunction(x) {\n    var a = (8 * (Math.PI - 3)) / (3 * Math.PI * (4 - Math.PI));\n\n    var inv = Math.sqrt(\n        Math.sqrt(\n            Math.pow(2 / (Math.PI * a) + Math.log(1 - x * x) / 2, 2) -\n                Math.log(1 - x * x) / a\n        ) -\n            (2 / (Math.PI * a) + Math.log(1 - x * x) / 2)\n    );\n\n    if (x >= 0) {\n        return inv;\n    } else {\n        return -inv;\n    }\n}\n\n/**\n * The [Probit](http://en.wikipedia.org/wiki/Probit)\n * is the inverse of cumulativeStdNormalProbability(),\n * and is also known as the normal quantile function.\n *\n * It returns the number of standard deviations from the mean\n * where the p'th quantile of values can be found in a normal distribution.\n * So, for example, probit(0.5 + 0.6827/2)  1 because 68.27% of values are\n * normally found within 1 standard deviation above or below the mean.\n *\n * @param {number} p\n * @returns {number} probit\n */\nfunction probit(p) {\n    if (p === 0) {\n        p = epsilon;\n    } else if (p >= 1) {\n        p = 1 - epsilon;\n    }\n    return Math.sqrt(2) * inverseErrorFunction(2 * p - 1);\n}\n\n/**\n * The [Logit](https://en.wikipedia.org/wiki/Logit)\n * is the inverse of cumulativeStdLogisticProbability,\n * and is also known as the logistic quantile function.\n *\n * @param {number} p\n * @returns {number} logit\n */\nfunction logit(p) {\n    if (p <= 0 || p >= 1) {\n        throw new Error(\"p must be strictly between zero and one\");\n    }\n    return Math.log(p / (1 - p));\n}\n\n/**\n * Conducts a [permutation test](https://en.wikipedia.org/wiki/Resampling_(statistics)#Permutation_tests)\n * to determine if two data sets are *significantly* different from each other, using\n * the difference of means between the groups as the test statistic.\n * The function allows for the following hypotheses:\n * - two_tail = Null hypothesis: the two distributions are equal.\n * - greater = Null hypothesis: observations from sampleX tend to be smaller than those from sampleY.\n * - less = Null hypothesis: observations from sampleX tend to be greater than those from sampleY.\n * [Learn more about one-tail vs two-tail tests.](https://en.wikipedia.org/wiki/One-_and_two-tailed_tests)\n *\n * @param {Array<number>} sampleX first dataset (e.g. treatment data)\n * @param {Array<number>} sampleY second dataset (e.g. control data)\n * @param {string} alternative alternative hypothesis, either 'two_sided' (default), 'greater', or 'less'\n * @param {number} k number of values in permutation distribution.\n * @param {Function} [randomSource=Math.random] an optional entropy source\n * @returns {number} p-value The probability of observing the difference between groups (as or more extreme than what we did), assuming the null hypothesis.\n *\n * @example\n * var control = [2, 5, 3, 6, 7, 2, 5];\n * var treatment = [20, 5, 13, 12, 7, 2, 2];\n * permutationTest(control, treatment); // ~0.1324\n */\nfunction permutationTest(sampleX, sampleY, alternative, k, randomSource) {\n    // Set default arguments\n    if (k === undefined) {\n        k = 10000;\n    }\n    if (alternative === undefined) {\n        alternative = \"two_side\";\n    }\n    if (\n        alternative !== \"two_side\" &&\n        alternative !== \"greater\" &&\n        alternative !== \"less\"\n    ) {\n        throw new Error(\n            \"`alternative` must be either 'two_side', 'greater', or 'less'.\"\n        );\n    }\n\n    // get means for each sample\n    var meanX = mean(sampleX);\n    var meanY = mean(sampleY);\n\n    // calculate initial test statistic. This will be our point of comparison with\n    // the generated test statistics.\n    var testStatistic = meanX - meanY;\n\n    // create test-statistic distribution\n    var testStatDsn = new Array(k);\n\n    // combine datsets so we can easily shuffle later\n    var allData = sampleX.concat(sampleY);\n    var midIndex = Math.floor(allData.length / 2);\n\n    for (var i = 0; i < k; i++) {\n        // 1. shuffle data assignments\n        shuffleInPlace(allData, randomSource);\n        var permLeft = allData.slice(0, midIndex);\n        var permRight = allData.slice(midIndex, allData.length);\n\n        // 2.re-calculate test statistic\n        var permTestStatistic = mean(permLeft) - mean(permRight);\n\n        // 3. store test statistic to build test statistic distribution\n        testStatDsn[i] = permTestStatistic;\n    }\n\n    // Calculate p-value depending on alternative\n    // For this test, we calculate the percentage of 'extreme' test statistics (subject to our hypothesis)\n    // more info on permutation test p-value calculations: https://onlinecourses.science.psu.edu/stat464/node/35\n    var numExtremeTStats = 0;\n    if (alternative === \"two_side\") {\n        for (var i$1 = 0; i$1 <= k; i$1++) {\n            if (Math.abs(testStatDsn[i$1]) >= Math.abs(testStatistic)) {\n                numExtremeTStats += 1;\n            }\n        }\n    } else if (alternative === \"greater\") {\n        for (var i$2 = 0; i$2 <= k; i$2++) {\n            if (testStatDsn[i$2] >= testStatistic) {\n                numExtremeTStats += 1;\n            }\n        }\n    } else {\n        // alternative === 'less'\n        for (var i$3 = 0; i$3 <= k; i$3++) {\n            /* c8 ignore start */\n            if (testStatDsn[i$3] <= testStatistic) {\n                numExtremeTStats += 1;\n            }\n            /* c8 ignore end */\n        }\n    }\n\n    return numExtremeTStats / k;\n}\n\n/**\n * [Sign](https://en.wikipedia.org/wiki/Sign_function) is a function\n * that extracts the sign of a real number\n *\n * @param {number} x input value\n * @returns {number} sign value either 1, 0 or -1\n * @throws {TypeError} if the input argument x is not a number\n * @private\n *\n * @example\n * sign(2); // => 1\n */\nfunction sign(x) {\n    if (typeof x === \"number\") {\n        if (x < 0) {\n            return -1;\n        } else if (x === 0) {\n            return 0;\n        } else {\n            return 1;\n        }\n    } else {\n        throw new TypeError(\"not a number\");\n    }\n}\n\n/**\n * [Bisection method](https://en.wikipedia.org/wiki/Bisection_method) is a root-finding\n * method that repeatedly bisects an interval to find the root.\n *\n * This function returns a numerical approximation to the exact value.\n *\n * @param {Function} func input function\n * @param {number} start - start of interval\n * @param {number} end - end of interval\n * @param {number} maxIterations - the maximum number of iterations\n * @param {number} errorTolerance - the error tolerance\n * @returns {number} estimated root value\n * @throws {TypeError} Argument func must be a function\n *\n * @example\n * bisect(Math.cos,0,4,100,0.003); // => 1.572265625\n */\nfunction bisect(func, start, end, maxIterations, errorTolerance) {\n    if (typeof func !== \"function\")\n        { throw new TypeError(\"func must be a function\"); }\n\n    for (var i = 0; i < maxIterations; i++) {\n        var output = (start + end) / 2;\n\n        if (\n            func(output) === 0 ||\n            Math.abs((end - start) / 2) < errorTolerance\n        ) {\n            return output;\n        }\n\n        if (sign(func(output)) === sign(func(start))) {\n            start = output;\n        } else {\n            end = output;\n        }\n    }\n\n    throw new Error(\"maximum number of iterations exceeded\");\n}\n\n/**\n * Calculate Euclidean distance between two points.\n * @param {Array<number>} left First N-dimensional point.\n * @param {Array<number>} right Second N-dimensional point.\n * @returns {number} Distance.\n */\nfunction euclideanDistance(left, right) {\n    var sum = 0;\n    for (var i = 0; i < left.length; i++) {\n        var diff = left[i] - right[i];\n        sum += diff * diff;\n    }\n    return Math.sqrt(sum);\n}\n\n/**\n * @typedef {Object} kMeansReturn\n * @property {Array<number>} labels The labels.\n * @property {Array<Array<number>>} centroids The cluster centroids.\n */\n\n/**\n * Perform k-means clustering.\n *\n * @param {Array<Array<number>>} points N-dimensional coordinates of points to be clustered.\n * @param {number} numCluster How many clusters to create.\n * @param {Function} randomSource An optional entropy source that generates uniform values in [0, 1).\n * @return {kMeansReturn} Labels (same length as data) and centroids (same length as numCluster).\n * @throws {Error} If any centroids wind up friendless (i.e., without associated points).\n *\n * @example\n * kMeansCluster([[0.0, 0.5], [1.0, 0.5]], 2); // => {labels: [0, 1], centroids: [[0.0, 0.5], [1.0 0.5]]}\n */\nfunction kMeansCluster(points, numCluster, randomSource) {\n    if ( randomSource === void 0 ) randomSource = Math.random;\n\n    var oldCentroids = null;\n    var newCentroids = sample(points, numCluster, randomSource);\n    var labels = null;\n    var change = Number.MAX_VALUE;\n    while (change !== 0) {\n        labels = labelPoints(points, newCentroids);\n        oldCentroids = newCentroids;\n        newCentroids = calculateCentroids(points, labels, numCluster);\n        change = calculateChange(newCentroids, oldCentroids);\n    }\n    return {\n        labels: labels,\n        centroids: newCentroids\n    };\n}\n\n/**\n * Label each point according to which centroid it is closest to.\n *\n * @private\n * @param {Array<Array<number>>} points Array of XY coordinates.\n * @param {Array<Array<number>>} centroids Current centroids.\n * @return {Array<number>} Group labels.\n */\nfunction labelPoints(points, centroids) {\n    return points.map(function (p) {\n        var minDist = Number.MAX_VALUE;\n        var label = -1;\n        for (var i = 0; i < centroids.length; i++) {\n            var dist = euclideanDistance(p, centroids[i]);\n            if (dist < minDist) {\n                minDist = dist;\n                label = i;\n            }\n        }\n        return label;\n    });\n}\n\n/**\n * Calculate centroids for points given labels.\n *\n * @private\n * @param {Array<Array<number>>} points Array of XY coordinates.\n * @param {Array<number>} labels Which groups points belong to.\n * @param {number} numCluster Number of clusters being created.\n * @return {Array<Array<number>>} Centroid for each group.\n * @throws {Error} If any centroids wind up friendless (i.e., without associated points).\n */\nfunction calculateCentroids(points, labels, numCluster) {\n    // Initialize accumulators.\n    var dimension = points[0].length;\n    var centroids = makeMatrix(numCluster, dimension);\n    var counts = Array(numCluster).fill(0);\n\n    // Add points to centroids' accumulators and count points per centroid.\n    var numPoints = points.length;\n    for (var i = 0; i < numPoints; i++) {\n        var point = points[i];\n        var label = labels[i];\n        var current = centroids[label];\n        for (var j = 0; j < dimension; j++) {\n            current[j] += point[j];\n        }\n        counts[label] += 1;\n    }\n\n    // Rescale centroids, checking for any that have no points.\n    for (var i$1 = 0; i$1 < numCluster; i$1++) {\n        if (counts[i$1] === 0) {\n            throw new Error((\"Centroid \" + i$1 + \" has no friends\"));\n        }\n        var centroid = centroids[i$1];\n        for (var j$1 = 0; j$1 < dimension; j$1++) {\n            centroid[j$1] /= counts[i$1];\n        }\n    }\n\n    return centroids;\n}\n\n/**\n * Calculate the difference between old centroids and new centroids.\n *\n * @private\n * @param {Array<Array<number>>} left One list of centroids.\n * @param {Array<Array<number>>} right Another list of centroids.\n * @return {number} Distance between centroids.\n */\nfunction calculateChange(left, right) {\n    var total = 0;\n    for (var i = 0; i < left.length; i++) {\n        total += euclideanDistance(left[i], right[i]);\n    }\n    return total;\n}\n\n/**\n * Calculate the [silhouette values](https://en.wikipedia.org/wiki/Silhouette_(clustering))\n * for clustered data.\n *\n * @param {Array<Array<number>>} points N-dimensional coordinates of points.\n * @param {Array<number>} labels Labels of points. This must be the same length as `points`,\n * and values must lie in [0..G-1], where G is the number of groups.\n * @return {Array<number>} The silhouette value for each point.\n *\n * @example\n * silhouette([[0.25], [0.75]], [0, 0]); // => [1.0, 1.0]\n */\nfunction silhouette(points, labels) {\n    if (points.length !== labels.length) {\n        throw new Error(\"must have exactly as many labels as points\");\n    }\n    var groupings = createGroups(labels);\n    var distances = calculateAllDistances(points);\n    var result = [];\n    for (var i = 0; i < points.length; i++) {\n        var s = 0;\n        if (groupings[labels[i]].length > 1) {\n            var a = meanDistanceFromPointToGroup(\n                i,\n                groupings[labels[i]],\n                distances\n            );\n            var b = meanDistanceToNearestGroup(\n                i,\n                labels,\n                groupings,\n                distances\n            );\n            s = (b - a) / Math.max(a, b);\n        }\n        result.push(s);\n    }\n    return result;\n}\n\n/**\n * Create a lookup table mapping group IDs to point IDs.\n *\n * @private\n * @param {Array<number>} labels Labels of points. This must be the same length as `points`,\n * and values must lie in [0..G-1], where G is the number of groups.\n * @return {Array<Array<number>>} An array of length G, each of whose entries is an array\n * containing the indices of the points in that group.\n */\nfunction createGroups(labels) {\n    var numGroups = 1 + max(labels);\n    var result = Array(numGroups);\n    for (var i = 0; i < labels.length; i++) {\n        var label = labels[i];\n        if (result[label] === undefined) {\n            result[label] = [];\n        }\n        result[label].push(i);\n    }\n    return result;\n}\n\n/**\n * Create a lookup table of all inter-point distances.\n *\n * @private\n * @param {Array<Array<number>>} points N-dimensional coordinates of points.\n * @return {Array<Array<number>>} A symmetric square array of inter-point distances\n * (zero on the diagonal).\n */\nfunction calculateAllDistances(points) {\n    var numPoints = points.length;\n    var result = makeMatrix(numPoints, numPoints);\n    for (var i = 0; i < numPoints; i++) {\n        for (var j = 0; j < i; j++) {\n            result[i][j] = euclideanDistance(points[i], points[j]);\n            result[j][i] = result[i][j];\n        }\n    }\n    return result;\n}\n\n/**\n * Calculate the mean distance between this point and all the points in the\n * nearest group (as determined by which point in another group is closest).\n *\n * @private\n * @param {number} which The index of this point.\n * @param {Array<number>} labels Labels of points.\n * @param {Array<Array<number>>} groupings An array whose entries are arrays\n * containing the indices of the points in that group.\n * @param {Array<Array<number>>} distances A symmetric square array of inter-point\n * distances.\n * @return {number} The mean distance from this point to others in the nearest\n * group.\n */\nfunction meanDistanceToNearestGroup(which, labels, groupings, distances) {\n    var label = labels[which];\n    var result = Number.MAX_VALUE;\n    for (var i = 0; i < groupings.length; i++) {\n        if (i !== label) {\n            var d = meanDistanceFromPointToGroup(\n                which,\n                groupings[i],\n                distances\n            );\n            if (d < result) {\n                result = d;\n            }\n        }\n    }\n    return result;\n}\n\n/**\n * Calculate the mean distance between a point and all the points in a group\n * (possibly its own).\n *\n * @private\n * @param {number} which The index of this point.\n * @param {Array<number>} group The indices of all the points in the group in\n * question.\n * @param {Array<Array<number>>} distances A symmetric square array of inter-point\n * distances.\n * @return {number} The mean distance from this point to others in the\n * specified group.\n */\nfunction meanDistanceFromPointToGroup(which, group, distances) {\n    var total = 0;\n    for (var i = 0; i < group.length; i++) {\n        total += distances[which][group[i]];\n    }\n    return total / group.length;\n}\n\n/**\n * Calculate the [silhouette metric](https://en.wikipedia.org/wiki/Silhouette_(clustering))\n * for a set of N-dimensional points arranged in groups. The metric is the largest\n * individual silhouette value for the data.\n *\n * @param {Array<Array<number>>} points N-dimensional coordinates of points.\n * @param {Array<number>} labels Labels of points. This must be the same length as `points`,\n * and values must lie in [0..G-1], where G is the number of groups.\n * @return {number} The silhouette metric for the groupings.\n *\n * @example\n * silhouetteMetric([[0.25], [0.75]], [0, 0]); // => 1.0\n */\nfunction silhouetteMetric(points, labels) {\n    var values = silhouette(points, labels);\n    return max(values);\n}\n\n/**\n * Relative error.\n *\n * This is more difficult to calculate than it first appears [1,2].  The usual\n * formula for the relative error between an actual value A and an expected\n * value E is `|(A-E)/E|`, but:\n *\n * 1. If the expected value is 0, any other value has infinite relative error,\n *    which is counter-intuitive: if the expected voltage is 0, getting 1/10th\n *    of a volt doesn't feel like an infinitely large error.\n *\n * 2. This formula does not satisfy the mathematical definition of a metric [3].\n *    [4] solved this problem by defining the relative error as `|ln(|A/E|)|`,\n *    but that formula only works if all values are positive: for example, it\n *    reports the relative error of -10 and 10 as 0.\n *\n * Our implementation sticks with convention and returns:\n *\n * - 0 if the actual and expected values are both zero\n * - Infinity if the actual value is non-zero and the expected value is zero\n * - `|(A-E)/E|` in all other cases\n *\n * [1] https://math.stackexchange.com/questions/677852/how-to-calculate-relative-error-when-true-value-is-zero\n * [2] https://en.wikipedia.org/wiki/Relative_change_and_difference\n * [3] https://en.wikipedia.org/wiki/Metric_(mathematics)#Definition\n * [4] F.W.J. Olver: \"A New Approach to Error Arithmetic.\" SIAM Journal on\n *     Numerical Analysis, 15(2), 1978, 10.1137/0715024.\n *\n * @param {number} actual The actual value.\n * @param {number} expected The expected value.\n * @return {number} The relative error.\n */\nfunction relativeError(actual, expected) {\n    // These lines are actually covered by tests, but it seems\n    // like c8 has a bug that marks them as not covered.\n    /* c8 ignore start */\n    if (actual === 0 && expected === 0) {\n        return 0;\n    }\n    /* c8 ignore end */\n    return Math.abs((actual - expected) / expected);\n}\n\n/**\n * Approximate equality.\n *\n * @param {number} actual The value to be tested.\n * @param {number} expected The reference value.\n * @param {number} tolerance The acceptable relative difference.\n * @return {boolean} Whether numbers are within tolerance.\n */\nfunction approxEqual(actual, expected, tolerance) {\n    if ( tolerance === void 0 ) tolerance = epsilon;\n\n    return relativeError(actual, expected) <= tolerance;\n}\n\nexport { BayesianClassifier, PerceptronModel, addToMean, approxEqual, mean as average, meanSimple as averageSimple, BayesianClassifier as bayesian, bernoulliDistribution, binomialDistribution, bisect, chiSquaredDistributionTable, chiSquaredGoodnessOfFit, chunk, ckmeans, coefficientOfVariation, combinations, combinationsReplacement, combineMeans, combineVariances, cumulativeStdLogisticProbability, cumulativeStdNormalProbability, epsilon, equalIntervalBreaks, errorFunction as erf, errorFunction, extent, extentSorted, factorial, gamma, gammaln, geometricMean, harmonicMean, interquartileRange, inverseErrorFunction, interquartileRange as iqr, jenks, kMeansCluster, kernelDensityEstimation as kde, kernelDensityEstimation, linearRegression, linearRegressionLine, logAverage, logit, medianAbsoluteDeviation as mad, max, maxSorted, mean, meanSimple, median, medianAbsoluteDeviation, medianSorted, min, minSorted, mode, modeFast, modeSorted, numericSort, PerceptronModel as perceptron, permutationTest, permutationsHeap, poissonDistribution, probit, product, quantile, quantileRank, quantileRankSorted, quantileSorted, quickselect, rSquared, relativeError, rootMeanSquare as rms, rootMeanSquare, sample, sampleCorrelation, sampleCovariance, sampleKurtosis, sampleRankCorrelation, sampleSkewness, sampleStandardDeviation, sampleVariance, sampleWithReplacement, shuffle, shuffleInPlace, sign, silhouette, silhouetteMetric, standardDeviation, standardNormalTable, subtractFromMean, sum, sumNthPowerDeviations, sumSimple, tTest, tTestTwoSample, uniqueCountSorted, variance, wilcoxonRankSum, zScore };\n//# sourceMappingURL=simple-statistics.mjs.map\n","import { select, selectAll } from 'd3-selection'\r\nimport { formatDefaultLocale } from 'd3-format'\r\nimport { geoIdentity, geoPath, geoCentroid } from 'd3-geo'\r\nimport { geoRobinson } from 'd3-geo-projection'\r\nimport {\r\n    getBBOXAsGeoJSON,\r\n    executeForAllInsets,\r\n    getFontSizeFromClass,\r\n    getParameterByName,\r\n    convertRectanglesToPaths,\r\n    getApproxCurrentGeoBbox,\r\n} from './utils'\r\nimport { appendAnnotations } from './annotations'\r\nimport { addLabelsToMap, updateLabels, updateValuesLabels } from './labels'\r\nimport { defineDeprecatedFunctions } from './deprecated'\r\nimport { Geometries } from './geometries'\r\nimport { buildInsets, removeInsets } from './insets'\r\nimport { appendStamp } from './stamps'\r\nimport { buildGridCartogramBase } from './cartograms'\r\nimport { appendMinimap } from './minimaps'\r\nimport { defineMapZoom, setMapView } from './zoom'\r\nimport { appendZoomButtons } from './buttons/zoom-buttons'\r\nimport { appendInsetsButton } from './buttons/insets-button'\r\nimport { addPlacenameLabels } from './placenames.js'\r\nimport { initProj4 } from './proj4.js'\r\nimport { addEurostatLogo, addEurostatRibbon } from './logo.js'\r\nimport { addCoastalMarginToMap, appendCoastalMargin } from './coastal-margin.js'\r\nimport { addFootnote, addSourceLink, addSubtitle, addTitle } from './texts.js'\r\nimport { addScalebarToMap } from './scalebar.js'\r\nimport { standardDeviation } from 'simple-statistics'\r\n\r\n// set default d3 locale\r\nformatDefaultLocale({\r\n    decimal: '.',\r\n    thousands: ' ',\r\n    grouping: [3],\r\n    currency: ['', ''],\r\n})\r\n\r\ninitProj4()\r\n\r\n/**\r\n * The map template: only the geometrical part.\r\n * To be used as a base map for a statistical map.\r\n *\r\n * @param {*} withCenterPoints Set to true (or 1) to add regions center points to the map template, to be used for proportional symbols maps for example.\r\n */\r\nexport const mapTemplate = function (config, withCenterPoints, mapType) {\r\n    //build map template object\r\n    const out = {}\r\n    out._mapType = mapType\r\n\r\n    // expose imported function to other modules\r\n    out.updateValuesLabels = updateValuesLabels\r\n\r\n    //map\r\n    out.svgId_ = 'map'\r\n    out.svg_ = undefined\r\n    out.width_ = Math.min(795, window.innerWidth)\r\n    out.height_ = 0\r\n    out.containerId_ = undefined\r\n\r\n    //geographical focus\r\n    out.gridCartogram_ = false // draw geometries as grid cells\r\n    out.gridCartogramShape_ = 'square' // square or hexagon\r\n    out.gridCartogramMargins_ = { top: 80, right: 50, bottom: 80, left: 150 }\r\n    out.gridCartogramCellPadding_ = 4\r\n    out.gridCartogramPositions_ = undefined //user defined cartograms\r\n    out.nutsLevel_ = 3 // 0,1,2,3, or 'mixed'\r\n    out.nutsYear_ = 2024\r\n    out.geo_ = 'EUR'\r\n    out.proj_ = '3035'\r\n    out.projectionFunction_ = undefined // e.g. d3.geoRobinson()\r\n    out.filterGeometriesFunction_ = undefined // user defined filter function\r\n    out.scale_ = '20M' //TODO choose automatically, depending on pixelSize ?\r\n    out.position_ = { x: undefined, y: undefined, z: undefined } // initial map view\r\n    out.placenames_ = false // load placenames from placenames.js\r\n    out.placenamesFilter_ = undefined // function to filter placenames\r\n\r\n    // pan & zoom\r\n    out.zoomExtent_ = undefined\r\n    out.translateExtent_ = undefined //d3 zoom.translateExtent\r\n    out.lockPanUntilZoom_ = true // if true, user can pan only after zooming once\r\n\r\n    //events\r\n    out.onZoomEnd_ = undefined // user function to call when zoom ends\r\n    out.onZoom_ = undefined // user function to call when zooming\r\n    out.onRegionMouseOver_ = undefined // user function to call when mouseover a region\r\n    out.onRegionMouseMove_ = undefined // user function to call when mousemove over a region\r\n    out.onRegionMouseOut_ = undefined // user function to call when mouseout of a region\r\n    out.onRegionClick_ = undefined // user function to call when clicking a region\r\n\r\n    // geometries\r\n    out.geometries_ = undefined // [{id:String, data:geojson, class:function}] user-defined geometries\r\n    out.processCentroids_ = undefined // runs over symbol centroids\r\n\r\n    //dorling cartograms (used for ps and pie maps)\r\n    out.dorling_ = false\r\n    out.animateDorling_ = true\r\n    out.dorlingStrength_ = { x: 1, y: 1 }\r\n    out.dorlingIterations_ = 1\r\n    out.onDorlingProgress_ = undefined\r\n    out.dorlingWorker_ = false // use a web worker for (non-animated) dorling cartograms to not block the main thread\r\n    out.dorlingWorkerD3URL_ = undefined\r\n\r\n    //header/footer\r\n    out.header_ = false // add titles to separate header section\r\n    out.footer_ = false // add footnotes to separate footer section\r\n    out.footerPadding_ = undefined // px padding between map and footer\r\n    out.headerPadding_ = undefined // px padding between header and map\r\n\r\n    //map title\r\n    out.title_ = ''\r\n    out.titlePosition_ = undefined\r\n\r\n    //map subtitle\r\n    out.subtitle_ = ''\r\n    out.subtitlePosition_ = undefined\r\n\r\n    //scalebar\r\n    out.showScalebar_ = false\r\n    out.scalebarPosition_ = []\r\n    out.scalebarUnits_ = ' km' //label\r\n    out.scalebarTextOffset_ = [0, 12]\r\n    out.scalebarMaxWidth_ = 150 //px\r\n    out.scalebarHeight_ = 90 //px\r\n    out.scalebarStrokeWidth_ = 1 //px\r\n    out.scalebarSegmentHeight_ = 6\r\n    out.scalebarTickHeight_ = 8\r\n\r\n    // stamp annotation\r\n    out.stamp_ = undefined //e.g {x,y,text,size}\r\n\r\n    //minimap\r\n    out.minimap_ = undefined\r\n\r\n    //buttons\r\n    out.zoomButtons_ = true // show zoom buttons\r\n    out.insetsButton_ = false // show insets button\r\n\r\n    //tooltip\r\n    out.tooltip_ = {\r\n        fontSize: '14px',\r\n        transitionDuration: 200,\r\n        xOffset: 0,\r\n        yOffset: 0,\r\n        textFunction: null,\r\n        showFlags: false,\r\n        omitRegions: [], // if specified, tooltip will not work for these regions\r\n    } //  See tooltip.js for more details\r\n\r\n    // region mouseover color\r\n    out.hoverColor_ = 'red'\r\n\r\n    //coastal margin\r\n    out.drawCoastalMargin_ = false\r\n    // for color, see .em-coastal-margin in map.css\r\n    out.coastalMarginSettings_ = {\r\n        standardDeviation: 1,\r\n        x: '-100%',\r\n        y: '-100%',\r\n        width: '200%',\r\n        height: '200%',\r\n        strokeWidth: 2,\r\n        color: 'rgb(0, 0, 0)',\r\n        opacity: 0.8,\r\n    }\r\n\r\n    //graticule\r\n    out.drawGraticule_ = false\r\n\r\n    //background map toggle (e.g. for dorling)\r\n    out.backgroundMap_ = true\r\n\r\n    //labelling\r\n    // see docs\\reference.md#labelling\r\n    out.labels_ = undefined\r\n\r\n    //annotations\r\n    out.annotations_ = undefined\r\n    out.annotationsAdded = false //simple flag to know when annotations have already been added\r\n\r\n    //hatching\r\n    out.patternFill_ = undefined // e.g. {pattern:'hatching',regionIds:['DE','FR']}\r\n\r\n    //dataset source link\r\n    out.showSourceLink_ = true\r\n\r\n    //default copyright and disclaimer text\r\n    out.footnote_ = 'Administrative boundaries: \\u00A9EuroGeographics \\u00A9OpenStreetMap' //\"(C)EuroGeographics (C)UN-FAO (C)Turkstat\";\r\n    out.footnoteTooltipText_ =\r\n        '<div class=\"em-footnote-tooltip\">The designations employed and the presentation of material on this map do not imply the expression of any opinion whatsoever on the part of the European Union concerning the legal status of any country, territory, city or area or of its authorities, or concerning the delimitation of its frontiers or boundaries. Kosovo*: This designation is without prejudice to positions on status, and is in line with UNSCR 1244/1999 and the ICJ Opinion on the Kosovo declaration of independence.</div>'\r\n    out.footnoteWrap_ = false //number of characters at which the footnote is wrapped\r\n    out.footnotePosition_ = undefined\r\n\r\n    out.showEstatLogo_ = false\r\n    out.showEstatRibbon_ = false\r\n    out.logoPosition_ = undefined\r\n    out.ribbonPosition_ = undefined\r\n    out.ribbonWidth_ = undefined\r\n    out.ribbonHeight_ = undefined\r\n    out.logoWidth_ = undefined\r\n    out.logoHeight_ = undefined\r\n    out.nuts2jsonBaseURL_ = window.location.hostname.includes('ec.europa.eu')\r\n        ? 'https://ec.europa.eu/assets/estat/E/E4/gisco/pub/nuts2json/v2'\r\n        : 'https://raw.githubusercontent.com/eurostat/Nuts2json/master/pub/v2'\r\n\r\n    //style for no data regions\r\n    out.noDataFillStyle_ = '#bcbcbc'\r\n\r\n    /**\r\n     * Insets.\r\n     * The map template has a recursive structure.\r\n     */\r\n\r\n    //insets to show, as a list of map template configs. Ex.: [{geo:\"MT\"},{geo:\"LI\"},{geo:\"PT20\"}]\r\n    out.insets_ = []\r\n    //inset templates - each inset is a map-template instance.\r\n    out.insetTemplates_ = {}\r\n    out.insetBoxPosition_ = undefined\r\n    out.insetBoxPadding_ = 5\r\n    out.insetBoxWidth_ = 210\r\n    //out.insetZoomExtent_ = [1, 3];\r\n    out.insetZoomExtent_ = null //zoom disabled as default\r\n    out.insetScale_ = '03M'\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    for (const att in out) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    }\r\n\r\n    // warn existing users of functions that have been banished to the shadow realm.\r\n    defineDeprecatedFunctions(out)\r\n\r\n    // convert geo to uppercase\r\n    out.geo = function (v) {\r\n        if (!arguments.length) return out.geo_\r\n        out.geo_ = v.toUpperCase()\r\n        return out\r\n    }\r\n\r\n    //special ones which affect also the insets\r\n    ;['tooltip_', 'nuts2jsonBaseURL_', 'processCentroids_', 'coastalMarginSettings_'].forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n\r\n            if (typeof v === 'object' && v !== null && !Array.isArray(v)) {\r\n                //override default properties\r\n                for (const p in v) {\r\n                    out[att][p] = v[p]\r\n                }\r\n            } else {\r\n                out[att] = v\r\n            }\r\n\r\n            //recursive call to inset components\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(\r\n                    out.insetTemplates_,\r\n                    out.svgId_,\r\n                    (inset, value) => {\r\n                        const fnName = att.substring(0, att.length - 1)\r\n                        inset[fnName](value)\r\n                    },\r\n                    v\r\n                )\r\n            }\r\n            return out\r\n        }\r\n    })\r\n\r\n    //title getter and setter\r\n    out.title = function (v) {\r\n        if (!arguments.length) return out.title_\r\n        out.title_ = v\r\n        if (out.svg())\r\n            out.svg()\r\n                .select('#title' + out.geo())\r\n                .text(v)\r\n        return out\r\n    }\r\n\r\n    //subtitle getter and setter\r\n    out.subtitle = function (v) {\r\n        if (!arguments.length) return out.subtitle_\r\n        out.subtitle_ = v\r\n        if (out.svg())\r\n            out.svg()\r\n                .select('#subtitle' + out.geo())\r\n                .text(v)\r\n        return out\r\n    }\r\n\r\n    //insets getter/setter\r\n    out.insets = function () {\r\n        if (!arguments.length) return out.insets_\r\n        if (arguments.length == 1 && arguments[0] === 'default') out.insets_ = 'default'\r\n        else if (arguments.length == 1 && arguments[0] === false) out.insets_ = false\r\n        else if (arguments.length == 1 && Array.isArray(arguments[0])) out.insets_ = arguments[0]\r\n        else out.insets_ = arguments\r\n        return out\r\n    }\r\n\r\n    // dynamic draw graticule\r\n    out.drawGraticule = function (v) {\r\n        if (!arguments.length) return out.drawGraticule_\r\n        out.drawGraticule_ = v\r\n\r\n        //update graticule\r\n        let graticule = out.svg_ ? out.svg().select('#em-graticule') : null\r\n        let zg = out.svg_ ? out.svg_.select('#em-zoom-group-' + out.svgId_) : null\r\n\r\n        // if existing and argument is false\r\n        if (graticule) {\r\n            if (graticule._groups[0][0] && v == false) {\r\n                //remove graticule\r\n                graticule.remove()\r\n\r\n                // if map already created and argument is true\r\n            } else if (out.Geometries.geoJSONs.graticule && out._pathFunction && zg && v == true) {\r\n                //remove existing graticule\r\n                graticule.remove()\r\n                // add new graticule\r\n                zg.append('g')\r\n                    .attr('id', 'em-graticule')\r\n                    .selectAll('path')\r\n                    .data(out.Geometries.geoJSONs.graticule)\r\n                    .enter()\r\n                    .append('path')\r\n                    .attr('d', out._pathFunction)\r\n                    .attr('class', 'em-graticule')\r\n\r\n                out.svg()\r\n                    .select('#em-graticule')\r\n                    .each(function () {\r\n                        // move graticule behind land mass\r\n                        out.geo_ == 'WORLD'\r\n                            ? this.parentNode.insertBefore(this, this.parentNode.childNodes[3])\r\n                            : this.parentNode.insertBefore(this, this.parentNode.childNodes[1])\r\n                    })\r\n            }\r\n        }\r\n        return out\r\n    }\r\n\r\n    //coastal margin override\r\n    out.drawCoastalMargin = function (v) {\r\n        //get\r\n        if (!arguments.length) return out.drawCoastalMargin_\r\n        //set\r\n        out.drawCoastalMargin_ = v\r\n        //update\r\n        appendCoastalMargin(out)\r\n        return out\r\n    }\r\n\r\n    //annotations override (update after first call)\r\n    out.annotations = function (v) {\r\n        //get\r\n        if (!arguments.length) return out.annotations_\r\n        //set\r\n        out.annotations_ = v\r\n        //update\r\n        appendAnnotations(out)\r\n        return out\r\n    }\r\n\r\n    //stamps override (update after first call)\r\n    out.stamp = function (v) {\r\n        //get\r\n        if (!arguments.length) return out.stamp_\r\n        //set\r\n        out.stamp_ = v\r\n        //update\r\n        appendStamp(out.stamp_, out)\r\n        return out\r\n    }\r\n\r\n    //minimap override (update after first call)\r\n    out.minimap = function (v) {\r\n        //get\r\n        if (!arguments.length) return out.minimap_\r\n        //set\r\n        out.minimap_ = v\r\n        //update\r\n        appendMinimap(out)\r\n        return out\r\n    }\r\n\r\n    //labels override (update after first call)\r\n    out.labels = function (v) {\r\n        //get\r\n        if (!arguments.length) return out.labels_\r\n        //set\r\n        out.labels_ = v\r\n        //update\r\n        updateLabels(out)\r\n        return out\r\n    }\r\n\r\n    out.position = function (v) {\r\n        if (!arguments.length) return out.position_\r\n        out.position_ = v\r\n        setMapView(out, v)\r\n        return out\r\n    }\r\n\r\n    // initiate Geometries class\r\n    out.Geometries = Geometries(out, withCenterPoints)\r\n\r\n    /**\r\n     * Requests geographic data and then builds the map template\r\n     */\r\n    out.updateGeoMapTemplate = function (callback) {\r\n        if (!callback) console.warn(' map.updateGeoMapTemplate called without callback function!')\r\n        // Erase previous data\r\n        out.Geometries.defaultGeoData = null\r\n        out.Geometries.allNUTSGeoData = null\r\n        out.Geometries.centroidsData = null\r\n\r\n        if (out.geometries_) {\r\n            out.Geometries.setUserGeometries(out.geometries_)\r\n            // use custom user-defined geometries\r\n            out.buildMapTemplate()\r\n\r\n            // Execute callback if defined\r\n            if (callback) callback()\r\n        } else {\r\n            // use default\r\n            out.Geometries.getDefaultGeoData(out.geo_, out.filterGeometriesFunction_, out.nutsLevel_).then(() => {\r\n                out.buildMapTemplate()\r\n\r\n                // Execute callback if defined\r\n                if (callback) callback()\r\n            })\r\n        }\r\n\r\n        // Use executeForAllInsets for recursive inset updates\r\n        executeForAllInsets(out.insetTemplates_, out.svgId_, (inset) => {\r\n            inset.updateGeoMapTemplate(callback)\r\n        })\r\n\r\n        return out\r\n    }\r\n\r\n    const createMapSVG = function (out) {\r\n        //get svg element. Create it if it does not exists\r\n        let svg = select('#' + out.svgId())\r\n        if (svg.size() == 0) {\r\n            svg = select('body').append('svg').attr('id', out.svgId())\r\n        }\r\n        svg.attr('class', 'em-map')\r\n        //add mapType css class\r\n        svg.classed('em--' + out._mapType, true)\r\n        // pies and coxcombs are proportional symbols, so add proportional-symbols class too\r\n        if (out._mapType === 'pie' || out._mapType === 'coxcomb') {\r\n            svg.classed('em--ps', true)\r\n        }\r\n        return svg\r\n    }\r\n\r\n    const wrapMapSvg = function (svg) {\r\n        const node = svg.node()\r\n        if (!node) return\r\n\r\n        const parent = node.parentNode\r\n        if (!parent) return\r\n\r\n        //  If parent is SVG (e.g. IMAGE), abandon wrapping\r\n        if (parent instanceof SVGElement) return\r\n\r\n        // already wrapped\r\n        if (parent.classList?.contains('em-map-wrapper')) return parent\r\n\r\n        const wrapper = document.createElement('div')\r\n        wrapper.className = 'em-map-wrapper'\r\n\r\n        parent.insertBefore(wrapper, node)\r\n        wrapper.appendChild(node)\r\n\r\n        return wrapper\r\n    }\r\n\r\n    /**\r\n     * Build a map object, including container, frame, map svg, insets and d3 zoom\r\n     */\r\n    out.buildMapTemplateBase = function () {\r\n        const svg = createMapSVG(out)\r\n        out.svg_ = svg\r\n\r\n        // Wrap SVG so HTML overlays (spinner, tooltip) can sit above it\r\n        if (!out.isInset) {\r\n            out._wrapper_ = wrapMapSvg(svg)\r\n        }\r\n\r\n        //set container for cases where container contains various maps\r\n        if (!out.containerId_) out.containerId_ = out.svgId_\r\n        //tooltip needs to know container to prevent overflow\r\n        if (!out.tooltip_.containerId) {\r\n            out.tooltip_.containerId = out.containerId_\r\n        }\r\n\r\n        //clear SVG (to avoid building multiple svgs on top of each other during multiple build() calls)\r\n        selectAll('#' + out.svgId() + ' > *').remove()\r\n\r\n        //set SVG dimensions\r\n        if (out.geo_.toUpperCase() == 'WORLD') {\r\n            //if no height was specified, use 45% of the width.\r\n            if (!out.height()) out.height(0.55 * out.width())\r\n            svg.attr('width', out.width()).attr('height', out.height())\r\n\r\n            //WORLD geo only accepts proj 54030 (robinson) at the moment\r\n            out.proj_ = 54030\r\n        }\r\n        //if no height was specified, use 85% of the width.\r\n        if (!out.height()) out.height(0.85 * out.width())\r\n        svg.attr('width', out.width()).attr('height', out.height())\r\n\r\n        // define clipPath relative to the drawing group (map area)\r\n        const defs = svg.append('defs').attr('class', 'em-defs')\r\n\r\n        defs.append('clipPath')\r\n            .attr('id', out.svgId_ + '-clip-path')\r\n            .append('rect')\r\n            .attr('x', 0)\r\n            .attr('y', 0)\r\n            .attr('width', out.width_)\r\n            .attr('height', out.height_)\r\n\r\n        if (out.drawCoastalMargin_) {\r\n            //define filter for coastal margin\r\n            svg.append('filter')\r\n                .attr('id', 'em-coastal-blur')\r\n                .attr('x', out.coastalMarginSettings_.x)\r\n                .attr('y', out.coastalMarginSettings_.y)\r\n                .attr('width', out.coastalMarginSettings_.width)\r\n                .attr('height', out.coastalMarginSettings_.height)\r\n                .append('feGaussianBlur')\r\n                .attr('in', 'SourceGraphic')\r\n                .attr('stdDeviation', out.coastalMarginSettings_.standardDeviation)\r\n        }\r\n\r\n        // create header, drawing and footer groups (stacked blocks)\r\n        // header (top)\r\n        svg.append('g')\r\n            .attr('id', 'em-header-' + out.svgId_)\r\n            .attr('class', 'em-header')\r\n\r\n        // drawing group (middle). clip-path will be updated by recalculateLayout()\r\n        const dg = svg\r\n            .append('g')\r\n            .attr('id', 'em-drawing-' + out.svgId_)\r\n            .attr('class', 'em-drawing-group')\r\n            .attr('clip-path', `url(#${out.svgId_}-clip-path)`) //  apply clipPath here\r\n\r\n        //add draggable class to map svg\r\n        if (out.zoomExtent_ || out.zoomButtons_) {\r\n            dg.classed('em-draggable', true)\r\n        }\r\n\r\n        // main zoom group inside drawing\r\n        const zg = dg\r\n            .append('g')\r\n            .attr('id', 'em-zoom-group-' + out.svgId_)\r\n            .attr('class', 'em-zoom-group')\r\n\r\n        // footer (bottom)\r\n        svg.append('g')\r\n            .attr('id', 'em-footer-' + out.svgId_)\r\n            .attr('class', 'em-footer')\r\n\r\n        // build insets\r\n        removeInsets(out) //remove existing\r\n        buildInsets(out, withCenterPoints, out._mapType) //build new\r\n\r\n        //draw frame\r\n        dg.append('rect')\r\n            .attr('id', 'em-frame-' + out.geo_)\r\n            .attr('class', 'em-frame')\r\n            .attr('x', 0)\r\n            .attr('y', 0)\r\n            .attr('width', out.width_)\r\n            .attr('height', out.height_)\r\n\r\n        if (out.stamp_) {\r\n            appendStamp(out.stamp_, out)\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Buid an empty map template, based on the geometries only.\r\n     */\r\n    out.buildMapTemplate = function () {\r\n        //prepare drawing group\r\n        const zoomGroup = out.svg().select('#em-zoom-group-' + out.svgId_)\r\n        //remove all children\r\n        zoomGroup.selectAll('*').remove()\r\n\r\n        // separate logic for cartograms\r\n        if (out.gridCartogram_ == true) {\r\n            buildGridCartogramBase(out)\r\n            out.footnote_ = false //dont need copyright\r\n        } else {\r\n            // default geographic logic\r\n\r\n            // position\r\n            if (!out.position_.x || !out.position_.y) {\r\n                defineDefaultPosition()\r\n            }\r\n            out.position_.z = out.position_.z || getDefaultZ()\r\n\r\n            // d3 projection/path functions\r\n            defineProjection()\r\n            definePathFunction()\r\n\r\n            // d3 zoom\r\n            if (out.zoomExtent() || out.zoomButtons_) {\r\n                if (!out.zoomExtent_) {\r\n                    console.log('Zoom buttons are enabled, but no zoom extent is defined. Setting default extent to map.zoomExtent([1,10]).')\r\n                    out.zoomExtent_ = [1, 10]\r\n                }\r\n                defineMapZoom(out)\r\n            }\r\n\r\n            if (out.backgroundMap_) {\r\n                drawBackgroundMap(out)\r\n            }\r\n        }\r\n\r\n        //prepare group for proportional symbols, with centroids\r\n        if (withCenterPoints) {\r\n            addCentroidsToMap(out)\r\n        }\r\n\r\n        // add geographical labels to map\r\n        if (out.labels_) {\r\n            addLabelsToMap(out, zoomGroup)\r\n        }\r\n\r\n        //annotations\r\n        if (out.annotations_) {\r\n            appendAnnotations(out)\r\n            out.annotationsAdded = true\r\n        }\r\n\r\n        //placenames\r\n        if (out.placenames_) {\r\n            addPlacenameLabels(out)\r\n        }\r\n\r\n        //title\r\n        if (out.title()) {\r\n            addTitle(out)\r\n        }\r\n\r\n        //subtitle\r\n        if (out.subtitle()) {\r\n            addSubtitle(out)\r\n        }\r\n\r\n        //bottom text\r\n        if (out.footnote_) {\r\n            addFootnote(out)\r\n        }\r\n\r\n        //logo\r\n        if (out.showEstatLogo_) {\r\n            addEurostatLogo(out)\r\n        }\r\n\r\n        if (out.showEstatRibbon_) {\r\n            addEurostatRibbon(out)\r\n        }\r\n\r\n        //source dataset URL\r\n        if (out.showSourceLink_) {\r\n            addSourceLink(out, withCenterPoints)\r\n        }\r\n\r\n        // scalebar\r\n        if (out.showScalebar_) {\r\n            if (out.scalebarPosition_.length !== 2) {\r\n                out.scalebarPosition_[0] = 15\r\n                out.scalebarPosition_[1] = out.height_ - 50\r\n            }\r\n            addScalebarToMap(out)\r\n        }\r\n\r\n        //minimap\r\n        if (out.minimap_) {\r\n            appendMinimap(out)\r\n        }\r\n\r\n        //zoom buttons\r\n        if (out.zoomButtons_) {\r\n            appendZoomButtons(out)\r\n        }\r\n\r\n        //insets buttons\r\n        if (out.insetsButton_) {\r\n            appendInsetsButton(out)\r\n        }\r\n\r\n        // after drawBackgroundMap, geometries, labels, etc.\r\n        if (out.drawCoastalMargin_) {\r\n            appendCoastalMargin(out)\r\n        }\r\n\r\n        //header/footer\r\n        setTimeout(() => out.recalculateLayout(), 20)\r\n        return out\r\n    }\r\n\r\n    const addCentroidsToMap = function (map) {\r\n        let centroidFeatures\r\n\r\n        if (!map.Geometries.centroidsData) {\r\n            // if centroids data is absent (e.g. for world maps) then calculate manually\r\n            if (map.geo_ == 'WORLD') {\r\n                centroidFeatures = []\r\n                map.Geometries.geoJSONs.worldrg.forEach((feature) => {\r\n                    let newFeature = { ...feature }\r\n                    // exception for France (because guyane)\r\n                    if (feature.properties.id == 'FR') {\r\n                        newFeature.geometry = {\r\n                            coordinates: [2.2, 46.2],\r\n                            type: 'Point',\r\n                        }\r\n                    } else {\r\n                        newFeature.geometry = {\r\n                            coordinates: geoCentroid(feature),\r\n                            type: 'Point',\r\n                        }\r\n                    }\r\n                    centroidFeatures.push(newFeature)\r\n                })\r\n            }\r\n        } else {\r\n            if (map.nutsLevel_ == 'mixed') {\r\n                centroidFeatures = [\r\n                    ...map.Geometries.centroidsData[0].features,\r\n                    ...map.Geometries.centroidsData[1].features,\r\n                    ...map.Geometries.centroidsData[2].features,\r\n                    ...map.Geometries.centroidsData[3].features,\r\n                ]\r\n            } else {\r\n                centroidFeatures = map.Geometries.centroidsData.features\r\n            }\r\n        }\r\n\r\n        if (map.processCentroids_) centroidFeatures = map.processCentroids_(centroidFeatures)\r\n\r\n        // Project and save coordinates\r\n        // Before filtering\r\n        const projectedCentroids = centroidFeatures.map((d) => {\r\n            const coords = map._projection(d.geometry.coordinates)\r\n            d.properties.centroid = coords\r\n            return d\r\n        })\r\n\r\n        // Keep an unfiltered copy\r\n        map.Geometries._allCentroidsFeatures = [...projectedCentroids]\r\n\r\n        // Filter to only centroids that have statistical data\r\n        map.Geometries.centroidsFeatures = projectedCentroids.filter((d) => hasStatData(d.properties.id, map))\r\n\r\n        // Append container if not existing\r\n        const gcp = out.getCentroidsGroup(map).empty()\r\n            ? map\r\n                  .svg()\r\n                  .select('#em-zoom-group-' + map.svgId_)\r\n                  .append('g')\r\n                  .attr('id', `em-centroids-${map.svgId_}`)\r\n                  .attr('class', 'em-centroids')\r\n            : out.getCentroidsGroup(map)\r\n\r\n        // Join pattern for centroids\r\n        gcp.selectAll('g.em-centroid')\r\n            .data(map.Geometries.centroidsFeatures, (d) => d.properties.id)\r\n            .join(\r\n                (enter) =>\r\n                    enter\r\n                        .append('g')\r\n                        .attr('class', 'em-centroid')\r\n                        .attr('id', (d) => 'ps' + d.properties.id)\r\n                        .attr('transform', (d) => `translate(${d.properties.centroid[0].toFixed(3)},${d.properties.centroid[1].toFixed(3)})`),\r\n                (update) => update,\r\n                (exit) => exit.remove()\r\n            )\r\n    }\r\n\r\n    /**\r\n     * Returns the D3 selection for the proportional symbols container\r\n     * of the given map (main or inset).\r\n     *\r\n     * Always uses a map-specific ID to avoid collisions with insets.\r\n     */\r\n    out.getCentroidsGroup = function (map) {\r\n        return map.svg().select(`#em-centroids-${map.svgId_}`)\r\n    }\r\n\r\n    // This will remove any centroids with no statistical data and re-add centroids for regions that just got data.\r\n    out.refreshCentroids = function (map) {\r\n        const allCentroids = map.Geometries._allCentroidsFeatures\r\n        if (!allCentroids) return\r\n\r\n        map.Geometries.centroidsFeatures = allCentroids.filter((d) => hasStatData(d.properties.id, map))\r\n\r\n        const gcp = out.getCentroidsGroup(map)\r\n\r\n        gcp.selectAll('g.em-centroid')\r\n            .data(map.Geometries.centroidsFeatures, (d) => d.properties.id)\r\n            .join(\r\n                (enter) =>\r\n                    enter\r\n                        .append('g')\r\n                        .attr('class', 'em-centroid')\r\n                        .attr('id', (d) => 'ps' + d.properties.id)\r\n                        .attr('transform', (d) => `translate(${d.properties.centroid[0].toFixed(3)},${d.properties.centroid[1].toFixed(3)})`),\r\n                (update) => update,\r\n                (exit) => exit.remove()\r\n            )\r\n\r\n        return map\r\n    }\r\n\r\n    // Small helper to check if region has statistical data\r\n    const hasStatData = function (id, map) {\r\n        //TODO: statCodes_ is only for coxcomb and pie maps, ps maps should also be contemplated here\r\n        if (!map.statCodes_) return true // if no data yet, keep everything\r\n        return map.statCodes_.some((code) => {\r\n            const s = map.statData(code)?.get(id)\r\n            return s && !isNaN(s.value) && s.value !== 0\r\n        })\r\n    }\r\n\r\n    const drawBackgroundMap = function (out) {\r\n        //draw background map\r\n        const zoomGroup = out.svg().select('#em-zoom-group-' + out.svgId_)\r\n        //draw sea\r\n        zoomGroup\r\n            .append('rect')\r\n            .attr('id', 'sea')\r\n            .attr('class', 'em-sea')\r\n            .attr('x', -5 * out.width_)\r\n            .attr('y', -5 * out.height_)\r\n            .attr('width', 11 * out.width_)\r\n            .attr('height', 11 * out.height_)\r\n\r\n        //sphere for world map\r\n        if (out.geo_ == 'WORLD') {\r\n            zoomGroup.append('path').datum({ type: 'Sphere' }).attr('id', 'sphere').attr('d', out._pathFunction).attr('class', 'em-graticule')\r\n        }\r\n\r\n        // draw polygons and borders\r\n        if (out.geometries_) {\r\n            out.Geometries.addUserGeometriesToMap(out.geometries_, zoomGroup, out._pathFunction)\r\n        } else {\r\n            out.Geometries.addDefaultGeometriesToMap(\r\n                zoomGroup,\r\n                out.drawGraticule_,\r\n                out._pathFunction,\r\n                out.nutsLevel_,\r\n                out.nutsYear_,\r\n                out.geo_,\r\n                out.proj_,\r\n                out.scale_\r\n            )\r\n        }\r\n    }\r\n\r\n    const defineDefaultPosition = function () {\r\n        if (out.projectionFunction_) {\r\n            // Handle custom D3 projection (like geoAzimuthalEquidistant)\r\n            if (typeof out.projectionFunction_.rotate === 'function') {\r\n                const r = out.projectionFunction_.rotate() // [lambda, phi, gamma]\r\n                if (Array.isArray(r) && r.length >= 2) {\r\n                    // Invert signs: the maps visual center is the opposite of its rotation\r\n                    const lon = -r[0]\r\n                    const lat = -r[1]\r\n                    out.position_.x = out.position_.x ?? lon\r\n                    out.position_.y = out.position_.y ?? lat\r\n                }\r\n            } else if (typeof out.projectionFunction_.center === 'function') {\r\n                const c = out.projectionFunction_.center() // [lon, lat]\r\n                if (Array.isArray(c) && c.length === 2) {\r\n                    out.position_.x = out.position_.x ?? c[0]\r\n                    out.position_.y = out.position_.y ?? c[1]\r\n                }\r\n            }\r\n        } else {\r\n            const defaultPosition = _defaultPosition[out.geo_ + '_' + out.proj_]\r\n            if (defaultPosition) {\r\n                out.position_.x = out.position_.x || defaultPosition.geoCenter[0]\r\n                out.position_.y = out.position_.y || defaultPosition.geoCenter[1]\r\n            } else if (out.Geometries.defaultGeoData?.bbox) {\r\n                // default to center of geoData bbox\r\n                out.position_.x = out.position_.x || 0.5 * (out.Geometries.defaultGeoData.bbox[0] + out.Geometries.defaultGeoData.bbox[2])\r\n                out.position_.y = out.position_.y || 0.5 * (out.Geometries.defaultGeoData.bbox[1] + out.Geometries.defaultGeoData.bbox[3])\r\n            } else {\r\n                //TODO: auto-define user=defined geometries geoCenter\r\n                // out.position_.x = Geometries.userGeometries\r\n                // out.position_.y = Geometries.userGeometries\r\n            }\r\n        }\r\n\r\n        // optional: set from URL\r\n        setViewFromURL()\r\n    }\r\n\r\n    const getDefaultZ = function () {\r\n        const defaultPosition = _defaultPosition[out.geo_ + '_' + out.proj_]\r\n        if (defaultPosition) {\r\n            return (defaultPosition.pixelSize * 800) / out.width_\r\n        } else if (out.Geometries.defaultGeoData?.bbox) {\r\n            return Math.min(\r\n                (out.Geometries.defaultGeoData.bbox[2] - out.Geometries.defaultGeoData.bbox[0]) / out.width_,\r\n                (out.Geometries.defaultGeoData.bbox[3] - out.Geometries.defaultGeoData.bbox[1]) / out.height_\r\n            )\r\n        } else {\r\n            return 100\r\n        }\r\n    }\r\n\r\n    const defineProjection = function () {\r\n        // Define projection based on the geographical context\r\n\r\n        if (out.geo_ === 'WORLD') {\r\n            // Use Robinson projection for the world with optional custom projection function\r\n            out._projection =\r\n                out.projectionFunction_ ||\r\n                geoRobinson()\r\n                    .translate([out.width_ / 2, out.height_ / 2])\r\n                    .scale((out.width_ - 20) / (2 * Math.PI))\r\n        } else {\r\n            // For non-WORLD geo, use custom or default identity projection with calculated bounding box\r\n            out._projection =\r\n                out.projectionFunction_ ||\r\n                geoIdentity()\r\n                    .reflectY(true)\r\n                    .fitSize([out.width_, out.height_], getBBOXAsGeoJSON(getApproxCurrentGeoBbox(out)))\r\n        }\r\n    }\r\n\r\n    const definePathFunction = function () {\r\n        out._pathFunction = geoPath().projection(out._projection)\r\n    }\r\n\r\n    /** Get x,y,z elements from URL and assign them to the view. */\r\n    const setViewFromURL = function () {\r\n        const x = getParameterByName('x'),\r\n            y = getParameterByName('y'),\r\n            z = getParameterByName('z')\r\n        if (x != null && x != undefined && !isNaN(+x)) out.position_.x = +x\r\n        if (y != null && y != undefined && !isNaN(+y)) out.position_.y = +y\r\n        if (z != null && z != undefined && !isNaN(+z)) out.position_.z = +z\r\n    }\r\n\r\n    out.recalculateLayout = function () {\r\n        const svg = out.svg()\r\n        const header = svg.select('#em-header-' + out.svgId_)\r\n        const drawing = svg.select('#em-drawing-' + out.svgId_)\r\n        const footer = svg.select('#em-footer-' + out.svgId_)\r\n        const frame = drawing.select('#em-frame-' + out.geo_)\r\n        const clipRect = svg.select(`#${out.svgId_}-clip-path rect`)\r\n\r\n        let headerHeight = 0\r\n        let footerHeight = 0\r\n\r\n        // --- Define consistent vertical padding between header and map ---\r\n        const headerMapPadding = out.headerPadding_ ? out.headerPadding_ : 20 // px (tweak visually as needed)\r\n        const footerMapPadding = out.footerPadding_ ? out.footerPadding_ : 10 // px below map before footer\r\n\r\n        // --- Measure header height ---\r\n        if (out.header_ && !header.empty()) {\r\n            const hb = header.node()?.getBBox?.()\r\n            if (hb) headerHeight = hb.height + headerMapPadding\r\n        }\r\n\r\n        // --- Measure footer height ---\r\n        if (out.footer_ && !footer.empty()) {\r\n            const fb = footer.node()?.getBBox?.()\r\n            if (fb) footerHeight = fb.height + footerMapPadding\r\n        }\r\n\r\n        // --- Move the map group below the header ---\r\n        drawing.attr('transform', `translate(0, ${headerHeight})`)\r\n\r\n        // --- Move footer below map ---\r\n        footer.attr('transform', `translate(0, ${headerHeight + out.height_ + footerMapPadding})`)\r\n\r\n        // --- Frame bounds ---\r\n        frame.attr('x', 0).attr('y', 0).attr('width', out.width_).attr('height', out.height_)\r\n\r\n        // --- Update clipRect (same dimensions as map area) ---\r\n        clipRect.attr('x', 0).attr('y', 0).attr('width', out.width_).attr('height', out.height_)\r\n\r\n        // --- Resize entire SVG ---\r\n        const totalHeight = out.height_ + headerHeight + footerHeight + footerMapPadding\r\n        svg.attr('width', out.width_).attr('height', totalHeight)\r\n\r\n        // --- Optional: Debug overlay ---\r\n        // drawing.selectAll('.debug-clip').remove();\r\n        // drawing.append('rect')\r\n        //     .attr('class', 'debug-clip')\r\n        //     .attr('x', 0)\r\n        //     .attr('y', 0)\r\n        //     .attr('width', out.width_)\r\n        //     .attr('height', out.height_)\r\n        //     .attr('fill', 'none')\r\n        //     .attr('stroke', 'magenta')\r\n        //     .attr('stroke-width', 1)\r\n        //     .attr('pointer-events', 'none');\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n/** Default geocenter positions and pixelSize (for default width = 800px) for territories and projections. */\r\nconst _defaultPosition = {\r\n    EUR_3035: { geoCenter: [4790000, 3420000], pixelSize: 6400 },\r\n    IC_32628: { geoCenter: [443468, 3145647], pixelSize: 1000 },\r\n    GP_32620: { geoCenter: [669498, 1784552], pixelSize: 130 },\r\n    MQ_32620: { geoCenter: [716521, 1621322], pixelSize: 130 },\r\n    GF_32622: { geoCenter: [266852, 444074], pixelSize: 500 },\r\n    RE_32740: { geoCenter: [348011, 7661627], pixelSize: 130 },\r\n    YT_32738: { geoCenter: [516549, 8583920], pixelSize: 70 },\r\n    MT_3035: { geoCenter: [4719755, 1441701], pixelSize: 70 },\r\n    PT20_32626: { geoCenter: [397418, 4271471], pixelSize: 1500 },\r\n    PT30_32628: { geoCenter: [333586, 3622706], pixelSize: 150 },\r\n    LI_3035: { geoCenter: [4287060, 2672000], pixelSize: 40 },\r\n    IS_3035: { geoCenter: [3011804, 4960000], pixelSize: 700 },\r\n    SJ_SV_3035: { geoCenter: [4570000, 6160156], pixelSize: 800 },\r\n    SJ_JM_3035: { geoCenter: [3647762, 5408300], pixelSize: 100 },\r\n    CARIB_32620: { geoCenter: [636345, 1669439], pixelSize: 500 },\r\n    WORLD_54030: { geoCenter: [14, 17], pixelSize: 9000 },\r\n}\r\n","import { updateCSSRule } from './utils.js'\r\n\r\n/* prettier-ignore */\r\n// to keep track of deprecated functions whilst keeping the current version clean.\r\n// also passes any important parameters to the new functions (if they exist) and overwrites any CSS style rules.\r\n// To be removed when completely phased out.\r\n\r\nexport const defineDeprecatedFunctions = (out) => {\r\n    // buttons\r\n    out.showZoomButtons = (v) => (console.warn('showZoomButtons() is now DEPRECATED, please use zoomButtons() instead'), out.zoomButtons_ = v, out);\r\n    out.showInsetsButton = (v) => (console.warn('showInsetsButton() is now DEPRECATED, please use insetsButton() instead'), out.insetsButton_ = v, out);\r\n    // styles\r\n    out.seaFillStyle = (v) => (console.warn('seaFillStyle() is now DEPRECATED, please use the .em-sea CSS class'), updateCSSRule('.em-sea','fill',v), out);\r\n    out.cntrgFillStyle = (v) => (console.warn('cntrgFillStyle() is now DEPRECATED, please use the .em-cntrg CSS class'),updateCSSRule('.em-cntrg','fill',v), out);\r\n    out.nutsrgFillStyle = (v) => (console.warn('nutsrgFillStyle() is now DEPRECATED, please use the .em-nutsrg CSS class'),updateCSSRule('.em-nutsrg','fill',v), out);\r\n    out.nutsbnStroke = (v) => {\r\n        console.warn('nutsbnStroke() is now DEPRECATED, please use the .bn_0, .bn_1, .bn_2, .bn_3 CSS classes')\r\n        if (v['0']) {\r\n            updateCSSRule('.bn_0','stroke',v['0'])\r\n        }\r\n        if (v['1']) {\r\n            updateCSSRule('.bn_1','stroke',v['1'])\r\n        }\r\n        if (v['2']) {\r\n            updateCSSRule('.bn_2','stroke',v['2'])\r\n        }\r\n        if (v['3']) {\r\n            updateCSSRule('.bn_3','stroke',v['3'])\r\n        }\r\n        return out\r\n    };\r\n    out.nutsbnStrokeWidth = (v) => {\r\n        console.warn('nutsbnStrokeWidth() is now DEPRECATED, please use the .bn_0, .bn_1, .bn_2, .bn_3 CSS classes')\r\n        if (v['0']) {\r\n            updateCSSRule('.bn_0','stroke-width',v['0'])\r\n        }\r\n        if (v['1']) {\r\n            updateCSSRule('.bn_1','stroke-width',v['1'])\r\n        }\r\n        if (v['2']) {\r\n            updateCSSRule('.bn_2','stroke-width',v['2'])\r\n        }\r\n        if (v['3']) {\r\n            updateCSSRule('.bn_3','stroke-width',v['3'])\r\n        }\r\n        return out\r\n    };\r\n    out.graticuleStroke = (v) => (console.warn('graticuleStroke() is now DEPRECATED, please use the .em-graticule CSS class'), updateCSSRule('.em-graticule','stroke',v), out);\r\n    out.graticuleStrokeWidth = (v) => (console.warn('graticuleStrokeWidth() is now DEPRECATED, please use the .em-graticule CSS class'), updateCSSRule('.em-graticule','stroke-width',v), out);\r\n    out.nutsrgSelFillSty = (v) => (console.warn('nutsrgSelFillSty() is now DEPRECATED, please use hoverColor() instead'), out.hoverColor_ = v, out);\r\n    out.titleFontSize = (v) => (console.warn('map.titleFontSize() is now DEPRECATED. please use the .em-title CSS class'),updateCSSRule('.em-title','font-size',v), out);\r\n    out.subtitleFontSize = (v) => (console.warn('map.subtitleFontSize() is now DEPRECATED. please use the .em-subtitle CSS class'),updateCSSRule('.em-subtitle','font-size',v), out);\r\n    out.subtitleFontWeight = (v) => (console.warn('map.subtitleFontWeight() is now DEPRECATED. please use the .em-subtitle CSS class'),updateCSSRule('.em-subtitle','font-weight',v), out);\r\n    out.titleFill = (v) => (console.warn('map.titleFill() is now DEPRECATED. please use the .em-title CSS class'),updateCSSRule('.em-title','fill',v), out);\r\n    out.subtitleFill = (v) => (console.warn('map.subtitleFill() is now DEPRECATED. please use the .em-subtitle CSS class'),updateCSSRule('.em-subtitle','fill',v), out);\r\n    out.cntbnStroke = (v) => {\r\n        console.warn('cntbnStroke() is now DEPRECATED, please use the .em-cntbn .em-bn-eu .em-bn-efta .em-bn-cc .em-bn-oth CSS classes')\r\n        if (v['eu']) {\r\n            updateCSSRule('.em-bn-eu','stroke',v['eu'])\r\n        }\r\n        if (v['efta']) {\r\n            updateCSSRule('.em-bn-efta','stroke',v['efta'])\r\n        }\r\n        if (v['cc']) {\r\n            updateCSSRule('.em-bn-cc','stroke',v['cc'])\r\n        }\r\n        if (v['oth']) {\r\n            updateCSSRule('.em-bn-oth','stroke',v['oth'])\r\n        }\r\n        if (v['co']) {\r\n            updateCSSRule('.em-bn-co','stroke',v['co'])\r\n        }\r\n        return out\r\n    };\r\n    out.cntbnStrokeWidth = (v) => {\r\n        console.warn('cntbnStrokeWidth() is now DEPRECATED, please use the .em-cntbn .em-worldbn .em-bn-eu .em-bn-efta .em-bn-cc .em-bn-oth CSS classes')\r\n        if (v['eu']) {\r\n            updateCSSRule('.em-bn-eu','stroke-width',v['eu'])\r\n        }\r\n        if (v['efta']) {\r\n            updateCSSRule('.em-bn-efta','stroke-width',v['efta'])\r\n        }\r\n        if (v['cc']) {\r\n            updateCSSRule('.em-bn-cc','stroke-width',v['cc'])\r\n        }\r\n        if (v['oth']) {\r\n            updateCSSRule('.em-bn-oth','stroke-width',v['oth'])\r\n        }\r\n        if (v['co']) {\r\n            updateCSSRule('.em-bn-co','stroke-width',v['co'])\r\n        }\r\n        return out\r\n    };\r\n    out.worldStroke = (v) => (console.warn('map.worldStroke() is now DEPRECATED. please use the .em-worldbn .em-bn-co .em-bn-d CSS classes'),updateCSSRule('.em-worldbn','stroke',v), out);\r\n    out.worldStrokeWidth = (v) => (console.warn('map.worldStrokeWidth() is now DEPRECATED. please use the .em-worldbn .em-bn-co .em-bn-d CSS classes'),updateCSSRule('.em-worldbn','stroke-width',v), out);\r\n    out.worldCoastStroke = (v) => (console.warn('map.worldCoastStroke() is now DEPRECATED. please use the .em-bn-co CSS class'),updateCSSRule('.em-bn-co','stroke',v), out);\r\n    out.worldCoastStrokeWidth = (v) => (console.warn('map.worldCoastStrokeWidth() is now DEPRECATED. please use the .em-bn-co CSS class'),updateCSSRule('.em-bn-co','stroke-width',v), out);\r\n    out.worldFillStyle = (v) => (console.warn('map.worldFillStyle() is now DEPRECATED. please use the .em-worldrg CSS class'),updateCSSRule('.em-worldrg','fill',v), out); \r\n    out.coastalMarginWidth = (v) => (console.warn('map.coastalMarginWidth() is now DEPRECATED. please use the #em-coast-margin CSS rule'),updateCSSRule('#em-coast-margin','stroke-width',v), out);  \r\n    out.coastalMarginColor = (v) => (console.warn('map.coastalMarginColor() is now DEPRECATED. please use the #em-coast-margin CSS rule'),updateCSSRule('#em-coast-margin','stroke',v), out);\r\n    out.coastalMarginStdDev = (v) => (console.warn('map.coastalMarginStdDev() is now DEPRECATED. please use map.coastalMarginSettings.standardDeviation instead.'), out.coastalMarginSettings.standardDeviation = v, out);\r\n    out.fontFamily = (v) => (console.warn('map.fontFamily() is now DEPRECATED. please use the .em-map CSS class'),updateCSSRule('.em-map','font-family',v), out);\r\n    out.botTxtFontSize = (v) => (console.warn('map.botTxtFontSize() is now DEPRECATED. please use the .em-footnote CSS class'),updateCSSRule('.em-footnote','font-size',v), out);\r\n    out.botTxtFill = (v) => (console.warn('map.botTxtFill() is now DEPRECATED. please use the .em-footnote CSS class'),updateCSSRule('.em-footnote','fill',v), out);\r\n    out.scalebarFontSize = (v) => (console.warn('map.scalebarFontSize() is now DEPRECATED. please use the .em-scalebar-label CSS class'),updateCSSRule('.em-scalebar-label','font-size',v), out);\r\n    out.frameStroke = (v)=> (console.warn('map.frameStroke() is now DEPRECATED. please use the .em-frame CSS class'),updateCSSRule('.em-frame','stroke',v), out);\r\n    out.frameStrokeWidth = (v)=> (console.warn('map.frameStrokeWidth() is now DEPRECATED. please use the .em-frame CSS class'),updateCSSRule('.em-frame','stroke-width',v), out);\r\n\r\n   //other\r\n    out.psClassifMethod = (v) => (console.warn('psClassifMethod() is now DEPRECATED. please use psClassificationMethod instead'),out.psClassificationMethod_ = v, out);\r\n    out.geoCenter = (v) => (console.warn('map.geoCenter() is now DEPRECATED. Please use map.position({x,y,z}) instead.'), out.position_.x = v[0], out.position_.y = v[1], out);\r\n    out.pixelSize = (v) => (console.warn('map.pixelSize() is now DEPRECATED. Please use the z property in map.position({x,y,z}) instead.'), out.position_.z = v, out);\r\n    out.pixSize = (v) => (console.warn('map.pixelSize() is now DEPRECATED. Please use the z property in map.position({x,y,z}) instead.'), out.position_.z = v, out);\r\n    out.tooltipText = (v) => (console.warn('map.tooltipText() is now DEPRECATED. Please use map.tooltip(config.textFunction) instead. See API reference for details.'), out.tooltip_.textFunction = v, out);\r\n    out.classifMethod = (v) => (console.warn('map.classifMethod() is now DEPRECATED. please use map.classificationMethod() instead.'), out.classificationMethod_ = v,out);\r\n    out.threshold = (v) => (console.warn('map.threshold() is now DEPRECATED. please use map.thresholds() instead.'), out.thresholds_ = v,out);\r\n    out.psThreshold = (v) => (console.warn('map.psThreshold() is now DEPRECATED. please use map.psThresholds() instead.'), out.psThresholds_ = v,out);\r\n    out.clnb = (v) => (console.warn('map.clnb() is now DEPRECATED. please use map.numberOfClasses() instead.'), out.numberOfClasses_ = v,out);\r\n    out.nutsLvl = (v) => (console.warn('map.nutsLvl() is now DEPRECATED. please use map.nutsLevel() instead.'), out.nutsLevel_ = v,out);\r\n    out.lg = (v) => (console.warn('map.lg() is now DEPRECATED. please use map.language() instead.'), out.language_ = v,out);\r\n    out.bottomText = (v) => (console.warn('bottomText is now DEPRECATED. Please use the footnote() method and em-footnote CSS class instead.'),out.footnote_ = v,out);\r\n    out.botTxtFontSize = (v) => (console.warn('botTxtFontSize is now DEPRECATED. Please use the em-footnote CSS class instead.'),out);\r\n    out.botTxtFill = (v) => (console.warn('botTxtFill is now DEPRECATED. Please use the em-footnote CSS class instead.'),out);\r\n    out.botTxtPadding = (v) => (console.warn('botTxtPadding is now DEPRECATED. Please use the em-footnote CSS class instead.'),out);\r\n    out.botTxtTooltipTxt = (v) => (console.warn('botTxtTooltipTxt is now DEPRECATED. Please use footnoteTooltipText() instead.'),out);\r\n    out.tooltipShowFlags = (v) =>(console.warn('tooltipShowFlags is now DEPRECATED. Please use out.tooltip({showFlags}) instead.'),out.tooltip_.showFlags = v,out);\r\n    out.colorFun = (v) =>(console.warn('colorFun is now DEPRECATED. Please use out.colorFunction() instead.'),out.colorFunction_ = v,out);\r\n    out.filtersDefinitionFun = (v)=>(console.warn('filtersDefinitionFun is now DEPRECATED. Please use out.filtersDefinitionFunction() instead.'),out.filtersDefinitionFunction_ = v,out);\r\n    \r\n    //labelling\r\n    out.labelling = (v) =>(console.warn('labelling is now DEPRECATED. Please use out.labels({}) configuration object instead. See documentation for details.'),out);\r\n    out.labelsConfig = (v) =>(console.warn('labelsConfig is now DEPRECATED. Please use out.labels({config:yourConfig}) configuration object instead. See documentation for details.'),out.labels_ =Object.assign(out.labels_ || {}, { config: v }),out);\r\n    out.statLabelsPositions = (v) =>(console.warn('statLabelsPositions is now DEPRECATED. Please use out.labels({statLabelsPositions:yourPositions}) instead. See documentation for details.'),out.labels_ = Object.assign(out.labels_ || {}, { statLabelsPositions: v }),out);\r\n    out.labelsToShow = (v) =>(console.warn('labelsToShow is now DEPRECATED. Please use out.labels({labelFilterFunction:yourFunction(region,map)}) function instead. See documentation for details.'),out);\r\n    out.labelShadowsToShow = (v) =>(console.warn('labelShadowsToShow is now DEPRECATED. Please use out.labels({labelFilterFunction:yourFunction(region,map)}) function instead. See documentation for details.'),out);\r\n    out.labelShadow = (v) =>(console.warn('labelShadow is now DEPRECATED. Please use out.labels({labelShadow:boolean}) instead. See documentation for details.'),out);\r\n    out.labelShadowWidth = (v) =>(console.warn('labelShadow is now DEPRECATED. Please use out.labels({labelShadow:boolean}) instead. See documentation for details.'),out);\r\n    out.labelFilterFunction =(v) =>(console.warn('labelFilterFunction is now DEPRECATED. Please use out.labels({labelFilterFunction:yourFunction(region,map)}) instead. See documentation for details.'),out);\r\n    out.labelFill = (v) => (console.warn('map.labelFill() is now DEPRECATED. please use the .em-stat-labels CSS class'), out);\r\n    out.labelStroke = (v) => (console.warn('map.labelStroke() is now DEPRECATED. please use the .em-stat-labels CSS class'), out);\r\n    out.labelStrokeWidth = (v) => (console.warn('map.labelStrokeWidth() is now DEPRECATED. please use the .em-stat-labels CSS class'), out);\r\n    out.labelOpacity = (v) => (console.warn('map.labelOpacity() is now DEPRECATED. please use the .em-stat-labels CSS class'), out);\r\n    out.labelValuesFontSize = (v) => (console.warn('map.labelValuesFontSize() is now DEPRECATED. please use the .em-stat-labels CSS class'), out);\r\n    out.labelShadowWidth = (v) => (console.warn('map.labelShadowWidth() is now DEPRECATED. please use the .em-stat-labels-shadows CSS class'), out);\r\n    out.labelShadowColor = (v) => (console.warn('map.labelShadowColor() is now DEPRECATED. please use the .em-stat-labels-shadows CSS class'), out);\r\n\r\n    out.countriesToShow = (v) => (console.warn('map.countriesToShow() is now DEPRECATED. please use the map.filterGeometriesFunction() function if you wish to filter the default geometries.'), out);\r\n    out.bordersToShow = (v) => (console.warn('map.bordersToShow() is now DEPRECATED. please use the map.filterGeometriesFunction() function if you wish to filter the default geometries.'), out);\r\n\r\n    //flow maps\r\n    out.flowDonutSizeScale = (v) => (console.warn('map.flowDonutSizeScale() is now DEPRECATED. please use flowNodeSizeScale_() instead.'), out.flowDonutSizeScale_ = v, out);\r\n    out.flowDonuts = (v) => (console.warn('map.flowDonuts() is now DEPRECATED. please use flowNodes(true).flowNodeType(\"donut\") instead.'), out.flowNodeType_ = v ? 'donut' : 'circle', out);\r\n    out.flowMapType = (v) => (console.warn('map.flowMapType() is now DEPRECATED. please use flowLineType() instead.'), out.flowLineType_ = v, out);\r\n    out.flowGradient = (v) => (console.warn('map.flowGradient() is now DEPRECATED. please use flowColorGradient() or flowWidthGradient() instead.'), out.flowColorGradient_ = v, out);\r\n    out.flowOverlayColors = (v) => (console.warn('map.flowOverlayColors() is now DEPRECATED. please use flowRegionColors() instead.'), out.flowRegionColors_ = v, out);\r\n    out.getFillPatternDefinitionFun = (v) => (console.warn('getFillPatternDefinitionFun is now DEPRECATED. please use fillPatternDefinitionFunction() instead.'), out.fillPatternDefinitionFunction_ = v, out);\r\n}\r\n","import { getFontSizeFromClass } from \"./utils\"\r\n\r\nexport function addTitle(out) {\r\n    // define default position\r\n    const cssClass = out.isInset ? 'em-inset-title' : 'em-title';\r\n    if (!out.titlePosition()) out.titlePosition([10, getFontSizeFromClass(cssClass) + (out.isInset ? 0 : 10)]);\r\n\r\n    // ensure header group exists (create if missing)\r\n    if (out.header_ && !out.isInset) {\r\n        if (out.svg().select('#em-header-' + out.svgId_).empty()) {\r\n            out.svg().append('g').attr('id', 'em-header-' + out.svgId_).attr('class', 'em-header');\r\n        }\r\n    }\r\n\r\n    const parent = out.header_ && !out.isInset\r\n        ? out.svg().select('#em-header-' + out.svgId_)\r\n        : out.svg(); // fallback to old behaviour\r\n\r\n    // remove any previous title (prevents duplicates and wrong bbox)\r\n    parent.select('#title' + out.geo_).remove();\r\n\r\n    // append new title (keep .html if you rely on markup)\r\n    parent.append('text')\r\n        .attr('id', 'title' + out.geo_)\r\n        .attr('class', cssClass)\r\n        .attr('x', out.titlePosition()[0])\r\n        .attr('y', out.titlePosition()[1])\r\n        .html(out.title());\r\n}\r\n\r\nexport function addSubtitle(out) {\r\n    if (!out.subtitle()) return;\r\n\r\n    const cssSubtitleClass = out.isInset ? 'em-inset-subtitle' : 'em-subtitle';\r\n    const cssTitleClass = out.isInset ? 'em-inset-title' : 'em-title';\r\n    if (!out.subtitlePosition()) out.subtitlePosition([10, getFontSizeFromClass(cssTitleClass) + getFontSizeFromClass(cssSubtitleClass) + 15]);\r\n\r\n    // ensure header group exists if needed\r\n    if (out.header_ && !out.isInset && out.svg().select('#em-header-' + out.svgId_).empty()) {\r\n        out.svg().append('g').attr('id', 'em-header-' + out.svgId_).attr('class', 'em-header');\r\n    }\r\n\r\n    const parent = out.header_ && !out.isInset\r\n        ? out.svg().select('#em-header-' + out.svgId_)\r\n        : out.svg();\r\n\r\n    parent.select('#subtitle' + out.geo_).remove();\r\n\r\n    parent.append('text')\r\n        .attr('id', 'subtitle' + out.geo_)\r\n        .attr('class', cssSubtitleClass)\r\n        .attr('x', out.subtitlePosition()[0])\r\n        .attr('y', out.subtitlePosition()[1])\r\n        .html(out.subtitle());\r\n}\r\n\r\n\r\nexport const addFootnote = function (out) {\r\n    const wrap = out.footnoteWrap_ || Infinity;   // e.g. user sets map.footnoteWrap(500)\r\n    const text = out.footnote_ || \"\";\r\n\r\n    // --- Determine base position depending on footer mode ---\r\n    let position;\r\n    if (out.footer_ && !out.isInset) {\r\n        // Footer is its own translated group; Y should be small padding only\r\n        position = out.footnotePosition_\r\n            ? [out.footnotePosition_[0], out.footnotePosition_[1]]\r\n            : [5, 10];\r\n    } else {\r\n        // Legacy mode: footnote drawn directly on SVG, use bottom of map area\r\n        position = out.footnotePosition_ ? out.footnotePosition_ : [10, out.height_];\r\n    }\r\n\r\n    const svg = out.svg();\r\n\r\n    // --- Choose correct parent group ---\r\n    let parent;\r\n    if (out.footer_ && !out.isInset) {\r\n        parent = svg.select('#em-footer-' + out.svgId_);\r\n        if (parent.empty()) {\r\n            parent = svg.append('g')\r\n                .attr('id', 'em-footer-' + out.svgId_)\r\n                .attr('class', 'em-footer');\r\n        }\r\n    } else {\r\n        parent = svg;\r\n    }\r\n\r\n    // --- Remove any existing footnote ---\r\n    parent.select('#em-footnote').remove();\r\n\r\n    // --- Append text element ---\r\n    const foot = parent.append(\"text\")\r\n        .attr(\"id\", \"em-footnote\")\r\n        .attr(\"class\", \"em-footnote\")\r\n        .attr(\"x\", position[0])\r\n        .attr(\"y\", position[1]);\r\n\r\n    // --- Wrapping logic ---\r\n    const words = text.split(/(\\s+)/); // keep whitespace tokens\r\n    let line = \"\";\r\n    let lineIndex = 0;\r\n\r\n    for (const w of words) {\r\n        if ((line + w).length > wrap && line.length > 0) {\r\n            foot.append(\"tspan\")\r\n                .attr(\"x\", position[0])\r\n                .attr(\"dy\", lineIndex === 0 ? 0 : \"1.2em\")\r\n                .html(line.trim());\r\n            line = w;\r\n            lineIndex++;\r\n        } else {\r\n            line += w;\r\n        }\r\n    }\r\n\r\n    // last line\r\n    if (line.trim().length > 0) {\r\n        foot.append(\"tspan\")\r\n            .attr(\"x\", position[0])\r\n            .attr(\"dy\", lineIndex === 0 ? 0 : \"1.2em\")\r\n            .html(line.trim());\r\n    }\r\n\r\n    // --- Tooltip logic ---\r\n    foot\r\n        .on(\"mouseover\", function () {\r\n            out._tooltip.mw___ = out._tooltip.style(\"max-width\");\r\n            out._tooltip.style(\"max-width\", \"400px\");\r\n            if (out.footnoteTooltipText_) out._tooltip.mouseover(out.footnoteTooltipText_);\r\n        })\r\n        .on(\"mousemove\", function (e) {\r\n            if (out.footnoteTooltipText_) out._tooltip.mousemove(e);\r\n        })\r\n        .on(\"mouseout\", function () {\r\n            if (out.footnoteTooltipText_) out._tooltip.mouseout();\r\n            out._tooltip.style(\"max-width\", out._tooltip.mw___);\r\n        });\r\n\r\n    return out;\r\n};\r\n\r\nexport function addSourceLink(out, withCenterPoints) {\r\n    const svg = out.svg();\r\n\r\n    // --- Choose correct parent group ---\r\n    let parent;\r\n    if (out.footer_ && !out.isInset) {\r\n        parent = svg.select('#em-footer-' + out.svgId_);\r\n        if (parent.empty()) {\r\n            parent = svg.append('g')\r\n                .attr('id', 'em-footer-' + out.svgId_)\r\n                .attr('class', 'em-footer');\r\n        }\r\n    } else {\r\n        parent = svg;\r\n    }\r\n\r\n    // --- Remove any existing source link ---\r\n    parent.selectAll('#em-source-link, .em-source-dataset-link, .em-source-pretext').remove();\r\n\r\n    // --- Retrieve dataset info ---\r\n    const stat = withCenterPoints ? out.stat('size') : out.stat();\r\n    if (!stat || !stat.eurostatDatasetCode) return;\r\n\r\n    // --- Compute link URL ---\r\n    const code = stat.eurostatDatasetCode;\r\n    const url = `https://ec.europa.eu/eurostat/databrowser/view/${code}/default/table?lang=en`;\r\n\r\n    // --- Determine positioning ---\r\n    // In footer mode  near top of footer; otherwise  bottom of map\r\n    const yPos = out.footer_ && !out.isInset ? 10 : out.height_;\r\n    const paddingRight = 10;\r\n\r\n    // --- Append dataset link ---\r\n    const linkText = parent.append('a')\r\n        .attr('class', 'em-source-dataset-link')\r\n        .attr('href', url)\r\n        .attr('target', '_blank')\r\n        .append('text')\r\n        .attr('class', 'em-source-dataset-link-text')\r\n        .attr('x', out.width_ - paddingRight)\r\n        .attr('y', yPos)\r\n        .text('EUROSTAT')\r\n        .attr('text-anchor', 'end');\r\n\r\n    const linkWidth = linkText.node().getComputedTextLength();\r\n\r\n    // --- Append \"Source:\" pretext ---\r\n    parent.append('text')\r\n        .attr('id', 'em-source-link')\r\n        .attr('class', 'em-source-pretext')\r\n        .attr('x', out.width_ - linkWidth - paddingRight - 6)\r\n        .attr('y', yPos)\r\n        .text('Source:')\r\n        .attr('text-anchor', 'end');\r\n}\r\n","const EUROSTAT_SVG_DATA_URI = 'data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20%20%20%20%20viewBox%3D%22317.6%20263.7%20206.4%2067.9%22%20%20%20%20%20preserveAspectRatio%3D%22xMinYMid%20meet%22%20%20%20%20%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20%20%20%20%20xml%3Aspace%3D%22preserve%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E.st0%7Bfill%3Anone%3B%7D.st1%7Bfill%3A%23164194%3B%7D.st2%7Bfill%3A%23FFED00%3B%7D.st3%7Bfill%3A%237C7C7B%3B%7D%3C%2Fstyle%3E%3Crect%20x%3D%22317.6%22%20y%3D%22263.7%22%20class%3D%22st0%22%20width%3D%22206.4%22%20height%3D%2267.9%22%2F%3E%3Cg%3E%3Cg%3E%3Cg%20id%3D%22EUflag_16_%22%3E%3Cpolygon%20class%3D%22st1%22%20points%3D%22501.4%2C309%20501.4%2C286.3%20467.4%2C286.3%20467.4%2C309%20501.4%2C309%20%22%2F%3E%3C%2Fg%3E%3Cg%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22485%2C289.8%20486.1%2C289.8%20485.2%2C290.5%20485.6%2C291.6%20484.6%2C290.9%20483.7%2C291.6%20484.1%2C290.5%20483.2%2C289.8%20484.3%2C289.8%20484.6%2C288.7%20485%2C289.8%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22485%2C304.9%20486.2%2C304.9%20485.2%2C305.6%20485.6%2C306.7%20484.7%2C306%20483.8%2C306.7%20484.1%2C305.6%20483.2%2C304.9%20484.3%2C304.9%20484.7%2C303.8%20485%2C304.9%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22488.8%2C303.9%20489.9%2C303.9%20489%2C304.6%20489.3%2C305.7%20488.4%2C305%20487.5%2C305.7%20487.9%2C304.6%20486.9%2C303.9%20488.1%2C303.9%20488.4%2C302.8%20488.8%2C303.9%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22488.8%2C290.8%20489.9%2C290.8%20489%2C291.5%20489.3%2C292.6%20488.4%2C291.9%20487.5%2C292.6%20487.9%2C291.5%20486.9%2C290.8%20488.1%2C290.8%20488.4%2C289.7%20488.8%2C290.8%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22491.5%2C293.6%20492.7%2C293.6%20491.8%2C294.3%20492.1%2C295.4%20491.2%2C294.7%20490.3%2C295.4%20490.6%2C294.3%20489.7%2C293.6%20490.9%2C293.6%20491.2%2C292.5%20491.5%2C293.6%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22491.5%2C301.2%20492.7%2C301.2%20491.8%2C301.9%20492.1%2C302.9%20491.2%2C302.3%20490.3%2C302.9%20490.6%2C301.9%20489.7%2C301.2%20490.9%2C301.2%20491.2%2C300.1%20491.5%2C301.2%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22492.6%2C297.3%20493.7%2C297.3%20492.8%2C298%20493.1%2C299.1%20492.2%2C298.4%20491.3%2C299.1%20491.7%2C298%20490.8%2C297.3%20491.9%2C297.3%20492.2%2C296.3%20492.6%2C297.3%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22481.2%2C290.8%20482.3%2C290.8%20481.4%2C291.5%20481.7%2C292.6%20480.8%2C291.9%20479.9%2C292.6%20480.3%2C291.5%20479.4%2C290.8%20480.5%2C290.8%20480.8%2C289.7%20481.2%2C290.8%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22478.5%2C293.6%20479.6%2C293.6%20478.7%2C294.3%20479%2C295.4%20478.1%2C294.7%20477.2%2C295.4%20477.6%2C294.3%20476.7%2C293.6%20477.8%2C293.6%20478.1%2C292.5%20478.5%2C293.6%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22477.5%2C297.3%20478.6%2C297.3%20477.7%2C298%20478%2C299.1%20477.1%2C298.4%20476.2%2C299.1%20476.6%2C298%20475.7%2C297.3%20476.8%2C297.3%20477.1%2C296.3%20477.5%2C297.3%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22478.5%2C301.2%20479.6%2C301.2%20478.7%2C301.9%20479%2C303%20478.1%2C302.3%20477.2%2C303%20477.6%2C301.9%20476.7%2C301.2%20477.8%2C301.2%20478.1%2C300.1%20478.5%2C301.2%20%22%2F%3E%3Cpolygon%20class%3D%22st2%22%20points%3D%22481.2%2C303.9%20482.3%2C303.9%20481.4%2C304.6%20481.8%2C305.7%20480.9%2C305%20480%2C305.7%20480.3%2C304.6%20479.4%2C303.9%20480.5%2C303.9%20480.9%2C302.9%20481.2%2C303.9%20%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cg%3E%3Cpath%20class%3D%22st3%22%20d%3D%22M337.3%2C304.5c0.7%2C0.7%2C1.8%2C1.1%2C3.1%2C1.1c1%2C0%2C1.8-0.2%2C2.5-0.7s1.1-1%2C1.3-1.5h4.2c-0.7%2C2.1-1.7%2C3.6-3.1%2C4.5c-1.4%2C0.9-3.1%2C1.4-5.1%2C1.4c-1.4%2C0-2.6-0.2-3.7-0.7c-1.1-0.4-2-1.1-2.8-1.9s-1.4-1.8-1.8-2.9c-0.4-1.1-0.6-2.4-0.6-3.7c0-1.3%2C0.2-2.5%2C0.6-3.7c0.4-1.1%2C1-2.1%2C1.8-2.9c0.8-0.8%2C1.7-1.5%2C2.8-1.9c1.1-0.5%2C2.3-0.7%2C3.6-0.7c1.5%2C0%2C2.8%2C0.3%2C3.9%2C0.9s2%2C1.4%2C2.7%2C2.3c0.7%2C1%2C1.2%2C2.1%2C1.5%2C3.3c0.3%2C1.2%2C0.4%2C2.5%2C0.3%2C3.9h-12.6C336.2%2C302.7%2C336.6%2C303.8%2C337.3%2C304.5z%20M342.8%2C295.3c-0.6-0.6-1.5-0.9-2.6-0.9c-0.8%2C0-1.4%2C0.1-1.9%2C0.4c-0.5%2C0.3-0.9%2C0.6-1.2%2C1c-0.3%2C0.4-0.5%2C0.8-0.6%2C1.2c-0.1%2C0.4-0.2%2C0.8-0.2%2C1.2h7.8C343.7%2C296.9%2C343.3%2C296%2C342.8%2C295.3z%20M462.6%2C291v3.9h-3.1v8.2c0%2C0.8%2C0%2C1.4%2C0.3%2C1.6c0.3%2C0.3%2C0.8%2C0.4%2C1.6%2C0.4c0.3%2C0%2C0.4%2C0%2C0.7%2C0c0.2%2C0%2C0.6-0.1%2C0.6-0.1v3.7c0%2C0.1-0.8%2C0.1-1.3%2C0.1c-0.5%2C0-0.9%2C0-1.4%2C0c-0.7%2C0-1.4%2C0-2.1-0.2c-0.7-0.1-1.2-0.3-1.7-0.6c-0.5-0.3-0.8-0.7-1.1-1.2c-0.3-0.5-0.3-1.2-0.3-2.1V295h-3.1V291h3.1v-4.7h4.7v4.7H462.6z%20M443.9%2C300.7c-0.3%2C0.1-0.6%2C0.2-0.9%2C0.2c-0.3%2C0.1-0.7%2C0.1-1.1%2C0.2c-0.4%2C0.1-0.8%2C0.1-1.1%2C0.2c-0.4%2C0.1-0.7%2C0.1-1%2C0.3c-0.4%2C0.1-0.7%2C0.3-0.9%2C0.5c-0.3%2C0.2-0.5%2C0.4-0.6%2C0.7c-0.2%2C0.3-0.2%2C0.7-0.2%2C1.1c0%2C0.4%2C0.1%2C0.8%2C0.2%2C1.1c0.2%2C0.3%2C0.4%2C0.5%2C0.6%2C0.7c0.3%2C0.2%2C0.6%2C0.3%2C0.9%2C0.4c0.4%2C0.1%2C0.7%2C0.1%2C1.1%2C0.1c0.9%2C0%2C1.7-0.1%2C2.2-0.5c0.5-0.3%2C0.9-0.7%2C1.1-1.1c0.2-0.4%2C0.3-0.9%2C0.4-1.3c0.1-0.5%2C0-0.8%2C0-1.1v-1.8C444.6%2C300.4%2C444.2%2C300.6%2C443.9%2C300.7%20M434.6%2C293.8c0.5-0.7%2C1.1-1.3%2C1.9-1.7c0.8-0.5%2C1.6-0.7%2C2.6-0.9c0.9-0.2%2C1.9-0.3%2C2.9-0.3c0.9%2C0%2C1.8%2C0.1%2C2.7%2C0.2c0.9%2C0.1%2C1.7%2C0.4%2C2.5%2C0.7c0.7%2C0.4%2C1.2%2C0.9%2C1.7%2C1.5c0.5%2C0.6%2C0.6%2C1.5%2C0.6%2C2.5v9.1c0%2C0.8%2C0.2%2C1.5%2C0.3%2C2.2c0.1%2C0.7%2C0.3%2C1.3%2C0.5%2C1.6l-4.8%2C0c-0.1-0.3-0.1-0.5-0.2-0.8c-0.1-0.3-0.1-0.6-0.1-0.9c-0.8%2C0.8-1.7%2C1.3-2.7%2C1.6c-1%2C0.3-2.1%2C0.5-3.2%2C0.5c-0.8%2C0-1.6-0.1-2.3-0.3c-0.7-0.2-1.3-0.5-1.9-0.9c-0.5-0.4-1-1-1.3-1.6c-0.3-0.7-0.4-1.4-0.4-2.3c0-1%2C0.2-1.8%2C0.5-2.4c0.3-0.6%2C0.8-1.2%2C1.3-1.5c0.5-0.4%2C1.2-0.7%2C1.9-0.9c0.7-0.2%2C1.4-0.3%2C2.1-0.5c0.7-0.1%2C1.4-0.2%2C2.1-0.3c0.7-0.1%2C1.3-0.2%2C1.9-0.3c0.5-0.1%2C1-0.3%2C1.3-0.6c0.3-0.3%2C0.5-0.6%2C0.4-1.1c0-0.5-0.1-0.9-0.3-1.2c-0.2-0.3-0.4-0.5-0.7-0.7c-0.3-0.2-0.6-0.3-1-0.3c-0.4-0.1-0.8-0.1-1.2-0.1c-0.9%2C0-1.7%2C0.1-2.2%2C0.5c-0.5%2C0.4-0.8%2C1.1-0.9%2C1.9h-4.8C433.9%2C295.7%2C434.1%2C294.6%2C434.6%2C293.8%20M431.3%2C291v3.9h-3.9v8.2c0%2C0.8%2C0.3%2C1.4%2C0.5%2C1.6c0.3%2C0.3%2C0.9%2C0.4%2C1.7%2C0.4c0.3%2C0%2C0.6%2C0%2C0.9%2C0c0.3%2C0%2C0.8-0.1%2C0.8-0.1v3.7c-0.8%2C0.1-0.9%2C0.1-1.4%2C0.1c-0.5%2C0-1%2C0-1.5%2C0c-0.7%2C0-1.5%2C0-2.1-0.2c-0.7-0.1-1.3-0.3-1.8-0.6c-0.5-0.3-1-0.7-1.3-1.2c-0.3-0.5-0.5-1.2-0.5-2.1V295h-2.3V291h2.3v-4.7h4.7v4.7H431.3z%20M407.5%2C304.3c0.2%2C0.4%2C0.5%2C0.8%2C0.8%2C1c0.3%2C0.2%2C0.7%2C0.5%2C1.2%2C0.6c0.4%2C0.1%2C0.9%2C0.2%2C1.3%2C0.2c0.3%2C0%2C0.7%2C0%2C1.1-0.1c0.4-0.1%2C0.7-0.2%2C1-0.4c0.3-0.2%2C0.6-0.4%2C0.8-0.7c0.2-0.3%2C0.3-0.6%2C0.3-1.1c0-0.7-0.5-1.3-1.4-1.6c-1-0.4-2.3-0.7-4-1.1c-0.7-0.2-1.4-0.4-2-0.6c-0.7-0.2-1.2-0.5-1.8-0.8c-0.5-0.4-0.9-0.8-1.2-1.3c-0.3-0.5-0.5-1.2-0.5-1.9c0-1.1%2C0.2-2%2C0.7-2.7c0.4-0.7%2C1-1.3%2C1.7-1.7c0.7-0.4%2C1.5-0.7%2C2.4-0.9c0.9-0.2%2C1.8-0.2%2C2.8-0.2c0.9%2C0%2C1.9%2C0.1%2C2.7%2C0.3c0.9%2C0.2%2C1.7%2C0.5%2C2.4%2C0.9c0.7%2C0.4%2C1.3%2C1%2C1.7%2C1.7c0.5%2C0.7%2C0.7%2C1.9%2C0.8%2C2.7h-4.5c-0.1-0.8-0.4-1.6-1-1.9c-0.6-0.3-1.4-0.5-2.2-0.5c-0.3%2C0-0.6%2C0-0.9%2C0c-0.3%2C0-0.6%2C0.1-0.9%2C0.2c-0.3%2C0.1-0.5%2C0.3-0.7%2C0.5c-0.2%2C0.2-0.3%2C0.5-0.3%2C0.9c0%2C0.4%2C0.2%2C0.8%2C0.5%2C1c0.3%2C0.3%2C0.7%2C0.5%2C1.2%2C0.7c0.5%2C0.2%2C1.1%2C0.3%2C1.7%2C0.5c0.6%2C0.1%2C1.3%2C0.3%2C2%2C0.4c0.7%2C0.2%2C1.4%2C0.3%2C2%2C0.6c0.7%2C0.2%2C1.2%2C0.5%2C1.8%2C0.9c0.5%2C0.4%2C0.9%2C0.8%2C1.2%2C1.4c0.3%2C0.6%2C0.5%2C1.2%2C0.5%2C2c0%2C1.1-0.2%2C2.1-0.7%2C2.9c-0.5%2C0.8-1.1%2C1.4-1.8%2C1.9c-0.7%2C0.5-1.6%2C0.8-2.5%2C1c-1%2C0.2-1.9%2C0.3-2.9%2C0.3c-1%2C0-2-0.1-2.9-0.3c-1-0.2-1.8-0.5-2.6-1c-0.7-0.5-1.4-1.3-1.8-2c-0.5-0.8-0.7-1.5-0.8-3.1h4.5C407.2%2C303.6%2C407.3%2C303.9%2C407.5%2C304.3%20M383.7%2C296.3c0.4-1.1%2C1-2.1%2C1.8-2.9c0.8-0.8%2C1.7-1.4%2C2.8-1.8c1.1-0.4%2C2.3-0.6%2C3.7-0.6c1.4%2C0%2C2.6%2C0.2%2C3.7%2C0.6c1.1%2C0.4%2C2%2C1.1%2C2.8%2C1.8c0.8%2C0.8%2C1.4%2C1.8%2C1.8%2C2.9c0.4%2C1.1%2C0.6%2C2.4%2C0.6%2C3.8c0%2C1.4-0.2%2C2.6-0.6%2C3.8c-0.4%2C1.1-1%2C2.1-1.8%2C2.9c-0.8%2C0.8-1.7%2C1.4-2.8%2C1.8c-1.1%2C0.4-2.4%2C0.6-3.7%2C0.6c-1.4%2C0-2.6-0.2-3.7-0.6c-1.1-0.4-2-1-2.8-1.8c-0.8-0.8-1.4-1.8-1.8-2.9c-0.4-1.1-0.6-2.4-0.6-3.8C383.1%2C298.7%2C383.3%2C297.4%2C383.7%2C296.3%20M388.1%2C302.1c0.1%2C0.7%2C0.4%2C1.3%2C0.7%2C1.8c0.3%2C0.5%2C0.8%2C0.9%2C1.3%2C1.3c0.5%2C0.3%2C1.2%2C0.5%2C2%2C0.5c0.8%2C0%2C1.5-0.2%2C2-0.5c0.5-0.3%2C1-0.7%2C1.3-1.3c0.3-0.5%2C0.6-1.1%2C0.7-1.8c0.1-0.7%2C0.2-1.3%2C0.2-2c0-0.7-0.1-1.4-0.2-2.1c-0.1-0.7-0.4-1.3-0.7-1.8c-0.3-0.5-0.8-0.9-1.3-1.3c-0.6-0.3-1.2-0.5-2-0.5c-0.8%2C0-1.5%2C0.2-2%2C0.5c-0.5%2C0.3-1%2C0.8-1.3%2C1.3c-0.3%2C0.5-0.5%2C1.1-0.7%2C1.8c-0.1%2C0.7-0.2%2C1.4-0.2%2C2.1C387.9%2C300.8%2C387.9%2C301.5%2C388.1%2C302.1%20M376.5%2C291v3.9h-0.1c0.2-0.8%2C0.5-1.2%2C0.9-1.7c0.4-0.5%2C0.8-0.9%2C1.3-1.3c0.5-0.3%2C1-0.6%2C1.6-0.8c0.6-0.2%2C1.1-0.3%2C1.6-0.3c0.3%2C0%2C0.9%2C0%2C0.9%2C0.1v4.4c0%2C0-0.4-0.1-0.7-0.1c-0.3%2C0-0.6%2C0-0.9%2C0c-0.9%2C0-1.6%2C0.1-2.2%2C0.4c-0.6%2C0.3-1.1%2C0.7-1.4%2C1.2c-0.4%2C0.5-0.6%2C1.1-0.8%2C1.8c-0.2%2C0.7-0.2%2C1.4-0.2%2C2.2v8.1h-4.7v-18H376.5z%20M363.2%2C309v-2.3h0c-0.6%2C0.8-1.4%2C1.6-2.4%2C2c-1%2C0.4-1.9%2C0.6-3%2C0.6c-1.3%2C0-2.3-0.2-3.1-0.5c-0.8-0.3-1.5-0.8-1.9-1.4c-0.5-0.6-0.8-1.4-1-2.3c-0.2-0.9-0.3-1.9-0.3-3V291h4.7v10.2c0%2C1.4%2C0.3%2C2.5%2C0.8%2C3.2c0.5%2C0.7%2C1.3%2C1.1%2C2.4%2C1.1c1.3%2C0%2C2.3-0.4%2C2.9-1.2c0.6-0.8%2C1-2.1%2C1-3.8V291h4.7v18H363.2z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E'\r\nconst EUROSTAT_RIBBON_DATA_URI = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAiIGhlaWdodD0iNjMiIHZpZXdCb3g9IjAgMCAxNDAgNjMiPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXItZ3JhZGllbnQiIHgxPSIwLjE1NSIgeTE9IjEiIHgyPSIwLjgzNyIgeTI9IjAuMDExIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzA4MmI3YSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIwLjUiIHN0b3AtY29sb3I9IiMwZTQ3Y2IiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXItZ3JhZGllbnQtMiIgeDE9IjAuNzU5IiB5MT0iMC45OTEiIHgyPSIwLjI0MyIgeTI9IjAuMDEzIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2Y0ZjVmNSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjN2Q4MDg4IiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0ibGluZWFyLWdyYWRpZW50LTMiIHgxPSIwLjE3IiB5MT0iMC45NzkiIHgyPSIwLjg0MyIgeTI9IjAuMDAyIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZmNmMiIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIwLjUiIHN0b3AtY29sb3I9IiNmYzAiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KCiAgPGcgaWQ9ImV1cm9zdGF0LXJpYmJvbiI+CiAgICA8cGF0aCBkPSJNMTA2LjUyMiA0Ljk4MUw5MC42MjggNC45ODFMNTUuMjUyIDQ3LjEzN0w3MS4xNDYgNDcuMTM3TDEwNi41MjIgNC45ODFaIgogICAgICAgICAgZmlsbD0idXJsKCNsaW5lYXItZ3JhZGllbnQpIiAvPgogICAgPHBhdGggZD0iTTM3LjU2MyAyNi4wNkw1My40NTkgMjYuMDZMNzEuMTQ2IDQ3LjEzOEw1NS4yNTIgNDcuMTM4TDM3LjU2MyAyNi4wNloiCiAgICAgICAgICBmaWxsPSJ1cmwoI2xpbmVhci1ncmFkaWVudC0yKSIgLz4KICAgIDxwYXRoIGQ9Ik01My40NTYgMjYuMDZMMzcuNTYgMjYuMDZMMi4xODQgNjguMjE2TDE4LjA3OSA2OC4yMTZMNTMuNDU2IDI2LjA2WiIKICAgICAgICAgIGZpbGw9InVybCgjbGluZWFyLWdyYWRpZW50LTMpIiAvPgogICAgPHBhdGggZD0iTTQ1LjQ5MSAzNS40ODlMNTYuOTc1IDQ5LjE5MkwzNC4wMDYgNDkuMTkyTDQ1LjQ5MSAzNS40ODlaIgogICAgICAgICAgY2xhc3M9ImxvZ28tcmliYm9uLWN1dC1maWxsIgogICAgICAgICAgZmlsbD0iI2ZmZiIgLz4KICAgIDxwYXRoIGQ9Ik0xMDYuNDkxIDQuOTgzTDE0Mi4xODQgNDcuNTI5TDcwLjc5NyA0Ny41MjlMMTA2LjQ5MSA0Ljk4M1oiCiAgICAgICAgICBmaWxsPSIjZmZmIiAvPgogIDwvZz4KPC9zdmc+Cg=='\r\n\r\nexport const addEurostatLogo = function (out) {\r\n    const svg = out.svg();\r\n\r\n    // --- Ensure a shared group exists ---\r\n    let group = svg.select('#em-logo-group');\r\n    if (group.empty()) {\r\n        group = svg.append('g')\r\n            .attr('id', 'em-logo-group')\r\n            .attr('class', 'em-logo-group');\r\n    }\r\n\r\n    const logoWidth = out.logoWidth_ || 200;\r\n    const logoHeight = out.logoHeight_ || 40;\r\n    const margin = 10;\r\n\r\n    const x = out.logoPosition_\r\n        ? out.logoPosition_[0]\r\n        : out.width_ - logoWidth - margin;\r\n    const y = out.logoPosition_\r\n        ? out.logoPosition_[1]\r\n        : out.height_ - logoHeight - margin;\r\n\r\n    // --- Remove existing logo only, not the entire group ---\r\n    group.selectAll('.em-eurostat-logo').remove();\r\n\r\n    group.append('image')\r\n        .attr('href', EUROSTAT_SVG_DATA_URI)\r\n        .attr('width', logoWidth)\r\n        .attr('height', logoHeight)\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .attr('class', 'em-eurostat-logo');\r\n};\r\n\r\n\r\nexport const addEurostatRibbon = function (out) {\r\n    const svg = out.svg();\r\n\r\n    // --- Ensure the same shared group exists ---\r\n    let group = svg.select('#em-logo-group');\r\n    if (group.empty()) {\r\n        group = svg.append('g')\r\n            .attr('id', 'em-logo-group')\r\n            .attr('class', 'em-logo-group');\r\n    }\r\n\r\n    const ribbonWidth = out.ribbonWidth_ || 200;\r\n    const ribbonHeight = out.ribbonHeight_ || 40;\r\n    const margin = 10;\r\n\r\n    let x = out.ribbonPosition_\r\n        ? out.ribbonPosition_[0]\r\n        : out.width_ - ribbonWidth - margin;\r\n    let y = out.ribbonPosition_\r\n        ? out.ribbonPosition_[1]\r\n        : out.height_ - ribbonHeight - margin;\r\n\r\n    if (out.footer && !out.ribbonPosition_) {\r\n        y += 80; // move down if footer is present\r\n    }\r\n\r\n    // --- Remove existing ribbon, not the whole group ---\r\n    group.selectAll('.em-eurostat-ribbon').remove();\r\n\r\n    group.append('image')\r\n        .attr('href', EUROSTAT_RIBBON_DATA_URI)\r\n        .attr('width', ribbonWidth)\r\n        .attr('height', ribbonHeight)\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .attr('class', 'em-eurostat-ribbon');\r\n};\r\n","import { select } from 'd3-selection'\r\nimport { getCSSPropertyFromClass } from '../utils'\r\n\r\nexport const appendZoomButtons = (map) => {\r\n    const svg = select('#' + map.svgId())\r\n\r\n    const buttonGroup = svg\r\n        .append('g')\r\n        .attr('class', 'em-zoom-buttons')\r\n        // .attr('transform', `translate(${map.width_ - 50}, 20)`)\r\n        .style('pointer-events', 'all') // allow clicks\r\n\r\n    const buttonSize = parseInt(getCSSPropertyFromClass('em-button', 'width')) || 30 // Default to 30px if not set\r\n\r\n    const zoomInBtn = buttonGroup.append('g').attr('class', 'em-zoom-in em-button').style('cursor', 'pointer')\r\n    zoomInBtn.append('title').text('Zoom in')\r\n    zoomInBtn.append('rect').attr('width', buttonSize).attr('height', buttonSize)\r\n    zoomInBtn\r\n        .append('text')\r\n        .attr('x', buttonSize / 2)\r\n        .attr('y', buttonSize / 2 + 7)\r\n        .text('+')\r\n\r\n    const zoomOutBtn = buttonGroup\r\n        .append('g')\r\n        .attr('class', 'em-zoom-out em-button')\r\n        .style('cursor', 'pointer')\r\n        .attr('transform', `translate(0, ${buttonSize})`)\r\n        .style('cursor', 'pointer')\r\n    zoomOutBtn.append('title').text('Zoom out')\r\n    zoomOutBtn.append('rect').attr('width', buttonSize).attr('height', buttonSize)\r\n\r\n    zoomOutBtn\r\n        .append('text')\r\n        .attr('x', buttonSize / 2)\r\n        .attr('y', buttonSize / 2 + 7)\r\n        .text('')\r\n\r\n    zoomInBtn.on('click', function (event) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        zoomIn(map)\r\n    })\r\n\r\n    zoomOutBtn.on('click', function (event) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        zoomOut(map)\r\n    })\r\n}\r\n\r\nfunction zoomIn(map) {\r\n    map.svg_.transition().call(map.__zoomBehavior.scaleBy, 2)\r\n}\r\n\r\nfunction zoomOut(map) {\r\n    map.svg_.transition().call(map.__zoomBehavior.scaleBy, 0.5)\r\n}\r\n","import clipRectangle from \"../clip/rectangle.js\";\nimport identity from \"../identity.js\";\nimport {transformer} from \"../transform.js\";\nimport {fitExtent, fitSize, fitWidth, fitHeight} from \"./fit.js\";\nimport {cos, degrees, radians, sin} from \"../math.js\";\n\nexport default function() {\n  var k = 1, tx = 0, ty = 0, sx = 1, sy = 1, // scale, translate and reflect\n      alpha = 0, ca, sa, // angle\n      x0 = null, y0, x1, y1, // clip extent\n      kx = 1, ky = 1,\n      transform = transformer({\n        point: function(x, y) {\n          var p = projection([x, y])\n          this.stream.point(p[0], p[1]);\n        }\n      }),\n      postclip = identity,\n      cache,\n      cacheStream;\n\n  function reset() {\n    kx = k * sx;\n    ky = k * sy;\n    cache = cacheStream = null;\n    return projection;\n  }\n\n  function projection (p) {\n    var x = p[0] * kx, y = p[1] * ky;\n    if (alpha) {\n      var t = y * ca - x * sa;\n      x = x * ca + y * sa;\n      y = t;\n    }    \n    return [x + tx, y + ty];\n  }\n  projection.invert = function(p) {\n    var x = p[0] - tx, y = p[1] - ty;\n    if (alpha) {\n      var t = y * ca + x * sa;\n      x = x * ca - y * sa;\n      y = t;\n    }\n    return [x / kx, y / ky];\n  };\n  projection.stream = function(stream) {\n    return cache && cacheStream === stream ? cache : cache = transform(postclip(cacheStream = stream));\n  };\n  projection.postclip = function(_) {\n    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;\n  };\n  projection.clipExtent = function(_) {\n    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];\n  };\n  projection.scale = function(_) {\n    return arguments.length ? (k = +_, reset()) : k;\n  };\n  projection.translate = function(_) {\n    return arguments.length ? (tx = +_[0], ty = +_[1], reset()) : [tx, ty];\n  }\n  projection.angle = function(_) {\n    return arguments.length ? (alpha = _ % 360 * radians, sa = sin(alpha), ca = cos(alpha), reset()) : alpha * degrees;\n  };\n  projection.reflectX = function(_) {\n    return arguments.length ? (sx = _ ? -1 : 1, reset()) : sx < 0;\n  };\n  projection.reflectY = function(_) {\n    return arguments.length ? (sy = _ ? -1 : 1, reset()) : sy < 0;\n  };\n  projection.fitExtent = function(extent, object) {\n    return fitExtent(projection, extent, object);\n  };\n  projection.fitSize = function(size, object) {\n    return fitSize(projection, size, object);\n  };\n  projection.fitWidth = function(width, object) {\n    return fitWidth(projection, width, object);\n  };\n  projection.fitHeight = function(height, object) {\n    return fitHeight(projection, height, object);\n  };\n\n  return projection;\n}\n","// jsonstat-toolkit v1.6.0 Copyright 2025 Xavier Badosa https://jsonstat.com\nfunction t(i,r){var l,s,o,a,u=function(t,i,r){if(0===Object.entries(t).length)return null;var l,s=[];if(r&&!n(r.name)&&(r=null),\"string\"==typeof t&&(t=[t]),Array.isArray(t)||e(t)){if(t.length===i)return r&&-1===t.findIndex((function(t){return null==t}))?r.from(t):t;if(1===t.length){for(l=0;l<i;l++)s.push(t[0]);return s}}for(l=0;l<i;l++){var o=void 0===t[l]?null:t[l];s.push(o)}return s};if(this.length=0,this.id=[],null!=i)switch(this.class=i.class||\"bundle\",this.class){case\"bundle\":var h=[],f=0;if(this.error=null,this.length=0,null===i||\"object\"!=typeof i)return void(this.class=null);if(i.hasOwnProperty(\"error\"))return void(this.error=i.error);if(\"dataset\"===i.class||\"collection\"===i.class||\"dimension\"===i.class)return new t(i);for(s in i)f++,h.push(s);this.__tree__=i,this.length=f,this.id=h;break;case\"dataset\":i.hasOwnProperty(\"__tree__\")?this.__tree__=l=i.__tree__:this.__tree__=l=i,this.label=l.label||null,this.note=l.note||null,this.link=l.link||null,this.href=l.href||null,this.updated=l.updated||null,this.source=l.source||null,this.extension=l.extension||null;var c,d=0,v=l.size||l.dimension&&l.dimension.size;if(this.size=v,this.value=l.hasOwnProperty(\"value\")&&null!==l.value&&0!==l.value.length?l.value:{},Array.isArray(this.value)||e(this.value))d=this.value.length;else{var y=1;for(c=v.length;c--;)y*=v[c];d=y}if(this.value=u(this.value,d,r),this.status=l.hasOwnProperty(\"status\")&&null!==l.status?u(l.status,d):null,l.hasOwnProperty(\"dimension\")){var p=l.dimension,g=l.role||!l.version&&p.role||null,b=l.id||p.id,m=v.length,_=function(t){g.hasOwnProperty(t)||(g[t]=null)};if(!Array.isArray(b)||!Array.isArray(v)||b.length!=m)return;if(this.length=m,this.id=b,g&&(_(\"time\"),_(\"geo\"),_(\"metric\"),_(\"classification\")),g&&null===g.classification){var x=[],O=[\"time\",\"geo\",\"metric\"],A=function(t,e){for(var n=e.length;n--;)if(t===e[n])return!0;return!1};for(c=0;c<3;c++){var w=g[O[c]];null!==w&&(x=x.concat(w))}for(g.classification=[],c=0;c<m;c++)A(b[c],x)||g.classification.push(b[c]);0===g.classification.length&&(g.classification=null)}this.role=g,this.n=d;for(var j=0,k=this.length;j<k;j++)if(p[b[j]].category.hasOwnProperty(\"index\")){if(Array.isArray(p[b[j]].category.index)){var D={},P=p[b[j]].category.index;for(o=P.length,a=0;a<o;a++)D[P[a]]=a;p[b[j]].category.index=D}}else{var E=0;for(s in p[b[j]].category.index={},p[b[j]].category.label)p[b[j]].category.index[s]=E++}}else this.length=0;break;case\"dimension\":if(!i.hasOwnProperty(\"__tree__\"))return new t({version:\"2.0\",class:\"dataset\",dimension:{d:i},id:[\"d\"],size:[function(t){var e=void 0===t.index?t.label:t.index;return Array.isArray(e)?e.length:Object.keys(e).length}(i.category)],value:[null]}).Dimension(0);var z=[],S=(l=i.__tree__).category;if(!l.hasOwnProperty(\"category\"))return;if(!S.hasOwnProperty(\"label\"))for(s in S.label={},S.index)S.label[s]=s;for(s in S.index)z[S.index[s]]=s;this.__tree__=l,this.label=l.label||null,this.note=l.note||null,this.link=l.link||null,this.href=l.href||null,this.id=z,this.length=z.length,this.role=i.role,this.hierarchy=S.hasOwnProperty(\"child\"),this.extension=l.extension||null;break;case\"category\":var C=i.child;this.id=C,this.length=null===C?0:C.length,this.index=i.index,this.label=i.label,this.note=i.note||null,this.unit=i.unit,this.coordinates=i.coord;break;case\"collection\":if(this.length=0,this.label=i.label||null,this.note=i.note||null,this.link=i.link||null,this.href=i.href||null,this.updated=i.updated||null,this.source=i.source||null,this.extension=i.extension||null,null!==this.link&&i.link.item){var I=i.link.item;if(this.length=Array.isArray(I)?I.length:0,this.length)for(a=0;a<this.length;a++)this.id[a]=I[a].href}}}function e(t){return\"[object ArrayBuffer]\"===Object.prototype.toString.call(t.buffer)}function n(t){return-1!==[\"Int8Array\",\"Uint8Array\",\"Uint8ClampedArray\",\"Int16Array\",\"Uint16Array\",\"Int32Array\",\"Uint32Array\",\"Float32Array\",\"Float64Array\",\"BigInt64Array\",\"BigUint64Array\"].indexOf(t)}function i(t){if(!t.ok)throw new Error(t.status+\" \"+t.statusText);return t.json()}function r(e,n,r){var l=\"object\"==typeof n?n:null;return\"function\"!=typeof r&&(r=null),r||\"function\"!=typeof n||(r=n),\"object\"==typeof e?new t(e,r):\"version\"===e?\"1.6.0\":fetch?fetch(e,l).then(i).then((function(e){return new t(e,r)})):void 0}t.prototype.Item=function(t){if(null===this||\"collection\"!==this.class||!this.length)return null;if(\"number\"==typeof t)return t>this.length||t<0?null:this.link.item[t];var e,n=[];if(\"object\"==typeof t){if(!t.class&&!t.follow)return null;t.class&&(e=\"dataset\"===t.class&&\"boolean\"==typeof t.embedded?!0===t.embedded?function(t,e,i){var r=t.link.item[e];i.class===r.class&&r.id&&r.size&&r.dimension&&n.push(r)}:function(t,e,i){var r=t.link.item[e];i.class!==r.class||r.id&&r.size&&r.dimension||n.push(r)}:function(t,e,i){i.class===t.link.item[e].class&&n.push(t.link.item[e])})}else e=function(t,e){n.push(t.link.item[e])};for(var i=0;i<this.length;i++)e(this,i,t);return n},t.prototype.Dataset=function(e){if(null===this)return null;if(\"dataset\"===this.class)return void 0!==e?this:[this];var n,i=[],r=0;if(\"collection\"===this.class){var l=this.Item({class:\"dataset\",embedded:!0});if(void 0===e){for(n=l.length;r<n;r++)i.push(new t(l[r]));return i}if(\"number\"==typeof e&&e>=0&&e<l.length)return new t(l[e]);if(\"string\"==typeof e)for(n=l.length;r<n;r++)if(l[r].href===e)return new t(l[r]);return null}if(\"bundle\"!==this.class)return null;if(void 0===e){for(n=this.id.length;r<n;r++)i.push(this.Dataset(this.id[r]));return i}if(\"number\"==typeof e){var s=this.id[e];return void 0!==s?this.Dataset(s):null}var o=this.__tree__[e];return void 0===o?null:new t({class:\"dataset\",__tree__:o})},t.prototype.Dimension=function(e,n){n=\"boolean\"!=typeof n||n;var i,r=[],l=this.id.length,s=function(t,e){if(null!==t)for(var n in t)for(var i=null!==t[n]?t[n].length:0;i--;)if(t[n][i]===e)return n;return null};if(null===this||\"dataset\"!==this.class)return null;if(void 0===e){for(i=0;i<l;i++)r.push(this.Dimension(this.id[i]));return r}if(\"number\"==typeof e){var o=this.id[e];return void 0!==o?this.Dimension(o,n):null}var a=this.role;if(\"object\"==typeof e){if(e.hasOwnProperty(\"role\")){for(i=0;i<l;i++){var u=this.id[i];s(a,u)===e.role&&r.push(this.Dimension(u,n))}return void 0===r[0]?null:r}return null}var h=this.__tree__.dimension;if(void 0===h)return null;var f=h[e];return void 0===f?null:n?new t({class:\"dimension\",__tree__:f,role:s(a,e)}):function(t,e){var n=[];for(var i in t)n[t[i]]=e[i];return n}(f.category.index,f.category.label)},t.prototype.Category=function(e){if(null===this||\"dimension\"!==this.class)return null;if(void 0===e){for(var n=[],i=0,r=this.id.length;i<r;i++)n.push(this.Category(this.id[i]));return n}if(\"number\"==typeof e){var l=this.id[e];return void 0!==l?this.Category(l):null}var s=this.__tree__.category;if(void 0===s)return null;var o=s.index[e];if(void 0===o)return null;var a=s.unit&&s.unit[e]||null,u=s.coordinates&&s.coordinates[e]||null,h=s.child&&s.child[e]||null,f=s.note&&s.note[e]||null;return new t({class:\"category\",index:o,label:s.label[e],note:f,child:h,unit:a,coord:u})},t.prototype.Dice=function(n,i,r){var l,s,o,a,u=function(t,e){return t.hasOwnProperty(e)&&!!t[e]};if(null===this||\"dataset\"!==this.class||null===this.value)return null;if(\"object\"!=typeof n)return this;\"object\"!=typeof i?(\"boolean\"==typeof i&&!0===i&&(l=!0),\"boolean\"==typeof r&&!0===r||(r=!1)):(l=u(i,\"clone\"),r=u(i,\"drop\"),s=u(i,\"stringify\"),o=u(i,\"ovalue\"),a=u(i,\"ostatus\"));var h,f=this.value,c=l?new t(JSON.parse(JSON.stringify(this))):this,d=c.status,v=[],y=[],p=function(t,e){var n,i,r,l=(n=t,i=e,r={},Array.isArray(n[i])?(n[i].forEach((function(t,e){null!==t&&(r[String(e)]=t)})),r):n[i]);delete t[e],t[e]=l};Array.isArray(n)&&(n=function(t){var e={};return t.forEach((function(t){e[t[0]]=t[1]})),e}(n)),null===n&&(n={});var g=Object.keys(n);return g.length>0&&(g.forEach((function(t){var e=n[t];Array.isArray(e)||(n[t]=[e]),0===n[t].length&&delete n[t]})),r&&(n=function(t){var e={};return Object.keys(t).forEach((function(n){e[n]=c.Dimension(n).id.filter((function(e){return-1===t[n].indexOf(e)}))})),e}(n)),c.toTable({type:\"arrobj\",content:\"id\",status:!0}).forEach((function(t,e){var i=[];g.forEach((function(e){var r=n[e],l=[];r.forEach((function(n){l.push(t[e]===n)})),i.push(-1!==l.indexOf(!0))})),-1===i.indexOf(!1)&&(v.push(t.value),y.push(t.status))})),g.forEach((function(t){var e=c.Dimension(t).id,i=0,r={};c.size[c.id.indexOf(t)]=n[t].length,e.forEach((function(e){-1!==n[t].indexOf(e)&&(r[e]=i,i++)})),c.__tree__.dimension[t].category.index=r})),c.n=v.length,c.value=c.__tree__.value=e(f)?function(t,e){return e.from(t)}(v,f.constructor):v,c.status=c.__tree__.status=null!==d?y:null),s?((h=c.__tree__).hasOwnProperty(\"id\")||(h.version=\"2.0\",h.hasOwnProperty(\"class\")||(h.class=\"dataset\"),h.id=h.dimension.id,h.size=h.dimension.size,delete h.dimension.id,delete h.dimension.size,h.dimension.hasOwnProperty(\"role\")&&(h.role=h.dimension.role,delete h.dimension.role)),h.hasOwnProperty(\"status\")&&-1!==[\"null\",\"{}\",\"[]\"].indexOf(JSON.stringify(h.status))&&delete h.status,h.hasOwnProperty(\"role\")&&(delete h.role.classification,[\"geo\",\"time\",\"metric\"].forEach((function(t){null===h.role[t]&&delete h.role[t]}))),o&&p(h,\"value\"),a&&h.hasOwnProperty(\"status\")&&p(h,\"status\"),JSON.stringify(h)):c},t.prototype.Slice=function(t){if(null===this||\"dataset\"!==this.class||0===Object.entries(this.value).length)return null;if(void 0===t)return this;if(!Array.isArray(t)){var e,n=[];for(e in t)n.push([e,t[e]]);t=n}return this.Dice(t.map((function(t){return[t[0],[t[1]]]})))},t.prototype.Data=function(t,e){var n,i,r=[],l=function(t){for(var e in t)if(t.hasOwnProperty(e))return e};if(null===this||\"dataset\"!==this.class||null===this.value)return null;if(void 0===t){for(i=this.value.length,n=0;n<i;n++)r.push(this.Data(n));return r}if(\"boolean\"!=typeof e&&(e=!0),\"number\"==typeof t){var s=this.value[t];return void 0===s?null:e?{value:s,status:this.status?this.status[t]:null}:s}var o=\"object\",a=this.__tree__,u=a.size||a.dimension&&a.dimension.size,h=u.length;if(Array.isArray(t)){if(!Array.isArray(t[0])){if(this.length!==t.length)return null;var f=1,c=0,d=[],v=[];for(n=0;n<h;n++)if(void 0!==t[n]){if(\"number\"!=typeof t[n]||t[n]>=u[n])return null;c+=(f*=n>0?u[h-n]:1)*t[h-n-1]}else d.push(n),v.push(u[n]);if(d.length>1)return null;if(1===d.length){for(var y=0,p=v[0];y<p;y++){var g=[];for(n=0;n<h;n++)n!==d[0]?g.push(t[n]):g.push(y);r.push(this.Data(g,e))}return r}return e?{value:this.value[c],status:this.status?this.status[c]:null}:this.value[c]}o=\"array\"}var b=function(t,e,n){var i,r=[],s={},o=t.dimension,a=t.id||o.id,u=t.size||o&&o.size;if(\"array\"===n){for(i=e.length;i--;)s[e[i][0]]=e[i][1];e=s}for(var h=0,f=a.length;h<f;h++){var c=a[h],d=e[c];r.push(\"string\"==typeof d?d:1===u[h]?l(o[c].category.index):null)}return r}(a,t,o),m=[],_=a.dimension,x=a.id||_.id;for(n=0,i=b.length;n<i;n++)m.push(_[x[n]].category.index[b[n]]);return this.Data(m,e)},t.prototype.toTable=function(t,e){if(null===this||\"dataset\"!==this.class||null===this.value)return null;1==arguments.length&&\"function\"==typeof t&&(e=t,t=null),\"arrobj\"!==(t=t||{field:\"label\",content:\"label\",vlabel:\"Value\",slabel:\"Status\",type:\"array\",status:!1,unit:!1,by:null,prefix:\"\",drop:[],meta:!1,comma:!1,bylabel:!1}).type&&\"objarr\"!==t.type||void 0!==t.field||(t.field=\"id\");var i,r,l,s,o,a,u,h,f,c=\"id\"===t.field,d=function(t){return(c?\"value\":t)||\"Value\"},v=function(t){return(c?\"status\":t)||\"Status\"},y=this.__tree__,p=!0===t.status;if(\"function\"==typeof e){i=this.toTable(t);var g=[],b=\"array\"!==t.type?0:1;for(o=(V=\"object\"!==t.type?i.slice(b):i.rows.slice(0)).length,r=0;r<o;r++){var m=e.call(this,V[r],r);void 0!==m&&g.push(m)}return\"object\"===t.type?{cols:i.cols,rows:g}:(\"array\"===t.type&&g.unshift(i[0]),g)}if(\"arrobj\"===t.type||\"objarr\"===t.type){var _=[],x=y.role&&y.role.metric,O=function(){},A={},w=this,j=w.id,k=t.by&&-1!==j.indexOf(t.by)?t.by:null,D=!0===t.meta,P=void 0!==t.drop&&Array.isArray(t.drop)?t.drop:[],E=!0===t.comma,z=!0===t.bylabel,S=w.value.constructor,C=function(e){var i,r={},l=d(t.vlabel);if(\"objarr\"===t.type&&(i=null===k&&n(S.name)?function(t){r[t]=t===l?S.from(e,(function(e){return e[t]})):e.map((function(e){return e[t]}))}:function(t){r[t]=e.map((function(e){return e[t]}))},Object.keys(e[0]).forEach(i),e=r),D){r={};return j.forEach((function(t){var e=w.Dimension(t);r[t]={label:e.label,role:e.role,categories:{id:e.id,label:w.Dimension(t,!1)}}})),{meta:{label:w.label,source:w.source,updated:w.updated,id:j,status:p,unit:t.unit,by:k,bylabel:z,drop:null!==k&&P.length>0?P:null,prefix:null!==k?q||\"\":null,comma:E,dimensions:r},data:e}}return e};k&&(t.field=\"id\");var I=(i=this.toTable({field:t.field,vlabel:t.vlabel,slabel:t.slabel,content:t.content,status:p})).shift();if(null===k&&t.unit&&x){if(\"id\"!==t.content)for(var U=x.length;U--;){var T=this.Dimension(x[U]);A[x[U]]={};for(var J=T.length;J--;)A[x[U]][T.Category(J).label]=T.id[J]}O=function(e,n){if(-1!==x.indexOf(e)){var i=y.dimension[e].category;i.unit?N.unit=i.unit[\"id\"!==t.content?A[e][n]:n]:N.unit=null}},t.unit=!0}else t.unit=!1;for(o=i.length,r=0;r<o;r++){var N={};for(l=i[r].length;l--;)N[I[l]]=i[r][l],O(I[l],i[r][l]);_.push(N)}if(E&&_.forEach((function(t){null!==t.value&&(t.value=(\"\"+t.value).replace(\".\",\",\"))})),null!==k){var B,F={},V=[],M={},q=void 0!==t.prefix?t.prefix:\"\";P.forEach((function(t,e){(!w.Dimension(t)||w.Dimension(t).length>1)&&(P[e]=\"\")}));var G=j.filter((function(t){return t!==k&&-1===P.indexOf(t)})),H=w.Dimension(k);for(var K in\"id\"!==t.content?z?B=function(t,e,n){t[e][q+n[k]]=n.value}:(H.Category().forEach((function(t,e){M[t.label]=H.id[e]})),B=function(t,e,n){t[e][q+M[n[k]]]=n.value}):B=function(t,e,n){t[e][q+n[k]]=n.value},_.forEach((function(t){var e=function(t,e){var n=[];return e.forEach((function(e){n.push(t[e])})),n.join(\"\\t\")}(t,G);void 0===F[e]&&(F[e]=function(t,e){var n={};return e.forEach((function(e){n[e]=t[e]})),n}(t,G)),B(F,e,t,k)})),F)V.push(F[K]);return p=!1,C(V)}return C(_)}if(\"object\"===t.type){var L=\"number\"==typeof this.value[0]||null===this.value[0]?\"number\":\"string\";a=function(t,e){var n=c&&t||e||t;it.push({id:t,label:n,type:\"string\"})},u=function(t,e,n){var i=d(t),r=v(e);n&&it.push({id:\"status\",label:r,type:\"string\"}),it.push({id:\"value\",label:i,type:L})},h=function(t){yt.push({v:t})},f=function(t){yt.push({v:t}),rt.push({c:yt})}}else a=function(t,e){var n=c&&t||e||t;it.push(n)},u=function(t,e,n){var i=d(t),r=v(e);n&&it.push(r),it.push(i),nt.push(it)},h=function(t){yt.push(t)},f=function(t){yt.push(t),nt.push(yt)};var Q=y.dimension,R=y.id||Q.id,W=y.size||Q.size,X=R.length;if(X!=W.length)return!1;var Y=[],Z=1,$=(U=1,[]),tt=[],et=[],nt=[],it=[],rt=[];for(r=0;r<X;r++){var lt=R[r];a(lt,Q[lt].label),Z*=W[r],U*=W[r];var st=[];for(l=0;l<W[r];l++)for(var ot in Q[R[r]].category.index)if(Q[R[r]].category.index[ot]===l){var at=\"id\"!==t.content&&Q[R[r]].category.label?Q[R[r]].category.label[ot]:ot;st.push(at)}Y.push(st),$.push(U)}for(u(t.vlabel,t.slabel,p),o=Y.length,r=0;r<o;r++){for(var ut=[],ht=0,ft=Y[r].length;ht<ft;ht++)for(var ct=0;ct<Z/$[r];ct++)ut.push(Y[r][ht]);tt.push(ut)}for(o=tt.length,r=0;r<o;r++){var dt=[],vt=0;for(s=0;s<Z;s++)dt.push(tt[r][vt]),++vt===tt[r].length&&(vt=0);et.push(dt)}for(s=0;s<Z;s++){var yt=[];o=tt.length;for(var pt=0;pt<o;pt++)h(et[pt][s]);p&&h(this.status?this.status[s]:null),f(this.value[s])}return\"object\"===t.type?{cols:it,rows:rt}:nt},t.prototype.node=function(){return this.__tree__},t.prototype.toString=function(){return this.class},t.prototype.Unflatten=function(t){if(null===this||\"dataset\"!==this.class||null===this.value||\"function\"!=typeof t)return null;const e=this.id,n=this.size,i=[];for(let r=0;r<this.n;r++){const l=this.Data(r),s={};let o=r;for(let t=e.length-1;t>=0;t--){const e=this.Dimension(t),i=this.id[t],r=n[t],l=o%r;e.Category(l);const a=e.id[l];o=Math.floor(o/r),s[i]=a}const a=t(s,l,r,i);void 0!==a&&i.push(a)}return i};export{r as default};\n","import { json, csv } from 'd3-fetch'\r\nimport { getEstatDataURL } from './utils'\r\nimport JSONstat from 'jsonstat-toolkit'\r\nimport { csvToIndex, jsonstatToIndex } from './utils'\r\n\r\n/**\r\n * A statistical dataset, to be used for a statistical map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const statData = function (config) {\r\n    //build stat data object\r\n    const out = {}\r\n\r\n    out.__data = undefined //for debugging\r\n\r\n    //out.maxNumberOfDecimalsInDataset = undefined\r\n\r\n    /**\r\n     * The statistical values, indexed by NUTS id.\r\n     * Each stat value is an object {value,status}.\r\n     */\r\n    out._data_ = undefined\r\n\r\n    /**\r\n     * Return the stat value {value,status} from a nuts id.\r\n     * If no argument is specified, returns the entire index.\r\n     * @param {*} nutsId\r\n     */\r\n    out.get = (nutsId) => {\r\n        if (!nutsId) {\r\n            return out._data_\r\n        } else {\r\n            if (out._data_) {\r\n                return out._data_[nutsId]\r\n            } else {\r\n                return undefined\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return the stat value from a nuts id.\r\n     * @param {*} nutsId\r\n     */\r\n    out.getValue = (nutsId) => {\r\n        const s = out.get(nutsId)\r\n        return s ? s.value : undefined\r\n    }\r\n\r\n    /**\r\n     * Set a stat value from a nuts id.\r\n     *\r\n     * @param {String} nutsId\r\n     * @param {Object || String || Number} stat The new statistical data. The format can be either {value:34.324,status:\"e\"} or a the value only.\r\n     */\r\n    out.set = (nutsId, stat) => {\r\n        out._data_ = out._data_ || {}\r\n        const s = out._data_[nutsId]\r\n\r\n        if (s) {\r\n            if (stat.value) {\r\n                s.value = stat.value\r\n                s.status = stat.status\r\n            } else {\r\n                // be careful here setting values here, we need to maintain strings with trailing zeros because in JSON 1.0 === 1 and they are removed. User might want stats labels with trailing zeros.\r\n                s.value = stat\r\n                //s.value = isNaN(+stat) ? stat : +stat\r\n            }\r\n        } else {\r\n            // be careful here setting values here, we need to maintain strings with trailing zeros because in JSON 1.0 === 1 and they are removed. User might want stats labels with trailing zeros.\r\n            out._data_[nutsId] = stat.value ? stat : { value: stat }\r\n            //out._data_[nutsId] = stat.value ? stat : { value: isNaN(+stat) ? stat : +stat}\r\n        }\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Set statistical data, already indexed by nutsId.\r\n     *\r\n     * @param {Object} data Something like: { \"PT\":0.2, \"LU\":0.6, ...}, or with status: { \"PT\": {value:0.2, status:\"e\"}, \"LU\":0.6, ...}\r\n     */\r\n    out.setData = (data) => {\r\n        out.__data = data // for debugging\r\n        out._data_ = {} // overwrite existing data\r\n        Object.keys(data).forEach((nutsId) => out.set(nutsId, data[nutsId]))\r\n        return out\r\n    }\r\n\r\n    //eg for sparklines\r\n    out.setManualMultiDate = function (dataObject) {\r\n        out._data_ = out._data_ || {}\r\n\r\n        for (const regionId in dataObject) {\r\n            const dateValueMap = dataObject[regionId]\r\n            out._data_[regionId] = {}\r\n\r\n            for (const date in dateValueMap) {\r\n                const value = dateValueMap[date]\r\n                out._data_[regionId][date] = { value: value }\r\n            }\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    out.hasData = function () {\r\n        return out._data_ != undefined && Object.keys(out._data_).length > 0\r\n    }\r\n\r\n    out.hasNumericData = function () {\r\n        if (!out._data_) return false\r\n\r\n        return Object.values(out._data_).some((d) => Number.isFinite(+d.value))\r\n    }\r\n\r\n    /** Return all stat values as an array. This can be used to classify the values. */\r\n    out.getArray = function () {\r\n        if (out.hasData()) {\r\n            return Object.values(out._data_)\r\n                .map((s) => s.value)\r\n                .filter((s) => s == 0 || s)\r\n        }\r\n    }\r\n\r\n    /** Return stat unique values. This can be used for categorical maps. */\r\n    out.getUniqueValues = function () {\r\n        if (out.hasData()) {\r\n            return Object.values(out._data_)\r\n                .map((s) => s.value)\r\n                .filter((item, i, ar) => ar.indexOf(item) === i)\r\n        }\r\n    }\r\n    /** Get min value. */\r\n    out.getMin = function () {\r\n        if (out.hasNumericData()) {\r\n            return Object.values(out._data_)\r\n                .map((s) => s.value)\r\n                .filter((s) => s == 0 || (s && s !== ':'))\r\n                .reduce((acc, v) => Math.min(acc, v))\r\n        }\r\n    }\r\n    /** Get max value. */\r\n    out.getMax = function () {\r\n        if (out.hasNumericData()) {\r\n            return Object.values(out._data_)\r\n                .map((s) => s.value)\r\n                .filter((s) => s == 0 || (s && s !== ':'))\r\n                .reduce((acc, v) => Math.max(acc, v))\r\n        }\r\n    }\r\n    /** Get max value region. */\r\n    out.getMaxRegionId = function () {\r\n        if (out.hasNumericData()) {\r\n            let maxVal = -Infinity\r\n            let maxRegion = null\r\n            for (const regionId in out._data_) {\r\n                const s = out._data_[regionId]\r\n                const val = s.value\r\n                if (val != null && val !== ':' && val > maxVal) {\r\n                    maxVal = val\r\n                    maxRegion = regionId\r\n                }\r\n            }\r\n            return maxRegion\r\n        }\r\n    }\r\n    /** Get min value region. */\r\n    out.getMinRegionId = function () {\r\n        if (out.hasNumericData()) {\r\n            let minVal = Infinity\r\n            let minRegion = null\r\n            for (const regionId in out._data_) {\r\n                const s = out._data_[regionId]\r\n                const val = s.value\r\n                if (val != null && val !== ':' && val < minVal) {\r\n                    minVal = val\r\n                    minRegion = regionId\r\n                }\r\n            }\r\n            return minRegion\r\n        }\r\n    }\r\n\r\n    /** Check if the stat data is ready. */\r\n    out.isReady = function () {\r\n        return out.hasData()\r\n    }\r\n\r\n    /** Some metadata */\r\n    out.metadata = undefined\r\n\r\n    //a text for the statitics unit of measure, to be shown in the tooltip\r\n    out.unitText_ = undefined\r\n\r\n    /**\r\n     * Retrieve stat data from remote data sources.\r\n     *\r\n     * @param {*} nutsLevel\r\n     * @param {*} callback\r\n     */\r\n    out.retrieveFromRemote = function (nutsLevel, lang, callback) {\r\n        if (out.eurostatDatasetCode_) updateEurobase(nutsLevel, lang, callback)\r\n        else if (out.csvURL_) updateCSV(callback)\r\n        return out\r\n    }\r\n\r\n    //TODO decompose into Eurobase/jsonstat and CSV types ?\r\n\r\n    /**\r\n     * Eurobase/jsonstat data source\r\n     * See https://ec.europa.eu/eurostat/web/json-and-unicode-web-services/getting-started/rest-request\r\n     */\r\n\r\n    /** The Eurobase dataset code */\r\n    out.eurostatDatasetCode_ = undefined\r\n    /** The Eurobase code */\r\n    out.filters_ = { lastTimePeriod: 1 }\r\n    /** The precision (number of decimal places) */\r\n    out.precision_ = 2\r\n    /** Dataset label/name */\r\n    out.label_ = undefined\r\n\r\n    /**\r\n     * Return promise for Eurobase/jsonstat data.\r\n     */\r\n    const getEurobasePromise = function (nutsLevel, lang) {\r\n        //set precision //DEPRECATED 16/11/2021 https://ec.europa.eu/eurostat/online-help/public/en/NAVIGATION_WDDSTranslator_migration_en/#DECOMMISSION\r\n        //out.filters_[\"precision\"] = out.precision_;\r\n        //select only required geo groups, depending on the specified nuts level\r\n        if (!out.filters_.geo) {\r\n            out.filters_['geoLevel'] = nutsLevel + '' === '0' ? 'country' : 'nuts' + nutsLevel\r\n        }\r\n\r\n        //force filtering of euro-geo-aggregates\r\n        //out.filters_[\"filterNonGeo\"] = 1; //DEPRECATED 16/11/2021\r\n\r\n        //retrieve stat data from Eurostat API\r\n        return json(getEstatDataURL(out.eurostatDatasetCode_, out.filters_, lang))\r\n    }\r\n\r\n    //for eurobase statistical data to retrieve from Eurostat API\r\n    const updateEurobase = function (nutsLevel, lang, callback) {\r\n        //erase previous data\r\n        out._data_ = null\r\n\r\n        getEurobasePromise(nutsLevel, lang).then(function (data___) {\r\n            if (data___.error) return console.error('Error retrieving Eurostat data: ' + data___.error[0]?.label)\r\n            //decode stat data\r\n            const jsd = JSONstat(data___)\r\n\r\n            //store jsonstat metadata\r\n            out.metadata = {\r\n                label: jsd.label,\r\n                href: jsd.href,\r\n                source: jsd.source,\r\n                updated: jsd.updated,\r\n                extension: jsd.extension,\r\n            }\r\n            out.metadata.time = jsd.Dimension('time').id[0]\r\n\r\n            //index\r\n            out._data_ = jsonstatToIndex(jsd)\r\n            //TODO: use maybe https://github.com/badosa/JSON-stat/blob/master/utils/fromtable.md to build directly an index ?\r\n\r\n            // #172 when using jsonstat-toolkit, values of null mean 'no data' and are converted to \":\"\r\n            Object.keys(out._data_).forEach((k) => {\r\n                if (out._data_[k].value === null) out._data_[k].value = ':'\r\n            })\r\n\r\n            if (callback) callback()\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Return the time stamp of the jsonstat dataset.\r\n     */\r\n    out.getTime = function () {\r\n        const t = out.filters_.time\r\n        if (t) return t\r\n        if (!out._data_) return\r\n        return out.metadata.time\r\n    }\r\n\r\n    /**\r\n     * CSV data source\r\n     */\r\n\r\n    /** The CSV file URL */\r\n    out.csvURL_ = undefined\r\n    /** The CSV column with the NUTS ids */\r\n    out.geoCol_ = 'geo'\r\n    /** The CSV column with the statistical values */\r\n    out.valueCol_ = 'value'\r\n\r\n    /**\r\n     * Return promise for CSV data.\r\n     */\r\n    const getCSVPromise = function (nutsLevel) {\r\n        return csv(out.csvURL_)\r\n    }\r\n\r\n    //for statistical data to retrieve from CSV file\r\n    const updateCSV = function (callback) {\r\n        //erase previous data\r\n        out._data_ = null\r\n\r\n        //retrieve csv data\r\n        getCSVPromise().then(function (data___) {\r\n            //decode stat data\r\n            out._data_ = csvToIndex(data___, out.geoCol_, out.valueCol_)\r\n\r\n            //store some metadata\r\n            out.metadata = { href: out.csvURL_ }\r\n\r\n            if (callback) callback()\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    ;['unitText_'].forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) for (let key in config) out[key + '_'] = config[key]\r\n\r\n    return out\r\n}\r\n","import { executeForAllInsets, getLegendRegionsSelector } from '../core/utils'\r\nimport { select } from 'd3-selection'\r\n\r\nexport function appendPatternFillLegend(out, container) {\r\n    const map = out.map\r\n    const offsetY = 15 // offset for the pattern fill legend\r\n\r\n    if (!map.patternFill_) return\r\n\r\n    map.patternFill_.forEach((cfg, index) => {\r\n        if (!cfg.legendLabel) return // skip if no label\r\n\r\n        const y = index * out.shapeHeight + index * out.shapePadding + offsetY\r\n\r\n        const item = container.append('g').attr('class', 'em-legend-item em-pattern-legend-item')\r\n\r\n        const patternColor = cfg.color || '#000' // fallback to black if no color provided\r\n        const isWhitePattern = patternColor.toLowerCase() === '#fff' || patternColor.toLowerCase() === 'white'\r\n\r\n        // Add background if pattern is white\r\n        if (isWhitePattern) {\r\n            item.append('rect').attr('x', 0).attr('y', y).attr('width', out.shapeWidth).attr('height', out.shapeHeight).attr('fill', '#ddd') // light gray background\r\n        }\r\n\r\n        // Add pattern overlay\r\n        item.append('rect')\r\n            .attr('class', 'em-legend-rect')\r\n            .attr('x', 0)\r\n            .attr('y', y)\r\n            .attr('width', out.shapeWidth)\r\n            .attr('height', out.shapeHeight)\r\n            .attr('fill', `url(#${cfg.patternId || cfg.pattern})`)\r\n            .on('mouseover', function () {\r\n                highlightPatternFillRegions(map, cfg.patternId || cfg.pattern)\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, highlightPatternFillRegions, cfg.patternId || cfg.pattern)\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightPatternFillRegions(map)\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, unhighlightPatternFillRegions)\r\n                }\r\n            })\r\n\r\n        // Add label\r\n        item.append('text')\r\n            .attr('class', 'em-legend-label')\r\n            .attr('x', out.shapeWidth + out.labelOffsets.x)\r\n            .attr('y', y + out.shapeHeight / 2)\r\n            .attr('dominant-baseline', 'middle')\r\n            .attr('dy', '0.35em') // ~vertical centering\r\n            .text(cfg.legendLabel)\r\n    })\r\n}\r\n\r\n// Highlight selected regions on mouseover\r\nfunction highlightPatternFillRegions(map, patternId) {\r\n    const targetFill = `url(#${patternId})`\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Set all regions (except overlays) to white\r\n    allRegions\r\n        .filter(function () {\r\n            return !select(this).classed('pattern-fill-overlay')\r\n        })\r\n        .style('fill', 'white')\r\n\r\n    // Dim all overlays\r\n    map.svg_.selectAll('.pattern-fill-overlay').style('opacity', 0) //.style('fill', 'unset')\r\n\r\n    // Brighten only overlays with matching pattern fill\r\n    map.svg_\r\n        .selectAll('.pattern-fill-overlay')\r\n        .filter(function () {\r\n            return select(this).attr('fill') === targetFill\r\n        })\r\n        .style('opacity', 1)\r\n    //.style('fill', 'red')\r\n}\r\n\r\nfunction unhighlightPatternFillRegions(map) {\r\n    map.svg_.selectAll('.pattern-fill-overlay').style('opacity', 1) //.style('fill', 'unset')\r\n\r\n    // Restore base region fills\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    allRegions\r\n        .filter(function () {\r\n            return !select(this).classed('pattern-fill-overlay')\r\n        })\r\n        .each(function () {\r\n            select(this).style('fill', select(this).attr('fill___'))\r\n        })\r\n}\r\n","export class InternMap extends Map {\n  constructor(entries, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (entries != null) for (const [key, value] of entries) this.set(key, value);\n  }\n  get(key) {\n    return super.get(intern_get(this, key));\n  }\n  has(key) {\n    return super.has(intern_get(this, key));\n  }\n  set(key, value) {\n    return super.set(intern_set(this, key), value);\n  }\n  delete(key) {\n    return super.delete(intern_delete(this, key));\n  }\n}\n\nexport class InternSet extends Set {\n  constructor(values, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (values != null) for (const value of values) this.add(value);\n  }\n  has(value) {\n    return super.has(intern_get(this, value));\n  }\n  add(value) {\n    return super.add(intern_set(this, value));\n  }\n  delete(value) {\n    return super.delete(intern_delete(this, value));\n  }\n}\n\nfunction intern_get({_intern, _key}, value) {\n  const key = _key(value);\n  return _intern.has(key) ? _intern.get(key) : value;\n}\n\nfunction intern_set({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) return _intern.get(key);\n  _intern.set(key, value);\n  return value;\n}\n\nfunction intern_delete({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) {\n    value = _intern.get(key);\n    _intern.delete(key);\n  }\n  return value;\n}\n\nfunction keyof(value) {\n  return value !== null && typeof value === \"object\" ? value.valueOf() : value;\n}\n","import {InternMap} from \"d3-array\";\nimport {initRange} from \"./init.js\";\n\nexport const implicit = Symbol(\"implicit\");\n\nexport default function ordinal() {\n  var index = new InternMap(),\n      domain = [],\n      range = [],\n      unknown = implicit;\n\n  function scale(d) {\n    let i = index.get(d);\n    if (i === undefined) {\n      if (unknown !== implicit) return unknown;\n      index.set(d, i = domain.push(d) - 1);\n    }\n    return range[i % range.length];\n  }\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [], index = new InternMap();\n    for (const value of _) {\n      if (index.has(value)) continue;\n      index.set(value, domain.push(value) - 1);\n    }\n    return scale;\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), scale) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return ordinal(domain, range).unknown(unknown);\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n","import {range as sequence} from \"d3-array\";\nimport {initRange} from \"./init.js\";\nimport ordinal from \"./ordinal.js\";\n\nexport default function band() {\n  var scale = ordinal().unknown(undefined),\n      domain = scale.domain,\n      ordinalRange = scale.range,\n      r0 = 0,\n      r1 = 1,\n      step,\n      bandwidth,\n      round = false,\n      paddingInner = 0,\n      paddingOuter = 0,\n      align = 0.5;\n\n  delete scale.unknown;\n\n  function rescale() {\n    var n = domain().length,\n        reverse = r1 < r0,\n        start = reverse ? r1 : r0,\n        stop = reverse ? r0 : r1;\n    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);\n    if (round) step = Math.floor(step);\n    start += (stop - start - step * (n - paddingInner)) * align;\n    bandwidth = step * (1 - paddingInner);\n    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);\n    var values = sequence(n).map(function(i) { return start + step * i; });\n    return ordinalRange(reverse ? values.reverse() : values);\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? ([r0, r1] = _, r0 = +r0, r1 = +r1, rescale()) : [r0, r1];\n  };\n\n  scale.rangeRound = function(_) {\n    return [r0, r1] = _, r0 = +r0, r1 = +r1, round = true, rescale();\n  };\n\n  scale.bandwidth = function() {\n    return bandwidth;\n  };\n\n  scale.step = function() {\n    return step;\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, rescale()) : round;\n  };\n\n  scale.padding = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;\n  };\n\n  scale.paddingInner = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;\n  };\n\n  scale.paddingOuter = function(_) {\n    return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;\n  };\n\n  scale.align = function(_) {\n    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;\n  };\n\n  scale.copy = function() {\n    return band(domain(), [r0, r1])\n        .round(round)\n        .paddingInner(paddingInner)\n        .paddingOuter(paddingOuter)\n        .align(align);\n  };\n\n  return initRange.apply(rescale(), arguments);\n}\n\nfunction pointish(scale) {\n  var copy = scale.copy;\n\n  scale.padding = scale.paddingOuter;\n  delete scale.paddingInner;\n  delete scale.paddingOuter;\n\n  scale.copy = function() {\n    return pointish(copy());\n  };\n\n  return scale;\n}\n\nexport function point() {\n  return pointish(band.apply(null, arguments).paddingInner(1));\n}\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity.js\";\n\nvar top = 1,\n    right = 2,\n    bottom = 3,\n    left = 4,\n    epsilon = 1e-6;\n\nfunction translateX(x) {\n  return \"translate(\" + x + \",0)\";\n}\n\nfunction translateY(y) {\n  return \"translate(0,\" + y + \")\";\n}\n\nfunction number(scale) {\n  return d => +scale(d);\n}\n\nfunction center(scale, offset) {\n  offset = Math.max(0, scale.bandwidth() - offset * 2) / 2;\n  if (scale.round()) offset = Math.round(offset);\n  return d => +scale(d) + offset;\n}\n\nfunction entering() {\n  return !this.__axis;\n}\n\nfunction axis(orient, scale) {\n  var tickArguments = [],\n      tickValues = null,\n      tickFormat = null,\n      tickSizeInner = 6,\n      tickSizeOuter = 6,\n      tickPadding = 3,\n      offset = typeof window !== \"undefined\" && window.devicePixelRatio > 1 ? 0 : 0.5,\n      k = orient === top || orient === left ? -1 : 1,\n      x = orient === left || orient === right ? \"x\" : \"y\",\n      transform = orient === top || orient === bottom ? translateX : translateY;\n\n  function axis(context) {\n    var values = tickValues == null ? (scale.ticks ? scale.ticks.apply(scale, tickArguments) : scale.domain()) : tickValues,\n        format = tickFormat == null ? (scale.tickFormat ? scale.tickFormat.apply(scale, tickArguments) : identity) : tickFormat,\n        spacing = Math.max(tickSizeInner, 0) + tickPadding,\n        range = scale.range(),\n        range0 = +range[0] + offset,\n        range1 = +range[range.length - 1] + offset,\n        position = (scale.bandwidth ? center : number)(scale.copy(), offset),\n        selection = context.selection ? context.selection() : context,\n        path = selection.selectAll(\".domain\").data([null]),\n        tick = selection.selectAll(\".tick\").data(values, scale).order(),\n        tickExit = tick.exit(),\n        tickEnter = tick.enter().append(\"g\").attr(\"class\", \"tick\"),\n        line = tick.select(\"line\"),\n        text = tick.select(\"text\");\n\n    path = path.merge(path.enter().insert(\"path\", \".tick\")\n        .attr(\"class\", \"domain\")\n        .attr(\"stroke\", \"currentColor\"));\n\n    tick = tick.merge(tickEnter);\n\n    line = line.merge(tickEnter.append(\"line\")\n        .attr(\"stroke\", \"currentColor\")\n        .attr(x + \"2\", k * tickSizeInner));\n\n    text = text.merge(tickEnter.append(\"text\")\n        .attr(\"fill\", \"currentColor\")\n        .attr(x, k * spacing)\n        .attr(\"dy\", orient === top ? \"0em\" : orient === bottom ? \"0.71em\" : \"0.32em\"));\n\n    if (context !== selection) {\n      path = path.transition(context);\n      tick = tick.transition(context);\n      line = line.transition(context);\n      text = text.transition(context);\n\n      tickExit = tickExit.transition(context)\n          .attr(\"opacity\", epsilon)\n          .attr(\"transform\", function(d) { return isFinite(d = position(d)) ? transform(d + offset) : this.getAttribute(\"transform\"); });\n\n      tickEnter\n          .attr(\"opacity\", epsilon)\n          .attr(\"transform\", function(d) { var p = this.parentNode.__axis; return transform((p && isFinite(p = p(d)) ? p : position(d)) + offset); });\n    }\n\n    tickExit.remove();\n\n    path\n        .attr(\"d\", orient === left || orient === right\n            ? (tickSizeOuter ? \"M\" + k * tickSizeOuter + \",\" + range0 + \"H\" + offset + \"V\" + range1 + \"H\" + k * tickSizeOuter : \"M\" + offset + \",\" + range0 + \"V\" + range1)\n            : (tickSizeOuter ? \"M\" + range0 + \",\" + k * tickSizeOuter + \"V\" + offset + \"H\" + range1 + \"V\" + k * tickSizeOuter : \"M\" + range0 + \",\" + offset + \"H\" + range1));\n\n    tick\n        .attr(\"opacity\", 1)\n        .attr(\"transform\", function(d) { return transform(position(d) + offset); });\n\n    line\n        .attr(x + \"2\", k * tickSizeInner);\n\n    text\n        .attr(x, k * spacing)\n        .text(format);\n\n    selection.filter(entering)\n        .attr(\"fill\", \"none\")\n        .attr(\"font-size\", 10)\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"text-anchor\", orient === right ? \"start\" : orient === left ? \"end\" : \"middle\");\n\n    selection\n        .each(function() { this.__axis = position; });\n  }\n\n  axis.scale = function(_) {\n    return arguments.length ? (scale = _, axis) : scale;\n  };\n\n  axis.ticks = function() {\n    return tickArguments = Array.from(arguments), axis;\n  };\n\n  axis.tickArguments = function(_) {\n    return arguments.length ? (tickArguments = _ == null ? [] : Array.from(_), axis) : tickArguments.slice();\n  };\n\n  axis.tickValues = function(_) {\n    return arguments.length ? (tickValues = _ == null ? null : Array.from(_), axis) : tickValues && tickValues.slice();\n  };\n\n  axis.tickFormat = function(_) {\n    return arguments.length ? (tickFormat = _, axis) : tickFormat;\n  };\n\n  axis.tickSize = function(_) {\n    return arguments.length ? (tickSizeInner = tickSizeOuter = +_, axis) : tickSizeInner;\n  };\n\n  axis.tickSizeInner = function(_) {\n    return arguments.length ? (tickSizeInner = +_, axis) : tickSizeInner;\n  };\n\n  axis.tickSizeOuter = function(_) {\n    return arguments.length ? (tickSizeOuter = +_, axis) : tickSizeOuter;\n  };\n\n  axis.tickPadding = function(_) {\n    return arguments.length ? (tickPadding = +_, axis) : tickPadding;\n  };\n\n  axis.offset = function(_) {\n    return arguments.length ? (offset = +_, axis) : offset;\n  };\n\n  return axis;\n}\n\nexport function axisTop(scale) {\n  return axis(top, scale);\n}\n\nexport function axisRight(scale) {\n  return axis(right, scale);\n}\n\nexport function axisBottom(scale) {\n  return axis(bottom, scale);\n}\n\nexport function axisLeft(scale) {\n  return axis(left, scale);\n}\n","import { scaleBand, scaleLinear } from 'd3-scale'\r\nimport { select } from 'd3-selection'\r\nimport { axisLeft, axisBottom } from 'd3-axis'\r\nimport { max } from 'd3-array'\r\nimport { executeForAllInsets, getFontSizeFromClass } from '../../core/utils'\r\nimport { getChoroplethLabelFormatter, getThresholds, unhighlightRegions, highlightRegions } from './legend-choropleth'\r\n\r\nexport const createHistogramLegend = (out, baseX, baseY) => {\r\n    const orientation = out.histogram.orientation || 'horizontal'\r\n    const showCounts = out.histogram.showCounts\r\n    const showPercentages = out.histogram.showPercentages\r\n    const labelRotation = out.histogram.labelRotation || 0\r\n    const margin = out.histogram.margin || { top: 0, right: 0, bottom: 0, left: 0 }\r\n    const height = out.histogram.height || 200\r\n    const width = out.histogram.width || 270\r\n    const numberOfClasses = out.getNumberOfClasses(out)\r\n    const labelFormatter = out.getLabelFormatter(out)\r\n    const colorClassifier = out.getColorClassifier(out)\r\n\r\n    const counts = new Array(numberOfClasses).fill(0)\r\n    const data = getData(out)\r\n    const colors = getColors(out)\r\n    const thresholds = getThresholds(out)\r\n\r\n    // Count class memberships\r\n    data.forEach((value) => {\r\n        const classIndex = colorClassifier(value)\r\n        if (typeof classIndex === 'number' && classIndex >= 0 && classIndex < counts.length) {\r\n            counts[classIndex]++\r\n        }\r\n    })\r\n\r\n    const total = counts.reduce((sum, d) => sum + d, 0)\r\n\r\n    const barGroup = out.lgg.append('g').attr('class', 'em-legend-histogram').attr('transform', `translate(${baseX}, ${baseY})`)\r\n\r\n    if (orientation === 'vertical') {\r\n        drawVerticalHistogram(barGroup)\r\n    } else {\r\n        drawHorizontalHistogram(barGroup)\r\n    }\r\n\r\n    function drawVerticalHistogram(barGroup) {\r\n        const reversedCounts = counts.slice().reverse()\r\n        const reversedPercentages = reversedCounts.map((d) => (total > 0 ? (d / total) * 100 : 0))\r\n        const reversedThresholds = thresholds.slice().reverse()\r\n        const yScale = scaleBand()\r\n            .domain(reversedCounts.map((_, i) => i))\r\n            .range([margin.top, height - margin.bottom])\r\n            .padding(0.1)\r\n        const xScale = scaleLinear()\r\n            .domain([0, max(reversedCounts)])\r\n            .nice()\r\n            .range([margin.left, width - margin.right])\r\n\r\n        // Bars\r\n        barGroup\r\n            .selectAll('rect')\r\n            .data(reversedCounts)\r\n            .join('rect')\r\n            .attr('class', 'em-legend-histogram-bar')\r\n            .attr('y', (_, i) => yScale(i))\r\n            .attr('x', margin.left)\r\n            .attr('height', yScale.bandwidth())\r\n            .attr('width', (d) => xScale(d) - margin.left)\r\n            .attr('fill', (_, i) => colors[colors.length - i - 1])\r\n            .attr('ecl', (_, i) => i)\r\n            .on('mouseover', handleMouseOver)\r\n            .on('mouseout', handleMouseOut)\r\n\r\n        // Bar labels\r\n        if (showCounts || showPercentages) {\r\n            barGroup\r\n                .selectAll('text.em-histogram-label')\r\n                .data(reversedCounts)\r\n                .join('text')\r\n                .attr('class', 'em-legend-label em-histogram-label')\r\n                .attr('x', (d) => xScale(d) + 5)\r\n                .attr('y', (_, i) => yScale(i) + yScale.bandwidth() / 2)\r\n                .attr('alignment-baseline', 'middle')\r\n                .text((_, i) => {\r\n                    return showPercentages ? `${reversedPercentages[i].toFixed(1)}%` : reversedCounts[i]\r\n                })\r\n        }\r\n\r\n        // Axis\r\n        // Axis (threshold boundaries, not band centers)\r\n        const axisGroup = barGroup.append('g').attr('id', 'em-legend-histogram-y-axis').attr('transform', `translate(${margin.left},0)`)\r\n\r\n        if (out.labelType === 'thresholds') {\r\n            const positions = []\r\n            for (let i = 0; i < reversedThresholds.length; i++) {\r\n                const y = yScale(i)\r\n                if (y !== undefined) {\r\n                    // Move to the *bottom* edge of each band, like a class boundary\r\n                    positions.push(y + yScale.bandwidth())\r\n                }\r\n            }\r\n\r\n            const boundaryScale = scaleLinear().domain([0, height]).range([0, height])\r\n            axisGroup.call(\r\n                axisLeft(boundaryScale)\r\n                    .tickValues(positions)\r\n                    .tickFormat((_, i) => (labelFormatter ? labelFormatter(reversedThresholds[i], i) : reversedThresholds[i]))\r\n                    .tickSize(4)\r\n                    .tickSizeOuter(0)\r\n            )\r\n        } else if (out.labelType === 'ranges') {\r\n            axisGroup.call(\r\n                axisLeft(yScale)\r\n                    .tickSizeOuter(0)\r\n                    .tickSize(0)\r\n                    .tickFormat((_, i) => (labelFormatter ? labelFormatter(reversedThresholds[i], i) : reversedThresholds[i]))\r\n            )\r\n        }\r\n\r\n        axisGroup.selectAll('text').attr('class', 'em-legend-label em-tick-label').attr('text-anchor', 'end')\r\n    }\r\n\r\n    function drawHorizontalHistogram(barGroup) {\r\n        // Reverse everything so lowest class is first (left)\r\n        const reversedCounts = counts.slice().reverse()\r\n        const reversedPercentages = reversedCounts.map((d) => (total > 0 ? (d / total) * 100 : 0))\r\n        const reversedColors = colors.slice().reverse()\r\n\r\n        const xScale = scaleBand()\r\n            .domain(reversedCounts.map((_, i) => i)) // keep band indices aligned\r\n            .range([margin.left, width - margin.right])\r\n            .padding(0.1)\r\n\r\n        const yScale = scaleLinear()\r\n            .domain([0, max(reversedCounts)])\r\n            .nice()\r\n            .range([height - margin.bottom, margin.top])\r\n\r\n        // Bars\r\n        barGroup\r\n            .selectAll('rect')\r\n            .data(reversedCounts)\r\n            .join('rect')\r\n            .attr('class', 'em-legend-histogram-bar')\r\n            .attr('x', (_, i) => xScale(i))\r\n            .attr('y', (d) => yScale(d))\r\n            .attr('width', xScale.bandwidth())\r\n            .attr('height', (d) => height - margin.bottom - yScale(d))\r\n            .attr('fill', (_, i) => reversedColors[i]) // no manual flipping\r\n            .attr('ecl', (_, i) => i)\r\n            .on('mouseover', handleMouseOver)\r\n            .on('mouseout', handleMouseOut)\r\n\r\n        // Bar labels (centered above bars)\r\n        if (showCounts || showPercentages) {\r\n            barGroup\r\n                .selectAll('text.em-histogram-label')\r\n                .data(reversedCounts)\r\n                .join('text')\r\n                .attr('class', 'em-legend-label em-histogram-label')\r\n                .attr('x', (_, i) => xScale(i) + xScale.bandwidth() / 2)\r\n                .attr('y', (d) => yScale(d) - 5)\r\n                .attr('text-anchor', 'middle')\r\n                .text((d, i) => (showPercentages ? `${reversedPercentages[i].toFixed(1)}%` : d))\r\n        }\r\n\r\n        // Axis (only for labelType === 'thresholds')\r\n        const axisGroup = barGroup\r\n            .append('g')\r\n            .attr('id', 'em-legend-histogram-x-axis')\r\n            .attr('transform', `translate(0, ${height - margin.bottom})`)\r\n\r\n        if (out.labelType === 'thresholds') {\r\n            const positions = []\r\n\r\n            for (let i = 0; i < thresholds.length; i++) {\r\n                const bandIndex = thresholds.length - i - 1\r\n                const x = xScale(bandIndex)\r\n                if (x !== undefined) positions.push(x + xScale.bandwidth())\r\n            }\r\n\r\n            const boundaryScale = scaleLinear().domain([0, width]).range([0, width])\r\n            axisGroup.call(\r\n                axisBottom(boundaryScale)\r\n                    .tickValues(positions)\r\n                    .tickFormat((_, i) => (labelFormatter ? labelFormatter(thresholds[i], i) : thresholds[i]))\r\n                    .tickSize(4)\r\n                    .tickSizeOuter(0)\r\n            )\r\n            axisGroup\r\n                .selectAll('text')\r\n                .attr('class', 'em-legend-label em-tick-label')\r\n                .attr('text-anchor', 'end')\r\n                .attr('dy', '0em')\r\n                .attr('dx', '-0.45em')\r\n                .attr('transform', `rotate(-${labelRotation})`)\r\n        } else if (out.labelType === 'ranges') {\r\n            axisGroup.call(\r\n                axisBottom(xScale)\r\n                    .tickSizeOuter(0)\r\n                    .tickSize(0)\r\n                    .tickFormat((_, i) => (labelFormatter ? labelFormatter(thresholds[i], i) : thresholds[i]))\r\n            )\r\n            axisGroup\r\n                .selectAll('text')\r\n                .attr('class', 'em-legend-label em-tick-label')\r\n                .attr('text-anchor', 'end')\r\n                .attr('dy', '0.35em')\r\n                .attr('dx', '-0.35em')\r\n                .attr('transform', `rotate(-${labelRotation})`)\r\n        }\r\n    }\r\n\r\n    function handleMouseOver(_, i) {\r\n        const sel = select(this).style('stroke', 'black')\r\n        const ecl = sel.attr('ecl')\r\n        const reversedIndex = colors.length - 1 - parseInt(ecl, 10)\r\n        highlightRegions(out.map, reversedIndex)\r\n        if (out.map.insetTemplates_) {\r\n            executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightRegions, ecl)\r\n        }\r\n    }\r\n\r\n    function handleMouseOut(_, i) {\r\n        const sel = select(this).style('stroke', 'none')\r\n        unhighlightRegions(out.map)\r\n        if (out.map.insetTemplates_) {\r\n            executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightRegions)\r\n        }\r\n    }\r\n}\r\nfunction getColors(out) {\r\n    const map = out.map\r\n    return map.colors_\r\n        ? map.colors_\r\n        : Array.from({ length: map.numberOfClasses_ }).map((_, index) => {\r\n              return map.classToFillStyle()(index, map.numberOfClasses_)\r\n          })\r\n}\r\n\r\nfunction getData(out) {\r\n    const map = out.map\r\n    return Object.values(map.statData()._data_).map((item) => item.value)\r\n}\r\n","//supports:\r\n// Sequential interpolators (like d3.interpolatePurples)\r\n// Stretched interpolators (e.g., stretchedColor using .valueTransform)\r\n// D3 diverging scales (d3.scaleDiverging(...).domain([-60, 0, 38.7]))\r\nimport { pointer, select } from 'd3-selection'\r\nimport { getChoroplethLabelFormatter } from './choropleth/legend-choropleth'\r\nimport { executeForAllInsets, getLegendRegionsSelector } from '../core/utils'\r\n\r\n// All of the above with or without .valueTransform / .valueUntransform\r\nexport function createContinuousLegend(out, baseX, baseY) {\r\n    const m = out.map\r\n    out._continuousLegendContainer = out.lgg\r\n        .append('g')\r\n        .attr('class', 'em-continuous-legend')\r\n        .attr('id', 'em-continuous-legend')\r\n        .attr('transform', `translate(${baseX}, ${baseY})`)\r\n\r\n    // choropleths dont have multiple visual variables (yet), so we use the root legend config\r\n    const config = out.map._mapType == 'ps' ? out.colorLegend : out // Use out.colorLegend for proportional symbols, out for choropleth\r\n    const isVertical = config.orientation === 'vertical'\r\n    const legendId = 'legend-gradient-' + Math.random().toString(36).substr(2, 5)\r\n    const legendWidth = out.width || out.shapeWidth * 6\r\n    const legendHeight = isVertical ? out.shapeWidth : out.shapeHeight\r\n\r\n    createLegendGradient(out, legendId, isVertical)\r\n    drawLegendRect(legendId, out, legendWidth, legendHeight, isVertical)\r\n\r\n    if (hasTicks(out)) {\r\n        drawTickLabels(out, legendWidth, legendHeight, isVertical)\r\n    } else {\r\n        drawLowHighLabels(out, legendWidth, legendHeight, isVertical)\r\n    }\r\n\r\n    if (out.noData) {\r\n        let y = (isVertical ? out.width + 5 : legendHeight + 30) + getTitlePadding(out)\r\n        const x = 0\r\n        if (config.pointOfDivergence && config.pointOfDivergencePadding) y += config.pointOfDivergencePadding // shift legend items down after point of divergence\r\n        const container = out._continuousLegendContainer.append('g').attr('class', 'em-no-data-legend').attr('transform', `translate(${x},${y})`)\r\n        out.appendNoDataLegend(container, config.noDataText, highlightRegions, unhighlightRegions)\r\n    }\r\n}\r\n\r\nfunction getUntransformedDomain(map) {\r\n    return typeof map.colorFunction_?.domain === 'function' ? map.colorFunction_.domain() : map.domain_ || [0, 1]\r\n}\r\n\r\nfunction getTransformedDomain(map) {\r\n    const valueTransform = map.valueTransform_ || ((d) => d)\r\n    const rawDomain = getUntransformedDomain(map)\r\n    return rawDomain.map(valueTransform)\r\n}\r\n\r\nfunction getTitlePadding(out) {\r\n    // Calculate the padding between the title and the first legend item\r\n    const map = out.map\r\n    return map._mapType == 'ps' ? out.colorLegend.titlePadding : out.titlePadding\r\n}\r\n\r\nfunction createLegendGradient(out, gradientId, isVertical) {\r\n    const map = out.map\r\n    const isD3Scale = typeof map.colorFunction_?.domain === 'function'\r\n    const steps = 20\r\n\r\n    // Determine domain\r\n    const domain = getTransformedDomain(map)\r\n    // Destructure the domain into three points for a diverging scale.\r\n    // If the domain already has three values (e.g., [-10, 0, 10]), use them as-is.\r\n    // Otherwise, assume a two-point domain ([min, max]) and insert a null for the center (d1),\r\n    // so later code can still treat it like a diverging scale.\r\n    const [d0, d1, d2] = domain.length === 3 ? domain : [domain[0], null, domain[1]]\r\n\r\n    // Create gradient\r\n    const defs = out._continuousLegendContainer.append('defs')\r\n    const gradient = defs\r\n        .append('linearGradient')\r\n        .attr('id', gradientId)\r\n        .attr('x1', isVertical ? '0%' : '0%')\r\n        .attr('x2', isVertical ? '0%' : '100%')\r\n        .attr('y1', isVertical ? '100%' : '0%')\r\n        .attr('y2', isVertical ? '0%' : '0%')\r\n\r\n    for (let i = 0; i <= steps; i++) {\r\n        const t = i / steps\r\n\r\n        let val\r\n        if (domain.length === 3) {\r\n            // Diverging domain: interpolate in two halves\r\n            val = t < 0.5 ? d0 + (d1 - d0) * (t * 2) : d1 + (d2 - d1) * ((t - 0.5) * 2)\r\n        } else {\r\n            // Sequential domain: linear interpolation\r\n            val = d0 + t * (d2 - d0)\r\n        }\r\n\r\n        const color = map.colorFunction_(isD3Scale ? val : t)\r\n\r\n        gradient\r\n            .append('stop')\r\n            .attr('offset', `${t * 100}%`)\r\n            .attr('stop-color', color)\r\n    }\r\n}\r\n\r\nfunction drawLegendRect(gradientId, out, width, height, isVertical) {\r\n    const titlePadding = getTitlePadding(out)\r\n    const rect = out._continuousLegendContainer\r\n        .append('rect')\r\n        .attr('class', 'em-legend-gradient')\r\n        .attr('id', 'em-legend-gradient')\r\n        .attr('x', 0)\r\n        .attr('y', titlePadding)\r\n        .attr('width', isVertical ? height : width)\r\n        .attr('height', isVertical ? width : height)\r\n        .style('fill', `url(#${gradientId})`)\r\n\r\n    // Attach mouse events for hover highlighting\r\n    addMouseEvents(rect, out, width, isVertical)\r\n}\r\n\r\nfunction getMaxDecimals(values) {\r\n    let maxDecimals = 0\r\n\r\n    values.forEach((val) => {\r\n        if (val == null || isNaN(val)) return\r\n        const str = val.toString()\r\n        if (str.includes('.')) {\r\n            const decimals = str.split('.')[1].length\r\n            if (decimals > maxDecimals) maxDecimals = decimals\r\n        }\r\n    })\r\n\r\n    return maxDecimals\r\n}\r\n\r\nfunction getColorData(out) {\r\n    const map = out.map\r\n    if (map._mapType === 'ps') {\r\n        // For proportional symbols, use the color function directly\r\n        return map.statData('color')\r\n    } else {\r\n        return map.statData()\r\n    }\r\n}\r\n\r\nfunction addMouseEvents(rect, out, legendLength, isVertical) {\r\n    const map = out.map\r\n    const domain = getUntransformedDomain(map) // untransformed for display\r\n    const untransform = map.valueUntransform_ || ((d) => d)\r\n    const container = out._continuousLegendContainer\r\n    const titlePadding = getTitlePadding(out)\r\n    const highlightFunction = getHighlightFunction(map)\r\n    const unhighlightFunction = getUnHighlightFunction(map)\r\n\r\n    rect.on('mousemove', function (event) {\r\n        const [mx, my] = pointer(event, this)\r\n\r\n        // Position along the gradient (adjust for padding if vertical)\r\n        const along = isVertical ? my - titlePadding : mx\r\n        const clamped = Math.max(0, Math.min(legendLength, along))\r\n        const norm = clamped / legendLength\r\n\r\n        // Invert for vertical so bottom = min, top = max\r\n        const t = isVertical ? 1 - norm : norm\r\n\r\n        // Map normalized t  raw domain value\r\n        let rawVal\r\n        if (domain.length === 3) {\r\n            const [d0, d1, d2] = domain\r\n            if (t < 0.5) {\r\n                const tt = t / 0.5\r\n                rawVal = d0 + (d1 - d0) * tt\r\n            } else {\r\n                const tt = (t - 0.5) / 0.5\r\n                rawVal = d1 + (d2 - d1) * tt\r\n            }\r\n        } else {\r\n            const [d0, d1] = domain\r\n            rawVal = d0 + t * (d1 - d0)\r\n        }\r\n\r\n        rawVal = untransform(rawVal)\r\n\r\n        // Clear old markers\r\n        container.selectAll('.em-hover-line, .em-hover-tick, .em-hover-label').remove()\r\n\r\n        const x = isVertical ? 0 : clamped\r\n        const y = isVertical ? clamped + titlePadding : 0\r\n\r\n        // Draw hover line\r\n        container\r\n            .append('line')\r\n            .attr('class', 'em-hover-line')\r\n            .attr('x1', isVertical ? x : x)\r\n            .attr('y1', isVertical ? y : y)\r\n            .attr('x2', isVertical ? x + out.shapeWidth : x)\r\n            .attr('y2', isVertical ? y : y + out.shapeHeight)\r\n            .attr('stroke', 'black')\r\n            .attr('stroke-width', 1)\r\n            .attr('pointer-events', 'none')\r\n\r\n        // Draw tick\r\n        container\r\n            .append('circle')\r\n            .attr('class', 'em-hover-tick')\r\n            .attr('cx', isVertical ? x + out.shapeWidth : x)\r\n            .attr('cy', isVertical ? y : y + out.shapeHeight)\r\n            .attr('r', 3)\r\n            .attr('fill', 'black')\r\n            .attr('pointer-events', 'none')\r\n\r\n        // Draw label\r\n        const labelFormatter = getChoroplethLabelFormatter(out)\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-hover-label')\r\n            .attr('x', isVertical ? x + out.shapeWidth + 5 : x)\r\n            .attr('y', isVertical ? y : y + out.shapeHeight + 12)\r\n            .attr('text-anchor', isVertical ? 'start' : 'middle')\r\n            .attr('alignment-baseline', 'middle')\r\n            .attr('pointer-events', 'none')\r\n            .text(labelFormatter(rawVal))\r\n\r\n        //highlight on map\r\n        highlightFunction(map, rawVal)\r\n    })\r\n\r\n    rect.on('mouseout', function () {\r\n        container.selectAll('.em-hover-line, .em-hover-tick, .em-hover-label').remove()\r\n        //highlight on map\r\n        unhighlightFunction(map)\r\n    })\r\n}\r\n\r\nfunction hasTicks(out) {\r\n    return out.ticks > 1 || out.tickValues\r\n}\r\n\r\nfunction drawTickLabels(out, legendLength, legendThickness, isVertical) {\r\n    const map = out.map\r\n    const domain = getUntransformedDomain(map)\r\n    const tickGroup = out._continuousLegendContainer.append('g').attr('class', 'em-legend-ticks')\r\n    const labelFormatter = getChoroplethLabelFormatter(out)\r\n    const transform = map.valueTransform_ || ((d) => d)\r\n    const titleOffset = getTitlePadding(out)\r\n\r\n    const raw = Array.isArray(out.tickValues) && out.tickValues ? out.tickValues.map(transform) : generateTickValues(domain, out.ticks, transform)\r\n\r\n    raw.forEach((val, i) => {\r\n        const t = computeNormalizedTickPosition(val, domain) // 0..1\r\n\r\n        if (isVertical) {\r\n            // existing vertical logic (works fine)\r\n            const along = legendLength - t * legendLength\r\n            const x = legendThickness\r\n            const y = along + titleOffset\r\n\r\n            tickGroup\r\n                .append('line')\r\n                .attr('class', 'em-legend-tick')\r\n                .attr('x1', x)\r\n                .attr('y1', y)\r\n                .attr('x2', x + out.tickLength)\r\n                .attr('y2', y)\r\n\r\n            const label =\r\n                Array.isArray(out.tickLabels) && out.tickLabels[i] != null\r\n                    ? out.tickLabels[i]\r\n                    : map.valueUntransform_\r\n                      ? labelFormatter(map.valueUntransform_(val))\r\n                      : labelFormatter(val)\r\n\r\n            tickGroup\r\n                .append('text')\r\n                .attr('class', 'em-legend-label em-legend-ticklabel')\r\n                .attr('x', x + out.tickLength + 3)\r\n                .attr('y', y)\r\n                .attr('dy', '0.35em')\r\n                .attr('text-anchor', 'start')\r\n                .text(label)\r\n        } else {\r\n            // Fixed horizontal logic\r\n            const along = t * legendLength // left to right\r\n            const x = along\r\n            const y = legendThickness + titleOffset\r\n\r\n            tickGroup\r\n                .append('line')\r\n                .attr('class', 'em-legend-tick')\r\n                .attr('x1', x)\r\n                .attr('y1', y)\r\n                .attr('x2', x)\r\n                .attr('y2', y + out.tickLength)\r\n\r\n            const label =\r\n                Array.isArray(out.tickLabels) && out.tickLabels[i] != null\r\n                    ? out.tickLabels[i]\r\n                    : map.valueUntransform_\r\n                      ? labelFormatter(map.valueUntransform_(val))\r\n                      : labelFormatter(val)\r\n\r\n            tickGroup\r\n                .append('text')\r\n                .attr('class', 'em-legend-label em-legend-ticklabel')\r\n                .attr('x', x)\r\n                .attr('y', y + out.tickLength + 10) // below tick\r\n                .attr('dy', '0') // no vertical baseline offset\r\n                .attr('text-anchor', i === 0 ? 'start' : i === raw.length - 1 ? 'end' : 'middle')\r\n                .text(label)\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * Generate evenly spaced tick values across a domain.\r\n * Supports both 2-point (sequential) and 3-point (diverging) domains.\r\n *\r\n * @param {number[]} domain - The domain array: [min, max] or [min, divergence, max]\r\n * @param {number} count - Number of ticks to generate\r\n * @param {Function} transform - Optional value transform function\r\n * @returns {number[]} Array of transformed tick values\r\n */\r\nfunction generateTickValues(domain, count, transform = (x) => x) {\r\n    if (Array.isArray(domain) && domain.length === 3) {\r\n        const [min, center, max] = domain\r\n        return Array.from({ length: count }, (_, i) => {\r\n            const t = i / (count - 1)\r\n            const raw = t < 0.5 ? min + (center - min) * (t * 2) : center + (max - center) * ((t - 0.5) * 2)\r\n            return transform(raw)\r\n        })\r\n    }\r\n\r\n    // Default: sequential 2-point domain\r\n    const [start, end] = domain\r\n    return Array.from({ length: count }, (_, i) => transform(start + (i / (count - 1)) * (end - start)))\r\n}\r\n\r\nfunction computeNormalizedTickPosition(val, domain) {\r\n    if (domain.length === 3) {\r\n        const [d0, d1, d2] = domain\r\n        return val < d1 ? (0.5 * (val - d0)) / (d1 - d0) : 0.5 + (0.5 * (val - d1)) / (d2 - d1)\r\n    } else {\r\n        return (val - domain[0]) / (domain[1] - domain[0])\r\n    }\r\n}\r\n\r\nfunction drawLowHighLabels(out, width, height, isVertical) {\r\n    const titleOffset = getTitlePadding(out)\r\n    const low = out.lowLabel\r\n    const high = out.highLabel\r\n    const divergence = out.pointOfDivergenceLabel\r\n    const container = out._continuousLegendContainer\r\n\r\n    if (isVertical) {\r\n        const barLength = width // vertical length of gradient\r\n        const barThickness = height // horizontal thickness\r\n        const xPos = barThickness + 5\r\n\r\n        // Low (exactly at bottom edge of gradient)\r\n        if (low) {\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', xPos)\r\n                .attr('y', titleOffset + barLength)\r\n                .attr('dy', '-0.2em') // no offset, baseline sits at edge\r\n                .attr('text-anchor', 'start')\r\n                .text(low)\r\n        }\r\n\r\n        // High (exactly at top edge of gradient)\r\n        if (high) {\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', xPos)\r\n                .attr('y', titleOffset)\r\n                .attr('dy', '0.8em') // no offset, baseline sits at edge\r\n                .attr('text-anchor', 'start')\r\n                .text(high)\r\n        }\r\n\r\n        // Divergence (center)\r\n        if (divergence) {\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', xPos)\r\n                .attr('y', titleOffset + barLength / 2)\r\n                .attr('dy', '0.35em') // center text vertically\r\n                .attr('text-anchor', 'start')\r\n                .text(divergence)\r\n        }\r\n    } else {\r\n        const barY = height + titleOffset + 10 // 10px below horizontal bar\r\n\r\n        if (low) {\r\n            container.append('text').attr('class', 'em-legend-label').attr('x', 0).attr('y', barY).attr('text-anchor', 'start').text(low)\r\n        }\r\n\r\n        if (high) {\r\n            container.append('text').attr('class', 'em-legend-label').attr('x', width).attr('y', barY).attr('text-anchor', 'end').text(high)\r\n        }\r\n\r\n        if (divergence) {\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', width / 2)\r\n                .attr('y', barY)\r\n                .attr('text-anchor', 'middle')\r\n                .text(divergence)\r\n        }\r\n    }\r\n}\r\n\r\nfunction getHighlightTolerance(map) {\r\n    if (!map || !map.legend_) return 1 // default if map or legend is undefined\r\n    return map.legend_.highlightTolerance ?? map.legend_.colorLegend?.highlightTolerance ?? 1\r\n}\r\n\r\nfunction getHighlightFunction(map) {\r\n    if (map._mapType == 'ps') return highlightPsSymbols\r\n    return highlightRegions\r\n}\r\n\r\nfunction getUnHighlightFunction(map) {\r\n    if (map._mapType == 'ps') return unhighlightPsSymbols\r\n    return unhighlightRegions\r\n}\r\n\r\n// Highlight selected regions on mouseover\r\n//TODO: merge these with legend-choropleth.js and legend-proportional-symbols.js highlight functions\r\nfunction highlightRegions(map, rawVal) {\r\n    const tolerance = getHighlightTolerance(map)\r\n    // Select all regions\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n    if (!allRegions) return\r\n\r\n    allRegions.each(function () {\r\n        const sel = select(this)\r\n        const ecl = sel.attr('ecl')\r\n        if (!ecl || ecl === 'nd') {\r\n            if (rawVal === 'nd') {\r\n                // dont whiten no data when no data is being hovered\r\n                return\r\n            }\r\n            sel.style('fill', 'white') // Dim the region\r\n            return\r\n        }\r\n\r\n        const val = +ecl // raw stat value\r\n        if (val >= rawVal - tolerance && val <= rawVal + tolerance) {\r\n            sel.style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n        } else {\r\n            sel.style('fill', 'white') // dim others\r\n        }\r\n    })\r\n}\r\n\r\n// Reset all regions to their original colors on mouseout\r\nfunction unhighlightRegions(map) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Restore each region's original color from the fill___ attribute\r\n    allRegions.each(function () {\r\n        select(this).style('fill', select(this).attr('fill___'))\r\n    })\r\n}\r\n\r\nfunction highlightPsSymbols(map, rawVal) {\r\n    const tolerance = getHighlightTolerance(map)\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    allSymbols.each(function () {\r\n        const symbol = select(this)\r\n        const ecl = symbol.attr('ecl')\r\n\r\n        // Handle no-data\r\n        if (!ecl || ecl === 'nd') {\r\n            if (rawVal === 'nd') {\r\n                // Don't dim if we're hovering \"no data\"\r\n                symbol.style('opacity', map.psFillOpacity_)\r\n                return\r\n            }\r\n            symbol.style('opacity', 0) // Dim \"no data\" if hovering a value\r\n            return\r\n        }\r\n\r\n        const val = +ecl // raw stat value\r\n        if (val >= rawVal - tolerance && val <= rawVal + tolerance) {\r\n            // Within range: keep full opacity\r\n            symbol.style('opacity', map.psFillOpacity_)\r\n        } else {\r\n            // Outside range: dim\r\n            symbol.style('opacity', 0)\r\n        }\r\n    })\r\n}\r\n\r\nfunction unhighlightPsSymbols(map) {\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    // Restore all to default opacity\r\n    allSymbols.each(function () {\r\n        select(this).style('opacity', map.psFillOpacity_)\r\n    })\r\n}\r\n","// legends for discrete color scales\r\nimport { select } from 'd3-selection'\r\nimport { executeForAllInsets, getLegendRegionsSelector } from '../core/utils'\r\nimport { unhighlightRegions } from './choropleth/legend-choropleth'\r\n\r\n// can either be 'ranges' (e.g. 0-10, 10-20) or 'thresholds' (e.g. 0, 10, 20 with ticks)\r\nexport function drawDiscreteLegend(out, x, y) {\r\n    // container\r\n    out._discreteLegendContainer = out.lgg.append('g').attr('class', 'em-discrete-legend-container').attr('transform', `translate(${x},${y})`)\r\n\r\n    // title\r\n    if (out.colorLegend?.title) {\r\n        out._discreteLegendContainer\r\n            .append('text')\r\n            .attr('class', 'em-legend-title em-color-legend-title')\r\n            .attr('id', 'em-color-legend-title')\r\n            .attr('x', 0)\r\n            .attr('y', 0)\r\n            .text(out.colorLegend.title)\r\n    }\r\n\r\n    // choropleths dont have multiple visual variables (yet), so we use the root legend config\r\n    const config = out.map._mapType == 'ps' ? out.colorLegend : out // Use out.colorLegend for proportional symbols, out for choropleth\r\n\r\n    // thresholds vs ranges\r\n    if (out.labelType === 'ranges' || out.colorLegend?.labelType === 'ranges') {\r\n        createRangesLegend(out, config)\r\n    } else {\r\n        createThresholdsLegend(out, config)\r\n    }\r\n\r\n    // Optionally add no-data\r\n    if (config.noData) {\r\n        let y = out.getNumberOfClasses(out) * config.shapeHeight + getTitlePadding(out) + 3 // 3px padding\r\n        const x = 0\r\n        if (config.pointOfDivergence && config.pointOfDivergencePadding) y += config.pointOfDivergencePadding // shift legend items down after point of divergence\r\n        const container = out._discreteLegendContainer.append('g').attr('class', 'em-no-data-legend').attr('transform', `translate(${x},${y})`)\r\n        const highlightFunction = out.getHighlightFunction(out.map)\r\n        const unhighlightFunction = out.getUnHighlightFunction(out.map)\r\n        out.appendNoDataLegend(container, config.noDataText, highlightFunction, unhighlightFunction)\r\n    }\r\n}\r\n\r\nfunction getTitlePadding(out) {\r\n    // Calculate the padding between the title and the first legend item\r\n    const map = out.map\r\n    let p = map._mapType == 'ps' ? out.colorLegend.titlePadding : 0;\r\n    if (out.maxMin) p += 10; // extra padding if max/min labels are shown\r\n    return p\r\n}\r\n\r\nfunction createThresholdsLegend(out, config) {\r\n    const map = out.map\r\n    const container = out._discreteLegendContainer\r\n    const numberOfClasses = out.getNumberOfClasses(out)\r\n    const titlePadding = getTitlePadding(out)\r\n    const highlightFunction = out.getHighlightFunction(map)\r\n    const unhighlightFunction = out.getUnHighlightFunction(map)\r\n    const classifier = out.getColorClassifier(out)\r\n    const classToFillStyle = out.getClassToFillStyle(out)\r\n    const stat = out.getColorStats(out)\r\n\r\n    // Label formatter\r\n    const labelFormatter = out.getLabelFormatter(out)\r\n\r\n    // ---- Correct global min/max from statData ----\r\n    let globalMin\r\n    let globalMax\r\n    let globalMinRegionId\r\n    let globalMaxRegionId\r\n    let globalMinRegion\r\n    let globalMaxRegion\r\n    if ((out.maxMin || config.maxMin) && stat) {\r\n        if (stat?.getMin && stat?.getMax) {\r\n            globalMin = stat.getMin()\r\n            globalMax = stat.getMax()\r\n        }\r\n        if (stat?.getMaxRegionId && stat?.getMinRegionId) {\r\n            globalMinRegionId = stat.getMinRegionId()\r\n            globalMaxRegionId = stat.getMaxRegionId()\r\n            // get region names from geometries\r\n            const allFeatures = map.Geometries.getAllRegionFeatures()\r\n            const minFeature = allFeatures.find(f => f.properties.id === globalMinRegionId)\r\n            const maxFeature = allFeatures.find(f => f.properties.id === globalMaxRegionId)\r\n            if (minFeature) globalMinRegion = minFeature.properties?.na || minFeature.properties?.na || globalMinRegionId\r\n            if (maxFeature) globalMaxRegion = maxFeature.properties?.na || maxFeature.properties?.na || globalMaxRegionId\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < numberOfClasses; i++) {\r\n        const y = i * config.shapeHeight + titlePadding\r\n        const x = 0\r\n        const ecl = out.ascending ? numberOfClasses - i - 1 : i\r\n        const fillColor = classToFillStyle(ecl, numberOfClasses)\r\n        const itemContainer = container.append('g').attr('class', 'em-legend-item')\r\n\r\n        // Append rectangle for each class\r\n        itemContainer\r\n            .append('rect')\r\n            .attr('class', 'em-legend-rect')\r\n            .attr('x', x)\r\n            .attr('y', y)\r\n            .attr('width', config.shapeWidth)\r\n            .attr('height', config.shapeHeight)\r\n            .style('fill', fillColor)\r\n            .on('mouseover', function () {\r\n                select(this).raise()\r\n                highlightFunction(map, ecl)\r\n                if (out.map.insetTemplates_) {\r\n                    executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightFunction, ecl)\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightFunction(map)\r\n                if (out.map.insetTemplates_) {\r\n                    executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightFunction, ecl)\r\n                }\r\n            })\r\n\r\n        // Append separation line\r\n        if (i > 0) {\r\n            itemContainer\r\n                .append('line')\r\n                .attr('class', 'em-legend-separator')\r\n                .attr('x1', 0)\r\n                .attr('y1', y)\r\n                .attr('x2', out.sepLineLength)\r\n                .attr('y2', y)\r\n        }\r\n\r\n        // Append tick line at each internal boundary\r\n        if (i > 0) {\r\n            itemContainer\r\n                .append('line')\r\n                .attr('class', 'em-legend-tick')\r\n                .attr('x1', config.sepLineLength)\r\n                .attr('y1', y)\r\n                .attr('x2', config.sepLineLength + config.tickLength)\r\n                .attr('y2', y)\r\n        }\r\n\r\n        // Append label at internal boundaries\r\n        if (i < numberOfClasses - 1) {\r\n            // mark label so we can move it in drawDivergingLine\r\n            const label = itemContainer\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr(\r\n                    'x',\r\n                    Math.max(config.shapeWidth, config.sepLineLength + config.tickLength) +\r\n                    (config.labelOffsets.x || 0)\r\n                )\r\n                .attr('y', y + config.shapeHeight)\r\n                .attr('dy', '0.3em') // ~vertical centering\r\n                .text(() => {\r\n                    if (config.labels) return config.labels[i]\r\n\r\n                    if (classifier?.invertExtent) {\r\n                        const range = classifier.invertExtent(ecl)\r\n                        return labelFormatter(range[out.ascending ? 0 : 1])\r\n                    }\r\n                    return map.noDataText_ || ''\r\n                })\r\n\r\n            // mark label so we can move it in drawDivergingLine\r\n            if (config.pointOfDivergenceLabel && i == config.pointOfDivergence - 1)\r\n                label.attr('class', 'em-legend-label em-legend-label-divergence')\r\n        }\r\n    }\r\n\r\n    // Add MIN and MAX ticks at the ends of the scale using statData extent\r\n    if ((out.maxMin || config.maxMin) && Number.isFinite(globalMin) && Number.isFinite(globalMax)) {\r\n        const tickX1 = 0\r\n        const tickX2 = config.maxMinTickLength ? config.sepLineLength + config.maxMinTickLength : config.sepLineLength + config.tickLength\r\n        const labelX = config.maxMinTickLength ?\r\n            Math.max(config.shapeWidth, config.sepLineLength + config.maxMinTickLength) + (config.labelOffsets.x || 0) :\r\n            Math.max(config.shapeWidth, config.sepLineLength + config.tickLength) + (config.labelOffsets.x || 0)\r\n\r\n        let maxLabel = labelFormatter(globalMax) + (config.maxMinLabels ? config.maxMinLabels[1] : '')\r\n        let minLabel = labelFormatter(globalMin) + (config.maxMinLabels ? config.maxMinLabels[0] : '')\r\n\r\n        if (config.maxMinRegionLabels) {\r\n            // override with region names\r\n            maxLabel = `${labelFormatter(globalMax)} (${globalMaxRegion})`\r\n            minLabel = `${labelFormatter(globalMin)} (${globalMinRegion})`\r\n        }\r\n        const maxMinGroup = container.append('g').attr('class', 'em-legend-max-min-group')\r\n\r\n        // Top boundary (MAX)\r\n        const yTop = titlePadding\r\n        maxMinGroup\r\n            .append('line')\r\n            .attr('class', 'em-legend-tick em-legend-tick-max')\r\n            .attr('x1', tickX1)\r\n            .attr('y1', yTop)\r\n            .attr('x2', tickX2)\r\n            .attr('y2', yTop)\r\n\r\n        maxMinGroup\r\n            .append('text')\r\n            .style('pointer-events', 'all')\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function () {\r\n                const numberOfClasses = out.getNumberOfClasses(out)\r\n                highlightMaxRegion(map, numberOfClasses, globalMaxRegionId)\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightRegions(map)\r\n            })\r\n            .attr('class', 'em-legend-label em-legend-label-max')\r\n            .attr('x', labelX)\r\n            .attr('y', yTop)\r\n            .attr('dy', '0.3em')\r\n            .text(maxLabel)\r\n\r\n        // Bottom boundary (MIN)\r\n        const yBottom = numberOfClasses * config.shapeHeight + titlePadding\r\n        maxMinGroup\r\n            .append('line')\r\n            .attr('class', 'em-legend-tick em-legend-tick-min')\r\n            .attr('x1', tickX1)\r\n            .attr('y1', yBottom)\r\n            .attr('x2', tickX2)\r\n            .attr('y2', yBottom)\r\n\r\n        maxMinGroup\r\n            .append('text')\r\n            .style('pointer-events', 'all')\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function () {\r\n                highlightMinRegion(map, globalMinRegionId)\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightRegions(map)\r\n            })\r\n            .attr('class', 'em-legend-label em-legend-label-min')\r\n            .attr('x', labelX)\r\n            .attr('y', yBottom)\r\n            .attr('dy', '0.3em')\r\n            .text(minLabel)\r\n    }\r\n\r\n    // Draw diverging line if applicable. We draw it afterwards so that we can calculate\r\n    // the max length of the legend labels so it doesnt cover them\r\n    if (config.pointOfDivergenceLabel) {\r\n        for (let i = 0; i < numberOfClasses; i++) {\r\n            let y = i * config.shapeHeight + titlePadding\r\n            // point of divergence indicator\r\n            if (i == config.pointOfDivergence) {\r\n                drawDivergingLine(out, y, config)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction highlightMaxRegion(map, numberOfClasses, id) {\r\n    const selector = getLegendRegionsSelector(map)\r\n\r\n    const ecl = numberOfClasses - 1 // max class index\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Set all regions to white\r\n    allRegions.style('fill', 'white')\r\n\r\n    // Highlight only the selected regions by restoring their original color\r\n    const topClassRegions = allRegions.filter(\"[ecl='\" + ecl + \"']\")\r\n    topClassRegions.each(function (d) {\r\n        if (d.properties.id === id) {\r\n            select(this).style('fill', map.hoverColor_)\r\n        }\r\n        //select(this).style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n    })\r\n}\r\n\r\nfunction highlightMinRegion(map, id) {\r\n    const selector = getLegendRegionsSelector(map)\r\n\r\n    const ecl = 0 // min class index\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Set all regions to white\r\n    allRegions.style('fill', 'white')\r\n\r\n    // Highlight only the selected regions by restoring their original color\r\n    const topClassRegions = allRegions.filter(\"[ecl='\" + ecl + \"']\")\r\n    topClassRegions.each(function (d) {\r\n        if (d.properties.id === id) {\r\n            select(this).style('fill', map.hoverColor_)\r\n        }\r\n        //select(this).style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n    })\r\n}\r\n\r\n\r\n\r\nfunction createRangesLegend(out, config) {\r\n    const map = out.map\r\n    const container = out._discreteLegendContainer\r\n    const labelFormatter = out.getLabelFormatter(out)\r\n    const numberOfClasses = out.getNumberOfClasses(out)\r\n    const highlightFunction = out.getHighlightFunction(map)\r\n    const unhighlightFunction = out.getUnHighlightFunction(map)\r\n    const classToFillStyle = out.getClassToFillStyle(out)\r\n    const colorClassifier = out.getColorClassifier(out)\r\n    const titlePadding = getTitlePadding(out)\r\n\r\n    // for each class\r\n    for (let i = 0; i < numberOfClasses; i++) {\r\n        let y = i * config.shapeHeight + titlePadding\r\n        const x = 0\r\n        const ecl = out.ascending ? numberOfClasses - i - 1 : i\r\n        const fillColor = classToFillStyle(ecl, numberOfClasses)\r\n        const itemContainer = container.append('g').attr('class', 'em-legend-item')\r\n\r\n        // shift legend items down after point of divergence if applicable\r\n        if (config.pointOfDivergenceLabel && i >= config.pointOfDivergence) y += config.pointOfDivergencePadding\r\n\r\n        // Append rectangle\r\n        itemContainer\r\n            .append('rect')\r\n            .attr('class', 'em-legend-rect')\r\n            .attr('x', x)\r\n            .attr('y', y)\r\n            .attr('width', config.shapeWidth)\r\n            .attr('height', config.shapeHeight)\r\n            .style('fill', fillColor)\r\n            .on('mouseover', function () {\r\n                select(this).raise()\r\n                highlightFunction(out.map, ecl)\r\n                if (out.map.insetTemplates_) {\r\n                    executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightFunction, ecl)\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightFunction(out.map)\r\n                if (out.map.insetTemplates_) {\r\n                    executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightFunction, ecl)\r\n                }\r\n            })\r\n\r\n        // Append separation line\r\n        if (i > 0) {\r\n            itemContainer\r\n                .append('line')\r\n                .attr('class', 'em-legend-separator')\r\n                .attr('x1', 0)\r\n                .attr('y1', y)\r\n                .attr('x2', config.sepLineLength)\r\n                .attr('y2', y)\r\n        }\r\n\r\n        // Append labels\r\n        itemContainer\r\n            .append('text')\r\n            .attr('class', 'em-legend-label')\r\n            .attr('x', Math.max(config.shapeWidth, config.sepLineLength + config.tickLength) + (config.labelOffsets.x || 0))\r\n            .attr('y', y + config.shapeHeight / 2)\r\n            .attr('dy', '0.3em')\r\n            .text(config.labels ? config.labels[i] : labelFormatter(colorClassifier.invertExtent(ecl)[out.ascending ? 0 : 1], i))\r\n    }\r\n\r\n    // Draw diverging line if applicable. We draw it afterwards so that we can calculate the max length of the legend labels so it doesnt cover them\r\n    if (config.pointOfDivergenceLabel) {\r\n        for (let i = 0; i < numberOfClasses; i++) {\r\n            let y = i * config.shapeHeight + titlePadding\r\n            // point of divergence indicator\r\n            if (i == config.pointOfDivergence) {\r\n                drawDivergingLine(out, y, config)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawDivergingLine(out, y, config) {\r\n    const container = out._discreteLegendContainer.append('g').attr('class', 'em-legend-divergence-container')\r\n    const markerHeight = 6\r\n    const x = 0\r\n    if (config.labelType == 'ranges') y = y + config.pointOfDivergencePadding / 2 // move to the middle of the space between legend item\r\n    const maxLabelLength = out._discreteLegendContainer\r\n        .selectAll('.em-legend-label')\r\n        .nodes()\r\n        .reduce((max, node) => Math.max(max, node.getBBox().width), 0)\r\n    const lineLength = out.divergingLineLength || out.shapeWidth + out.labelOffsets?.x + maxLabelLength + out.labelOffsets?.x + 15 // rect > offset > label > offset > padding > vertical line\r\n\r\n    // Draw the horizontal divergence line\r\n    container\r\n        .append('line')\r\n        .attr('x1', x)\r\n        .attr('y1', y)\r\n        .attr('x2', x + lineLength)\r\n        .attr('y2', y)\r\n        .attr('class', 'em-legend-diverging-line')\r\n\r\n    const labels = out.pointOfDivergenceLabel.split('|')\r\n    if (labels.length > 1) {\r\n        // divergence line with up and down arrows\r\n        const directionLineLength = out.divergingArrowLength || 30\r\n        const directionLineX = x + lineLength\r\n        // Add arrowhead marker definition\r\n        const defs = container.append('defs')\r\n        defs.append('marker')\r\n            .attr('id', 'arrowhead')\r\n            .attr('markerWidth', markerHeight)\r\n            .attr('markerHeight', markerHeight)\r\n            .attr('refX', 0)\r\n            .attr('refY', markerHeight / 2)\r\n            .attr('orient', 'auto')\r\n            .append('polygon')\r\n            .attr('points', `0 0, ${markerHeight} ${markerHeight / 2}, 0 ${markerHeight}`)\r\n            .attr('fill', 'black')\r\n\r\n        // Upward line with arrowhead\r\n        container\r\n            .append('line')\r\n            .attr('class', 'em-legend-diverging-line')\r\n            .attr('x1', directionLineX)\r\n            .attr('y1', y)\r\n            .attr('x2', directionLineX)\r\n            .attr('y2', y - directionLineLength)\r\n            .attr('marker-end', 'url(#arrowhead)')\r\n\r\n        // Downward line with arrowhead\r\n        container\r\n            .append('line')\r\n            .attr('class', 'em-legend-diverging-line')\r\n            .attr('x1', directionLineX)\r\n            .attr('y1', y)\r\n            .attr('x2', directionLineX)\r\n            .attr('y2', y + directionLineLength)\r\n            .attr('marker-end', 'url(#arrowhead)')\r\n\r\n        // Labels for upward and downward lines\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-legend-label')\r\n            .attr('x', directionLineX + 10)\r\n            .attr('y', y - directionLineLength + 10)\r\n            .attr('dy', '0.3em')\r\n            .text(labels[0])\r\n\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-legend-label')\r\n            .attr('x', directionLineX + 10)\r\n            .attr('y', y + directionLineLength - 10)\r\n            .attr('dy', '0.3em')\r\n            .text(labels[1])\r\n    } else {\r\n        // just the single label\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-legend-diverging-label em-legend-label')\r\n            .attr('x', x + lineLength + 5)\r\n            .attr('y', y)\r\n            .attr('dy', '0.3em')\r\n            .text(out.pointOfDivergenceLabel)\r\n    }\r\n\r\n    //move threshold label out of the way of the line\r\n    if (out.labelType == 'thresholds' || out.colorLegend?.labelType == 'thresholds') {\r\n        if (labels.length > 1) {\r\n            // move it to end of line\r\n            out._discreteLegendContainer.selectAll('.em-legend-label-divergence').attr('x', x + lineLength + 10)\r\n        } else {\r\n            // remove it so it doesnt clash with pointOfDivergenceLabel\r\n            out._discreteLegendContainer.selectAll('.em-legend-label-divergence').remove()\r\n        }\r\n    }\r\n}\r\n","//legend-choropleth.js\r\nimport { select } from 'd3-selection'\r\nimport { format } from 'd3-format'\r\nimport * as Legend from '../legend'\r\nimport { getLegendRegionsSelector } from '../../core/utils'\r\nimport { appendPatternFillLegend } from '../legend-pattern-fill'\r\nimport { createHistogramLegend } from './legend-histogram'\r\nimport { createContinuousLegend } from '../legend-continuous'\r\nimport { drawDiscreteLegend } from '../legend-discrete'\r\nimport { createAlphaLegend } from './legend-value-by-alpha'\r\n\r\n/**\r\n * A legend for choropleth maps\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object (inherit)\r\n    const out = Legend.legend(map)\r\n\r\n    out.labelType = 'thresholds' // thresholds || ranges\r\n    //the separation line length\r\n    out.sepLineLength = out.shapeWidth\r\n    //tick line length in pixels\r\n    out.tickLength = 4\r\n    //the number of decimal for the legend labels\r\n    out.decimals = 0\r\n    //the distance between the legend box elements to the corresponding text label\r\n    out.labelOffsets = { x: 3, y: 0 }\r\n\r\n    // manually define labels\r\n    out.labels = null\r\n\r\n    // Histogram config as nested object\r\n    out.histogram = null\r\n\r\n    //diverging line\r\n    out.pointOfDivergenceLabel = undefined\r\n    out.pointOfDivergence = undefined\r\n    out.pointOfDivergencePadding = 7\r\n    out.divergingLineLength = undefined\r\n    out.divergingArrowLength = undefined\r\n\r\n    //continuous legend\r\n    out.lowLabel = 'Low' //'Low'\r\n    out.highLabel = 'High' //'High'\r\n    out.ticks = 0 // Number of tick marks on continuous color legend (set to 0 to disable and just show low/high labels)\r\n    out.tickValues = undefined // Custom tick values for continuous legend (if empty, will use linear interpolation based on domain)\r\n    out.tickLabels = undefined // Custom tick labels for continuous legend (if empty, will use tickValues)\r\n    out.orientation = 'vertical' // or 'vertical'\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        for (let key in config) {\r\n            if (key === 'histogram' && typeof config[key] === 'object') {\r\n                out.histogram = {\r\n                    orientation: 'horizontal',\r\n                    showCounts: false,\r\n                    showPercentages: false,\r\n                    labelRotation: 0,\r\n                    ...config.histogram,\r\n                }\r\n            } else {\r\n                out[key] = config[key]\r\n            }\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        if (out.lgg.node()) {\r\n            const map = out.map\r\n\r\n            // Draw legend background box and title if provided\r\n            out.makeBackgroundBox()\r\n            if (out.title) out.addTitle()\r\n            if (out.subtitle) out.addSubtitle()\r\n\r\n            //exit early if no classifier\r\n            if (!map.classToFillStyle()) return\r\n\r\n            //set default point of divergence if applicable\r\n            if (out.pointOfDivergenceLabel && !out.pointOfDivergence) out.pointOfDivergence = map.numberOfClasses_ / 2\r\n\r\n            // initial x and y positions for the internal legend elements\r\n            const baseY = out.getBaseY()\r\n            const baseX = out.getBaseX()\r\n\r\n            if (out.histogram) {\r\n                createHistogramLegend(out, baseX, baseY)\r\n            } else if (map.colorSchemeType_ === 'continuous') {\r\n                createContinuousLegend(out, baseX, baseY)\r\n            } else {\r\n                drawDiscreteLegend(out, baseX, baseY)\r\n            }\r\n\r\n            // Draw opacity legend if value-by-alpha is active\r\n            if (map.opacityScale_) {\r\n                const offsetY = out.lgg.node().getBBox().height + 10 // 10px spacing below color legend\r\n                createAlphaLegend(out, baseX, baseY + offsetY)\r\n            }\r\n\r\n            // Append pattern fill legend items BELOW the main legend\r\n            if (out.map.patternFill_) {\r\n                const legendHeight = out.lgg.node().getBBox().height\r\n                const patternContainer = out.lgg\r\n                    .append('g')\r\n                    .attr('class', 'pattern-fill-legend')\r\n                    .attr('transform', `translate(${out.getBaseX()}, ${legendHeight + out.boxPadding + 5})`)\r\n                appendPatternFillLegend(out, patternContainer)\r\n            }\r\n\r\n            // Set legend box dimensions\r\n            out.setBoxDimension()\r\n        }\r\n    }\r\n\r\n    //deprecated\r\n    out.labelDecNb = (v) => (console.warn('labelDecNb is now DEPRECATED. Please use decimals instead.'), out)\r\n\r\n    return out\r\n}\r\n\r\nexport function getThresholds(out) {\r\n    const map = out.map\r\n    const thresholds =\r\n        map.thresholds_.length > 1\r\n            ? map.thresholds_\r\n            : Array.from({ length: map.numberOfClasses_ })\r\n                .map((_, index) => {\r\n                    return map.classifier().invertExtent(index)[out.ascending ? 0 : 1]\r\n                })\r\n                .slice(1) // Remove the first entry and return the rest as an array\r\n    return thresholds\r\n}\r\n\r\nexport function getChoroplethLabelFormatter(out) {\r\n    if (out.labelType == 'ranges') {\r\n        const thresholds = getThresholds(out)\r\n        const defaultLabeller = (label, i) => {\r\n            const decimalFormatter = format(`.${out.decimals}f`)\r\n            if (i === 0) return `> ${decimalFormatter(thresholds[thresholds.length - 1])}` //top\r\n            if (i === thresholds.length) return `< ${decimalFormatter(thresholds[0])}` //bottom\r\n            return `${decimalFormatter(thresholds[thresholds.length - i - 1])} - < ${decimalFormatter(thresholds[thresholds.length - i])}  ` //in-between\r\n        }\r\n        return out.labelFormatter || defaultLabeller\r\n    } else if (out.labelType == 'thresholds') {\r\n        return out.labelFormatter || format(`.${out.decimals}f`)\r\n    } else {\r\n        return out.labelFormatter || format(`.${out.decimals}f`)\r\n    }\r\n}\r\n\r\n// Highlight selected regions on mouseover\r\nexport function highlightRegions(map, ecl) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Set all regions to white\r\n    allRegions.style('fill', 'white')\r\n\r\n    // Highlight only the selected regions by restoring their original color\r\n    const selectedRegions = allRegions.filter(\"[ecl='\" + ecl + \"']\")\r\n    selectedRegions.each(function () {\r\n        select(this).style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n    })\r\n}\r\n\r\n// Reset all regions to their original colors on mouseout\r\nexport function unhighlightRegions(map) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Restore each region's original color from the fill___ attribute\r\n    allRegions.each(function () {\r\n        select(this).style('fill', select(this).attr('fill___'))\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * Threshold ticks + dataset min/max at the ends.\r\n * Example: thresholds [10, 20, 30], data in [3, 42]\r\n *  -> [3, 10, 20, 30, 42]  (or reversed if !ascending)\r\n */\r\nexport function getThresholdTicksWithExtents(out) {\r\n    const thresholds = getThresholds(out)\r\n    const maxVal = out.map.statData().getMax()\r\n    const minVal = out.map.statData().getMin()\r\n\r\n    if (!maxVal && !minVal) return thresholds\r\n\r\n\r\n    // Build [min, ...thresholds, max] and dedupe\r\n    const vals = [minVal, ...thresholds, maxVal]\r\n    const uniq = Array.from(new Set(vals)) // preserve order, avoid dupes\r\n\r\n    // Sort according to legend direction\r\n    uniq.sort((a, b) => (out.ascending ? a - b : b - a))\r\n\r\n    return uniq\r\n}","// legend-alpha.js\r\nimport { min, max } from 'd3-array'\r\nimport { spaceAsThousandSeparator } from '../../core/utils'\r\nimport { select } from 'd3-selection'\r\nimport { getChoroplethLabelFormatter } from './legend-choropleth'\r\n\r\n/**\r\n * Create a legend for the opacity (alpha) channel.\r\n * Called only if map.opacityScale_ is defined.\r\n */\r\nexport function createAlphaLegend(out, baseX, baseY) {\r\n    const map = out.map\r\n    const alphaData = map.statData('alpha')\r\n    if (!alphaData || !alphaData.isReady()) return\r\n    const scale = map.opacityScale_\r\n    // const minVal = alphaData.getMin()\r\n    // const maxVal = alphaData.getMax()\r\n    const minVal = scale.domain()[0]\r\n    const maxVal = scale.domain()[1]\r\n    const labelFormatter = getChoroplethLabelFormatter(out)\r\n\r\n    // Container for the alpha legend\r\n    out._alphaLegendContainer = out.lgg.append('g').attr('class', 'alpha-legend-container').attr('transform', `translate(${baseX},${baseY})`)\r\n\r\n    const width = 120\r\n    const height = 10\r\n    const steps = 40\r\n    const stepWidth = width / steps\r\n\r\n    // Draw a simple gradient of black rectangles with opacity scaled to the data\r\n    for (let i = 0; i < steps; i++) {\r\n        const v = minVal + ((maxVal - minVal) * i) / steps\r\n        out._alphaLegendContainer\r\n            .append('rect')\r\n            .attr('x', i * stepWidth)\r\n            .attr('y', 0)\r\n            .attr('width', stepWidth)\r\n            .attr('height', height)\r\n            .style('fill', '#000')\r\n            .style('opacity', scale(v))\r\n    }\r\n\r\n    // Labels: min and max\r\n    out._alphaLegendContainer\r\n        .append('text')\r\n        .attr('x', 0)\r\n        .attr('y', height + 12)\r\n        .attr('class', 'em-legend-label')\r\n        .text(labelFormatter(minVal))\r\n\r\n    out._alphaLegendContainer\r\n        .append('text')\r\n        .attr('x', width)\r\n        .attr('y', height + 12)\r\n        .attr('text-anchor', 'end')\r\n        .attr('class', 'em-legend-label')\r\n        .text(labelFormatter(maxVal))\r\n\r\n    // Title centered above bar\r\n    out._alphaLegendContainer\r\n        .append('text')\r\n        .attr('x', width / 2)\r\n        .attr('y', -5)\r\n        .attr('text-anchor', 'middle')\r\n        .attr('class', 'em-legend-label')\r\n        .text(alphaData.unitText?.() || 'Transparency')\r\n}\r\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction append(strings) {\n  this._ += strings[0];\n  for (let i = 1, n = strings.length; i < n; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  let d = Math.floor(digits);\n  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  const k = 10 ** d;\n  return function(strings) {\n    this._ += strings[0];\n    for (let i = 1, n = strings.length; i < n; ++i) {\n      this._ += Math.round(arguments[i] * k) / k + strings[i];\n    }\n  };\n}\n\nexport class Path {\n  constructor(digits) {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n    this._append = digits == null ? append : appendRound(digits);\n  }\n  moveTo(x, y) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._append`Z`;\n    }\n  }\n  lineTo(x, y) {\n    this._append`L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  quadraticCurveTo(x1, y1, x, y) {\n    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  bezierCurveTo(x1, y1, x2, y2, x, y) {\n    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arcTo(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._append`M${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._append`L${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      let x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;\n      }\n\n      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;\n    }\n  }\n  arc(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._append`M${x0},${y0}`;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._append`L${x0},${y0}`;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._append`A${r},${r},0,${+(da >= pi)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;\n    }\n  }\n  rect(x, y, w, h) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;\n  }\n  toString() {\n    return this._;\n  }\n}\n\nexport function path() {\n  return new Path;\n}\n\n// Allow instanceof d3.path\npath.prototype = Path.prototype;\n\nexport function pathRound(digits = 3) {\n  return new Path(+digits);\n}\n","import {Path} from \"d3-path\";\n\nexport function withPath(shape) {\n  let digits = 3;\n\n  shape.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) {\n      digits = null;\n    } else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    return shape;\n  };\n\n  return () => new Path(digits);\n}\n","export const abs = Math.abs;\nexport const atan2 = Math.atan2;\nexport const cos = Math.cos;\nexport const max = Math.max;\nexport const min = Math.min;\nexport const sin = Math.sin;\nexport const sqrt = Math.sqrt;\n\nexport const epsilon = 1e-12;\nexport const pi = Math.PI;\nexport const halfPi = pi / 2;\nexport const tau = 2 * pi;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n","import {min, sqrt} from \"../math.js\";\n\nconst sqrt3 = sqrt(3);\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size + min(size / 28, 0.75)) * 0.59436;\n    const t = r / 2;\n    const u = t * sqrt3;\n    context.moveTo(0, r);\n    context.lineTo(0, -r);\n    context.moveTo(-u, -t);\n    context.lineTo(u, t);\n    context.moveTo(-u, t);\n    context.lineTo(u, -t);\n  }\n};\n","import {pi, sqrt, tau} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / pi);\n    context.moveTo(r, 0);\n    context.arc(0, 0, r, 0, tau);\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / 5) / 2;\n    context.moveTo(-3 * r, -r);\n    context.lineTo(-r, -r);\n    context.lineTo(-r, -3 * r);\n    context.lineTo(r, -3 * r);\n    context.lineTo(r, -r);\n    context.lineTo(3 * r, -r);\n    context.lineTo(3 * r, r);\n    context.lineTo(r, r);\n    context.lineTo(r, 3 * r);\n    context.lineTo(-r, 3 * r);\n    context.lineTo(-r, r);\n    context.lineTo(-3 * r, r);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst tan30 = sqrt(1 / 3);\nconst tan30_2 = tan30 * 2;\n\nexport default {\n  draw(context, size) {\n    const y = sqrt(size / tan30_2);\n    const x = y * tan30;\n    context.moveTo(0, -y);\n    context.lineTo(x, 0);\n    context.lineTo(0, y);\n    context.lineTo(-x, 0);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const w = sqrt(size);\n    const x = -w / 2;\n    context.rect(x, x, w, w);\n  }\n};\n","import {sin, cos, sqrt, pi, tau} from \"../math.js\";\n\nconst ka = 0.89081309152928522810;\nconst kr = sin(pi / 10) / sin(7 * pi / 10);\nconst kx = sin(tau / 10) * kr;\nconst ky = -cos(tau / 10) * kr;\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size * ka);\n    const x = kx * r;\n    const y = ky * r;\n    context.moveTo(0, -r);\n    context.lineTo(x, y);\n    for (let i = 1; i < 5; ++i) {\n      const a = tau * i / 5;\n      const c = cos(a);\n      const s = sin(a);\n      context.lineTo(s * r, -c * r);\n      context.lineTo(c * x - s * y, s * x + c * y);\n    }\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst sqrt3 = sqrt(3);\n\nexport default {\n  draw(context, size) {\n    const y = -sqrt(size / (sqrt3 * 3));\n    context.moveTo(0, y * 2);\n    context.lineTo(-sqrt3 * y, -y);\n    context.lineTo(sqrt3 * y, -y);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst c = -0.5;\nconst s = sqrt(3) / 2;\nconst k = 1 / sqrt(12);\nconst a = (k / 2 + 1) * 3;\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / a);\n    const x0 = r / 2, y0 = r * k;\n    const x1 = x0, y1 = r * k + r;\n    const x2 = -x1, y2 = y1;\n    context.moveTo(x0, y0);\n    context.lineTo(x1, y1);\n    context.lineTo(x2, y2);\n    context.lineTo(c * x0 - s * y0, s * x0 + c * y0);\n    context.lineTo(c * x1 - s * y1, s * x1 + c * y1);\n    context.lineTo(c * x2 - s * y2, s * x2 + c * y2);\n    context.lineTo(c * x0 + s * y0, c * y0 - s * x0);\n    context.lineTo(c * x1 + s * y1, c * y1 - s * x1);\n    context.lineTo(c * x2 + s * y2, c * y2 - s * x2);\n    context.closePath();\n  }\n};\n","import {sqrt} from \"../math.js\";\n\nconst sqrt3 = sqrt(3);\n\nexport default {\n  draw(context, size) {\n    const s = sqrt(size) * 0.6824;\n    const t = s  / 2;\n    const u = (s * sqrt3) / 2; // cos(Math.PI / 6)\n    context.moveTo(0, -s);\n    context.lineTo(u, t);\n    context.lineTo(-u, t);\n    context.closePath();\n  }\n};\n","import constant from \"./constant.js\";\nimport {withPath} from \"./path.js\";\nimport asterisk from \"./symbol/asterisk.js\";\nimport circle from \"./symbol/circle.js\";\nimport cross from \"./symbol/cross.js\";\nimport diamond from \"./symbol/diamond.js\";\nimport diamond2 from \"./symbol/diamond2.js\";\nimport plus from \"./symbol/plus.js\";\nimport square from \"./symbol/square.js\";\nimport square2 from \"./symbol/square2.js\";\nimport star from \"./symbol/star.js\";\nimport triangle from \"./symbol/triangle.js\";\nimport triangle2 from \"./symbol/triangle2.js\";\nimport wye from \"./symbol/wye.js\";\nimport times from \"./symbol/times.js\";\n\n// These symbols are designed to be filled.\nexport const symbolsFill = [\n  circle,\n  cross,\n  diamond,\n  square,\n  star,\n  triangle,\n  wye\n];\n\n// These symbols are designed to be stroked (with a width of 1.5px and round caps).\nexport const symbolsStroke = [\n  circle,\n  plus,\n  times,\n  triangle2,\n  asterisk,\n  square2,\n  diamond2\n];\n\nexport default function Symbol(type, size) {\n  let context = null,\n      path = withPath(symbol);\n\n  type = typeof type === \"function\" ? type : constant(type || circle);\n  size = typeof size === \"function\" ? size : constant(size === undefined ? 64 : +size);\n\n  function symbol() {\n    let buffer;\n    if (!context) context = buffer = path();\n    type.apply(this, arguments).draw(context, +size.apply(this, arguments));\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  symbol.type = function(_) {\n    return arguments.length ? (type = typeof _ === \"function\" ? _ : constant(_), symbol) : type;\n  };\n\n  symbol.size = function(_) {\n    return arguments.length ? (size = typeof _ === \"function\" ? _ : constant(+_), symbol) : size;\n  };\n\n  symbol.context = function(_) {\n    return arguments.length ? (context = _ == null ? null : _, symbol) : context;\n  };\n\n  return symbol;\n}\n","import { max } from 'd3-array'\r\nimport { getFontSizeFromClass, spaceAsThousandSeparator } from '../core/utils'\r\n\r\n/**\r\n * @description builds a nested circle legend for proportional circles\r\n * @param {*} out legend object\r\n */\r\nexport function drawCircleSizeLegend(out, container, values, sizeScale, title, titlePadding = 16) {\r\n    //draw size legend title\r\n    if (title) {\r\n        const sizeLegendTitleFontSize = getFontSizeFromClass('em-size-legend-title')\r\n        titlePadding += sizeLegendTitleFontSize // add title font size to padding\r\n        // append title to the legend\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-size-legend-title')\r\n            .attr('id', 'em-size-legend-title')\r\n            .attr('x', 0)\r\n            .attr('y', sizeLegendTitleFontSize)\r\n            .text(title)\r\n    }\r\n\r\n    //assign default circle radiuses if none specified by user\r\n    let domain = sizeScale.domain()\r\n    if (!values) {\r\n        let min = domain[0]\r\n        const max = domain[1]\r\n\r\n        // If min is 0, replace with the smallest non-zero value\r\n        if (min === 0 && sizeScale._values?.length) {\r\n            min = Math.min(...sizeScale._values.filter((v) => v > 0))\r\n        }\r\n\r\n        values = [max, min]\r\n    }\r\n\r\n    let maxRadius = sizeScale(max(values)) //maximum circle radius to be shown in legend\r\n    let x = maxRadius\r\n    let y = maxRadius * 2 + titlePadding // y position of the first circle\r\n\r\n    const itemContainer = container\r\n        .append('g')\r\n        .attr('transform', `translate(${x},${y})`)\r\n        .attr('class', 'em-circle-size-legend')\r\n        .attr('id', 'em-circle-size-legend')\r\n        .attr('text-anchor', 'right')\r\n        .style('fill', 'black')\r\n        .selectAll('g')\r\n        .data(values.filter((d) => sizeScale(d))) // Filter data before binding\r\n        .join('g')\r\n        .attr('class', 'em-legend-item')\r\n\r\n    //circles\r\n    itemContainer\r\n        .append('circle')\r\n        .attr('class', 'em-legend-circle')\r\n        .style('fill', 'none')\r\n        .attr('stroke', 'black')\r\n        .attr('cy', (d) => -sizeScale(d))\r\n        .attr('r', sizeScale)\r\n\r\n    //labels\r\n    let labelFormatter = out.sizeLegend?.labelFormatter || spaceAsThousandSeparator\r\n    if (out.nodeSizeLegend?.labelFormatter) {\r\n        labelFormatter = out.nodeSizeLegend.labelFormatter\r\n    }\r\n    let labels = out.sizeLegend?.labels || out.nodeSizeLegend?.labels\r\n    itemContainer\r\n        .append('text')\r\n        .attr('class', 'em-legend-label')\r\n        .attr('dy', '0.35em') // ~vertical centering\r\n        .attr('y', (d, i) => {\r\n            let y = -1 - 2 * sizeScale(d)\r\n            return y\r\n        })\r\n        .attr('x', maxRadius + 5)\r\n        .text((d, i) => {\r\n            if (labels && labels[i]) {\r\n                return labels[i]\r\n            }\r\n            return labelFormatter(d)\r\n        })\r\n    //line pointing to top of corresponding circle:\r\n    itemContainer\r\n        .append('line')\r\n        .style('stroke-dasharray', 2)\r\n        .style('stroke', 'grey')\r\n        .attr('x1', 2)\r\n        .attr('y1', (d, i) => {\r\n            let y = -1 - 2 * sizeScale(d)\r\n            return y\r\n        })\r\n        .attr('x2', maxRadius + 5)\r\n        .attr('y2', (d, i) => {\r\n            let y = -1 - 2 * sizeScale(d)\r\n            return y\r\n        })\r\n\r\n    return out\r\n}\r\n","import { getFontSizeFromClass, spaceAsThousandSeparator } from '../../core/utils'\r\n\r\nexport function buildSpikeLegend(out) {\r\n    const map = out.map\r\n\r\n    // SVG path for a spike\r\n    const spike = (length, width = map.psSpikeWidth_) => `M${-width / 2},0L0,${-length}L${width / 2},0`\r\n\r\n    const labelFormatter = out.sizeLegend?.labelFormatter || spaceAsThousandSeparator\r\n\r\n    const sizeDomain = map.classifierSize_.domain()\r\n    const maxStat = sizeDomain[1]\r\n    const minStat = sizeDomain[0]\r\n    const maxSize = map.classifierSize_(maxStat)\r\n\r\n    // Legend values (max  min by default)\r\n    const legendValues = out.sizeLegend.values || [maxStat, minStat]\r\n\r\n    // Typography\r\n    const labelFontSize = getFontSizeFromClass('em-legend-label')\r\n    const titleFontSize = out.sizeLegend.title ? getFontSizeFromClass('em-size-legend-title') : 0\r\n\r\n    const labelOffset = labelFontSize + 2\r\n\r\n    // Root container\r\n    const container = out._sizeLegendContainer.append('g').attr('id', 'em-spike-legend')\r\n\r\n    // Title\r\n    let currentY = 0\r\n\r\n    if (out.sizeLegend.title) {\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-legend-title em-spike-legend-title')\r\n            .attr('id', 'em-size-legend-title')\r\n            .attr('x', 0)\r\n            .attr('y', titleFontSize)\r\n            .text(out.sizeLegend.title)\r\n\r\n        currentY += titleFontSize + 8\r\n    }\r\n\r\n    // Items container (centered under title)\r\n    // Horizontal spacing based on spike width and maximum label length\r\n    // const spikeSpacing = Math.max(map.psSpikeWidth_ * 1.2, labelFontSize * 2.5)\r\n    const formattedLabels = legendValues.map((d) => String(labelFormatter(d)))\r\n    const maxLabelLength = Math.max(...formattedLabels.map((s) => s.length))\r\n    const labelPixelWidth = maxLabelLength * labelFontSize * 0.45\r\n    const spikeSpacing = labelPixelWidth + 5\r\n\r\n\r\n    const items = container\r\n        .append('g')\r\n        .attr('id', 'em-spike-legend-items')\r\n        .attr('transform', `translate(${out.boxPadding + labelFontSize},${currentY + maxSize})`)\r\n        .attr('text-anchor', 'middle')\r\n        .style('font-size', `${labelFontSize}px`)\r\n        .selectAll('g')\r\n        .data(legendValues)\r\n        .join('g')\r\n        .attr('transform', (d, i) => `translate(${i * spikeSpacing},0)`)\r\n\r\n    // Spikes\r\n    items\r\n        .append('path')\r\n        .attr('d', (d) => spike(map.classifierSize_(d)))\r\n        .attr('fill', map.psFill_)\r\n        .attr('fill-opacity', map.psFillOpacity_)\r\n        .attr('stroke', map.psStroke_)\r\n        .attr('stroke-width', map.psStrokeWidth_)\r\n\r\n    // Labels\r\n    items\r\n        .append('text')\r\n        .attr('class', 'em-legend-label em-spike-legend-label')\r\n        .attr('dy', labelOffset)\r\n        .text((d) => labelFormatter(d))\r\n}\r\n","import { symbol, symbolCircle, symbolDiamond, symbolStar, symbolCross, symbolSquare, symbolTriangle, symbolWye } from 'd3-shape'\r\n/**\r\n * @description give a d3 symbol from a shape name\r\n */\r\nexport const symbolsLibrary = {\r\n    cross: symbolCross,\r\n    square: symbolSquare,\r\n    diamond: symbolDiamond,\r\n    triangle: symbolTriangle,\r\n    star: symbolStar,\r\n    wye: symbolWye,\r\n    circle: symbolCircle,\r\n}\r\n\r\n/**\r\n * @description Appends <path> elements containing symbols for each region in the map SVG\r\n * @param {*} map map instance\r\n * @param {*} sizeData e.g. map.statData('size')\r\n * @return {*}\r\n */\r\nexport function appendD3SymbolsToMap(map, sizeData, out) {\r\n    return map\r\n        .svg()\r\n        .selectAll('g.em-centroid')\r\n        .append('path')\r\n        .filter((rg) => {\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv && sv.value !== ':') return rg\r\n        })\r\n        .attr('class', 'ps')\r\n        .attr('d', (rg) => {\r\n            //calculate size\r\n            if (!sizeData) return\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv != 0 && !sv) return\r\n            let size = out.classifierSize_(+sv.value) || 0\r\n\r\n            //apply size to shape\r\n            if (out.psCustomShape_) {\r\n                return out.psCustomShape_.size(size * size)()\r\n            } else {\r\n                const symbolType = symbolsLibrary[out.psShape_] || symbolsLibrary['circle']\r\n                return symbol()\r\n                    .type(symbolType)\r\n                    .size(size * size)()\r\n            }\r\n        })\r\n}\r\n","import { symbolsLibrary } from '../../map-types/proportional-symbol/symbols/d3-symbols.js'\r\nimport { symbol } from 'd3-shape'\r\n\r\n/**\r\n * @description returns the d3.symbol object chosen by the user\r\n * @return {d3.shape || SVG}\r\n */\r\nfunction getShape(out) {\r\n    const map = out.map\r\n    let shape\r\n    if (map.psCustomSVG_) {\r\n        shape = map.psCustomSVG_\r\n    } else if (map.psCustomShape_) {\r\n        shape = map.psCustomShape_\r\n    } else if (map.psShape_ == 'bar') {\r\n        //for rectangles, we use a custom d3 symbol\r\n        let drawRectangle = (context, size) => {\r\n            let height = Math.sqrt(size)\r\n            context.moveTo(0, 0)\r\n            context.lineTo(0, height)\r\n            context.lineTo(map.psBarWidth_, height)\r\n            context.lineTo(map.psBarWidth_, 0)\r\n            context.lineTo(0, 0)\r\n            context.closePath()\r\n        }\r\n        shape = symbol().type({ draw: drawRectangle })\r\n    } else {\r\n        let symbolType = symbolsLibrary[map.psShape_] || symbolsLibrary['circle']\r\n        shape = symbol().type(symbolType)\r\n    }\r\n    return shape\r\n}\r\n\r\n/**\r\n * @description builds a size legend item for proportional D3 shapes (e.g. square, triangle, star)\r\n * @param {number} symbolSize the size of the symbol item\r\n */\r\nexport function buildD3SymbolItem(out, value, symbolSize, index, labelFormatter) {\r\n    const map = out.map\r\n\r\n    // Initialize running Y cursor for stacking\r\n    if (out.sizeLegend._cursorY == null) {\r\n        out.sizeLegend._cursorY = out.boxPadding + (out.sizeLegend.title ? out.sizeLegend.titlePadding : 0)\r\n    }\r\n\r\n    const maxSize = map.classifierSize_(map.classifierSize_.domain()[1])\r\n    const x = maxSize\r\n    const y = out.sizeLegend._cursorY + out.sizeLegend.shapePadding\r\n\r\n    // Container for symbol + label\r\n    const itemContainer = out._sizeLegendContainer.append('g').attr('class', 'em-size-legend-item').attr('transform', `translate(${x},${y})`)\r\n\r\n    // --- Draw D3 symbol ---\r\n    const shape = getShape(out)\r\n    const d = shape.size(symbolSize * symbolSize)()\r\n\r\n    const symbolGroup = itemContainer\r\n        .append('g')\r\n        .style('fill', map.classifierColor_ ? out.sizeLegend.shapeFill : map.psFill_)\r\n        .style('fill-opacity', map.psFillOpacity())\r\n        .style('stroke', out.sizeLegend.shapeStroke || map.psStroke())\r\n        .style('stroke-width', out.sizeLegend.shapeStrokeWidth || map.psStrokeWidth())\r\n\r\n    const symbolPath = symbolGroup.append('path').attr('d', d)\r\n\r\n    // hift symbol down by half its height (baseline-align it)\r\n    const symBBox = symbolPath.node().getBBox()\r\n    symbolPath.attr('transform', `translate(${out.sizeLegend.shapeOffsets.x},${out.sizeLegend.shapeOffsets.y + symBBox.height / 2})`)\r\n\r\n    // --- Label ---\r\n    const labelX = maxSize / 2 + out.sizeLegend.labelOffsets.x + out.boxPadding\r\n\r\n    itemContainer\r\n        .append('text')\r\n        .attr('class', 'em-legend-label')\r\n        .attr('dy', '0.35em')\r\n        .attr('x', labelX)\r\n        .attr('y', symBBox.height / 2)\r\n        .text(labelFormatter(value))\r\n\r\n    // --- Advance cursor using final rendered height ---\r\n    const hb = itemContainer.node().getBBox().height\r\n    out.sizeLegend._cursorY += hb + out.sizeLegend.shapePadding\r\n}\r\n","import { getFontSizeFromClass } from '../../core/utils'\r\nimport { symbol } from 'd3-shape'\r\nimport { spaceAsThousandSeparator } from '../../core/utils'\r\n\r\nimport { select } from 'd3-selection'\r\nimport { drawCircleSizeLegend } from '../legend-circle-size'\r\nimport { buildSpikeLegend } from './legend-spike'\r\nimport { buildD3SymbolItem } from './legend-d3-shape'\r\nimport { symbolsLibrary } from '../../map-types/proportional-symbol/symbols/d3-symbols'\r\n\r\n/**\r\n * Builds a legend which illustrates the statistical values of different symbol sizes\r\n *\r\n * @param {*} map map instance\r\n * @param {*} container parent legend object from core/legend.js\r\n */\r\nexport function drawSizeLegend(out, baseX, baseY) {\r\n    const map = out.map\r\n\r\n    // container for size legend\r\n    out._sizeLegendContainer = out.lgg\r\n        .append('g')\r\n        .attr('class', 'em-size-legend-container')\r\n        .attr('id', 'em-size-legend-container')\r\n        .attr('transform', `translate(${baseX},${baseY})`)\r\n\r\n    // reset per-draw cursors/accumulators\r\n    out.sizeLegend._cursorY = null\r\n\r\n    // draw legend\r\n    if (!map.psCustomSVG_ && map.psShape_ === 'circle') {\r\n        // circle size legend\r\n        drawCircleSizeLegend(\r\n            out,\r\n            out._sizeLegendContainer,\r\n            out.sizeLegend.values,\r\n            map.classifierSize_,\r\n            out.sizeLegend.title,\r\n            out.sizeLegend.titlePadding\r\n        )\r\n        // DO NOT return; we want No Data appended after everything\r\n    } else if (map.psShape_ === 'spike') {\r\n        buildSpikeLegend(out)\r\n    } else {\r\n        // bars, other d3 shapes, custom SVG paths\r\n\r\n        const container = out._sizeLegendContainer\r\n        //draw size legend title\r\n        if (out.sizeLegend.title) {\r\n            const sizeLegendTitleFontSize = getFontSizeFromClass('em-size-legend-title')\r\n            // append title to the legend\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-title em-size-legend-title')\r\n                .attr('id', 'em-size-legend-title')\r\n                .attr('x', 0)\r\n                .attr('y', sizeLegendTitleFontSize)\r\n                .text(out.sizeLegend.title)\r\n        }\r\n\r\n        // define format for labels\r\n        const labelFormatter = out.sizeLegend?.labelFormatter || spaceAsThousandSeparator\r\n        const domain = map.classifierSize_.domain()\r\n\r\n        // for custom paths\r\n        map.customSymbols = { nodeHeights: 0 } // save some custom settings for buildCustomSVGItem\r\n\r\n        // if user doesnt define values for legend manually\r\n        if (!out.sizeLegend.values) {\r\n            out.sizeLegend.values = [domain[1], domain[0]] // default to min and max values\r\n        }\r\n\r\n        let length = out.sizeLegend.values.length\r\n        if (!length || length < 2) {\r\n            console.warn('eurostat-map: sizeLegend.values length must be at least 2')\r\n            length = 2\r\n        }\r\n        for (let i = 1; i < length + 1; i++) {\r\n            // define class number\r\n            // define raw value\r\n            const val = out.sizeLegend.values[i - 1]\r\n            // calculate shape size\r\n            const symbolSize = map.classifierSize_(val)\r\n\r\n            if (map.psShape_ === 'bar') {\r\n                buildBarsItem(out, val, symbolSize, i, labelFormatter)\r\n            } else if (map.psShape_ === 'custom' || map.psCustomSVG_) {\r\n                buildCustomSVGItem(out, val, symbolSize, i, labelFormatter)\r\n            } else {\r\n                buildD3SymbolItem(out, val, symbolSize, i, labelFormatter)\r\n            }\r\n        }\r\n    }\r\n\r\n    // append No Data after all size-legend content is in the container\r\n    if (out.sizeLegend.noData) addNoDataLegend(out)\r\n}\r\n\r\nfunction addNoDataLegend(out) {\r\n    const bbox = out._sizeLegendContainer.node().getBBox()\r\n    const paddings = {\r\n        default: 20,\r\n        bar: 35,\r\n        spike: 1,\r\n        circle: 1,\r\n        square: 20,\r\n    } // add some extra padding for bars and spikes\r\n    const padding = paddings[out.map.psShape_] || paddings['default']\r\n    const noDataHeight = out.noDataShapeHeight\r\n    const y = bbox.height + padding + noDataHeight / 2 // padding after the size legend\r\n    const x = 0\r\n    const container = out._sizeLegendContainer.append('g').attr('class', 'em-no-data-legend').attr('transform', `translate(${x},${y})`)\r\n    out.appendNoDataLegend(container, out.sizeLegend.noDataText, highlightPsRegions, unhighlightPsRegions)\r\n}\r\n\r\n/**\r\n * @description\r\n * @param {*} m\r\n * @param {*} value\r\n * @param {*} symbolSize\r\n * @param {*} index\r\n * @param {*} labelFormatter\r\n */\r\nfunction buildCustomSVGItem(out, value, symbolSize, index, labelFormatter) {\r\n    const map = out.map\r\n\r\n    if (out.sizeLegend._cursorY == null) {\r\n        out.sizeLegend._cursorY = out.boxPadding + (out.sizeLegend.title ? out.sizeLegend.titlePadding : 0)\r\n    }\r\n\r\n    const maxSize = map.classifierSize_(map.classifierSize_.domain()[1])\r\n    const symbolColumnX = out.boxPadding + maxSize\r\n    const y = out.sizeLegend._cursorY\r\n\r\n    // Row container\r\n    const itemContainer = out._sizeLegendContainer\r\n        .append('g')\r\n        .attr('class', 'em-size-legend-item')\r\n        .attr('transform', `translate(${symbolColumnX},${y})`)\r\n\r\n    // Symbol wrapper\r\n    const symbolGroup = itemContainer\r\n        .append('g')\r\n        .attr('class', 'em-size-legend-symbol')\r\n        .style('fill', map.classifierColor_ ? out.sizeLegend.shapeFill : map.psFill_)\r\n        .style('fill-opacity', map.psFillOpacity())\r\n        .style('stroke', out.sizeLegend.shapeStroke || map.psStroke())\r\n        .style('stroke-width', out.sizeLegend.shapeStrokeWidth || map.psStrokeWidth())\r\n\r\n    // SVG content\r\n    const svgGroup = symbolGroup.append('g').html(map.psCustomSVG_).attr('transform', `scale(${symbolSize})`)\r\n\r\n    //  Measure rendered symbol\r\n    const bbox = svgGroup.node().getBBox()\r\n\r\n    //  CENTER X AND Y RELATIVE TO ROW CENTER\r\n    svgGroup.attr('transform', `translate(${-bbox.x - bbox.width / 2},${-bbox.y - bbox.height / 2}) scale(${symbolSize})`)\r\n\r\n    // Label aligned to same row center\r\n    const labelX = symbolColumnX + map.classifierSize_(map.classifierSize_.domain()[0]) + out.sizeLegend.labelOffsets.x\r\n\r\n    const labelY = 0\r\n\r\n    itemContainer.append('text').attr('class', 'em-legend-label').attr('dy', '0.35em').attr('x', labelX).attr('y', labelY).text(labelFormatter(value))\r\n\r\n    // Advance cursor by FULL row height\r\n    const h = itemContainer.node().getBBox().height\r\n    out.sizeLegend._cursorY += h + out.sizeLegend.shapePadding\r\n}\r\n\r\n/**\r\n * @description\r\n * @param {*} m\r\n * @param {*} symbolSize\r\n */\r\nfunction buildBarsItem(out, value, symbolSize, index, labelFormatter) {\r\n    const map = out.map\r\n\r\n    // init stacking cursor\r\n    if (out.sizeLegend._cursorY == null) {\r\n        out.sizeLegend._cursorY = out.boxPadding + (out.sizeLegend.title ? out.sizeLegend.titlePadding : 0)\r\n    }\r\n\r\n    const x = out.boxPadding // bars start from the left\r\n    const y = out.sizeLegend._cursorY + out.sizeLegend.shapePadding\r\n\r\n    // make bar path (height  symbolSize because size() gets area = symbolSize^2)\r\n    const shape = getShape(out)\r\n    const d = shape.size(symbolSize * symbolSize)()\r\n\r\n    // container for one bar + label\r\n    const itemContainer = out._sizeLegendContainer.append('g').attr('class', 'em-size-legend-item').attr('transform', `translate(${x},${y})`)\r\n\r\n    // draw bar\r\n    itemContainer\r\n        .append('g')\r\n        .style('fill', map.classifierColor_ ? out.sizeLegend.shapeFill : map.psFill_)\r\n        .style('fill-opacity', map.psFillOpacity())\r\n        .style('stroke', out.sizeLegend.shapeStroke ? out.sizeLegend.shapeStroke : map.psStroke())\r\n        .style('stroke-width', out.sizeLegend.shapeStrokeWidth || map.psStrokeWidth())\r\n        .append('path')\r\n        .attr('d', d)\r\n        .attr('transform', `translate(${out.sizeLegend.shapeOffsets.x},${out.sizeLegend.shapeOffsets.y})`)\r\n\r\n    // label (to the right, vertically centered)\r\n    const labelX = x + map.psBarWidth_ + out.sizeLegend.labelOffsets.x\r\n    const labelY = symbolSize / 2 + out.sizeLegend.labelOffsets.y\r\n\r\n    itemContainer.append('text').attr('class', 'em-legend-label').attr('dy', '0.35em').attr('x', labelX).attr('y', labelY).text(labelFormatter(value))\r\n\r\n    // advance stacking cursor by actual rendered height\r\n    const hb = itemContainer.node().getBBox().height\r\n    out.sizeLegend._cursorY += hb + out.sizeLegend.shapePadding\r\n}\r\n\r\n/**\r\n * @description returns the d3.symbol object chosen by the user\r\n * @return {d3.shape || SVG}\r\n */\r\nfunction getShape(out) {\r\n    const map = out.map\r\n    let shape\r\n    if (map.psCustomSVG_) {\r\n        shape = map.psCustomSVG_\r\n    } else if (map.psCustomShape_) {\r\n        shape = map.psCustomShape_\r\n    } else if (map.psShape_ == 'bar') {\r\n        //for rectangles, we use a custom d3 symbol\r\n        let drawRectangle = (context, size) => {\r\n            let height = Math.sqrt(size)\r\n            context.moveTo(0, 0)\r\n            context.lineTo(0, height)\r\n            context.lineTo(map.psBarWidth_, height)\r\n            context.lineTo(map.psBarWidth_, 0)\r\n            context.lineTo(0, 0)\r\n            context.closePath()\r\n        }\r\n        shape = symbol().type({ draw: drawRectangle })\r\n    } else {\r\n        let symbolType = symbolsLibrary[map.psShape_] || symbolsLibrary['circle']\r\n        shape = symbol().type(symbolType)\r\n    }\r\n    return shape\r\n}\r\n\r\nfunction highlightPsRegions(map, ecl) {\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    // Set all symbols to visible\r\n    allSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', '0')\r\n    })\r\n\r\n    // Highlight only the selected regions by restoring their original opacity\r\n    const selectedSymbols = allSymbols.filter(\"[ecl='\" + ecl + \"']\")\r\n    selectedSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', map.psFillOpacity_) // Restore original opacity for selected regions\r\n    })\r\n}\r\n\r\n// Reset all regions to their original opacitys on mouseout\r\nfunction unhighlightPsRegions(map) {\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    // Restore each region's original opacity from the fill___ attribute\r\n    allSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', map.psFillOpacity_) // Restore original opacity for selected regions\r\n    })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport * as Legend from '../legend'\r\nimport { appendPatternFillLegend } from '../legend-pattern-fill'\r\nimport { drawSizeLegend } from './legend-symbol-size'\r\nimport { drawDiscreteLegend } from '../legend-discrete'\r\nimport { format } from 'd3-format'\r\n\r\n/**\r\n * A legend for proportional symbol map\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    //size legend config (legend illustrating the values of different symbol sizes)\r\n    out.sizeLegend = {\r\n        title: null,\r\n        titlePadding: 15, //padding between title and legend body\r\n        values: undefined, //manually define raw data values\r\n        cellNb: 3, //number of elements in the legend\r\n        shapePadding: 15, //the y distance between consecutive legend shape elements\r\n        shapeOffsets: { x: 0, y: 0 },\r\n        shapeFill: 'white',\r\n        shapeStroke: null,\r\n        shapeStrokeWidth: null,\r\n        labelOffsets: { x: 10, y: 0 }, //the distance between the legend box elements to the corresponding text label\r\n        decimals: 0, //the number of decimal for the legend labels\r\n        labelFormatter: undefined,\r\n        labels: null, // user-defined labels for each size\r\n        noData: false, // show no data legend item\r\n        noDataText: 'No data', //no data text label\r\n        _totalBarsHeight: 0,\r\n        _totalD3SymbolsHeight: 0,\r\n    }\r\n\r\n    // color legend config (legend illustrating the data-driven colour classes)\r\n    out.colorLegend = {\r\n        title: null,\r\n        titlePadding: 10, //padding between title and legend body\r\n        marginTop: 30, // margin top (distance between color and size legend)\r\n        shapeWidth: 25, //the width of the legend box elements\r\n        shapeHeight: 20, //the height of the legend box elements\r\n        shapePadding: 1, //the distance between consecutive legend shape elements in the color legend\r\n        labelOffsets: { x: 5, y: 0 }, //distance (x) between label text and its corresponding shape element\r\n        decimals: 0, //the number of decimal for the legend labels\r\n        labelFormatter: undefined, // user-defined d3 format function\r\n        labelType: 'thresholds', // type of labels to show: thresholds or ranges\r\n        labels: null, // user-defined labels for each class\r\n        noData: true, //show no data\r\n        noDataText: 'No data', //no data text label\r\n        sepLineLength: 24, // //the separation line length\r\n        sepLineStroke: 'black', //the separation line color\r\n        sepLineStrokeWidth: 1, //the separation line width\r\n        tickLength: 5, // threshold ticks length in px\r\n        //diverging line for diverging color legends\r\n        pointOfDivergenceLabel: undefined,\r\n        pointOfDivergence: undefined,\r\n        pointOfDivergencePadding: 7,\r\n        divergingLineLength: undefined,\r\n        divergingArrowLength: undefined,\r\n    }\r\n\r\n    //override attribute values with config values\r\n    if (config)\r\n        for (let key in config) {\r\n            if (key == 'colorLegend' || key == 'sizeLegend') {\r\n                for (let p in out[key]) {\r\n                    //override each property in size and color legend configs\r\n                    if (config[key][p] !== undefined) {\r\n                        out[key][p] = config[key][p]\r\n                    }\r\n                }\r\n                if (config.colorLegend == false) out.colorLegend = false\r\n            } else {\r\n                out[key] = config[key]\r\n            }\r\n        }\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        if (out.lgg.node()) {\r\n            const lgg = out.lgg\r\n\r\n            //remove previous content\r\n            lgg.selectAll('*').remove()\r\n\r\n            //draw legend background box\r\n            out.makeBackgroundBox()\r\n            if (out.title) out.addTitle()\r\n            if (out.subtitle) out.addSubtitle()\r\n\r\n            // reset height counters\r\n            out.sizeLegend._totalBarsHeight = 0\r\n            out.sizeLegend._totalD3SymbolsHeight = 0\r\n\r\n            // initial x and y positions for the internal legend elements\r\n            const baseY = out.getBaseY()\r\n            const baseX = out.getBaseX()\r\n\r\n            // legend for size\r\n            if (map.classifierSize_) {\r\n                drawSizeLegend(out, baseX, baseY)\r\n            }\r\n            if (map.classifierColor_ && out.colorLegend) {\r\n                let x = baseX\r\n                let y = baseY\r\n                if (out._sizeLegendContainer) {\r\n                    // position it below size legend ( + out.colorLegend.marginTop)\r\n                    y += out._sizeLegendContainer.node().getBBox().height + out.colorLegend.marginTop\r\n                }\r\n                drawDiscreteLegend(out, x, y)\r\n            }\r\n\r\n            // Append pattern fill legend items BELOW the main legend\r\n            if (out.map.patternFill_) {\r\n                const legendHeight = out.lgg.node().getBBox().height\r\n                const patternContainer = out.lgg\r\n                    .append('g')\r\n                    .attr('class', 'pattern-fill-legend')\r\n                    .attr('transform', `translate(${baseX}, ${legendHeight + out.boxPadding + 5})`)\r\n                appendPatternFillLegend(out, patternContainer)\r\n            }\r\n\r\n            //set legend box dimensions\r\n            out.setBoxDimension()\r\n        }\r\n    }\r\n\r\n    return out\r\n}\r\n\r\nfunction getColorThresholds(out) {\r\n    const map = out.map\r\n    const thresholds =\r\n        map.psThresholds_.length > 1\r\n            ? map.psThresholds_\r\n            : Array.from({ length: map.psClasses_ })\r\n                .map((_, index) => {\r\n                    return map.classifier().invertExtent(index)[out.ascending ? 0 : 1]\r\n                })\r\n                .slice(1) // Remove the first entry and return the rest as an array\r\n    return thresholds\r\n}\r\n\r\nexport function getPropSymbolColorLabelFormatter(out) {\r\n    if (out.colorLegend.labelType == 'ranges') {\r\n        const thresholds = getColorThresholds(out)\r\n        const defaultLabeller = (label, i) => {\r\n            const decimalFormatter = format(`.${out.decimals}f`)\r\n            if (i === 0) return `> ${decimalFormatter(thresholds[thresholds.length - 1])}` //top\r\n            if (i === thresholds.length) return `< ${decimalFormatter(thresholds[0])}` //bottom\r\n            return `${decimalFormatter(thresholds[thresholds.length - i - 1])} - < ${decimalFormatter(thresholds[thresholds.length - i])}  ` //in-between\r\n        }\r\n        return out.colorLegend.labelFormatter || defaultLabeller\r\n    } else if (out.colorLegend.labelType == 'thresholds') {\r\n        return out.colorLegend.labelFormatter || format(`.${out.decimals}f`)\r\n    } else {\r\n        return out.colorLegend.labelFormatter || format(`.${out.decimals}f`)\r\n    }\r\n}\r\n\r\n// Highlight selected regions on mouseover\r\nexport function highlightPsSymbols(map, ecl) {\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    // Set all symbols to visible\r\n    allSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', '0')\r\n    })\r\n\r\n    // Highlight only the selected regions by restoring their original opacity\r\n    const selectedSymbols = allSymbols.filter(\"[ecl='\" + ecl + \"']\")\r\n    selectedSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', map.psFillOpacity_) // Restore original opacity for selected regions\r\n    })\r\n}\r\n\r\n// Reset all regions to their original opacitys on mouseout\r\nexport function unhighlightPsSymbols(map) {\r\n    const allSymbols = map.getCentroidsGroup(map).selectAll('[ecl]')\r\n\r\n    // Restore each region's original opacity from the fill___ attribute\r\n    allSymbols.each(function (d, i) {\r\n        let symbol = select(this)\r\n        symbol.style('opacity', map.psFillOpacity_) // Restore original opacity for selected regions\r\n    })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { executeForAllInsets, getFontSizeFromClass, getLegendRegionsSelector } from '../core/utils'\r\nimport { formatDefaultLocale } from 'd3-format'\r\nimport { getChoroplethLabelFormatter, highlightRegions, unhighlightRegions } from './choropleth/legend-choropleth'\r\nimport { getPropSymbolColorLabelFormatter, highlightPsSymbols, unhighlightPsSymbols } from './proportional-symbol/legend-proportional-symbols'\r\n\r\n/**\r\n * A eurostat-map legend. This is an abstract method.\r\n */\r\nexport const legend = function (map) {\r\n    //build legend object\r\n    const out = {}\r\n\r\n    //link map to legend\r\n    out.map = map\r\n\r\n    //the SVG where to make the legend\r\n    out.svgId = 'em-legend-container-' + Math.round(10e4 * Math.random())\r\n    out.svg = undefined\r\n    out.lgg = undefined\r\n\r\n    //the legend element position, in case it is embeded within the map SVG\r\n    out.x = undefined\r\n    out.y = undefined\r\n\r\n    //the legend box\r\n    out.boxPadding = 7\r\n    out.boxOpacity = 0.7\r\n\r\n    //legend title\r\n    out.title = ''\r\n    // we now use CSS instead of inline styles\r\n    out.titleFontSize = getFontSizeFromClass('em-legend-title')\r\n    // width\r\n    out.width = 150\r\n    //padding between title and body\r\n    out.titlePadding = 5\r\n    //the width of the legend box elements\r\n    out.shapeWidth = 25\r\n    //the height of the legend box elements\r\n    out.shapeHeight = 20\r\n    //the distance between consecutive legend shape elements\r\n    out.shapePadding = 5\r\n\r\n    // we now use CSS instead of inline styles\r\n    out.labelFontSize = getFontSizeFromClass('em-legend-label')\r\n    //the distance between the legend box elements to the corresponding text label\r\n    out.labelOffsets = { x: 5, y: 5 }\r\n    //labelFormatter function\r\n    out.labelFormatter = null\r\n    //set legend labels locale\r\n    formatDefaultLocale({\r\n        decimal: '.',\r\n        thousands: ' ',\r\n        grouping: [3],\r\n        currency: ['', ''],\r\n    })\r\n\r\n    //show no data\r\n    out.noData = true\r\n    //no data label text\r\n    out.noDataText = 'No data'\r\n    //gap between legend and 'no data' legend\r\n    out.noDataPadding = 5\r\n    out.noDataShapeWidth = 25\r\n    out.noDataShapeHeight = 20\r\n\r\n    //the order of the legend elements where applicable. Set to false to invert.\r\n    out.ascending = true\r\n    out.decimals = 0\r\n\r\n    out.maxMin = true // show max/min values in legends where applicable\r\n    out.maxMinLabels = ['', ''] // Labels for max and min if maxMin is true\r\n\r\n    /** Build legend. */\r\n    out.build = function () {\r\n        //set SVG element and add main drawing group\r\n        out.svg = select('#' + out.svgId)\r\n        // clear previous legend(s)\r\n        out.svg.selectAll('*').remove()\r\n        // append new legend group\r\n        out.lgg = out.svg\r\n            // .append('g')\r\n            // .attr('id', 'em-legend-' + out.svgId)\r\n            .attr('class', 'em-legend')\r\n    }\r\n\r\n    /**\r\n     * Update the legend element.\r\n     * This is an abstract method to be defined for each specific legend.\r\n     */\r\n    out.update = function () {\r\n        console.log('Legend update function not implemented')\r\n        return out\r\n    }\r\n\r\n    out.updateContainer = function () {\r\n        const map = out.map\r\n        const container = out.lgg\r\n        // Remove previous content\r\n        container.selectAll('*').remove()\r\n\r\n        //check if provided external svgId has changed\r\n        const legendSVG = out.svg\r\n        if (map && container && legendSVG && legendSVG?.attr('id') !== map.legend_.svgId) {\r\n            out.build() // sets new svg and lgg\r\n        }\r\n\r\n        //position legend\r\n        if (out.x != null || out.y != null) {\r\n            const x = out.x ?? map.width() - out.width - out.boxPadding\r\n            const y = out.y ?? out.boxPadding\r\n            out.lgg.attr('transform', `translate(${x},${y})`)\r\n        }\r\n    }\r\n\r\n    out.updateConfig = function () {\r\n        const map = out.map\r\n        // Update legend parameters if necessary\r\n        if (map.legend_) {\r\n            deepMergeExistingKeys(out, map.legend_)\r\n        }\r\n    }\r\n\r\n    /** Draw legend background box */\r\n    out.makeBackgroundBox = function () {\r\n        out.lgg.append('rect').attr('id', 'em-legend-background').attr('class', 'em-legend-background').style('opacity', out.boxOpacity)\r\n    }\r\n\r\n    out.addTitle = function () {\r\n        if (out.title) {\r\n            const titlesContainer = out.lgg.append('g').attr('id', 'em-legend-titles')\r\n            let cssFontSize = getFontSizeFromClass('em-legend-title')\r\n            titlesContainer\r\n                .append('text')\r\n                .attr('class', 'em-legend-title')\r\n                .attr('x', out.boxPadding)\r\n                .attr('y', out.boxPadding + cssFontSize)\r\n                .text(out.title)\r\n        }\r\n    }\r\n\r\n    out.addSubtitle = function () {\r\n        if (out.subtitle) {\r\n            const titlesContainer = out.lgg.select('#em-legend-titles')\r\n            let titleFontSize = getFontSizeFromClass('em-legend-title')\r\n            let subtitleFontSize = getFontSizeFromClass('em-legend-subtitle')\r\n            titlesContainer\r\n                .append('text')\r\n                .attr('class', 'em-legend-subtitle')\r\n                .attr('x', out.boxPadding)\r\n                .attr('y', out.boxPadding + titleFontSize + subtitleFontSize + 3) // 3px padding after title\r\n                .html(out.subtitle)\r\n        }\r\n    }\r\n\r\n    // get the initial y position for the legend elements within the legend box (boxPadding + titles + padding)\r\n    out.getBaseY = function () {\r\n        return (\r\n            out.boxPadding +\r\n            (out.title ? getFontSizeFromClass('em-legend-title') : 0) +\r\n            (out.subtitle ? getFontSizeFromClass('em-legend-subtitle') : 0) +\r\n            10\r\n        )\r\n    }\r\n    out.getBaseX = function () {\r\n        return out.boxPadding\r\n    }\r\n\r\n    /** Set legend box dimensions, ensuring it has suitable dimensions to fit to all legend graphic elements */\r\n    out.setBoxDimension = function () {\r\n        if (out.lgg.node()) {\r\n            //get legend elements bounding box\r\n            const bb = out.lgg.node().getBBox({ stroke: true })\r\n            //apply to legend box dimensions\r\n            const p = out.boxPadding\r\n            out.svg\r\n                .select('#em-legend-background')\r\n                .attr('x', bb.x - p)\r\n                .attr('y', bb.y - p) // -2 to account for the title height\r\n                .attr('width', bb.width + 2 * p)\r\n                .attr('height', bb.height + 2 * p)\r\n        }\r\n    }\r\n\r\n    //'no data' legend box\r\n    out.appendNoDataLegend = function (container, noDataText, highlightRegions, unhighlightRegions) {\r\n        const map = out.map\r\n\r\n        //append symbol & style\r\n        container\r\n            .append('rect')\r\n            .attr('class', 'em-legend-rect')\r\n            .style('fill', map.noDataFillStyle())\r\n            .attr('y', out.noDataPadding)\r\n            .attr('width', out.noDataShapeWidth)\r\n            .attr('height', out.noDataShapeHeight)\r\n            .on('mouseover', function () {\r\n                highlightRegions(map, 'nd')\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, highlightRegions, 'nd')\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightRegions(map)\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, unhighlightRegions, 'nd')\r\n                }\r\n            })\r\n\r\n        //'no data' label\r\n        container\r\n            .append('text')\r\n            .attr('class', 'em-legend-label em-legend-label-no-data')\r\n            .attr('dy', '0.35em') // ~vertical centering\r\n            .attr('x', out.noDataShapeWidth + 5)\r\n            .attr('y', out.noDataShapeHeight / 2 + out.noDataPadding)\r\n            .style('pointer-events', 'all')\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function () {\r\n                highlightRegions(map, 'nd')\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, highlightRegions, 'nd')\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightRegions(map)\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId, unhighlightRegions, 'nd')\r\n                }\r\n            })\r\n            .text(noDataText)\r\n    }\r\n\r\n    out.getNumberOfClasses = function (out) {\r\n        const map = out.map\r\n        const mapType = map._mapType\r\n        const numberOfClasses = mapType === 'ps' ? map.psClasses_ : map.numberOfClasses_ //prop symbols or choropleth\r\n        return numberOfClasses\r\n    }\r\n\r\n    out.getLabelFormatter = function (out) {\r\n        const map = out.map\r\n        const mapType = map._mapType\r\n        const labelFormatter = mapType === 'ps' ? getPropSymbolColorLabelFormatter(out) : getChoroplethLabelFormatter(out)\r\n        return labelFormatter\r\n    }\r\n\r\n    out.getClassToFillStyle = function (out) {\r\n        const map = out.map\r\n        const mapType = map._mapType\r\n        const classToFillStyle = mapType === 'ps' ? map.psClassToFillStyle_ : map.classToFillStyle_\r\n        return classToFillStyle\r\n    }\r\n\r\n    out.getColorClassifier = function (out) {\r\n        const map = out.map\r\n        const mapType = map._mapType\r\n        const colorClassifier = mapType === 'ps' ? map.classifierColor_ : map.classifier_\r\n        return colorClassifier\r\n    }\r\n\r\n    out.getColorStats = function (out) {\r\n        const map = out.map\r\n        const mapType = map._mapType\r\n        const stats = mapType === 'ps' ? map.statData('color') : map.statData()\r\n        return stats\r\n    }\r\n\r\n    out.getHighlightFunction = function (map) {\r\n        if (map._mapType == 'ps') return highlightPsSymbols\r\n        return highlightRegions\r\n    }\r\n\r\n    out.getUnHighlightFunction = function (map) {\r\n        if (map._mapType == 'ps') return unhighlightPsSymbols\r\n        return unhighlightRegions\r\n    }\r\n\r\n    //It performs a shallow copy  nested objects will be copied by reference, not duplicated.\r\n    //It modifies the target object (out) in place.\r\n    //Useful for merging objects or extending existing ones.\r\n    function deepMergeExistingKeys(target, source, options = {}, seen = new WeakSet(), depth = 0) {\r\n        const MAX_DEPTH = options.maxDepth || 100\r\n\r\n        if (seen.has(target)) return target\r\n        seen.add(target)\r\n\r\n        if (depth > MAX_DEPTH) {\r\n            console.warn(`Max recursion depth (${MAX_DEPTH}) reached.`)\r\n            return target\r\n        }\r\n\r\n        for (const key in source) {\r\n            if (source.hasOwnProperty(key) && target.hasOwnProperty(key)) {\r\n                const sourceVal = source[key]\r\n                const targetVal = target[key]\r\n\r\n                // Handle functions: overwrite directly\r\n                if (typeof sourceVal === 'function') {\r\n                    target[key] = sourceVal\r\n\r\n                    // Handle nested plain objects\r\n                } else if (isPlainObject(sourceVal) && isPlainObject(targetVal)) {\r\n                    deepMergeExistingKeys(targetVal, sourceVal, options, seen, depth + 1)\r\n\r\n                    // Handle arrays: overwrite (or merge if option set)\r\n                } else if (Array.isArray(sourceVal) && Array.isArray(targetVal)) {\r\n                    target[key] = options.mergeArrays ? [...new Set([...targetVal, ...sourceVal])] : [...sourceVal]\r\n\r\n                    // Handle Dates\r\n                } else if (sourceVal instanceof Date) {\r\n                    target[key] = new Date(sourceVal.getTime())\r\n\r\n                    // Handle RegExp\r\n                } else if (sourceVal instanceof RegExp) {\r\n                    target[key] = new RegExp(sourceVal)\r\n\r\n                    // Handle Map and Set\r\n                } else if (sourceVal instanceof Map) {\r\n                    target[key] = new Map(sourceVal)\r\n                } else if (sourceVal instanceof Set) {\r\n                    target[key] = new Set(sourceVal)\r\n\r\n                    // Overwrite primitives and other types\r\n                } else {\r\n                    target[key] = sourceVal\r\n                }\r\n            }\r\n        }\r\n\r\n        return target\r\n    }\r\n\r\n    // Helper to check for plain objects\r\n    function isPlainObject(value) {\r\n        return Object.prototype.toString.call(value) === '[object Object]'\r\n    }\r\n\r\n    return out\r\n}\r\n","import { select } from 'd3-selection'\r\n\r\n/**\r\n * @param {*} config\r\n * @returns\r\n */\r\nexport const tooltip = function (config) {\r\n    config = config || {}\r\n\r\n    config.containerId = config.containerId || config.svgId || 'map' // the maximum bounds of the tooltip\r\n    config.id = config.id || `em-tooltip-${config.containerId}` // id of the tooltip div\r\n    config.offset = {\r\n        x: config.offset?.x || config.xOffset || 30, // x offset of the tooltip\r\n        y: config.offset?.y || config.yOffset || 20, // y offset of the tooltip\r\n    }\r\n    config.transitionDuration = 0\r\n    config.opacity = config.opacity || 1\r\n\r\n    let tooltip\r\n\r\n    function my() {\r\n        tooltip = select('#' + config.id)\r\n        if (tooltip.empty()) {\r\n            tooltip = select('body').append('div').attr('id', config.id)\r\n        }\r\n        tooltip.attr('class', 'em-tooltip')\r\n    }\r\n\r\n    my.mouseover = function (html) {\r\n        tooltip.html(html)\r\n        if (html) {\r\n            let x = event.pageX\r\n            let y = event.pageY\r\n            my.ensureTooltipOnScreen(x, y)\r\n            // Fade in\r\n            tooltip\r\n                .interrupt() // cancel ongoing transitions\r\n                .transition()\r\n                .duration(config.transitionDuration) // fade\r\n                .style('opacity', config.opacity)\r\n        }\r\n    }\r\n\r\n    my.mousemove = function (event) {\r\n        let x = event.pageX\r\n        let y = event.pageY\r\n        this.ensureTooltipOnScreen(x, y)\r\n    }\r\n\r\n    my.mouseout = function () {\r\n        // Fade out\r\n        tooltip.interrupt().transition().duration(config.transitionDuration).style('opacity', 0)\r\n    }\r\n\r\n    my.style = function (k, v) {\r\n        if (arguments.length == 1) return tooltip.style(k)\r\n        tooltip.style(k, v)\r\n        return my\r\n    }\r\n\r\n    my.attr = function (k, v) {\r\n        if (arguments.length == 1) return tooltip.attr(k)\r\n        tooltip.attr(k, v)\r\n        return my\r\n    }\r\n\r\n    /**\r\n     * @function ensureTooltipOnScreen\r\n     * @description Prevents the tooltip from overflowing off screen\r\n     */\r\n    my.ensureTooltipOnScreen = function (eventX, eventY) {\r\n        let node = tooltip.node()\r\n\r\n        node.style.left = eventX + config.offset.x + 'px'\r\n        node.style.top = eventY - config.offset.y + 'px'\r\n\r\n        let parent = document.getElementById(config.containerId)\r\n        let rect = parent.getBoundingClientRect() // get the bounding rectangle\r\n        let parentWidth = rect.width\r\n        let parentHeight = rect.height\r\n\r\n        //too far right\r\n        //taking into account off screen space but shouldnt be\r\n        if (node.offsetLeft > rect.left + parentWidth - node.clientWidth) {\r\n            let left = eventX - node.clientWidth - config.offset.x\r\n            node.style.left = left + 'px'\r\n            // check if mouse covers tooltip\r\n            if (node.offsetLeft + node.clientWidth > eventX) {\r\n                //move tooltip left so it doesnt cover mouse\r\n                let left2 = eventX - node.clientWidth - config.offset.x\r\n                node.style.left = left2 + 'px'\r\n            }\r\n            // node.style.top = node.offsetTop + config.offset.y + \"px\";\r\n        }\r\n\r\n        //too far down\r\n        if (node.offsetTop + node.clientHeight > rect.top + parentHeight) {\r\n            node.style.top = node.offsetTop - node.clientHeight + 'px'\r\n        }\r\n    }\r\n\r\n    my()\r\n    return my\r\n}\r\n","const OVERLAY_ID = \"em-loading-overlay\";\r\n\r\nfunction createOverlay(wrapper) {\r\n    if (!wrapper) return null;\r\n\r\n    let overlay = wrapper.querySelector(`#${OVERLAY_ID}`);\r\n    if (overlay) return overlay;\r\n\r\n    overlay = document.createElement(\"div\");\r\n    overlay.id = OVERLAY_ID;\r\n    overlay.classList.add(\"is-hidden\");\r\n    overlay.setAttribute(\"aria-hidden\", \"true\");\r\n\r\n    overlay.innerHTML = `\r\n        <div class=\"em-spinner-stack\" role=\"status\" aria-live=\"polite\">\r\n            <div class=\"em-loading-spinner\" aria-hidden=\"true\"></div>\r\n            <div class=\"em-loading-label\">Loading</div>\r\n        </div>\r\n    `;\r\n\r\n    wrapper.appendChild(overlay);\r\n    return overlay;\r\n}\r\n\r\nexport function showSpinner(wrapper, label = \"Loading\") {\r\n    const overlay = createOverlay(wrapper);\r\n    if (!overlay) return;\r\n\r\n    const lbl = overlay.querySelector(\".em-loading-label\");\r\n    if (lbl) lbl.textContent = label;\r\n\r\n    overlay.classList.remove(\"is-hidden\");\r\n    overlay.setAttribute(\"aria-hidden\", \"false\");\r\n}\r\n\r\nexport function hideSpinner(wrapper) {\r\n    if (!wrapper) return;\r\n\r\n    const overlay = wrapper.querySelector(`#${OVERLAY_ID}`);\r\n    if (!overlay) return;\r\n\r\n    overlay.classList.add(\"is-hidden\");\r\n    overlay.setAttribute(\"aria-hidden\", \"true\");\r\n}\r\n","import { getDownloadURL, executeForAllInsets, applyComputedStylesToSVG, ensureSvgSize } from './utils'\r\nimport * as MapTemplate from './map-template'\r\nimport * as StatisticalData from './stat-data'\r\nimport * as Legend from '../legend/legend'\r\nimport { select } from 'd3-selection'\r\nimport * as tp from '../tooltip/tooltip'\r\nimport { hideSpinner, showSpinner } from './spinner'\r\n\r\n/**\r\n * An abstract statistical map: A map template with statistical data, without any particular styling rule.\r\n *\r\n * @param {*} withCenterPoints Set to true (or 1) to add regions center points to the map template, to be used for proportional symbols maps for example.\r\n */\r\nexport const statMap = function (config, withCenterPoints, mapType) {\r\n    //build stat map from map template\r\n    const out = MapTemplate.mapTemplate(config, withCenterPoints, mapType)\r\n\r\n    // build-completion latch\r\n    out._geoDone_ = false\r\n    out._statDone_ = false\r\n    out._finalized_ = false\r\n\r\n    const tryFinalize = function () {\r\n        if (out._finalized_) return\r\n        if (!out._geoDone_ || !out._statDone_) return\r\n        out._finalized_ = true\r\n        if (out.callback()) out.callback()(out)\r\n    }\r\n\r\n    // render scheduling flag\r\n    let _renderScheduled = false\r\n    out._loadingStatCount_ = 0\r\n\r\n    //the statistical data configuration.\r\n    //A map can have several stat datasets. This is a dictionary of all stat configuration\r\n    out.stat_ = { default: undefined }\r\n    out.stat = function (k, v) {\r\n        //no argument: getter - return the default stat\r\n        if (!arguments.length) return out.stat_['default']\r\n        //two arguments: setter - set the config k with value v\r\n        if (arguments.length == 2) {\r\n            out.stat_[k] = v\r\n            return out\r\n        }\r\n        //one string argument: getter - return the config k\r\n        if (typeof k === 'string' || k instanceof String) return out.stat_[k]\r\n        //one non-string argument: setter - set the entire dictionnary\r\n        out.stat_ = k.default ? k : { default: k }\r\n        return out\r\n    }\r\n\r\n    //the statistical data, retrieved from the config information. As a dictionary.\r\n    out.statData_ = {\r\n        default: StatisticalData.statData(),\r\n        color: StatisticalData.statData(),\r\n        size: StatisticalData.statData(),\r\n        v1: StatisticalData.statData(),\r\n        v2: StatisticalData.statData(), //bivariate\r\n        v3: StatisticalData.statData(), //trivariate\r\n    }\r\n    out.statData = function (k, v) {\r\n        if (!arguments.length) return out.statData_['default']\r\n\r\n        // lazy create if not exist\r\n        if (arguments.length === 1) {\r\n            if (!out.statData_[k]) out.statData_[k] = StatisticalData.statData()\r\n            return out.statData_[k]\r\n        }\r\n\r\n        // setter\r\n        out.statData_[k] = v\r\n        return out\r\n    }\r\n\r\n    //test for no data case\r\n    out.noDataText_ = 'No data available'\r\n    //langage (currently used only for eurostat data API)\r\n    out.language_ = 'en'\r\n    //transition time for rendering\r\n    out.transitionDuration_ = 500\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = undefined\r\n    //for maps using special fill patterns, this is the function to define them in the SVG image - See functions: getFillPatternLegend and getFillPatternDefinitionFun\r\n    out.filtersDefinitionFunction_ = undefined\r\n    //a callback function to execute after the map build is complete.\r\n    out.callback_ = undefined\r\n\r\n    //legend configuration\r\n    out.legend_ = undefined\r\n    //legend object\r\n    out.legendObj_ = undefined\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    ;['legend_', 'legendObj_', 'noDataText_', 'language_', 'transitionDuration_', 'tooltipText_', 'filtersDefinitionFunction_', 'callback_'].forEach(\r\n        function (att) {\r\n            out[att.substring(0, att.length - 1)] = function (v) {\r\n                if (!arguments.length) return out[att]\r\n                out[att] = v\r\n                return out\r\n            }\r\n        }\r\n    )\r\n\r\n    //override attribute values with config values\r\n    if (config) for (let key in config) if (out[key] && config[key] != undefined) out[key](config[key])\r\n\r\n    // override legend for updating after build\r\n    out.legend = function (v) {\r\n        if (!arguments.length) return out.legend_\r\n\r\n        // clear existing legend\r\n        if (v == false) {\r\n            const legend = out.legendObj()\r\n            if (legend) {\r\n                const legendSvg = select('#' + legend.svgId)\r\n                if (legendSvg.size() > 0) {\r\n                    legendSvg.selectAll('*').remove()\r\n                }\r\n            }\r\n            out.legend_ = v\r\n            return out\r\n        }\r\n        //set new legend config\r\n        out.legend_ = v\r\n        //update if existing legend\r\n        if (out.legendObj_) out.updateLegend()\r\n        return out\r\n    }\r\n\r\n    out.updateLegend = function (v) {\r\n        if (out.legendObj_) out.legendObj().update()\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Build the map.\r\n     * This method should be called once, preferably after the map attributes have been set to some initial values.\r\n     */\r\n    out.build = function () {\r\n        // RESET BUILD LIFECYCLE FLAGS\r\n        out._geoDone_ = false\r\n        out._statDone_ = false\r\n        out._finalized_ = false\r\n        _renderScheduled = false\r\n\r\n        if (out.projectionFunction_) out.proj('4326') //when using custom d3 projection function always request NUTS2JSON in WGS84\r\n\r\n        //build map template base\r\n        out.buildMapTemplateBase()\r\n\r\n        //add additional filters for fill patterns for example\r\n        if (out.filtersDefinitionFunction_) {\r\n            out.filtersDefinitionFunction_(out.svg(), out.numberOfClasses_)\r\n        }\r\n\r\n        //legend element\r\n        if (out.legend()) {\r\n            out.buildLegend()\r\n        }\r\n\r\n        //define tooltip\r\n        //prepare map tooltip\r\n        if (out.tooltip_) {\r\n            out._tooltip = tp.tooltip(out.tooltip_)\r\n        } else {\r\n            //no config specified, use default\r\n            if (!out.tooltip_) out.tooltip_ = { id: out.svgId() }\r\n            out._tooltip = tp.tooltip(out.tooltip_)\r\n        }\r\n\r\n        //launch geo data retrieval\r\n        out.updateGeoData()\r\n\r\n        //launch stat data retrieval\r\n        out.updateStatData()\r\n\r\n        return out\r\n    }\r\n\r\n    out.updateLoader = () => {\r\n        if (out.isInset) return\r\n\r\n        //  Ensure wrapper exists (lazy creation)\r\n        if (!out._wrapper_) {\r\n            const svg = out.svg?.()\r\n            if (!svg || svg.empty()) return\r\n            out._wrapper_ = svg.node().parentNode?.classList?.contains('em-map-wrapper') ? svg.node().parentNode : null\r\n        }\r\n\r\n        if (!out._wrapper_) return\r\n\r\n        if (out._loadingGeo_ || out._loadingStatCount_ > 0) {\r\n            showSpinner(out._wrapper_, 'Loading')\r\n        } else {\r\n            hideSpinner(out._wrapper_)\r\n        }\r\n    }\r\n\r\n    out.buildLegend = function () {\r\n        //create legend object\r\n        out.legendObj(out.getLegendConstructor()(out, out.legend()))\r\n        const legend = out.legendObj()\r\n\r\n        //get legend svg. If it does not exist, create it embeded within the map\r\n        let legendSvg = select('#' + legend.svgId)\r\n        if (legendSvg.size() == 0) {\r\n            //get legend position\r\n            const x = legend.x == undefined ? out.width() - 100 - legend.boxPadding : legend.x\r\n            const y = legend.y == undefined ? legend.boxPadding : legend.y\r\n\r\n            //build legend SVG in a new group\r\n            out.svg().append('g').attr('id', legend.svgId).attr('class', 'em-legend')\r\n        }\r\n\r\n        legend.build()\r\n    }\r\n\r\n    /** Check if all stat datasets have been loaded. */\r\n    const isStatDataReady = function () {\r\n        for (const key in out.statData_) {\r\n            const hasConfig = !!out.stat_[key]\r\n            const hasManualData = !!(out.statData_[key] && out.statData_[key].get())\r\n\r\n            if (!hasConfig && !hasManualData) continue\r\n            if (!out.statData_[key].isReady()) return false\r\n        }\r\n        return true\r\n    }\r\n\r\n    /**\r\n     * Launch map geo data retrieval, and make/update the map once received.\r\n     * This method should be called after attributes related to the map geometries have changed, to retrieve this new data and refresh the map.\r\n     */\r\n    out.updateGeoData = function () {\r\n        out._loadingGeo_ = true\r\n        out.updateLoader()\r\n\r\n        out.updateGeoMapTemplate(() => {\r\n            out._loadingGeo_ = false\r\n            out.updateLoader()\r\n\r\n            if (!out.Geometries.isGeoReady()) return\r\n\r\n            out._geoDone_ = true\r\n\r\n            if (isStatDataReady()) {\r\n                out._statDone_ = true\r\n                out.updateStatValues()\r\n            }\r\n\r\n            tryFinalize()\r\n        })\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Launch map geo stat datasets retrieval, and make/update the map once received.\r\n     * This method should be called after specifications on the stat data sources attached to the map have changed, to retrieve this new data and refresh the map.\r\n     */\r\n    out.updateStatData = function () {\r\n        for (let statKey in out.stat_) {\r\n            const config = out.stat(statKey)\r\n            const manualData = out.statData(statKey).get?.()\r\n\r\n            if (!config && !manualData) continue\r\n\r\n            if (config) {\r\n                const statData = StatisticalData.statData(config)\r\n                out.statData(statKey, statData)\r\n\r\n                // detect remote on statData, not config\r\n                const isRemote = !!statData.eurostatDatasetCode_ || !!statData.csvURL_\r\n\r\n                if (isRemote) {\r\n                    out._loadingStatCount_++\r\n                    out.updateLoader()\r\n                }\r\n\r\n                let nl = out.nutsLevel_\r\n                if (nl === 'mixed') nl = 0\r\n\r\n                statData.retrieveFromRemote(nl, out.language(), () => {\r\n                    // bookkeeping MUST always run\r\n                    if (isRemote) {\r\n                        out._loadingStatCount_ = Math.max(0, out._loadingStatCount_ - 1)\r\n                        out.updateLoader()\r\n                    }\r\n\r\n                    if (!isStatDataReady()) return\r\n\r\n                    out._statDone_ = true\r\n                    if (!out.Geometries.isGeoReady()) return\r\n\r\n                    if (_renderScheduled) return\r\n\r\n                    _renderScheduled = true\r\n                    Promise.resolve().then(() => {\r\n                        _renderScheduled = false\r\n                        out.updateStatValues()\r\n                        tryFinalize()\r\n                    })\r\n                })\r\n            }\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Make/update the map with new stat data.\r\n     * This method should be called after stat data attached to the map have changed, to refresh the map.\r\n     * If the stat data sources have changed, call *updateStatData* instead.\r\n     */\r\n    out.updateStatValues = function () {\r\n        // filter out centroids without stat data\r\n        if (withCenterPoints) {\r\n            // insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, out.refreshCentroids)\r\n            }\r\n            //main map\r\n            out.refreshCentroids(out)\r\n        }\r\n\r\n        out.updateClassification()\r\n        out.updateStyle()\r\n\r\n        if (out.legend_ && out.legendObj()) out.legendObj().update()\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Abstract method.\r\n     * Make/update the map after classification attributes have been changed.\r\n     * For example, if the number of classes, or the classification method has changed, call this method to update the map.\r\n     */\r\n    out.updateClassification = function () {\r\n        console.log('Map updateClassification function not implemented')\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Abstract method.\r\n     * Make/update the map after styling attributes have been changed.\r\n     * For example, if the style (color?) for one legend element has changed, call this method to update the map.\r\n     */\r\n    out.updateStyle = function () {\r\n        console.log('Map updateStyle function not implemented')\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * Abstract method.\r\n     * Function which return the legend constructor function for the map.\r\n     */\r\n    out.getLegendConstructor = function () {\r\n        console.log('Map getLegendConstructor function not implemented')\r\n        return Legend.legend\r\n    }\r\n\r\n    /**\r\n     * Retrieve the time stamp of the map, even if not specified in the dimension initially.\r\n     * This applies only for stat data retrieved from Eurostat API.\r\n     * This method is useful for example when the data retrieved is the freshest, and one wants to know what this date is, for example to display it in the map title.\r\n     */\r\n    out.getTime = function () {\r\n        return out.statData('default').getTime()\r\n    }\r\n\r\n    /**\r\n     * Set some map attributes based on the following URL parameters:\r\n     * \"w\":width, \"h\":height, \"x\":xGeoCenter, \"y\":yGeoCenter, \"z\":pixGeoSize, \"s\":scale, \"lvl\":nuts level, \"time\":time,\r\n     * \"proj\":CRS, \"geo\":geo territory, \"ny\":nuts version, \"language\":langage, \"numberOfClasses\":class number\r\n     */\r\n    out.setFromURL = function () {\r\n        const opts = getURLParameters()\r\n        if (opts.w) out.width(opts.w)\r\n        if (opts.h) out.height(opts.h)\r\n        if (opts.x && opts.y) out.geoCenter([opts.x, opts.y])\r\n        if (opts.z) out.pixelSize(opts.z)\r\n        if (opts.s) out.scale(opts.s)\r\n        if (opts.lvl) out.nutsLevel(opts.lvl)\r\n        if (opts.time) {\r\n            out.filters_.time = opts.time\r\n            delete out.filters_.lastTimePeriod\r\n        }\r\n        if (opts.proj) out.proj(opts.proj)\r\n        if (opts.geo) out.geo(opts.geo)\r\n        if (opts.ny) out.nutsYear(opts.ny)\r\n        if (opts.language) out.language(opts.language)\r\n        if (opts.numberOfClasses) out.numberOfClasses(+opts.numberOfClasses)\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * @function exportMapToSVG\r\n     * @description Exports the current map with styling to SVG and downloads it\r\n     *\r\n     */\r\n    out.exportMapToSVG = function () {\r\n        // Clone the original SVG node to avoid modifying the DOM\r\n        const svgNodeClone = out.svg_.node().cloneNode(true)\r\n        // Add XML namespaces if not already present\r\n        if (!svgNodeClone.hasAttribute('xmlns')) {\r\n            svgNodeClone.setAttribute('xmlns', 'http://www.w3.org/2000/svg')\r\n        }\r\n        if (!svgNodeClone.hasAttribute('xmlns:xlink')) {\r\n            svgNodeClone.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink')\r\n        }\r\n\r\n        // Temporarily append the clone to the document to compute styles\r\n        document.body.appendChild(svgNodeClone)\r\n\r\n        // inline the actual computed styles\r\n        applyComputedStylesToSVG(svgNodeClone)\r\n        //set explicit width / height / viewBox for reliable export\r\n        ensureSvgSize(svgNodeClone)\r\n\r\n        // Remove the cloned SVG from the document after applying styles\r\n        document.body.removeChild(svgNodeClone)\r\n\r\n        const svgUrl = getDownloadURL(svgNodeClone)\r\n\r\n        // Create a download link and trigger download\r\n        const downloadLink = document.createElement('a')\r\n        downloadLink.href = svgUrl\r\n        downloadLink.download = 'eurostatmap.svg'\r\n        document.body.appendChild(downloadLink)\r\n        downloadLink.click()\r\n        document.body.removeChild(downloadLink)\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * @function exportMapToPNG\r\n     * @description Exports the current map with styling to PNG and downloads it\r\n     *\r\n     */\r\n    out.exportMapToPNG = async function (width, height) {\r\n        // Clone original SVG\r\n        const svgNodeClone = out.svg_.node().cloneNode(true)\r\n\r\n        // Ensure xml namespaces\r\n        if (!svgNodeClone.hasAttribute('xmlns')) svgNodeClone.setAttribute('xmlns', 'http://www.w3.org/2000/svg')\r\n        if (!svgNodeClone.hasAttribute('xmlns:xlink')) svgNodeClone.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink')\r\n\r\n        // Append clone so getComputedStyle & fonts resolve correctly\r\n        document.body.appendChild(svgNodeClone)\r\n\r\n        // Wait for webfonts (if any) to load\r\n        if (document.fonts && document.fonts.ready) {\r\n            try {\r\n                await document.fonts.ready\r\n            } catch (e) {\r\n                console.warn('document.fonts.ready failed', e)\r\n            }\r\n        }\r\n\r\n        // Inline computed styles and set explicit size/viewBox (must run while clone is in DOM)\r\n        applyComputedStylesToSVG(svgNodeClone)\r\n        ensureSvgSize(svgNodeClone)\r\n\r\n        // Insert white background rect as first child if none present\r\n        if (!svgNodeClone.querySelector('rect[data-export-background]')) {\r\n            const w = svgNodeClone.getAttribute('width') || svgNodeClone.viewBox.baseVal.width || svgNodeClone.getBoundingClientRect().width\r\n            const h = svgNodeClone.getAttribute('height') || svgNodeClone.viewBox.baseVal.height || svgNodeClone.getBoundingClientRect().height\r\n            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\r\n            bg.setAttribute('x', 0)\r\n            bg.setAttribute('y', 0)\r\n            bg.setAttribute('width', String(w))\r\n            bg.setAttribute('height', String(h))\r\n            bg.setAttribute('fill', '#ffffff')\r\n            bg.setAttribute('data-export-background', 'true')\r\n            svgNodeClone.insertBefore(bg, svgNodeClone.firstElementChild)\r\n        }\r\n\r\n        // Serialize while still in DOM\r\n        const serializer = new XMLSerializer()\r\n        const svgString = serializer.serializeToString(svgNodeClone)\r\n\r\n        // Remove clone from DOM now\r\n        document.body.removeChild(svgNodeClone)\r\n\r\n        // Create blob URL\r\n        const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' })\r\n        const url = URL.createObjectURL(svgBlob)\r\n\r\n        // Determine pixel dimensions\r\n        const w = Math.round(width || parseFloat(svgNodeClone.getAttribute('width')) || 800)\r\n        const h = Math.round(height || parseFloat(svgNodeClone.getAttribute('height')) || 600)\r\n\r\n        // Create image and set crossOrigin (best-effort)\r\n        const img = new Image()\r\n        img.crossOrigin = 'anonymous'\r\n\r\n        // Helper to revoke and cleanup\r\n        const cleanup = (pngUrl) => {\r\n            try {\r\n                URL.revokeObjectURL(url)\r\n            } catch (e) {}\r\n            if (pngUrl) {\r\n                try {\r\n                    URL.revokeObjectURL(pngUrl)\r\n                } catch (e) {}\r\n            }\r\n        }\r\n\r\n        img.onload = function () {\r\n            try {\r\n                const canvas = document.createElement('canvas')\r\n                canvas.width = w\r\n                canvas.height = h\r\n                const ctx = canvas.getContext('2d')\r\n\r\n                // Fill white background to avoid transparent -> black in some viewers\r\n                ctx.fillStyle = '#ffffff'\r\n                ctx.fillRect(0, 0, w, h)\r\n\r\n                ctx.drawImage(img, 0, 0, w, h)\r\n\r\n                canvas.toBlob(function (pngBlob) {\r\n                    if (!pngBlob) {\r\n                        console.error('canvas.toBlob returned null  likely CORS/taint issue.')\r\n                        // open the serialized SVG for debugging\r\n                        const debugWin = window.open()\r\n                        debugWin.document.write('<pre>' + escapeHtml(svgString) + '</pre>')\r\n                        cleanup()\r\n                        return\r\n                    }\r\n\r\n                    const pngUrl = URL.createObjectURL(pngBlob)\r\n                    const a = document.createElement('a')\r\n                    a.href = pngUrl\r\n                    a.download = 'eurostat-map.png'\r\n                    document.body.appendChild(a)\r\n                    a.click()\r\n                    document.body.removeChild(a)\r\n\r\n                    cleanup(pngUrl)\r\n                }, 'image/png')\r\n            } catch (err) {\r\n                console.error('Error drawing SVG to canvas:', err)\r\n                // open serialized SVG for debugging\r\n                const debugWin = window.open()\r\n                debugWin.document.write('<pre>' + escapeHtml(svgString) + '</pre>')\r\n                cleanup()\r\n            }\r\n        }\r\n\r\n        img.onerror = function (err) {\r\n            console.error('Image failed to load for export. Likely CORS or invalid SVG. Error:', err)\r\n            // open serialized SVG for debugging\r\n            const debugWin = window.open()\r\n            debugWin.document.write('<pre>' + escapeHtml(svgString) + '</pre>')\r\n            cleanup()\r\n        }\r\n\r\n        // start loading\r\n        img.src = url\r\n\r\n        return out\r\n    }\r\n\r\n    // small helper to escape HTML for debug window\r\n    function escapeHtml(str) {\r\n        return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n/**\r\n * Retrieve some URL parameters, which could be then reused as map definition parameters.\r\n * This allow a quick map customisation by simply adding and changing some URL parameters.\r\n * See map method: setFromURL(...)\r\n */\r\nexport const getURLParameters = function () {\r\n    const ps = {}\r\n    const p = ['w', 'h', 'x', 'y', 'z', 's', 'lvl', 'time', 'proj', 'geo', 'ny', 'language', 'sl', 'numberOfClasses']\r\n    for (let i = 0; i < p.length; i++) ps[p[i]] = getURLParameterByName(p[i])\r\n    return ps\r\n}\r\n","import { getRegionsSelector } from './utils'\r\nimport { select } from 'd3-selection'\r\n\r\nexport function applyPatternFill(map, configs = []) {\r\n    if (!Array.isArray(configs)) {\r\n        console.warn('patternFill expects an array of configs')\r\n        return\r\n    }\r\n\r\n    let defs = map.svg().select('defs')\r\n    if (defs.empty()) {\r\n        defs = map.svg().append('defs')\r\n    }\r\n\r\n    // Prepare: map each regionId to an array of patternIds\r\n    const regionToPatternIds = {}\r\n\r\n    configs.forEach((config) => {\r\n        const { pattern = 'hatching', regionIds = [], color = '#000', strokeWidth = 1, customPattern, spacing } = config\r\n\r\n        let patternId\r\n\r\n        if (customPattern) {\r\n            const idMatch = customPattern.match(/id=['\"]([^'\"]+)['\"]/)\r\n            if (idMatch) {\r\n                patternId = idMatch[1]\r\n\r\n                if (map.svg().select(`#${patternId}`).empty()) {\r\n                    defs.node().insertAdjacentHTML('beforeend', customPattern)\r\n                }\r\n            } else {\r\n                console.warn('customPattern must include an id attribute.')\r\n                return\r\n            }\r\n        } else {\r\n            const colorKey = color.replace('#', '').toLowerCase()\r\n            patternId = `${pattern}-${colorKey}-sw${strokeWidth}`\r\n            definePattern(map, patternId, pattern, color, strokeWidth, spacing)\r\n        }\r\n\r\n        config.patternId = patternId\r\n\r\n        regionIds.forEach((regionId) => {\r\n            if (!regionToPatternIds[regionId]) {\r\n                regionToPatternIds[regionId] = []\r\n            }\r\n            regionToPatternIds[regionId].push(patternId)\r\n        })\r\n    })\r\n\r\n    // Apply all patterns for each region (stacking them)\r\n    map.svg()\r\n        .selectAll(getRegionsSelector(map))\r\n        .each(function (d) {\r\n            const id = d?.properties?.id\r\n            const patternIds = regionToPatternIds[id]\r\n\r\n            if (patternIds && patternIds.length) {\r\n                const original = select(this)\r\n\r\n                patternIds.forEach((patternId) => {\r\n                    const clone = original.node().cloneNode(true)\r\n\r\n                    select(clone)\r\n                        .attr('fill', `url(#${patternId})`)\r\n                        .attr('pointer-events', 'none')\r\n                        .attr('class', (original.attr('class') || '') + 'pattern-fill-overlay')\r\n\r\n                    select(this.parentNode).append(() => clone)\r\n                })\r\n            }\r\n        })\r\n}\r\n\r\nfunction definePattern(map, patternId, patternName, color, strokeWidth, spacing = 8) {\r\n    const defs = map.svg().select('defs')\r\n\r\n    if (\r\n        map\r\n            .svg()\r\n            .select(`#${CSS.escape(patternId)}`)\r\n            .empty()\r\n    ) {\r\n        const pattern = defs\r\n            .append('pattern')\r\n            .attr('id', patternId)\r\n            .attr('patternUnits', 'userSpaceOnUse')\r\n            .attr('width', spacing)\r\n            .attr('height', spacing)\r\n\r\n        if (patternName === 'hatching') {\r\n            // Diagonal stripes, scaled to spacing\r\n            pattern\r\n                .append('path')\r\n                .attr(\r\n                    'd',\r\n                    `M-${spacing / 8},${spacing / 8} l${spacing / 4},-${spacing / 4} M0,${spacing} l${spacing},-${spacing} M${spacing - spacing / 8},${spacing + spacing / 8} l${spacing / 4},-${spacing / 4}`\r\n                )\r\n                .attr('stroke', color)\r\n                .attr('stroke-width', strokeWidth)\r\n        } else if (patternName === 'crosshatch') {\r\n            // X shape\r\n            pattern\r\n                .append('path')\r\n                .attr('d', `M0,0 l${spacing},${spacing} M${spacing},0 l-${spacing},${spacing}`)\r\n                .attr('stroke', color)\r\n                .attr('stroke-width', strokeWidth)\r\n        } else if (patternName === 'dots') {\r\n            // Center dot, radius proportional\r\n            pattern\r\n                .append('circle')\r\n                .attr('cx', spacing / 2)\r\n                .attr('cy', spacing / 2)\r\n                .attr('r', strokeWidth)\r\n                .attr('fill', color)\r\n        } else {\r\n            console.warn(`Unknown pattern \"${patternName}\", defaulting to hatching.`)\r\n            pattern\r\n                .append('path')\r\n                .attr(\r\n                    'd',\r\n                    `M-${spacing / 8},${spacing / 8} l${spacing / 4},-${spacing / 4} M0,${spacing} l${spacing},-${spacing} M${spacing - spacing / 8},${spacing + spacing / 8} l${spacing / 4},-${spacing / 4}`\r\n                )\r\n                .attr('stroke', color)\r\n                .attr('stroke-width', strokeWidth)\r\n        }\r\n    }\r\n}\r\n","//map-choropleth.js\r\nimport { select } from 'd3-selection'\r\nimport { min, max } from 'd3-array'\r\nimport { scaleQuantile, scaleQuantize, scaleThreshold } from 'd3-scale'\r\nimport { interpolateYlGnBu } from 'd3-scale-chromatic'\r\nimport { piecewise, interpolateLab } from 'd3-interpolate'\r\nimport * as StatMap from '../../core/stat-map'\r\nimport * as ChoroplethLegend from '../../legend/choropleth/legend-choropleth'\r\nimport { checkIfDiverging, executeForAllInsets, getRegionsSelector, getTextColorForBackground, spaceAsThousandSeparator } from '../../core/utils'\r\nimport { jenks, ckmeans } from 'simple-statistics'\r\nimport { applyPatternFill } from '../../core/pattern-fill'\r\n\r\n/**\r\n * Returns a chroropleth map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, false, 'ch')\r\n\r\n    //the number of classes\r\n    out.numberOfClasses_ = 7\r\n    //the classification method\r\n    out.classificationMethod_ = 'quantile' // or: ckmeans, jenks, equinter, threshold\r\n    //the threshold, when the classification method is 'threshold'\r\n    out.thresholds_ = [0]\r\n    //colors to use for classes\r\n    out.colors_ = null\r\n    //when computed automatically, ensure the threshold are nice rounded values\r\n    out.makeClassifNice_ = true\r\n    //the color function [0,1] -> color\r\n    const paletteA = [\r\n        '#D4DAF0',\r\n        '#C1C9EB',\r\n        '#A8B4E6',\r\n        '#93A2DC',\r\n        '#7C90D6',\r\n        '#677CD2',\r\n        '#5169BE',\r\n        '#3C57B0',\r\n        '#2644A7',\r\n        '#15246B',\r\n    ]\r\n    out.colorFunction_ = (t) => piecewise(interpolateLab, paletteA)(Math.min(Math.max(0, t), 1)) // default\r\n    //a function returning the color from the class i\r\n    out.classToFillStyle_ = undefined\r\n    //the classifier: a function which return a class number from a stat value.\r\n    out.classifier_ = undefined\r\n    // set tooltip function\r\n    out.tooltip_.textFunction = choroplethTooltipFunction\r\n\r\n    // continuous color schemes\r\n    out.colorSchemeType_ = 'discrete' // or 'continuous'\r\n    out.valueTransform_ = (x) => x // for distribution stretching in continuous mode\r\n    out.valueUntransform_ = (x) => x // the legends need to 'untransform' the value to show the original value\r\n    out.pointOfDivergence_ = null // the point in the domain where the color diverges (e.g. 0 for a diverging color scheme)\r\n\r\n    // Getter/setters for exposed attributes\r\n    const paramNames = [\r\n        'numberOfClasses_',\r\n        'classificationMethod_',\r\n        'thresholds_',\r\n        'makeClassifNice_',\r\n        'colorFunction_',\r\n        'classToFillStyle_',\r\n        'noDataFillStyle_',\r\n        'classifier_',\r\n        'colors_',\r\n        'colorFunction_',\r\n        'colorSchemeType_',\r\n        'valueTransform_',\r\n        'valueUntransform_',\r\n        'pointOfDivergence_',\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    //override of some special getters/setters\r\n    out.colorFunction = function (v) {\r\n        if (!arguments.length) return out.colorFunction_\r\n        out.colorFunction_ = v\r\n        if (out.filtersDefinitionFunction_) {\r\n            // dot density style\r\n            out.classToFillStyle(getFillPatternLegend())\r\n        } else {\r\n            // update color function\r\n            const newFunction = getColorFunction(out.colorFunction_, out.colors_, out.colorSchemeType_)\r\n            out.classToFillStyle(newFunction)\r\n        }\r\n\r\n        return out\r\n    }\r\n    out.threshold = function (v) {\r\n        if (!arguments.length) return out.thresholds_\r\n        out.thresholds_ = v\r\n        out.numberOfClasses(v.length + 1)\r\n        return out\r\n    }\r\n    out.filtersDefinitionFunction = function (v) {\r\n        if (!arguments.length) return out.filtersDefinitionFunction_\r\n        out.filtersDefinitionFunction_ = v\r\n        if (out.svg()) out.filtersDefinitionFunction_(out.svg(), out.numberOfClasses_)\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        try {\r\n            // apply classification to all insets that are outside of the main map's SVG\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n            }\r\n\r\n            // apply to main map\r\n            applyClassificationToMap(out)\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in updateClassification:', e.message)\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    function applyClassificationToMap(map) {\r\n        const generateRange = (nb) => [...Array(nb).keys()]\r\n        const dataArray = out.statData().getArray()\r\n\r\n        const setupClassifier = () => {\r\n            const range = generateRange(out.numberOfClasses_)\r\n\r\n            if (out.colorSchemeType_ === 'continuous') {\r\n                const valueTransform = out.valueTransform_ || ((d) => d)\r\n                const transformedValues = dataArray.map(valueTransform)\r\n                const minVal = min(transformedValues)\r\n                const maxVal = max(transformedValues)\r\n                const isDiverging = checkIfDiverging(out)\r\n                const isFullScale = typeof out.colorFunction_?.domain === 'function'\r\n\r\n                if (!isFullScale) {\r\n                    if (isDiverging) {\r\n                        const divergence = valueTransform(out.pointOfDivergence_ ?? 0)\r\n                        out.domain_ = [minVal, divergence, maxVal]\r\n                    } else {\r\n                        out.domain_ = [minVal, maxVal]\r\n                    }\r\n                }\r\n\r\n                out.classifier((val) => val) // identity\r\n            }\r\n\r\n            const dataArrayNumeric = [...dataArray].filter(v => !isNaN(parseFloat(v)) && isFinite(v))\r\n\r\n            switch (out.classificationMethod_) {\r\n                case 'quantile': {\r\n                    out.classifier(scaleQuantile().domain(dataArray).range(range))\r\n                    break\r\n                }\r\n                case 'equal-interval':\r\n                case 'equinter': {\r\n                    out.classifier(\r\n                        scaleQuantize()\r\n                            .domain([min(dataArray), max(dataArray)])\r\n                            .range(range)\r\n                    )\r\n                    if (out.makeClassifNice_) out.classifier().nice()\r\n                    break\r\n                }\r\n                case 'threshold': {\r\n                    out.numberOfClasses(out.thresholds_.length + 1)\r\n                    out.classifier(scaleThreshold().domain(out.thresholds_).range(generateRange(out.numberOfClasses_)))\r\n                    break\r\n                }\r\n                case 'jenks': {\r\n                    const jenksBreaks = jenks(dataArrayNumeric, out.numberOfClasses_) //data, lowerClassLimits, nClasses\r\n                    const domain = jenksBreaks.slice(1, -1)\r\n                    out.classifier(scaleThreshold().domain(domain).range(range))\r\n                    break\r\n                }\r\n                case 'ckmeans': {\r\n                    const ckmeansBreaks = ckmeans(dataArrayNumeric, out.numberOfClasses_).map((cluster) => cluster.pop())\r\n                    const domain = ckmeansBreaks.slice(0, -1)\r\n                    out.classifier(scaleThreshold().domain(domain).range(range))\r\n                    break\r\n                }\r\n            }\r\n        }\r\n\r\n        const classifyRegions = (regions) => {\r\n            regions.attr('ecl', (rg) => {\r\n                const regionData = out.statData().get(rg.properties.id)\r\n                if (!regionData) return\r\n                const value = regionData.value\r\n                if (value === ':' || value === null) return 'nd'\r\n\r\n                if (out.colorSchemeType_ === 'continuous') {\r\n                    // no class index for continuous mode\r\n                    return value\r\n                }\r\n\r\n                return value != null ? +out.classifier_(value) : undefined\r\n            })\r\n        }\r\n\r\n        // Initialize classifier and apply classification\r\n        setupClassifier()\r\n\r\n        if (map.svg_) {\r\n            const selector = getRegionsSelector(map)\r\n            classifyRegions(map.svg().selectAll(selector))\r\n\r\n            if (map.nutsLevel_ === 'mixed') {\r\n                const nuts0Regions = map.svg().selectAll('path.em-nutsrg0')\r\n                classifyRegions(nuts0Regions)\r\n            }\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        try {\r\n            // apply style to insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n            }\r\n\r\n            // apply to main map\r\n            applyStyleToMap(out)\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in updateStyle:', e.message)\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n        // Define function to get a class' color\r\n        if (out.filtersDefinitionFunction_) {\r\n            // Dot density style\r\n            out.classToFillStyle(getFillPatternLegend())\r\n        } else {\r\n            // Color legend style\r\n            out.classToFillStyle(getColorFunction(out.colorFunction_, out.colors_))\r\n        }\r\n\r\n        // Apply color and events to regions if SVG exists\r\n        if (map.svg_) {\r\n            const selector = getRegionsSelector(map)\r\n            const regions = map.svg().selectAll(selector)\r\n\r\n            // Apply transition and set initial fill colors with data-driven logic\r\n            regions\r\n                .style('pointer-events', 'none') // disable interaction during transition\r\n                .transition()\r\n                .duration(out.transitionDuration())\r\n                .style('fill', regionsFillFunction)\r\n                .end()\r\n                .then(() => {\r\n                    // Re-enable interaction after the transition\r\n                    regions.style('pointer-events', null)\r\n                    // Store the original color for each region\r\n                    regions.each(function () {\r\n                        const sel = select(this)\r\n                        sel.attr('fill___', sel.style('fill'))\r\n                    })\r\n                    // Set up mouse events\r\n                    addMouseEventsToRegions(map, regions)\r\n\r\n                    // update font color for grid cartograms (contrast)\r\n                    if (out.gridCartogram_) {\r\n                        map.svg()\r\n                            .selectAll('.em-grid-text')\r\n                            .each(function () {\r\n                                const cellColor = select(this.parentNode).style('fill')\r\n                                select(this).attr('fill', getTextColorForBackground(cellColor))\r\n                            })\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    //console.error('Error applying transition to regions:', err)\r\n                })\r\n            // Apply additional settings for mixed NUTS level view\r\n            if (out.nutsLevel_ === 'mixed') {\r\n                styleMixedNUTS(map)\r\n            }\r\n\r\n            // Update labels for statistical values if required\r\n            if (out.labels_) {\r\n                if (out.labels_.values) out.updateValuesLabels(map)\r\n            }\r\n\r\n            //add hatching if needed\r\n            if (out.patternFill_) {\r\n                applyPatternFill(map, out.patternFill_)\r\n            }\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return ChoroplethLegend.legend\r\n    }\r\n\r\n    // when mixing different NUTS levels (e.g. showing NUTS 1 and NUTS 2 data simultaneously)\r\n    const styleMixedNUTS = function (map) {\r\n        map.svg()\r\n            .selectAll(getRegionsSelector(map))\r\n            .each(function () {\r\n                if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n                const sel = select(this)\r\n                const ecl = sel.attr('ecl')\r\n                const lvl = sel.attr('lvl')\r\n\r\n                // Determine display visibility\r\n                const isVisible = ecl || lvl === '0'\r\n\r\n                // Apply styles efficiently\r\n                sel.style('display', isVisible ? 'block' : 'none')\r\n\r\n                if (ecl && lvl !== '0') {\r\n                    const stroke = sel.style('stroke') || '#777'\r\n                    const strokeWidth = sel.style('stroke-width') || 0.2\r\n                    sel.style('stroke', stroke).style('stroke-width', strokeWidth)\r\n                }\r\n            })\r\n    }\r\n\r\n    function getContinuousColor(value, out) {\r\n        const colorFn = out.colorFunction_\r\n        const domain = out.domain_ || [0, 1]\r\n        const isD3Scale = typeof colorFn?.domain === 'function'\r\n        const transform = out.valueTransform_ || ((d) => d)\r\n\r\n        const transformed = transform(value)\r\n        if (isNaN(transformed)) return out.noDataFillStyle_ || 'gray'\r\n\r\n        if (isD3Scale) {\r\n            return colorFn(transformed)\r\n        }\r\n\r\n        let t\r\n        if (domain.length === 3) {\r\n            const [d0, , d2] = domain\r\n            const divT = transform(out.pointOfDivergence_ ?? 0)\r\n            t = transformed < divT ? (0.5 * (transformed - d0)) / (divT - d0) : 0.5 + (0.5 * (transformed - divT)) / (d2 - divT)\r\n        } else {\r\n            const [d0, d1] = domain\r\n            t = (transformed - d0) / (d1 - d0)\r\n        }\r\n\r\n        return colorFn(Math.min(Math.max(t, 0), 1))\r\n    }\r\n\r\n    const regionsFillFunction = function (rg) {\r\n        const ecl = select(this).attr('ecl') // may be a class index or a raw value\r\n        const colorSchemeType = out.colorSchemeType_ || 'discrete'\r\n\r\n        if (!ecl && ecl !== '0') {\r\n            return // input not added\r\n        }\r\n\r\n        // Data not available\r\n        if (ecl === 'nd') {\r\n            return out.noDataFillStyle_ || 'gray'\r\n        }\r\n\r\n        // Dot-density or pattern-fill mode\r\n        if (out.filtersDefinitionFunction_) {\r\n            return out.classToFillStyle_(ecl)\r\n        }\r\n\r\n        // Continuous color scheme\r\n        if (colorSchemeType === 'continuous') {\r\n            const rawValue = +ecl\r\n            return getContinuousColor(rawValue, out)\r\n        }\r\n\r\n        // Discrete color scheme\r\n        if (out.Geometries?.userGeometries) {\r\n            return out.classToFillStyle_(ecl, out.numberOfClasses_ || 1)\r\n        }\r\n\r\n        if (out.geo_ === 'WORLD') {\r\n            const fillStyle = out.classToFillStyle_(ecl, out.numberOfClasses_ || 1)\r\n            return fillStyle || out.cntrgFillStyle_\r\n        }\r\n\r\n        // Default (NUTS case)\r\n        return out.classToFillStyle_(ecl, out.numberOfClasses_ || 1)\r\n    }\r\n\r\n    const addMouseEventsToRegions = function (map, regions) {\r\n        const shouldOmit = (id) => map.tooltip_.omitRegions?.includes(id)\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', map.hoverColor_) // Apply highlight color\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n                if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n            })\r\n            .on('mouseout', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', sel.attr('fill___')) // Revert to original color\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n            })\r\n    }\r\n\r\n    // Manually highlight a region by ID (simulate mouseover)\r\n    out.highlightRegion = function (regionId) {\r\n        if (!out.svg_) return out\r\n\r\n        const selector = getRegionsSelector(out)\r\n        const region = out\r\n            .svg()\r\n            .selectAll(selector)\r\n            .filter((d) => d.properties.id === regionId)\r\n\r\n        if (!region.empty()) {\r\n            const rg = region.datum()\r\n            const sel = region\r\n            sel.style('fill', out.hoverColor_ || 'orange')\r\n\r\n            if (out._tooltip) {\r\n                const html = out.tooltip_.textFunction(rg, out)\r\n                out._tooltip.mouseover(html)\r\n\r\n                // Get region bounds (in SVG space)\r\n                const bbox = region.node().getBBox()\r\n\r\n                // Apply current zoom/pan transform\r\n                const transform = out.__lastTransform || { x: 0, y: 0, k: 1 }\r\n                const scaledX = (bbox.x + bbox.width / 2) * transform.k + transform.x\r\n                const scaledY = (bbox.y + bbox.height / 2) * transform.k + transform.y\r\n\r\n                // Convert to screen coords\r\n                const mapRect = out.svg().node().getBoundingClientRect()\r\n                const x = mapRect.left + scaledX\r\n                const y = mapRect.top + scaledY\r\n\r\n                out._tooltip.ensureTooltipOnScreen(x, y)\r\n            }\r\n\r\n            if (out.onRegionMouseOver_) {\r\n                out.onRegionMouseOver_(null, rg, region.node(), out)\r\n            }\r\n        }\r\n        return out\r\n    }\r\n\r\n    // Manually clear the highlight (simulate mouseout)\r\n    out.clearHighlight = function () {\r\n        if (!out.svg_) return out\r\n\r\n        const selector = getRegionsSelector(out)\r\n        out.svg()\r\n            .selectAll(selector)\r\n            .each(function () {\r\n                const sel = select(this)\r\n                const original = sel.attr('fill___')\r\n                if (original) sel.style('fill', original)\r\n            })\r\n\r\n        if (out._tooltip) {\r\n            out._tooltip.mouseout()\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n//build a color legend object\r\nexport const getColorFunction = function (colorFunction, colorArray, schemeType = 'discrete') {\r\n    colorFunction = colorFunction || interpolateYlGnBu\r\n\r\n    if (schemeType === 'continuous') {\r\n        return function (value, domain = [0, 1]) {\r\n            const t = (value - domain[0]) / (domain[1] - domain[0])\r\n            return colorFunction(Math.min(Math.max(t, 0), 1))\r\n        }\r\n    }\r\n\r\n    if (colorArray) {\r\n        return function (ecl, numberOfClasses) {\r\n            return colorArray[ecl]\r\n        }\r\n    }\r\n\r\n    return function (ecl, numberOfClasses) {\r\n        return colorFunction(ecl / (numberOfClasses - 1))\r\n    }\r\n}\r\n\r\n/**\r\n * Build a fill pattern legend object { nd:\"white\", 0:\"url(#pattern_0)\", 1:\"url(#pattern_1)\", ... }\r\n */\r\nexport const getFillPatternLegend = function () {\r\n    return function (ecl) {\r\n        return 'url(#pattern_' + ecl + ')'\r\n    }\r\n}\r\n\r\nconst choroplethTooltipFunction = function (region, map) {\r\n    if (map.tooltip_.omitRegions && map.tooltip_.omitRegions.includes(region.properties.id)) {\r\n        return '' // Skip tooltip for omitted regions\r\n    }\r\n    const buf = []\r\n\r\n    // Header with region name and ID\r\n    const regionName = region.properties.na || region.properties.name\r\n    const regionId = region.properties.id\r\n    buf.push(`\r\n        <div class=\"em-tooltip-bar\">\r\n            <b>${regionName}</b>${regionId ? ` (${regionId})` : ''}\r\n        </div>\r\n    `)\r\n\r\n    // Retrieve region's data value and unit\r\n    const statData = map.statData()\r\n    const sv = statData.get(regionId)\r\n    const unit = statData.unitText() || ''\r\n\r\n    // No data case\r\n    if (!sv || (sv.value !== 0 && !sv.value) || sv.value === ':') {\r\n        buf.push(`\r\n            <div class=\"em-tooltip-text no-data\">\r\n                <table class=\"em-tooltip-table\">\r\n                    <tbody>\r\n                        <tr><td>${map.noDataText_}</td></tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        `)\r\n        return buf.join('')\r\n    }\r\n\r\n    // Data display\r\n    buf.push(`\r\n        <div class=\"em-tooltip-text\">\r\n            <table class=\"em-tooltip-table\">\r\n                <tbody>\r\n                    <tr><td>${spaceAsThousandSeparator(sv.value)} ${unit}</td></tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    `)\r\n\r\n    // Optional status flag\r\n    const statusFlag = sv.status\r\n    if (statusFlag && map.tooltip_.showFlags) {\r\n        const flagText = map.tooltip_.showFlags === 'short' ? statusFlag : flags[statusFlag] || statusFlag\r\n        buf.push(` <span class=\"status-flag\">${flagText}</span>`)\r\n    }\r\n\r\n    return buf.join('')\r\n}\r\n","import {default as value} from \"./value.js\";\n\nexport default function piecewise(interpolate, values) {\n  if (values === undefined) values = interpolate, interpolate = value;\n  var i = 0, n = values.length - 1, v = values[0], I = new Array(n < 0 ? 0 : n);\n  while (i < n) I[i] = interpolate(v, v = values[++i]);\n  return function(t) {\n    var i = Math.max(0, Math.min(n - 1, Math.floor(t *= n)));\n    return I[i](t - i);\n  };\n}\n","import colors from \"../colors.js\";\nimport ramp from \"../ramp.js\";\n\nexport var scheme = new Array(3).concat(\n  \"fee8c8fdbb84e34a33\",\n  \"fef0d9fdcc8afc8d59d7301f\",\n  \"fef0d9fdcc8afc8d59e34a33b30000\",\n  \"fef0d9fdd49efdbb84fc8d59e34a33b30000\",\n  \"fef0d9fdd49efdbb84fc8d59ef6548d7301f990000\",\n  \"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000\",\n  \"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000\"\n).map(colors);\n\nexport default ramp(scheme);\n","// https://en.wikipedia.org/wiki/Linear_congruential_generator#Parameters_in_common_use\nconst a = 1664525;\nconst c = 1013904223;\nconst m = 4294967296; // 2^32\n\nexport default function() {\n  let s = 1;\n  return () => (s = (a * s + c) % m) / m;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer} from \"d3-timer\";\nimport lcg from \"./lcg.js\";\n\nexport function x(d) {\n  return d.x;\n}\n\nexport function y(d) {\n  return d.y;\n}\n\nvar initialRadius = 10,\n    initialAngle = Math.PI * (3 - Math.sqrt(5));\n\nexport default function(nodes) {\n  var simulation,\n      alpha = 1,\n      alphaMin = 0.001,\n      alphaDecay = 1 - Math.pow(alphaMin, 1 / 300),\n      alphaTarget = 0,\n      velocityDecay = 0.6,\n      forces = new Map(),\n      stepper = timer(step),\n      event = dispatch(\"tick\", \"end\"),\n      random = lcg();\n\n  if (nodes == null) nodes = [];\n\n  function step() {\n    tick();\n    event.call(\"tick\", simulation);\n    if (alpha < alphaMin) {\n      stepper.stop();\n      event.call(\"end\", simulation);\n    }\n  }\n\n  function tick(iterations) {\n    var i, n = nodes.length, node;\n\n    if (iterations === undefined) iterations = 1;\n\n    for (var k = 0; k < iterations; ++k) {\n      alpha += (alphaTarget - alpha) * alphaDecay;\n\n      forces.forEach(function(force) {\n        force(alpha);\n      });\n\n      for (i = 0; i < n; ++i) {\n        node = nodes[i];\n        if (node.fx == null) node.x += node.vx *= velocityDecay;\n        else node.x = node.fx, node.vx = 0;\n        if (node.fy == null) node.y += node.vy *= velocityDecay;\n        else node.y = node.fy, node.vy = 0;\n      }\n    }\n\n    return simulation;\n  }\n\n  function initializeNodes() {\n    for (var i = 0, n = nodes.length, node; i < n; ++i) {\n      node = nodes[i], node.index = i;\n      if (node.fx != null) node.x = node.fx;\n      if (node.fy != null) node.y = node.fy;\n      if (isNaN(node.x) || isNaN(node.y)) {\n        var radius = initialRadius * Math.sqrt(0.5 + i), angle = i * initialAngle;\n        node.x = radius * Math.cos(angle);\n        node.y = radius * Math.sin(angle);\n      }\n      if (isNaN(node.vx) || isNaN(node.vy)) {\n        node.vx = node.vy = 0;\n      }\n    }\n  }\n\n  function initializeForce(force) {\n    if (force.initialize) force.initialize(nodes, random);\n    return force;\n  }\n\n  initializeNodes();\n\n  return simulation = {\n    tick: tick,\n\n    restart: function() {\n      return stepper.restart(step), simulation;\n    },\n\n    stop: function() {\n      return stepper.stop(), simulation;\n    },\n\n    nodes: function(_) {\n      return arguments.length ? (nodes = _, initializeNodes(), forces.forEach(initializeForce), simulation) : nodes;\n    },\n\n    alpha: function(_) {\n      return arguments.length ? (alpha = +_, simulation) : alpha;\n    },\n\n    alphaMin: function(_) {\n      return arguments.length ? (alphaMin = +_, simulation) : alphaMin;\n    },\n\n    alphaDecay: function(_) {\n      return arguments.length ? (alphaDecay = +_, simulation) : +alphaDecay;\n    },\n\n    alphaTarget: function(_) {\n      return arguments.length ? (alphaTarget = +_, simulation) : alphaTarget;\n    },\n\n    velocityDecay: function(_) {\n      return arguments.length ? (velocityDecay = 1 - _, simulation) : 1 - velocityDecay;\n    },\n\n    randomSource: function(_) {\n      return arguments.length ? (random = _, forces.forEach(initializeForce), simulation) : random;\n    },\n\n    force: function(name, _) {\n      return arguments.length > 1 ? ((_ == null ? forces.delete(name) : forces.set(name, initializeForce(_))), simulation) : forces.get(name);\n    },\n\n    find: function(x, y, radius) {\n      var i = 0,\n          n = nodes.length,\n          dx,\n          dy,\n          d2,\n          node,\n          closest;\n\n      if (radius == null) radius = Infinity;\n      else radius *= radius;\n\n      for (i = 0; i < n; ++i) {\n        node = nodes[i];\n        dx = x - node.x;\n        dy = y - node.y;\n        d2 = dx * dx + dy * dy;\n        if (d2 < radius) closest = node, radius = d2;\n      }\n\n      return closest;\n    },\n\n    on: function(name, _) {\n      return arguments.length > 1 ? (event.on(name, _), simulation) : event.on(name);\n    }\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import constant from \"./constant.js\";\n\nexport default function(x) {\n  var strength = constant(0.1),\n      nodes,\n      strengths,\n      xz;\n\n  if (typeof x !== \"function\") x = constant(x == null ? 0 : +x);\n\n  function force(alpha) {\n    for (var i = 0, n = nodes.length, node; i < n; ++i) {\n      node = nodes[i], node.vx += (xz[i] - node.x) * strengths[i] * alpha;\n    }\n  }\n\n  function initialize() {\n    if (!nodes) return;\n    var i, n = nodes.length;\n    strengths = new Array(n);\n    xz = new Array(n);\n    for (i = 0; i < n; ++i) {\n      strengths[i] = isNaN(xz[i] = +x(nodes[i], i, nodes)) ? 0 : +strength(nodes[i], i, nodes);\n    }\n  }\n\n  force.initialize = function(_) {\n    nodes = _;\n    initialize();\n  };\n\n  force.strength = function(_) {\n    return arguments.length ? (strength = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : strength;\n  };\n\n  force.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : x;\n  };\n\n  return force;\n}\n","import constant from \"./constant.js\";\n\nexport default function(y) {\n  var strength = constant(0.1),\n      nodes,\n      strengths,\n      yz;\n\n  if (typeof y !== \"function\") y = constant(y == null ? 0 : +y);\n\n  function force(alpha) {\n    for (var i = 0, n = nodes.length, node; i < n; ++i) {\n      node = nodes[i], node.vy += (yz[i] - node.y) * strengths[i] * alpha;\n    }\n  }\n\n  function initialize() {\n    if (!nodes) return;\n    var i, n = nodes.length;\n    strengths = new Array(n);\n    yz = new Array(n);\n    for (i = 0; i < n; ++i) {\n      strengths[i] = isNaN(yz[i] = +y(nodes[i], i, nodes)) ? 0 : +strength(nodes[i], i, nodes);\n    }\n  }\n\n  force.initialize = function(_) {\n    nodes = _;\n    initialize();\n  };\n\n  force.strength = function(_) {\n    return arguments.length ? (strength = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : strength;\n  };\n\n  force.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : y;\n  };\n\n  return force;\n}\n","export default function(d) {\n  const x = +this._x.call(null, d),\n      y = +this._y.call(null, d);\n  return add(this.cover(x, y), x, y, d);\n}\n\nfunction add(tree, x, y, d) {\n  if (isNaN(x) || isNaN(y)) return tree; // ignore invalid points\n\n  var parent,\n      node = tree._root,\n      leaf = {data: d},\n      x0 = tree._x0,\n      y0 = tree._y0,\n      x1 = tree._x1,\n      y1 = tree._y1,\n      xm,\n      ym,\n      xp,\n      yp,\n      right,\n      bottom,\n      i,\n      j;\n\n  // If the tree is empty, initialize the root as a leaf.\n  if (!node) return tree._root = leaf, tree;\n\n  // Find the existing leaf for the new point, or add it.\n  while (node.length) {\n    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;\n    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;\n    if (parent = node, !(node = node[i = bottom << 1 | right])) return parent[i] = leaf, tree;\n  }\n\n  // Is the new point is exactly coincident with the existing point?\n  xp = +tree._x.call(null, node.data);\n  yp = +tree._y.call(null, node.data);\n  if (x === xp && y === yp) return leaf.next = node, parent ? parent[i] = leaf : tree._root = leaf, tree;\n\n  // Otherwise, split the leaf node until the old and new point are separated.\n  do {\n    parent = parent ? parent[i] = new Array(4) : tree._root = new Array(4);\n    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;\n    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;\n  } while ((i = bottom << 1 | right) === (j = (yp >= ym) << 1 | (xp >= xm)));\n  return parent[j] = node, parent[i] = leaf, tree;\n}\n\nexport function addAll(data) {\n  var d, i, n = data.length,\n      x,\n      y,\n      xz = new Array(n),\n      yz = new Array(n),\n      x0 = Infinity,\n      y0 = Infinity,\n      x1 = -Infinity,\n      y1 = -Infinity;\n\n  // Compute the points and their extent.\n  for (i = 0; i < n; ++i) {\n    if (isNaN(x = +this._x.call(null, d = data[i])) || isNaN(y = +this._y.call(null, d))) continue;\n    xz[i] = x;\n    yz[i] = y;\n    if (x < x0) x0 = x;\n    if (x > x1) x1 = x;\n    if (y < y0) y0 = y;\n    if (y > y1) y1 = y;\n  }\n\n  // If there were no (valid) points, abort.\n  if (x0 > x1 || y0 > y1) return this;\n\n  // Expand the tree to cover the new points.\n  this.cover(x0, y0).cover(x1, y1);\n\n  // Add the new points.\n  for (i = 0; i < n; ++i) {\n    add(this, xz[i], yz[i], data[i]);\n  }\n\n  return this;\n}\n","export default function(node, x0, y0, x1, y1) {\n  this.node = node;\n  this.x0 = x0;\n  this.y0 = y0;\n  this.x1 = x1;\n  this.y1 = y1;\n}\n","export function defaultX(d) {\n  return d[0];\n}\n\nexport default function(_) {\n  return arguments.length ? (this._x = _, this) : this._x;\n}\n","export function defaultY(d) {\n  return d[1];\n}\n\nexport default function(_) {\n  return arguments.length ? (this._y = _, this) : this._y;\n}\n","import tree_add, {addAll as tree_addAll} from \"./add.js\";\nimport tree_cover from \"./cover.js\";\nimport tree_data from \"./data.js\";\nimport tree_extent from \"./extent.js\";\nimport tree_find from \"./find.js\";\nimport tree_remove, {removeAll as tree_removeAll} from \"./remove.js\";\nimport tree_root from \"./root.js\";\nimport tree_size from \"./size.js\";\nimport tree_visit from \"./visit.js\";\nimport tree_visitAfter from \"./visitAfter.js\";\nimport tree_x, {defaultX} from \"./x.js\";\nimport tree_y, {defaultY} from \"./y.js\";\n\nexport default function quadtree(nodes, x, y) {\n  var tree = new Quadtree(x == null ? defaultX : x, y == null ? defaultY : y, NaN, NaN, NaN, NaN);\n  return nodes == null ? tree : tree.addAll(nodes);\n}\n\nfunction Quadtree(x, y, x0, y0, x1, y1) {\n  this._x = x;\n  this._y = y;\n  this._x0 = x0;\n  this._y0 = y0;\n  this._x1 = x1;\n  this._y1 = y1;\n  this._root = undefined;\n}\n\nfunction leaf_copy(leaf) {\n  var copy = {data: leaf.data}, next = copy;\n  while (leaf = leaf.next) next = next.next = {data: leaf.data};\n  return copy;\n}\n\nvar treeProto = quadtree.prototype = Quadtree.prototype;\n\ntreeProto.copy = function() {\n  var copy = new Quadtree(this._x, this._y, this._x0, this._y0, this._x1, this._y1),\n      node = this._root,\n      nodes,\n      child;\n\n  if (!node) return copy;\n\n  if (!node.length) return copy._root = leaf_copy(node), copy;\n\n  nodes = [{source: node, target: copy._root = new Array(4)}];\n  while (node = nodes.pop()) {\n    for (var i = 0; i < 4; ++i) {\n      if (child = node.source[i]) {\n        if (child.length) nodes.push({source: child, target: node.target[i] = new Array(4)});\n        else node.target[i] = leaf_copy(child);\n      }\n    }\n  }\n\n  return copy;\n};\n\ntreeProto.add = tree_add;\ntreeProto.addAll = tree_addAll;\ntreeProto.cover = tree_cover;\ntreeProto.data = tree_data;\ntreeProto.extent = tree_extent;\ntreeProto.find = tree_find;\ntreeProto.remove = tree_remove;\ntreeProto.removeAll = tree_removeAll;\ntreeProto.root = tree_root;\ntreeProto.size = tree_size;\ntreeProto.visit = tree_visit;\ntreeProto.visitAfter = tree_visitAfter;\ntreeProto.x = tree_x;\ntreeProto.y = tree_y;\n","export default function(random) {\n  return (random() - 0.5) * 1e-6;\n}\n","import {quadtree} from \"d3-quadtree\";\nimport constant from \"./constant.js\";\nimport jiggle from \"./jiggle.js\";\n\nfunction x(d) {\n  return d.x + d.vx;\n}\n\nfunction y(d) {\n  return d.y + d.vy;\n}\n\nexport default function(radius) {\n  var nodes,\n      radii,\n      random,\n      strength = 1,\n      iterations = 1;\n\n  if (typeof radius !== \"function\") radius = constant(radius == null ? 1 : +radius);\n\n  function force() {\n    var i, n = nodes.length,\n        tree,\n        node,\n        xi,\n        yi,\n        ri,\n        ri2;\n\n    for (var k = 0; k < iterations; ++k) {\n      tree = quadtree(nodes, x, y).visitAfter(prepare);\n      for (i = 0; i < n; ++i) {\n        node = nodes[i];\n        ri = radii[node.index], ri2 = ri * ri;\n        xi = node.x + node.vx;\n        yi = node.y + node.vy;\n        tree.visit(apply);\n      }\n    }\n\n    function apply(quad, x0, y0, x1, y1) {\n      var data = quad.data, rj = quad.r, r = ri + rj;\n      if (data) {\n        if (data.index > node.index) {\n          var x = xi - data.x - data.vx,\n              y = yi - data.y - data.vy,\n              l = x * x + y * y;\n          if (l < r * r) {\n            if (x === 0) x = jiggle(random), l += x * x;\n            if (y === 0) y = jiggle(random), l += y * y;\n            l = (r - (l = Math.sqrt(l))) / l * strength;\n            node.vx += (x *= l) * (r = (rj *= rj) / (ri2 + rj));\n            node.vy += (y *= l) * r;\n            data.vx -= x * (r = 1 - r);\n            data.vy -= y * r;\n          }\n        }\n        return;\n      }\n      return x0 > xi + r || x1 < xi - r || y0 > yi + r || y1 < yi - r;\n    }\n  }\n\n  function prepare(quad) {\n    if (quad.data) return quad.r = radii[quad.data.index];\n    for (var i = quad.r = 0; i < 4; ++i) {\n      if (quad[i] && quad[i].r > quad.r) {\n        quad.r = quad[i].r;\n      }\n    }\n  }\n\n  function initialize() {\n    if (!nodes) return;\n    var i, n = nodes.length, node;\n    radii = new Array(n);\n    for (i = 0; i < n; ++i) node = nodes[i], radii[node.index] = +radius(node, i, nodes);\n  }\n\n  force.initialize = function(_nodes, _random) {\n    nodes = _nodes;\n    random = _random;\n    initialize();\n  };\n\n  force.iterations = function(_) {\n    return arguments.length ? (iterations = +_, force) : iterations;\n  };\n\n  force.strength = function(_) {\n    return arguments.length ? (strength = +_, force) : strength;\n  };\n\n  force.radius = function(_) {\n    return arguments.length ? (radius = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : radius;\n  };\n\n  return force;\n}\n","import { forceSimulation, forceX, forceY, forceCollide } from 'd3-force'\r\nimport { executeForAllInsets } from '../utils'\r\n\r\nexport function runDorlingSimulation(map, radiusAccessor) {\r\n    // Common function to start a simulation on a single map (main or inset)\r\n    const runSim = (singleMap) => {\r\n        const nodes = singleMap.Geometries.centroidsFeatures || []\r\n        if (!nodes.length) return\r\n\r\n        stopDorlingSimulation(singleMap)\r\n\r\n        const strengthX = singleMap.dorlingStrength_?.x ?? 1\r\n        const strengthY = singleMap.dorlingStrength_?.y ?? 1\r\n        const iterations = singleMap.dorlingIterations_ ?? 1\r\n        const useWorker = singleMap.dorlingWorker_ !== false\r\n        const d3URL = singleMap.dorlingWorkerD3URL_ || 'https://unpkg.com/d3@7/dist/d3.min.js'\r\n\r\n        // Compute initial projected coordinates\r\n        for (const n of nodes) {\r\n            const projected = singleMap._projection?.(n.geometry.coordinates)\r\n            if (projected) {\r\n                n.x = projected[0]\r\n                n.y = projected[1]\r\n            } else {\r\n                n.x = NaN\r\n                n.y = NaN\r\n            }\r\n        }\r\n\r\n        const containers = map.getCentroidsGroup(singleMap).selectAll('g.em-centroid')\r\n\r\n        const tickTransform = (sel) => {\r\n            sel.attr('transform', (d) => {\r\n                if (!d || isNaN(d.x) || isNaN(d.y)) return null\r\n                return `translate(${d.x},${d.y})`\r\n            })\r\n        }\r\n\r\n        // === Non-animated branch ===\r\n        if (singleMap.animateDorling_ === false) {\r\n            if (!useWorker) {\r\n                // Run synchronously on main thread\r\n                const sim = forceSimulation(nodes)\r\n                    .force('x', forceX((d) => d.properties.centroid[0]).strength(strengthX))\r\n                    .force('y', forceY((d) => d.properties.centroid[1]).strength(strengthY))\r\n                    .force('collide', forceCollide((d) => radiusAccessor(d)).iterations(iterations))\r\n                    .stop()\r\n\r\n                const nTicks = Math.ceil(Math.log(sim.alphaMin()) / Math.log(1 - sim.alphaDecay()))\r\n                for (let i = 0; i < nTicks; i++) {\r\n                    sim.tick()\r\n                    if (i % 10 === 0) tickTransform(containers)\r\n                }\r\n                tickTransform(containers)\r\n                updateDorlingProgress(1, singleMap)\r\n                return sim\r\n            } else {\r\n                // === Web Worker branch ===\r\n                console.log('Running Dorling simulation asynchronously in a Web Worker')\r\n                const worker = new Worker(new URL('./dorling-worker.js', import.meta.url), { type: 'module' })\r\n                worker.postMessage({\r\n                    nodes: nodes.map((n) => ({ ...n })), // shallow clone\r\n                    radii: nodes.map((n) => radiusAccessor(n)),\r\n                    strengthX,\r\n                    strengthY,\r\n                    iterations,\r\n                    d3URL,\r\n                })\r\n\r\n                worker.onmessage = (e) => {\r\n                    const { type, nodes: finalNodes, progress, total } = e.data\r\n                    if (type === 'progress') {\r\n                        updateDorlingProgress(progress / total, singleMap)\r\n                        return\r\n                    }\r\n                    if (type === 'end' && finalNodes) {\r\n                        nodes.forEach((node, i) => {\r\n                            node.x = finalNodes[i].x\r\n                            node.y = finalNodes[i].y\r\n                        })\r\n                        tickTransform(containers)\r\n                        updateDorlingProgress(1, singleMap)\r\n                        worker.terminate()\r\n                    }\r\n                }\r\n                return\r\n            }\r\n        }\r\n\r\n        // === Animated branch ===\r\n        singleMap.simulation = forceSimulation(nodes)\r\n            .force('x', forceX((d) => d.properties.centroid[0]).strength(strengthX))\r\n            .force('y', forceY((d) => d.properties.centroid[1]).strength(strengthY))\r\n            .force('collide', forceCollide((d) => radiusAccessor(d)).iterations(iterations))\r\n            .on('tick', () => tickTransform(containers))\r\n\r\n        return singleMap.simulation\r\n    }\r\n\r\n    // Run on main map\r\n    runSim(map)\r\n\r\n    // Run on all insets\r\n    if (map.insetTemplates_) {\r\n        executeForAllInsets(map.insetTemplates_, map.svgId_, (inset) => {\r\n            runSim(inset)\r\n        })\r\n    }\r\n}\r\n\r\nfunction updateDorlingProgress(progress, map) {\r\n    if (map.onDorlingProgress_) {\r\n        map.onDorlingProgress_(progress, map)\r\n    }\r\n}\r\n\r\nexport function stopDorlingSimulation(map) {\r\n    if (!map.simulation) return\r\n    map.simulation.stop()\r\n    map.simulation.on('tick', null)\r\n    map.simulation = null\r\n}\r\n\r\n// Optional API setters\r\nexport function dorlingWorker(flag) {\r\n    this.dorlingWorker_ = flag\r\n    return this\r\n}\r\n\r\nexport function dorlingWorkerD3URL(url) {\r\n    this.dorlingWorkerD3URL_ = url\r\n    return this\r\n}\r\n","import {linearish} from \"./linear.js\";\nimport {copy, identity, transformer} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\n\nfunction transformPow(exponent) {\n  return function(x) {\n    return x < 0 ? -Math.pow(-x, exponent) : Math.pow(x, exponent);\n  };\n}\n\nfunction transformSqrt(x) {\n  return x < 0 ? -Math.sqrt(-x) : Math.sqrt(x);\n}\n\nfunction transformSquare(x) {\n  return x < 0 ? -x * x : x * x;\n}\n\nexport function powish(transform) {\n  var scale = transform(identity, identity),\n      exponent = 1;\n\n  function rescale() {\n    return exponent === 1 ? transform(identity, identity)\n        : exponent === 0.5 ? transform(transformSqrt, transformSquare)\n        : transform(transformPow(exponent), transformPow(1 / exponent));\n  }\n\n  scale.exponent = function(_) {\n    return arguments.length ? (exponent = +_, rescale()) : exponent;\n  };\n\n  return linearish(scale);\n}\n\nexport default function pow() {\n  var scale = powish(transformer());\n\n  scale.copy = function() {\n    return copy(scale, pow()).exponent(scale.exponent());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n\nexport function sqrt() {\n  return pow.apply(null, arguments).exponent(0.5);\n}\n","import { scaleLinear, scaleSqrt } from \"d3-scale\";\r\nimport { max, min } from \"d3-array\";\r\n\r\n/**\r\n * Create a proportional circle radius scale (area  value)\r\n *\r\n * @param {Array<number>} rawData  Raw statistical values\r\n * @param {number} maxSize         Maximum radius in px\r\n * @param {number} minSize         Minimum visible radius for positive values\r\n */\r\nexport function createSqrtScale(\r\n  rawData = [],\r\n  maxSize = 20,\r\n  minSize = 0\r\n) {\r\n  // ----------------------------\r\n  // 1. Sanitize data\r\n  // ----------------------------\r\n  const positives = rawData\r\n    .map(Number)\r\n    .filter(v => Number.isFinite(v) && v > 0);\r\n\r\n  let dataMax = max(positives);\r\n  let dataMin = min(positives);\r\n\r\n  if (!Number.isFinite(dataMax) || dataMax <= 0) dataMax = 1;\r\n  if (!Number.isFinite(dataMin) || dataMin <= 0) dataMin = dataMax;\r\n\r\n  const minR = Math.max(0, minSize);\r\n\r\n  // ----------------------------\r\n  // 2. Base sqrt scale (area-correct)\r\n  // ----------------------------\r\n  const base = scaleSqrt()\r\n    .domain([0, dataMax])\r\n    .range([0, maxSize])\r\n    .clamp(true);\r\n\r\n  // ----------------------------\r\n  // 3. Final classifier\r\n  // ----------------------------\r\n  function scale(v) {\r\n    const x = +v;\r\n    if (!Number.isFinite(x) || x <= 0) return 0;\r\n    return Math.max(minR, base(x));\r\n  }\r\n\r\n  // ----------------------------\r\n  // 4. D3-like helpers\r\n  // ----------------------------\r\n  scale.domain = () => [dataMin, dataMax];\r\n  scale.maxSize = () => maxSize;\r\n  scale.minSize = () => minR;\r\n  scale.baseScale = () => base;\r\n\r\n  return scale;\r\n}\r\n\r\n\r\n/**\r\n * Create a linear scale (e.g for line widths)\r\n *\r\n * @param {Array<number>} rawData  Raw statistical values\r\n * @param {number} maxSize         Maximum width in px\r\n * @param {number} minSize         Minimum visible width for positive values\r\n */\r\nexport function createLinearScale(\r\n  rawData = [],\r\n  maxSize = 20,\r\n  minSize = 0\r\n) {\r\n  // ----------------------------\r\n  // 1. Sanitize data\r\n  // ----------------------------\r\n  const positives = rawData\r\n    .map(Number)\r\n    .filter(v => Number.isFinite(v) && v > 0);\r\n\r\n  let dataMax = max(positives);\r\n  let dataMin = min(positives);\r\n\r\n  if (!Number.isFinite(dataMax) || dataMax <= 0) dataMax = 1;\r\n  if (!Number.isFinite(dataMin) || dataMin <= 0) dataMin = dataMax;\r\n\r\n  const minR = Math.max(0, minSize);\r\n\r\n  // ----------------------------\r\n  // 2. Base linear scale\r\n  // ----------------------------\r\n  const base = scaleLinear()\r\n    .domain([0, dataMax])\r\n    .range([0, maxSize])\r\n    .clamp(true);\r\n\r\n  // ----------------------------\r\n  // 3. Final classifier\r\n  // ----------------------------\r\n  function scale(v) {\r\n    const x = +v;\r\n    if (!Number.isFinite(x) || x <= 0) return 0;\r\n    return Math.max(minR, base(x));\r\n  }\r\n\r\n  // ----------------------------\r\n  // 4. D3-like helpers\r\n  // ----------------------------\r\n  scale.domain = () => [dataMin, dataMax];\r\n  scale.maxSize = () => maxSize;\r\n  scale.minSize = () => minR;\r\n  scale.baseScale = () => base;\r\n\r\n  return scale;\r\n}\r\n","import { createSqrtScale, createLinearScale } from \"../../core/scale.js\";\r\nimport { scaleQuantile, scaleQuantize, scaleThreshold } from 'd3-scale'\r\n\r\n/**\r\n * @description defines classifier functions (out.classifierColor and out.classifierSize) for both symbol size and color\r\n */\r\nexport function defineClassifiers(out) {\r\n    defineSizeClassifier(out)\r\n\r\n    // colour\r\n    if (out.statData('color').getArray()) {\r\n        defineColorClassifier(out)\r\n    }\r\n}\r\n\r\nfunction defineColorClassifier(out) {\r\n    //simply return the array [0,1,2,3,...,nb-1]\r\n    const getA = function (nb) {\r\n        return [...Array(nb).keys()]\r\n    }\r\n    //use suitable classification type for colouring\r\n    if (out.psClassificationMethod_ === 'quantile') {\r\n        //https://github.com/d3/d3-scale#quantile-scales\r\n        const domain = out.statData('color').getArray()\r\n        const range = getA(out.psClasses_)\r\n        out.classifierColor(scaleQuantile().domain(domain).range(range))\r\n    } else if (out.psClassificationMethod_ === 'equinter') {\r\n        //https://github.com/d3/d3-scale#quantize-scales\r\n        const domain = out.statData('color').getArray()\r\n        const range = getA(out.psClasses_)\r\n        out.classifierColor(\r\n            scaleQuantize()\r\n                .domain([min(domain), max(domain)])\r\n                .range(range)\r\n        )\r\n        if (out.makeClassifNice_) out.classifierColor().nice()\r\n    } else if (out.psClassificationMethod_ === 'threshold') {\r\n        //https://github.com/d3/d3-scale#threshold-scales\r\n        out.psClasses(out.psThresholds().length + 1)\r\n        const range = getA(out.psClasses_)\r\n        out.classifierColor(scaleThreshold().domain(out.psThresholds()).range(range))\r\n    }\r\n}\r\n\r\nfunction defineSizeClassifier(out) {\r\n    // raw values (size-specific first, fallback)\r\n    const rawData = out.statData('size')?.getArray() ?? out.statData()?.getArray() ?? []\r\n\r\n    // choose scale type based on shape\r\n    const isLinear = out.psShape_ === 'spike' || out.psShape_ === 'bar' || out.psShape_ === 'line'\r\n\r\n    const classifier = isLinear\r\n        ? createLinearScale(rawData, out.psMaxSize_, out.psMinSize_ || 0)\r\n        : createSqrtScale(rawData, out.psMaxSize_, out.psMinSize_ || 0)\r\n\r\n    // expose on map instance (unchanged public API)\r\n    out.classifierSize(classifier)\r\n}\r\n\r\n/**\r\n * @description assigns a color to each symbol, based on their statistical value\r\n * @param {*} map\r\n */\r\nexport function applyClassificationToMap(map) {\r\n    if (map.svg_) {\r\n        if (map.classifierColor_) {\r\n            //assign color class to each symbol, based on their value\r\n            // at this point, the symbol path hasnt been appended. Only the parent g element (.em-centroid)\r\n            const colorData = map.statData('color')\r\n            map.svg_.selectAll('.em-centroid').attr('ecl', function (rg) {\r\n                const sv = colorData.get(rg.properties.id)\r\n                if (!sv) {\r\n                    return 'nd'\r\n                }\r\n                const v = sv.value\r\n                if ((v !== 0 && !v) || v == ':') {\r\n                    return 'nd'\r\n                }\r\n                let c = +map.classifierColor_(+v)\r\n                return c\r\n            })\r\n        }\r\n    }\r\n}\r\n","import { color as d3color } from 'd3-color';\r\nimport { updateCSSRule } from '../../core/utils';\r\n\r\n//update the color of background regions of a proportional symbol map\r\nexport function updateBackgroundColor(map, symbolFill) {\r\n    const symbolColor = symbolFill || '#ffffff'\r\n    const c = d3color(symbolColor)\r\n    const hexColor = c ? c.formatHex() : '#ffffff'\r\n    const mapId = map.svgId_ || ''\r\n    const brightenFactor = map.psBrightenFactor_ || 0.9\r\n    const backgroundColor = getBackgroundColor(hexColor, brightenFactor)\r\n\r\n    updateCSSRule(`#${mapId}.em--ps .em-nutsrg`, 'fill', backgroundColor)\r\n}\r\n\r\nfunction getBackgroundColor(fillColor, brightenFactor) {\r\n    return brightenHex(fillColor, brightenFactor)\r\n}\r\n\r\nfunction brightenHex(hex, brightenFactor) {\r\n    const factor = brightenFactor // Brightening factor (0 to 1)\r\n    // Ensure valid hex\r\n    hex = hex.replace(/^#/, '')\r\n    if (hex.length === 3) {\r\n        hex = hex\r\n            .split('')\r\n            .map((c) => c + c)\r\n            .join('')\r\n    }\r\n\r\n    // Parse RGB\r\n    const num = parseInt(hex, 16)\r\n    let r = (num >> 16) & 255\r\n    let g = (num >> 8) & 255\r\n    let b = num & 255\r\n\r\n    // Increase brightness\r\n    r = Math.min(255, Math.round(r + (255 - r) * factor))\r\n    g = Math.min(255, Math.round(g + (255 - g) * factor))\r\n    b = Math.min(255, Math.round(b + (255 - b) * factor))\r\n\r\n    // Return new hex\r\n    return `#${((1 << 24) | (r << 16) | (g << 8) | b).toString(16).slice(1)}`\r\n}\r\n","export default function(x, y) {\n  if (isNaN(x = +x) || isNaN(y = +y)) return this; // ignore invalid points\n\n  var x0 = this._x0,\n      y0 = this._y0,\n      x1 = this._x1,\n      y1 = this._y1;\n\n  // If the quadtree has no extent, initialize them.\n  // Integer extent are necessary so that if we later double the extent,\n  // the existing quadrant boundaries dont change due to floating point error!\n  if (isNaN(x0)) {\n    x1 = (x0 = Math.floor(x)) + 1;\n    y1 = (y0 = Math.floor(y)) + 1;\n  }\n\n  // Otherwise, double repeatedly to cover.\n  else {\n    var z = x1 - x0 || 1,\n        node = this._root,\n        parent,\n        i;\n\n    while (x0 > x || x >= x1 || y0 > y || y >= y1) {\n      i = (y < y0) << 1 | (x < x0);\n      parent = new Array(4), parent[i] = node, node = parent, z *= 2;\n      switch (i) {\n        case 0: x1 = x0 + z, y1 = y0 + z; break;\n        case 1: x0 = x1 - z, y1 = y0 + z; break;\n        case 2: x1 = x0 + z, y0 = y1 - z; break;\n        case 3: x0 = x1 - z, y0 = y1 - z; break;\n      }\n    }\n\n    if (this._root && this._root.length) this._root = node;\n  }\n\n  this._x0 = x0;\n  this._y0 = y0;\n  this._x1 = x1;\n  this._y1 = y1;\n  return this;\n}\n","export default function() {\n  var data = [];\n  this.visit(function(node) {\n    if (!node.length) do data.push(node.data); while (node = node.next)\n  });\n  return data;\n}\n","export default function(_) {\n  return arguments.length\n      ? this.cover(+_[0][0], +_[0][1]).cover(+_[1][0], +_[1][1])\n      : isNaN(this._x0) ? undefined : [[this._x0, this._y0], [this._x1, this._y1]];\n}\n","import Quad from \"./quad.js\";\n\nexport default function(x, y, radius) {\n  var data,\n      x0 = this._x0,\n      y0 = this._y0,\n      x1,\n      y1,\n      x2,\n      y2,\n      x3 = this._x1,\n      y3 = this._y1,\n      quads = [],\n      node = this._root,\n      q,\n      i;\n\n  if (node) quads.push(new Quad(node, x0, y0, x3, y3));\n  if (radius == null) radius = Infinity;\n  else {\n    x0 = x - radius, y0 = y - radius;\n    x3 = x + radius, y3 = y + radius;\n    radius *= radius;\n  }\n\n  while (q = quads.pop()) {\n\n    // Stop searching if this quadrant cant contain a closer node.\n    if (!(node = q.node)\n        || (x1 = q.x0) > x3\n        || (y1 = q.y0) > y3\n        || (x2 = q.x1) < x0\n        || (y2 = q.y1) < y0) continue;\n\n    // Bisect the current quadrant.\n    if (node.length) {\n      var xm = (x1 + x2) / 2,\n          ym = (y1 + y2) / 2;\n\n      quads.push(\n        new Quad(node[3], xm, ym, x2, y2),\n        new Quad(node[2], x1, ym, xm, y2),\n        new Quad(node[1], xm, y1, x2, ym),\n        new Quad(node[0], x1, y1, xm, ym)\n      );\n\n      // Visit the closest quadrant first.\n      if (i = (y >= ym) << 1 | (x >= xm)) {\n        q = quads[quads.length - 1];\n        quads[quads.length - 1] = quads[quads.length - 1 - i];\n        quads[quads.length - 1 - i] = q;\n      }\n    }\n\n    // Visit this point. (Visiting coincident points isnt necessary!)\n    else {\n      var dx = x - +this._x.call(null, node.data),\n          dy = y - +this._y.call(null, node.data),\n          d2 = dx * dx + dy * dy;\n      if (d2 < radius) {\n        var d = Math.sqrt(radius = d2);\n        x0 = x - d, y0 = y - d;\n        x3 = x + d, y3 = y + d;\n        data = node.data;\n      }\n    }\n  }\n\n  return data;\n}\n","export default function(d) {\n  if (isNaN(x = +this._x.call(null, d)) || isNaN(y = +this._y.call(null, d))) return this; // ignore invalid points\n\n  var parent,\n      node = this._root,\n      retainer,\n      previous,\n      next,\n      x0 = this._x0,\n      y0 = this._y0,\n      x1 = this._x1,\n      y1 = this._y1,\n      x,\n      y,\n      xm,\n      ym,\n      right,\n      bottom,\n      i,\n      j;\n\n  // If the tree is empty, initialize the root as a leaf.\n  if (!node) return this;\n\n  // Find the leaf node for the point.\n  // While descending, also retain the deepest parent with a non-removed sibling.\n  if (node.length) while (true) {\n    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;\n    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;\n    if (!(parent = node, node = node[i = bottom << 1 | right])) return this;\n    if (!node.length) break;\n    if (parent[(i + 1) & 3] || parent[(i + 2) & 3] || parent[(i + 3) & 3]) retainer = parent, j = i;\n  }\n\n  // Find the point to remove.\n  while (node.data !== d) if (!(previous = node, node = node.next)) return this;\n  if (next = node.next) delete node.next;\n\n  // If there are multiple coincident points, remove just the point.\n  if (previous) return (next ? previous.next = next : delete previous.next), this;\n\n  // If this is the root point, remove it.\n  if (!parent) return this._root = next, this;\n\n  // Remove this leaf.\n  next ? parent[i] = next : delete parent[i];\n\n  // If the parent now contains exactly one leaf, collapse superfluous parents.\n  if ((node = parent[0] || parent[1] || parent[2] || parent[3])\n      && node === (parent[3] || parent[2] || parent[1] || parent[0])\n      && !node.length) {\n    if (retainer) retainer[j] = node;\n    else this._root = node;\n  }\n\n  return this;\n}\n\nexport function removeAll(data) {\n  for (var i = 0, n = data.length; i < n; ++i) this.remove(data[i]);\n  return this;\n}\n","export default function() {\n  return this._root;\n}\n","export default function() {\n  var size = 0;\n  this.visit(function(node) {\n    if (!node.length) do ++size; while (node = node.next)\n  });\n  return size;\n}\n","import Quad from \"./quad.js\";\n\nexport default function(callback) {\n  var quads = [], q, node = this._root, child, x0, y0, x1, y1;\n  if (node) quads.push(new Quad(node, this._x0, this._y0, this._x1, this._y1));\n  while (q = quads.pop()) {\n    if (!callback(node = q.node, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1) && node.length) {\n      var xm = (x0 + x1) / 2, ym = (y0 + y1) / 2;\n      if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));\n      if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));\n      if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));\n      if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));\n    }\n  }\n  return this;\n}\n","import Quad from \"./quad.js\";\n\nexport default function(callback) {\n  var quads = [], next = [], q;\n  if (this._root) quads.push(new Quad(this._root, this._x0, this._y0, this._x1, this._y1));\n  while (q = quads.pop()) {\n    var node = q.node;\n    if (node.length) {\n      var child, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1, xm = (x0 + x1) / 2, ym = (y0 + y1) / 2;\n      if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));\n      if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));\n      if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));\n      if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));\n    }\n    next.push(q);\n  }\n  while (q = next.pop()) {\n    callback(q.node, q.x0, q.y0, q.x1, q.y1);\n  }\n  return this;\n}\n","import { getRegionsSelector } from '../../core/utils'\r\nimport { getSizeStatData } from './map-proportional-symbols'\r\nimport { select } from 'd3-selection'\r\n\r\nexport function addMouseEvents(map, out) {\r\n    addMouseEventsToSymbols(map, out)\r\n    addMouseEventsToRegions(map, out)\r\n}\r\n\r\nconst addMouseEventsToRegions = function (map, out) {\r\n    const regions = map.svg().selectAll(getRegionsSelector(map))\r\n    const sizeData = getSizeStatData(map)\r\n    regions\r\n        .on('mouseover', function (e, rg) {\r\n            // only show tooltip for polygons of regions with values of 0\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv?.value === 0 || sv?.value === ':' || sv?.value === '0') {\r\n                select(this).style('fill', map.hoverColor_) // Apply highlight color\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n            } else {\r\n                return // skip regions with no input or value > 0\r\n            }\r\n        })\r\n        .on('mousemove', function (e, rg) {\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv?.value === 0 || sv?.value === ':' || sv?.value === '0') {\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n                if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n            } else {\r\n                return // skip regions with no data or value > 0\r\n            }\r\n        })\r\n        .on('mouseout', function (e, rg) {\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv?.value === 0 || sv?.value === ':' || sv?.value === '0') {\r\n                const sel = select(this)\r\n                sel.style('fill', sel.attr('fill___')) // Revert to original color\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n            } else {\r\n                return // skip regions with no data or value > 0\r\n            }\r\n        })\r\n}\r\nconst addMouseEventsToSymbols = function (map, out) {\r\n    const symbols = map.svg().selectAll('g.em-centroid')\r\n    //symbols\r\n    symbols\r\n        .on('mouseover', function (e, rg) {\r\n            const sel = select(this.childNodes[0])\r\n            sel.attr('fill___', sel.style('fill'))\r\n            sel.style('fill', out.hoverColor_)\r\n            if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n        })\r\n        .on('mousemove', function (e, rg) {\r\n            if (out._tooltip) out._tooltip.mousemove(e)\r\n            if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n        })\r\n        .on('mouseout', function (e, rg) {\r\n            const sel = select(this.childNodes[0])\r\n            let newFill = sel.attr('fill___')\r\n            if (newFill) {\r\n                sel.style('fill', newFill)\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n            }\r\n            if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n        })\r\n}\r\n","export function appendSpikesToMap(map, sizeData, out) {\r\n    //The spike function creates a triangular path of the given length (height) with a base width of 7 pixels.\r\n    const spike = (length, width = out.psSpikeWidth_) => `M${-width / 2},0L0,${-length}L${width / 2},0`\r\n    let symbolContainers = map.svg().selectAll('g.em-centroid')\r\n\r\n    // Append circles to each symbol container\r\n    const spikes = symbolContainers\r\n        .append('path')\r\n        .attr('d', (d) => {\r\n            const datum = sizeData.get(d.properties.id)\r\n            const value = datum ? out.classifierSize_(+datum.value) : 0\r\n            let path = spike(value)\r\n            return path\r\n        })\r\n        .style('fill', (d) => d.color || 'steelblue') // Adjust color as needed\r\n        //.attr('fill', map.psFill_)\r\n        .attr('fill-opacity', map.psFillOpacity_)\r\n        .attr('stroke', map.psStroke_)\r\n        .attr('stroke-width', map.psStrokeWidth_)\r\n\r\n    return spikes\r\n}\r\n","import { max, min } from 'd3-array'\r\nimport { select } from 'd3-selection'\r\nimport { interpolateOrRd } from 'd3-scale-chromatic'\r\nimport * as StatMap from '../../core/stat-map.js'\r\nimport * as ProportionalSymbolLegend from '../../legend/proportional-symbol/legend-proportional-symbols.js'\r\n\r\nimport { spaceAsThousandSeparator, executeForAllInsets, getRegionsSelector, getTextColorForBackground, updateCSSRule } from '../../core/utils.js'\r\nimport { applyPatternFill } from '../../core/pattern-fill.js'\r\nimport { runDorlingSimulation, stopDorlingSimulation } from '../../core/dorling/dorling.js'\r\nimport { applyClassificationToMap, defineClassifiers } from './ps-classification.js'\r\nimport { updateBackgroundColor } from './ps-background.js'\r\nimport { addMouseEvents } from './ps-interactions.js'\r\nimport { appendSpikesToMap } from './symbols/spikes.js'\r\nimport { appendCirclesToMap } from './symbols/circles.js'\r\nimport { appendBarsToMap } from './symbols/bars.js'\r\nimport { appendD3SymbolsToMap } from './symbols/d3-symbols.js'\r\nimport { appendCustomSymbolsToMap } from './symbols/custom.js'\r\n\r\n/**\r\n * Returns a proportional symbol map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, true, 'ps')\r\n\r\n    //shape\r\n    out.psShape_ = 'circle' // accepted values: circle, bar, square, star, diamond, wye, cross\r\n    out.psCustomShape_ // see http://using-d3js.com/05_10_symbols.html#h_66iIQ5sJIT\r\n    out.psCustomSVG_ // see http://bl.ocks.org/jessihamel/9648495\r\n    out.psSpikeWidth_ = 7 // 'spike' shape widths\r\n    out.psOffset_ = { x: 0, y: 0 }\r\n\r\n    //size\r\n    out.psMaxSize_ = 30 // max symbol size\r\n    out.psMinSize_ = 5 // min symbol size\r\n    out.psBarWidth_ = 10 //for vertical bars\r\n    out.psMaxValue_ = undefined // allow the user to manually define the domain of the sizing scale. E.g. if the user wants to use the same scale across different maps.\r\n    out.psMinValue_ = undefined\r\n    out.psSizeScale_ = undefined // 'sqrt' or 'linear'\r\n\r\n    //colour\r\n    out.psFill_ = '#009569' //same fill for all symbols when no visual variable (setData()) for 'color' is specified\r\n    out.psFillOpacity_ = 1\r\n    out.psStroke_ = '#ffffff'\r\n    out.psStrokeWidth_ = 0.2\r\n    out.psStrokeOpacity_ = 1\r\n    out.psClasses_ = 5 // number of classes to use for colouring\r\n    out.psColors_ = null //colours to use for threshold colouring\r\n    out.psColorFun_ = interpolateOrRd\r\n    out.psClassToFillStyle_ = undefined //a function returning the color from the class i\r\n    out.psBrightenFactor_ = 0.9 // factor for brightening background color of regions\r\n\r\n    //the threshold, when the classification method is 'threshold'\r\n    out.psThresholds_ = [0]\r\n    //the classification method\r\n    out.psClassificationMethod_ = 'quantile' // or: equinter, threshold\r\n    //when computed automatically, ensure the threshold are nice rounded values\r\n    out.makeClassifNice_ = true\r\n    //\r\n    //the classifier: a function which return the symbol size/color from the stat value.\r\n    out.classifierSize_ = undefined\r\n    out.classifierColor_ = undefined\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = tooltipTextFunPs\r\n\r\n    out.psCodeLabels_ = false // show country codes in symbols\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    const paramNames = [\r\n        'psMaxSize_',\r\n        'psMinSize_',\r\n        'psMaxValue_',\r\n        'psMinValue_',\r\n        'psFill_',\r\n        'psFillOpacity_',\r\n        'psStrokeOpacity_',\r\n        'psStroke_',\r\n        'psStrokeWidth_',\r\n        'classifierSize_',\r\n        'classifierColor_',\r\n        'psShape_',\r\n        'psCustomShape_',\r\n        'psBarWidth_',\r\n        'psClassToFillStyle_',\r\n        'psColorFun_',\r\n        'psSizeScale_',\r\n        'noDataFillStyle_',\r\n        'psThresholds_',\r\n        'psColors_',\r\n        'psCustomSVG_',\r\n        'psOffset_',\r\n        'psClassificationMethod_',\r\n        'psClasses_',\r\n        'dorling_',\r\n        'dorlingStrength_',\r\n        'dorlingIterations_',\r\n        'animateDorling_',\r\n        'psSpikeWidth_',\r\n        'psCodeLabels_',\r\n        'psBrightenFactor_',\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    //override of some special getters/setters\r\n    out.psColorFun = function (v) {\r\n        if (!arguments.length) return out.psColorFun_\r\n        out.psColorFun_ = v\r\n        out.psClassToFillStyle_ = getColorLegend(out.psColorFun_, out.psColors_)\r\n        return out\r\n    }\r\n    out.psThresholds = function (v) {\r\n        if (!arguments.length) return out.psThresholds_\r\n        out.psThresholds_ = v\r\n        out.psClasses(v.length + 1)\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        try {\r\n            //define classifiers for sizing and colouring (out.classifierSize_ & out.classifierColor_)\r\n            defineClassifiers(out)\r\n\r\n            // apply classification to all insets that are outside of the main map's SVG\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n            }\r\n\r\n            // apply to main map\r\n            applyClassificationToMap(out)\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in proportional symbols classification: ' + e.message)\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Applies proportional symbol styling to a map object\r\n     *\r\n     * @param {*} map\r\n     * @returns\r\n     */\r\n    function applyStyleToMap(map) {\r\n        // update region color according to symbol color\r\n        updateBackgroundColor(map, out.psFill_)\r\n\r\n        //define style per class\r\n        if (!out.psClassToFillStyle()) out.psClassToFillStyle(getColorLegend(out.psColorFun_, out.psColors_))\r\n\r\n        // if size dataset not defined then use default\r\n        const sizeData = getSizeStatData(map)\r\n\r\n        if (map.svg_) {\r\n            //clear previous centroids\r\n            let prevSymbols = map.svg_.selectAll(':not(#em-insets-group) g.em-centroid > *')\r\n            prevSymbols.remove()\r\n\r\n            // 'small' centroids on top of big ones\r\n            out.updateSymbolsDrawOrder(map)\r\n\r\n            // append symbols to centroids\r\n            let symb\r\n            if (out.psCustomSVG_) {\r\n                symb = appendCustomSymbolsToMap(map, sizeData, out)\r\n            } else if (out.psShape_ == 'bar') {\r\n                symb = appendBarsToMap(map, sizeData, out)\r\n            } else if (out.psShape_ == 'circle') {\r\n                symb = appendCirclesToMap(map, sizeData, out)\r\n            } else if (out.psShape_ == 'spike') {\r\n                symb = appendSpikesToMap(map, sizeData, out)\r\n            } else {\r\n                // circle, cross, star, triangle, diamond, square, wye or custom\r\n                symb = appendD3SymbolsToMap(map, sizeData, out)\r\n            }\r\n\r\n            setRegionStyles(map, sizeData)\r\n            setSymbolStyles(symb)\r\n            appendLabelsToSymbols(map, sizeData)\r\n            addMouseEvents(map, out)\r\n\r\n            // Update labels for statistical values if required\r\n            if (out.labels_?.values) {\r\n                out.updateValuesLabels(map)\r\n            }\r\n\r\n            //add hatching if needed\r\n            if (out.patternFill_) {\r\n                applyPatternFill(map, out.patternFill_)\r\n            }\r\n        }\r\n        return map\r\n    }\r\n\r\n    const setRegionStyles = function (map, sizeData) {\r\n        // set style of symbols\r\n        const selector = getRegionsSelector(map)\r\n        const regions = map.svg().selectAll(selector)\r\n\r\n        if (map.geo_ !== 'WORLD') {\r\n            if (map.nutsLevel_ == 'mixed') {\r\n                styleMixedNUTSRegions(map, sizeData, regions)\r\n                // Build centroidFeatures so Dorling has something to simulate\r\n                const centroids = []\r\n                map.svg()\r\n                    .selectAll('g.em-centroid')\r\n                    .each(function (d) {\r\n                        if (!d.properties?.centroid) return\r\n                        centroids.push(d) // d already has properties and id\r\n                    })\r\n                map.Geometries.centroidsFeatures = centroids\r\n            }\r\n\r\n            // apply 'nd' class to no data regions for legend item hover\r\n            regions.attr('ecl', function (rg) {\r\n                const sv = sizeData.get(rg.properties.id)\r\n                if (!sv || (!sv.value && sv !== 0 && sv.value !== 0 && sv.value !== '0')) {\r\n                    // NO INPUT\r\n                    return 'ni'\r\n                } else if (sv && sv.value) {\r\n                    if (sv.value == ':') {\r\n                        // DATA NOT AVAILABLE (no data)\r\n                        return 'nd'\r\n                    }\r\n                }\r\n            })\r\n\r\n            // 1) clear any previous inline fill so CSS can apply to regions that now have data\r\n            regions.style('fill', null)\r\n\r\n            // 2) apply gray only to current no-data (\":\") regions\r\n            regions\r\n                .filter((rg) => {\r\n                    const sv = sizeData.get(rg.properties.id)\r\n                    return sv && sv.value === ':'\r\n                })\r\n                .style('fill', out.noDataFillStyle())\r\n                .attr('fill___', out.noDataFillStyle()) // save for legend mouseover\r\n        }\r\n    }\r\n\r\n    const appendLabelsToSymbols = function (map, sizeData) {\r\n        let symbolContainers = map.svg().selectAll('g.em-centroid')\r\n        //country code labels\r\n        if (out.psCodeLabels_) {\r\n            const countryCodeLabel = symbolContainers\r\n                .filter((d) => {\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    return datum?.value !== ':' && datum?.value != null // Ignore `':'`, `null`, and `undefined`\r\n                })\r\n                .append('text')\r\n                .attr('class', 'em-circle-code-label')\r\n                .text((d) => {\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    return datum?.value === ':' ? '' : d.properties.id // Hide text if value is ':'\r\n                })\r\n                .attr('text-anchor', 'middle')\r\n                .attr('dominant-baseline', 'middle')\r\n                .attr('font-family', 'sans-serif')\r\n                .style('font-size', (d) => {\r\n                    // calculate radius\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    const radius = datum ? out.classifierSize_(+datum.value) : 0\r\n                    // size adjustment factor depends on symbol type, and whether stat values are also added to the circles\r\n                    let factor = out.labels_?.values && sizeData.get(d.properties.id)?.value ? 0.8 : 0.9\r\n                    if (out.psShape_ === 'square') factor = factor - 0.4\r\n                    return `${radius * factor}px`\r\n                })\r\n                .attr('fill', function () {\r\n                    const fill = window.getComputedStyle(this.parentNode.firstChild)?.fill\r\n                    return getTextColorForBackground(fill)\r\n                })\r\n                .attr('dy', (d) => (out.labels_?.values && sizeData.get(d.properties.id)?.value ? '-0.3em' : '0'))\r\n        }\r\n\r\n        //stat labels\r\n        if (out.labels_?.values) {\r\n            const statLabels = symbolContainers\r\n                .filter((d) => {\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    return datum?.value !== ':' && datum?.value != null // Ignore `':'`, `null`, and `undefined`\r\n                })\r\n                .append('text')\r\n                .attr('class', 'em-circle-stat-label')\r\n                .text((d) => {\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    if (datum?.value) return datum.value\r\n                })\r\n                .attr('text-anchor', 'middle')\r\n                .attr('dominant-baseline', 'middle')\r\n                .attr('font-family', 'sans-serif')\r\n                .style('font-size', (d) => {\r\n                    // calculate radius\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    const radius = datum ? out.classifierSize_(+datum.value) : 0\r\n                    return `${radius * 0.4}px`\r\n                })\r\n                .attr('fill', function () {\r\n                    const fill = window.getComputedStyle(this.parentNode.firstChild)?.fill || out.psFill_\r\n                    return getTextColorForBackground(fill)\r\n                })\r\n                .attr('dy', (d) => (out.psCodeLabels_ ? '0.8em' : '0'))\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description sets color/stroke/opacity styles of all symbols\r\n     * @param {d3.selection} symb symbols d3 selection\r\n     */\r\n    function setSymbolStyles(symb) {\r\n        symb.attr('fill-opacity', out.psFillOpacity())\r\n            .attr('stroke-opacity', out.psStrokeOpacity())\r\n            .attr('stroke', out.psStroke())\r\n            .attr('stroke-width', out.psStrokeWidth())\r\n            .style('fill', function () {\r\n                if (out.classifierColor_) {\r\n                    //for ps, ecl attribute belongs to the parent g.em-centroid node created in map-template\r\n                    const ecl = select(this.parentNode).attr('ecl')\r\n                    if (!ecl || ecl === 'nd') return out.noDataFillStyle_ || 'gray'\r\n                    let color = out.psClassToFillStyle_(ecl, out.psClasses_)\r\n                    return color\r\n                } else {\r\n                    return out.psFill_\r\n                }\r\n            })\r\n            .attr('fill___', function () {\r\n                let fill = select(this).style('fill')\r\n                return fill // save for legend mouseover\r\n            })\r\n    }\r\n\r\n    /**\r\n     * @description Updates the draw order of the symbols according to their data values\r\n     * @param {*} map map instance\r\n     */\r\n    out.updateSymbolsDrawOrder = function (map) {\r\n        const gcp = out.getCentroidsGroup(map)\r\n        const sizeData = getSizeStatData(map)\r\n\r\n        // Ensure centroidFeatures is populated (important for mixed)\r\n        if (!map.Geometries.centroidsFeatures || !map.Geometries.centroidsFeatures.length) {\r\n            // Build features from whatever is currently bound to centroids\r\n            map.Geometries.centroidsFeatures = map\r\n                .svg()\r\n                .selectAll('g.em-centroid')\r\n                .data()\r\n                .filter((d) => d?.properties?.centroid)\r\n        }\r\n\r\n        // Sort features by descending value (largest first so small ones are on top)\r\n        const sorted = map.Geometries.centroidsFeatures\r\n            .filter((f) => {\r\n                const v = sizeData.get?.(f.properties.id)?.value\r\n                return v != null && v !== ':' // exclude no-data\r\n            })\r\n            .sort((a, b) => sizeData.get(b.properties.id).value - sizeData.get(a.properties.id).value)\r\n\r\n        // Clear old symbol containers\r\n        gcp.selectAll('g.em-centroid').remove()\r\n\r\n        // Recreate sorted symbol containers\r\n        gcp.selectAll('g.em-centroid')\r\n            .data(sorted, (d) => d.properties.id)\r\n            .enter()\r\n            .append('g')\r\n            .attr('class', 'em-centroid')\r\n            .attr('id', (d) => 'ps' + d.properties.id)\r\n            .attr('transform', (d) => `translate(${d.properties.centroid[0].toFixed(3)},${d.properties.centroid[1].toFixed(3)})`)\r\n\r\n        // Re-apply classification to the new containers\r\n        applyClassificationToMap(map)\r\n    }\r\n\r\n    /**\r\n     * @description adds proportional symbols to each regions in a map with mixed NUTS levels (IMAGE)\r\n     * @param {*} map\r\n     * @param {*} sizeData\r\n     * @param {*} regions\r\n     * @return {*}\r\n     */\r\n    function styleMixedNUTSRegions(map, sizeData, regions) {\r\n        // toggle display of mixed NUTS levels\r\n        regions.style('display', function (rg) {\r\n            if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (!sv || (!sv.value && sv !== 0 && sv.value !== 0 && sv.value !== '0')) {\r\n                // no symbol for no data\r\n                return 'none'\r\n            } else if (map.geo_ == 'WORLD') {\r\n                return 'block'\r\n            }\r\n        })\r\n\r\n        // nuts border stroke\r\n        regions\r\n            .style('stroke', function (rg) {\r\n                const sel = select(this)\r\n                const lvl = sel.attr('lvl')\r\n                const stroke = sel.style('stroke')\r\n                const sv = sizeData.get(rg.properties.id)\r\n                if (!sv || !sv.value) {\r\n                    return\r\n                } else {\r\n                    if (lvl !== '0') {\r\n                        return stroke || '#777'\r\n                    }\r\n                }\r\n            })\r\n\r\n            // nuts border stroke width\r\n            .style('stroke-width', function (rg) {\r\n                const sel = select(this)\r\n                const lvl = sel.attr('lvl')\r\n                const strokeWidth = sel.style('stroke-width')\r\n                const sv = sizeData.get(rg.properties.id)\r\n                if (!sv || !sv.value) {\r\n                    return\r\n                } else if (out.geo_ == 'WORLD') {\r\n                    if (lvl !== '0') {\r\n                        return strokeWidth || '#777'\r\n                    }\r\n                }\r\n            })\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        try {\r\n            // apply to main map\r\n            applyStyleToMap(out)\r\n\r\n            // apply style to insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n            }\r\n\r\n            // dorling cartogram\r\n            if (out.dorling_) {\r\n                const sizeData = getSizeStatData(out)\r\n                runDorlingSimulation(out, (d) => {\r\n                    const datum = sizeData.get(d.properties.id)\r\n                    const r = datum ? out.classifierSize_(+datum.value) : 0\r\n                    return out.psShape_ === 'square' ? (r / 2) * Math.SQRT2 : r\r\n                })\r\n            } else {\r\n                stopDorlingSimulation(out)\r\n            }\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in proportional symbols styling: ' + e.message)\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return ProportionalSymbolLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n//build a color legend object\r\nexport const getColorLegend = function (colorFun, colorArray) {\r\n    colorFun = colorFun || interpolateOrRd\r\n    if (colorArray) {\r\n        return function (ecl, numberOfClasses) {\r\n            return colorArray[ecl]\r\n        }\r\n    }\r\n    return function (ecl, numberOfClasses) {\r\n        return colorFun(ecl / (numberOfClasses - 1))\r\n    }\r\n}\r\n\r\nexport function getSizeStatData(map) {\r\n    return map.statData('size').getArray() ? map.statData('size') : map.statData()\r\n}\r\n\r\n/**\r\n * Specific function for tooltip text.\r\n *\r\n * @param {*} rg The region to show information on.\r\n * @param {*} map The map element\r\n */\r\n\r\nconst tooltipTextFunPs = function (region, map) {\r\n    if (map.tooltip_.omitRegions && map.tooltip_.omitRegions.includes(region.properties.id)) {\r\n        return '' // Skip tooltip for omitted regions\r\n    }\r\n\r\n    const regionName = region.properties.na\r\n    const regionId = region.properties.id\r\n\r\n    const formatValue = (val, unit, noDataText) => {\r\n        if (val === ':') {\r\n            return noDataText || 'Data not available'\r\n        }\r\n        return spaceAsThousandSeparator(val) + (unit ? ' ' + unit : '')\r\n    }\r\n\r\n    // Stat 1\r\n    const v1 = map.statData('size').getArray() ? map.statData('size') : map.statData()\r\n    const sv1 = v1.get(region.properties.id)\r\n    const unit1 = v1.unitText?.() || ''\r\n    const row1 = `<tr><td>${formatValue(sv1?.value, unit1, map.noDataText_)}</td></tr>`\r\n\r\n    // Stat 2 (optional)\r\n    let row2 = ''\r\n    const v2 = map.statData('color')?.getArray() ? map.statData('color') : null\r\n    if (v2) {\r\n        const sv2 = v2.get(region.properties.id)\r\n        const unit2 = v2.unitText?.() || ''\r\n        row2 = `<tr><td>${formatValue(sv2?.value, unit2, map.noDataText_)}</td></tr>`\r\n    }\r\n\r\n    return `\r\n    <div class=\"em-tooltip-bar\">\r\n      <b>${regionName}</b>${regionId ? ` (${regionId})` : ''}\r\n    </div>\r\n    <div class=\"em-tooltip-text\">\r\n      <table class=\"em-tooltip-table\">\r\n        <tbody>\r\n          ${row1}\r\n          ${row2}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `.trim()\r\n}\r\n","/**\r\n * @description Appends custom SVG symbols for each region in the map\r\n * @param {*} map\r\n * @param {*} sizeData\r\n * @return {*}\r\n */\r\nexport function appendCustomSymbolsToMap(map, sizeData, out) {\r\n    return map\r\n        .getCentroidsGroup(map)\r\n        .selectAll('g.em-centroid')\r\n        .append('g')\r\n        .filter((rg) => {\r\n            const sv = sizeData.get(rg.properties.id)\r\n            if (sv && sv.value !== ':') return rg\r\n        })\r\n        .attr('class', 'ps')\r\n        .html(out.psCustomSVG_)\r\n        .attr('transform', (rg) => {\r\n            //calculate size\r\n            const sv = sizeData.get(rg.properties.id)\r\n            let size = out.classifierSize_(+sv.value)\r\n            if (size) {\r\n                return `translate(${out.psOffset_.x * size},${out.psOffset_.y * size}) scale(${size})`\r\n            }\r\n        })\r\n}\r\n","/**\r\n * @description Appends <rect> elements containing bars for each region in the map SVG\r\n * @param {*} map map instance\r\n * @param {*} sizeData e.g. map.statData('size')\r\n * @return {*}\r\n */\r\nexport function appendBarsToMap(map, sizeData, out) {\r\n    return (\r\n        map\r\n            .getCentroidsGroup(map)\r\n            .selectAll('g.em-centroid')\r\n            .append('rect')\r\n            .filter((rg) => {\r\n                const sv = sizeData.get(rg.properties.id)\r\n                if (sv && sv.value !== ':') return rg\r\n            })\r\n            .attr('width', out.psBarWidth_)\r\n            //for vertical bars we scale the height attribute using the classifier\r\n            .attr('height', function (rg) {\r\n                const sv = sizeData.get(rg.properties.id)\r\n                if (!sv || !sv.value) {\r\n                    return 0\r\n                }\r\n                let v = out.classifierSize_(+sv.value)\r\n                return v\r\n            })\r\n            .attr('transform', function () {\r\n                let bRect = this.getBoundingClientRect()\r\n                return `translate(${-this.getAttribute('width') / 2}` + `, -${this.getAttribute('height')})`\r\n            })\r\n    )\r\n}\r\n","import { select } from 'd3-selection'\r\n/**\r\n * @description Appends <circle> elements for each region in the map SVG\r\n * @param {*} map map instance\r\n * @param {*} sizeData statistical data for size e.g. map.statData('size')\r\n * @param {*} out 'main' map object (as opposed to an inset map object)\r\n * @return {void}\r\n */\r\nexport function appendCirclesToMap(map, sizeData, out) {\r\n    // Append circles to each symbol container\r\n    const circles = map\r\n        .svg()\r\n        .selectAll('g.em-centroid')\r\n        .filter((d) => {\r\n            const datum = sizeData.get(d.properties.id)\r\n            return datum && datum.value !== ':' && datum.value\r\n        })\r\n        .append('circle')\r\n        .attr('stroke-width', out.psStrokeWidth_)\r\n        .attr('stroke', out.psStroke_)\r\n        .attr('fill-opacity', out.psFillOpacity_)\r\n        .attr('stroke-opacity', out.psStrokeOpacity_)\r\n        .style('pointer-events', 'none') // disable interaction during transition\r\n        .transition()\r\n        .duration(out.transitionDuration_)\r\n        .attr('r', function (d) {\r\n            const datum = sizeData.get(d.properties.id)\r\n            const radius = out.classifierSize_(+datum.value)\r\n            if (radius < 0) console.error('Negative radius for circle:', d.properties.id)\r\n            if (isNaN(radius)) console.error('NaN radius for circle:', d.properties.id)\r\n            return radius\r\n        })\r\n        .on('end', function () {\r\n            // Re-enable after animation completes\r\n            select(this).style('pointer-events', null)\r\n        })\r\n\r\n    return circles\r\n}\r\n","import colors from \"../colors.js\";\n\nexport default colors(\"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f\");\n","import { create, select } from 'd3-selection'\r\nimport * as Legend from './legend'\r\nimport { executeForAllInsets, getLegendRegionsSelector } from '../core/utils'\r\nimport { appendPatternFillLegend } from './legend-pattern-fill'\r\n\r\n/**\r\n * A legend for categorical maps\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n    // allow the user to define the order of the legend elements manually as an array\r\n    out.order = undefined\r\n\r\n    //override attribute values with config values\r\n    if (config) for (let key in config) out[key] = config[key]\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        if (out.lgg.node() && out.map.classifier_) {\r\n            // Draw legend background box and title if provided\r\n            out.makeBackgroundBox()\r\n            if (out.title) out.addTitle()\r\n            if (out.subtitle) out.addSubtitle()\r\n\r\n            const baseY = out.getBaseY()\r\n            const baseX = out.getBaseX()\r\n\r\n            out._categoricalContainer = out.lgg.append('g').attr('class', 'em-legend-categorical').attr('transform', `translate(${baseX}, ${baseY})`)\r\n            createCategoricalLegend(out)\r\n\r\n            // Append pattern fill legend items BELOW the main legend\r\n            if (out.map.patternFill_) {\r\n                const legendHeight = out.lgg.node().getBBox().height\r\n                const patternContainer = out.lgg\r\n                    .append('g')\r\n                    .attr('class', 'pattern-fill-legend')\r\n                    .attr('transform', `translate(${baseX}, ${legendHeight + 15})`)\r\n                appendPatternFillLegend(out, patternContainer)\r\n            }\r\n\r\n            // Optionally add no-data\r\n            if (out.noData) {\r\n                const legendHeight = out.lgg.node().getBBox().height + 10 // Add some space below the legend\r\n                const x = baseX\r\n                const container = out.lgg\r\n                    .append('g')\r\n                    .attr('class', 'em-no-data-legend')\r\n                    .attr('transform', `translate(${x},${legendHeight + 15})`)\r\n                out.appendNoDataLegend(container, out.noDataText, highlightRegions, unhighlightRegions)\r\n            }\r\n\r\n            //set legend box dimensions\r\n            out.setBoxDimension()\r\n        }\r\n    }\r\n\r\n    function createCategoricalLegend(out) {\r\n        const container = out._categoricalContainer\r\n        const map = out.map\r\n\r\n        //get category codes\r\n        const domain = map.classToFillStyle() ? Object.keys(map.classToFillStyle()) : map.classifier_.domain()\r\n        const ecls = out.order ? out.order : domain\r\n\r\n        //draw legend elements for classes: rectangle + label\r\n        for (let i = 0; i < ecls.length; i++) {\r\n            //the class\r\n            const ecl_ = ecls[i]\r\n            const ecl = map.classifier_(ecl_)\r\n            const fillColor = map.classToFillStyle_[ecl_]\r\n\r\n            //the vertical position of the legend element\r\n            const y = out.titlePadding + i * (out.shapeHeight + out.shapePadding)\r\n\r\n            //rectangle\r\n            container\r\n                .append('rect')\r\n                .attr('class', 'em-legend-rect')\r\n                .attr('x', 0)\r\n                .attr('y', y)\r\n                .attr('width', out.shapeWidth)\r\n                .attr('height', out.shapeHeight)\r\n                .style('fill', fillColor)\r\n                .on('mouseover', function () {\r\n                    highlightRegions(out.map, ecl)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.svgId_, highlightRegions, ecl)\r\n                    }\r\n                })\r\n                .on('mouseout', function () {\r\n                    unhighlightRegions(out.map, ecl)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.svgId_, unhighlightRegions, ecl)\r\n                    }\r\n                })\r\n\r\n            //label\r\n            container\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', out.shapeWidth + out.labelOffsets.x)\r\n                .attr('y', y + out.shapeHeight * 0.5)\r\n                .attr('dy', '0.35em') // ~vertical centering\r\n                .text(map.classToText() ? map.classToText()[ecl_] : ecl_)\r\n        }\r\n    }\r\n\r\n    // Highlight selected regions on mouseover\r\n    function highlightRegions(map, ecl) {\r\n        const selector = getLegendRegionsSelector(map)\r\n        const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n        allRegions.style('fill', 'white')\r\n        const selectedRegions = allRegions.filter(\"[ecl='\" + ecl + \"']\")\r\n        selectedRegions.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n        })\r\n    }\r\n\r\n    // Reset all regions to their original colors on mouseout\r\n    function unhighlightRegions(map) {\r\n        const selector = getLegendRegionsSelector(map)\r\n        const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n        allRegions.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___'))\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n","import { select, style } from 'd3-selection'\r\nimport { scaleOrdinal } from 'd3-scale'\r\nimport { schemeSet3 } from 'd3-scale-chromatic'\r\nimport * as StatMap from '../core/stat-map'\r\nimport * as CategoricalLegend from '../legend/legend-categorical'\r\nimport { executeForAllInsets, getCSSPropertyFromClass, getRegionsSelector, getTextColorForBackground } from '../core/utils'\r\nimport { applyPatternFill } from '../core/pattern-fill'\r\n\r\n/**\r\n * Returns a categorical map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, false, 'ct')\r\n\r\n    /** Fill style for each category/class. Ex.: { urb: \"#fdb462\", int: \"#ffffb3\", rur: \"#ccebc5\" } */\r\n    out.classToFillStyle_ = undefined\r\n    /** Text label for each category/class. Ex.: { \"urb\": \"Urban\", \"int\": \"Intermediate\", \"rur\": \"Rural\" } */\r\n    out.classToText_ = undefined\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = tooltipTextFunCat\r\n\r\n    //the classifier: a function which returns a class number from a stat value.\r\n    out.classifier_ = undefined\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    const paramNames = ['classToFillStyle_', 'classToText_', 'noDataFillStyle_', 'tooltipText_', 'classifier_']\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        // apply classification to all insets that are outside of the main map's SVG\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n        }\r\n\r\n        // apply to main map\r\n        applyClassificationToMap(out)\r\n\r\n        return out\r\n    }\r\n\r\n    const applyClassificationToMap = function (map) {\r\n        //get domain (unique values)\r\n        const domain = out.statData().getUniqueValues()\r\n\r\n        //get range [0,1,2,3,...,domain.length-1]\r\n        const range = [...Array(domain.length).keys()]\r\n\r\n        //make classifier\r\n        //only use user-define classes\r\n        const ctfs = out.classToFillStyle_ ? out.classToFillStyle() : undefined\r\n        if (ctfs) {\r\n            const categories = Object.keys(ctfs)\r\n            out.classifier(\r\n                scaleOrdinal()\r\n                    .domain(categories) // Only classify known categories\r\n                    .range(categories.map((_, i) => i)) // Assign numerical classes\r\n            )\r\n        } else {\r\n            // Use all unique values if no user-defined classes exist\r\n            out.classifier(scaleOrdinal().domain(domain).range(range))\r\n        }\r\n\r\n        // Apply classifier and set 'ecl' attribute to regions based on value\r\n        const classifyRegions = (regions) => {\r\n            regions.attr('ecl', (rg) => {\r\n                const sv = out.statData().get(rg.properties.id)\r\n                if (!sv) return\r\n\r\n                const v = sv.value\r\n                if (v === ':') return 'nd' // No data\r\n\r\n                const value = isNaN(v) ? v : +v // Convert numbers, keep strings as is\r\n\r\n                //  Ensure only known values are classified\r\n                const classifierDomain = out.classifier().domain()\r\n                if (!classifierDomain.includes(value)) return // Skip unknown values\r\n\r\n                return out.classifier()(value)\r\n            })\r\n        }\r\n\r\n        let selector = getRegionsSelector(map)\r\n        classifyRegions(map.svg().selectAll(selector))\r\n\r\n        // Handle mixed NUTS level, separating NUTS level 0\r\n        if (map.nutsLevel_ === 'mixed') {\r\n            const nuts0Regions = map.svg().selectAll('path.em-nutsrg0')\r\n            classifyRegions(nuts0Regions)\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        //if no color specified, use some default colors\r\n        if (!out.classToFillStyle()) {\r\n            const ctfs = {}\r\n            const dom = out.classifier().domain()\r\n            for (let i = 0; i < dom.length; i++) ctfs[dom[i]] = schemeSet3[i % 12]\r\n            out.classToFillStyle(ctfs)\r\n        }\r\n\r\n        // apply classification to all insets\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n        }\r\n\r\n        // apply to main map\r\n        applyStyleToMap(out)\r\n        return out\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n        // Apply color and events to regions if SVG exists\r\n        if (map.svg_) {\r\n            const selector = getRegionsSelector(map)\r\n            const regions = map.svg().selectAll(selector)\r\n\r\n            // Apply transition and set initial fill colors with data-driven logic\r\n            regions\r\n                .style('pointer-events', 'none') // disable interaction during transition\r\n                .transition()\r\n                .duration(out.transitionDuration())\r\n                .style('fill', regionsFillFunction)\r\n                .end()\r\n                .then(() => {\r\n                    // Re-enable interaction after the transition\r\n                    regions.style('pointer-events', null)\r\n                    // Store the original color for each region\r\n                    regions.each(function () {\r\n                        const sel = select(this)\r\n                        sel.attr('fill___', sel.style('fill'))\r\n                    })\r\n                    // Set up mouse events\r\n                    addMouseEventsToRegions(map, regions)\r\n\r\n                    // update font color for grid cartograms (contrast)\r\n                    if (out.gridCartogram_) {\r\n                        map.svg()\r\n                            .selectAll('.em-grid-text')\r\n                            .each(function () {\r\n                                const cellColor = select(this.parentNode).style('fill')\r\n                                select(this).attr('fill', getTextColorForBackground(cellColor))\r\n                            })\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    //console.error('Error applying transition to regions:', err)\r\n                })\r\n\r\n            // Apply additional settings for mixed NUTS level view\r\n            if (out.nutsLevel_ === 'mixed') {\r\n                styleMixedNUTS(map)\r\n            }\r\n\r\n            // Update labels for statistical values if required\r\n            if (out.labels_) {\r\n                if (out.labels_.values) out.updateValuesLabels(map)\r\n            }\r\n\r\n            //add hatching if needed\r\n            if (out.patternFill_) {\r\n                applyPatternFill(map, out.patternFill_)\r\n            }\r\n        }\r\n    }\r\n\r\n    // when mixing different NUTS levels (e.g. showing NUTS 1 and NUTS 2 data simultaneously)\r\n    const styleMixedNUTS = function (map) {\r\n        map.svg()\r\n            .selectAll(getRegionsSelector(map))\r\n            .style('display', function (rg) {\r\n                if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n                const sel = select(this)\r\n                const ecl = sel.attr('ecl')\r\n                const lvl = sel.attr('lvl')\r\n                return ecl || lvl === '0' ? 'block' : 'none'\r\n            })\r\n            .style('stroke', function () {\r\n                const sel = select(this)\r\n                const lvl = sel.attr('lvl')\r\n                const ecl = sel.attr('ecl')\r\n                const stroke = sel.style('stroke')\r\n                return ecl && lvl !== '0' ? stroke || '#777' : null\r\n            })\r\n            .style('stroke-width', function () {\r\n                const sel = select(this)\r\n                const lvl = sel.attr('lvl')\r\n                const ecl = sel.attr('ecl')\r\n                const strokeWidth = sel.style('stroke-width')\r\n                return ecl && lvl !== '0' ? strokeWidth || 0.2 : null\r\n            })\r\n    }\r\n\r\n    const regionsFillFunction = function (rg) {\r\n        const ecl = select(this).attr('ecl') // 'this' refers to the current DOM element\r\n        if (out.Geometries.userGeometries) {\r\n            if (!ecl) return getCSSPropertyFromClass('em-nutsrg', 'fill')\r\n            if (ecl === 'nd') return out.noDataFillStyle() || 'gray'\r\n            return out.classToFillStyle_[out.classifier().domain()[ecl]]\r\n        } else {\r\n            if (out.geo_ === 'WORLD') {\r\n                // World template logic\r\n                if (!ecl) return out.cntrgFillStyle_\r\n                if (ecl === 'nd') return out.noDataFillStyle() || 'gray'\r\n                const fillStyle = out.classToFillStyle_[out.classifier().domain()[ecl]]\r\n                return fillStyle || out.cntrgFillStyle_\r\n            } else {\r\n                // NUTS template logic\r\n                const countryId = rg.properties.id.slice(0, 2)\r\n                if (!ecl) return getCSSPropertyFromClass('em-nutsrg', 'fill')\r\n                if (ecl === 'nd') return out.noDataFillStyle() || 'gray'\r\n                return out.classToFillStyle_[out.classifier().domain()[ecl]]\r\n            }\r\n        }\r\n    }\r\n\r\n    const addMouseEventsToRegions = function (map, regions) {\r\n        const shouldOmit = (id) => map.tooltip_.omitRegions?.includes(id)\r\n        // Set up mouse events\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', map.hoverColor_) // Apply highlight color\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n                if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n            })\r\n            .on('mouseout', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', sel.attr('fill___')) // Revert to original color\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n            })\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return CategoricalLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n/**\r\n * Specific function for tooltip text.\r\n *\r\n * @param {*} rg The region to show information on.\r\n * @param {*} map The map element\r\n */\r\nconst tooltipTextFunCat = function (rg, map) {\r\n    const buf = []\r\n    if (rg.properties.id) {\r\n        //name and code\r\n        buf.push('<div class=\"em-tooltip-bar\">' + rg.properties.na + ' (' + rg.properties.id + ') </div>')\r\n    } else {\r\n        //region name\r\n        buf.push('<div class=\"em-tooltip-bar\">' + rg.properties.na + '</div>')\r\n    }\r\n    //get stat value\r\n    const sv = map.statData().get(rg.properties.id)\r\n    //case when no data available\r\n    if (!sv || (sv.value != 0 && !sv.value)) {\r\n        buf.push(map.noDataText_)\r\n        return buf.join('')\r\n    }\r\n    const val = sv.value\r\n    if (map.classToText_) {\r\n        const lbl = map.classToText_[val]\r\n        //display label and value\r\n        buf.push(`\r\n    <div class=\"em-tooltip-text\">\r\n    <table class=\"em-tooltip-table\">\r\n    <tbody>\r\n    <tr>\r\n    <td>\r\n    ${lbl ? lbl : val}\r\n    </td>\r\n    </tr>\r\n    </tbody>\r\n    </table>\r\n    </div>\r\n`)\r\n        return buf.join('')\r\n    }\r\n    //display just value\r\n    buf.push(`\r\n    <div class=\"em-tooltip-text\">\r\n    <table class=\"em-tooltip-table\">\r\n    <tbody>\r\n    <tr>\r\n    <td>\r\n    ${val}\r\n    </td>\r\n    </tr>\r\n    </tbody>\r\n    </table>\r\n    </div>\r\n`)\r\n    return buf.join('')\r\n}\r\n","export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(line);\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import { select, selectAll } from 'd3-selection'\r\nimport * as Legend from '../legend'\r\nimport { line } from 'd3-shape'\r\nimport { executeForAllInsets, getFontSizeFromClass, getLegendRegionsSelector } from '../../core/utils'\r\n\r\n/**\r\n * A legend for choropleth-bivariate maps\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    //size\r\n    out.squareSize = 100\r\n\r\n    //orientation\r\n    out.rotation = 0\r\n\r\n    //labels\r\n    out.label1 = 'Variable 1'\r\n    out.label2 = 'Variable 2'\r\n\r\n    //get the font size of the texts\r\n    out.axisTitleFontSize = getFontSizeFromClass('em-bivariate-axis-title')\r\n\r\n    //breaks\r\n    out.breaks1 = undefined\r\n    out.breaks2 = undefined\r\n    out.showBreaks = false // if set to true and breaks1 and breaks2 are undefined then breaks are automatically defined\r\n    out.tickLength = 5 // length of the ticks\r\n\r\n    //axis\r\n    out.yAxisLabelsOffset = { x: 0, y: 0 }\r\n    out.xAxisLabelsOffset = { x: 0, y: 0 }\r\n\r\n    //axis titles\r\n    out.yAxisTitleOffset = { x: 0, y: 0 }\r\n    out.xAxisTitleOffset = { x: 0, y: 0 }\r\n\r\n    //override padding\r\n    out.boxPadding = out.labelFontSize\r\n\r\n    //add extra distance between legend and no data item\r\n    out.noDataYOffset = 30\r\n\r\n    //arrows\r\n    out.axisArrows = true // if set to true, arrows are drawn at the end of the axes\r\n    out.arrowHeight = 15\r\n    out.arrowWidth = 14\r\n    out.arrowPadding = 10 // padding between arrow and axis label\r\n\r\n    //override attribute values with config values\r\n    if (config) for (let key in config) out[key] = config[key]\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        // Horizontal shift to move everything right (adjust this value as needed)\r\n        out._horizontalOffset = out.axisTitleFontSize + out.arrowPadding // Adjust this value to move the whole legend to the right\r\n\r\n        // Remove previous content\r\n        out.lgg.selectAll('*').remove()\r\n\r\n        // Draw background box\r\n        out.makeBackgroundBox()\r\n\r\n        //titles\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        // The vertical position of the legend element\r\n        out._y = out.boxPadding + (out.title ? out.titleFontSize + out.boxPadding : 0)\r\n\r\n        // Square group with horizontal offset\r\n        addSquares()\r\n\r\n        // set breaks if user hasnt defined them but has enabled them\r\n        // set breaks if user hasn't defined them but has enabled them\r\n        if (!out.breaks1 && !out.breaks2 && out.showBreaks) {\r\n            // Extract breaks from classifier1_\r\n            const c1 = map.classifier1_\r\n            if (typeof c1.quantiles === 'function') {\r\n                out.breaks1 = c1.quantiles().map((d) => parseFloat(d.toFixed(0)))\r\n            } else if (c1.domain) {\r\n                out.breaks1 = c1.domain().map((d) => parseFloat(d.toFixed(0)))\r\n            }\r\n\r\n            // Extract breaks from classifier2_\r\n            const c2 = map.classifier2_\r\n            if (typeof c2.quantiles === 'function') {\r\n                out.breaks2 = c2.quantiles().map((d) => parseFloat(d.toFixed(0)))\r\n            } else if (c2.domain) {\r\n                out.breaks2 = c2.domain().map((d) => parseFloat(d.toFixed(0)))\r\n            }\r\n        }\r\n\r\n        // Draw breaks labels 1 (X axis)\r\n        addBreakLabels()\r\n\r\n        out._xAxisArrowY = 0\r\n        out._yAxisArrowX = 0\r\n        if (out.axisArrows) {\r\n            addAxisArrows()\r\n        }\r\n\r\n        addAxisTitles()\r\n\r\n        // Arrow defs\r\n        out.lgg\r\n            .append('defs')\r\n            .append('marker')\r\n            .attr('viewBox', `0 0 ${out.arrowWidth} ${out.arrowHeight}`)\r\n            .attr('id', 'arrowhead')\r\n            .attr('refX', 0)\r\n            .attr('refY', 5)\r\n            .attr('markerWidth', out.arrowWidth)\r\n            .attr('markerHeight', out.arrowHeight)\r\n            .attr('orient', 'auto')\r\n            .append('path')\r\n            .attr('d', 'M 0 0 L 5 5 L 0 10')\r\n            .attr('marker-units', 'strokeWidth')\r\n\r\n        // 'No data' legend box\r\n        if (out.noData) {\r\n            addNoDataElement()\r\n        }\r\n\r\n        // Set legend box dimensions\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    function addNoDataElement() {\r\n        const noDataYOffset =\r\n            out.rotation === 0 ? out.noDataYOffset + out.squareSize / out.map.numberOfClasses_ + out.arrowHeight / 2 : out.noDataYOffset\r\n\r\n        let noDataY =\r\n            out.rotation === 0 ? out._y + out.squareSize + noDataYOffset : out._y + 1.4142 * out.squareSize + out.boxPadding * 2 + noDataYOffset\r\n\r\n        out.lgg\r\n            .append('rect')\r\n            .attr('class', 'em-bivariate-nodata')\r\n            .attr('x', out.boxPadding + out.noDataShapeWidth / 2)\r\n            .attr('y', noDataY + (out.rotation == 0 ? 0 : -10))\r\n            .attr('width', out.noDataShapeWidth)\r\n            .attr('height', out.noDataShapeHeight)\r\n            .style('fill', out.map.noDataFillStyle())\r\n            .on('mouseover', function () {\r\n                const regions = out.map.nutsLevel_ == 'mixed' ? selectAll('#em-nutsrg') : select('#em-nutsrg')\r\n                const sel = regions.selectAll(\"[nd='nd']\")\r\n                sel.style('fill', 'red')\r\n            })\r\n            .on('mouseout', function () {\r\n                const nRg = out.map.nutsLevel_ == 'mixed' ? selectAll('#em-nutsrg') : select('#em-nutsrg')\r\n                const sel = nRg.selectAll(\"[nd='nd']\")\r\n                sel.style('fill', function () {\r\n                    return select(this).attr('fill___')\r\n                })\r\n                select(this).style('fill', out.map.noDataFillStyle())\r\n            })\r\n        out.lgg\r\n            .append('text')\r\n            .attr('class', 'em-bivariate-nodata-label')\r\n            .attr('x', out.boxPadding + out.noDataShapeWidth + (out.noDataShapeWidth / 2 + 5))\r\n            .attr('y', noDataY + out.noDataShapeHeight * 0.5 + 1 + (out.rotation == 0 ? 0 : -10))\r\n            .text(out.noDataText)\r\n    }\r\n\r\n    function addSquares() {\r\n        const lgg = out.lgg\r\n        const numberOfClasses = out.map.numberOfClasses()\r\n        const sz = out.squareSize / numberOfClasses\r\n        const xc = out.rotation === 0 ? 0 : 0.7071 * out.squareSize + out.boxPadding\r\n        const initialX = 0\r\n\r\n        const square = lgg\r\n            .append('g')\r\n            .attr('class', 'bivariate-squares-chart')\r\n            .attr(\r\n                'transform',\r\n                `translate(${out.boxPadding + out._horizontalOffset},${xc + out._y}) rotate(${out.rotation}) translate(${out.boxPadding},0)`\r\n            )\r\n\r\n        // Draw rectangles\r\n        for (let i = 0; i < numberOfClasses; i++) {\r\n            for (let j = 0; j < numberOfClasses; j++) {\r\n                const ecl1 = numberOfClasses - i - 1\r\n                const ecl2 = numberOfClasses - j - 1\r\n                const fill = out.map.classToFillStyle()(ecl1, ecl2)\r\n\r\n                square\r\n                    .append('rect')\r\n                    .attr('class', 'em-bivariate-square')\r\n                    .attr('x', initialX + (numberOfClasses - 1 - i) * sz)\r\n                    .attr('y', j * sz)\r\n                    .attr('width', sz)\r\n                    .attr('height', sz)\r\n                    .style('fill', fill)\r\n                    .on('mouseover', function () {\r\n                        highlightRegions(out.map, ecl1, ecl2)\r\n                        if (out.map.insetTemplates_) {\r\n                            executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightRegions, ecl1, ecl2)\r\n                        }\r\n                        select(this).raise() // raise legend square to avoid stroke issue\r\n                    })\r\n                    .on('mouseout', function () {\r\n                        unhighlightRegions(out.map)\r\n                        if (out.map.insetTemplates_) {\r\n                            executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightRegions, ecl1, ecl2)\r\n                        }\r\n                    })\r\n            }\r\n        }\r\n\r\n        // Frame\r\n        square\r\n            .append('rect')\r\n            .attr('class', 'em-bivariate-frame')\r\n            .attr('x', initialX)\r\n            .attr('y', 0)\r\n            .attr('width', out.squareSize)\r\n            .attr('height', out.squareSize)\r\n            .attr('stroke-width', 0.7)\r\n    }\r\n\r\n    function addBreakLabels() {\r\n        const xc = out.rotation === 0 ? 0 : 0.7071 * out.squareSize + out.boxPadding\r\n        const initialX = 0\r\n        const numberOfClasses = out.map.numberOfClasses()\r\n        const sz = out.squareSize / numberOfClasses\r\n\r\n        // group with horizontal offset\r\n        const breakLabels = out.lgg\r\n            .append('g')\r\n            .attr('class', 'bivariate-break-labels')\r\n            .attr(\r\n                'transform',\r\n                `translate(${out.boxPadding + out._horizontalOffset},${xc + out._y}) rotate(${out.rotation}) translate(${out.boxPadding},0)`\r\n            )\r\n        if (out.breaks1) {\r\n            for (let i = 0; i < out.breaks1.length; i++) {\r\n                const x = initialX + sz * (i + 1)\r\n                const y = out.squareSize + getFontSizeFromClass('em-bivariate-tick-label')\r\n\r\n                breakLabels\r\n                    .append('text')\r\n                    .attr('class', 'em-bivariate-tick-label')\r\n                    .attr('x', x + out.xAxisLabelsOffset.x)\r\n                    .attr('y', y + out.xAxisLabelsOffset.y)\r\n                    .text(out.breaks1[i])\r\n\r\n                breakLabels\r\n                    .append('line')\r\n                    .attr('class', 'em-bivariate-tick')\r\n                    .attr('x1', x)\r\n                    .attr('x2', x)\r\n                    .attr('y1', out.squareSize)\r\n                    .attr('y2', out.squareSize + out.tickLength)\r\n            }\r\n        }\r\n\r\n        // Draw breaks labels 2 (Y axis)\r\n        if (out.breaks2) {\r\n            for (let i = 0; i < out.breaks2.length; i++) {\r\n                const x = initialX\r\n                const y = sz * (i + 2) - sz\r\n\r\n                breakLabels\r\n                    .append('text')\r\n                    .attr('class', 'em-bivariate-tick-label')\r\n                    .attr('x', x + out.yAxisLabelsOffset.x)\r\n                    .attr('y', y - out.yAxisLabelsOffset.y - (out.tickLength + 2))\r\n                    .text([...out.breaks2].reverse()[i])\r\n                    .attr('text-anchor', 'middle')\r\n                    .attr('transform', `rotate(-90, ${x}, ${y})`)\r\n\r\n                breakLabels\r\n                    .append('line')\r\n                    .attr('class', 'em-bivariate-tick')\r\n                    .attr('x1', x)\r\n                    .attr('x2', x - out.tickLength)\r\n                    .attr('y1', y)\r\n                    .attr('y2', y)\r\n            }\r\n        }\r\n    }\r\n\r\n    function addAxisTitles() {\r\n        const xc = out.rotation === 0 ? 0 : 0.7071 * out.squareSize + out.boxPadding\r\n        const initialX = 0\r\n\r\n        const axisTitles = out.lgg\r\n            .append('g')\r\n            .attr('class', 'bivariate-axis-titles')\r\n            .attr(\r\n                'transform',\r\n                `translate(${out.boxPadding + out._horizontalOffset},${xc + out._y}) rotate(${out.rotation}) translate(${out.boxPadding},0)`\r\n            )\r\n\r\n        // X axis title\r\n        let xAxisTitleY = out.squareSize + out.xAxisLabelsOffset.y + (out.axisArrows ? out.arrowPadding + out.arrowHeight : 7)\r\n        let xAxisTitleX = initialX\r\n        if (out.showBreaks || (out.breaks1 && out.breaks2)) xAxisTitleY += getFontSizeFromClass('em-bivariate-tick-label') // move over for tick labels\r\n        if (out.xAxisTitleOffset) xAxisTitleY += out.xAxisTitleOffset.y\r\n        if (out.xAxisTitleOffset) xAxisTitleX += out.xAxisTitleOffset.x\r\n        axisTitles\r\n            .append('text')\r\n            .attr('class', 'em-bivariate-axis-title em-bivariate-axis-title-x')\r\n            .attr('x', xAxisTitleX)\r\n            .attr('y', xAxisTitleY)\r\n            .text(out.label1)\r\n            .attr('dominant-baseline', 'hanging')\r\n            .attr('alignment-baseline', 'hanging')\r\n\r\n        // Y axis title\r\n        let yAxisTitleY = (out.axisArrows ? out._yAxisArrowX - out.arrowPadding : 7) + (out.rotation == -45 ? -4 : -10) // adjust for rotation\r\n        if (out.showBreaks || (out.breaks1 && out.breaks2)) xAxisTitleY += getFontSizeFromClass('em-bivariate-tick-label') // move over for tick labels\r\n        let yAxisTitleX = -out.squareSize\r\n        //manual offsets\r\n        if (out.yAxisTitleOffset) yAxisTitleY += out.yAxisTitleOffset.y\r\n        if (out.yAxisTitleOffset) yAxisTitleX += out.yAxisTitleOffset.x\r\n        axisTitles\r\n            .append('text')\r\n            .attr('class', 'em-bivariate-axis-title em-bivariate-axis-title-y')\r\n            .attr('x', yAxisTitleX)\r\n            .attr('y', yAxisTitleY)\r\n            .text(out.label2)\r\n            .style('transform', out.rotation < 0 ? `translate(${out.axisArrows ? -51 : -15}px, 95px) rotate(90deg)` : 'rotate(-90deg)')\r\n    }\r\n\r\n    function addAxisArrows() {\r\n        const xc = out.rotation === 0 ? 0 : 0.7071 * out.squareSize + out.boxPadding\r\n        const initialX = 0\r\n\r\n        // group with horizontal offset\r\n        const axisArrows = out.lgg\r\n            .append('g')\r\n            .attr('class', 'bivariate-axis-arrows')\r\n            .attr(\r\n                'transform',\r\n                `translate(${out.boxPadding + out._horizontalOffset},${xc + out._y}) rotate(${out.rotation}) translate(${out.boxPadding},0)`\r\n            )\r\n\r\n        // Append X axis arrow\r\n        out._xAxisArrowY = out.squareSize + out.tickLength + out.arrowPadding\r\n        if (out.showBreaks || (out.breaks1 && out.breaks2)) out._xAxisArrowY += getFontSizeFromClass('em-bivariate-tick-label') / 1.5 // move over for tick labels\r\n\r\n        axisArrows\r\n            .append('path')\r\n            .attr('class', 'em-bivariate-axis-arrow')\r\n            .attr(\r\n                'd',\r\n                line()([\r\n                    [initialX, out._xAxisArrowY],\r\n                    [initialX + out.squareSize, out._xAxisArrowY],\r\n                ])\r\n            )\r\n            .attr('stroke', 'black')\r\n            .attr('marker-end', 'url(#arrowhead)')\r\n\r\n        // Append Y axis arrow\r\n        out._yAxisArrowX = -out.tickLength - out.arrowPadding\r\n        if (out.showBreaks || (out.breaks1 && out.breaks2)) out._yAxisArrowX -= out.labelFontSize / 2 // move over for tick labels\r\n\r\n        axisArrows\r\n            .append('path')\r\n            .attr('class', 'em-bivariate-axis-arrow')\r\n            .attr(\r\n                'd',\r\n                line()([\r\n                    [out._yAxisArrowX, out.squareSize],\r\n                    [out._yAxisArrowX, 0],\r\n                ])\r\n            )\r\n            .attr('stroke', 'black')\r\n            .attr('marker-end', 'url(#arrowhead)')\r\n    }\r\n\r\n    // Highlight selected regions on mouseover\r\n    function highlightRegions(map, ecl1, ecl2) {\r\n        const selector = getLegendRegionsSelector(map)\r\n        const allRegions = map.svg_.selectAll(selector).selectAll('[ecl1],[ecl2]')\r\n\r\n        // Set all regions to white\r\n        allRegions.style('fill', 'white')\r\n\r\n        // Highlight only the selected regions by restoring their original color\r\n        const selectedRegions = allRegions.filter(`[ecl1='${ecl1}']`).filter(`[ecl2='${ecl2}']`).filter(':not([nd])')\r\n        selectedRegions.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___')) // Restore original color for selected regions\r\n        })\r\n    }\r\n\r\n    // Reset all regions to their original colors on mouseout\r\n    function unhighlightRegions(map) {\r\n        const selector = getLegendRegionsSelector(map)\r\n        const allRegions = map.svg_.selectAll(selector).selectAll('[ecl1],[ecl2]')\r\n\r\n        // Restore each region's original color from the fill___ attribute\r\n        allRegions.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___'))\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { scaleQuantile, scaleThreshold } from 'd3-scale'\r\nimport { interpolateRgb } from 'd3-interpolate'\r\nimport * as StatMap from '../../core/stat-map'\r\nimport * as BivariateLegend from '../../legend/choropleth/legend-choropleth-bivariate'\r\nimport {\r\n    getCSSPropertyFromClass,\r\n    spaceAsThousandSeparator,\r\n    executeForAllInsets,\r\n    getRegionsSelector,\r\n    getTextColorForBackground,\r\n} from '../../core/utils'\r\n\r\n/**\r\n * Return a bivariate choropleth map.\r\n * See: https://gistbok.ucgis.org/bok-topics/multivariate-mapping\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, false, 'chbi')\r\n\r\n    //number of classes for the classification. Same for both variables.\r\n    out.numberOfClasses_ = 3\r\n    //stevens.greenblue\r\n    //TODO make it possible to use diverging color ramps ?\r\n    out.startColor_ = '#e8e8e8'\r\n    out.color1_ = '#73ae80'\r\n    out.color2_ = '#6c83b5'\r\n    out.endColor_ = '#2a5a5b'\r\n    //a function returning the colors for the classes i,j\r\n    out.classToFillStyle_ = undefined\r\n    //the classifier: a function which return a class number from a stat value.\r\n    out.classifier1_ = undefined\r\n    out.classifier2_ = undefined\r\n    // user defined breaks for the first and second variable.\r\n    out.breaks1_ = undefined\r\n    out.breaks2_ = undefined\r\n\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = tooltipTextFunBiv\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    const paramNames = [\r\n        'numberOfClasses_',\r\n        'breaks1_',\r\n        'breaks2_',\r\n        'startColor_',\r\n        'color1_',\r\n        'color2_',\r\n        'endColor_',\r\n        'classToFillStyle_',\r\n        'noDataFillStyle_',\r\n        'classifier1_',\r\n        'classifier2_',\r\n    ].forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[key](config[k])\r\n        })\r\n    }\r\n\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        // apply classification to all insets that are outside of the main map's SVG\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n        }\r\n\r\n        // apply to main map\r\n        applyClassificationToMap(out)\r\n\r\n        return out\r\n    }\r\n\r\n    function applyClassificationToMap(map) {\r\n        //set classifiers\r\n        const setupClassifiers = () => {\r\n            let stat1 = out.statData('v1').getArray()\r\n            let stat2 = out.statData('v2').getArray()\r\n\r\n            const range = [...Array(out.numberOfClasses()).keys()]\r\n\r\n            // classifier1\r\n            if (!out.classifier1_) {\r\n                if (out.breaks1_) {\r\n                    out.classifier1(scaleThreshold().domain(out.breaks1_).range(range))\r\n                } else {\r\n                    out.classifier1(scaleQuantile().domain(stat1).range(range))\r\n                }\r\n            }\r\n\r\n            // classifier2\r\n            if (!out.classifier2_) {\r\n                if (out.breaks2_) {\r\n                    out.classifier2(scaleThreshold().domain(out.breaks2_).range(range))\r\n                } else {\r\n                    out.classifier2(scaleQuantile().domain(stat2).range(range))\r\n                }\r\n            }\r\n\r\n            // define bivariate color scale\r\n            if (!out.classToFillStyle_) {\r\n                const scale = scaleBivariate(out.numberOfClasses(), out.startColor(), out.color1(), out.color2(), out.endColor())\r\n                out.classToFillStyle(scale)\r\n            }\r\n        }\r\n\r\n        const classifyRegions = (regions) => {\r\n            regions\r\n                .attr('ecl1', function (rg) {\r\n                    const sv = out.statData('v1').get(rg.properties.id)\r\n                    if (!sv) return\r\n                    const v = sv.value\r\n                    if ((v != 0 && !v) || v == ':') return 'nd'\r\n                    // if (rg.properties.id.length == 4) console.log(rg)\r\n                    return +out.classifier1_(+v)\r\n                })\r\n                .attr('ecl2', function (rg) {\r\n                    const sv = out.statData('v2').get(rg.properties.id)\r\n                    if (!sv) return\r\n                    const v = sv.value\r\n                    if ((v != 0 && !v) || v == ':') return 'nd'\r\n                    return +out.classifier2_(+v)\r\n                })\r\n                .attr('nd', function (rg) {\r\n                    const sv1 = out.statData('v1').get(rg.properties.id)\r\n                    const sv2 = out.statData('v2').get(rg.properties.id)\r\n                    if (sv1 || sv2) {\r\n                        let v = sv1?.value\r\n                        if ((v != 0 && !v) || v == ':') return 'nd'\r\n                        v = sv2?.value\r\n                        if ((v != 0 && !v) || v == ':') return 'nd'\r\n                        return\r\n                    }\r\n                })\r\n        }\r\n\r\n        // Initialize classifier\r\n        setupClassifiers()\r\n\r\n        // Apply classification and assign 'ecl' attribute based on map type\r\n        if (map.svg_) {\r\n            let selector = getRegionsSelector(map)\r\n            classifyRegions(map.svg().selectAll(selector))\r\n\r\n            // Handle mixed NUTS level, separating NUTS level 0\r\n            if (map.nutsLevel_ === 'mixed') {\r\n                const nuts0Regions = map.svg().selectAll('path.em-nutsrg0')\r\n                classifyRegions(nuts0Regions)\r\n            }\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        // apply style to insets\r\n        // apply classification to all insets\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n        }\r\n\r\n        // apply to main map\r\n        applyStyleToMap(out)\r\n\r\n        return out\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n        //apply style to nuts regions\r\n\r\n        // set colour of regions\r\n        if (map.svg()) {\r\n            const selector = getRegionsSelector(map)\r\n            let regions = map.svg().selectAll(selector)\r\n            regions\r\n                .style('pointer-events', 'none') // disable interaction during transition\r\n                .transition()\r\n                .duration(out.transitionDuration())\r\n                .style('fill', function (rg) {\r\n                    const nd = select(this).attr('nd')\r\n                    if (nd) return out.noDataFillStyle() || 'gray'\r\n\r\n                    const ecl1 = select(this).attr('ecl1')\r\n                    const ecl2 = select(this).attr('ecl2')\r\n                    if (!ecl1 && !ecl2) return getCSSPropertyFromClass('em-nutsrg', 'fill') // GISCO-2678 - lack of data no longer means no data, instead it is explicitly set using ':'.\r\n                    if (ecl2 === 'nd') return out.noDataFillStyle() || 'gray'\r\n                    let color = out.classToFillStyle_(+ecl1, +ecl2)\r\n                    return color\r\n                })\r\n                .end()\r\n                .then(\r\n                    () => {\r\n                        // Re-enable after animation completes\r\n                        regions.style('pointer-events', null)\r\n\r\n                        // Store the original color for each region\r\n                        regions.each(function () {\r\n                            const sel = select(this)\r\n                            sel.attr('fill___', sel.style('fill'))\r\n                        })\r\n\r\n                        // Set up mouse events\r\n                        addMouseEventsToRegions(map, regions)\r\n\r\n                        // update font color for grid cartograms (contrast)\r\n                        if (out.gridCartogram_) {\r\n                            map.svg()\r\n                                .selectAll('.em-grid-text')\r\n                                .each(function () {\r\n                                    const cellColor = select(this.parentNode).style('fill')\r\n                                    select(this).attr('fill', getTextColorForBackground(cellColor))\r\n                                })\r\n                        }\r\n                    },\r\n                    (err) => {\r\n                        // rejection\r\n                    }\r\n                )\r\n\r\n            if (out.nutsLevel_ == 'mixed') {\r\n                styleMixedNUTS(map)\r\n            }\r\n        }\r\n    }\r\n\r\n    // when mixing different NUTS levels (e.g. showing NUTS 1 and NUTS 2 data simultaneously)\r\n    const styleMixedNUTS = function (map) {\r\n        map.svg()\r\n            .selectAll(getRegionsSelector(map))\r\n            .each(function () {\r\n                if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n                const sel = select(this)\r\n                const ecl1 = sel.attr('ecl1')\r\n                const ecl2 = sel.attr('ecl2')\r\n                const lvl = sel.attr('lvl')\r\n\r\n                // Determine display visibilitys\r\n                const isVisible = ecl1 || ecl2 || lvl === '0'\r\n\r\n                // Apply styles efficiently\r\n                sel.style('display', isVisible ? 'block' : 'none')\r\n\r\n                if ((ecl1 || ecl2) && lvl !== '0') {\r\n                    const stroke = sel.style('stroke') || '#777'\r\n                    const strokeWidth = sel.style('stroke-width') || 0.2\r\n                    sel.style('stroke', stroke).style('stroke-width', strokeWidth)\r\n                }\r\n            })\r\n    }\r\n\r\n    const addMouseEventsToRegions = (map, regions) => {\r\n        const shouldOmit = (id) => map.tooltip_.omitRegions?.includes(id)\r\n\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                select(this).style('fill', map.hoverColor_)\r\n                out._tooltip?.mouseover(out.tooltip_.textFunction(rg, out))\r\n                if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                out._tooltip?.mousemove(e)\r\n                if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n            })\r\n            .on('mouseout', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                const newFill = sel.attr('fill___')\r\n                if (newFill) {\r\n                    sel.style('fill', newFill)\r\n                    out._tooltip?.mouseout()\r\n                }\r\n                if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n            })\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return BivariateLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\nconst scaleBivariate = function (numberOfClasses, startColor, color1, color2, endColor) {\r\n    //color ramps, by row\r\n    const cs = []\r\n    //interpolate from first and last columns\r\n    const rampS1 = interpolateRgb(startColor, color1)\r\n    const ramp2E = interpolateRgb(color2, endColor)\r\n    for (let i = 0; i < numberOfClasses; i++) {\r\n        const t = i / (numberOfClasses - 1)\r\n        const colFun = interpolateRgb(rampS1(t), ramp2E(t))\r\n        const row = []\r\n        for (let j = 0; j < numberOfClasses; j++) row.push(colFun(j / (numberOfClasses - 1)))\r\n        cs.push(row)\r\n    }\r\n    //TODO compute other matrix based on rows, and average both?\r\n\r\n    return function (ecl1, ecl2) {\r\n        return cs[ecl1][ecl2]\r\n    }\r\n}\r\n\r\n/**\r\n * Specific function for tooltip text.\r\n *\r\n * @param {*} rg The region to show information on.\r\n * @param {*} map The map element\r\n */\r\nconst tooltipTextFunBiv = function (rg, map) {\r\n    const buf = []\r\n    //region name\r\n    const regionName = rg.properties.na || rg.properties.name\r\n    if (rg.properties.id) {\r\n        //name and code\r\n        buf.push('<div class=\"em-tooltip-bar\" >' + regionName + ' (' + rg.properties.id + ') </div>')\r\n    } else {\r\n        //region name\r\n        buf.push('<div class=\"em-tooltip-bar\" >' + regionName + '</div>')\r\n    }\r\n\r\n    //stat 1 value\r\n    const sv1 = map.statData('v1').get(rg.properties.id)\r\n    const unit1 = map.statData('v1').unitText()\r\n    //stat 2 value\r\n    const sv2 = map.statData('v2').get(rg.properties.id)\r\n    const unit2 = map.statData('v2').unitText()\r\n\r\n    buf.push(`\r\n        <div class=\"em-tooltip-text\" style=\"background: #ffffff;color: #171a22;padding: 4px;font-size:15px;\">\r\n        <table class=\"em-tooltip-table\">\r\n        <tbody>\r\n        <tr>\r\n        <td>\r\n        ${sv1 && sv1.value ? spaceAsThousandSeparator(sv1.value) : ''} ${unit1 && sv1 && sv1.value ? unit1 : ''}\r\n        ${!sv1 || (sv1.value != 0 && !sv1.value) ? map.noDataText_ : ''}\r\n        </td>\r\n        </tr>\r\n        <tr>\r\n        <td>\r\n        ${sv2 && sv2.value ? spaceAsThousandSeparator(sv2.value) : ''} ${unit2 && sv2 && sv2.value ? unit2 : ''}\r\n        ${!sv2 || (sv2.value != 0 && !sv2.value) ? map.noDataText_ : ''}\r\n        </td>\r\n        </tr>\r\n        </tbody>\r\n        </table>\r\n        </div>\r\n    `)\r\n\r\n    return buf.join('')\r\n}\r\n","/**\n * Ternary geometry functions\n */\nexport class TernaryGeometry {\n    /**\n     * Calculate centroids of subtriangles in a segmented equilateral triangle\n     *\n     * @param k - Number of rows in the segmented equilateral triangle\n     * @returns Array of centroid information\n     */\n    static ternaryMeshCentroids(k) {\n        const K = k * k;\n        const centroids = [];\n        for (let id = 1; id <= K; id++) {\n            const g = Math.floor(Math.sqrt(K - id));\n            const gsq = g * g;\n            const c1 = (((-K + id + g * (g + 2) + 1) % 2) - 3 * gsq - 3 * id + 3 * K + 1) / (6 * k);\n            const c2 = -(((-K + gsq + id + 2 * g + 1) % 2) + 3 * g - 3 * k + 1) / (3 * k);\n            const c3 = (((-K + gsq + id + 2 * g + 1) % 2) + 3 * gsq + 6 * g + 3 * id - 3 * K + 1) / (6 * k);\n            centroids.push({ id, p1: c1, p2: c2, p3: c3 });\n        }\n        return centroids;\n    }\n    /**\n     * Calculate vertices of sub-triangles in a segmented equilateral triangle\n     *\n     * @param centroids - Centroids of sub-triangles\n     * @returns Array of vertex information\n     */\n    static ternaryMeshVertices(centroids) {\n        const k = Math.sqrt(centroids.length);\n        const vertices = [];\n        centroids.forEach((c) => {\n            const j = k - Math.floor(Math.sqrt(k * k - c.id));\n            const i = c.id - (j - 1) * (2 * k - j + 1);\n            const term1 = (Math.pow(-1, i % 2) * 2) / (3 * k);\n            const term2 = Math.pow(-1, i % 2) / (3 * k);\n            vertices.push({\n                id: c.id,\n                vertex: 1,\n                p1: c.p1 - term1,\n                p2: c.p2 + term2,\n                p3: c.p3 + term2,\n            });\n            vertices.push({\n                id: c.id,\n                vertex: 2,\n                p1: c.p1 + term2,\n                p2: c.p2 - term1,\n                p3: c.p3 + term2,\n            });\n            vertices.push({\n                id: c.id,\n                vertex: 3,\n                p1: c.p1 + term2,\n                p2: c.p2 + term2,\n                p3: c.p3 - term1,\n            });\n        });\n        return vertices;\n    }\n    /**\n     * Calculate distance between points in ternary space\n     *\n     * @param p - Reference ternary point\n     * @param C - Array of ternary points to measure distance to\n     * @returns Array of distances\n     */\n    static ternaryDistance(p, C) {\n        return C.map((c) => {\n            const q1 = p[0] - c[0];\n            const q2 = p[1] - c[1];\n            const q3 = p[2] - c[2];\n            return -(q2 * q3 + q3 * q1 + q1 * q2);\n        });\n    }\n    /**\n     * Find nearest coordinate in set C for each point in P\n     *\n     * @param P - Array of ternary points\n     * @param C - Array of reference ternary points\n     * @returns Array of nearest ternary points\n     */\n    static ternaryNearest(P, C) {\n        return P.map((p) => {\n            if (!p)\n                return null;\n            const distances = this.ternaryDistance(p, C);\n            const minIndex = distances.indexOf(Math.min(...distances));\n            return C[minIndex];\n        });\n    }\n    /**\n     * Calculate vertices of sextant regions\n     *\n     * @param center - Center point of the sextants\n     * @returns Array of sextant vertex information\n     */\n    static ternarySextantVertices(center) {\n        const vertices = [];\n        // corner points\n        const p1 = [1, 0, 0];\n        const p2 = [0, 1, 0];\n        const p3 = [0, 0, 1];\n        const a1 = [center[0], 1 - center[0], 0];\n        const a2 = [center[0], 0, 1 - center[0]];\n        const b1 = [0, center[1], 1 - center[1]];\n        const b2 = [1 - center[1], center[1], 0];\n        const c1 = [1 - center[2], 0, center[2]];\n        const c2 = [0, 1 - center[2], center[2]];\n        // sextant vertices\n        const sextantPoints = [\n            // sextant 1: 5 vertices\n            [center, c1, p1, b2, center],\n            // sextant 2: 4 vertices\n            [center, b2, a1, center],\n            // sextant 3: 5 vertices\n            [center, a1, p2, c2, center],\n            // sextant 4: 4 vertices\n            [center, c2, b1, center],\n            // sextant 5: 5 vertices\n            [center, b1, p3, a2, center],\n            // sextant 6: 4 vertices\n            [center, a2, c1, center],\n        ];\n        for (let id = 1; id <= 6; id++) {\n            const points = sextantPoints[id - 1];\n            for (let v = 0; v < points.length; v++) {\n                vertices.push({\n                    id,\n                    vertex: v + 1,\n                    p1: points[v][0],\n                    p2: points[v][1],\n                    p3: points[v][2],\n                });\n            }\n        }\n        return vertices;\n    }\n    /**\n     * Determine which sextant a point belongs to\n     *\n     * @param P - Array of ternary points\n     * @param center - Center point of the sextants\n     * @returns Array of sextant ids (1-6) or null\n     */\n    static ternarySurroundingSextant(P, center) {\n        return P.map((p) => {\n            if (!p)\n                return null;\n            const isLarger = [p[0] > center[0], p[1] > center[1], p[2] > center[2]];\n            if (isLarger[0] && !isLarger[1] && !isLarger[2])\n                return 1;\n            if (isLarger[0] && isLarger[1] && !isLarger[2])\n                return 2;\n            if (!isLarger[0] && isLarger[1] && !isLarger[2])\n                return 3;\n            if (!isLarger[0] && isLarger[1] && isLarger[2])\n                return 4;\n            if (!isLarger[0] && !isLarger[1] && isLarger[2])\n                return 5;\n            if (isLarger[0] && !isLarger[1] && isLarger[2])\n                return 6;\n            // Otherwise the point is exactly at the center, or invalid\n            return null;\n        });\n    }\n    /**\n     * Convert ternary coordinates to cartesian coordinates for plotting\n     *\n     * @param p - Ternary point\n     * @returns Cartesian coordinates [x, y]\n     */\n    static ternaryToCartesian(p) {\n        const x = 0.5 * (2 * p[2] + p[1]);\n        const y = (Math.sqrt(3) / 2) * p[1];\n        return [x, y];\n    }\n    /**\n     * Convert cartesian coordinates to ternary coordinates\n     *\n     * @param x - X coordinate\n     * @param y - Y coordinate\n     * @returns Ternary point\n     */\n    static cartesianToTernary(x, y) {\n        const p2 = (2 * y) / Math.sqrt(3);\n        const p3 = x - p2 / 2;\n        const p1 = 1 - p2 - p3;\n        return [p1, p2, p3];\n    }\n    /**\n     * Calculate ternary limits (min/max for each component)\n     *\n     * @param P - Array of ternary points\n     * @returns Object with lower and upper limits\n     */\n    static ternaryLimits(P) {\n        // Initialize with extreme values...\n        const lower = [1, 1, 1];\n        const upper = [0, 0, 0];\n        // and find min/max for each component\n        P.forEach((p) => {\n            lower[0] = Math.min(lower[0], p[0]);\n            lower[1] = Math.min(lower[1], p[1]);\n            lower[2] = Math.min(lower[2], p[2]);\n            upper[0] = Math.max(upper[0], p[0]);\n            upper[1] = Math.max(upper[1], p[1]);\n            upper[2] = Math.max(upper[2], p[2]);\n        });\n        return { lower, upper };\n    }\n}\n","/**\n * Utility functions for compositional data analysis\n */\nexport class CompositionUtils {\n    /**\n     * Calculate geometric mean of an array of numbers\n     *\n     * @param x - Array of numeric values\n     * @param removeZeros - Whether to remove zeros before calculation\n     * @returns The geometric mean\n     */\n    static geometricMean(x, removeZeros = true) {\n        const values = removeZeros ? x.filter((v) => v !== 0) : x;\n        if (values.length === 0) {\n            return 0;\n        }\n        return Math.exp(values.reduce((sum, val) => sum + Math.log(val), 0) / values.length);\n    }\n    /**\n     * Calculate the center of a compositional dataset\n     *\n     * @param P - Array of ternary points\n     * @returns The center point\n     */\n    static centre(P) {\n        // Calculate geometric mean for each component\n        const g1 = this.geometricMean(P.map((p) => p[0]));\n        const g2 = this.geometricMean(P.map((p) => p[1]));\n        const g3 = this.geometricMean(P.map((p) => p[2]));\n        // Close the vector of geometric means\n        const sum = g1 + g2 + g3;\n        return [g1 / sum, g2 / sum, g3 / sum];\n    }\n    /**\n     * Perturbe a compositional dataset by a compositional vector\n     *\n     * @param P - Array of ternary points\n     * @param c - Perturbation vector\n     * @returns Perturbated compositions\n     */\n    static perturbe(P, c = [1 / 3, 1 / 3, 1 / 3]) {\n        return P.map((p) => {\n            if (!p)\n                return null;\n            const raw = [p[0] * c[0], p[1] * c[1], p[2] * c[2]];\n            const sum = raw.reduce((a, b) => a + b, 0);\n            return [raw[0] / sum, raw[1] / sum, raw[2] / sum];\n        });\n    }\n    /**\n     * Power scaling of compositions\n     *\n     * @param P - Array of ternary points\n     * @param scale - Power scalar\n     * @returns Scaled compositions\n     */\n    static powerScale(P, scale = 1) {\n        return P.map((p) => {\n            if (!p)\n                return null;\n            const raw = [Math.pow(p[0], scale), Math.pow(p[1], scale), Math.pow(p[2], scale)];\n            const sum = raw.reduce((a, b) => a + b, 0);\n            return [raw[0] / sum, raw[1] / sum, raw[2] / sum];\n        });\n    }\n    /**\n     * Close compositions to ensure they sum to 1\n     *\n     * @param P - Array of ternary points\n     * @returns Closed compositions\n     */\n    static close(P) {\n        return P.map((p) => {\n            if (!this.isValidTernary(p)) {\n                return null;\n            }\n            const sum = p[0] + p[1] + p[2];\n            return [p[0] / sum, p[1] / sum, p[2] / sum];\n        });\n    }\n    /**\n     * Validate ternary points\n     *\n     * @param P - Array of ternary points to validate\n     * @throws Error if any point has negative values or values don't sum to approximately 1\n     */\n    static validateTernaryPoints(P) {\n        for (let i = 0; i < P.length; i++) {\n            const p = P[i];\n            if (!p) {\n                continue;\n            }\n            if (p.length !== 3) {\n                throw new Error(`Ternary point must have exactly 3 components, got ${p.length}`);\n            }\n            if (p.some((val) => val < 0)) {\n                throw new Error(`Ternary point contains negative values: [${p}]`);\n            }\n            const sum = p[0] + p[1] + p[2];\n            if (Math.abs(sum - 1) > 1e-9) {\n                throw new Error(`Ternary point components must sum to 1, got ${sum}: [${p}]`);\n            }\n        }\n    }\n    /**\n     * Validate that a point is a valid ternary point (i.e., has three non-null components)\n     */\n    static isValidTernary(point) {\n        return (Array.isArray(point) &&\n            point.length === 3 &&\n            point.every((v) => typeof v === 'number' && !Number.isNaN(v)));\n    }\n}\n","import { CompositionUtils } from './compositionUtils';\nimport { TernaryGeometry } from './ternaryGeometry';\n/**\n * Color mapping functions\n */\nexport class ColorMapping {\n    /**\n     * Map ternary compositions to colors using balance scheme\n     *\n     * @param P - Array of ternary compositions\n     * @param center - Center of color scale\n     * @param breaks - Number of breaks for discretization\n     *  (use Infinity or null or a value > 100 for continuous scale)\n     * @param hue - Primary hue in degrees [0-360]\n     * @param chroma - Maximum chroma [0-200]\n     * @param lightness - Lightness [0-100]\n     * @param contrast - Contrast [0-1]\n     * @param spread - Spread around center (>0)\n     * @returns Array of color results\n     */\n    static colorMapTricolore(P, center = [1 / 3, 1 / 3, 1 / 3], breaks = 4, hue = 80, chroma = 140, lightness = 80, contrast = 0.4, spread = 1) {\n        // Copy input and ensure compositions are closed\n        const P_notrans = CompositionUtils.close([...P]);\n        // Close compositions (i.e. ensure they sum to 1)\n        let closed = CompositionUtils.close([...P]);\n        // Discretize if breaks < 100 and breaks is finite\n        // (i.e. use breaks = Infinity for continuous scale)\n        if (Number.isFinite(breaks) && breaks < 100) {\n            const centroids = TernaryGeometry.ternaryMeshCentroids(breaks).map((c) => [c.p1, c.p2, c.p3]);\n            closed = TernaryGeometry.ternaryNearest(closed, centroids);\n        }\n        // Center and scale\n        const centered = CompositionUtils.perturbe(closed, [\n            1 / center[0],\n            1 / center[1],\n            1 / center[2],\n        ]);\n        const scaled = CompositionUtils.powerScale(centered, spread);\n        // Calculate colors\n        return scaled.map((p, i) => {\n            // Handle invalid compositions\n            // (i.e. composition that contains null/undefined/NaN values)\n            if (!p) {\n                return {\n                    p1: P[i][0],\n                    p2: P[i][1],\n                    p3: P[i][2],\n                    h: null,\n                    c: null,\n                    l: null,\n                    rgb: null,\n                };\n            }\n            // Scale proportions by maximum chroma\n            const C = p.map((v) => v * chroma);\n            // Generate primary colors with equidistant hues\n            const phi = [hue, hue + 120, hue + 240].map((h) => (h * Math.PI) / 180);\n            // Create complex values for each color component\n            const Z = phi.map((angle, j) => {\n                return { re: C[j] * Math.cos(angle), im: C[j] * Math.sin(angle) };\n            });\n            // Sum the complex values\n            const z = Z.reduce((sum, val) => {\n                return { re: sum.re + val.re, im: sum.im + val.im };\n            }, { re: 0, im: 0 });\n            // Convert to polar coordinates\n            const h = ((Math.atan2(z.im, z.re) * 180) / Math.PI + 360) % 360;\n            const c = Math.sqrt(z.re * z.re + z.im * z.im);\n            // Adjust lightness and chroma based on contrast\n            const cfactor = (c * contrast) / chroma + 1 - contrast;\n            const l = cfactor * lightness;\n            const adjustedC = cfactor * c;\n            // Convert to hex RGB\n            const rgb = this.hclToHex(h, adjustedC, l);\n            return {\n                p1: P_notrans[i][0],\n                p2: P_notrans[i][1],\n                p3: P_notrans[i][2],\n                h,\n                c: adjustedC,\n                l,\n                rgb,\n            };\n        });\n    }\n    /**\n     * Map ternary compositions to colors using sextant scheme\n     *\n     * @param P - Array of ternary compositions\n     * @param center - Center of sextant division\n     * @param values - Array of 6 color values for sextants\n     * @returns Array of sextant color results\n     */\n    static colorMapSextant(P, center = [1 / 3, 1 / 3, 1 / 3], values = ['#FFFF00', '#B3DCC3', '#01A0C6', '#B8B3D8', '#F11D8C', '#FFB3B3']) {\n        if (values.length !== 6) {\n            throw new Error('Sextant values array must have exactly 6 elements');\n        }\n        // Close compositions (i.e. ensure they sum to 1)\n        const closed = CompositionUtils.close([...P]);\n        // Assign points to sextants\n        const sextants = TernaryGeometry.ternarySurroundingSextant(closed, center);\n        return closed.map((p, i) => {\n            // Handle invalid compositions\n            // (i.e. composition that contains null/undefined/NaN values)\n            if (!p) {\n                return {\n                    p1: P[i][0],\n                    p2: P[i][1],\n                    p3: P[i][2],\n                    sextant: null,\n                    rgb: null,\n                };\n            }\n            const sextant = sextants[i];\n            const rgb = sextant !== null ? values[sextant - 1] : null;\n            return {\n                p1: p[0],\n                p2: p[1],\n                p3: p[2],\n                sextant,\n                rgb,\n            };\n        });\n    }\n    /**\n     * Convert HCL color to Hex RGB\n     *\n     * @param h - Hue [0-360]\n     * @param c - Chroma [0-200]\n     * @param l - Lightness [0-100]\n     * @returns Hex RGB string\n     */\n    static hclToHex(h, c, l) {\n        // Implementation based on d3-color conversions\n        // First normalize values\n        h = h % 360;\n        if (h < 0)\n            h += 360;\n        // Scale c and L to typical ranges\n        c = Math.max(0, Math.min(c, 230)); // Max ~230\n        l = Math.max(0, Math.min(l, 100));\n        // Convert HCL to LAB\n        const hRad = (h * Math.PI) / 180;\n        const a = Math.cos(hRad) * c;\n        const _b = Math.sin(hRad) * c;\n        // Convert LAB to XYZ\n        const y = (l + 16) / 116;\n        const x = a / 500 + y;\n        const z = y - _b / 200;\n        // D65 illuminant constants\n        const X_n = 0.95047;\n        const Y_n = 1.0;\n        const Z_n = 1.08883;\n        const fx = x > 0.206893034 ? x ** 3 : (x - 16 / 116) / 7.787;\n        const fy = y > 0.206893034 ? y ** 3 : (y - 16 / 116) / 7.787;\n        const fz = z > 0.206893034 ? z ** 3 : (z - 16 / 116) / 7.787;\n        const X = X_n * fx;\n        const Y = Y_n * fy;\n        const Z = Z_n * fz;\n        // Convert XYZ to sRGB\n        let r = 3.2406 * X - 1.5372 * Y - 0.4986 * Z;\n        let g = -0.9689 * X + 1.8758 * Y + 0.0415 * Z;\n        let b = 0.0557 * X - 0.204 * Y + 1.057 * Z;\n        // Apply gamma correction and clamp\n        const gamma = (v) => {\n            return v > 0.0031308 ? 1.055 * v ** (1 / 2.4) - 0.055 : 12.92 * v;\n        };\n        r = gamma(r);\n        g = gamma(g);\n        b = gamma(b);\n        // Clamp and convert to 8-bit\n        const clamp = (v) => Math.max(0, Math.min(1, v));\n        const to8bit = (v) => Math.round(clamp(v) * 255);\n        // Convert to hex\n        const toHex = (v) => {\n            const hex = to8bit(v).toString(16);\n            return hex.length === 1 ? '0' + hex : hex;\n        };\n        return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n    }\n}\n","export default function identity(x) {\n  return x;\n}\n","import {InternMap} from \"internmap\";\nimport identity from \"./identity.js\";\n\nexport default function group(values, ...keys) {\n  return nest(values, identity, identity, keys);\n}\n\nexport function groups(values, ...keys) {\n  return nest(values, Array.from, identity, keys);\n}\n\nfunction flatten(groups, keys) {\n  for (let i = 1, n = keys.length; i < n; ++i) {\n    groups = groups.flatMap(g => g.pop().map(([key, value]) => [...g, key, value]));\n  }\n  return groups;\n}\n\nexport function flatGroup(values, ...keys) {\n  return flatten(groups(values, ...keys), keys);\n}\n\nexport function flatRollup(values, reduce, ...keys) {\n  return flatten(rollups(values, reduce, ...keys), keys);\n}\n\nexport function rollup(values, reduce, ...keys) {\n  return nest(values, identity, reduce, keys);\n}\n\nexport function rollups(values, reduce, ...keys) {\n  return nest(values, Array.from, reduce, keys);\n}\n\nexport function index(values, ...keys) {\n  return nest(values, identity, unique, keys);\n}\n\nexport function indexes(values, ...keys) {\n  return nest(values, Array.from, unique, keys);\n}\n\nfunction unique(values) {\n  if (values.length !== 1) throw new Error(\"duplicate key\");\n  return values[0];\n}\n\nfunction nest(values, map, reduce, keys) {\n  return (function regroup(values, i) {\n    if (i >= keys.length) return reduce(values);\n    const groups = new InternMap();\n    const keyof = keys[i++];\n    let index = -1;\n    for (const value of values) {\n      const key = keyof(value, ++index, values);\n      const group = groups.get(key);\n      if (group) group.push(value);\n      else groups.set(key, [value]);\n    }\n    for (const [key, values] of groups) {\n      groups.set(key, regroup(values, i));\n    }\n    return map(groups);\n  })(values, 0);\n}\n","import { TernaryGeometry } from '../core/ternaryGeometry';\nimport { ColorMapping } from '../core/colorMapping';\nimport { CompositionUtils } from '../core/compositionUtils';\n// TODO: check if this works correctly in various environments\n//  for d3 (cf. inside TricoloreViz constructor too)\nimport { select } from 'd3-selection';\nimport { group } from 'd3-array';\n/**\n * js visualization for Tricolore\n */\nexport class TricoloreViz {\n    /**\n     * Create a TricoloreViz instance\n     *\n     * @param selector - CSS selector for container or D3 selection\n     * @param width - Width of the visualization\n     * @param height - Height of the visualization\n     * @param margin - Margins around the visualization\n     *\n     * @throws Error - If js is not available\n     */\n    constructor(selector, width = 650, height = 520, margin = {\n        top: 20,\n        right: 60,\n        bottom: 50,\n        left: 60,\n    }) {\n        this.canvas = null;\n        this.ctx = null;\n        this.container = select(selector);\n        this.width = width;\n        this.height = height;\n        this.margin = margin;\n        // Create SVG container\n        this.svg = this.container.append('svg').attr('width', width).attr('height', height);\n        // Create group for the triangle\n        this.triangle = this.svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`).attr('class', 'em-tricolore-triangle');\n        // Create group for legending elements (axis names and ticks)\n        this.legend = this.svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`).attr('class', 'em-tricolore-legend-labels');\n        // Create group for data points\n        this.circles = this.svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`).attr('class', 'em-tricolore-data-points');\n    }\n    /**\n     * Create a continuous ternary plot using canvas\n     *\n     * @param data - Array of ternary points\n     * @param options - Visualization options\n     *\n     * @throws Error - If showData is true and data contains invalid ternary points\n     */\n    createContinuousPlot(data = [], options = {}) {\n        var _a, _b;\n        const { center = [1 / 3, 1 / 3, 1 / 3], hue = 80, chroma = 140, lightness = 80, contrast = 0.4, spread = 1, showData = true, showCenter = true, showLines = true, labels = ['p', 'p', 'p'], labelPosition = 'corner', colorTarget = 'triangles', } = options;\n        const plotWidth = this.width - this.margin.left - this.margin.right;\n        const plotHeight = this.height - this.margin.top - this.margin.bottom;\n        const size = Math.min(plotWidth, plotHeight);\n        // Remove any existing canvas\n        if (this.canvas) {\n            select(this.canvas).remove();\n        }\n        // Clear previous contents\n        this.triangle.selectAll('*').remove();\n        this.legend.selectAll('*').remove();\n        this.circles.selectAll('*').remove();\n        // Create canvas for continuous color rendering\n        this.canvas = document.createElement('canvas');\n        this.canvas.width = size;\n        this.canvas.height = size;\n        this.ctx = this.canvas.getContext('2d');\n        if (!this.ctx)\n            return;\n        // Draw the colored triangle on canvas\n        this.drawContinuousTriangle(size, center, hue, chroma, lightness, contrast, spread);\n        // Position canvas\n        this.triangle.append('image').attr('x', 0).attr('y', 0).attr('width', size).attr('height', size).attr('href', this.canvas.toDataURL());\n        // Add triangle border and axes using SVG\n        this.drawTriangleFrame(size, labels, center, showCenter, showLines, labelPosition, colorTarget);\n        // Add data points if requested\n        if (showData && data.length > 0) {\n            const colorTarget = (_a = options.colorTarget) !== null && _a !== void 0 ? _a : 'triangles';\n            this.addDataPoints(data, size, options.dataPointHandlers, showCenter, center, undefined, colorTarget);\n        }\n        if (showCenter) {\n            this.addCenterAnnotation(size, center, (_b = options.centerLabel) !== null && _b !== void 0 ? _b : 'Average value', options.centerAnnotationOffsets);\n        }\n    }\n    /**\n     * Create a discrete ternary plot using SVG polygons\n     *\n     * @param data - Array of ternary points\n     * @param options - Visualization options\n     *\n     * @throws Error - If showData is true and data contains invalid ternary points\n     */\n    createDiscretePlot(data = [], options = {}) {\n        var _a;\n        const { center = [1 / 3, 1 / 3, 1 / 3], breaks = 4, hue = 80, chroma = 140, lightness = 80, contrast = 0.4, spread = 1, showData = true, showCenter = true, showLines = true, labels = ['p', 'p', 'p'], labelPosition = 'corner', colorTarget = 'triangles', } = options;\n        const plotWidth = this.width - this.margin.left - this.margin.right;\n        const plotHeight = this.height - this.margin.top - this.margin.bottom;\n        const size = Math.min(plotWidth, plotHeight);\n        // Clear previous contents\n        this.triangle.selectAll('*').remove();\n        this.legend.selectAll('*').remove();\n        this.circles.selectAll('*').remove();\n        // Generate mesh centroids and vertices\n        const centroids = TernaryGeometry.ternaryMeshCentroids(breaks);\n        const vertices = TernaryGeometry.ternaryMeshVertices(centroids);\n        // Calculate colors for each centroid\n        const centroidPoints = centroids.map((c) => [c.p1, c.p2, c.p3]);\n        const colors = ColorMapping.colorMapTricolore(centroidPoints, center, breaks, hue, chroma, lightness, contrast, spread);\n        // Group vertices by triangle id\n        const triangleGroups = group(vertices, (d) => d.id);\n        // Create a polygon for each triangle\n        triangleGroups.forEach((triangleVertices, id) => {\n            const points = triangleVertices\n                .map((v) => {\n                const [x, y] = this.ternaryToSvgCoords([v.p1, v.p2, v.p3], size);\n                return `${x},${y}`;\n            })\n                .join(' ');\n            const color = colors[Number(id) - 1].rgb;\n            const classIndex = Number(id) - 1;\n            const poly = this.triangle\n                .append('polygon')\n                .attr('points', points)\n                .attr('stroke', 'none')\n                .attr('classIndex', classIndex)\n                .attr('class', 'em-ternary-discrete-polygon');\n            if (colorTarget === 'triangles') {\n                poly.attr('fill', color);\n            }\n            else {\n                poly.attr('fill', '#fffefe'); // or 'none'\n            }\n            const handlers = options.triangleHandlers;\n            if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseover) {\n                poly.on('mouseover', (e) => handlers.mouseover(e, color));\n            }\n            if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseout) {\n                poly.on('mouseout', (e) => handlers.mouseout(e));\n            }\n        });\n        // Draw triangle border and axes\n        this.drawTriangleFrame(size, labels, center, showCenter, showLines, labelPosition, colorTarget, breaks);\n        // Add data points if requested\n        if (showData && data.length > 0) {\n            const pointColors = colorTarget === 'points' ? ColorMapping.colorMapTricolore(data, center, breaks, hue, chroma, lightness, contrast, spread) : undefined;\n            this.addDataPoints(data, size, options.dataPointHandlers, showCenter, center, colorTarget === 'points' ? pointColors : undefined, colorTarget);\n        }\n        if (showCenter) {\n            this.addCenterAnnotation(size, center, (_a = options.centerLabel) !== null && _a !== void 0 ? _a : 'Average value', options.centerAnnotationOffsets);\n        }\n    }\n    /**\n     * Create a sextant ternary plot\n     *\n     * @param data - Array of ternary points\n     * @param options - Visualization options\n     *\n     * @throws Error - If showData is true and data contains invalid ternary points\n     */\n    createSextantPlot(data = [], options = {}) {\n        var _a, _b;\n        const { center = [1 / 3, 1 / 3, 1 / 3], values = ['#FFFF00', '#B3DCC3', '#01A0C6', '#B8B3D8', '#F11D8C', '#FFB3B3'], showData = true, showCenter = true, showLines = true, labels = ['p', 'p', 'p'], labelPosition = 'corner', colorTarget = 'triangles', } = options;\n        if (values.length !== 6) {\n            throw new Error('Sextant plot requires exactly 6 color values');\n        }\n        const plotWidth = this.width - this.margin.left - this.margin.right;\n        const plotHeight = this.height - this.margin.top - this.margin.bottom;\n        const size = Math.min(plotWidth, plotHeight);\n        // Clear previous contents\n        this.triangle.selectAll('*').remove();\n        this.legend.selectAll('*').remove();\n        this.circles.selectAll('*').remove();\n        // Generate sextant vertices\n        const vertices = TernaryGeometry.ternarySextantVertices(center);\n        // Group vertices by sextant id\n        const sextantGroups = group(vertices, (d) => d.id);\n        // Create a polygon for each sextant\n        sextantGroups.forEach((sextantVertices, id) => {\n            // Sort vertices by vertex id to ensure proper polygon drawing\n            sextantVertices.sort((a, b) => a.vertex - b.vertex);\n            const points = sextantVertices\n                .map((v) => {\n                const [x, y] = this.ternaryToSvgCoords([v.p1, v.p2, v.p3], size);\n                return `${x},${y}`;\n            })\n                .join(' ');\n            const colorIndex = Number(id) - 1;\n            const classIndex = Number(id) - 1;\n            const poly = this.triangle\n                .append('polygon')\n                .attr('points', points)\n                .attr('fill', values[colorIndex])\n                .attr('stroke', 'none')\n                .attr('data-ecl', classIndex);\n            const handlers = options.triangleHandlers;\n            if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseover) {\n                poly.on('mouseover', (e) => handlers.mouseover(e, values[colorIndex]));\n            }\n            if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseout) {\n                poly.on('mouseout', (e) => handlers.mouseout(e));\n            }\n        });\n        // Draw triangle border and axes\n        this.drawTriangleFrame(size, labels, center, showCenter, showLines, labelPosition, colorTarget);\n        // Add data points if requested\n        if (showData && data.length > 0) {\n            const colorTarget = (_a = options.colorTarget) !== null && _a !== void 0 ? _a : 'triangles';\n            this.addDataPoints(data, size, options.dataPointHandlers, showCenter, center, undefined, colorTarget);\n        }\n        if (showCenter) {\n            this.addCenterAnnotation(size, center, (_b = options.centerLabel) !== null && _b !== void 0 ? _b : 'Average value', options.centerAnnotationOffsets);\n        }\n    }\n    /**\n     * Draw the continuous colored triangle on canvas\n     */\n    drawContinuousTriangle(size, center, hue, chroma, lightness, contrast, spread) {\n        if (!this.ctx)\n            return;\n        const resolution = size;\n        const imageData = this.ctx.createImageData(resolution, resolution);\n        for (let y = 0; y < resolution; y++) {\n            for (let x = 0; x < resolution; x++) {\n                // Convert from pixel coordinates to ternary coordinates\n                const [p1, p2, p3] = this.svgToTernaryCoords([x, y], resolution);\n                // Skip pixels outside the triangle\n                if (p1 < 0 || p2 < 0 || p3 < 0 || p1 > 1 || p2 > 1 || p3 > 1) {\n                    continue;\n                }\n                // Calculate color for this point\n                const color = ColorMapping.colorMapTricolore([[p1, p2, p3]], center, 100, hue, chroma, lightness, contrast, spread)[0];\n                // Parse the hex color\n                const r = parseInt(color.rgb.slice(1, 3), 16);\n                const g = parseInt(color.rgb.slice(3, 5), 16);\n                const b = parseInt(color.rgb.slice(5, 7), 16);\n                // Set the pixel color\n                const pixelIndex = (y * resolution + x) * 4;\n                imageData.data[pixelIndex] = r;\n                imageData.data[pixelIndex + 1] = g;\n                imageData.data[pixelIndex + 2] = b;\n                imageData.data[pixelIndex + 3] = 255;\n            }\n        }\n        this.ctx.putImageData(imageData, 0, 0);\n    }\n    /**\n     * Draw the triangle frame, axes and labels\n     */\n    drawTriangleFrame(size, labels, center, showCenter, showLines, labelPosition = 'corner', colorTarget = 'triangles', breaks = 4) {\n        // Define triangle corners in ternary coordinates\n        // and convert to SVG coordinates\n        const corners = [\n            [1, 0, 0], // bottom left (p1)\n            [0, 1, 0], // top (p2)\n            [0, 0, 1], // bottom right (p3)\n        ];\n        const svgCorners = corners.map((p) => this.ternaryToSvgCoords(p, size));\n        // Create the triangle border\n        const points = svgCorners.map((p) => p.join(',')).join(' ');\n        this.triangle.append('polygon').attr('points', points).attr('fill', 'none').attr('stroke', 'black').attr('stroke-width', 1);\n        // Add axis names\n        if (labelPosition === 'edge') {\n            const labelPositions = [\n                [(svgCorners[0][0] + svgCorners[1][0]) / 2 - 35, (svgCorners[0][1] + svgCorners[1][1]) / 2 - 14], // p1\n                [(svgCorners[1][0] + svgCorners[2][0]) / 2 + 35, (svgCorners[1][1] + svgCorners[2][1]) / 2 - 14], // p2\n                [(svgCorners[0][0] + svgCorners[2][0]) / 2, (svgCorners[0][1] + svgCorners[2][1]) / 2 + 35], // p3\n            ];\n            const rotateValues = [-60, 60, 0];\n            labels.forEach((label, i) => {\n                this.legend\n                    .append('text')\n                    .attr('x', labelPositions[i][0])\n                    .attr('y', labelPositions[i][1])\n                    .attr('class', 'em-ternary-axis-title em-legend-label em-ternary-legend-label')\n                    .attr('text-anchor', 'middle')\n                    .attr('dominant-baseline', 'middle')\n                    .attr('transform', `rotate(${rotateValues[i]},${labelPositions[i][0]},${labelPositions[i][1]})`)\n                    .text(label);\n            });\n        }\n        else {\n            // 'corner'\n            const labelPositions = [\n                [svgCorners[0][0], svgCorners[0][1] + 25], // p1\n                [svgCorners[1][0], svgCorners[1][1] - 15], // p2\n                [svgCorners[2][0], svgCorners[2][1] + 25], // p3\n            ];\n            labels.forEach((label, i) => {\n                this.legend\n                    .append('text')\n                    .attr('class', 'em-ternary-axis-title em-legend-label em-ternary-legend-label')\n                    .attr('x', labelPositions[i][0])\n                    .attr('y', labelPositions[i][1])\n                    .attr('text-anchor', 'middle')\n                    .text(label);\n            });\n        }\n        // Add grid lines and labels for each axis\n        // ===============================\n        // Grid lines (major + minor)\n        // ===============================\n        const majorGrid = typeof breaks === 'number' && breaks > 1 ? Array.from({ length: breaks - 1 }, (_, i) => (i + 1) / breaks) : [];\n        const minorSubdivisions = 5; // e.g. 5 minor ticks per major\n        const minorGrid = [];\n        for (let i = 0; i < majorGrid.length; i++) {\n            const start = i === 0 ? 0 : majorGrid[i - 1];\n            const end = majorGrid[i];\n            const step = (end - start) / minorSubdivisions;\n            for (let j = 1; j < minorSubdivisions; j++) {\n                minorGrid.push(start + j * step);\n            }\n        }\n        const drawGridLine = (a, b, major) => {\n            const [x1, y1] = this.ternaryToSvgCoords(a, size);\n            const [x2, y2] = this.ternaryToSvgCoords(b, size);\n            this.legend\n                .append('line')\n                .attr('x1', x1)\n                .attr('y1', y1)\n                .attr('x2', x2)\n                .attr('y2', y2)\n                .attr('stroke', colorTarget === 'triangles' ? '#555' : '#555')\n                .attr('stroke-width', major ? 1 : 0.2)\n                .attr('opacity', major ? 0.4 : 0.25)\n                .attr('class', major ? 'em-ternary-grid-line' : 'em-ternary-grid-line-minor');\n        };\n        if (showLines) {\n            // --- minor grid first (background) ---\n            minorGrid.forEach((v) => {\n                // p1\n                drawGridLine([v, 0, 1 - v], [v, 1 - v, 0], false);\n                // p2\n                drawGridLine([0, v, 1 - v], [1 - v, v, 0], false);\n                // p3\n                drawGridLine([1 - v, 0, v], [0, 1 - v, v], false);\n            });\n            // --- major grid on top ---\n            majorGrid.forEach((v) => {\n                // p1 axis (edge p2 = 0)\n                const p1Edge = [v, 0, 1 - v];\n                drawGridLine(p1Edge, [v, 1 - v, 0], true);\n                this.drawAxisTick(p1Edge, [0, -1, +1], size);\n                // p2 axis (edge p3 = 0)\n                const p2Edge = [1 - v, v, 0];\n                drawGridLine([0, v, 1 - v], p2Edge, true);\n                this.drawAxisTick(p2Edge, [+1, 0, -1], size);\n                // p3 axis (edge p1 = 0)\n                const p3Edge = [0, 1 - v, v];\n                drawGridLine([1 - v, 0, v], p3Edge, true);\n                this.drawAxisTick(p3Edge, [-1, +1, 0], size);\n            });\n        }\n        // ===============================\n        // Axis labels (unchanged)\n        // ===============================\n        const labelStride = this.computeLabelStride(majorGrid.length + 1);\n        const labelGrid = majorGrid.filter((_, i) => i % labelStride === 0);\n        labelGrid.forEach((val) => {\n            // p1 axis\n            const line = [this.ternaryToSvgCoords([val, 1 - val, 0], size), this.ternaryToSvgCoords([val, 0, 1 - val], size)];\n            this.legend\n                .append('text')\n                .attr('x', line[0][0] - 10)\n                .attr('y', line[0][1] + 3)\n                .attr('text-anchor', 'end')\n                .attr('font-size', '10px')\n                .attr('class', 'em-ternary-axis-tick-label')\n                .text(`${(val * 100).toFixed(0)}%`);\n        });\n        labelGrid.forEach((val) => {\n            // p2 axis\n            const line = [this.ternaryToSvgCoords([0, val, 1 - val], size), this.ternaryToSvgCoords([1 - val, val, 0], size)];\n            this.legend\n                .append('text')\n                .attr('x', line[0][0] + 5)\n                .attr('y', line[0][1] - 10)\n                .attr('text-anchor', 'start')\n                .attr('font-size', '10px')\n                .attr('class', 'em-ternary-axis-tick-label')\n                .text(`${(val * 100).toFixed(0)}%`);\n        });\n        labelGrid.forEach((val) => {\n            // p3 axis\n            const line = [this.ternaryToSvgCoords([1 - val, 0, val], size), this.ternaryToSvgCoords([0, 1 - val, val], size)];\n            this.legend\n                .append('text')\n                .attr('x', line[0][0] + 10)\n                .attr('y', line[0][1] + 18)\n                .attr('text-anchor', 'middle')\n                .attr('font-size', '10px')\n                .attr('class', 'em-ternary-axis-tick-label')\n                .text(`${(val * 100).toFixed(0)}%`);\n        });\n    }\n    computeLabelStride(breaks) {\n        if (breaks <= 7)\n            return 1; // show all\n        if (breaks <= 10)\n            return 2; // every other\n        if (breaks <= 15)\n            return 3;\n        return Math.ceil(breaks / 4); // cap at ~4 labels per axis\n    }\n    drawAxisTick(at, normal, size, length = 8) {\n        const [x1, y1] = this.ternaryToSvgCoords(at, size);\n        const tickEnd = [at[0] + normal[0] * (length / size), at[1] + normal[1] * (length / size), at[2] + normal[2] * (length / size)];\n        const [x2, y2] = this.ternaryToSvgCoords(tickEnd, size);\n        this.legend\n            .append('line')\n            .attr('x1', x1)\n            .attr('y1', y1)\n            .attr('x2', x2)\n            .attr('y2', y2)\n            .attr('stroke-width', 1)\n            .attr('opacity', 0.4)\n            .attr('class', 'em-ternary-axis-tick');\n    }\n    /**\n     * Add data points to the visualization\n     */\n    addDataPoints(data, size, handlers, showCenter, center, colors, colorTarget = 'triangles') {\n        const closed = CompositionUtils.close([...data]);\n        // Validate data (this will throw an error if invalid)\n        CompositionUtils.validateTernaryPoints(closed);\n        // TODO: decide if we want\n        //  - to throw an error (current behavior)\n        //  - to silently ignore invalid points\n        //  - to filter out invalid points and warn about it\n        //  - to warn and skip plotting points\n        // try {\n        //   CompositionUtils.validateTernaryPoints(data);\n        // } catch (e) {\n        //   console.warn('Invalid ternary points:', e);\n        //   return;\n        // }\n        closed.forEach((p, i) => {\n            if (p) {\n                const [x, y] = this.ternaryToSvgCoords(p, size);\n                const fill = colorTarget === 'points' && colors && colors[i] && colors[i].rgb ? colors[i].rgb : 'black';\n                const c = this.circles\n                    .append('circle')\n                    .datum({ point: p, index: i })\n                    .attr('cx', x)\n                    .attr('cy', y)\n                    .attr('r', 2)\n                    .attr('fill', fill)\n                    .attr('opacity', colorTarget === 'points' ? 1 : 0.7)\n                    .attr('class', 'em-ternary-legend-data-point');\n                if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseover) {\n                    c.on('mouseover', (e) => handlers.mouseover(e, c.datum()));\n                }\n                if (handlers === null || handlers === void 0 ? void 0 : handlers.mousemove) {\n                    c.on('mousemove', (e) => handlers.mousemove(e, c.datum()));\n                }\n                if (handlers === null || handlers === void 0 ? void 0 : handlers.mouseout) {\n                    c.on('mouseout', (e) => handlers.mouseout(e, c.datum()));\n                }\n            }\n        });\n        if (showCenter) {\n            const centerSvg = this.ternaryToSvgCoords(center, size);\n            const [cx, cy] = centerSvg;\n            //LINES\n            const guides = [\n                // p = c1  bottom edge (p2 = 0)\n                [[center[0], 0, 1 - center[0]], center],\n                // p = c2  LEFT edge (p3 = 0)   THIS WAS WRONG BEFORE\n                [[1 - center[1], center[1], 0], center],\n                // p = c3  right edge (p1 = 0)\n                [[0, 1 - center[2], center[2]], center],\n            ];\n            guides.forEach(([a, b], i) => {\n                const [x1, y1] = this.ternaryToSvgCoords(a, size);\n                const [x2, y2] = this.ternaryToSvgCoords(b, size);\n                this.circles\n                    .append('line')\n                    .attr('x1', x1)\n                    .attr('y1', y1)\n                    .attr('x2', x2)\n                    .attr('y2', y2)\n                    .attr('stroke', colorTarget === 'triangles' ? 'white' : '#000')\n                    .attr('stroke-width', colorTarget === 'triangles' ? 1 : 1)\n                    .attr('opacity', colorTarget === 'triangles' ? 0.9 : 1)\n                    .attr('class', 'em-ternary-center-line');\n                // Add label showing the center value for this component\n                const centerValue = Math.round(center[i] * 100);\n                // Use the edge point (x1, y1)\n                const labelX = x1;\n                const labelY = y1;\n                // Calculate line angle\n                const lineAngle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);\n                // Adjust rotation for labels 2 and 3 (flip 180 degrees)\n                let rotation = lineAngle;\n                // Offset distance - make label 1 further from edge\n                const offsetDistance = i === 0 ? 25 : 15;\n                let offsetX = offsetDistance * Math.cos((lineAngle * Math.PI) / 180);\n                let offsetY = offsetDistance * Math.sin((lineAngle * Math.PI) / 180);\n                //left\n                if (i === 1) {\n                    offsetX += -5;\n                    offsetY += 8;\n                }\n                //bottom\n                if (i === 0) {\n                    rotation = lineAngle + 180;\n                    offsetX += 14;\n                    offsetY += 10;\n                }\n                //right\n                if (i === 2) {\n                    rotation = lineAngle + 180;\n                    offsetX += 5;\n                    offsetY += 10;\n                }\n                this.circles\n                    .append('text')\n                    .attr('x', labelX + offsetX)\n                    .attr('y', labelY + offsetY)\n                    .attr('text-anchor', 'middle')\n                    .attr('dominant-baseline', 'middle')\n                    .attr('fill', colorTarget === 'triangles' ? 'white' : '#000')\n                    .attr('transform', `rotate(${rotation}, ${labelX + offsetX}, ${labelY + offsetY})`)\n                    .attr('class', 'em-ternary-center-line-label')\n                    .text(`${centerValue}%`);\n            });\n            this.circles\n                .append('circle')\n                .attr('cx', cx)\n                .attr('cy', cy)\n                .attr('r', 3)\n                .attr('fill', 'black')\n                .attr('stroke', 'white')\n                .attr('class', 'em-ternary-center-point');\n        }\n    }\n    /**\n     * Add a curved annotation from the ternary center point\n     * to the top of the legend area explaining what it is.\n     */\n    addCenterAnnotation(size, center, text = 'Average value', offsets = { labelX: 70, labelY: 20, curveX: 10, curveY: 0 }) {\n        const [cx, cy] = this.ternaryToSvgCoords(center, size);\n        // Target point above the triangle (inside legend space)\n        const tx = cx + offsets.labelX; //offset to the right\n        const ty = 35 + offsets.labelY; //offset down\n        // Control point for curvature (pulls curve upward)\n        const mx = cx + offsets.curveX;\n        const my = cy - offsets.curveY;\n        const path = `\n        M ${cx},${cy}\n        Q ${mx},${my} ${tx},${ty}\n    `;\n        const g = this.circles.append('g').attr('class', 'em-ternary-center-annotation');\n        // Curved guide line\n        g.append('path').attr('d', path).attr('fill', 'none').attr('class', 'em-ternary-annotation-line');\n        // Small dot at the end (optional but helps)\n        //g.append('circle').attr('cx', tx).attr('cy', ty).attr('r', 2).attr('fill', '#444')\n        // Label\n        g.append('text')\n            .attr('x', tx)\n            .attr('y', ty - 6)\n            .attr('class', 'em-ternary-center-annotation-label')\n            .text(text);\n    }\n    /**\n     * Convert ternary coordinates to SVG coordinates\n     */\n    ternaryToSvgCoords(p, size) {\n        const [x, y] = TernaryGeometry.ternaryToCartesian(p);\n        return [x * size, size - y * size];\n    }\n    /**\n     * Convert SVG coordinates to ternary coordinates\n     */\n    svgToTernaryCoords(point, size) {\n        return TernaryGeometry.cartesianToTernary(point[0] / size, 1 - point[1] / size);\n    }\n}\n","// legend-choropleth-trivariate.js\r\nimport * as Legend from '../legend'\r\nimport { select } from 'd3-selection'\r\n// Tricolore\r\nimport { TricoloreViz, CompositionUtils } from '../../lib/tricolore/src'\r\nimport { executeForAllInsets, getLegendRegionsSelector } from '../../core/utils'\r\n\r\n/**\r\n * Legend for trivariate (ternary) choropleth maps\r\n * rendered via Tricolore.\r\n */\r\nexport const legend = function (map, config = {}) {\r\n    const out = Legend.legend(map)\r\n\r\n    // --- defaults ---\r\n    out.width = 160\r\n    out.height = 160\r\n    out.padding = { top: 50, right: 50, bottom: 10, left: 50 }\r\n    out.type = 'continuous' // 'continuous' | 'discrete'\r\n    out.showCenter = true\r\n    out.centerLabel = 'Average'\r\n    out.showLines = false\r\n    out.labels = ['Variable 1', 'Variable 2', 'Variable 3']\r\n    out.labelPosition = 'edge' // 'corner' | 'edge'\r\n    out.colorTarget = 'points' // 'triangles' | 'points'\r\n    out.showData = true\r\n    out.centerAnnotationOffsets = { labelX: 70, labelY: 10, curveX: -20, curveY: -20 }\r\n\r\n    // allow overrides\r\n    Object.assign(out, config)\r\n\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        if (!out.lgg.node()) return out\r\n\r\n        // background + titles\r\n        out.makeBackgroundBox()\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        drawTricoloreLegend()\r\n\r\n        out.setBoxDimension()\r\n        return out\r\n    }\r\n\r\n    function drawTricoloreLegend() {\r\n        const baseY = out.getBaseY()\r\n        const baseX = out.getBaseX()\r\n        const container = out.lgg.append('g').attr('class', 'em-ternary-legend').attr('transform', `translate(${baseX},${baseY})`)\r\n\r\n        // clear previous content\r\n        container.selectAll('*').remove()\r\n\r\n        // container div for Tricolore\r\n        const tricoloreContainer = container\r\n            .append('foreignObject')\r\n            .attr('x', 0)\r\n            .attr('y', 0)\r\n            .attr('width', out.width)\r\n            .attr('height', out.height)\r\n            .append('xhtml:div')\r\n            .style('width', `${out.width}px`)\r\n            .style('height', `${out.height}px`)\r\n\r\n        const viz = new TricoloreViz(tricoloreContainer.node(), out.width, out.height, out.padding)\r\n\r\n        const opts = {\r\n            center: map._ternaryCenter_,\r\n            hue: map.ternarySettings_.hue,\r\n            chroma: map.ternarySettings_.chroma,\r\n            lightness: map.ternarySettings_.lightness,\r\n            contrast: map.ternarySettings_.contrast,\r\n            spread: map.ternarySettings_.spread,\r\n            labels: out.labels,\r\n            labelPosition: out.labelPosition,\r\n            showCenter: out.showCenter,\r\n            centerLabel: out.centerLabel,\r\n            showLines: out.showLines,\r\n            breaks: map.ternarySettings_.breaks,\r\n            colorTarget: out.colorTarget,\r\n            showData: out.showData,\r\n            centerAnnotationOffsets: out.centerAnnotationOffsets,\r\n            //legend event handlers\r\n            dataPointHandlers: {\r\n                mouseover: (e, d) => {\r\n                    const sel = select(e.currentTarget)\r\n\r\n                    // store original styles once\r\n                    if (!sel.attr('fill___')) sel.attr('fill___', sel.attr('fill'))\r\n                    if (!sel.attr('opacity___')) sel.attr('opacity___', sel.attr('opacity'))\r\n\r\n                    sel.attr('fill', 'red').attr('opacity', 1).raise()\r\n\r\n                    //  highlight corresponding map regions\r\n                    highlightRegionsByClass(map, d.index)\r\n                    if (map.insetTemplates_) {\r\n                        executeForAllInsets(map.insetTemplates_, map.svgId, highlightRegionsByClass, d.index)\r\n                    }\r\n\r\n                    //  get region by class index\r\n                    const rg = getRegionByClassIndex(map, d.index)\r\n\r\n                    if (rg) {\r\n                        map._tooltip?.mouseover(map.tooltip_.textFunction(rg, map))\r\n                    }\r\n                },\r\n\r\n                mousemove: (e) => {\r\n                    map._tooltip?.mousemove(e)\r\n                },\r\n\r\n                mouseout: (e, d) => {\r\n                    const sel = select(e.currentTarget)\r\n\r\n                    sel.attr('fill', sel.attr('fill___')).attr('opacity', sel.attr('opacity___')).lower()\r\n\r\n                    unhighlightRegionsByClass(map)\r\n                    if (map.insetTemplates_) {\r\n                        executeForAllInsets(map.insetTemplates_, map.svgId, unhighlightRegionsByClass)\r\n                    }\r\n\r\n                    map._tooltip?.mouseout()\r\n                },\r\n            },\r\n            triangleHandlers: {\r\n                mouseover: (_, color) => {\r\n                    const sel = select(_.currentTarget)\r\n                    sel.attr('stroke-width', 2).attr('stroke', 'red').raise()\r\n                    highlightRegionsByColor(map, color)\r\n                    if (map.insetTemplates_) {\r\n                        executeForAllInsets(map.insetTemplates_, map.svgId, highlightRegionsByColor, color)\r\n                    }\r\n                },\r\n                mouseout: (_) => {\r\n                    select(_.currentTarget).attr('stroke', 'none').lower()\r\n                    unhighlightRegions(map)\r\n                    if (map.insetTemplates_) {\r\n                        executeForAllInsets(map.insetTemplates_, map.svgId, unhighlightRegions)\r\n                    }\r\n                },\r\n            },\r\n        }\r\n\r\n        if (map.ternarySettings_.breaks < 30) {\r\n            viz.createDiscretePlot(map._ternaryData_, opts)\r\n        } else {\r\n            viz.createContinuousPlot(map._ternaryData_, opts)\r\n        }\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n// Highlight selected regions on mouseover\r\nfunction highlightRegionsByColor(map, color) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const regions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Normalize color once (browser-safe)\r\n    const target = normalizeColor(color)\r\n\r\n    regions.each(function () {\r\n        const sel = select(this)\r\n        const original = normalizeColor(sel.attr('fill___'))\r\n\r\n        if (original === target) {\r\n            sel.style('fill', sel.attr('fill___'))\r\n        } else {\r\n            sel.style('fill', '#fff')\r\n        }\r\n    })\r\n}\r\n\r\nfunction getRegionByClassIndex(map, classIndex) {\r\n    const id = map._ternaryIdByClass_\r\n        ? map._ternaryIdByClass_.get(classIndex)\r\n        : [...map._ternaryClassById_.entries()].find(([, i]) => i === classIndex)?.[0]\r\n\r\n    if (!id) return null\r\n\r\n    const feature = map.Geometries.getRegionFeatures()?.find((f) => f.properties.id === id)\r\n\r\n    return feature || null\r\n}\r\n\r\nfunction normalizeColor(c) {\r\n    if (!c) return null\r\n    const ctx = document.createElement('canvas').getContext('2d')\r\n    ctx.fillStyle = c\r\n    return ctx.fillStyle.toLowerCase()\r\n}\r\n\r\n// Reset all regions to their original colors on mouseout\r\nfunction unhighlightRegions(map) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const allRegions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    // Restore each region's original color from the fill___ attribute\r\n    allRegions.each(function () {\r\n        select(this).style('fill', select(this).attr('fill___'))\r\n    })\r\n}\r\n\r\nfunction highlightRegionsByClass(map, classIndex) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    const regions = map.svg_.selectAll(selector).selectAll('[ecl]')\r\n\r\n    regions.each(function () {\r\n        const sel = select(this)\r\n        const ecl = +sel.attr('ecl')\r\n\r\n        if (ecl === classIndex) {\r\n            sel.style('fill', sel.attr('fill___'))\r\n        } else {\r\n            sel.style('fill', '#fff')\r\n        }\r\n    })\r\n}\r\n\r\nfunction unhighlightRegionsByClass(map) {\r\n    const selector = getLegendRegionsSelector(map)\r\n    map.svg_\r\n        .selectAll(selector)\r\n        .selectAll('[ecl]')\r\n        .each(function () {\r\n            const sel = select(this)\r\n            sel.style('fill', sel.attr('fill___'))\r\n        })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport * as StatMap from '../../core/stat-map'\r\nimport * as TrivariateLegend from '../../legend/choropleth/legend-choropleth-trivariate'\r\nimport { getRegionsSelector, executeForAllInsets, spaceAsThousandSeparator } from '../../core/utils'\r\nimport { tricolore, CompositionUtils } from '../../lib/tricolore/src'\r\n\r\n/**\r\n * Trivariate (ternary) choropleth map  Observable-style\r\n */\r\nexport const map = function (config) {\r\n    const out = StatMap.statMap(config, false, 'chtri')\r\n\r\n    // ===============================\r\n    // Configuration\r\n    // ===============================\r\n\r\n    out.ternaryCodes_ = ['v1', 'v2', 'v3']\r\n\r\n    out.noDataFillStyle_ = '#ccc'\r\n\r\n    // tricolore parameters\r\n    out.ternarySettings_ = {\r\n        hue: 10,\r\n        chroma: 120,\r\n        lightness: 70,\r\n        contrast: 0.2,\r\n        spread: 0.8,\r\n        breaks: 5,\r\n        meanCentering: true,\r\n    }\r\n\r\n    // internal cache (index  color)\r\n    out._ternaryColors_ = null\r\n    out._ternaryData_ = null //stats composition data\r\n    out._ternaryCenter_ = null\r\n\r\n    // ===============================\r\n\r\n    // Tooltip renderer\r\n    out.tooltip_.textFunction = tooltipTextFunctionTrivariate\r\n\r\n    // ===============================\r\n    // Getters / setters\r\n    // ===============================\r\n    const paramNames = ['ternaryCodes_', 'noDataFillStyle_', 'ternarySettings_']\r\n    paramNames.forEach((att) => {\r\n        const name = att.slice(0, -1)\r\n\r\n        out[name] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n\r\n            if (att === 'ternarySettings_') {\r\n                // MERGE, dont replace\r\n                out.ternarySettings_ = {\r\n                    ...out.ternarySettings_,\r\n                    ...v,\r\n                }\r\n            } else {\r\n                out[att] = v\r\n            }\r\n\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    // ===============================\r\n    // Classification (compute colors ONCE)\r\n    // ===============================\r\n    //@override\r\n    out.updateClassification = function () {\r\n        // ALWAYS reset to safe defaults\r\n        out._ternaryData_ = []\r\n        out._ternaryColorById_ = new Map()\r\n        out._ternaryCenter_ = null\r\n\r\n        const features = out.Geometries.getRegionFeatures()\r\n        if (!features || features.length === 0) return out\r\n\r\n        const [c1, c2, c3] = out.ternaryCodes_\r\n        const filtered = []\r\n\r\n        const statData1 = out.statData(c1)\r\n        const statData2 = out.statData(c2)\r\n        const statData3 = out.statData(c3)\r\n        features.forEach((f) => {\r\n            const id = f.properties.id\r\n            const id1 = statData1.get(id)\r\n            const id2 = statData2.get(id)\r\n            const id3 = statData3.get(id)\r\n            const v1 = +id1?.value\r\n            const v2 = +id2?.value\r\n            const v3 = +id3?.value\r\n\r\n            if (Number.isFinite(v1) && Number.isFinite(v2) && Number.isFinite(v3) && v1 + v2 + v3 > 0) {\r\n                filtered.push({ id, values: [v1, v2, v3] })\r\n            }\r\n        })\r\n\r\n        out._ternaryData_ = filtered.map((d) => d.values)\r\n\r\n        // --- center ---\r\n        out._ternaryCenter_ = out.ternarySettings_.meanCentering ? CompositionUtils.centre(out._ternaryData_) : [1 / 3, 1 / 3, 1 / 3]\r\n\r\n        // --- colors ---\r\n        const colors = tricolore(out._ternaryData_, {\r\n            center: out._ternaryCenter_,\r\n            breaks: out.ternarySettings_.breaks,\r\n            hue: out.ternarySettings_.hue,\r\n            chroma: out.ternarySettings_.chroma,\r\n            lightness: out.ternarySettings_.lightness,\r\n            contrast: out.ternarySettings_.contrast,\r\n            spread: out.ternarySettings_.spread,\r\n        })\r\n\r\n        out._ternaryColorById_ = new Map()\r\n        out._ternaryClassById_ = new Map()\r\n\r\n        filtered.forEach((d, i) => {\r\n            const color = colors[i]\r\n\r\n            if (color != null) {\r\n                out._ternaryColorById_.set(d.id, color)\r\n                out._ternaryClassById_.set(d.id, i) // <-- class index\r\n            }\r\n        })\r\n        return out\r\n    }\r\n\r\n    // ===============================\r\n    // Styling (apply cached colors)\r\n    // ===============================\r\n    //@override\r\n    out.updateStyle = function () {\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, styleRegions)\r\n        }\r\n        styleRegions(out)\r\n\r\n        addMouseEventsToRegions(out, out.svg().selectAll(getRegionsSelector(out)))\r\n        return out\r\n    }\r\n\r\n    function regionsFillFunction(rg) {\r\n        const id = rg.properties.id\r\n        const c = out._ternaryColorById_.get(id)\r\n        const cls = out._ternaryClassById_.get(id)\r\n\r\n        const sel = select(this)\r\n        sel.attr('ecl', cls ?? null)\r\n\r\n        return c ?? map.noDataFillStyle_\r\n    }\r\n\r\n    function styleRegions(map) {\r\n        if (!map.svg() || !map._ternaryColorById_) return\r\n\r\n        const selector = getRegionsSelector(map)\r\n\r\n        const regions = map.svg().selectAll(selector)\r\n\r\n        // Apply transition and set initial fill colors with data-driven logic\r\n        regions\r\n            .style('pointer-events', 'none') // disable interaction during transition\r\n            .transition()\r\n            .duration(out.transitionDuration())\r\n            .style('fill', regionsFillFunction)\r\n            .end()\r\n            .then(() => {\r\n                // Re-enable interaction after the transition\r\n                regions.style('pointer-events', null)\r\n                // Store the original color for each region\r\n                regions.each(function () {\r\n                    const sel = select(this)\r\n                    sel.attr('fill___', sel.style('fill'))\r\n                })\r\n                // Set up mouse events\r\n                addMouseEventsToRegions(map, regions)\r\n\r\n                // update font color for grid cartograms (contrast)\r\n                if (out.gridCartogram_) {\r\n                    map.svg()\r\n                        .selectAll('.em-grid-text')\r\n                        .each(function () {\r\n                            const cellColor = select(this.parentNode).style('fill')\r\n                            select(this).attr('fill', getTextColorForBackground(cellColor))\r\n                        })\r\n                }\r\n            })\r\n            .catch((err) => {\r\n                //console.error('Error applying transition to regions:', err)\r\n            })\r\n    }\r\n\r\n    // ===============================\r\n    // Hover / tooltip\r\n    // ===============================\r\n    function addMouseEventsToRegions(map, regions) {\r\n        const shouldOmit = (id) => map.tooltip_.omitRegions?.includes(id)\r\n\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', map.hoverColor_)\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n                if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n            })\r\n            .on('mouseout', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', sel.attr('fill___'))\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n            })\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return TrivariateLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n// ===============================\r\n// Tooltip\r\n// ===============================\r\nconst tooltipTextFunctionTrivariate = function (rg, map) {\r\n    const buf = []\r\n    const name = rg.properties.na || ''\r\n    const id = rg.properties.id || ''\r\n    buf.push(`<div class=\"em-tooltip-bar\">${name}${id ? ` (${id})` : ''}</div>`)\r\n\r\n    const [c1, c2, c3] = map.ternaryCodes_\r\n\r\n    const sv1 = map.statData(c1).get(id)\r\n    const sv2 = map.statData(c2).get(id)\r\n    const sv3 = map.statData(c3).get(id)\r\n\r\n    //we assume all three stats have the same unit\r\n    const unitText = map.statData(c1).unitText() || map.statData(c2).unit_ || map.statData(c3).unit_ || ''\r\n\r\n    buf.push(`<div class=\"em-tooltip-text\" style=\"background:#fff;color:#171a22;padding:4px;font-size:15px;\">\r\n      <table class=\"em-tooltip-table\"><tbody>\r\n        <tr><td>${map.statData(c1).label_ || c1}: ${sv1?.value ? spaceAsThousandSeparator(sv1.value) + unitText : ''}</td></tr>\r\n        <tr><td>${map.statData(c2).label_ || c2}: ${sv2?.value ? spaceAsThousandSeparator(sv2.value) + unitText : ''}</td></tr>\r\n        <tr><td>${map.statData(c3).label_ || c3}: ${sv3?.value ? spaceAsThousandSeparator(sv3.value) + unitText : ''}</td></tr>\r\n      </tbody></table></div>`)\r\n\r\n    return buf.join('')\r\n}\r\n","/**\n * Tricolore.js - A library for visualizing ternary compositions\n * Ported from R package: https://github.com/jschoeley/tricolore/\n */\n// Export types\nexport * from './types';\n// Export core functionality\nexport { CompositionUtils } from './core/compositionUtils';\nexport { TernaryGeometry } from './core/ternaryGeometry';\nexport { ColorMapping } from './core/colorMapping';\n// Export visualization (only if d3 is available)\nimport { TricoloreViz } from './viz/tricoloreViz';\nexport { TricoloreViz };\n// Main tricolore functions\nimport { ColorMapping } from './core/colorMapping';\n/**\n * Calculate tricolore colors for a set of ternary compositions\n *\n * @param data - Array of ternary compositions\n * @param options - Configuration options\n * @returns Array of hex color codes\n */\nexport function tricolore(data, options = {}) {\n    const { center = [1 / 3, 1 / 3, 1 / 3], breaks = 4, hue = 80, chroma = 140, lightness = 80, contrast = 0.4, spread = 1, } = options;\n    return ColorMapping.colorMapTricolore(data, center, breaks, hue, chroma, lightness, contrast, spread).map((result) => result.rgb);\n}\n/**\n * Calculate tricolore colors with full result information\n *\n * @param data - Array of ternary compositions\n * @param options - Configuration options\n * @returns Array of detailed color results\n */\nexport function tricoloreDetailed(data, options = {}) {\n    const { center = [1 / 3, 1 / 3, 1 / 3], breaks = 4, hue = 80, chroma = 140, lightness = 80, contrast = 0.4, spread = 1, } = options;\n    return ColorMapping.colorMapTricolore(data, center, breaks, hue, chroma, lightness, contrast, spread);\n}\n/**\n * Calculate sextant colors for a set of ternary compositions\n *\n * @param data - Array of ternary compositions\n * @param options - Configuration options\n * @returns Array of hex color codes\n */\nexport function tricoloreSextant(data, options = {}) {\n    const { center = [1 / 3, 1 / 3, 1 / 3], values = ['#FFFF00', '#B3DCC3', '#01A0C6', '#B8B3D8', '#F11D8C', '#FFB3B3'], } = options;\n    return ColorMapping.colorMapSextant(data, center, values).map((result) => result.rgb);\n}\n/**\n * Calculate sextant colors with full result information\n *\n * @param data - Array of ternary compositions\n * @param options - Configuration options\n * @returns Array of detailed sextant results\n */\nexport function tricoloreSextantDetailed(data, options = {}) {\n    const { center = [1 / 3, 1 / 3, 1 / 3], values = ['#FFFF00', '#B3DCC3', '#01A0C6', '#B8B3D8', '#F11D8C', '#FFB3B3'], } = options;\n    return ColorMapping.colorMapSextant(data, center, values);\n}\n","export default function(a, b) {\n  return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n}\n","export default function(d) {\n  return d;\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport descending from \"./descending.js\";\nimport identity from \"./identity.js\";\nimport {tau} from \"./math.js\";\n\nexport default function() {\n  var value = identity,\n      sortValues = descending,\n      sort = null,\n      startAngle = constant(0),\n      endAngle = constant(tau),\n      padAngle = constant(0);\n\n  function pie(data) {\n    var i,\n        n = (data = array(data)).length,\n        j,\n        k,\n        sum = 0,\n        index = new Array(n),\n        arcs = new Array(n),\n        a0 = +startAngle.apply(this, arguments),\n        da = Math.min(tau, Math.max(-tau, endAngle.apply(this, arguments) - a0)),\n        a1,\n        p = Math.min(Math.abs(da) / n, padAngle.apply(this, arguments)),\n        pa = p * (da < 0 ? -1 : 1),\n        v;\n\n    for (i = 0; i < n; ++i) {\n      if ((v = arcs[index[i] = i] = +value(data[i], i, data)) > 0) {\n        sum += v;\n      }\n    }\n\n    // Optionally sort the arcs by previously-computed values or by data.\n    if (sortValues != null) index.sort(function(i, j) { return sortValues(arcs[i], arcs[j]); });\n    else if (sort != null) index.sort(function(i, j) { return sort(data[i], data[j]); });\n\n    // Compute the arcs! They are stored in the original data's order.\n    for (i = 0, k = sum ? (da - n * pa) / sum : 0; i < n; ++i, a0 = a1) {\n      j = index[i], v = arcs[j], a1 = a0 + (v > 0 ? v * k : 0) + pa, arcs[j] = {\n        data: data[j],\n        index: i,\n        value: v,\n        startAngle: a0,\n        endAngle: a1,\n        padAngle: p\n      };\n    }\n\n    return arcs;\n  }\n\n  pie.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), pie) : value;\n  };\n\n  pie.sortValues = function(_) {\n    return arguments.length ? (sortValues = _, sort = null, pie) : sortValues;\n  };\n\n  pie.sort = function(_) {\n    return arguments.length ? (sort = _, sortValues = null, pie) : sort;\n  };\n\n  pie.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : startAngle;\n  };\n\n  pie.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : endAngle;\n  };\n\n  pie.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : padAngle;\n  };\n\n  return pie;\n}\n","import constant from \"./constant.js\";\nimport {abs, acos, asin, atan2, cos, epsilon, halfPi, max, min, pi, sin, sqrt, tau} from \"./math.js\";\nimport {withPath} from \"./path.js\";\n\nfunction arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction arcEndAngle(d) {\n  return d.endAngle;\n}\n\nfunction arcPadAngle(d) {\n  return d && d.padAngle; // Note: optional!\n}\n\nfunction intersect(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var x10 = x1 - x0, y10 = y1 - y0,\n      x32 = x3 - x2, y32 = y3 - y2,\n      t = y32 * x10 - x32 * y10;\n  if (t * t < epsilon) return;\n  t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / t;\n  return [x0 + t * x10, y0 + t * y10];\n}\n\n// Compute perpendicular offset line of length rc.\n// http://mathworld.wolfram.com/Circle-LineIntersection.html\nfunction cornerTangents(x0, y0, x1, y1, r1, rc, cw) {\n  var x01 = x0 - x1,\n      y01 = y0 - y1,\n      lo = (cw ? rc : -rc) / sqrt(x01 * x01 + y01 * y01),\n      ox = lo * y01,\n      oy = -lo * x01,\n      x11 = x0 + ox,\n      y11 = y0 + oy,\n      x10 = x1 + ox,\n      y10 = y1 + oy,\n      x00 = (x11 + x10) / 2,\n      y00 = (y11 + y10) / 2,\n      dx = x10 - x11,\n      dy = y10 - y11,\n      d2 = dx * dx + dy * dy,\n      r = r1 - rc,\n      D = x11 * y10 - x10 * y11,\n      d = (dy < 0 ? -1 : 1) * sqrt(max(0, r * r * d2 - D * D)),\n      cx0 = (D * dy - dx * d) / d2,\n      cy0 = (-D * dx - dy * d) / d2,\n      cx1 = (D * dy + dx * d) / d2,\n      cy1 = (-D * dx + dy * d) / d2,\n      dx0 = cx0 - x00,\n      dy0 = cy0 - y00,\n      dx1 = cx1 - x00,\n      dy1 = cy1 - y00;\n\n  // Pick the closer of the two intersection points.\n  // TODO Is there a faster way to determine which intersection to use?\n  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;\n\n  return {\n    cx: cx0,\n    cy: cy0,\n    x01: -ox,\n    y01: -oy,\n    x11: cx0 * (r1 / r - 1),\n    y11: cy0 * (r1 / r - 1)\n  };\n}\n\nexport default function() {\n  var innerRadius = arcInnerRadius,\n      outerRadius = arcOuterRadius,\n      cornerRadius = constant(0),\n      padRadius = null,\n      startAngle = arcStartAngle,\n      endAngle = arcEndAngle,\n      padAngle = arcPadAngle,\n      context = null,\n      path = withPath(arc);\n\n  function arc() {\n    var buffer,\n        r,\n        r0 = +innerRadius.apply(this, arguments),\n        r1 = +outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) - halfPi,\n        a1 = endAngle.apply(this, arguments) - halfPi,\n        da = abs(a1 - a0),\n        cw = a1 > a0;\n\n    if (!context) context = buffer = path();\n\n    // Ensure that the outer radius is always larger than the inner radius.\n    if (r1 < r0) r = r1, r1 = r0, r0 = r;\n\n    // Is it a point?\n    if (!(r1 > epsilon)) context.moveTo(0, 0);\n\n    // Or is it a circle or annulus?\n    else if (da > tau - epsilon) {\n      context.moveTo(r1 * cos(a0), r1 * sin(a0));\n      context.arc(0, 0, r1, a0, a1, !cw);\n      if (r0 > epsilon) {\n        context.moveTo(r0 * cos(a1), r0 * sin(a1));\n        context.arc(0, 0, r0, a1, a0, cw);\n      }\n    }\n\n    // Or is it a circular or annular sector?\n    else {\n      var a01 = a0,\n          a11 = a1,\n          a00 = a0,\n          a10 = a1,\n          da0 = da,\n          da1 = da,\n          ap = padAngle.apply(this, arguments) / 2,\n          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : sqrt(r0 * r0 + r1 * r1)),\n          rc = min(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),\n          rc0 = rc,\n          rc1 = rc,\n          t0,\n          t1;\n\n      // Apply padding? Note that since r1  r0, da1  da0.\n      if (rp > epsilon) {\n        var p0 = asin(rp / r0 * sin(ap)),\n            p1 = asin(rp / r1 * sin(ap));\n        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;\n        else da0 = 0, a00 = a10 = (a0 + a1) / 2;\n        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;\n        else da1 = 0, a01 = a11 = (a0 + a1) / 2;\n      }\n\n      var x01 = r1 * cos(a01),\n          y01 = r1 * sin(a01),\n          x10 = r0 * cos(a10),\n          y10 = r0 * sin(a10);\n\n      // Apply rounded corners?\n      if (rc > epsilon) {\n        var x11 = r1 * cos(a11),\n            y11 = r1 * sin(a11),\n            x00 = r0 * cos(a00),\n            y00 = r0 * sin(a00),\n            oc;\n\n        // Restrict the corner radius according to the sector angle. If this\n        // intersection fails, its probably because the arc is too small, so\n        // disable the corner radius entirely.\n        if (da < pi) {\n          if (oc = intersect(x01, y01, x00, y00, x11, y11, x10, y10)) {\n            var ax = x01 - oc[0],\n                ay = y01 - oc[1],\n                bx = x11 - oc[0],\n                by = y11 - oc[1],\n                kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt(ax * ax + ay * ay) * sqrt(bx * bx + by * by))) / 2),\n                lc = sqrt(oc[0] * oc[0] + oc[1] * oc[1]);\n            rc0 = min(rc, (r0 - lc) / (kc - 1));\n            rc1 = min(rc, (r1 - lc) / (kc + 1));\n          } else {\n            rc0 = rc1 = 0;\n          }\n        }\n      }\n\n      // Is the sector collapsed to a line?\n      if (!(da1 > epsilon)) context.moveTo(x01, y01);\n\n      // Does the sectors outer ring have rounded corners?\n      else if (rc1 > epsilon) {\n        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);\n        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);\n\n        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the outer ring just a circular arc?\n      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);\n\n      // Is there no inner ring, and its a circular sector?\n      // Or perhaps its an annular sector collapsed due to padding?\n      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);\n\n      // Does the sectors inner ring (or point) have rounded corners?\n      else if (rc0 > epsilon) {\n        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);\n        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);\n\n        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the inner ring just a circular arc?\n      else context.arc(0, 0, r0, a10, a00, cw);\n    }\n\n    context.closePath();\n\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  arc.centroid = function() {\n    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,\n        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;\n    return [cos(a) * r, sin(a) * r];\n  };\n\n  arc.innerRadius = function(_) {\n    return arguments.length ? (innerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : innerRadius;\n  };\n\n  arc.outerRadius = function(_) {\n    return arguments.length ? (outerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : outerRadius;\n  };\n\n  arc.cornerRadius = function(_) {\n    return arguments.length ? (cornerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : cornerRadius;\n  };\n\n  arc.padRadius = function(_) {\n    return arguments.length ? (padRadius = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), arc) : padRadius;\n  };\n\n  arc.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : startAngle;\n  };\n\n  arc.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : endAngle;\n  };\n\n  arc.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : padAngle;\n  };\n\n  arc.context = function(_) {\n    return arguments.length ? ((context = _ == null ? null : _), arc) : context;\n  };\n\n  return arc;\n}\n","import colors from \"../colors.js\";\n\nexport default colors(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\");\n","import { select } from 'd3-selection'\r\nimport { format } from 'd3-format'\r\nimport * as Legend from './legend'\r\nimport { executeForAllInsets, getLegendRegionsSelector } from '../core/utils'\r\n\r\n/**\r\n * A legend for choropleth maps\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    //override attribute values with config values\r\n    if (config) for (let key in config) out[key] = config[key]\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        const m = out.map\r\n        const svgMap = m.svg()\r\n        const lgg = out.lgg\r\n\r\n        //remove previous content\r\n        lgg.selectAll('*').remove()\r\n\r\n        //draw legend background box\r\n        out.makeBackgroundBox()\r\n\r\n        //titles\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        //draw legend elements for classes: rectangle + label\r\n        let i = 0\r\n        const scs = m.catColors()\r\n        for (let code in scs) {\r\n            //the vertical position of the legend element\r\n            const y = out.boxPadding + (out.title ? out.titleFontSize + out.boxPadding : 0) + i * (out.shapeHeight + out.shapePadding)\r\n\r\n            //the color\r\n            const col = m.catColors()[code] || 'lightgray'\r\n\r\n            //rectangle\r\n            lgg.append('rect')\r\n                .attr('class', 'em-legend-rect')\r\n                .attr('x', out.boxPadding)\r\n                .attr('y', y)\r\n                .attr('width', out.shapeWidth)\r\n                .attr('height', out.shapeHeight)\r\n                .style('fill', scs[code])\r\n                .attr('stroke', 'black')\r\n                .attr('stroke-width', 0.5)\r\n                .on('mouseover', function () {\r\n                    const sel = select(this)\r\n                    sel.raise()\r\n                    highlightRegions(out.map, code)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightRegions, code)\r\n                    }\r\n                })\r\n                .on('mouseout', function () {\r\n                    unhighlightRegions(out.map)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightRegions)\r\n                    }\r\n                })\r\n\r\n            //label\r\n            lgg.append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', out.boxPadding + out.shapeWidth + out.labelOffsets.x)\r\n                .attr('y', y + out.shapeHeight * 0.5)\r\n                .attr('dy', '0.35em') // ~vertical centering\r\n                .text(m.catLabels()[code] || code)\r\n                .on('mouseover', function () {\r\n                    svgMap\r\n                        .selectAll('pattern')\r\n                        .selectAll(\"rect[code='\" + code + \"']\")\r\n                        .style('fill', m.hoverColor())\r\n                })\r\n                .on('mouseout', function () {\r\n                    const col = m.catColors()[code] || 'lightgray'\r\n                    svgMap\r\n                        .selectAll('pattern')\r\n                        .selectAll(\"rect[code='\" + code + \"']\")\r\n                        .style('fill', col)\r\n                })\r\n\r\n            i++\r\n        }\r\n\r\n        //'no data' legend box\r\n        if (out.noData) {\r\n            const y = out.boxPadding + (out.title ? out.titleFontSize + out.boxPadding : 0) + i * (out.shapeHeight + out.shapePadding)\r\n\r\n            //rectangle\r\n            lgg.append('rect')\r\n                .attr('class', 'em-legend-rect')\r\n                .attr('x', out.boxPadding)\r\n                .attr('y', y)\r\n                .attr('width', out.shapeWidth)\r\n                .attr('height', out.shapeHeight)\r\n                .style('fill', m.noDataFillStyle())\r\n                .on('mouseover', function () {\r\n                    svgMap.select('#em-nutsrg').selectAll(\"[nd='nd']\").style('fill', m.hoverColor())\r\n                    select(this).style('fill', m.hoverColor())\r\n                })\r\n                .on('mouseout', function () {\r\n                    const sel = svgMap\r\n                        .select('#em-nutsrg')\r\n                        .selectAll(\"[nd='nd']\")\r\n                        .style('fill', function (d) {\r\n                            m.noDataFillStyle()\r\n                        })\r\n                    select(this).style('fill', m.noDataFillStyle())\r\n                })\r\n\r\n            //'no data' label\r\n            lgg.append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', out.boxPadding + out.shapeWidth + out.labelOffsets.x)\r\n                .attr('y', y + out.shapeHeight * 0.5)\r\n                .text(out.noDataText)\r\n                .on('mouseover', function () {\r\n                    svgMap.select('#em-nutsrg').selectAll(\"[nd='nd']\").style('fill', m.hoverColor())\r\n                })\r\n                .on('mouseout', function () {\r\n                    const sel = svgMap\r\n                        .select('#em-nutsrg')\r\n                        .selectAll(\"[nd='nd']\")\r\n                        .style('fill', function (d) {\r\n                            m.noDataFillStyle()\r\n                        })\r\n                })\r\n        }\r\n\r\n        //set legend box dimensions\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    function highlightRegions(map, code) {\r\n        const allRegions = map.svg_.selectAll('pattern').selectAll('rect')\r\n\r\n        // Save original colors if not already stored\r\n        allRegions.each(function () {\r\n            const el = select(this)\r\n            if (!el.attr('data-original-fill')) {\r\n                el.attr('data-original-fill', el.style('fill'))\r\n            }\r\n            el.style('fill', 'white') // Set all regions to white\r\n        })\r\n\r\n        // Highlight only the selected regions by restoring their original color\r\n        const selectedRegions = map.svg_.selectAll('pattern').selectAll(\"rect[code='\" + code + \"']\")\r\n        selectedRegions.each(function () {\r\n            const el = select(this)\r\n            el.style('fill', el.attr('data-original-fill')) // Restore original fill\r\n        })\r\n    }\r\n\r\n    function unhighlightRegions(map) {\r\n        const allRegions = map.svg_.selectAll('pattern').selectAll('rect')\r\n\r\n        // Restore each region's original color from the stored attribute\r\n        allRegions.each(function () {\r\n            const el = select(this)\r\n            const originalFill = el.attr('data-original-fill')\r\n            if (originalFill) {\r\n                el.style('fill', originalFill)\r\n            }\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n","export default function extent(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n}\n","import { format } from 'd3-format'\r\nimport { select } from 'd3-selection'\r\nimport { max } from 'd3-array'\r\nimport * as Legend from './legend'\r\nimport { executeForAllInsets, getFontSizeFromClass } from '../core/utils'\r\nimport { drawCircleSizeLegend } from './legend-circle-size'\r\n\r\n/**\r\n * A legend for proportional symbol map\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    //size legend config (legend illustrating the values of different pie sizes)\r\n    out.sizeLegend = {\r\n        title: null,\r\n        titlePadding: 10, //padding between title and body\r\n        values: null,\r\n        labelFormatter: undefined, // user-defined format function\r\n        noData: false, // show no data legend item\r\n        noDataText: 'No data', //no data text label\r\n    }\r\n\r\n    //colour legend config (legend illustrating the values of different pie colours)\r\n    out.colorLegend = {\r\n        title: null,\r\n        titlePadding: 10, //padding between title and body\r\n        marginTop: 33, // margin top (distance between color and size legend)\r\n        labelOffsets: { x: 5, y: 5 }, //the distance between the legend box elements to the corresponding text label\r\n        shapeWidth: 25, //the width of the legend box elements\r\n        shapeHeight: 20, //the height of the legend box elements\r\n        shapePadding: 1, //the distance between consecutive legend box elements\r\n        noData: true, //show no data\r\n        noDataText: 'No data', //no data label text\r\n    }\r\n\r\n    out._sizeLegendHeight = 0\r\n\r\n    //override attribute values with config values\r\n    if (config)\r\n        for (let key in config) {\r\n            if (key == 'colorLegend' || key == 'sizeLegend') {\r\n                for (let p in out[key]) {\r\n                    //override each property in size and color legend configs\r\n                    if (config[key][p] !== undefined) {\r\n                        out[key][p] = config[key][p]\r\n                    }\r\n                }\r\n                if (config.colorLegend == false) out.colorLegend = false\r\n            } else {\r\n                out[key] = config[key]\r\n            }\r\n        }\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        const map = out.map\r\n        const lgg = out.lgg\r\n\r\n        //remove previous content\r\n        lgg.selectAll('*').remove()\r\n\r\n        //draw legend background box\r\n        out.makeBackgroundBox()\r\n\r\n        //titles\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        // initial x and y positions for the internal legend elements\r\n        const baseY = out.getBaseY()\r\n        const baseX = out.getBaseX()\r\n\r\n        // legend for sizes\r\n        if (map.classifierSize_) {\r\n            //circle size legend\r\n            out._sizeLegendContainer = lgg.append('g').attr('class', 'em-pie-size-legend').attr('transform', `translate(${baseX}, ${baseY})`)\r\n            drawCircleSizeLegend(\r\n                out,\r\n                out._sizeLegendContainer,\r\n                out.sizeLegend.values,\r\n                map.classifierSize_,\r\n                out.sizeLegend.title,\r\n                out.sizeLegend.titlePadding\r\n            )\r\n        }\r\n\r\n        // legend for ps color values\r\n        buildColorLegend(out, baseX, baseY)\r\n\r\n        //set legend box dimensions\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    /**\r\n     * Builds a legend illustrating the statistical values of the pie charts' different colours\r\n     *\r\n     */\r\n    function buildColorLegend(out, baseX, baseY) {\r\n        const map = out.map\r\n        const config = out.colorLegend\r\n        //container\r\n        out._colorLegendContainer = out.lgg.append('g').attr('class', 'em-pie-color-legend')\r\n\r\n        //container position\r\n        if (out._sizeLegendContainer) {\r\n            // position it below size legend\r\n            const sizeLegendHeight = out._sizeLegendContainer.node().getBBox().height\r\n            out._colorLegendContainer.attr('transform', `translate(${baseX},${sizeLegendHeight + out.colorLegend.marginTop})`)\r\n        } else {\r\n            out._colorLegendContainer.attr('transform', `translate(${baseX},${baseY})`)\r\n        }\r\n\r\n        //draw title\r\n        if (config.title) {\r\n            out._colorLegendContainer\r\n                .append('text')\r\n                .attr('id', 'em-color-legend-title')\r\n                .attr('class', 'em-color-legend-title')\r\n                .attr('x', 0)\r\n                .attr('y', out.titleFontSize)\r\n                .text(config.title)\r\n        }\r\n\r\n        //draw legend elements for classes: rectangle + label\r\n        let i = 0\r\n        const scs = map.catColors()\r\n        for (let code in scs) {\r\n            //the vertical position of the legend element\r\n            const y = out.colorLegend.titlePadding + (config.title ? out.titleFontSize : 0) + i * (config.shapeHeight + config.shapePadding)\r\n            //the color\r\n            const col = map.catColors()[code] || 'lightgray'\r\n\r\n            //rectangle\r\n            out._colorLegendContainer\r\n                .append('rect')\r\n                .attr('class', 'em-legend-rect')\r\n                .attr('x', 0)\r\n                .attr('y', y)\r\n                .attr('width', config.shapeWidth)\r\n                .attr('height', config.shapeHeight)\r\n                .style('fill', scs[code])\r\n\r\n                .on('mouseover', function () {\r\n                    highlightRegions(out.map, code)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightRegions, code)\r\n                    }\r\n                })\r\n                .on('mouseout', function () {\r\n                    unhighlightRegions(out.map)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightRegions, code)\r\n                    }\r\n                })\r\n\r\n            //label\r\n            out._colorLegendContainer\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', config.shapeWidth + config.labelOffsets.x)\r\n                .attr('y', y + config.shapeHeight * 0.5)\r\n                .attr('dy', '0.35em') // ~vertical centering\r\n                .text(map.catLabels()[code] || code)\r\n\r\n            i++\r\n        }\r\n\r\n        //'no data' legend box\r\n        if (config.noData) {\r\n            let sizeLegendHeight = 0\r\n            if (out._sizeLegendContainer) {\r\n                sizeLegendHeight = out._sizeLegendContainer.node().getBBox().height\r\n            }\r\n            const y =\r\n                sizeLegendHeight +\r\n                out.colorLegend.marginTop +\r\n                out.boxPadding +\r\n                (config.title ? out.titleFontSize + out.boxPadding : 0) +\r\n                i * (config.shapeHeight + config.shapePadding)\r\n\r\n            const container = out.lgg.append('g').attr('class', 'em-no-data-legend').attr('transform', `translate(${out.boxPadding},${y})`)\r\n            out.appendNoDataLegend(container, out.noDataText, highlightRegions, unhighlightRegions)\r\n        }\r\n    }\r\n\r\n    // Highlight selected segments on mouseover\r\n    function highlightRegions(map, code) {\r\n        const allSegments = map.svg_.selectAll('.piechart').selectAll('path[code]')\r\n\r\n        // Set all segments to transparent\r\n        allSegments.style('opacity', 0)\r\n\r\n        // Highlight only the selected segments by restoring their original color\r\n        const selectedSegments = allSegments.filter(\"path[code='\" + code + \"']\")\r\n        selectedSegments.each(function () {\r\n            select(this).style('opacity', 1) // Restore original color for selected segments\r\n        })\r\n    }\r\n\r\n    // Reset all segments to their original colors on mouseout\r\n    function unhighlightRegions(map) {\r\n        const allSegments = map.svg_.selectAll('.piechart').selectAll('path[code]')\r\n\r\n        // Restore each segments's original color from the fill___ attribute\r\n        allSegments.each(function () {\r\n            select(this).style('opacity', 1)\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n","import { scaleSqrt } from 'd3-scale'\r\nimport { select, selectAll } from 'd3-selection'\r\nimport { arc, pie } from 'd3-shape'\r\nimport { extent, sum } from 'd3-array'\r\nimport { interpolateOrRd, schemeCategory10 } from 'd3-scale-chromatic'\r\nimport * as StatMap from '../core/stat-map'\r\nimport * as PiechartLegend from '../legend/legend-piecharts'\r\nimport { executeForAllInsets, getRegionsSelector, spaceAsThousandSeparator } from '../core/utils'\r\nimport { runDorlingSimulation, stopDorlingSimulation } from '../core/dorling/dorling'\r\nimport { interpolate } from 'd3-interpolate'\r\n\r\n/**\r\n * Returns a proportional pie chart map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, true, 'pie')\r\n\r\n    out.dorling_ = config?.dorling || false\r\n    out.animateDorling_ = true\r\n\r\n    // pie charts\r\n    out.pieMinRadius_ = 5\r\n    out.pieMaxRadius_ = 15\r\n    out.pieChartInnerRadius_ = 0\r\n    out.pieStrokeFill_ = 'white'\r\n    out.pieStrokeWidth_ = 0.3\r\n\r\n    //tooltip pie chart\r\n    out.tooltipPieRadius_ = 40\r\n    out.tooltipPieInnerRadius_ = 0\r\n\r\n    //colors - indexed by category code\r\n    out.catColors_ = undefined\r\n    //labels - indexed by category code\r\n    out.catLabels_ = undefined\r\n\r\n    // 'other' section of the pie chart for when 'out.pieTotalCode_' is defined\r\n    out.pieOtherColor_ = '#FFCC80'\r\n    out.pieOtherText_ = 'Other'\r\n\r\n    //show piecharts only when data for all categories is complete.\r\n    //Otherwise, consider the regions as being with no data at all.\r\n    out.showOnlyWhenComplete_ = false\r\n\r\n    out.classifierSize_ = null //d3 scale for scaling pie sizes\r\n    out.statPie_ = null\r\n    /** The code of the \"total\" category in the eurostat database */\r\n    out.pieTotalCode_ = undefined\r\n\r\n    /** The codes of the categories to consider for the composition. */\r\n    out.statCodes_ = undefined\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    ;[\r\n        'catColors_',\r\n        'catLabels_',\r\n        'showOnlyWhenComplete_',\r\n        'noDataFillStyle_',\r\n        'pieMaxRadius_',\r\n        'pieMinRadius_',\r\n        'pieChartInnerRadius_',\r\n        'pieOtherColor_',\r\n        'pieOtherText_',\r\n        'pieStrokeFill_',\r\n        'pieStrokeWidth_',\r\n        'dorling_',\r\n        'animateDorling_',\r\n        'pieTotalCode_',\r\n        'statCodes_',\r\n    ].forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config)\r\n        [\r\n            'catColors',\r\n            'catLabels',\r\n            'showOnlyWhenComplete',\r\n            'noDataFillStyle',\r\n            'pieMaxRadius',\r\n            'pieMinRadius',\r\n            'pieChartInnerRadius',\r\n            'pieOtherColor',\r\n            'pieOtherText',\r\n            'pieStrokeFill',\r\n            'pieStrokeWidth',\r\n            'statCodes',\r\n        ].forEach(function (key) {\r\n            if (config[key] != undefined) out[key](config[key])\r\n        })\r\n\r\n    /**\r\n     * A function to define a pie chart map easily, without repetition of information.\r\n     * Only for eurobase data sources.\r\n     *\r\n     * @param {*} stat A pattern for the stat data source\r\n     * @param {String} dim The dimension (defined in eurostat REST API) of the composition.\r\n     * @param {Array} codes The category codes of the composition\r\n     * @param {Array} labels Optional: The labels for the category codes\r\n     * @param {Array} colors Optional: The colors for the category\r\n     * @param {string} tCode Optional: The category code of the total (used to calculate total & \"other\" values if codes array dont represent all possible categories)\r\n     */\r\n    out.statPie = function (stat, dim, codes, labels, colors, tCode) {\r\n        //add one dataset (stat) config for each category (code)\r\n        stat.filters = stat.filters || {}\r\n        for (let i = 0; i < codes.length; i++) {\r\n            //category code\r\n            const code = codes[i]\r\n            stat.filters[dim] = code\r\n            const sc_ = {}\r\n            for (let key in stat) {\r\n                sc_[key] = stat[key]\r\n            }\r\n            sc_.filters = {}\r\n            for (let key in stat.filters) {\r\n                sc_.filters[key] = stat.filters[key]\r\n            }\r\n            out.stat(code, sc_)\r\n\r\n            //if specified, retrieve and assign color\r\n            if (colors) {\r\n                out.catColors_ = out.catColors_ || {}\r\n                out.catColors_[code] = colors[i]\r\n            }\r\n            //if specified, retrieve and assign label\r\n            if (labels) {\r\n                out.catLabels_ = out.catLabels_ || {}\r\n                out.catLabels_[code] = labels[i]\r\n            }\r\n        }\r\n\r\n        //set out.statCodes_\r\n        out.statCodes_ = codes\r\n\r\n        //set out.pieTotalCode_\r\n        if (tCode) {\r\n            out.pieTotalCode_ = tCode\r\n            stat.filters[dim] = tCode\r\n            const sc_ = {}\r\n            for (let key in stat) sc_[key] = stat[key]\r\n            sc_.filters = {}\r\n            for (let key in stat.filters) sc_.filters[key] = stat.filters[key]\r\n            out.stat(tCode, sc_)\r\n        } else {\r\n            out.pieTotalCode_ = undefined\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        // apply classification to all insets that are outside of the main map's SVG\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n        }\r\n\r\n        // apply to main map\r\n        applyClassificationToMap(out)\r\n\r\n        return out\r\n    }\r\n\r\n    const applyClassificationToMap = function (map) {\r\n        //if not provided, get list of stat codes from the map stat data\r\n        if (!out.statCodes_) {\r\n            //get list of stat codes.\r\n            out.statCodes_ = Object.keys(out.statData_)\r\n            //remove \"default\", if present\r\n            const index = out.statCodes_.indexOf('default')\r\n            if (index > -1) out.statCodes_.splice(index, 1)\r\n        }\r\n\r\n        //define size scaling function\r\n        let domain = getDatasetMaxMin()\r\n        if (!isNaN(domain[0])) {\r\n            out.classifierSize_ = scaleSqrt().domain(domain).range([out.pieMinRadius_, out.pieMaxRadius_])\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        try {\r\n            if (!out.classifierSize_) return //cannot style without classifier\r\n\r\n            //if not specified, build default color ramp\r\n            if (!out.catColors_) {\r\n                out.catColors({})\r\n                for (let i = 0; i < out.statCodes_.length; i++) out.catColors_[out.statCodes_[i]] = schemeCategory10[i % 10]\r\n            }\r\n            if (out.pieTotalCode_) {\r\n                //when total code is used, an 'other' section is added to the pie\r\n                out.catColors_['other'] = out.pieOtherColor_\r\n                out.catLabels_['other'] = out.pieOtherText_\r\n            }\r\n\r\n            //if not specified, initialise category labels\r\n            out.catLabels_ = out.catLabels_ || {}\r\n\r\n            // apply style to insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n            }\r\n\r\n            // apply to main map\r\n            applyStyleToMap(out)\r\n\r\n            //dorling cartograms\r\n            if (out.dorling_) {\r\n                runDorlingSimulation(out, (d) => {\r\n                    const total = getRegionTotal(d.properties.id) || 0\r\n                    return out.classifierSize_(total) || 0\r\n                })\r\n            } else {\r\n                stopDorlingSimulation(out)\r\n            }\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in pie symbols styling: ' + e.message)\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n        //build and assign pie charts to the regions\r\n        //collect nuts ids from g elements. TODO: find better way of sharing regions with pies\r\n        let regionFeatures = []\r\n        if (out.svg_) {\r\n            let s = map.getCentroidsGroup(map)\r\n            if (s) {\r\n                let sym = s.selectAll('g.em-centroid')\r\n                sym.append('g')\r\n                    .attr('class', 'em-pie')\r\n                    .attr('id', (rg) => {\r\n                        regionFeatures.push(rg)\r\n                        return 'pie_' + rg.properties.id\r\n                    })\r\n\r\n                // set region hover function\r\n                const selector = getRegionsSelector(out)\r\n                let regions = out.svg().selectAll(selector)\r\n\r\n                if (map.geo_ !== 'WORLD') {\r\n                    if (map.nutsLevel_ == 'mixed') {\r\n                        styleMixedNUTSRegions(map, regions)\r\n                    }\r\n                }\r\n                addPieChartsToMap(regionFeatures)\r\n\r\n                // Set up mouse events\r\n                addMouseEventsToRegions(map, regions)\r\n            }\r\n        }\r\n    }\r\n\r\n    function addMouseEventsToRegions(map, regions) {\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                const sel = select(this)\r\n                sel.attr('fill___', sel.style('fill'))\r\n                sel.style('fill', out.hoverColor_)\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n            })\r\n            .on('mouseout', function () {\r\n                const sel = select(this)\r\n                let newFill = sel.attr('fill___')\r\n                if (newFill) {\r\n                    sel.style('fill', sel.attr('fill___'))\r\n                    if (out._tooltip) out._tooltip.mouseout()\r\n                }\r\n            })\r\n    }\r\n\r\n    function addPieChartsToMap(regionFeatures) {\r\n        regionFeatures.forEach((region) => {\r\n            const regionId = region.properties.id\r\n            //prepare data for pie chart\r\n            const data = []\r\n            const comp = getComposition(regionId)\r\n            for (const key in comp) data.push({ code: key, value: comp[key] })\r\n\r\n            //case of regions with no data\r\n            if (!data || data.length == 0) {\r\n                return\r\n            }\r\n\r\n            // create svg for pie chart\r\n            // can be more than one center point for each nuts ID (e.g. Malta when included in insets)\r\n            let nodes = out.svg().selectAll('#pie_' + regionId)\r\n\r\n            // define radius\r\n            const r = out.classifierSize_(getRegionTotal(regionId))\r\n            const ir = out.pieChartInnerRadius_\r\n\r\n            //make pie chart. See https://observablehq.com/@d3/pie-chart\r\n            const pie_ = pie()\r\n                .sort(null)\r\n                .value((d) => d.value)\r\n            const arcFunction = arc().innerRadius(ir).outerRadius(r)\r\n\r\n            const chartsnodes = nodes\r\n                .append('g')\r\n                .attr('class', 'piechart')\r\n                .attr('stroke', out.pieStrokeFill_)\r\n                .attr('stroke-width', out.pieStrokeWidth_ + 'px')\r\n                .style('pointer-events', 'none') // optional: block during transition\r\n\r\n            // Draw pie segments\r\n            const pieData = pie_(data)\r\n\r\n            const paths = chartsnodes\r\n                .selectAll('path')\r\n                .data(pieData)\r\n                .join('path')\r\n                .attr('fill', (d) => out.catColors_[d.data.code] || 'lightgray')\r\n                .attr('code', (d) => d.data.code)\r\n\r\n                .each(function (d) {\r\n                    this._current = { startAngle: d.startAngle, endAngle: d.startAngle }\r\n                }) // start collapsed\r\n                .transition()\r\n                .delay((d, i) => i * 150) // progressive segment delay\r\n                .duration(out.transitionDuration_)\r\n                .attrTween('d', function (d) {\r\n                    const interpolater = interpolate(this._current, d)\r\n                    this._current = interpolater(1)\r\n                    return function (t) {\r\n                        return arcFunction(interpolater(t))\r\n                    }\r\n                })\r\n                .on('end', function () {\r\n                    select(chartsnodes.node()).style('pointer-events', null) // enable interaction after last slice\r\n                })\r\n\r\n            // add mouse events to pies\r\n            chartsnodes\r\n                .on('mouseover', function (e, rg) {\r\n                    const parent = select(this)\r\n                    parent.style('stroke-width', out.pieStrokeWidth_ + 1).style('stroke', 'black')\r\n                    if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                })\r\n                .on('mousemove', function (e) {\r\n                    if (out._tooltip) out._tooltip.mousemove(e)\r\n                })\r\n                .on('mouseout', function () {\r\n                    const parent = select(this)\r\n                    parent.style('stroke-width', out.pieStrokeWidth_).style('stroke', out.pieStrokeFill_)\r\n                    if (out._tooltip) out._tooltip.mouseout()\r\n                })\r\n        })\r\n    }\r\n\r\n    function styleMixedNUTSRegions(map, regions) {\r\n        regions.each(function (rg) {\r\n            const sel = select(this)\r\n\r\n            if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n\r\n            const lvl = sel.attr('lvl')\r\n            //const total = getRegionTotal(rg.properties.id)\r\n            const comp = getComposition(rg.properties.id)\r\n\r\n            // Determine if region has data\r\n            const hasData = comp //|| (total && (total.value || total.value === 0 || total === 0))\r\n\r\n            // Compute styles\r\n            let display = hasData ? (map.geo_ === 'WORLD' ? 'block' : null) : 'none'\r\n            let stroke = null\r\n            let strokeWidth = null\r\n\r\n            if (hasData) {\r\n                if (lvl !== '0') {\r\n                    stroke = sel.style('stroke') || '#777'\r\n                    if (map.geo_ === 'WORLD') {\r\n                        strokeWidth = sel.style('stroke-width') || '#777'\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Apply all styles at once\r\n            sel.style('display', display).style('stroke', stroke).style('stroke-width', strokeWidth)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Function to compute composition for region id, for each category.\r\n     * Return an object with, for each category, the share [0,1] of the category.\r\n     * @param {*} id\r\n     */\r\n    const getComposition = function (id) {\r\n        const comp = {}\r\n        let sum = 0\r\n        const codes = out.statCodes_\r\n\r\n        // Compute category values and sum\r\n        for (let i = 0; i < codes.length; i++) {\r\n            const sc = codes[i]\r\n            const s = out.statData(sc).get(id)\r\n            const val = s?.value\r\n\r\n            // Skip invalid or NaN values\r\n            if (val === null || val === undefined || isNaN(val)) {\r\n                if (out.showOnlyWhenComplete()) return undefined\r\n                continue\r\n            }\r\n\r\n            comp[sc] = val\r\n            sum += val\r\n        }\r\n\r\n        // Override sum if a total stat is specified\r\n        if (out.pieTotalCode_) {\r\n            const totalData = out.statData(out.pieTotalCode_)\r\n            const totalEntry = totalData.get(id)\r\n            const totalVal = totalEntry?.value\r\n\r\n            if (totalVal === null || totalVal === undefined || isNaN(totalVal)) {\r\n                // No valid total => treat as zero\r\n                sum = 0\r\n            } else {\r\n                sum = totalVal\r\n            }\r\n        }\r\n\r\n        // Return undefined if no data or sum is zero\r\n        if (!sum || isNaN(sum)) return undefined\r\n\r\n        // Compute ratios\r\n        for (const sc of codes) {\r\n            if (comp[sc] !== undefined) {\r\n                comp[sc] /= sum\r\n            }\r\n        }\r\n\r\n        // Compute \"other\" if using total\r\n        if (out.pieTotalCode_) {\r\n            const totalPerc = Object.values(comp).reduce((a, b) => a + b, 0)\r\n            comp['other'] = Math.max(0, 1 - totalPerc) // protect against floating-point drift\r\n        }\r\n\r\n        return comp\r\n    }\r\n\r\n    /**\r\n     * @function getDatasetMaxMin\r\n     * @description gets the maximum and minimum total of all dimensions combined for each region. Used to define the domain of the pie size scaling function.\r\n     * @returns [min,max]\r\n     */\r\n    function getDatasetMaxMin() {\r\n        let totals = []\r\n        let sel = out.getCentroidsGroup(out).selectAll('g.em-centroid').data()\r\n\r\n        sel.forEach((rg) => {\r\n            let id = rg.properties.id\r\n            let total = getRegionTotal(id)\r\n            if (total) {\r\n                totals.push(total)\r\n            }\r\n        })\r\n\r\n        let minmax = extent(totals)\r\n        return minmax\r\n    }\r\n\r\n    /**\r\n     * Get absolute total value of combined statistical values for a specific region. E.g total livestock\r\n     * @param {*} id nuts region id\r\n     */\r\n    const getRegionTotal = function (id) {\r\n        let sum = 0\r\n        let s\r\n        if (out.pieTotalCode_) {\r\n            //when total is a stat code\r\n            const totalData = out.statData(out.pieTotalCode_)\r\n            s = totalData.get(id)\r\n            //case when some data is missing\r\n            if (!s || (s.value != 0 && !s.value) || isNaN(s.value)) {\r\n                if (out.showOnlyWhenComplete()) {\r\n                    sum = undefined\r\n                }\r\n            } else {\r\n                sum = s.value\r\n            }\r\n        } else {\r\n            //get stat value for each category. Compute the sum.\r\n            for (let i = 0; i < out.statCodes_.length; i++) {\r\n                //retrieve code and stat value\r\n                const sc = out.statCodes_[i]\r\n                s = out.statData(sc).get(id)\r\n                //case when some data is missing\r\n                if (!s || (s.value != 0 && !s.value) || isNaN(s.value)) {\r\n                    if (out.showOnlyWhenComplete()) return undefined\r\n                    else continue\r\n                }\r\n                sum += s.value\r\n            }\r\n        }\r\n\r\n        //case when no data\r\n        if (sum == 0) return undefined\r\n        return sum\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return PiechartLegend.legend\r\n    }\r\n\r\n    //specific tooltip text function\r\n    // tooltip chart dimensions\r\n    const width = 150\r\n    const height = 120\r\n    const margin = 10\r\n    const radius = Math.min(width, height) / 2 - margin\r\n\r\n    // Generate pie and arcs\r\n    const pie_ = pie()\r\n        .sort(null)\r\n        .value((d) => d.value)\r\n    const innerArc = arc()\r\n        .innerRadius(0)\r\n        .outerRadius(radius * 0.8)\r\n    const outerArc = arc()\r\n        .innerRadius(radius * 0.9)\r\n        .outerRadius(radius * 0.9)\r\n    // Tooltip function for pie charts\r\n    const pieChartTooltipFunction = function (rg, map) {\r\n        const regionName = rg.properties.na || rg.properties.name\r\n        const regionId = rg.properties.id\r\n        const comp = getComposition(regionId)\r\n\r\n        const data = []\r\n        for (const key in comp) data.push({ code: key, value: comp[key] })\r\n\r\n        let html = ''\r\n\r\n        // Header\r\n        html += `<div class=\"em-tooltip-bar\">${regionName}${regionId ? ` (${regionId})` : ''}</div>`\r\n\r\n        if (!data || data.length === 0) {\r\n            html += `<div>${out.noDataText()}</div>`\r\n            return html\r\n        }\r\n\r\n        const pieData = pie_(data)\r\n\r\n        let paths = ''\r\n        let polylines = ''\r\n        let labels = ''\r\n\r\n        for (const d of pieData) {\r\n            const fill = out.catColors()[d.data.code] || 'lightgray'\r\n            const dPath = innerArc(d)\r\n            paths += `<path d=\"${dPath}\" fill=\"${fill}\" stroke=\"white\" stroke-width=\"1\" opacity=\"0.7\"></path>`\r\n\r\n            if (d.data.value > 0.1) {\r\n                const posA = innerArc.centroid(d)\r\n                const posB = outerArc.centroid(d)\r\n                const posC = outerArc.centroid(d)\r\n                const midangle = d.startAngle + (d.endAngle - d.startAngle) / 2\r\n                posC[0] = radius * 0.95 * (midangle < Math.PI ? 1 : -1)\r\n\r\n                polylines += `<polyline points=\"${posA.join(',')} ${posB.join(',')} ${posC.join(',')}\"\r\n                stroke=\"black\" fill=\"none\" stroke-width=\"1\" />`\r\n\r\n                const labelPos = outerArc.centroid(d)\r\n                labelPos[0] = radius * 0.99 * (midangle < Math.PI ? 1 : -1)\r\n                const anchor = midangle < Math.PI ? 'start' : 'end'\r\n                const percent = (d.data.value * 100).toFixed()\r\n                if (!isNaN(percent)) {\r\n                    labels += `<text x=\"${labelPos[0]}\" y=\"${labelPos[1]}\" text-anchor=\"${anchor}\" font-size=\"12px\">\r\n                    ${percent}%\r\n                </text>`\r\n                }\r\n            }\r\n        }\r\n\r\n        const svg = `\r\n        <div class='em-tooltip-piechart-container'>\r\n            <svg viewBox=\"${-width / 2} ${-height / 2} ${width} ${height}\" width=\"${width}\" height=\"${height - margin / 2}\">\r\n                <g transform=\"translate(0,0)\">\r\n                    ${paths}\r\n                    ${polylines}\r\n                    ${labels}\r\n                </g>\r\n            </svg>\r\n        </div>\r\n    `\r\n        html += svg\r\n\r\n        // Breakdown (sorted by value, with percentages)\r\n        html += `<div class=\"em-tooltip-breakdown\">`\r\n\r\n        // Collect all values, compute total, and sort descending\r\n        const breakdownData = out.statCodes_\r\n            .map((sc) => {\r\n                const s = out.statData(sc).get(regionId)\r\n                return s && s.value !== undefined && s.value !== null\r\n                    ? { code: sc, label: out.catLabels_[sc], value: s.value, color: out.catColors()[sc] || '#666' }\r\n                    : null\r\n            })\r\n            .filter(Boolean)\r\n            .sort((a, b) => b.value - a.value)\r\n\r\n        const total = getRegionTotal(regionId) || breakdownData.reduce((sum, d) => sum + d.value, 0)\r\n\r\n        // Render each category\r\n        for (const item of breakdownData) {\r\n            const percent = total ? ((item.value / total) * 100).toFixed(0) : 0\r\n            html += `\r\n        <div class=\"em-breakdown-item\">\r\n            <span class=\"em-breakdown-color\" style=\"background:${item.color}\"></span>\r\n            <span class=\"em-breakdown-label\">${item.label}</span>\r\n            <span class=\"em-breakdown-value\">${item.value?.toFixed ? spaceAsThousandSeparator(item.value) : 0} (${isNaN(percent) ? 0 : percent}%)</span>\r\n        </div>\r\n    `\r\n        }\r\n\r\n        // Total (always last, no percentage)\r\n        if (total !== undefined && total !== null) {\r\n            const unit = out.statData(out.statCodes_[0]).unitText() || ''\r\n            html += `\r\n        <div class=\"em-breakdown-item em-total\">\r\n            <span class=\"em-breakdown-label\">Total</span>\r\n            <span class=\"em-breakdown-value\">${spaceAsThousandSeparator(total)} ${unit}</span>\r\n        </div>\r\n    `\r\n        }\r\n\r\n        html += `</div>`\r\n\r\n        return html\r\n    }\r\n\r\n    out.tooltip_.textFunction = pieChartTooltipFunction\r\n\r\n    return out\r\n}\r\n","import { select, create } from 'd3-selection'\r\nimport { scaleLinear, scaleSqrt } from 'd3-scale'\r\nimport { line, area } from 'd3-shape'\r\nimport { extent, min, max } from 'd3-array'\r\nimport { axisBottom, axisLeft, axisRight } from 'd3-axis'\r\nimport * as StatMap from '../core/stat-map'\r\nimport * as lgch from '../legend/choropleth/legend-choropleth'\r\nimport { executeForAllInsets, getRegionsSelector } from '../core/utils'\r\nimport * as StatisticalData from '../core/stat-data'\r\n\r\n/**\r\n * Returns a sparkline map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, true, 'spark')\r\n\r\n    out.sparkLineColor_ = 'black'\r\n    out.sparkAreaColor_ = '#41afaa'\r\n    out.sparkLineWidth_ = 30\r\n    out.sparkLineHeight_ = 20\r\n    out.sparkLineStrokeWidth_ = 0.4\r\n    out.sparkLineOpacity_ = 0.6\r\n    out.sparkType_ = 'line'\r\n    out.sparkLineCircleRadius_ = 0\r\n    out.sparkTooltipChart_ = {\r\n        width: 100,\r\n        height: 50,\r\n        margin: { left: 60, right: 40, top: 40, bottom: 40 },\r\n        circleRadius: 1.5,\r\n    }\r\n\r\n    //show sparklines only when data for all dates is complete.\r\n    //Otherwise, consider the regions as being with no data at all.\r\n    out.showOnlyWhenComplete_ = false\r\n    out.sparkLineChartFunction_ = undefined\r\n\r\n    out.statSpark_ = null\r\n    out.sparkHeightClassifier_ = null\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    const paramNames = [\r\n        'sparkLineColor_',\r\n        'showOnlyWhenComplete_',\r\n        'sparkType_',\r\n        'sparkLineWidth_',\r\n        'sparkLineHeight_',\r\n        'sparkLineStrokeWidth_',\r\n        'sparkLineOpacity_',\r\n        'sparkLineCircleRadius_',\r\n        'sparkLineAreaColor_',\r\n        'sparkTooltipChart_',\r\n        'sparkLineChartFunction_',\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    // Allow users manually add sparkline data\r\n    out.sparklineData_ = undefined\r\n    out.sparklineData = function (dataObject) {\r\n        const dates = Object.keys(dataObject[Object.keys(dataObject)[0]])\r\n        out._statDates = dates\r\n\r\n        dates.forEach((date) => {\r\n            const statData = StatisticalData.statData()\r\n            const perDateValues = {}\r\n\r\n            for (const regionId in dataObject) {\r\n                const regionValues = dataObject[regionId]\r\n                perDateValues[regionId] = regionValues[date]\r\n            }\r\n\r\n            statData.setData(perDateValues)\r\n            out.statData(date, statData)\r\n        })\r\n\r\n        return out\r\n    }\r\n\r\n    /**\r\n     * A function to define a sparkline map easily, without repetition of information.\r\n     * Only for eurobase data sources.\r\n     *\r\n     * @param {*} stat A pattern for the stat data source\r\n     * @param {Array} dates The dates of the composition (time parameter)\r\n     * @param {Array} labels Optional: The labels for the dates\r\n     */\r\n    out.statSpark = function (stat, dates, labels) {\r\n        //add one dataset config for each category\r\n        stat.filters = stat.filters || {}\r\n        for (let i = 0; i < dates.length; i++) {\r\n            //category code\r\n            const date = dates[i]\r\n            stat.filters.time = date\r\n            const sc_ = {}\r\n            for (let key in stat) sc_[key] = stat[key]\r\n            sc_.filters = {}\r\n            for (let key in stat.filters) sc_.filters[key] = stat.filters[key]\r\n            out.stat(date, sc_)\r\n\r\n            //if specified, retrieve and assign label\r\n            if (labels) {\r\n                out.catLabels_ = out.catLabels_ || {}\r\n                out.catLabels_[date] = labels[i]\r\n            }\r\n        }\r\n\r\n        //set statCodes\r\n        out._statDates = dates\r\n\r\n        return out\r\n    }\r\n\r\n    /** The codes of the categories to consider for the composition. */\r\n    out._statDates = undefined\r\n\r\n    /**\r\n     * Function to compute composition for region id, for each date.\r\n     * Return an object with, for each date, its statistical value for the region\r\n     * @param {*} id\r\n     * @returns [{date,value}]\r\n     */\r\n    const getComposition = function (id) {\r\n        let comp = [],\r\n            sum = 0\r\n\r\n        // Get stat value for each category and compute the sum.\r\n        for (let i = 0; i < out._statDates.length; i++) {\r\n            // Retrieve code and stat value\r\n            const date = out._statDates[i]\r\n            const s = out.statData(date).get(id)\r\n\r\n            // Case when some data is missing\r\n            if (!s || (s.value != 0 && !s.value) || isNaN(s.value)) {\r\n                if (out.showOnlyWhenComplete()) return undefined\r\n                else continue\r\n            }\r\n\r\n            comp.push({ date: date, value: s.value })\r\n            sum += s.value\r\n        }\r\n\r\n        // Case when no data\r\n        if (sum == 0) return undefined\r\n\r\n        // Calculate year-on-year percentage change\r\n        for (let i = 1; i < comp.length; i++) {\r\n            const previousValue = comp[i - 1].value\r\n            const currentValue = comp[i].value\r\n\r\n            // Calculate percentage change from previous value\r\n            comp[i].percentageChange = previousValue === 0 ? 0.001 : ((currentValue - previousValue) / previousValue) * 100\r\n        }\r\n\r\n        // The first data point doesn't have a previous value to compare with\r\n        //comp[0].percentageChange = 0.001 // or you can leave it undefined or null, depending on how you want to handle it\r\n\r\n        return comp\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        //if not provided, get list of stat codes from the map stat data\r\n        if (!out._statDates) {\r\n            //get list of stat codes.\r\n            out._statDates = Object.keys(out.statData_)\r\n            //remove \"default\", if present\r\n            const index = out._statDates.indexOf('default')\r\n            if (index > -1) out._statDates.splice(index, 1)\r\n        }\r\n\r\n        // define size scaling function\r\n        // Define the domain correctly for the log scale\r\n        out.domain = getDatasetMaxMin() // Avoid 0 for log scale\r\n\r\n        // for area charts\r\n        out.widthClassifier_ = scaleSqrt().domain(out.domain).range([0, out.sparkLineWidth_])\r\n        out.heightClassifier_ = scaleSqrt().domain(out.domain).range([0, out.sparkLineHeight_])\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        try {\r\n            // apply to main map\r\n            applyStyleToMap(out)\r\n\r\n            // apply style to insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n            }\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in proportional symbols styling: ' + e.message)\r\n            console.error(e)\r\n        }\r\n\r\n\r\n        return out\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n\r\n        //build and assign pie charts to the regions\r\n        //collect nuts ids from g elements. TODO: find better way of getting IDs\r\n        let nutsIds = []\r\n        let s = map.getCentroidsGroup(map)\r\n        let sym = s.selectAll('g.em-centroid').attr('id', (rg) => {\r\n            nutsIds.push(rg.properties.id)\r\n            return 'spark_' + rg.properties.id\r\n        })\r\n\r\n        setRegionStyles(map)\r\n        addSparkLinesToMap(nutsIds)\r\n        addMouseEventsToRegions(map)\r\n        return map\r\n\r\n    }\r\n\r\n    function setRegionStyles(map) {\r\n\r\n    }\r\n\r\n    function addMouseEventsToRegions(map) {\r\n        // set region hover function\r\n        const selector = getRegionsSelector(map)\r\n        let regions = out.svg().selectAll(selector)\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                const data = getComposition(rg.properties.id)\r\n                if (data) {\r\n                    const sel = select(this)\r\n                    sel.attr('fill___', sel.style('fill'))\r\n                    sel.style('fill', out.hoverColor_)\r\n                    if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n                }\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                const data = getComposition(rg.properties.id)\r\n                if (data) {\r\n                    if (out._tooltip) out._tooltip.mousemove(e)\r\n                }\r\n            })\r\n            .on('mouseout', function () {\r\n                const sel = select(this)\r\n                let currentFill = sel.style('fill')\r\n                let newFill = sel.attr('fill___')\r\n                if (newFill) {\r\n                    sel.style('fill', sel.attr('fill___'))\r\n                    if (out._tooltip) out._tooltip.mouseout()\r\n                }\r\n            })\r\n    }\r\n\r\n    function addSparkLinesToMap(ids) {\r\n        ids.forEach((nutsid) => {\r\n            //create svg for sparkline\r\n            // can be more than one center point for each nuts ID (e.g. Malta when included in insets)\r\n            let node = out.svg().select('#spark_' + nutsid)\r\n            let data = getComposition(nutsid)\r\n\r\n            if (data) {\r\n                createSparkLineChart(node, data, out.sparkLineWidth_, out.sparkLineHeight_)\r\n            }\r\n        })\r\n    }\r\n\r\n    function createSparkLineChart(node, data, width, height, isForTooltip = false) {\r\n        // call custom user function to draw the sparkline\r\n        if (out.sparkLineChartFunction_ && out.sparkLineChartFunction_ !== createSparkLineChart) {\r\n            return out.sparkLineChartFunction_(node, data, width, height, isForTooltip)\r\n        }\r\n\r\n        const xScale = scaleLinear()\r\n            .domain([0, out._statDates.length - 1])\r\n            .range([0.5, width - 0.5])\r\n\r\n        const minValue = min(data.map((d) => d.value)) || 0\r\n        const maxValue = max(data.map((d) => d.value)) || 1\r\n\r\n        const yScale = scaleLinear().domain([minValue, maxValue]).range([height, 0])\r\n\r\n        const scaledData = data.map((d, i) => ({\r\n            ...d,\r\n            scaledXValue: xScale(i),\r\n            scaledYValue: yScale(d.value),\r\n        }))\r\n\r\n        const zeroY = yScale(0)\r\n\r\n        if (isForTooltip) {\r\n            // X-axis at bottom\r\n            node.append('g')\r\n                .attr('class', 'axis-x')\r\n                .attr('transform', `translate(0, ${height})`)\r\n                .call(\r\n                    axisBottom(xScale)\r\n                        .ticks(out._statDates.length)\r\n                        .tickFormat((d, i) => out._statDates[i])\r\n                )\r\n                .selectAll('text')\r\n                .style('text-anchor', 'end')\r\n                .attr('dx', '-.8em')\r\n                .attr('dy', '.15em')\r\n                .attr('transform', 'rotate(-65)')\r\n\r\n            // Y-axis with raw value labels\r\n            node.append('g').attr('class', 'axis-y').call(axisLeft(yScale).ticks(5))\r\n\r\n            // Horizontal zero reference line  only if min < 0 and max > 0\r\n            if (minValue < 0 && maxValue > 0) {\r\n                node.append('line')\r\n                    .attr('x1', 0)\r\n                    .attr('x2', width)\r\n                    .attr('y1', zeroY)\r\n                    .attr('y2', zeroY)\r\n                    .attr('stroke', 'gray')\r\n                    .attr('stroke-dasharray', '2,2')\r\n                    .attr('stroke-width', 1)\r\n            }\r\n        }\r\n\r\n        const lineGenerator = line()\r\n            .x((d) => d.scaledXValue)\r\n            .y((d) => d.scaledYValue)\r\n\r\n        if (out.sparkType_ === 'area') {\r\n            node.append('path')\r\n                .datum(scaledData)\r\n                .attr('fill', typeof out.sparkAreaColor_ === 'function' ? (d, i) => out.sparkAreaColor_(d, i) : out.sparkAreaColor_)\r\n                .attr('stroke', 'none')\r\n                .attr('opacity', out.sparkLineOpacity_)\r\n                .attr('fill-opacity', 0.3)\r\n                .attr(\r\n                    'd',\r\n                    area()\r\n                        .x((d) => d.scaledXValue)\r\n                        .y0(zeroY)\r\n                        .y1((d) => d.scaledYValue)\r\n                )\r\n        }\r\n\r\n        const path = node.append('path')\r\n            .datum(scaledData)\r\n            .attr('fill', 'none')\r\n            .attr('opacity', out.sparkLineOpacity_)\r\n            .attr('stroke', typeof out.sparkLineColor_ === 'function'\r\n                ? (d, i) => out.sparkLineColor_(d, i)\r\n                : out.sparkLineColor_)\r\n            .attr('stroke-width', typeof out.sparkLineStrokeWidth_ === 'function'\r\n                ? (d, i) => out.sparkLineStrokeWidth_(d, i)\r\n                : out.sparkLineStrokeWidth_ + 'px')\r\n            .attr('d', lineGenerator);\r\n\r\n        // === Progressive draw animation ===\r\n        if (!isForTooltip) {\r\n            const totalLength = path.node().getTotalLength();\r\n            path\r\n                .attr('stroke-dasharray', totalLength)\r\n                .attr('stroke-dashoffset', totalLength)\r\n                .transition()\r\n                .duration(out.transitionDuration())\r\n                .attr('stroke-dashoffset', 0);\r\n        }\r\n\r\n        node.selectAll('circle')\r\n            .data(scaledData)\r\n            .enter()\r\n            .append('circle')\r\n            .attr('cx', (d) => d.scaledXValue)\r\n            .attr('cy', (d) => d.scaledYValue)\r\n            .attr('r', out.sparkLineCircleRadius_)\r\n            .attr('fill', 'red')\r\n            .attr('stroke', 'none')\r\n    }\r\n\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = function (region, map) {\r\n        const buf = []\r\n\r\n        const regionName = region.properties.na\r\n        const regionId = region.properties.id\r\n        buf.push(`\r\n                <div class=\"em-tooltip-bar\">\r\n                    <b>${regionName}</b>${regionId ? ` (${regionId})` : ''}\r\n                </div>\r\n            `)\r\n\r\n        const chartHeight = out.sparkTooltipChart_.height\r\n        const chartWidth = out.sparkTooltipChart_.width\r\n        const margin = out.sparkTooltipChart_.margin\r\n        const data = getComposition(region.properties.id)\r\n\r\n        if (data) {\r\n            // Total SVG size (including margins)\r\n            const totalWidth = chartWidth + margin.left + margin.right\r\n            const totalHeight = chartHeight + margin.top + margin.bottom\r\n\r\n            // Create detached div\r\n            const container = create('div').attr('class', 'em-tooltip-chart-container')\r\n\r\n            // Create SVG with full size\r\n            const svg = container.append('svg').attr('class', 'em-tooltip-chart-svg').attr('width', totalWidth).attr('height', totalHeight)\r\n\r\n            // Inner group where chart is drawn\r\n            const g = svg.append('g').attr('transform', `translate(${margin.left}, ${margin.top})`)\r\n\r\n            // Call sparkline drawing on the inner area only\r\n            createSparkLineChart(g, data, chartWidth, chartHeight, true)\r\n\r\n            // Add result to tooltip buffer\r\n            buf.push(container.node().outerHTML)\r\n        }\r\n\r\n        return buf.join('')\r\n    }\r\n\r\n    /**\r\n     * @function getDatasetMaxMin\r\n     * @description gets the maximum and minimum values of all dates for each region. Used to define the domain of the sparkline Y axis.\r\n     * @returns [min,max]\r\n     */\r\n    function getDatasetMaxMin() {\r\n        const maxs = []\r\n        const sel = out.getCentroidsGroup(out).selectAll('g.em-centroid').data()\r\n\r\n        sel.forEach((rg) => {\r\n            const id = rg.properties.id\r\n            const regionMax = getRegionMax(id)\r\n            if (regionMax !== undefined) {\r\n                maxs.push(regionMax)\r\n            }\r\n        })\r\n\r\n        if (maxs.length === 0) {\r\n            return [0, 1] // fallback if no data found\r\n        }\r\n\r\n        return extent(maxs)\r\n    }\r\n\r\n    /**\r\n     * Get absolute total value of combined statistical values for a specific region. E.g total livestock\r\n     * @param {*} id nuts region id\r\n     */\r\n    const getRegionMax = function (id) {\r\n        let max = 0\r\n\r\n        // get stat value for each date and find the max\r\n        for (let i = 0; i < out._statDates.length; i++) {\r\n            const date = out._statDates[i]\r\n            const statData = out.statData(date)\r\n\r\n            if (!statData || typeof statData.get !== 'function') continue\r\n\r\n            const s = statData.get(id)\r\n            if (!s || (s.value !== 0 && !s.value) || isNaN(s.value)) {\r\n                if (out.showOnlyWhenComplete()) return undefined\r\n                continue\r\n            }\r\n\r\n            if (s.value > max) max = s.value\r\n        }\r\n\r\n        if (max === 0) return undefined\r\n        return max\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        //TODO define legend\r\n        return lgch.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n//build a color legend object\r\nexport const getColorLegend = function (colorFun) {\r\n    colorFun = colorFun || interpolateYlOrRd\r\n    return function (ecl, numberOfClasses) {\r\n        return colorFun(ecl / (numberOfClasses - 1))\r\n    }\r\n}\r\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(area);\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","import creator from \"./creator.js\";\nimport select from \"./select.js\";\n\nexport default function(name) {\n  return select(creator(name).call(document.documentElement));\n}\n","import { select } from \"d3-selection\";\r\nimport { format as d3format } from \"d3-format\";\r\nimport { spaceAsThousandSeparator } from \"../../core/utils\";\r\n\r\nconst fmt = d3format ? d3format(\".2s\") : (v => String(v));\r\nconst comma = d3format ? d3format(\",\") : (v => String(v));\r\n\r\nexport function drawHorizontalFlowWidthLegend(out, baseX, baseY) {\r\n    if (!out) return null;\r\n    const map = out.map || out;\r\n    if (!map || !map.strokeWidthScale) return null;\r\n\r\n    // remove previous container if any\r\n    if (out._flowWidthContainer) out._flowWidthContainer.remove();\r\n\r\n    //config\r\n    const cfg = out.flowWidthLegend\r\n    out._flowWidthContainer = out.lgg\r\n        .append(\"g\")\r\n        .attr(\"class\", \"em-flow-width-legend-horizontal\")\r\n        .attr(\"transform\", `translate(${baseX}, ${baseY})`);\r\n\r\n    if (cfg.title) {\r\n        out._flowWidthContainer\r\n            .append('text')\r\n            .attr('class', 'em-width-legend-title')\r\n            .text(cfg.title || 'Flow width')\r\n    }\r\n\r\n    // keep same defaults as your notebook\r\n    const x = cfg.x ?? 0;\r\n    const totalWidth = cfg.width || out.width;\r\n    const segments = cfg.segments ?? 5;\r\n    const labelOffset = cfg.labelOffset ?? 12;\r\n    const pad = cfg.pad ?? 0;\r\n\r\n    // baseline inner coordinates (moved *after* values calculation)\r\n    const innerStart = x + pad;\r\n    const innerEnd = x + totalWidth - pad;\r\n    const innerWidth = Math.max(0, innerEnd - innerStart);\r\n\r\n    // sample values (linear interpolation across domain)\r\n    const sampleVals = [];\r\n    const max = out.map.maxFlowCount;\r\n    const min = out.map.minFlowCount;\r\n    for (let i = 0; i < segments +1; i++) {\r\n        const t = segments === 1 ? 0.5 : i / (segments - 1);\r\n        sampleVals.push(min + t * (max - min));\r\n    }\r\n    const values = cfg.values || sampleVals;\r\n\r\n    const n = Math.max(1, values.length - 1);\r\n    const slabWidth = innerWidth / n;\r\n\r\n    // compute stroke widths using the map scale (force visible floor)\r\n    const strokeWidths = values.map((v) => Math.max(0.5, map.strokeWidthScale(v)));\r\n    const maxStroke = Math.max(...strokeWidths);\r\n\r\n    // vertical placement: match previous notebook spacing\r\n    const lineY = map.strokeWidthScale(max) + cfg.titlePadding\r\n\r\n    const texts = out._flowWidthContainer.append(\"g\").attr(\"class\", \"em-flow-legend-texts\");\r\n    const lines = out._flowWidthContainer.append(\"g\").attr(\"class\", \"em-flow-legend-lines\");\r\n\r\n    // baseline (visual guide)\r\n    lines.append(\"line\")\r\n        .attr('class', 'em-flow-legend-baseline')\r\n        .attr(\"x1\", innerStart)\r\n        .attr(\"x2\", innerEnd)\r\n        .attr(\"y1\", lineY)\r\n        .attr(\"y2\", lineY)\r\n        .attr(\"stroke\", \"#eee\")\r\n        .attr(\"stroke-width\", 1);\r\n\r\n    for (let i = 0; i < n; i++) {\r\n        const s = innerStart + i * slabWidth;\r\n        const e = i === n - 1 ? innerEnd : innerStart + (i + 1) * slabWidth;\r\n        const sw = strokeWidths[i];\r\n        const val = values[i];\r\n\r\n        lines.append(\"line\")\r\n            .style(\"stroke-width\", sw)\r\n            .attr(\"x1\", s)\r\n            .attr(\"x2\", e)\r\n            .attr(\"y1\", lineY)\r\n            .attr(\"y2\", lineY)\r\n            .style(\"stroke\", cfg.color ?? \"#000\")\r\n            .style(\"stroke-opacity\", cfg.strokeOpacity ?? 1);\r\n\r\n        // label centered on the slab\r\n        const cx = (s + e) / 2;\r\n        texts.append(\"text\")\r\n            .attr(\"x\", cx)\r\n            .attr(\"y\", lineY - labelOffset)\r\n            .attr(\"dy\", \"-0.35em\")\r\n            .attr(\"class\", \"em-legend-label em-flow-legend-label em-flow-width-horizontal-label\")\r\n            .text(fmt(val));\r\n    }\r\n\r\n    // captions for min/max aligned with baseline ends\r\n    if (!cfg.maxMin) return;\r\n    texts.append(\"text\")\r\n        .attr(\"x\", innerStart)\r\n        .attr(\"y\", lineY + maxStroke + 6)\r\n        .attr(\"class\", \"em-legend-label em-flow-legend-min-label\")\r\n        .attr('dy', '0.5em')\r\n        .text(comma(Math.round(min)));\r\n\r\n    texts.append(\"text\")\r\n        .attr(\"x\", innerEnd)\r\n        .attr(\"y\", lineY + maxStroke + 6)\r\n        .attr(\"class\", \"em-legend-label em-flow-legend-max-label\")\r\n        .attr('dy', '0.5em')\r\n        .text(comma(Math.round(max)));\r\n\r\n}\r\n\r\n\r\nexport function drawVerticalFlowWidthLegend(out, baseX, baseY) {\r\n    const map = out.map\r\n    if (!map.strokeWidthScale) return\r\n    out._flowWidthContainer = out.lgg.append('g').attr('class', 'em-flow-width-legend').attr('transform', `translate(${baseX}, ${baseY})`)\r\n\r\n    //config\r\n    const cfg = out.flowWidthLegend\r\n    const segments = cfg.segments ?? 5;\r\n\r\n    if (cfg.title) {\r\n        out._flowWidthContainer\r\n            .append('text')\r\n            .attr('class', 'em-width-legend-title')\r\n            .text(cfg.title || 'Flow width')\r\n    }\r\n\r\n    // Representative values (min, mid, max or user-defined)\r\n    const sampleVals = [];\r\n    const max = out.map.maxFlowCount\r\n    const min = out.map.minFlowCount\r\n    for (let i = 0; i < segments; i++) {\r\n        const t = segments === 1 ? 0.5 : i / (segments - 1);\r\n        sampleVals.push(min + t * (max - min));\r\n    }\r\n    const values = cfg.values || sampleVals\r\n\r\n    let currentY = cfg.titlePadding || 10\r\n    const padding = 7 // extra spacing between items\r\n    let x = 0\r\n\r\n    const scale = map.strokeWidthScale\r\n    values.forEach((val, i) => {\r\n        const strokeWidth = scale(val)\r\n\r\n        // Space relative to previous line (half previous + half current + padding)\r\n        if (i > 0) {\r\n            const prevStrokeWidth = scale(values[i - 1])\r\n            currentY += prevStrokeWidth / 2 + strokeWidth / i + padding\r\n        }\r\n\r\n        let label = cfg.labelFormatter ? cfg.labelFormatter(val) : spaceAsThousandSeparator(val)\r\n        if (cfg.labels && cfg.labels[i]) label = cfg.labels[i];//manual override\r\n\r\n        out._flowWidthContainer\r\n            .append('line')\r\n            .attr('x1', x)\r\n            .attr('x2', x + 40)\r\n            .attr('y1', currentY)\r\n            .attr('y2', currentY)\r\n            .attr('stroke', cfg.color ? cfg.color : '#6b6b6b')\r\n            .attr('stroke-width', strokeWidth)\r\n\r\n        out._flowWidthContainer\r\n            .append('text')\r\n            .attr('x', x + 50)\r\n            .attr('y', currentY)\r\n            .attr('dy', '0.35em')\r\n            .attr('class', 'em-legend-label')\r\n            .text(label)\r\n    })\r\n}\r\n","import { select, selectAll } from 'd3-selection'\r\n\r\n// explain flow line colors\r\nexport function drawFlowColorLegend(out, x, y) {\r\n    const map = out.map\r\n\r\n    // Create/clear container\r\n    out._flowColorContainer?.remove()\r\n    out._flowColorContainer = out.lgg\r\n        .append('g')\r\n        .attr('class', 'em-flow-color-legend')\r\n        .attr('transform', `translate(${x}, ${y})`)\r\n\r\n    const title = out._flowColorContainer\r\n        .append('text')\r\n        .attr('class', 'em-color-legend-title')\r\n        .attr('id', 'em-color-legend-title')\r\n        .attr('dy', '0.35em')\r\n        .text(out.flowColorLegend.title || 'Destination')\r\n\r\n    let legendItems = [];\r\n    if (typeof map.flowColor_ === 'function') {\r\n        if (out.flowColorLegend.items && out.flowColorLegend.items.length > 0) {\r\n            // allow user-provided items; add key if provided\r\n            legendItems = out.flowColorLegend.items.map(d => ({ label: d.label, color: d.color, key: d.key ?? null }));\r\n        } else {\r\n            legendItems = [{ label: \"please specify legend items ...\", color: \"#888\", key: null }];\r\n        }\r\n    } else {\r\n        // top destinations case\r\n        const colorScale = map.topLocationColorScale;\r\n        const topKeys = Array.from(map.topLocationKeys || []);\r\n        legendItems = topKeys.map(key => ({\r\n            key,                                 // <<< NEW: stable key for matching\r\n            label: map.nodeNameMap.get(key) || key,\r\n            color: colorScale(key),\r\n        }));\r\n        legendItems.push({ key: 'Other', label: 'Other', color: map.flowColor_ });\r\n    }\r\n\r\n    // Draw each legend row\r\n    const titleOffset = title.node().getBBox().height + out.flowColorLegend.titlePadding\r\n\r\n    // Draw legend rows with mouseover\r\n    const itemHeight = 22\r\n    const itemWidth = out.itemHeight || 18\r\n    legendItems.forEach((item, i) => {\r\n        const row = out._flowColorContainer\r\n            .append('g')\r\n            .attr('class', 'em-color-legend-item')\r\n            .attr('transform', `translate(0, ${i * 22 + titleOffset})`)\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function () {\r\n                highlightLines(item.key);\r\n\r\n                // bold text + stroke rect\r\n                select(this).select('text').style('font-weight', 'bold');\r\n                select(this).select('rect').attr('stroke', 'black').attr('stroke-width', 2);\r\n            })\r\n            .on('mouseout', function () {\r\n                unhighlightLines();\r\n\r\n                // reset text + rect\r\n                select(this).select('text').style('font-weight', 'normal');\r\n                select(this).select('rect').attr('stroke', 'none');\r\n            });\r\n\r\n        row.append('rect').attr('width', 18).attr('height', itemHeight).attr('fill', item.color)\r\n\r\n        row.append('text').attr('x', 25).attr('y', 14).attr('class', 'em-legend-label').text(item.label)\r\n    })\r\n}\r\n\r\n\r\nfunction highlightLines(nodeId) {\r\n    if (!nodeId) return;\r\n\r\n    selectAll('.em-flow-link, .em-flow-link-bundled')\r\n        .classed('highlighted', function () {\r\n            //const o = this.getAttribute('data-origin'); \r\n            const d = this.getAttribute('data-dest');\r\n            return  d === nodeId; // destination only here\r\n        })\r\n        .classed('dimmed', function () {\r\n            //const o = this.getAttribute('data-origin');\r\n            const d = this.getAttribute('data-dest');\r\n            return !( d === nodeId);\r\n        });\r\n}\r\n\r\nfunction unhighlightLines() {\r\n    selectAll('.em-flow-link, .em-flow-link-bundled')\r\n        .classed('highlighted', false)\r\n        .classed('dimmed', false);\r\n}","import * as Legend from '../legend'\r\nimport { drawCircleSizeLegend } from '../legend-circle-size'\r\nimport { drawHorizontalFlowWidthLegend, drawVerticalFlowWidthLegend } from './legend-flow-width'\r\nimport { drawFlowColorLegend } from './legend-flow-color'\r\n\r\n/**\r\n * A legend for proportional symbol map\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    out.flowWidthLegend = {\r\n        title: null,\r\n        titlePadding: 17,\r\n        values: null,\r\n        marginTop: 15,\r\n        labelFormatter: undefined, // function to format legend labels\r\n        labels: null, // manual override for legend labels\r\n        color: '#333', // line color\r\n        orientation: 'horizontal', // 'vertical' or 'horizontal'\r\n        segments: 3,\r\n        width: 150,\r\n        maxMin: false,\r\n    }\r\n\r\n    out.nodeSizeLegend = {\r\n        title: null,\r\n        titlePadding: 25,\r\n        values: null,\r\n        labels: null, // manual override for legend labels\r\n        marginTop: 20,\r\n        labelFormatter: undefined, // function to format legend labels\r\n    }\r\n\r\n    out.flowColorLegend = {\r\n        title: null,\r\n        titlePadding: 0, // Padding between title and legend body\r\n        marginTop: 50,\r\n        items: [], // user-defined legend items for custom flow color function,\r\n        ticks: false // use labels as ticks\r\n    }\r\n\r\n    out.regionColorLegend = {\r\n        title: null,\r\n        titlePadding: 15,\r\n        marginTop: 30,\r\n        labels: ['Exporter', 'Importer'],\r\n    }\r\n\r\n    //override attribute values with config values\r\n    if (config)\r\n        for (let key in config) {\r\n            if (\r\n                key == 'colorLegend' ||\r\n                key == 'flowWidthLegend' ||\r\n                key == 'nodeSizeLegend' ||\r\n                key == 'flowColorLegend' ||\r\n                key == 'regionColorLegend'\r\n            ) {\r\n                for (let p in out[key]) {\r\n                    //override each property in size and color legend configs\r\n                    if (config[key][p] !== undefined) {\r\n                        out[key][p] = config[key][p]\r\n                    }\r\n                }\r\n                if (config.colorLegend == false) out.colorLegend = false\r\n            } else {\r\n                out[key] = config[key]\r\n            }\r\n        }\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        const m = out.map\r\n        const lgg = out.lgg\r\n\r\n        // update legend parameters if necessary\r\n        if (m.legend_)\r\n            for (let key in m.legend_) {\r\n                if (\r\n                    key == 'colorLegend' ||\r\n                    key == 'flowWidthLegend' ||\r\n                    key == 'nodeSizeLegend' ||\r\n                    key == 'flowColorLegend' ||\r\n                    key == 'regionColorLegend'\r\n                ) {\r\n                    for (let p in out[key]) {\r\n                        //override each property in size and color legend m.legend_\r\n                        if (m.legend_[key][p] !== undefined) {\r\n                            out[key][p] = m.legend_[key][p]\r\n                        }\r\n                    }\r\n                } else {\r\n                    out[key] = m.legend_[key]\r\n                }\r\n            }\r\n\r\n        //remove previous content\r\n        lgg.selectAll('*').remove()\r\n\r\n        //draw legend background box\r\n        out.makeBackgroundBox()\r\n\r\n        //titles\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        // draw legend elements\r\n        buildFlowLegend(out)\r\n\r\n        //set legend box dimensions\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    /**\r\n     * Builds a legend which illustrates the statistical values of different flow symbol sizes\r\n     *\r\n     */\r\n    function buildFlowLegend(out) {\r\n        const map = out.map\r\n        let baseX = out.getBaseX()\r\n        let baseY = out.getBaseY()\r\n\r\n        // line widths\r\n        if (out.flowWidthLegend) {\r\n            out.flowWidthLegend.orientation == 'vertical' ? drawVerticalFlowWidthLegend(out, baseX, baseY + out.flowWidthLegend.marginTop) : drawHorizontalFlowWidthLegend(out, baseX, baseY + out.flowWidthLegend.marginTop)\r\n        }\r\n\r\n        const flowWidthNode = out._flowWidthContainer.node()\r\n        const flowWidthLegendHeight = flowWidthNode.getBBox().height\r\n\r\n        // node size legend\r\n        if (map.flowNodes_ && map._nodeSizeScale) {\r\n            // node legend container\r\n            out._nodeLegendContainer = out.lgg\r\n                .append('g')\r\n                .attr('class', 'em-node-color-legend')\r\n                .attr('transform', `translate(${baseX}, ${baseY + flowWidthLegendHeight})`)\r\n\r\n            // node size legend\r\n            out._nodeSizeContainer = out._nodeLegendContainer\r\n                .append('g')\r\n                .attr('class', 'em-node-size-legend')\r\n                .attr('transform', `translate(${0}, ${out.nodeSizeLegend.marginTop})`)\r\n\r\n            //draw circle size legend\r\n            drawCircleSizeLegend(\r\n                out,\r\n                out._nodeSizeContainer,\r\n                out.nodeSizeLegend.values,\r\n                map._nodeSizeScale,\r\n                out.nodeSizeLegend.title,\r\n                out.nodeSizeLegend.titlePadding\r\n            )\r\n        }\r\n\r\n        // flow colour legend\r\n        if (out.flowColorLegend && ((map.flowNodes_ && map._nodeSizeScale) || (typeof map.flowColor_ === 'function'))) {\r\n            // flow color legend\r\n            let flowColorLegendYOffset = out.lgg.node().getBBox().height + out.flowColorLegend.marginTop\r\n            drawFlowColorLegend(out, baseX, flowColorLegendYOffset)\r\n        }\r\n\r\n        // region fill colors\r\n        if ((map.importerRegionIds.length > 0 || map.exporterRegionIds.length > 0) && out.regionColorLegend) {\r\n            let regionColorLegendYOffset = out.lgg.node().getBBox().height + out.regionColorLegend.marginTop\r\n            drawRegionColorLegend(out, baseX, regionColorLegendYOffset)\r\n        }\r\n    }\r\n\r\n\r\n\r\n    function drawRegionColorLegend(out, baseX, baseY) {\r\n        // Create/clear container\r\n        out._regionColorContainer?.remove()\r\n        out._regionColorContainer = out.lgg\r\n            .append('g')\r\n            .attr('class', 'em-flow-region-color-legend')\r\n            .attr('transform', `translate(${baseX}, ${baseY})`)\r\n\r\n        const title = out._regionColorContainer\r\n            .append('text')\r\n            .attr('class', 'em-color-legend-title')\r\n            .attr('id', 'em-color-legend-title')\r\n            .attr('dy', '0.35em')\r\n            .text(out.regionColorLegend.title || 'Region fill colors')\r\n\r\n        const map = out.map\r\n        const items = {\r\n            [out.regionColorLegend.labels[0]]: map.flowRegionColors_[0],\r\n            [out.regionColorLegend.labels[1]]: map.flowRegionColors_[1],\r\n        }\r\n        // Draw the legend items\r\n        let x = 0\r\n        let y = out.regionColorLegend.titlePadding\r\n        Object.entries(items).forEach(([label, color], i) => {\r\n            out._regionColorContainer\r\n                .append('rect')\r\n                .attr('x', 0)\r\n                .attr('y', y + i * 20)\r\n                .attr('width', out.shapeWidth)\r\n                .attr('height', out.shapeHeight)\r\n                .attr('fill', color)\r\n\r\n            out._regionColorContainer\r\n                .append('text')\r\n                .attr('x', out.shapeWidth + 5)\r\n                .attr('y', y + i * 20 + 15)\r\n                .attr('class', 'em-legend-label')\r\n                .text(label)\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n\r\n","export default function sum(values, valueof) {\n  let sum = 0;\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        sum += value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        sum += value;\n      }\n    }\n  }\n  return sum;\n}\n","// arrows.js  shared arrow utilities for straight + sankey\r\n\r\nimport { select } from \"d3-selection\";\r\n\r\nconst uid = (prefix = \"arrow\") => `${prefix}-${Math.random().toString(36).slice(2)}`;\r\n\r\n/**\r\n * Ensure <defs> exists on the given SVG root/selection.\r\n * @param {d3.Selection} svgRoot\r\n */\r\nexport function ensureDefs(svgRoot) {\r\n    let defs = svgRoot.select(\"defs\");\r\n    if (defs.empty()) defs = svgRoot.append(\"defs\");\r\n    return defs;\r\n}\r\n\r\n/**\r\n * Create (once) a trio of arrow markers: normal, hover, outline.\r\n * Returns their IDs. If they already exist, just returns the same IDs.\r\n *\r\n * @param {d3.Selection} svgRoot - your <svg> selection (or top container that can host <defs>)\r\n * @param {Object} opts\r\n * @param {string} [opts.cacheKey=\"default\"] - so straight/sankey can keep separate sets if desired\r\n * @param {number} [opts.scale=1] - multiplies the marker geometry\r\n * @param {string} [opts.markerUnits=\"strokeWidth\"] - \"strokeWidth\" to scale with line width, or \"userSpaceOnUse\"\r\n * @param {string} [opts.hoverColor=\"black\"]\r\n * @param {string} [opts.outlineColor=\"#ffffff\"]\r\n * @param {string} [opts.idBase] - stable base, otherwise generated\r\n * @param {boolean} [opts.useContextStroke=true] - if true, marker fill = \"context-stroke\"\r\n */\r\nexport function ensureArrowMarkers(svgRoot, opts = {}) {\r\n    const {\r\n        cacheKey = \"default\",\r\n        scale = 1,\r\n        markerUnits = \"strokeWidth\",\r\n        hoverColor = \"black\",\r\n        outlineColor = \"#ffffff\",\r\n        idBase = uid(\"arrow\"),\r\n        useContextStroke = true,\r\n    } = opts;\r\n\r\n    // stash on the svg node so both renderers can reuse\r\n    const node = svgRoot.node();\r\n    node._arrowCache ||= new Map();\r\n    if (node._arrowCache.has(cacheKey)) return node._arrowCache.get(cacheKey);\r\n\r\n    const defs = ensureDefs(svgRoot);\r\n\r\n    const ids = {\r\n        normal: `${idBase}`,\r\n        hover: `${idBase}-hover`,\r\n        outline: `${idBase}-outline`,\r\n    };\r\n\r\n    // create if missing\r\n    if (defs.select(`#${ids.normal}`).empty()) {\r\n        createMarker(defs, ids.normal, {\r\n            markerUnits,\r\n            scale,\r\n            fill: useContextStroke ? \"context-stroke\" : hoverColor,\r\n            out: opts.out,                 //  add this\r\n        });\r\n    }\r\n    if (defs.select(`#${ids.hover}`).empty()) {\r\n        createMarker(defs, ids.hover, {\r\n            markerUnits,\r\n            scale,\r\n            fill: hoverColor,\r\n            out: opts.out,\r\n        });\r\n    }\r\n    if (defs.select(`#${ids.outline}`).empty()) {\r\n        createMarker(defs, ids.outline, {\r\n            markerUnits,\r\n            scale,\r\n            fill: opts.out?.flowOutlineColor_ || outlineColor,\r\n            out: opts.out,\r\n        });\r\n    }\r\n\r\n    node._arrowCache.set(cacheKey, ids);\r\n    return ids;\r\n}\r\n\r\n/**\r\n * Apply a marker-end to a selection (e.g., your line/path).\r\n * Pass ids from ensureArrowMarkers and one of \"normal\" | \"hover\" | \"outline\".\r\n */\r\nexport function applyArrow(selection, ids, variant = \"normal\") {\r\n    if (!ids) return selection;\r\n    const id = ids[variant];\r\n    return selection.attr(\"marker-end\", id ? `url(#${id})` : null);\r\n}\r\n\r\n/**\r\n * Convenience helpers for hover swapping.\r\n */\r\nexport function setHoverArrow(selection, ids, on) {\r\n    return applyArrow(selection, ids, on ? \"hover\" : \"normal\");\r\n}\r\n\r\n/**\r\n * Internal: create a compact, rounded arrow head.\r\n * You can tweak geometry here and itll propagate everywhere.\r\n */\r\nfunction createMarker(defs, id, {\r\n  markerUnits = \"strokeWidth\",\r\n  scale = 1,\r\n  fill = \"context-stroke\",\r\n}) {\r\n  const VB = 10, PAD = 0.1;\r\n  const TIP_X = VB - PAD, MID_Y = VB / 2;\r\n  const size = 3.0 * scale;\r\n\r\n  const m = defs.append(\"marker\")\r\n    .attr(\"id\", id)\r\n    .attr(\"markerUnits\", markerUnits)       // scales with line/outline width\r\n    .attr(\"markerWidth\", size)\r\n    .attr(\"markerHeight\", size)\r\n    .attr(\"viewBox\", `0 0 ${VB} ${VB}`)\r\n    .attr(\"refX\", TIP_X)                    // tip exactly at line end\r\n    .attr(\"refY\", MID_Y)\r\n    .attr(\"orient\", \"auto\");\r\n\r\n  // single filled arrow; outline comes from the *outline line*'s own marker\r\n  m.append(\"path\")\r\n    .attr(\"fill\", fill)\r\n    .attr(\"d\", `M0,0 L${TIP_X},${MID_Y} L0,${VB} L${VB*0.22},${MID_Y} Z`);\r\n}\r\n\r\n\r\n\r\n","// flow-bidirectional.js\r\n// Shared helpers for bidirectional flow aggregation.\r\n\r\n/**\r\n * Build a bidirectional route map:\r\n *   key = unordered \"A|B\"\r\n *   route = {\r\n *      idA, idB,\r\n *      nodeA, nodeB,\r\n *      coordsA: [xA, yA],\r\n *      coordsB: [xB, yB],\r\n *      flowAB, flowBA\r\n *   }\r\n */\r\nexport function buildBidirectionalRouteMap(nodes, links) {\r\n    const nodeById = new Map(nodes.map((n) => [n.id, n]));\r\n    const routeMap = new Map();\r\n\r\n    for (const link of links) {\r\n        const sourceId = typeof link.source === 'object' ? link.source.id : link.source;\r\n        const targetId = typeof link.target === 'object' ? link.target.id : link.target;\r\n\r\n        const sourceNode = nodeById.get(sourceId);\r\n        const targetNode = nodeById.get(targetId);\r\n        if (!sourceNode || !targetNode) continue;\r\n\r\n        const key = sourceId < targetId ? `${sourceId}|${targetId}` : `${targetId}|${sourceId}`;\r\n\r\n        if (!routeMap.has(key)) {\r\n            const nodeA = sourceId < targetId ? sourceNode : targetNode;\r\n            const nodeB = sourceId < targetId ? targetNode : sourceNode;\r\n\r\n            routeMap.set(key, {\r\n                key,\r\n                idA: nodeA.id,\r\n                idB: nodeB.id,\r\n                nodeA,\r\n                nodeB,\r\n                coordsA: [nodeA.x, nodeA.y],\r\n                coordsB: [nodeB.x, nodeB.y],\r\n                flowAB: 0,\r\n                flowBA: 0,\r\n                // NEW: keep a representative link for each direction\r\n                sampleAB: null,\r\n                sampleBA: null,\r\n            });\r\n        }\r\n\r\n        const route = routeMap.get(key);\r\n        const v = +link.value || 0;\r\n\r\n        if (sourceId === route.idA && targetId === route.idB) {\r\n            route.flowAB += v;\r\n            if (!route.sampleAB) route.sampleAB = link;\r\n        } else {\r\n            route.flowBA += v;\r\n            if (!route.sampleBA) route.sampleBA = link;\r\n        }\r\n    }\r\n\r\n    return routeMap;\r\n}\r\n\r\n/**\r\n * For sankey.js:\r\n *  - One-way route: keep a normal link AB or BA.\r\n *  - Two-way route: create a hidden midpoint node M and two half-links:\r\n *        M  B  (value = AB)\r\n *        M  A  (value = BA)\r\n *    so visually you get two half-ribbons meeting in the middle.\r\n */\r\nexport function expandRoutesToSankeyMidpointGraph(nodes, links) {\r\n    const routeMap = buildBidirectionalRouteMap(nodes, links);\r\n    const nodeById = new Map(nodes.map((n) => [n.id, n]));\r\n\r\n    const newNodes = nodes.map((n) => ({ ...n }));\r\n    const newLinks = [];\r\n    let midIndex = 0;\r\n\r\n    for (const route of routeMap.values()) {\r\n        const { idA, idB, coordsA, coordsB, flowAB, flowBA, sampleAB, sampleBA } = route;\r\n        const nodeA = nodeById.get(idA);\r\n        const nodeB = nodeById.get(idB);\r\n        if (!nodeA || !nodeB) continue;\r\n\r\n        // helper: shallow-copy extras from a sample link\r\n        const extraAB = sampleAB ? { ...sampleAB } : {};\r\n        const extraBA = sampleBA ? { ...sampleBA } : {};\r\n        // remove structural bits were going to overwrite\r\n        delete extraAB.source; delete extraAB.target; delete extraAB.value;\r\n        delete extraBA.source; delete extraBA.target; delete extraBA.value;\r\n\r\n        if (flowAB > 0 && flowBA > 0) {\r\n            const midId = `__mid__${idA}__${idB}__${midIndex++}`;\r\n            const midNode = {\r\n                id: midId,\r\n                x: (coordsA[0] + coordsB[0]) / 2,\r\n                y: (coordsA[1] + coordsB[1]) / 2,\r\n                isMidpoint: true,\r\n            };\r\n            newNodes.push(midNode);\r\n\r\n            // AB half (midpoint -> B)\r\n            newLinks.push({\r\n                ...extraAB,\r\n                source: midId,\r\n                target: idB,\r\n                value: flowAB,\r\n                route,\r\n                originId: idA,\r\n                destId: idB,\r\n                dir: 'AtoB',\r\n            });\r\n\r\n            // BA half (midpoint -> A)\r\n            newLinks.push({\r\n                ...extraBA,\r\n                source: midId,\r\n                target: idA,\r\n                value: flowBA,\r\n                route,\r\n                originId: idB,\r\n                destId: idA,\r\n                dir: 'BtoA',\r\n            });\r\n        } else if (flowAB > 0) {\r\n            newLinks.push({\r\n                ...extraAB,\r\n                source: idA,\r\n                target: idB,\r\n                value: flowAB,\r\n                route,\r\n                originId: idA,\r\n                destId: idB,\r\n                dir: 'AtoB',\r\n            });\r\n        } else if (flowBA > 0) {\r\n            newLinks.push({\r\n                ...extraBA,\r\n                source: idB,\r\n                target: idA,\r\n                value: flowBA,\r\n                route,\r\n                originId: idB,\r\n                destId: idA,\r\n                dir: 'BtoA',\r\n            });\r\n        }\r\n    }\r\n\r\n    return { nodes: newNodes, links: newLinks };\r\n}\r\n\r\n","import { generateUniqueId } from '../../core/utils'\r\nimport { sum } from 'd3-array'\r\nimport { select } from 'd3-selection'\r\nimport { ensureArrowMarkers, applyArrow, setHoverArrow } from './arrows.js';\r\nimport { expandRoutesToSankeyMidpointGraph } from './flow-bidirectional.js';\r\n\r\n// spatial sankey. Adopted from this notebook: https://observablehq.com/@bayre/deconstructed-sankey-diagram\r\n// See https://observablehq.com/@joewdavies/flow-map-of-europe\r\n\r\n/**\r\n     * Function to create a map with Sankey diagram and other elements\r\n     * exampleGraph = {\r\n                nodes: [\r\n                    { id: 'FR', x: 681.1851800759263, y: 230.31124763648583 },\r\n                    { id: 'DE', x: 824.5437782154489, y: 123.70302649032199 },\r\n                ],\r\n                links: [\r\n                    { source: 'FR', target: 'DE', value: 82018369.72 },\r\n                ],\r\n            }\r\n     */\r\n\r\nexport function createSankeyFlowMap(out, sankeyContainer) {\r\n    const svg = out.svg_;\r\n    const baseGraph = out.flowGraph_;\r\n    const usesGradient = out.flowColorGradient_ || out.flowOpacityGradient_;\r\n\r\n    // Needed by the colour helpers (same pattern as straight.js)\r\n    out._nodeById = out._nodeById || new Map(baseGraph.nodes.map(n => [n.id, n]));\r\n\r\n    // 1) Build a derived graph where bi-directional flows are split into two half-links.\r\n    const sankeyInput = expandRoutesToSankeyMidpointGraph(baseGraph.nodes, baseGraph.links);\r\n\r\n    // 2) Run the spatial-sankey layout on that derived graph\r\n    const { nodes, links } = sankey(out, sankeyInput);\r\n\r\n    // shared markers (normal/hover/outline)\r\n    const arrowIds = out.flowArrows_\r\n        ? ensureArrowMarkers(svg, {\r\n            cacheKey: 'sankey',\r\n            scale: out.flowArrowScale_ || 1,\r\n            markerUnits: 'strokeWidth',\r\n            hoverColor: out.hoverColor_ || 'black',\r\n            outlineColor: out.flowOutlineColor_ || '#ffffff',\r\n            useContextStroke: true,\r\n        })\r\n        : null;\r\n\r\n    // gradients\r\n    const defs = svg.select('defs').empty() ? svg.append('defs') : svg.select('defs');\r\n    const gradientIds = links.map(() => generateUniqueId('gradient'));\r\n    if (usesGradient) addFlowGradients(out, defs, gradientIds, links);\r\n\r\n    // Add Sankey flows\r\n    addSankeyFlows(out, sankeyContainer, nodes, links, arrowIds, gradientIds);\r\n\r\n    // Add lines at nodes (stems)  skip synthetic midpoints\r\n    addNodeStems(out, sankeyContainer, nodes);\r\n\r\n    return svg.node();\r\n}\r\n\r\n/**\r\n * Adds linear gradient definitions for flow links\r\n */\r\nfunction addFlowGradients(out, defs, gradientIds, links) {\r\n    // one gradient per link (keep indices aligned with `links`)\r\n    defs.selectAll('linearGradient')\r\n        .data(links)\r\n        .join('linearGradient')\r\n        .attr('id', (_, i) => gradientIds[i])\r\n        .attr('gradientUnits', 'userSpaceOnUse')\r\n        .attr('x1', d => d?.source?.x1 ?? d?.target?.x0 ?? 0)\r\n        .attr('x2', d => d?.target?.x0 ?? d?.source?.x1 ?? 0)\r\n        .attr('y1', d => d?.y0 ?? d?.y1 ?? 0)\r\n        .attr('y2', d => d?.y1 ?? d?.y0 ?? 0)\r\n        .each(function (d) {\r\n            const g = select(this);\r\n            g.selectAll('stop').remove();\r\n\r\n            // Colors: if color gradient is ON, blend from region color  flow color.\r\n            // Otherwise keep a flat color (whatever getFlowStroke returns).\r\n            const startColor = out.flowColorGradient_\r\n                ? (out.flowRegionColors_?.[0] ?? getFlowStroke(out, d))\r\n                : getFlowStroke(out, d);\r\n\r\n            const endColor = out.flowColorGradient_\r\n                ? (typeof out.flowColor_ === 'function' ? out.flowColor_(d) : out.flowColor_)\r\n                : getFlowStroke(out, d);\r\n\r\n            // Opacity: if opacity gradient is ON, start at 0  1; else keep at 1.\r\n            const startOpacity = out.flowOpacityGradient_ ? 0 : 1;\r\n            const endOpacity = 1;\r\n\r\n            g.append('stop')\r\n                .attr('offset', '0%')\r\n                .attr('stop-color', startColor)\r\n                .attr('stop-opacity', startOpacity);\r\n\r\n            g.append('stop')\r\n                .attr('offset', '100%')\r\n                .attr('stop-color', endColor)\r\n                .attr('stop-opacity', endOpacity);\r\n        });\r\n}\r\n\r\nfunction cloneGraph({ nodes, links }) {\r\n    return {\r\n        nodes: nodes.map((d) => ({ ...d })),\r\n        links: links.map((d) => ({ ...d })),\r\n    };\r\n}\r\n\r\nfunction initGraphLinks(graph) {\r\n    const { nodes, links } = graph;\r\n    const id = (d) => d.id;\r\n\r\n    // Reset per-node arrays\r\n    for (const [i, node] of nodes.entries()) {\r\n        node.index = i;\r\n        node.sourceLinks = [];\r\n        node.targetLinks = [];\r\n    }\r\n\r\n    const nodeById = new Map(nodes.map((d, i) => [id(d, i, nodes), d]));\r\n\r\n    // Attach link.source / link.target as node objects & fill sourceLinks/targetLinks\r\n    for (const [i, link] of links.entries()) {\r\n        link.index = i;\r\n        let { source, target } = link;\r\n\r\n        if (typeof source !== 'object') source = link.source = nodeById.get(source);\r\n        if (typeof target !== 'object') target = link.target = nodeById.get(target);\r\n        if (!source || !target) continue;\r\n\r\n        source.sourceLinks.push(link);\r\n        target.targetLinks.push(link);\r\n    }\r\n}\r\n\r\nfunction sankey(out, baseGraph) {\r\n    const graph = cloneGraph(baseGraph);\r\n    initGraphLinks(graph);\r\n\r\n    computeNodeValues(graph);\r\n    computeNodeDepths(graph);\r\n    computeNodeHeights(graph);\r\n    computeNodeBreadths(out, graph);\r\n    computeLinkBreadths(out, graph);\r\n\r\n    //  fix midpoint Y so split flows meet at the true midpoint, not its location on the stem\r\n    adjustMidpointNodes(graph);\r\n\r\n    return graph;\r\n}\r\n\r\nfunction addSankeyFlows(out, container, nodes, links, arrowIds, gradientIds) {\r\n    const usesGradient = out.flowColorGradient_ || out.flowOpacityGradient_;\r\n    const flowsGroup = buildFlowsGroup(container, out);\r\n    const baseCurvSettings = out.flowCurvatureSettings_ || {};\r\n    const baseCurv = baseCurvSettings.curvature ?? 0.5;\r\n\r\n    const linkPath = sankeyLinkAvoidingNodes(nodes, {\r\n        ...baseCurvSettings,\r\n        curvature: typeof baseCurvSettings.curvature === 'function'\r\n            ? baseCurvSettings.curvature\r\n            : (link) => {\r\n                const isHalf = link.source && link.source.isMidpoint;\r\n                return isHalf ? baseCurv * 0.5 : baseCurv;\r\n            }\r\n    });\r\n\r\n    links.forEach((link, i) => {\r\n        const dCenter = linkPath(link);\r\n        const colorKey = computeColorKey(out, link);\r\n\r\n        //  always compute a solid base color for matching\r\n        const baseColor = getFlowStroke(out, link);\r\n\r\n        // What we actually paint with: either gradient or solid\r\n        const paint = usesGradient ? `url(#${gradientIds[i]})` : baseColor;\r\n\r\n        // Outline behind the main symbol (only for simple stroke variant)\r\n        if (out.flowOutlines_ && !out.flowWidthGradient_) {\r\n            buildOutlinePath(out, flowsGroup, dCenter, link, arrowIds);\r\n        }\r\n\r\n        // Main symbol\r\n        const mainSel = out.flowWidthGradient_\r\n            ? buildTaperedMain(out, flowsGroup, dCenter, link, paint, colorKey, baseColor)\r\n            : buildSimpleMain(out, flowsGroup, dCenter, link, paint, colorKey, arrowIds, baseColor);\r\n\r\n        // Mouse/tooltip/arrow hover\r\n        addMouseEvents(out, mainSel, {\r\n            usesGradient,\r\n            paint,       // paint to restore on mouseout\r\n            link,\r\n            arrowIds\r\n        });\r\n    });\r\n}\r\n\r\n/* ----------------- helpers ----------------- */\r\n\r\nfunction buildFlowsGroup(container, out) {\r\n    return container.append('g')\r\n        .attr('class', 'em-flow-lines')\r\n        .attr('id', 'em-flow-lines')\r\n        .style('opacity', out.flowOpacity_);\r\n}\r\n\r\nfunction computeColorKey(out, link) {\r\n    // Stable key used by legend hover\r\n    if (out.topLocationKeys && out.topLocationKeys.has?.(link?.target?.id)) return link.target.id;\r\n    return link?.target?.id ?? link?.source?.id ?? 'Other';\r\n}\r\n\r\nfunction getBackoffAndDash(out, strokePx, dCenter) {\r\n    const backoff = out.flowArrows_ ? arrowBackoffPxForStroke(strokePx, out.flowArrowScale_) : 0;\r\n    const [dashVis, dashGap] = pathDashForBackoff(dCenter, backoff);\r\n    return { backoff, dashVis, dashGap };\r\n}\r\n\r\nfunction buildOutlinePath(out, flowsGroup, dCenter, link, arrowIds) {\r\n    const outlineW = link.width + out.flowOutlineWidth_;\r\n    const { dashVis, dashGap } = getBackoffAndDash(out, outlineW, dCenter);\r\n\r\n    const outline = flowsGroup.append('path')\r\n        .attr('d', dCenter)\r\n        .attr('fill', 'none')\r\n        .attr('class', 'em-flow-link-outline')\r\n        .attr('stroke', out.flowOutlineColor_)\r\n        .attr('stroke-width', outlineW)\r\n        .attr('stroke-dasharray', out.flowArrows_ ? `${dashVis} ${dashGap}` : null)\r\n        .style('pointer-events', 'none');\r\n\r\n    if (out.flowArrows_) applyArrow(outline, arrowIds, 'outline');\r\n    return outline;\r\n}\r\n\r\nfunction buildTaperedMain(out, flowsGroup, dCenter, link, paint, colorKey, baseColor) {\r\n    // Build the tapered polygon...\r\n    const dPoly = taperedPolygonForLink(\r\n        link, () => dCenter,\r\n        {\r\n            startRatio: out.flowWidthGradientSettings_.startRatio,\r\n            samples: out.flowWidthGradientSettings_.samples,\r\n            minStartWidth: out.flowWidthGradientSettings_.minStartWidth,\r\n            capEnd: out.flowArrows_,\r\n        },\r\n        0\r\n    );\r\n\r\n    if (out.flowOutlines_) {\r\n        const dPolyOutline = taperedPolygonForLink(\r\n            link, () => dCenter,\r\n            {\r\n                startRatio: out.flowWidthGradientSettings_.startRatio,\r\n                samples: out.flowWidthGradientSettings_.samples,\r\n                minStartWidth: out.flowWidthGradientSettings_.minStartWidth,\r\n                capEnd: out.flowArrows_,\r\n            },\r\n            out.flowOutlineWidth_\r\n        );\r\n        flowsGroup.append('path')\r\n            .attr('d', dPolyOutline)\r\n            .attr('fill', out.flowOutlineColor_)\r\n            .attr('class', 'em-flow-link-outline');\r\n    }\r\n\r\n    const mainSel = flowsGroup.append('path')\r\n        .attr('d', dPoly)\r\n        .attr('fill', paint)\r\n        .attr('class', 'em-flow-link em-flow-link-tapered')\r\n        .attr('data-color-key', colorKey)\r\n        //  always the solid base color, never the gradient URL\r\n        .attr('data-color', baseColor);\r\n\r\n    return mainSel;\r\n}\r\n\r\nfunction buildSimpleMain(out, flowsGroup, dCenter, link, paint, colorKey, arrowIds, baseColor) {\r\n    const { dashVis, dashGap } = getBackoffAndDash(out, link.width, dCenter);\r\n\r\n    const mainSel = flowsGroup.append('path')\r\n        .attr('d', dCenter)\r\n        .attr('fill', 'none')\r\n        .attr('class', 'em-flow-link')\r\n        .attr('stroke', paint)\r\n        .attr('stroke-width', link.width)\r\n        .attr('stroke-linecap', 'butt')\r\n        .attr('stroke-dasharray', out.flowArrows_ ? `${dashVis} ${dashGap}` : null)\r\n        .attr('data-color-key', colorKey)\r\n        //  again: always the solid base color\r\n        .attr('data-color', baseColor);\r\n\r\n    if (out.flowArrows_) applyArrow(mainSel, arrowIds, 'normal');\r\n    return mainSel;\r\n}\r\n\r\nfunction addMouseEvents(out, mainSel, ctx) {\r\n    const { usesGradient, paint, link, arrowIds } = ctx;\r\n\r\n    mainSel\r\n        .on('mouseover', function () {\r\n            if (out.flowWidthGradient_) {\r\n                // Tapered uses fill\r\n                select(this).attr('fill', out.hoverColor_);\r\n            } else {\r\n                // Simple uses stroke\r\n                select(this).attr('stroke', out.hoverColor_);\r\n                if (out.flowArrows_) setHoverArrow(select(this), arrowIds, true);\r\n            }\r\n            if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(link, out));\r\n        })\r\n        .on('mousemove', e => {\r\n            if (out._tooltip) out._tooltip.mousemove(e);\r\n        })\r\n        .on('mouseout', function () {\r\n            if (out.flowWidthGradient_) {\r\n                select(this).attr('fill', paint);   // restore polygon fill\r\n            } else {\r\n                select(this).attr('stroke', paint); // restore stroke\r\n                if (out.flowArrows_) setHoverArrow(select(this), arrowIds, false);\r\n            }\r\n            if (out._tooltip) out._tooltip.mouseout();\r\n        });\r\n}\r\n\r\n// Sample an SVG path string into points using DOM path length\r\nfunction samplePathByLength(d, samples = 48) {\r\n    const tmp = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n    tmp.setAttribute('d', d);\r\n    const L = tmp.getTotalLength();\r\n    const pts = [];\r\n    for (let i = 0; i <= samples; i++) {\r\n        const p = tmp.getPointAtLength((L * i) / samples);\r\n        pts.push([p.x, p.y]);\r\n    }\r\n    return pts;\r\n}\r\n\r\n// Build a tapered polygon by offsetting along normals of the centerline.\r\n// `extraPad` makes the polygon uniformly thicker (used for outlines).\r\nfunction taperedPolygonForLink(\r\n    link,\r\n    pathFn,\r\n    {\r\n        startRatio = 0.25,\r\n        samples = 48,\r\n        minStartWidth = 1.5,\r\n        capEnd = !out.flowArrows_\r\n    } = {},\r\n    extraPad = 0 // for outlines\r\n) {\r\n    const center = samplePathByLength(pathFn(link), samples);\r\n\r\n    // tangents  unit normals\r\n    const normals = [];\r\n    for (let i = 0; i < center.length; i++) {\r\n        const a = center[Math.max(0, i - 1)];\r\n        const b = center[Math.min(center.length - 1, i + 1)];\r\n        const dx = b[0] - a[0], dy = b[1] - a[1];\r\n        const len = Math.hypot(dx, dy) || 1;\r\n        normals.push([-dy / len, dx / len]);\r\n    }\r\n\r\n    const wStart = Math.max(minStartWidth, link.width * startRatio);\r\n    const wEnd = link.width;\r\n\r\n    const top = [], bot = [];\r\n    const n = center.length - 1;\r\n\r\n    for (let i = 0; i <= n; i++) {\r\n        const t = i / n;\r\n        const width = wStart + (wEnd - wStart) * t;\r\n        const half = width / 2 + extraPad;  // <<< apply pad here\r\n        const nx = normals[i][0] * half;\r\n        const ny = normals[i][1] * half;\r\n        top.push([center[i][0] + nx, center[i][1] + ny]);\r\n        bot.push([center[i][0] - nx, center[i][1] - ny]);\r\n    }\r\n    bot.reverse();\r\n\r\n    // Optional: flatten tail instead of a point\r\n    if (capEnd) {\r\n        top[n][1] = bot[0][1] = (top[n][1] + bot[0][1]) / 2;\r\n    }\r\n\r\n    let d = `M${top[0][0]},${top[0][1]}`;\r\n    for (let i = 1; i < top.length; i++) d += `L${top[i][0]},${top[i][1]}`;\r\n    for (let i = 0; i < bot.length; i++) d += `L${bot[i][0]},${bot[i][1]}`;\r\n    d += 'Z';\r\n    return d;\r\n}\r\n\r\n\r\nfunction getFlowStroke(out, link) {\r\n    const fallback = typeof out.flowColor_ === 'string' ? out.flowColor_ : '#999999';\r\n\r\n    // Let the users flowColor function have first say, with the REAL link\r\n    if (typeof out.flowColor_ === 'function') {\r\n        try {\r\n            const c = out.flowColor_(link);\r\n            if (c != null) return c;\r\n        } catch (e) {\r\n            // swallow and fall back to top-N / default\r\n            console.log('flowColor_ threw in sankey getFlowStroke:', e);\r\n        }\r\n    }\r\n\r\n    // Then our \"top N\" logic, using origin/destination IDs\r\n    const originId =\r\n        link.originId ??\r\n        (typeof link.source === 'object' ? link.source.id : link.source);\r\n\r\n    const destId =\r\n        link.destId ??\r\n        (typeof link.target === 'object' ? link.target.id : link.target);\r\n\r\n    return colorByTopN(out, originId, destId, fallback);\r\n}\r\n\r\n// Copied from straight.js so \"top N\" behaves identically\r\nfunction colorByTopN(out, originId, destId, fallback) {\r\n    if (!out.topLocationKeys || !out.flowTopLocations_ || !out.flowNodes_) return fallback;\r\n\r\n    const type = out.flowTopLocationsType_ || 'sum';\r\n\r\n    if (type === 'origin') {\r\n        return out.topLocationKeys.has(originId)\r\n            ? out.topLocationColorScale(originId)\r\n            : fallback;\r\n    }\r\n\r\n    if (type === 'destination') {\r\n        return out.topLocationKeys.has(destId)\r\n            ? out.topLocationColorScale(destId)\r\n            : fallback;\r\n    }\r\n\r\n    // default: 'sum' / mixed  prefer destination if in top list, else origin\r\n    return out.topLocationKeys.has(destId)\r\n        ? out.topLocationColorScale(destId)\r\n        : (out.topLocationKeys.has(originId)\r\n            ? out.topLocationColorScale(originId)\r\n            : fallback);\r\n}\r\n\r\n/**\r\n * Adds rectangles (lines) for node stems\r\n * @param {Object} container - D3 selection of SVG\r\n * @param {Array} nodes - Sankey nodes data\r\n */\r\nfunction addNodeStems(out, container, nodes) {\r\n    const visibleNodes = nodes.filter((d) => !d.isMidpoint); //  skip synthetic midpoints\r\n\r\n    container\r\n        .append('g')\r\n        .attr('class', 'em-flow-node-stems')\r\n        .selectAll('rect')\r\n        .data(visibleNodes, (d) => d.id)\r\n        .join('rect')\r\n        .attr('x', (d) => d.x0 - 0.5)\r\n        .attr('y', (d) => (out.flowStack_ ? d.y0 : d.y))\r\n        .attr('width', 1)\r\n        .attr('height', (d) => (out.flowStack_ ? Math.max(0, d.y1 - d.y0) : 0))\r\n        .attr('fill', '#000');\r\n}\r\n\r\nfunction computeNodeDepths({ nodes }) {\r\n    const n = nodes.length\r\n    let current = new Set(nodes)\r\n    let next = new Set()\r\n    let x = 0\r\n    while (current.size) {\r\n        for (const node of current) {\r\n            node.depth = x\r\n            for (const { target } of node.sourceLinks) {\r\n                next.add(target)\r\n            }\r\n        }\r\n        if (++x > n) {\r\n            console.log('Detected circular link(s); continuing layout.');\r\n            break; // Dont throw, just stop further propagation\r\n        }\r\n        current = next\r\n        next = new Set()\r\n    }\r\n}\r\n\r\nfunction computeNodeHeights({ nodes }) {\r\n    const visited = new Set();\r\n    const stack = [];\r\n\r\n    // Helper: recursive traversal with circular protection\r\n    function visit(node, depth = 0) {\r\n        if (visited.has(node)) return node.height ?? 0; // already computed\r\n        visited.add(node);\r\n        stack.push(node);\r\n\r\n        // Determine height from the deepest incoming chain\r\n        let maxHeight = 0;\r\n        for (const { source } of node.targetLinks) {\r\n            if (stack.includes(source)) {\r\n                // Circular reference detected  stop recursion, don't loop forever\r\n                console.log(`Circular link detected between ${source.id} and ${node.id}`);\r\n                continue;\r\n            }\r\n            const h = visit(source, depth + 1);\r\n            if (h + 1 > maxHeight) maxHeight = h + 1;\r\n        }\r\n\r\n        node.height = maxHeight;\r\n        stack.pop();\r\n        return maxHeight;\r\n    }\r\n\r\n    // Run the traversal for all nodes\r\n    for (const node of nodes) visit(node);\r\n\r\n    // Normalize heights so the smallest is 0\r\n    const minH = Math.min(...nodes.map(n => n.height ?? 0));\r\n    for (const node of nodes) node.height = (node.height ?? 0) - minH;\r\n}\r\n\r\n\r\nfunction computeNodeBreadths(out, { nodes }) {\r\n    for (const node of nodes) {\r\n        // Compute link widths\r\n        node.sourceLinks.forEach((link) => (link.width = out.strokeWidthScale(link.value)))\r\n        node.targetLinks.forEach((link) => (link.width = out.strokeWidthScale(link.value)))\r\n\r\n        // Use total space needed by links\r\n        const totalLinkWidth = Math.max(\r\n            sum(node.sourceLinks, (d) => d.width),\r\n            sum(node.targetLinks, (d) => d.width)\r\n        )\r\n\r\n        node.x0 = node.x1 = node.x\r\n        node.y0 = node.y - totalLinkWidth / 2\r\n        node.y1 = node.y + totalLinkWidth / 2\r\n    }\r\n\r\n    reorderLinks(nodes)\r\n}\r\n\r\nfunction computeLinkBreadths(out, { nodes }) {\r\n    for (const node of nodes) {\r\n        const mid = node.y;\r\n\r\n        //  Special case: synthetic midpoints for split flows\r\n        // All links should meet exactly at node.y, not be stacked.\r\n        if (node.isMidpoint) {\r\n            for (const l of node.sourceLinks) l.y0 = mid;\r\n            for (const l of node.targetLinks) l.y1 = mid;\r\n            node.y0 = mid;\r\n            node.y1 = mid;\r\n            continue;\r\n        }\r\n\r\n        // Collapse mode: both ends meet at the node center\r\n        if (!out.flowStack_) {\r\n            for (const l of node.sourceLinks) l.y0 = mid;\r\n            for (const l of node.targetLinks) l.y1 = mid;\r\n            node.y0 = mid;\r\n            node.y1 = mid;\r\n            continue;\r\n        }\r\n\r\n        // --- STACK MODE: two independent stacks, one per side of the node ---\r\n        const left = [];\r\n        const right = [];\r\n\r\n        // Outgoing links (this node is the source)\r\n        for (const l of node.sourceLinks) {\r\n            const other = l.target;\r\n            const item = { link: l, width: l.width, otherY: other.y, at: \"out\" };\r\n            (other.x < node.x ? left : right).push(item);\r\n        }\r\n\r\n        // Incoming links (this node is the target)\r\n        for (const l of node.targetLinks) {\r\n            const other = l.source;\r\n            const item = { link: l, width: l.width, otherY: other.y, at: \"in\" };\r\n            (other.x < node.x ? left : right).push(item);\r\n        }\r\n\r\n        const totalLeft = left.reduce((s, d) => s + d.width, 0);\r\n        const totalRight = right.reduce((s, d) => s + d.width, 0);\r\n\r\n        left.sort(out.flowOrder_);\r\n        right.sort(out.flowOrder_);\r\n\r\n        let yL = mid - totalLeft / 2;\r\n        for (const d of left) {\r\n            const yMid = yL + d.width / 2;\r\n            if (d.at === \"out\") d.link.y0 = yMid; else d.link.y1 = yMid;\r\n            yL += d.width;\r\n        }\r\n\r\n        let yR = mid - totalRight / 2;\r\n        for (const d of right) {\r\n            const yMid = yR + d.width / 2;\r\n            if (d.at === \"out\") d.link.y0 = yMid; else d.link.y1 = yMid;\r\n            yR += d.width;\r\n        }\r\n\r\n        const span = Math.max(totalLeft, totalRight);\r\n        node.y0 = mid - span / 2;\r\n        node.y1 = mid + span / 2;\r\n    }\r\n}\r\n\r\n// After link positions are computed, adjust synthetic midpoint nodes so they\r\n// sit at the true midpoint of THEIR two incident links (using the stacked\r\n// y-positions, not the node centres).\r\nfunction adjustMidpointNodes({ nodes }) {\r\n    for (const node of nodes) {\r\n        if (!node.isMidpoint) continue;\r\n\r\n        const incident = [\r\n            ...(node.sourceLinks || []),\r\n            ...(node.targetLinks || [])\r\n        ];\r\n\r\n        if (incident.length !== 2) continue; // sanity: we expect exactly two halves\r\n\r\n        const ends = [];\r\n\r\n        for (const link of incident) {\r\n            if (link.source === node) {\r\n                // midpoint -> real node\r\n                ends.push({ x: link.target.x0, y: link.y1 });\r\n            } else if (link.target === node) {\r\n                // real node -> midpoint (just in case)\r\n                ends.push({ x: link.source.x1, y: link.y0 });\r\n            }\r\n        }\r\n\r\n        if (ends.length !== 2) continue;\r\n\r\n        // Y midpoint of the *actual* stacked link endpoints\r\n        const midY = (ends[0].y + ends[1].y) / 2;\r\n\r\n        // Keep x as-is (geometric middle already fine); just fix Y\r\n        node.y = midY;\r\n        node.y0 = midY;\r\n        node.y1 = midY;\r\n\r\n        // Snap both halves to the corrected midpoint Y\r\n        for (const link of incident) {\r\n            if (link.source === node) link.y0 = midY;\r\n            if (link.target === node) link.y1 = midY;\r\n        }\r\n    }\r\n}\r\n\r\nfunction computeNodeValues({ nodes }) {\r\n    for (const node of nodes) {\r\n        node.value = Math.max(\r\n            sum(node.sourceLinks, (d) => d.value),\r\n            sum(node.targetLinks, (d) => d.value)\r\n        )\r\n    }\r\n}\r\n\r\nfunction reorderLinks(nodes) {\r\n    for (const { sourceLinks, targetLinks } of nodes) {\r\n        sourceLinks.sort((a, b) => a.target.y - b.target.y)\r\n        targetLinks.sort((a, b) => a.source.y - b.source.y)\r\n    }\r\n}\r\n\r\n// Smooth cubic segment builder with curvature\r\nfunction cubicSegment(p0, p1, curvature = 0.5) {\r\n    const [x0, y0] = p0, [x1, y1] = p1;\r\n    const xi = (t) => x0 + (x1 - x0) * t;\r\n    const c1x = xi(curvature), c2x = xi(1 - curvature);\r\n    return `C${c1x},${y0} ${c2x},${y1} ${x1},${y1}`;\r\n}\r\n\r\n\r\n// Returns a function(link) -> path string, avoiding node stems.\r\n// obstacles: array of nodes with x0, y0, y1 (your stacked extents)\r\n// opts:\r\n//   gapX: how far to go left / right of the node before / after the bypass\r\n//   padX: horizontal \"no-go\" half-width around the stem\r\n//   padY: vertical clearance outside [y0, y1]\r\n//   bumpY: extra lift above/below the obstacle band\r\n//   curvature: 0..1; 0.5  default d3-sankey feel\r\n//\r\nfunction sankeyLinkAvoidingNodes(obstacles, {\r\n    gapX = 10,\r\n    padX = 2,\r\n    padY = 2,\r\n    bumpY = 0,\r\n    curvature = 0.5   // may be number OR function(link) -> number\r\n} = {}) {\r\n    return function (link) {\r\n        const sx = link.source.x1, sy = link.y0;\r\n        const tx = link.target.x0, ty = link.y1;\r\n\r\n        // If source and target have same x, just draw a straight segment.\r\n        if (sx === tx) {\r\n            return `M${sx},${sy}L${tx},${ty}`;\r\n        }\r\n\r\n        const rev = sx > tx;\r\n        const xA = rev ? tx : sx;\r\n        const yA = rev ? ty : sy;\r\n        const xB = rev ? sx : tx;\r\n        const yB = rev ? sy : ty;\r\n\r\n        const pts = [[xA, yA]];\r\n\r\n        const yAt = (x) => {\r\n            const t = (xB === xA) ? 0 : ((x - xA) / (xB - xA));\r\n            return yA + (yB - yA) * t;\r\n        };\r\n\r\n        // 1) Collect bypass segments that actually intersect this link\r\n        const segments = [];\r\n\r\n        for (const n of obstacles) {\r\n            if (n === link.source || n === link.target) continue;\r\n\r\n            const ox = n.x0;\r\n            if (ox <= xA || ox >= xB) continue;\r\n\r\n            const nodeTop = (n.y0 ?? n.y);\r\n            const nodeBot = (n.y1 ?? n.y);\r\n            const nodeMid = (nodeTop + nodeBot) / 2;\r\n\r\n            const leftX = ox - padX;\r\n            const rightX = ox + padX;\r\n\r\n            const yline = yAt(ox);\r\n\r\n            // Is the link passing above or below the node centre?\r\n            const isBelow = yline >= nodeMid;      // larger y = visually \"below\"\r\n\r\n            // Apply pad only on the side where the link lies\r\n            const top = nodeTop - (isBelow ? 0 : padY);\r\n            const bot = nodeBot + (isBelow ? padY : 0);\r\n\r\n            // Only treat as collision if the link actually enters this one-sided band\r\n            if (yline >= top && yline <= bot) {\r\n                const bypassY = isBelow\r\n                    ? (bot + bumpY)   // link is below  push further down\r\n                    : (top - bumpY);  // link is above  push further up\r\n\r\n                const x1 = Math.max(xA, leftX - gapX);\r\n                const x2 = Math.min(xB, rightX + gapX);\r\n                if (x2 < x1) continue; // degenerate; allow x1 === x2\r\n\r\n                segments.push({ x1, x2, y: bypassY });\r\n            }\r\n        }\r\n\r\n        if (segments.length) {\r\n            // 2) Merge overlapping segments horizontally\r\n            segments.sort((a, b) => a.x1 - b.x1);\r\n            const merged = [];\r\n            for (const seg of segments) {\r\n                if (!merged.length || seg.x1 > merged[merged.length - 1].x2) {\r\n                    merged.push({ ...seg });\r\n                } else {\r\n                    const last = merged[merged.length - 1];\r\n                    last.x2 = Math.max(last.x2, seg.x2);\r\n                    // keep the latest y (they should be same-side already)\r\n                    last.y = seg.y;\r\n                }\r\n            }\r\n\r\n            // 3) Emit bypass points, enforcing monotonic X\r\n            for (const seg of merged) {\r\n                const startX = Math.max(xA, seg.x1);\r\n                const endX = Math.min(xB, seg.x2);\r\n                let lastX = pts[pts.length - 1][0];\r\n\r\n                if (startX > lastX) {\r\n                    pts.push([startX, seg.y]);\r\n                    lastX = startX;\r\n                }\r\n                if (endX > lastX) {\r\n                    pts.push([endX, seg.y]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Always end at the target\r\n        pts.push([xB, yB]);\r\n        if (rev) pts.reverse();\r\n\r\n        //  per-link curvature: number OR function(link) -> number\r\n        const c = (typeof curvature === 'function') ? curvature(link) : curvature;\r\n\r\n        let d = `M${pts[0][0]},${pts[0][1]}`;\r\n        for (let i = 1; i < pts.length; i++) {\r\n            d += cubicSegment(pts[i - 1], pts[i], c);\r\n        }\r\n        return d;\r\n    };\r\n}\r\n\r\n\r\nfunction pathLength(d) {\r\n    const p = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n    p.setAttribute('d', d);\r\n    return p.getTotalLength();\r\n}\r\n\r\nfunction pathDashForBackoff(d, backoffPx) {\r\n    const L = Math.max(0, pathLength(d));\r\n    const vis = Math.max(0, L - Math.min(backoffPx, L));\r\n    const gap = Math.min(backoffPx, L);\r\n    return [vis, gap];\r\n}\r\n\r\n// matches arrows.js defaults: markerWidth = 3 * scale (in strokeWidth units),\r\n// and the usable length ~ 0.9 of the marker viewBox\r\nfunction arrowBackoffPxForStroke(strokePx, arrowScale = 1) {\r\n    const arrowLenPx = strokePx * (3 * arrowScale) * 0.9;\r\n    return arrowLenPx * 0.85;\r\n}","import constant from \"./constant.js\";\nimport jiggle from \"./jiggle.js\";\n\nfunction index(d) {\n  return d.index;\n}\n\nfunction find(nodeById, nodeId) {\n  var node = nodeById.get(nodeId);\n  if (!node) throw new Error(\"node not found: \" + nodeId);\n  return node;\n}\n\nexport default function(links) {\n  var id = index,\n      strength = defaultStrength,\n      strengths,\n      distance = constant(30),\n      distances,\n      nodes,\n      count,\n      bias,\n      random,\n      iterations = 1;\n\n  if (links == null) links = [];\n\n  function defaultStrength(link) {\n    return 1 / Math.min(count[link.source.index], count[link.target.index]);\n  }\n\n  function force(alpha) {\n    for (var k = 0, n = links.length; k < iterations; ++k) {\n      for (var i = 0, link, source, target, x, y, l, b; i < n; ++i) {\n        link = links[i], source = link.source, target = link.target;\n        x = target.x + target.vx - source.x - source.vx || jiggle(random);\n        y = target.y + target.vy - source.y - source.vy || jiggle(random);\n        l = Math.sqrt(x * x + y * y);\n        l = (l - distances[i]) / l * alpha * strengths[i];\n        x *= l, y *= l;\n        target.vx -= x * (b = bias[i]);\n        target.vy -= y * b;\n        source.vx += x * (b = 1 - b);\n        source.vy += y * b;\n      }\n    }\n  }\n\n  function initialize() {\n    if (!nodes) return;\n\n    var i,\n        n = nodes.length,\n        m = links.length,\n        nodeById = new Map(nodes.map((d, i) => [id(d, i, nodes), d])),\n        link;\n\n    for (i = 0, count = new Array(n); i < m; ++i) {\n      link = links[i], link.index = i;\n      if (typeof link.source !== \"object\") link.source = find(nodeById, link.source);\n      if (typeof link.target !== \"object\") link.target = find(nodeById, link.target);\n      count[link.source.index] = (count[link.source.index] || 0) + 1;\n      count[link.target.index] = (count[link.target.index] || 0) + 1;\n    }\n\n    for (i = 0, bias = new Array(m); i < m; ++i) {\n      link = links[i], bias[i] = count[link.source.index] / (count[link.source.index] + count[link.target.index]);\n    }\n\n    strengths = new Array(m), initializeStrength();\n    distances = new Array(m), initializeDistance();\n  }\n\n  function initializeStrength() {\n    if (!nodes) return;\n\n    for (var i = 0, n = links.length; i < n; ++i) {\n      strengths[i] = +strength(links[i], i, links);\n    }\n  }\n\n  function initializeDistance() {\n    if (!nodes) return;\n\n    for (var i = 0, n = links.length; i < n; ++i) {\n      distances[i] = +distance(links[i], i, links);\n    }\n  }\n\n  force.initialize = function(_nodes, _random) {\n    nodes = _nodes;\n    random = _random;\n    initialize();\n  };\n\n  force.links = function(_) {\n    return arguments.length ? (links = _, initialize(), force) : links;\n  };\n\n  force.id = function(_) {\n    return arguments.length ? (id = _, force) : id;\n  };\n\n  force.iterations = function(_) {\n    return arguments.length ? (iterations = +_, force) : iterations;\n  };\n\n  force.strength = function(_) {\n    return arguments.length ? (strength = typeof _ === \"function\" ? _ : constant(+_), initializeStrength(), force) : strength;\n  };\n\n  force.distance = function(_) {\n    return arguments.length ? (distance = typeof _ === \"function\" ? _ : constant(+_), initializeDistance(), force) : distance;\n  };\n\n  return force;\n}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // falls through\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","import {Basis} from \"./basis.js\";\n\nfunction Bundle(context, beta) {\n  this._basis = new Basis(context);\n  this._beta = beta;\n}\n\nBundle.prototype = {\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n    this._basis.lineStart();\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        j = x.length - 1;\n\n    if (j > 0) {\n      var x0 = x[0],\n          y0 = y[0],\n          dx = x[j] - x0,\n          dy = y[j] - y0,\n          i = -1,\n          t;\n\n      while (++i <= j) {\n        t = i / j;\n        this._basis.point(\n          this._beta * x[i] + (1 - this._beta) * (x0 + t * dx),\n          this._beta * y[i] + (1 - this._beta) * (y0 + t * dy)\n        );\n      }\n    }\n\n    this._x = this._y = null;\n    this._basis.lineEnd();\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\nexport default (function custom(beta) {\n\n  function bundle(context) {\n    return beta === 1 ? new Basis(context) : new Bundle(context, beta);\n  }\n\n  bundle.beta = function(beta) {\n    return custom(+beta);\n  };\n\n  return bundle;\n})(0.85);\n","import { forceSimulation, forceManyBody, forceLink } from \"d3-force\";\r\nimport { curveBundle, line } from \"d3-shape\";\r\nimport { scaleLinear, scaleSqrt } from \"d3-scale\";\r\nimport { applyArrow, setHoverArrow } from \"./arrows.js\";\r\nimport { select } from \"d3-selection\";\r\nimport { getFlowStroke, computeColorKey, onFlowLineMouseOver, onFlowLineMouseOut } from \"./straight.js\"; // reuse your helpers\r\n\r\nexport function drawEdgeBundleLines(out, lineGroup) {\r\n  const width = out.width_ || out.innerWidth_ || 1000;\r\n  const height = out.height_ || out.innerHeight_ || 800;\r\n  const hypotenuse = Math.sqrt(width * width + height * height);\r\n\r\n  const scales = {\r\n    segments: scaleLinear().domain([0, hypotenuse]).range([1, 10]),\r\n    nodes: out._nodeSizeScale || scaleSqrt().range([4, 18]),\r\n  };\r\n\r\n  // Build the bundled network\r\n  const bundle = generateSegments(out.flowGraph_.nodes, out.flowGraph_.links, scales);\r\n\r\n  // --- Style setup: compute stroke, width, and colors for each path ---\r\n  const arrowIds = out.flowArrows_\r\n    ? out._arrowIds || {} // reuse markers if already built\r\n    : null;\r\n\r\n  const lineFunction = line()\r\n    .curve(curveBundle.beta(0.85))\r\n    .x(d => d.x)\r\n    .y(d => d.y);\r\n\r\n  const paths = lineGroup\r\n    .selectAll(\"path.em-flow-link\")\r\n    .data(bundle.paths)\r\n    .enter()\r\n    .append(\"path\")\r\n    .attr(\"d\", lineFunction)\r\n    .attr(\"class\", \"em-flow-link\")\r\n    .attr(\"fill\", \"none\")\r\n    .style(\"cursor\", \"pointer\")\r\n    .style(\"pointer-events\", \"auto\")\r\n    .attr(\"stroke-linecap\", \"butt\")\r\n    .attr(\"stroke-opacity\", out.flowOpacity_ ?? 1)\r\n    .each(function (d, i) {\r\n      // find source/target IDs for metadata\r\n      const source = d[0];\r\n      const target = d[d.length - 1];\r\n      const originId = source.id || source.code || source.iata;\r\n      const destId = target.id || target.code || target.iata;\r\n      const val = (out.flowGraph_.links?.[i]?.value) ?? 1;\r\n\r\n      const baseColor = getFlowStroke(out, originId, destId, null, val);\r\n      const colorKey = computeColorKey(out, originId, destId);\r\n      const paint = baseColor;\r\n      const strokeW = out.strokeWidthScale(val);\r\n\r\n      select(this)\r\n        .attr(\"data-nb\", val)\r\n        .attr(\"data-origin\", originId)\r\n        .attr(\"data-dest\", destId)\r\n        .attr(\"data-color\", baseColor)\r\n        .attr(\"data-color-key\", colorKey)\r\n        .attr(\"stroke\", paint)\r\n        .attr(\"stroke-width\", strokeW)\r\n        .attr(\"stroke-dasharray\", out.flowArrows_ ? \"5 5\" : null);\r\n\r\n      if (out.flowArrows_) applyArrow(select(this), arrowIds, \"normal\");\r\n    })\r\n\r\n\r\n  //mouse events\r\n  paths\r\n    .on(\"mouseover\", function (event, d) {\r\n      const src = d[0];\r\n      const dst = d[d.length - 1];\r\n      const originId = src.id || src.code || src.iata;\r\n      const destId = dst.id || dst.code || dst.iata;\r\n      const val = (out.flowGraph_.links?.find(\r\n        l => (l.source.id || l.source.code) === originId &&\r\n          (l.target.id || l.target.code) === destId\r\n      )?.value) ?? 1;\r\n\r\n      // Call imported hover handler\r\n      onFlowLineMouseOver(out, originId, destId, val, arrowIds).call(this, event);\r\n    })\r\n    .on(\"mousemove\", function (event) {\r\n      if (out._tooltip) out._tooltip.mousemove(event);\r\n    })\r\n    .on(\"mouseout\", function (event, d) {\r\n      const baseColor = select(this).attr(\"data-color\");\r\n      onFlowLineMouseOut(out, baseColor, arrowIds).call(this, event);\r\n    });\r\n\r\n  // --- Animate (edge bundling simulation) ---\r\n  const layout = forceSimulation()\r\n    .alphaDecay(out.flowBundleSettings_.alphaDecay)\r\n    .force(\r\n      \"charge\",\r\n      forceManyBody().strength(out.flowBundleSettings_.chargeStrength).distanceMax(out.flowBundleSettings_.distanceMax ? out.flowBundleSettings_.distanceMax : scales.nodes.range()[1] * 2)\r\n    )\r\n    .force(\"link\", forceLink().strength(out.flowBundleSettings_.linkStrength).distance(0).iterations(out.flowBundleSettings_.linkIterations))\r\n    .on(\"tick\", () => paths.attr(\"d\", lineFunction))\r\n    .on(\"end\", () => console.log(\"layout complete\"));\r\n\r\n  layout.nodes(bundle.nodes);\r\n  layout.force(\"link\").links(bundle.links);\r\n}\r\n\r\n// --- same segment generator as before ---\r\nfunction generateSegments(nodes, links, scales) {\r\n  const bundle = { nodes: [], links: [], paths: [] };\r\n\r\n  bundle.nodes = nodes.map(d => {\r\n    d.fx = d.x;\r\n    d.fy = d.y;\r\n    return d;\r\n  });\r\n\r\n  links.forEach(d => {\r\n    const len = distance(d.source, d.target);\r\n    const total = Math.round(scales.segments(len));\r\n    const xscale = scaleLinear().domain([0, total + 1]).range([d.source.x, d.target.x]);\r\n    const yscale = scaleLinear().domain([0, total + 1]).range([d.source.y, d.target.y]);\r\n\r\n    let src = d.source;\r\n    const local = [src];\r\n    for (let j = 1; j <= total; j++) {\r\n      const tgt = { x: xscale(j), y: yscale(j) };\r\n      local.push(tgt);\r\n      bundle.nodes.push(tgt);\r\n      bundle.links.push({ source: src, target: tgt });\r\n      src = tgt;\r\n    }\r\n    local.push(d.target);\r\n    bundle.links.push({ source: src, target: d.target });\r\n    bundle.paths.push(local);\r\n  });\r\n\r\n  return bundle;\r\n}\r\n\r\nfunction distance(a, b) {\r\n  const dx = a.x - b.x;\r\n  const dy = a.y - b.y;\r\n  return Math.sqrt(dx * dx + dy * dy);\r\n}\r\n","import {quadtree} from \"d3-quadtree\";\nimport constant from \"./constant.js\";\nimport jiggle from \"./jiggle.js\";\nimport {x, y} from \"./simulation.js\";\n\nexport default function() {\n  var nodes,\n      node,\n      random,\n      alpha,\n      strength = constant(-30),\n      strengths,\n      distanceMin2 = 1,\n      distanceMax2 = Infinity,\n      theta2 = 0.81;\n\n  function force(_) {\n    var i, n = nodes.length, tree = quadtree(nodes, x, y).visitAfter(accumulate);\n    for (alpha = _, i = 0; i < n; ++i) node = nodes[i], tree.visit(apply);\n  }\n\n  function initialize() {\n    if (!nodes) return;\n    var i, n = nodes.length, node;\n    strengths = new Array(n);\n    for (i = 0; i < n; ++i) node = nodes[i], strengths[node.index] = +strength(node, i, nodes);\n  }\n\n  function accumulate(quad) {\n    var strength = 0, q, c, weight = 0, x, y, i;\n\n    // For internal nodes, accumulate forces from child quadrants.\n    if (quad.length) {\n      for (x = y = i = 0; i < 4; ++i) {\n        if ((q = quad[i]) && (c = Math.abs(q.value))) {\n          strength += q.value, weight += c, x += c * q.x, y += c * q.y;\n        }\n      }\n      quad.x = x / weight;\n      quad.y = y / weight;\n    }\n\n    // For leaf nodes, accumulate forces from coincident quadrants.\n    else {\n      q = quad;\n      q.x = q.data.x;\n      q.y = q.data.y;\n      do strength += strengths[q.data.index];\n      while (q = q.next);\n    }\n\n    quad.value = strength;\n  }\n\n  function apply(quad, x1, _, x2) {\n    if (!quad.value) return true;\n\n    var x = quad.x - node.x,\n        y = quad.y - node.y,\n        w = x2 - x1,\n        l = x * x + y * y;\n\n    // Apply the Barnes-Hut approximation if possible.\n    // Limit forces for very close nodes; randomize direction if coincident.\n    if (w * w / theta2 < l) {\n      if (l < distanceMax2) {\n        if (x === 0) x = jiggle(random), l += x * x;\n        if (y === 0) y = jiggle(random), l += y * y;\n        if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);\n        node.vx += x * quad.value * alpha / l;\n        node.vy += y * quad.value * alpha / l;\n      }\n      return true;\n    }\n\n    // Otherwise, process points directly.\n    else if (quad.length || l >= distanceMax2) return;\n\n    // Limit forces for very close nodes; randomize direction if coincident.\n    if (quad.data !== node || quad.next) {\n      if (x === 0) x = jiggle(random), l += x * x;\n      if (y === 0) y = jiggle(random), l += y * y;\n      if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);\n    }\n\n    do if (quad.data !== node) {\n      w = strengths[quad.data.index] * alpha / l;\n      node.vx += x * w;\n      node.vy += y * w;\n    } while (quad = quad.next);\n  }\n\n  force.initialize = function(_nodes, _random) {\n    nodes = _nodes;\n    random = _random;\n    initialize();\n  };\n\n  force.strength = function(_) {\n    return arguments.length ? (strength = typeof _ === \"function\" ? _ : constant(+_), initialize(), force) : strength;\n  };\n\n  force.distanceMin = function(_) {\n    return arguments.length ? (distanceMin2 = _ * _, force) : Math.sqrt(distanceMin2);\n  };\n\n  force.distanceMax = function(_) {\n    return arguments.length ? (distanceMax2 = _ * _, force) : Math.sqrt(distanceMax2);\n  };\n\n  force.theta = function(_) {\n    return arguments.length ? (theta2 = _ * _, force) : Math.sqrt(theta2);\n  };\n\n  return force;\n}\n","import { select } from 'd3-selection'\r\nimport { ensureArrowMarkers, applyArrow, setHoverArrow } from './arrows.js'\r\nimport { buildBidirectionalRouteMap } from './flow-bidirectional.js'\r\nimport { generateUniqueId } from '../../core/utils.js'\r\nimport { drawEdgeBundleLines } from './edge-bundling.js';\r\n\r\n/**\r\n * Function to create a flow map with straight lines.\r\n * exampleGraph = {\r\n *   nodes:[{id:'FR',x:681.18,y:230.31},{id:'DE',x:824.54,y:123.70}],\r\n *   links:[{source:'FR',target:'DE',value:82018369.72}],\r\n * }\r\n */\r\nexport function createFlowMap(out, flowMapContainer) {\r\n    drawStraightLinesByFlow(out, flowMapContainer)\r\n}\r\n\r\n// ------------- orchestrator -------------\r\nfunction drawStraightLinesByFlow(out, container) {\r\n    // minimal guard\r\n    if (!out?.flowGraph_) return;\r\n\r\n    // create arrow markers once\r\n    const svgRoot = out.svg_ || container;\r\n    const arrowIds = out.flowArrows_\r\n        ? ensureArrowMarkers(svgRoot, {\r\n            cacheKey: \"straight\",\r\n            scale: out.flowArrowScale_ || 1,\r\n            markerUnits: \"strokeWidth\",\r\n            hoverColor: out.hoverColor_ || \"black\",\r\n            outlineColor: out.flowOutlineColor_ || \"#ffffff\",\r\n            useContextStroke: true,\r\n        })\r\n        : null;\r\n\r\n    const segments = buildSegments(out);\r\n\r\n    assignWidths(out, segments);\r\n    const gradientIds = prepareGradients(out, container, segments);\r\n    drawSegments(out, container, segments, gradientIds, arrowIds);\r\n\r\n}\r\n\r\n\r\n// ---------------- helpers ----------------\r\nconst idFor = (v) => (v && typeof v === 'object' ? (v.id ?? v.iata ?? v.code) : v);\r\n\r\n// Build segments array depending on out.flowBidirectional_\r\nfunction buildSegments(out) {\r\n    const { nodes = [], links = [] } = out.flowGraph_ || {};\r\n    out._nodeById = out._nodeById || new Map(nodes.map((n) => [n.id, n]));\r\n\r\n    const segs = [];\r\n\r\n    if (out.flowBidirectional_) {\r\n        // Original bidirectional handling remains the same\r\n        const routeMap = buildBidirectionalRouteMap(nodes, links);\r\n        for (const route of routeMap.values()) {\r\n            const { idA, idB, nodeA, nodeB, flowAB, flowBA } = route;\r\n            const midX = (nodeA.x + nodeB.x) / 2;\r\n            const midY = (nodeA.y + nodeB.y) / 2;\r\n\r\n            if (flowAB > 0 && flowBA > 0) {\r\n                segs.push({\r\n                    originId: idA,\r\n                    destId: idB,\r\n                    x1: midX,\r\n                    y1: midY,\r\n                    x2: nodeB.x,\r\n                    y2: nodeB.y,\r\n                    value: flowAB,\r\n                    route,\r\n                    nodeA,\r\n                    nodeB,\r\n                    isHalf: true,\r\n                });\r\n                segs.push({\r\n                    originId: idB,\r\n                    destId: idA,\r\n                    x1: midX,\r\n                    y1: midY,\r\n                    x2: nodeA.x,\r\n                    y2: nodeA.y,\r\n                    value: flowBA,\r\n                    route,\r\n                    nodeA,\r\n                    nodeB,\r\n                    isHalf: true,\r\n                });\r\n            } else if (flowAB > 0) {\r\n                segs.push({\r\n                    originId: idA,\r\n                    destId: idB,\r\n                    x1: nodeA.x,\r\n                    y1: nodeA.y,\r\n                    x2: nodeB.x,\r\n                    y2: nodeB.y,\r\n                    value: flowAB,\r\n                    route,\r\n                    nodeA,\r\n                    nodeB,\r\n                });\r\n            } else if (flowBA > 0) {\r\n                segs.push({\r\n                    originId: idB,\r\n                    destId: idA,\r\n                    x1: nodeB.x,\r\n                    y1: nodeB.y,\r\n                    x2: nodeA.x,\r\n                    y2: nodeA.y,\r\n                    value: flowBA,\r\n                    route,\r\n                    nodeA,\r\n                    nodeB,\r\n                });\r\n            }\r\n        }\r\n    } else {\r\n        // --- Single-direction merged flows ---\r\n        const merged = new Map();\r\n        const { links = [] } = out.flowGraph_ || {};\r\n        const nodeMap = out._nodeById;\r\n\r\n        for (const link of links) {\r\n            const sid = idFor(link.source);\r\n            const tid = idFor(link.target);\r\n            if (!sid || !tid || sid === tid) continue;\r\n\r\n            const key = sid < tid ? `${sid}|${tid}` : `${tid}|${sid}`; // symmetric key\r\n            const value = +link.value || +link.nb || 0;\r\n            if (!(value > 0)) continue;\r\n\r\n            const sourceNode =\r\n                nodeMap.get(sid) ||\r\n                (typeof link.source === \"object\" ? link.source : null);\r\n            const targetNode =\r\n                nodeMap.get(tid) ||\r\n                (typeof link.target === \"object\" ? link.target : null);\r\n\r\n            if (!sourceNode || !targetNode) continue;\r\n\r\n            const entry = merged.get(key);\r\n            if (entry) {\r\n                entry.value += value;\r\n            } else {\r\n                merged.set(key, {\r\n                    originId: sid,\r\n                    destId: tid,\r\n                    nodeA: sourceNode,   //  store live references\r\n                    nodeB: targetNode,\r\n                    value,\r\n\r\n                    //  define getters that always read live node positions\r\n                    get x1() { return this.nodeA.x; },\r\n                    get y1() { return this.nodeA.y; },\r\n                    get x2() { return this.nodeB.x; },\r\n                    get y2() { return this.nodeB.y; },\r\n                });\r\n            }\r\n        }\r\n\r\n        segs.push(...merged.values());\r\n    }\r\n\r\n    return segs;\r\n}\r\n\r\nfunction assignWidths(out, segments) {\r\n    for (const s of segments) {\r\n        const sw = typeof out.strokeWidthScale === 'function' ? out.strokeWidthScale(s.value) : (s.value || 1);\r\n        s.width = +((sw == null ? 1 : sw)).toFixed(1);\r\n    }\r\n}\r\n\r\n// create deduped gradients, return array of gradientId per segment (index aligned)\r\nfunction prepareGradients(out, container, segments) {\r\n    const usesGradient = out.flowColorGradient_ || out.flowOpacityGradient_;\r\n    if (!usesGradient) return null;\r\n\r\n    const svgRoot = out.svg_ || container;\r\n    const defs = (svgRoot.select('defs').empty()) ? svgRoot.append('defs') : svgRoot.select('defs');\r\n    const gradientMap = new Map();\r\n    const gradientIds = new Array(segments.length);\r\n\r\n\r\n    for (let i = 0; i < segments.length; i++) {\r\n        const s = segments[i];\r\n        const baseColor = getFlowStroke(out, s.originId, s.destId, s.route, s.value);\r\n        // key: rounded coords + color + opacity flag. Adjust bucketing if necessary.\r\n        const key = `${Math.round(s.x1)}:${Math.round(s.y1)}:${Math.round(s.x2)}:${Math.round(s.y2)}:${baseColor}:${out.flowOpacityGradient_ ? 1 : 0}`;\r\n        let gid = gradientMap.get(key);\r\n        if (!gid) {\r\n            gid = generateUniqueId('flowgrad');\r\n            gradientMap.set(key, gid);\r\n\r\n            const g = defs.append('linearGradient')\r\n                .attr('id', gid)\r\n                .attr('gradientUnits', 'userSpaceOnUse')\r\n                .attr('x1', s.x1).attr('y1', s.y1)\r\n                .attr('x2', s.x2).attr('y2', s.y2);\r\n\r\n            const startColor = out.flowColorGradient_ ? (out.flowRegionColors_?.[0] ?? baseColor) : baseColor;\r\n            const startOpacity = out.flowOpacityGradient_ ? 0 : 1;\r\n            const endOpacity = 1;\r\n\r\n            g.append('stop').attr('offset', '0%').attr('stop-color', startColor).attr('stop-opacity', startOpacity);\r\n            g.append('stop').attr('offset', '100%').attr('stop-color', baseColor).attr('stop-opacity', endOpacity);\r\n        }\r\n        gradientIds[i] = gid;\r\n    }\r\n\r\n    return gradientIds;\r\n}\r\n\r\n// draw all segments (one element per segment). avoid extra tip/outline nodes and inline styles\r\nfunction drawSegments(out, container, segments, gradientIds, arrowIds) {\r\n    const lineGroup = container.select('.em-flow-lines').empty()\r\n        ? container.append('g').attr('class', 'em-flow-lines').attr('id', 'em-flow-lines')\r\n        : container.select('.em-flow-lines');\r\n\r\n    const usesGradient = !!gradientIds;\r\n\r\n    if (out.flowEdgeBundling_) {\r\n        drawEdgeBundleLines(out,lineGroup)\r\n        return;\r\n    }\r\n\r\n    // draw each segment\r\n    for (let i = 0; i < segments.length; i++) {\r\n        const s = segments[i];\r\n        const baseColor = getFlowStroke(out, s.originId, s.destId, s.route, s.value);\r\n        const colorKey = computeColorKey(out, s.originId, s.destId);\r\n        const paint = (usesGradient && gradientIds[i]) ? `url(#${gradientIds[i]})` : baseColor;\r\n        let paths\r\n\r\n        if (out.flowWidthGradient_) {\r\n            // tapered polygon path (single element)\r\n            const dx = s.x2 - s.x1, dy = s.y2 - s.y1;\r\n            const L = Math.hypot(dx, dy) || 1;\r\n            const nx = -dy / L, ny = dx / L;\r\n\r\n            const startRatio = (out.flowWidthGradientSettings_?.startRatio) ?? 0.25;\r\n            const minStartWidth = (out.flowWidthGradientSettings_?.minStartWidth) ?? (s.width * 0.25);\r\n            const wStart = Math.max(minStartWidth, s.width * startRatio);\r\n            const wEnd = s.width;\r\n\r\n            const topStartX = s.x1 + nx * (wStart / 2);\r\n            const topStartY = s.y1 + ny * (wStart / 2);\r\n            const topEndX = s.x2 + nx * (wEnd / 2);\r\n            const topEndY = s.y2 + ny * (wEnd / 2);\r\n            const botEndX = s.x2 - nx * (wEnd / 2);\r\n            const botEndY = s.y2 - ny * (wEnd / 2);\r\n            const botStartX = s.x1 - nx * (wStart / 2);\r\n            const botStartY = s.y1 - ny * (wStart / 2);\r\n\r\n            const dPoly = `M${topStartX},${topStartY}L${topEndX},${topEndY}L${botEndX},${botEndY}L${botStartX},${botStartY}Z`;\r\n\r\n            paths = lineGroup.append('path')\r\n                .attr('d', dPoly)\r\n                .attr('class', 'em-flow-link em-flow-link-tapered')\r\n                .attr('fill', paint)\r\n                .attr('data-color-key', colorKey)\r\n                .attr('data-color', baseColor)\r\n                .attr('data-nb', s.value)\r\n                .attr('data-origin', s.originId)\r\n                .attr('data-dest', s.destId)\r\n                .attr('opacity', out.flowOpacity_ ?? 1);\r\n\r\n            if (out.flowArrows_) applyArrow(paths, arrowIds, 'normal');\r\n            // note: mouse handlers for tapered shapes omitted in original; add if needed\r\n        } else {\r\n\r\n            //  original straight line fallback\r\n            const segLen = Math.hypot(s.x2 - s.x1, s.y2 - s.y1) || 0;\r\n            const backoff = out.flowArrows_ ? arrowBackoffPxForStroke(s.width) : 0;\r\n            const dashVis = Math.max(0, segLen - backoff);\r\n            const dashGap = out.flowArrows_ ? Math.min(backoff, segLen) : null;\r\n\r\n            paths = lineGroup.append('line')\r\n                .datum(s) //  attach the segment itself\r\n                .attr('x1', d => d.x1)\r\n                .attr('y1', d => d.y1)\r\n                .attr('x2', d => d.x2)\r\n                .attr('y2', d => d.y2)\r\n                .attr('class', 'em-flow-link')\r\n                .attr('data-nb', s.value)\r\n                .attr('data-origin', s.originId)\r\n                .attr('data-dest', s.destId)\r\n                .attr('stroke', paint)\r\n                .attr('stroke-width', s.width)\r\n                .attr('stroke-opacity', out.flowOpacity_ ?? 1)\r\n                .attr('stroke-linecap', 'butt')\r\n                .attr('stroke-dasharray', out.flowArrows_ ? `${dashVis} ${dashGap}` : null)\r\n                .attr('data-color', baseColor)\r\n                .attr('data-color-key', colorKey);\r\n        }\r\n\r\n        //mouse events\r\n        paths.on('mouseover', onFlowLineMouseOver(out, s.originId, s.destId, s.value, arrowIds))\r\n            .on('mousemove', onFlowLineMouseMove(out))\r\n            .on('mouseout', onFlowLineMouseOut(out, baseColor, arrowIds));\r\n\r\n        //arrows\r\n        if (out.flowArrows_) applyArrow(paths, arrowIds, 'normal');\r\n    }\r\n}\r\n\r\n\r\n\r\n// estimate arrow length (px) for a given stroke width (px), matched to arrows.js createMarker()\r\nfunction arrowBackoffPxForStroke(strokePx) {\r\n    // match arrows.js createMarker(): markerWidth = 3 * scale, tip at ~90% of viewBox\r\n    const arrowLenPx = strokePx * (3 * (out.flowArrowScale_ || 1)) * 0.9;\r\n    return arrowLenPx * 0.7; // slightly less so the base tucks under cleanly\r\n}\r\n\r\nexport function getFlowStroke(out, originId, destId, route, halfValue) {\r\n    const fallback = typeof out.flowColor_ === 'string' ? out.flowColor_ : '#999999'\r\n    const nodeById = out._nodeById || new Map(out.flowGraph_.nodes.map(n => [n.id, n]))\r\n    const source = nodeById.get(originId) || { id: originId }\r\n    const target = nodeById.get(destId) || { id: destId }\r\n    const linkLike = { source, target, value: halfValue, route }\r\n\r\n    if (typeof out.flowColor_ === 'function') {\r\n        let color\r\n        try { color = out.flowColor_(linkLike) } catch (_) { }\r\n        if (color == null && out.flowColor_.length >= 3) {\r\n            try { color = out.flowColor_(originId, destId, route) } catch (_) { }\r\n        }\r\n        if (color != null) return color\r\n    }\r\n    return colorByTopN(out, originId, destId, fallback)\r\n}\r\n\r\nfunction colorByTopN(out, originId, destId, fallback) {\r\n    if (!out.topLocationKeys || !out.flowTopLocations_) return fallback\r\n    const type = out.flowTopLocationsType_ || 'sum'\r\n    if (type === 'origin') {\r\n        return out.topLocationKeys.has(originId) ? out.topLocationColorScale(originId) : fallback\r\n    }\r\n    if (type === 'destination') {\r\n        return out.topLocationKeys.has(destId) ? out.topLocationColorScale(destId) : fallback\r\n    }\r\n    return out.topLocationKeys.has(destId)\r\n        ? out.topLocationColorScale(destId)\r\n        : (out.topLocationKeys.has(originId) ? out.topLocationColorScale(originId) : fallback)\r\n}\r\n\r\n\r\nexport function computeColorKey(out, originId, destId) {\r\n    if (!out.topLocationKeys) return null;\r\n\r\n    const type = out.flowTopLocationsType_ || 'sum';\r\n\r\n    if (type === 'origin') {\r\n        return out.topLocationKeys.has(originId) ? originId : 'Other';\r\n    }\r\n\r\n    if (type === 'destination') {\r\n        return out.topLocationKeys.has(destId) ? destId : 'Other';\r\n    }\r\n\r\n    // default: 'sum' / mixed  prefer destination if in top list, else origin, else \"Other\"\r\n    if (out.topLocationKeys.has(destId)) return destId;\r\n    if (out.topLocationKeys.has(originId)) return originId;\r\n    return 'Other';\r\n}\r\n\r\n// Hover handlers (arrow swap aware)\r\nexport function onFlowLineMouseOver(out, sourceId, targetId, flow, arrowIds) {\r\n    return function (e) {\r\n        const hoveredColor = out.hoverColor_ || 'black'\r\n        select(this).attr('stroke', hoveredColor).attr('stroke-opacity', 1) // highlight with solid hover color\r\n        if (out.flowArrows_) setHoverArrow(select(this), arrowIds, true)\r\n\r\n        if (out._tooltip) {\r\n            const sourceNode = out.flowGraph_.nodes.find((n) => n.id === sourceId)\r\n            const targetNode = out.flowGraph_.nodes.find((n) => n.id === targetId)\r\n            const linkObj = { source: sourceNode, target: targetNode, value: flow }\r\n            out._tooltip.mouseover(out.tooltip_.textFunction(linkObj, out))\r\n        }\r\n    }\r\n}\r\n\r\nexport function onFlowLineMouseMove(out) {\r\n    return function (e) {\r\n        if (out._tooltip) out._tooltip.mousemove(e)\r\n    }\r\n}\r\n\r\nexport function onFlowLineMouseOut(out, baseColor, arrowIds) {\r\n    return function () {\r\n        select(this).attr('stroke', baseColor).attr('stroke-opacity', out.flowOpacity_)   // restore solid base color\r\n        if (out.flowArrows_) setHoverArrow(select(this), arrowIds, false)\r\n        if (out._tooltip) out._tooltip.mouseout()\r\n    }\r\n}","import { sum, max } from 'd3-array'\r\nimport { scaleSqrt } from 'd3-scale'\r\nimport { arc, pie } from 'd3-shape'\r\nimport { spaceAsThousandSeparator } from '../../core/utils'\r\nimport { select, selectAll } from 'd3-selection'\r\nimport { format } from 'd3-format'\r\n\r\nexport function drawNodeDonuts(out, container) {\r\n    //compute composition\r\n    computeDonutValues(out)\r\n    computeDonutLocationStats(out)\r\n\r\n    const donutContainer = container.append('g').attr('class', 'donuts').attr('id', 'donuts')\r\n    const nodes = out.flowGraph_.nodes\r\n    const maxValue = max(nodes, (d) => sum(d.donutValues, (v) => v.value))\r\n    out._nodeSizeScale = out.flowNodeSizeScale_ || scaleSqrt().domain([0, maxValue]).range([3, 10])\r\n    const arcGen = arc().innerRadius(5)\r\n    const pieGen = pie()\r\n        .value((d) => d.value)\r\n        .sort(null)\r\n\r\n    Object.entries(out.locationStats).forEach(([locKey, stats]) => {\r\n        const { x, y, incoming, outgoing, internal } = stats\r\n        const total = out.flowInternal_ ? incoming + outgoing + internal : incoming + outgoing\r\n        if (total === 0) return\r\n\r\n        const incomingBreakdown = getIncomingBreakdownByOrigin(locKey, out)\r\n        const outgoingBreakdown = getOutgoingBreakdownByDestination(locKey, out)\r\n\r\n        // Combine for grouping by color\r\n        const allBreakdown = [...incomingBreakdown, ...outgoingBreakdown]\r\n\r\n        // Group by color\r\n        const valuesByColor = new Map()\r\n        allBreakdown.forEach((d) => {\r\n            const key = d.color\r\n            valuesByColor.set(key, (valuesByColor.get(key) || 0) + d.value)\r\n        })\r\n\r\n        // Create final donut values for the pie\r\n        const donutValues = Array.from(valuesByColor, ([color, value]) => ({\r\n            label: color, // color key (tooltip still uses full breakdown)\r\n            value,\r\n            color,\r\n        }))\r\n\r\n        //  Generate pie segments and attach parent reference\r\n        const pieData = pieGen(donutValues)\r\n        pieData.forEach((segment) => {\r\n            segment.data.parent = {\r\n                id: locKey,\r\n                name: out.nodeNameMap.get(locKey) || locKey,\r\n                donutValues, // full breakdown for tooltip\r\n            }\r\n        })\r\n\r\n        const g = donutContainer.append('g').attr('class', 'donut-group').attr('transform', `translate(${x},${y})`).attr('data-total', total)\r\n\r\n        const mouseoverFunction = out.flowNodeMouseoverFunction_ || donutMouseoverFunction\r\n\r\n        // Outer donut ring\r\n        g.selectAll('path')\r\n            .data(pieData)\r\n            .join('path')\r\n            .attr('d', arcGen.innerRadius(out._nodeSizeScale(total) * 0.4).outerRadius(out._nodeSizeScale(total)))\r\n            .attr('fill', (d) => d.data.color)\r\n            .attr('stroke', 'white')\r\n            .attr('stroke-width', 0.5)\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function (event, d) {\r\n                if (out._tooltip) out._tooltip.mouseover(mouseoverFunction(d, out))\r\n                highlightDonut(event, out.svg_)\r\n                highlightLines(locKey)\r\n            })\r\n            .on('mousemove', function (event, d) {\r\n                if (out._tooltip) out._tooltip.mousemove(event)\r\n            })\r\n            .on('mouseout', function (event, d) {\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                unhighlightDonut(event, out.svg_)\r\n                unhighlightLines()\r\n            })\r\n\r\n        // Inner circle\r\n        g.append('circle')\r\n            .attr('r', out._nodeSizeScale(total) * 0.4)\r\n            .attr('fill', 'white')\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', function (event) {\r\n                // Reuse the first arc's data for tooltip content\r\n                const firstArcDatum = pieData[0]\r\n                if (out._tooltip) out._tooltip.mouseover(mouseoverFunction(firstArcDatum, out))\r\n                highlightDonut(event, out.svg_)\r\n                highlightLines(locKey)\r\n            })\r\n            .on('mousemove', function (event) {\r\n                if (out._tooltip) out._tooltip.mousemove(event)\r\n            })\r\n            .on('mouseout', function (event) {\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n                unhighlightDonut(event, out.svg_)\r\n                unhighlightLines()\r\n            })\r\n    })\r\n}\r\n\r\nfunction highlightLines(nodeId) {\r\n  if (!nodeId) return;\r\n\r\n  selectAll('.em-flow-link, .em-flow-link-bundled')\r\n    .classed('highlighted', function () {\r\n      const o = this.getAttribute('data-origin');\r\n      const d = this.getAttribute('data-dest');\r\n      return o === nodeId || d === nodeId;\r\n    })\r\n    .classed('dimmed', function () {\r\n      const o = this.getAttribute('data-origin');\r\n      const d = this.getAttribute('data-dest');\r\n      return !(o === nodeId || d === nodeId);\r\n    });\r\n}\r\n\r\nfunction unhighlightLines() {\r\n  selectAll('.em-flow-link, .em-flow-link-bundled')\r\n    .classed('highlighted', false)\r\n    .classed('dimmed', false);\r\n}\r\n\r\nfunction donutMouseoverFunction(d, out) {\r\n    const percentFormat = format('.0%')\r\n    const node = d.data.parent\r\n    const total = sum(node.donutValues, (v) => v.value)\r\n    const statData = out.statData?.()\r\n    const unit = statData?.unitText?.() || ''\r\n\r\n    const buf = []\r\n\r\n    // --- Header ---\r\n    buf.push(`\r\n        <div class=\"em-tooltip-bar\">\r\n            <b><span class=\"em-tooltip-label-text\">${node.name || node.id || 'Unknown location'}</span></b>\r\n        </div>\r\n    `)\r\n\r\n    buf.push(`<div class=\"em-tooltip-text\"><table class=\"em-tooltip-table em-donut-tooltip-table\"><tbody>`)\r\n\r\n    // === INCOMING BREAKDOWN ===\r\n    const incomingBreakdown = getIncomingBreakdownByOrigin(node.id, out)\r\n    const totalIncoming = sum(incomingBreakdown, (v) => v.value)\r\n    if (totalIncoming > 0) {\r\n        const incomingPercent = percentFormat(totalIncoming / total)\r\n        buf.push(`\r\n            <tr class=\"em-donut-tooltip-section-header\">\r\n                <td>Incoming:</td>\r\n                <td>${spaceAsThousandSeparator(totalIncoming)} (${incomingPercent})</td>\r\n            </tr>\r\n        `)\r\n\r\n        incomingBreakdown.forEach((segment) => {\r\n            const percent = percentFormat(segment.value / total)\r\n            buf.push(`\r\n                <tr class=\"em-donut-tooltip-row\">\r\n                    <td class=\"em-donut-tooltip-label\">\r\n                        <span class=\"em-donut-tooltip-colorchip\" style=\"background:${segment.color}\"></span>\r\n                        <span class=\"em-tooltip-label-text\">${segment.name || segment.key}</span>\r\n                    </td>\r\n                    <td class=\"em-donut-tooltip-value\">\r\n                        ${spaceAsThousandSeparator(segment.value)} (${percent})\r\n                    </td>\r\n                </tr>\r\n            `)\r\n        })\r\n    }\r\n\r\n    // === OUTGOING BREAKDOWN ===\r\n    const outgoingBreakdown = getOutgoingBreakdownByDestination(node.id, out)\r\n    const totalOutgoing = sum(outgoingBreakdown, (v) => v.value)\r\n    if (totalOutgoing > 0) {\r\n        const outgoingPercent = percentFormat(totalOutgoing / total)\r\n        buf.push(`\r\n            <tr class=\"em-donut-tooltip-section-header\">\r\n                <td>Outgoing:</td>\r\n                <td>${spaceAsThousandSeparator(totalOutgoing)} (${outgoingPercent})</td>\r\n            </tr>\r\n        `)\r\n\r\n        outgoingBreakdown.forEach((segment) => {\r\n            const percent = percentFormat(segment.value / total)\r\n            buf.push(`\r\n                <tr class=\"em-donut-tooltip-row\">\r\n                    <td class=\"em-donut-tooltip-label\">\r\n                        <span class=\"em-donut-tooltip-colorchip\" style=\"background:${segment.color}\"></span>\r\n                        <span class=\"em-tooltip-label-text\">${segment.name || segment.key}</span>\r\n                    </td>\r\n                    <td class=\"em-donut-tooltip-value\">\r\n                        ${spaceAsThousandSeparator(segment.value)} (${percent})\r\n                    </td>\r\n                </tr>\r\n            `)\r\n        })\r\n    }\r\n\r\n    // === TOTAL ROW ===\r\n    buf.push(`\r\n        <tr class=\"em-donut-tooltip-total\">\r\n            <td colspan=\"2\">Total: ${spaceAsThousandSeparator(total)} ${unit}</td>\r\n        </tr>\r\n    `)\r\n\r\n    buf.push(`</tbody></table></div>`)\r\n\r\n    return buf.join('')\r\n}\r\n\r\n\r\n\r\nconst highlightDonut = (event, svg) => {\r\n    const currentZoom = +svg.attr('data-zoom') || 1\r\n\r\n    select(event.target.parentNode) // the <g> group around the donut arcs\r\n        .selectAll('path')\r\n        .each(function () {\r\n            const el = select(this)\r\n            const current = +el.attr('stroke-width') || 0\r\n            el.attr('data-stroke-width', current) // store original value\r\n        })\r\n        .attr('stroke', 'black')\r\n        .attr('stroke-width', 2 / currentZoom) // scale line width to zoom\r\n}\r\n\r\nconst unhighlightDonut = (event, svg) => {\r\n    const currentZoom = +svg.attr('data-zoom') || 1\r\n\r\n    select(event.target.parentNode)\r\n        .selectAll('path')\r\n        .attr('stroke', 'white')\r\n        .attr('stroke-width', function () {\r\n            const el = select(this)\r\n            const original = +el.attr('data-stroke-width') || 0\r\n            return original / currentZoom\r\n        })\r\n}\r\n\r\n// === Incoming Breakdown ===\r\nfunction getIncomingBreakdownByOrigin(nodeId, out) {\r\n    const topKeys = out.topLocationKeys\r\n    const type = out.flowTopLocationsType_\r\n    const includeInternal = out.flowInternal_\r\n\r\n    const breakdown = {}\r\n\r\n    // === Loop all links ===\r\n    for (const link of out.flowGraph_.links) {\r\n        const srcKey = link.source.id\r\n        const tgtKey = link.target.id\r\n\r\n        // We only care about links where this node is the TARGET (incoming flow)\r\n        if (tgtKey !== nodeId) continue\r\n\r\n        // Handle internal flow\r\n        if (srcKey === tgtKey) {\r\n            if (includeInternal) {\r\n                breakdown['Internal'] = (breakdown['Internal'] || 0) + link.value\r\n            }\r\n            continue // don't double-count self-link for origin/destination\r\n        }\r\n\r\n        let key\r\n\r\n        if (type === 'destination') {\r\n            // In destination mode: all incoming flows collapse into 1 slice for the node\r\n            key = nodeId\r\n        } else if (type === 'origin') {\r\n            // Show breakdown by origin\r\n            key = topKeys.has(srcKey) ? srcKey : 'Other'\r\n        } else {\r\n            // 'sum' mode: color by origin if it's a top location; otherwise fall back to this node\r\n            key = topKeys.has(srcKey) || topKeys.has(nodeId) ? (topKeys.has(srcKey) ? srcKey : nodeId) : 'Other'\r\n        }\r\n\r\n        breakdown[key] = (breakdown[key] || 0) + link.value\r\n    }\r\n\r\n    // Convert breakdown to array with colors\r\n    return sortBreakdown(\r\n        Object.entries(breakdown).map(([key, value]) => ({\r\n            key,\r\n            name: out.nodeNameMap?.get(key) || key, //  Human-readable name\r\n            value,\r\n            color: getSegmentColor(key, nodeId, out),\r\n        }))\r\n    )\r\n}\r\n\r\n// === Outgoing Breakdown ===\r\nfunction getOutgoingBreakdownByDestination(nodeId, out) {\r\n    const topKeys = out.topLocationKeys\r\n    const color = (key) => out.topLocationColorScale(key)\r\n    const type = out.flowTopLocationsType_\r\n    const includeInternal = out.flowInternal_\r\n\r\n    const breakdown = {}\r\n\r\n    for (const link of out.flowGraph_.links) {\r\n        const srcKey = link.source.id\r\n        const tgtKey = link.target.id\r\n\r\n        // Only consider links where this node is the SOURCE (outgoing flow)\r\n        if (srcKey !== nodeId) continue\r\n\r\n        // Handle internal flow\r\n        if (srcKey === tgtKey) {\r\n            if (includeInternal) {\r\n                breakdown['Internal'] = (breakdown['Internal'] || 0) + link.value\r\n            }\r\n            continue\r\n        }\r\n\r\n        let key\r\n\r\n        if (type === 'origin') {\r\n            // In origin mode: all outgoing flows collapse into 1 slice\r\n            key = nodeId\r\n        } else if (type === 'destination') {\r\n            // Show breakdown by destination if in topKeys\r\n            key = topKeys.has(tgtKey) ? tgtKey : 'Other'\r\n        } else {\r\n            // 'sum' mode: color by destination if top; otherwise fall back to this node\r\n            key = topKeys.has(tgtKey) || topKeys.has(nodeId) ? (topKeys.has(tgtKey) ? tgtKey : nodeId) : 'Other'\r\n        }\r\n\r\n        breakdown[key] = (breakdown[key] || 0) + link.value\r\n    }\r\n\r\n    // Convert to array with colors and sort\r\n    return sortBreakdown(\r\n        Object.entries(breakdown).map(([key, value]) => ({\r\n            key,\r\n            name: out.nodeNameMap?.get(key) || key, //  Human-readable name\r\n            value,\r\n            color: getSegmentColor(key, nodeId, out),\r\n        }))\r\n    )\r\n}\r\n\r\n// Keep your 'Other last' sorting\r\nfunction sortBreakdown(arr) {\r\n    return arr.sort((a, b) => {\r\n        // Always keep \"Other\" last\r\n        if (a.key === 'Other') return 1\r\n        if (b.key === 'Other') return -1\r\n\r\n        // Sort by numeric value descending\r\n        return b.value - a.value\r\n    })\r\n}\r\n\r\nfunction getSegmentColor(key, nodeId, out) {\r\n    const topKeys = out.topLocationKeys || new Set()\r\n    const colorScale = out.topLocationColorScale\r\n\r\n    if (key === 'Other') return '#666'\r\n    if (key === 'Internal') return topKeys.has(nodeId) ? colorScale(nodeId) : '#999'\r\n    return topKeys.has(key) ? colorScale(key) : '#666'\r\n}\r\n\r\nexport function computeDonutLocationStats(out) {\r\n    const statsByLoc = {}\r\n\r\n    for (const node of out.flowGraph_.nodes) {\r\n        statsByLoc[node.id] = {\r\n            x: node.x,\r\n            y: node.y,\r\n            incoming: 0,\r\n            outgoing: 0,\r\n            internal: 0,\r\n        }\r\n    }\r\n\r\n    for (const link of out.flowGraph_.links) {\r\n        const srcKey = link.source.id\r\n        const tgtKey = link.target.id\r\n\r\n        // Outgoing for source\r\n        if (statsByLoc[srcKey]) statsByLoc[srcKey].outgoing += link.value\r\n        // Incoming for target\r\n        if (statsByLoc[tgtKey]) statsByLoc[tgtKey].incoming += link.value\r\n        // Internal if same node\r\n        if (srcKey === tgtKey) statsByLoc[srcKey].internal += link.value\r\n    }\r\n\r\n    out.locationStats = statsByLoc\r\n}\r\nexport function computeDonutValues(out) {\r\n    const nodes = out.flowGraph_.nodes\r\n    const topKeys = out.topLocationKeys || new Set()\r\n    const colorScale = out.topLocationColorScale\r\n    const type = out.flowTopLocationsType_\r\n\r\n    for (const node of nodes) {\r\n        const valuesMap = new Map()\r\n        let internalFlowTotal = 0\r\n\r\n        // === Incoming flows (from others to this node)\r\n        for (const link of node.targetLinks) {\r\n            const sourceKey = link.source.id\r\n\r\n            if (sourceKey === node.id) {\r\n                // self-flow (internal)\r\n                if (out.flowInternal_) internalFlowTotal += link.value\r\n                continue\r\n            }\r\n\r\n            let key\r\n            if (type === 'origin') {\r\n                key = topKeys.has(sourceKey) ? sourceKey : 'Other'\r\n            } else if (type === 'destination') {\r\n                key = topKeys.has(node.id) ? node.id : 'Other' // target = this node\r\n            } else {\r\n                // sum: check both\r\n                key = topKeys.has(sourceKey) || topKeys.has(node.id) ? (topKeys.has(node.id) ? node.id : sourceKey) : 'Other'\r\n            }\r\n\r\n            valuesMap.set(key, (valuesMap.get(key) || 0) + link.value)\r\n        }\r\n\r\n        // === Outgoing flows (from this node to others)\r\n        for (const link of node.sourceLinks) {\r\n            const targetKey = link.target.id\r\n\r\n            if (targetKey === node.id) {\r\n                // self-flow (internal)\r\n                if (out.flowInternal_) internalFlowTotal += link.value\r\n                continue\r\n            }\r\n\r\n            let key\r\n            if (type === 'origin') {\r\n                key = topKeys.has(node.id) ? node.id : 'Other' // origin = this node\r\n            } else if (type === 'destination') {\r\n                key = topKeys.has(targetKey) ? targetKey : 'Other'\r\n            } else {\r\n                // sum: prefer destination if top\r\n                key = topKeys.has(targetKey) || topKeys.has(node.id) ? (topKeys.has(targetKey) ? targetKey : node.id) : 'Other'\r\n            }\r\n\r\n            valuesMap.set(key, (valuesMap.get(key) || 0) + link.value)\r\n        }\r\n\r\n        // === Convert to donutValues array with colors\r\n        node.donutValues = Array.from(valuesMap.entries()).map(([key, value]) => ({\r\n            label: key,\r\n            value,\r\n            color: getSegmentColor(key, node.id, out),\r\n        }))\r\n\r\n        // === Add internal flow slice if applicable\r\n        if (out.flowInternal_ && internalFlowTotal > 0) {\r\n            node.donutValues.push({\r\n                label: 'Internal',\r\n                value: internalFlowTotal,\r\n                color: '#999', // gray for internal flows\r\n            })\r\n        }\r\n    }\r\n}\r\n","import { max } from \"d3-array\"\r\nimport { scaleSqrt } from \"d3-scale\"\r\nimport { spaceAsThousandSeparator } from \"../../core/utils\"\r\nimport { create, select, selectAll } from 'd3-selection'\r\nimport { createSqrtScale } from \"../../core/scale\"\r\n\r\nfunction computeCircleLocationStats(out) {\r\n    const statsByLoc = {}\r\n\r\n    for (const node of out.flowGraph_.nodes) {\r\n        statsByLoc[node.id] = {\r\n            x: node.x,\r\n            y: node.y,\r\n            incoming: 0,\r\n            outgoing: 0,\r\n            internal: 0\r\n        }\r\n    }\r\n\r\n    for (const link of out.flowGraph_.links) {\r\n        const src = link.source.id\r\n        const tgt = link.target.id\r\n        const v = link.value || 0\r\n\r\n        // regular flows\r\n        if (statsByLoc[src]) statsByLoc[src].outgoing += v\r\n        if (statsByLoc[tgt]) statsByLoc[tgt].incoming += v\r\n\r\n        // internal flow (self-loop)\r\n        if (src === tgt) {\r\n            statsByLoc[src].internal += v\r\n        }\r\n    }\r\n\r\n    out.locationStats = statsByLoc\r\n}\r\n\r\n\r\nexport function drawNodeCircles(out, container) {\r\n    // make sure stats exist\r\n    if (!out.locationStats) computeCircleLocationStats(out)\r\n\r\n    const stats = out.locationStats\r\n    const includeInternal = out.flowInternal_\r\n\r\n    // compute totals per node\r\n    const totals = Object.values(stats).map(s =>\r\n        includeInternal\r\n            ? s.incoming + s.outgoing + s.internal\r\n            : s.incoming + s.outgoing\r\n    )\r\n\r\n    const maxValue = max(totals.length ? totals : [0])\r\n\r\n    // size scale\r\n    out._nodeSizeScale =\r\n        out.flowNodeSizeScale_ ||\r\n        createSqrtScale(totals, out.flowMaxNodeSize_ || 20, out.flowMinNodeSize_ || 0)\r\n\r\n    const circlesContainer = container\r\n        .append(\"g\")\r\n        .attr(\"class\", \"em-node-circles\")\r\n\r\n    // simple tooltip\r\n    function makeTooltip(locKey) {\r\n        const s = stats[locKey]\r\n        const incoming = s.incoming\r\n        const outgoing = s.outgoing\r\n        const internal = s.internal\r\n        const total = includeInternal ? incoming + outgoing + internal : incoming + outgoing\r\n\r\n        const unit = out.statData?.()?.unitText?.() || \"\"\r\n\r\n        return `\r\n            <div class=\"em-tooltip-bar\"><b>${out.nodeNameMap?.get(locKey) || locKey}</b></div>\r\n            <div class=\"em-tooltip-text\">\r\n                <table class=\"em-tooltip-table\"><tbody>\r\n                    <tr><td>Incoming:</td><td style=\"text-align:right\">${spaceAsThousandSeparator(incoming)}</td></tr>\r\n                    <tr><td>Outgoing:</td><td style=\"text-align:right\">${spaceAsThousandSeparator(outgoing)}</td></tr>\r\n                    ${includeInternal\r\n                ? `<tr><td>Internal:</td><td style=\"text-align:right\">${spaceAsThousandSeparator(internal)}</td></tr>`\r\n                : \"\"\r\n            }\r\n                    <tr class=\"em-tooltip-total\">\r\n                        <td colspan=\"2\" style=\"padding-top:4px;font-weight:bold;\">\r\n                            Total: ${spaceAsThousandSeparator(total)} ${unit}\r\n                        </td>\r\n                    </tr>\r\n                </tbody></table>\r\n            </div>\r\n        `\r\n    }\r\n\r\n    function nodeFill(id) {\r\n        // color by topLocations if present\r\n        if (out.topLocationKeys?.has(id)) {\r\n            return out.topLocationColorScale(id)\r\n        }\r\n        // fallback: global flow color or blue\r\n        if (typeof out.flowColor_ === \"string\") return out.flowColor_\r\n        return \"#2d50a0\"\r\n    }\r\n\r\n    // draw circles\r\n    Object.entries(stats).forEach(([locKey, s]) => {\r\n        const total = includeInternal\r\n            ? s.incoming + s.outgoing + s.internal\r\n            : s.incoming + s.outgoing\r\n\r\n        if (!total) return\r\n\r\n        const g = circlesContainer\r\n            .append(\"g\")\r\n            .attr(\"class\", \"em-node-circle-group\")\r\n            .attr(\"transform\", `translate(${s.x},${s.y})`)\r\n            .attr(\"data-id\", locKey)\r\n\r\n        const r = out._nodeSizeScale(total)\r\n\r\n        // main circle\r\n        g.append(\"circle\")\r\n            .attr(\"r\", r).attr(\"class\", \"em-node-circle\")\r\n            .attr(\"fill\", nodeFill(locKey))\r\n            .attr(\"stroke\", \"white\")\r\n            .attr(\"stroke-width\", 0.5)\r\n            .style(\"cursor\", \"pointer\")\r\n            .on(\"mouseover\", function (event) {\r\n                select(this).attr(\"stroke-width\", 1.5)\r\n                if (out._tooltip) out._tooltip.mouseover(makeTooltip(locKey))\r\n                highlightLines(locKey)\r\n            })\r\n            .on(\"mouseout\", function(event)  {\r\n                select(this).attr(\"stroke-width\", 0.5)\r\n                if (out._tooltip) out._tooltip.mouseout(event)\r\n                unhighlightLines()\r\n            })\r\n            .on(\"mousemove\", event => {\r\n                if (out._tooltip) out._tooltip.mousemove(event)\r\n            })\r\n\r\n    })\r\n}\r\n\r\nfunction highlightLines(nodeId) {\r\n  if (!nodeId) return;\r\n\r\n  selectAll('.em-flow-link, .em-flow-link-bundled')\r\n    .classed('highlighted', function () {\r\n      const o = this.getAttribute('data-origin');\r\n      const d = this.getAttribute('data-dest');\r\n      return o === nodeId || d === nodeId;\r\n    })\r\n    .classed('dimmed', function () {\r\n      const o = this.getAttribute('data-origin');\r\n      const d = this.getAttribute('data-dest');\r\n      return !(o === nodeId || d === nodeId);\r\n    });\r\n}\r\n\r\nfunction unhighlightLines() {\r\n  selectAll('.em-flow-link, .em-flow-link-bundled')\r\n    .classed('highlighted', false)\r\n    .classed('dimmed', false);\r\n}","// Import required D3 modules\r\n// import { sankey, sankeyLinkHorizontal } from 'd3-sankey'\r\n\r\nimport { min, max } from 'd3-array'\r\nimport { scaleLinear } from 'd3-scale'\r\nimport * as StatMap from '../../core/stat-map'\r\nimport * as FlowLegend from '../../legend/flow/legend-flow'\r\nimport { select } from 'd3-selection'\r\nimport { createSankeyFlowMap } from './sankey'\r\nimport { getRegionsSelector, spaceAsThousandSeparator } from '../../core/utils'\r\nimport { createFlowMap } from './straight'\r\nimport { drawNodeDonuts } from './donuts'\r\nimport { drawNodeCircles } from './circles'\r\nimport { scaleOrdinal } from 'd3-scale'\r\nimport { addFlowValueLabels } from '../../core/labels'\r\n\r\n\r\n/**\r\n * Returns a flow map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, true, 'flow')\r\n    out.strokeWidthScale = null // function to scale flow widths    \r\n\r\n    // override tooltip function\r\n    out.tooltip_.textFunction = flowMapTooltipFunction\r\n\r\n    // flow type settings\r\n    out.flowLineType_ = 'curved' // type of flow map values: curved || straight\r\n    out.flowBidirectional_ = true // Whether flows should be bidirectional (true) or unidirectional (false). If there are flows to and from 2 nodes and flowBidirectional is set to false, then these flows will be merged into one line.\r\n    out.flowStack_ = true // stack flows at origin/destination for sankeys (set to false for flows to be drawn on top of each other at origin/destination)\r\n    out.flowEdgeBundling_ = false // whether to use edge bundling for curved flow lines\r\n    out.flowCurvatureSettings_ = {\r\n        gapX: 10,        // how far before/after node to begin/end curve\r\n        padX: 2,         // horizontal clearance near node stems\r\n        padY: 2,         // vertical collision detection padding\r\n        bumpY: 1,        // extra height for hop\r\n        curvature: 0.5   // 0..1; default sankey smoothness\r\n    };\r\n\r\n    //out.flowThicknessType_ = 'linear' // gradual?\r\n    out.flowColor_ = '#848484ff'\r\n    out.flowRegionColors_ = ['#bbd7ee', '#c7e3c6'] // net exporter, net importers\r\n    out.flowRegionLabels_ = ['Exporter', 'Importer']\r\n    out.flowMaxWidth_ = 30\r\n    out.flowMinWidth_ = 1\r\n    out.flowArrows_ = true\r\n    out.flowArrowScale_ = 0.7 // scale of arrow markers\r\n    out.flowOutlines_ = true\r\n    out.flowOutlineWidth_ = 1.2 // width of outline around flow lines\r\n    out.flowOutlineColor_ = '#ffffff' // color of outline around flow lines\r\n    out.flowLabelOffsets_ = { x: 3, y: 0 } // Offsets for flow labels\r\n    out.flowOpacity_ = 0.5 // Default opacity for flow lines\r\n\r\n\r\n    out.flowOrder_ = (a, b) => {\r\n        const dy = a.otherY - b.otherY;          // primary: other end vertical position\r\n        if (dy) return dy;\r\n        if (a.at !== b.at) return a.at === \"out\" ? -1 : 1;  // outgoing above incoming on ties\r\n        const dv = (b.link.value ?? 0) - (a.link.value ?? 0); // larger value above\r\n        if (dv) return dv;\r\n        return String(a.link.id ?? '').localeCompare(String(b.link.id ?? '')); // stable\r\n    }; //use a custom order function for the flows at nodes\r\n\r\n    //add proportional symbols to nodes\r\n    out.flowNodes_ = false // whether to draw proportional symbols at flow nodes\r\n    out.flowNodeType_ = 'circle' // 'circle' || 'donut' (total count only vs inbound/outbound)\r\n    out.flowMinNodeSize_ = 3 // min size for node symbols\r\n    out.flowMaxNodeSize_ = 10 // max size for node symbols\r\n    out.flowNodeSizeScale_ = null // custom size scale for nodes\r\n\r\n    // include internal flow\r\n    out.flowInternal_ = true // Whether to include internal flows in donuts\r\n\r\n    // top N coloring\r\n    out.flowTopLocations_ = 0 // Number of top locations to colour categorically. currently only for flowLineType_ 'straight'. Set to 0 to disable.\r\n    out.flowTopLocationsType_ = 'destination' // 'sum' | 'origin' | 'destination' top locations can be defined by sum of flows or by origin or destination\r\n\r\n    // gradients\r\n    out.flowColorGradient_ = false // color at origin to color at destination\r\n    out.flowOpacityGradient_ = false // 0 origin to 1 at destination\r\n    out.flowWidthGradient_ = false // thin at origin to thick at destination\r\n    out.flowWidthGradientSettings_ = {\r\n        startRatio: 0.25,   // starting thickness (as a fraction of final width)\r\n        samples: 48,        // number of resampled points along path (smoothness)\r\n        minStartWidth: 1.5, // ensures very thin flows don't taper to zero\r\n        capEnd: true,       // closes the end cleanly (flat tail)\r\n        curvatureFollow: true // keeps offset normal perpendicular to local tangent\r\n    };\r\n    out.flowBundleSettings_ = {\r\n        alphaDecay: 0.1,\r\n        chargeStrength: 10,\r\n        distanceMax: null, // if null, will default to twice the max dimension of the map\r\n        linkStrength: 0.7,\r\n        linkIterations: 1\r\n    };\r\n\r\n    /**\r\n     * flowmap-specific setters/getters\r\n     */\r\n    const paramNames = [\r\n        'flowGraph_',\r\n        'flowColor_',\r\n        'flowRegionColors_',\r\n        'flowRegionLabels_',\r\n        'flowArrows_',\r\n        'flowArrowScale_',\r\n        'flowMaxWidth_',\r\n        'flowMinWidth_',\r\n        'flowOutlines_',\r\n        'flowOutlineWidth_',\r\n        'flowOutlineColor_',\r\n        'flowColorGradient_',\r\n        'flowStack_',\r\n        'flowNodes_',\r\n        'flowNodeType_',\r\n        'flowLabelOffsets_',\r\n        'flowLineType_',\r\n        'flowNodeSizeScale_',\r\n        'flowOpacity_',\r\n        'flowInternal_',\r\n        'flowTopLocations_',\r\n        'flowTopLocationsType_',\r\n        'flowCurvatureSettings_',\r\n        'flowOrder_',\r\n        'flowWidthGradient_',\r\n        'flowOpacityGradient_',\r\n        'flowWidthGradientSettings_',\r\n        'flowBidirectional_',\r\n        'flowEdgeBundling_',\r\n        'flowBundleSettings_'\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        // if donuts are enabled, flows must have categorical colors\r\n        if (out.flowNodes_ && out.flowNodeType_ === 'donut' && out.flowTopLocations_ == 0) {\r\n            out.flowTopLocations_ = 4 // force top locations to enable categorical coloring\r\n        }\r\n\r\n        // some pre-calculations\r\n        prepareFlowGraph(out)\r\n\r\n        // update stroke width function\r\n        defineWidthScale(out)\r\n\r\n        // Define our container SVG\r\n        const zoomGroup = select('#em-zoom-group-' + out.svgId_);\r\n\r\n        // Try to select existing container\r\n        let flowContainer = zoomGroup.select('#em-flow-container');\r\n\r\n        // If it doesn't exist, create it\r\n        if (flowContainer.empty()) {\r\n            flowContainer = zoomGroup\r\n                .append('g')\r\n                .attr('id', 'em-flow-container')\r\n                .attr('class', 'em-flow-container');\r\n        } else {\r\n            // If it exists, clear existing contents\r\n            flowContainer.selectAll('*').remove();\r\n        }\r\n\r\n        //hacky: move it up one so that it is above the regions but below the labels\r\n        const node = flowContainer.node();\r\n        if (node && node.previousSibling) {\r\n            node.parentNode?.insertBefore(node, node.previousSibling);\r\n        }\r\n\r\n        // Show importer/exporter regions by coloring them\r\n        addOverlayPolygons(out)\r\n\r\n        if (out.flowLineType_ === 'curved' || out.flowLineType_ === 'sankey') {\r\n            // Create the sankey layout\r\n            createSankeyFlowMap(out, flowContainer)\r\n        } else {\r\n            // Draw straight lines by flow\r\n            createFlowMap(out, flowContainer)\r\n        }\r\n\r\n        // draw nodes\r\n        if (out.flowNodes_) {\r\n            if (out.flowNodeType_ === 'donut') {\r\n                drawNodeDonuts(out, flowContainer)\r\n            } else {\r\n                drawNodeCircles(out, flowContainer)\r\n            }\r\n        }\r\n\r\n        // Add labels to nodes\r\n        if (out.labels_?.values) {\r\n            const zoomGroup = out.svg().select('#em-zoom-group-' + out.svgId_)\r\n            addFlowValueLabels(out, zoomGroup)\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () { }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        //TODO: define legend\r\n        return FlowLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\nfunction defineWidthScale(out) {\r\n    const data = out.flowGraph_.links\r\n    // data: array of links with .value\r\n    const positives = data.map(d => d.value).filter(v => v > 0);\r\n    const upper = max(positives);\r\n    const smallestPositive = min(positives);\r\n\r\n    // visual params\r\n    const minW = Math.max(0, out.flowMinWidth_ || 0); // visible floor (px)\r\n    const maxW = out.flowMaxWidth_;                   // max stroke width (px)\r\n\r\n    // Base linear scale for positives only\r\n    const base = scaleLinear()\r\n        .domain([0, upper])\r\n        .range([0, maxW])\r\n        .clamp(true);\r\n\r\n\r\n    // Final classifier, force min width\r\n    const strokeWidthScale = (v) => {\r\n        const x = +v;\r\n        if (!Number.isFinite(x) || x <= 0) return 0;\r\n        return Math.max(minW, base(x));\r\n    };\r\n\r\n    // Optional: expose domain method to be compatible with legacy code\r\n    strokeWidthScale.domain = (...args) => {\r\n        if (args.length) { base.domain(...args); return strokeWidthScale; }\r\n        return base.domain();\r\n    };\r\n\r\n    out.strokeWidthScale = strokeWidthScale;\r\n}\r\n\r\nfunction prepareFlowGraph(out) {\r\n    // if nodes in the graph dont have coordinates specified by the user then use nuts2json centroids instead\r\n    addCoordinatesToGraph(out)\r\n    projectAllNodeCoordinates(out)\r\n    calculateNodeTotals(out)\r\n    computeNodeLinks(out)\r\n    if (out.flowTopLocations_) computeTopFlowLocations(out) // compute top locations based on user-selected type\r\n    computeMaxMinFlowCounts(out)\r\n\r\n    out.nodeNameMap = new Map(out.flowGraph_.nodes.map((n) => [n.id, n.name || n.id]))\r\n}\r\n\r\nfunction computeMaxMinFlowCounts(out) {\r\n    const values = out.flowGraph_.links.map((l) => l.value).filter((v) => v > 0)\r\n    out.maxFlowCount = values.length ? max(values) : 0\r\n    out.minFlowCount = values.length ? min(values) : 0\r\n}\r\n\r\n/**\r\n * Compute top N flow locations based on user-selected type:\r\n *  - 'sum'         => incoming + outgoing\r\n *  - 'origin'      => outgoing only\r\n *  - 'destination' => incoming only\r\n *\r\n * Updates:\r\n *   out.topLocationKeys (Set of IDs)\r\n *   out.topLocationColorScale (Ordinal scale for coloring)\r\n */\r\nfunction computeTopFlowLocations(out) {\r\n    const nodes = out.flowGraph_.nodes\r\n    const topN = out.flowTopLocations_\r\n    const topType = out.flowTopLocationsType_ || 'sum'\r\n\r\n    // Calculate score for each node based on selected type\r\n    nodes.forEach((node) => {\r\n        const outgoing = node.sourceLinks.reduce((sum, l) => sum + l.value, 0)\r\n        const incoming = node.targetLinks.reduce((sum, l) => sum + l.value, 0)\r\n\r\n        if (topType === 'origin') {\r\n            node.topScore = outgoing\r\n        } else if (topType === 'destination') {\r\n            node.topScore = incoming\r\n        } else {\r\n            node.topScore = outgoing + incoming\r\n        }\r\n    })\r\n\r\n    // Sort by score descending and select top N\r\n    const topLocations = [...nodes].sort((a, b) => b.topScore - a.topScore).slice(0, topN)\r\n\r\n    // Save results\r\n    out.topLocationKeys = new Set(topLocations.map((loc) => loc.id))\r\n\r\n    // Assign colors to top locations\r\n    out.topLocationColorScale = scaleOrdinal()\r\n        .domain(topLocations.map((d) => d.id))\r\n        .range([\r\n            '#00B3E3', // bright turquoise\r\n            '#FBBA00', // golden yellow\r\n            '#2BA966', // medium green\r\n            '#D23142', // red pink\r\n            '#005289', // deep blue\r\n            '#93397F', // deep mauve\r\n            '#E73E11', // bright red orange\r\n            '#4E4084', // muted purple\r\n            '#056731', // dark green\r\n            '#00667E', // teal blue\r\n            '#B5B900', // light green\r\n        ])\r\n}\r\n\r\n// if nodes in the graph dont have coordinates specified by the user then use nuts2json centroids instead\r\nfunction addCoordinatesToGraph(out) {\r\n    out.flowGraph_.nodes.forEach((node) => {\r\n        if (typeof node.x !== 'number' || typeof node.y !== 'number') {\r\n            if (out.Geometries.centroidsFeatures) {\r\n                const centroid = out.Geometries.centroidsFeatures.find((feature) => {\r\n                    return node.id == feature.properties.id\r\n                })\r\n                if (centroid) {\r\n                    const [x, y] = centroid.geometry.coordinates\r\n                    node.x = x\r\n                    node.y = y\r\n                } else {\r\n                    console.error('could not find coordinates for', node.id)\r\n                }\r\n            } else {\r\n                const features = out.Geometries.getRegionFeatures?.()\r\n                const feature = features?.find((f) => f.properties.id === node.id)\r\n                const centroid = feature?.properties?.centroid || out._pathFunction.centroid(feature)\r\n                const [x, y] = centroid\r\n                node.x = x\r\n                node.y = y\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nfunction projectAllNodeCoordinates(out) {\r\n    const nodes = out.flowGraph_.nodes\r\n    for (const node of nodes) {\r\n        const screenCoords = out._projection([node.x, node.y])\r\n        node.x = screenCoords[0]\r\n        node.y = screenCoords[1]\r\n    }\r\n}\r\n\r\nexport function computeNodeLinks(out) {\r\n    const nodes = out.flowGraph_.nodes\r\n    const links = out.flowGraph_.links\r\n    const id = (d) => d.id\r\n    for (const [i, node] of nodes.entries()) {\r\n        node.index = i\r\n        node.sourceLinks = []\r\n        node.targetLinks = []\r\n    }\r\n    const nodeById = new Map(nodes.map((d, i) => [id(d, i, nodes), d]))\r\n    for (const [i, link] of links.entries()) {\r\n        link.index = i\r\n        let { source, target } = link\r\n        if (typeof source !== 'object') source = link.source = find(nodeById, source)\r\n        if (typeof target !== 'object') target = link.target = find(nodeById, target)\r\n        source.sourceLinks.push(link)\r\n        target.targetLinks.push(link)\r\n    }\r\n}\r\n\r\nfunction find(nodeById, id) {\r\n    const node = nodeById.get(id)\r\n    if (!node) throw new Error('missing: ' + id)\r\n    return node\r\n}\r\n\r\nfunction calculateNodeTotals(out) {\r\n    // Sum values for each node\r\n    const { nodes, links } = out.flowGraph_\r\n    const nodeTotals = new Map()\r\n    links.forEach((link) => {\r\n        nodeTotals.set(link.source, (nodeTotals.get(link.source) || 0) + link.value)\r\n        nodeTotals.set(link.target, (nodeTotals.get(link.target) || 0) + link.value)\r\n    })\r\n\r\n    // Add the totals to nodes\r\n    nodes.forEach((node) => {\r\n        node.value = nodeTotals.get(node.id) || 0\r\n    })\r\n}\r\n\r\n/**\r\n * Adds geographical layers (regions, POI overlay, borders)\r\n */\r\nfunction addOverlayPolygons(out) {\r\n    const graph = out.flowGraph_\r\n    const importerIds = []\r\n    const exporterIds = []\r\n    const features = out.Geometries.getRegionFeatures()\r\n\r\n    if (!features) return\r\n\r\n    graph.nodes.forEach((node) => {\r\n        // Compute totals for this node\r\n        const outgoing = node.sourceLinks.reduce((sum, l) => sum + l.value, 0)\r\n        const incoming = node.targetLinks.reduce((sum, l) => sum + l.value, 0)\r\n\r\n        // Skip nodes that aren't in the geometry features\r\n        const overlay = features.find((f) => f.properties.id === node.id)\r\n        if (!overlay) {\r\n            console.log('could not find region geometry for', node.id)\r\n            return\r\n        }\r\n\r\n        // Classify based on net flow\r\n        if (incoming > outgoing) {\r\n            importerIds.push(node.id)\r\n        } else if (outgoing > incoming) {\r\n            exporterIds.push(node.id)\r\n        }\r\n        // optional: else neither if incoming == outgoing\r\n    })\r\n\r\n    out.importerRegionIds = importerIds\r\n    out.exporterRegionIds = exporterIds\r\n\r\n    if (importerIds.length === 0 && exporterIds.length === 0) {\r\n        console.log('No importer or exporter regions found in the flow graph.')\r\n        return\r\n    }\r\n\r\n    // Update region fills and classes\r\n    const selector = getRegionsSelector(out)\r\n    const allRegions = out.svg_.selectAll(selector)\r\n\r\n    allRegions.each(function () {\r\n        const id = this.__data__.properties.id\r\n        select(this)\r\n            .style('fill', () => {\r\n                if (importerIds.includes(id)) return out.flowRegionColors_[1] // net importer color\r\n                if (exporterIds.includes(id)) return out.flowRegionColors_[0] // net exporter color\r\n                return null\r\n            })\r\n            .attr('class', () => {\r\n                if (importerIds.includes(id)) return 'em-flow-importer'\r\n                if (exporterIds.includes(id)) return 'em-flow-exporter'\r\n                return null\r\n            })\r\n    })\r\n}\r\n\r\n\r\n\r\nconst flowMapTooltipFunction = function (link, map) {\r\n    const buf = [];\r\n    const statData = map.statData();\r\n    const unit = statData.unitText() || '';\r\n\r\n    // ---- FIX: determine true origin/destination for split flows ----\r\n    const originId =\r\n        link.originId ??\r\n        (link.source.isMidpoint ? null : link.source.id);\r\n\r\n    const destId =\r\n        link.destId ??\r\n        (link.target.isMidpoint ? null : link.target.id);\r\n\r\n    const nodeById = map._nodeById || new Map();\r\n\r\n    const originNode = nodeById.get(originId) || { id: originId, name: originId };\r\n    const destNode = nodeById.get(destId) || { id: destId, name: destId };\r\n\r\n    const originName = originNode.name || originNode.id;\r\n    const destName = destNode.name || destNode.id;\r\n\r\n    // Header\r\n    const title = `${originName} to ${destName}`;\r\n    buf.push(`\r\n        <div class=\"em-tooltip-bar\">\r\n            <b>${title}</b>\r\n        </div>\r\n    `);\r\n\r\n    // Value\r\n    buf.push(`\r\n        <div class='em-tooltip-text'>\r\n            <table class=\"em-tooltip-table\">\r\n                <tbody>\r\n                    <tr><td>${spaceAsThousandSeparator(link.value)} ${unit}</td></tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    `);\r\n\r\n    return buf.join('');\r\n};\r\n","import continuous from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport {linearish} from \"./linear.js\";\nimport number from \"./number.js\";\n\nfunction square(x) {\n  return Math.sign(x) * x * x;\n}\n\nfunction unsquare(x) {\n  return Math.sign(x) * Math.sqrt(Math.abs(x));\n}\n\nexport default function radial() {\n  var squared = continuous(),\n      range = [0, 1],\n      round = false,\n      unknown;\n\n  function scale(x) {\n    var y = unsquare(squared(x));\n    return isNaN(y) ? unknown : round ? Math.round(y) : y;\n  }\n\n  scale.invert = function(y) {\n    return squared.invert(square(y));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (squared.domain(_), scale) : squared.domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (squared.range((range = Array.from(_, number)).map(square)), scale) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return scale.range(_).round(true);\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, scale) : round;\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (squared.clamp(_), scale) : squared.clamp();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return radial(squared.domain(), range)\n        .round(round)\n        .clamp(squared.clamp())\n        .unknown(unknown);\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n","export default function(series, order) {\n  if (!((n = series.length) > 1)) return;\n  for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {\n    s0 = s1, s1 = series[order[i]];\n    for (j = 0; j < m; ++j) {\n      s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];\n    }\n  }\n}\n","export default function(series) {\n  var n = series.length, o = new Array(n);\n  while (--n >= 0) o[n] = n;\n  return o;\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport offsetNone from \"./offset/none.js\";\nimport orderNone from \"./order/none.js\";\n\nfunction stackValue(d, key) {\n  return d[key];\n}\n\nfunction stackSeries(key) {\n  const series = [];\n  series.key = key;\n  return series;\n}\n\nexport default function() {\n  var keys = constant([]),\n      order = orderNone,\n      offset = offsetNone,\n      value = stackValue;\n\n  function stack(data) {\n    var sz = Array.from(keys.apply(this, arguments), stackSeries),\n        i, n = sz.length, j = -1,\n        oz;\n\n    for (const d of data) {\n      for (i = 0, ++j; i < n; ++i) {\n        (sz[i][j] = [0, +value(d, sz[i].key, j, data)]).data = d;\n      }\n    }\n\n    for (i = 0, oz = array(order(sz)); i < n; ++i) {\n      sz[oz[i]].index = i;\n    }\n\n    offset(sz, oz);\n    return sz;\n  }\n\n  stack.keys = function(_) {\n    return arguments.length ? (keys = typeof _ === \"function\" ? _ : constant(Array.from(_)), stack) : keys;\n  };\n\n  stack.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), stack) : value;\n  };\n\n  stack.order = function(_) {\n    return arguments.length ? (order = _ == null ? orderNone : typeof _ === \"function\" ? _ : constant(Array.from(_)), stack) : order;\n  };\n\n  stack.offset = function(_) {\n    return arguments.length ? (offset = _ == null ? offsetNone : _, stack) : offset;\n  };\n\n  return stack;\n}\n","import { format } from 'd3-format'\r\nimport { select } from 'd3-selection'\r\nimport { max } from 'd3-array'\r\nimport * as Legend from './legend'\r\nimport { executeForAllInsets, getFontSizeFromClass } from '../core/utils'\r\nimport { arc } from 'd3-shape'\r\nimport { drawCircleSizeLegend } from './legend-circle-size'\r\n\r\n/**\r\n * Legend for Coxcomb (polar area) maps\r\n *\r\n * @param {*} map\r\n */\r\nexport const legend = function (map, config) {\r\n    const out = Legend.legend(map)\r\n\r\n    out.sizeLegend = {\r\n        title: null,\r\n        titlePadding: 15,\r\n        values: null,\r\n    }\r\n\r\n    out.colorLegend = {\r\n        title: null,\r\n        titlePadding: 15,\r\n        marginTop: 23,\r\n        labelOffsets: { x: 5, y: 5 },\r\n        shapeWidth: 25,\r\n        shapeHeight: 20,\r\n        shapePadding: 1,\r\n        noData: true,\r\n        noDataText: 'No data',\r\n    }\r\n\r\n    out.timeLegend = {\r\n        title: null,\r\n        marginTop: 20,\r\n    }\r\n\r\n    out._sizeLegendHeight = 0\r\n\r\n    if (config) {\r\n        for (let key in config) {\r\n            if (key === 'colorLegend' || key === 'sizeLegend' || key === 'timeLegend') {\r\n                for (let p in out[key]) {\r\n                    if (config[key][p] !== undefined) out[key][p] = config[key][p]\r\n                }\r\n            } else {\r\n                out[key] = config[key]\r\n            }\r\n        }\r\n    }\r\n\r\n    //@override\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        const lgg = out.lgg\r\n        lgg.selectAll('*').remove()\r\n\r\n        out.makeBackgroundBox()\r\n\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        const baseY = out.getBaseY()\r\n        const baseX = out.getBaseX()\r\n\r\n        if (map.classifierSize_) {\r\n            const container = lgg.append('g').attr('class', 'em-coxcomb-size-legend').attr('transform', `translate(${baseX}, ${baseY})`)\r\n            out._sizeLegendContainer = container\r\n            drawCircleSizeLegend(out, container, out.sizeLegend.values, out.map.classifierSize_, out.sizeLegend.title, out.sizeLegend.titlePadding)\r\n        }\r\n\r\n        buildColorLegend(out, baseX, baseY)\r\n\r\n        buildCoxcombTimeLegend(out, baseX, baseY)\r\n\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    function buildColorLegend(out, baseX, baseY) {\r\n        const map = out.map\r\n        const config = out.colorLegend\r\n        out._colorLegendContainer = out.lgg.append('g').attr('class', 'em-coxcomb-color-legend')\r\n\r\n        let sizeLegendHeight = 0\r\n        if (out._sizeLegendContainer) {\r\n            sizeLegendHeight = out._sizeLegendContainer.node().getBBox().height\r\n            out._colorLegendContainer.attr('transform', `translate(${baseX},${sizeLegendHeight + out.colorLegend.marginTop})`)\r\n        } else {\r\n            out._colorLegendContainer.attr('transform', `translate(${baseX},${baseY})`)\r\n        }\r\n\r\n        if (config.title) {\r\n            out._colorLegendContainer\r\n                .append('text')\r\n                .attr('class', 'em-color-legend-title')\r\n                .attr('id', 'em-color-legend-title')\r\n                .attr('x', 0)\r\n                .attr('y', out.titleFontSize)\r\n                .text(config.title)\r\n        }\r\n\r\n        let i = 0\r\n        const scs = map.catColors()\r\n        for (let code in scs) {\r\n            const y = out.colorLegend.titlePadding + (config.title ? out.titleFontSize : 0) + i * (config.shapeHeight + config.shapePadding)\r\n            const col = map.catColors()[code] || 'lightgray'\r\n\r\n            out._colorLegendContainer\r\n                .append('rect')\r\n                .attr('class', 'em-legend-rect')\r\n                .attr('x', 0)\r\n                .attr('y', y)\r\n                .attr('width', config.shapeWidth)\r\n                .attr('height', config.shapeHeight)\r\n                .style('fill', col)\r\n                .on('mouseover', function () {\r\n                    highlightRegions(out.map, code)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, highlightRegions, code)\r\n                    }\r\n                })\r\n                .on('mouseout', function () {\r\n                    unhighlightRegions(out.map)\r\n                    if (out.map.insetTemplates_) {\r\n                        executeForAllInsets(out.map.insetTemplates_, out.map.svgId, unhighlightRegions, code)\r\n                    }\r\n                })\r\n\r\n            out._colorLegendContainer\r\n                .append('text')\r\n                .attr('class', 'em-legend-label')\r\n                .attr('x', config.shapeWidth + config.labelOffsets.x)\r\n                .attr('y', y + config.shapeHeight * 0.5)\r\n                .attr('dy', '0.35em')\r\n                .text(map.catLabels()[code] || code)\r\n\r\n            i++\r\n        }\r\n\r\n        if (config.noData) {\r\n            const y =\r\n                sizeLegendHeight +\r\n                out.colorLegend.marginTop +\r\n                out.colorLegend.titlePadding +\r\n                (config.title ? out.titleFontSize + out.boxPadding : 0) +\r\n                i * config.shapeHeight +\r\n                i * config.shapePadding\r\n            const container = out.lgg.append('g').attr('class', 'em-no-data-legend').attr('transform', `translate(${out.boxPadding},${y})`)\r\n            out.appendNoDataLegend(container, out.noDataText, highlightRegions, unhighlightRegions)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds a Coxcomb time-segment legend showing how wedges represent periods of time.\r\n     * Labels each segment (e.g., Jan, Feb) around the circle.\r\n     */\r\n    function buildCoxcombTimeLegend(out, baseX, baseY) {\r\n        const times = out.map._coxTimes || []\r\n        const radius = 40\r\n\r\n        if (!times.length) return\r\n\r\n        let y = baseY\r\n        let x = baseX\r\n\r\n        if (out._sizeLegendContainer) {\r\n            y += out._sizeLegendContainer.node().getBBox().height\r\n        }\r\n        if (out._colorLegendContainer) {\r\n            y += out._colorLegendContainer.node().getBBox().height\r\n            y += out.colorLegend.marginTop || 0\r\n        }\r\n\r\n        y += out.timeLegend?.marginTop || 0\r\n        y += radius\r\n\r\n        const labelOffset = 18 // extra spacing for labels\r\n        const angleStep = (2 * Math.PI) / times.length\r\n\r\n        const colorLegendWidth = out._colorLegendContainer?.node()?.getBBox().width || 0\r\n        const centerX = x + colorLegendWidth / 2 + labelOffset\r\n\r\n        const container = out.lgg\r\n            .append('g')\r\n            .attr('class', 'em-coxcomb-time-legend')\r\n            .attr('transform', `translate(${centerX}, ${y + radius})`)\r\n\r\n        const arcGen = arc()\r\n            .innerRadius(0)\r\n            .outerRadius(radius)\r\n            .startAngle((d, i) => i * angleStep)\r\n            .endAngle((d, i) => (i + 1) * angleStep)\r\n\r\n        // Draw faint wedges\r\n        container\r\n            .selectAll('path')\r\n            .data(times)\r\n            .join('path')\r\n            .attr('d', (d, i) => arcGen(d, i))\r\n            .attr('fill', '#ccc')\r\n            .attr('class', 'em-coxcomb-legend-time-segment')\r\n\r\n        const labelRadius = radius + labelOffset\r\n        const timeAbbr = map._coxTimeLabels\r\n            ? map._coxTimeLabels\r\n            : ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\r\n\r\n        // Place horizontal labels around the circle (no flipping)\r\n        container\r\n            .selectAll('text.em-coxcomb-legend-time-label')\r\n            .data(times)\r\n            .join('text')\r\n            .attr('class', 'em-legend-label em-coxcomb-legend-time-label')\r\n            .attr('x', (d, i) => Math.sin(i * angleStep + angleStep / 2) * labelRadius)\r\n            .attr('y', (d, i) => -Math.cos(i * angleStep + angleStep / 2) * labelRadius)\r\n            .attr('text-anchor', 'middle')\r\n            .attr('alignment-baseline', 'middle')\r\n            .text((d, i) => {\r\n                return timeAbbr[i] || d\r\n            })\r\n\r\n        // Highlight behavior for time hover\r\n        container\r\n            .selectAll('path')\r\n            .on('mouseover', function (event, time) {\r\n                const hoveredTime = time // \"YYYY-MM\" format\r\n                const mapSvg = out.map.svg_ || out.map.svg()\r\n                const allSegments = mapSvg.selectAll('.em-coxcomb-chart path')\r\n\r\n                allSegments.style('opacity', (d) => {\r\n                    return d.data.month === hoveredTime ? 1 : 0\r\n                })\r\n                select(this).style('stroke-width', 3).style('opacity', 0.8).raise()\r\n            })\r\n            .on('mouseout', function () {\r\n                const mapSvg = out.map.svg_ || out.map.svg()\r\n                mapSvg.selectAll('.em-coxcomb-chart path').style('opacity', 1)\r\n                select(this).style('stroke-width', 0.5).style('opacity', 0.4).raise()\r\n            })\r\n    }\r\n\r\n    function highlightRegions(map, code) {\r\n        const allSegments = map.svg_.selectAll('.em-coxcomb-chart').selectAll('path[code]')\r\n        allSegments.style('fill', 'white')\r\n        const selected = allSegments.filter(\"path[code='\" + code + \"']\")\r\n        selected.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___'))\r\n        })\r\n    }\r\n\r\n    function unhighlightRegions(map) {\r\n        const allSegments = map.svg_.selectAll('.em-coxcomb-chart').selectAll('path[code]')\r\n        allSegments.each(function () {\r\n            select(this).style('fill', select(this).attr('fill___'))\r\n        })\r\n    }\r\n\r\n    return out\r\n}\r\n","import { scaleSqrt, scaleBand, scaleRadial, scaleLinear } from 'd3-scale'\r\nimport { select } from 'd3-selection'\r\nimport { arc, stack } from 'd3-shape'\r\nimport { extent, max, min } from 'd3-array'\r\nimport { schemeCategory10 } from 'd3-scale-chromatic'\r\nimport * as StatMap from '../core/stat-map'\r\nimport { executeForAllInsets, getRegionsSelector, spaceAsThousandSeparator } from '../core/utils'\r\nimport * as CoxcombLegend from '../legend/legend-coxcomb'\r\nimport { interpolate } from 'd3-interpolate'\r\nimport { runDorlingSimulation, stopDorlingSimulation } from '../core/dorling/dorling'\r\n\r\n/**\r\n * Returns a coxcomb (polar area) chart map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    const out = StatMap.statMap(config, true, 'coxcomb')\r\n\r\n    out.coxcombMinRadius_ = 10\r\n    out.coxcombMaxRadius_ = 80\r\n    out.coxcombStrokeFill_ = 'white'\r\n    out.coxcombStrokeWidth_ = 0.3\r\n    out.coxcombRings_ = true // Show outer rings by default\r\n\r\n    out.hoverColor_ = '#000'\r\n\r\n    out.catColors_ = undefined\r\n    out.catLabels_ = undefined\r\n    out.classifierSize_ = null\r\n    const paramNames = [\r\n        'catColors_',\r\n        'catLabels_',\r\n        'noDataFillStyle_',\r\n        'coxcombMaxRadius_',\r\n        'coxcombMinRadius_',\r\n        'coxcombRings_',\r\n        'coxcombStrokeFill_',\r\n        'coxcombStrokeWidth_',\r\n        'hoverColor_',\r\n        'classifierSize_'\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    out.statCodes_ = undefined\r\n    out.totalCode_ = undefined\r\n\r\n    // Helper for Eurostat datasets (like statSpark or statPie)\r\n    // .statCoxcomb({\r\n    //     filters: {\r\n    //       //data/tour_occ_nin2m?format=JSON&unit=NR&c_resid=TOTAL&nace_r2=I551-I553&month=M01&lang=EN\r\n    //       eurostatDatasetCode: \"tour_occ_nin2m\",\r\n    //       filters: { unit: \"NR\", nace_r2: \"I551-I553\", TIME: 2022 }, // shared filters\r\n    //       unitText: \"Nights spent\",\r\n    //     },\r\n    //     timeParameter: \"month\",\r\n    //     times: [\"M01\", \"M02\", \"M03\", \"M04\", \"M05\", \"M06\", \"M07\", \"M08\", \"M09\", \"M10\", \"M11\", \"M12\"],\r\n    //     timeLabels:['Jan','Feb','March']\r\n    //     categoryParameter: \"c_resid\",\r\n    //     categoryCodes: [\"DOM\", \"FOR\"],\r\n    //     categoryLabels: [\"Domestic\", \"Foreign\"],\r\n    //     categoryColors: [\"#1b9e77\", \"#d95f02\"],\r\n    //     totalCode: \"TOTAL\",\r\n    //   })\r\n    out.statCoxcomb = function (config) {\r\n        out._coxTimes = config.times\r\n        out._coxCategoryCodes = [...config.categoryCodes] // clone so we can append \"other\" later safely\r\n        out._coxTimeLabels = config.timeLabels\r\n\r\n        config.filters = config.filters || {}\r\n\r\n        // Load each category  time\r\n        config.times.forEach((time) => {\r\n            config.categoryCodes.forEach((category) => {\r\n                config.stat.filters[config.timeParameter] = time\r\n                config.stat.filters[config.categoryParameter] = category\r\n\r\n                const sc_ = {}\r\n                for (let key in config.stat) sc_[key] = config.stat[key]\r\n                sc_.filters = {}\r\n                for (let key in config.stat.filters) sc_.filters[key] = config.stat.filters[key]\r\n\r\n                const key = `${time}:${category}`\r\n                out.stat(key, sc_)\r\n\r\n                // Assign labels/colors\r\n                if (config.categoryColors) {\r\n                    out.catColors_ = out.catColors_ || {}\r\n                    out.catColors_[category] = config.categoryColors[config.categoryCodes.indexOf(category)]\r\n                }\r\n                if (config.categoryLabels) {\r\n                    out.catLabels_ = out.catLabels_ || {}\r\n                    out.catLabels_[category] = config.categoryLabels[config.categoryCodes.indexOf(category)]\r\n                }\r\n            })\r\n\r\n            // Also load TOTAL for each month (if available)\r\n            if (config.totalCode) {\r\n                config.stat.filters[config.timeParameter] = time\r\n                config.stat.filters[config.categoryParameter] = config.totalCode\r\n\r\n                const scTotal = {}\r\n                for (let key in config.stat) scTotal[key] = config.stat[key]\r\n                scTotal.filters = {}\r\n                for (let key in config.stat.filters) scTotal.filters[key] = config.stat.filters[key]\r\n\r\n                const totalKey = `${time}:${config.totalCode}`\r\n                out.stat(totalKey, scTotal)\r\n            }\r\n        })\r\n\r\n        // Store totalCode so buildMonthData() and tooltips know it exists\r\n        if (config.totalCode) {\r\n            out.totalCode_ = config.totalCode\r\n            out.catColors_['other'] = '#FFCC80'\r\n            out.catLabels_['other'] = 'Other'\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        // apply classification to all insets that are outside of the main map's SVG\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyClassificationToMap)\r\n        }\r\n\r\n        //main map\r\n        applyClassificationToMap()\r\n\r\n        return out\r\n    }\r\n\r\n    function applyClassificationToMap(map) {\r\n        if (!out.statCodes_) {\r\n            out.statCodes_ = Object.keys(out.statData_)\r\n            const index = out.statCodes_.indexOf('default')\r\n            if (index > -1) out.statCodes_.splice(index, 1)\r\n        }\r\n        getTotals(map)\r\n        computeCoxStatusMap(map);\r\n        defineSizeScales(map)\r\n    }\r\n\r\n    function getTotals(map) {\r\n        const yearlyTotals = {}\r\n        const monthlyTotals = {} // regionId -> { month: total }\r\n\r\n        if (out.totalCode_) {\r\n            // Use month-specific TOTAL series for each region (loaded as `${month}:${totalCode_}`)\r\n            out._coxTimes.forEach((month) => {\r\n                const stat = out.statData(`${month}:${out.totalCode_}`)\r\n                if (!stat || !stat._data_) return\r\n\r\n                for (const region in stat._data_) {\r\n                    const v = stat._data_[region]?.value || 0\r\n                    monthlyTotals[region] = monthlyTotals[region] || {}\r\n                    monthlyTotals[region][month] = v\r\n                    yearlyTotals[region] = (yearlyTotals[region] || 0) + v\r\n                }\r\n            })\r\n        } else {\r\n            // Fallback: sum all causes per month for each region\r\n            out._coxTimes.forEach((month) => {\r\n                const perRegionMonthSum = {}\r\n\r\n                out._coxCategoryCodes.forEach((cause) => {\r\n                    const stat = out.statData(`${month}:${cause}`)\r\n                    if (!stat || !stat._data_) return\r\n\r\n                    for (const region in stat._data_) {\r\n                        const v = stat._data_[region]?.value || 0\r\n                        perRegionMonthSum[region] = (perRegionMonthSum[region] || 0) + v\r\n                    }\r\n                })\r\n\r\n                for (const region in perRegionMonthSum) {\r\n                    monthlyTotals[region] = monthlyTotals[region] || {}\r\n                    monthlyTotals[region][month] = perRegionMonthSum[region]\r\n                    yearlyTotals[region] = (yearlyTotals[region] || 0) + perRegionMonthSum[region]\r\n                }\r\n            })\r\n        }\r\n\r\n        out.yearlyTotals = yearlyTotals\r\n        out.monthlyTotals = monthlyTotals\r\n    }\r\n\r\n    function computeCoxStatusMap(map) {\r\n        const months = out._coxTimes || [];\r\n        const cats = out._coxCategoryCodes || [];\r\n        const useTotal = !!out.totalCode_;\r\n        const status = new Map(); // id -> {value: ':'} for ND, {value:0} for HAS (incl. zero), null for NI\r\n\r\n        // Collect region ids seen in any relevant series\r\n        const regionIds = new Set();\r\n        const addIdsFrom = (key) => {\r\n            const st = out.statData(key);\r\n            if (st && st._data_) Object.keys(st._data_).forEach(id => regionIds.add(id));\r\n        };\r\n        months.forEach(m => {\r\n            if (useTotal) addIdsFrom(`${m}:${out.totalCode_}`);\r\n            else cats.forEach(c => addIdsFrom(`${m}:${c}`));\r\n        });\r\n\r\n        // Determine status for each region\r\n        regionIds.forEach(id => {\r\n            let seenAny = false, seenND = false, seenNumeric = false;\r\n            months.forEach(m => {\r\n                if (useTotal) {\r\n                    const e = out.statData(`${m}:${out.totalCode_}`)?.get(id);\r\n                    if (!e) return;\r\n                    seenAny = true;\r\n                    if (e.value === ':') seenND = true;\r\n                    else if (typeof e.value === 'number') seenNumeric = true; // zero counts as data\r\n                } else {\r\n                    cats.forEach(c => {\r\n                        const e = out.statData(`${m}:${c}`)?.get(id);\r\n                        if (!e) return;\r\n                        seenAny = true;\r\n                        if (e.value === ':') seenND = true;\r\n                        else if (typeof e.value === 'number') seenNumeric = true; // zero counts as data\r\n                    });\r\n                }\r\n            });\r\n\r\n            if (seenND) status.set(id, { value: ':' });      // ND\r\n            else if (seenAny || seenNumeric) status.set(id, { value: 0 }); // HAS (incl. all-zero)\r\n            else status.set(id, null);                        // NI\r\n        });\r\n\r\n        out.coxStatus_ = status;\r\n    }\r\n\r\n    function getRegionTotal(id) {\r\n        const totalsByRegion = out.yearlyTotals\r\n        return totalsByRegion[id] !== undefined ? totalsByRegion[id] : undefined\r\n    }\r\n\r\n    function defineSizeScales(map) {\r\n        const yearlyValues = Object.values(out.yearlyTotals)\r\n        const minRadius = out.coxcombMinRadius_ || 0\r\n        const maxRadius = out.coxcombMaxRadius_ || 80\r\n\r\n        const globalMin = min(yearlyValues) || 0\r\n        const globalMax = max(yearlyValues) || 0\r\n\r\n        // Scale yearly totals  outer chart radius (ensures area  total)\r\n        const outerScale = scaleRadial().domain([globalMin, globalMax]).range([minRadius, maxRadius])\r\n\r\n        // Scale individual stacked values so that wedge areas stay proportional\r\n        out.classifierChartSize_ = (v, regionId) => {\r\n            const targetOuter = outerScale(out.yearlyTotals[regionId] || 0)\r\n            const regionMax = Math.max(...Object.values(out.monthlyTotals[regionId] || { 0: 1 }))\r\n            const proportion = v / regionMax\r\n            return Math.sqrt(proportion) * targetOuter // sqrt keeps area consistent\r\n        }\r\n\r\n        out.classifierSize_ = outerScale\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        if (!out.catColors_) {\r\n            out.catColors({})\r\n            for (let i = 0; i < out.statCodes_.length; i++) {\r\n                out.catColors_[out.statCodes_[i]] = schemeCategory10[i % 10]\r\n            }\r\n        }\r\n\r\n        try {\r\n            // apply style to insets\r\n            if (out.insetTemplates_) {\r\n                executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n            }\r\n\r\n            // apply to main map\r\n            applyStyleToMap(out)\r\n\r\n            // dorling cartogram\r\n            if (out.dorling_) {\r\n                runDorlingSimulation(out, (d) => {\r\n                    const total = getRegionTotal(d.properties.id) || 0\r\n                    return out.classifierSize_(total) || 0\r\n                })\r\n            } else {\r\n                stopDorlingSimulation(out)\r\n            }\r\n\r\n            return out\r\n        } catch (e) {\r\n            console.error('Error in updateStyle:', e.message)\r\n            console.error(e)\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    function applyStyleToMap(map) {\r\n        out.catLabels_ = out.catLabels_ || {}\r\n\r\n        if (out.svg_) {\r\n            const s = map.getCentroidsGroup(map)\r\n            if (s) {\r\n                const sym = s.selectAll('g.em-centroid')\r\n\r\n                // Only keep regions that actually have data\r\n                const regionFeatures = sym.data().filter((rg) => {\r\n                    const id = rg.properties.id\r\n                    return getRegionTotal(id) !== undefined // has non-zero or valid data\r\n                })\r\n\r\n                applyStyleToRegionPolygons(map)\r\n\r\n                // Hover behavior (skip no-data regions)\r\n                addMouseEventsToRegions(map)\r\n\r\n                // append charts to regions\r\n                addCoxcombChartsToMap(regionFeatures, map)\r\n            }\r\n        }\r\n    }\r\n\r\n    function applyStyleToRegionPolygons(map) {\r\n        const selector = getRegionsSelector(map);\r\n        let regions = map.svg().selectAll(selector);\r\n        const status = out.coxStatus_; // id -> {...} or null\r\n\r\n        if (map.geo_ !== 'WORLD') {\r\n            if (map.nutsLevel_ == 'mixed') {\r\n                styleMixedNUTSRegions(map, status, regions); // pass status instead of sizeData\r\n                // (centroids build stays the same)\r\n            }\r\n\r\n            // set ecl for legend/hover\r\n            regions.attr('ecl', (rg) => {\r\n                const sv = status.get(rg.properties.id);\r\n                if (sv == null) return 'ni';         // no input\r\n                if (sv?.value === ':') return 'nd';  // not available\r\n                return null;                         // has data\r\n            });\r\n\r\n            // color ND polygons\r\n            regions\r\n                .filter(rg => status.get(rg.properties.id)?.value === ':')\r\n                .style('fill', out.noDataFillStyle());\r\n        }\r\n    }\r\n\r\n    function styleMixedNUTSRegions(map, status, regions) {\r\n        regions.style('display', function (rg) {\r\n            if (this.parentNode.classList.contains('em-cntrg')) return;\r\n            const sv = status.get(rg.properties.id);\r\n            if (sv == null) return 'none';  // NI: hide\r\n            return 'block';\r\n        });\r\n\r\n        regions\r\n            .style('stroke', function (rg) {\r\n                const sel = select(this);\r\n                const lvl = sel.attr('lvl');\r\n                const sv = status.get(rg.properties.id);\r\n                if (!sv || sv.value == null) return;\r\n                if (lvl !== '0') return sel.style('stroke') || '#777';\r\n            })\r\n            .style('stroke-width', function (rg) {\r\n                const sel = select(this);\r\n                const lvl = sel.attr('lvl');\r\n                const sv = status.get(rg.properties.id);\r\n                if (!sv || sv.value == null) return;\r\n                if (out.geo_ == 'WORLD') return;\r\n                if (lvl !== '0') return sel.style('stroke-width') || 1;\r\n            });\r\n    }\r\n\r\n\r\n    function addCoxcombChartsToMap(regionFeatures, map) {\r\n        const months = out._coxTimes\r\n        const causes = out._coxCategoryCodes\r\n        const angle = createAngleScale(months)\r\n\r\n        regionFeatures.forEach((region) => {\r\n            const regionId = region.properties.id\r\n\r\n            const monthData = buildMonthData(regionId, months, causes)\r\n            if (!monthData.length) return\r\n\r\n            const keys = getActiveKeys(monthData, causes)\r\n\r\n            const stackGen = stack().keys(keys)\r\n            const stacked = stackGen(monthData)\r\n\r\n            drawCoxcomb(regionId, stacked, keys, angle, map)\r\n        })\r\n    }\r\n\r\n    function drawCoxcomb(regionId, stackedData, keys, angle, map) {\r\n        // 1) Anchor to the centroid group for this region\r\n        const centroid = map.svg().select('#ps' + regionId);\r\n        if (centroid.empty()) return;\r\n\r\n        // 2) One container per region, keyed join\r\n        const node = centroid\r\n            .selectAll('g.em-coxcomb')\r\n            .data([regionId], d => d) // stable key\r\n            .join(\r\n                enter => enter.append('g')\r\n                    .attr('class', 'em-coxcomb')\r\n                    .attr('id', 'cox_' + regionId),\r\n                update => update,\r\n                exit => exit.remove()\r\n            );\r\n\r\n        // 3) Clear children before (re)building chart contents\r\n        node.selectAll('*').remove();\r\n\r\n        // 4) Outer ring\r\n        if (out.coxcombRings_) {\r\n            const yearlyTotal = out.yearlyTotals[regionId] || 0;\r\n            const targetOuter = out.classifierSize_(yearlyTotal);\r\n            node.append('circle')\r\n                .attr('class', 'em-coxcomb-max-outline')\r\n                .attr('r', 0)\r\n                .attr('fill', 'none')\r\n                .attr('stroke', '#000')\r\n                .attr('stroke-width', 0.3)\r\n                .attr('opacity', 0.5)\r\n                .attr('pointer-events', 'none')\r\n                .transition()\r\n                .duration(out.transitionDuration_ / 2)\r\n                .attr('r', targetOuter);\r\n        }\r\n\r\n        // 4) Arc generator (shared for tween)\r\n        const arcGen = arc()\r\n            .startAngle(d => angle(d.data.month))\r\n            .endAngle(d => angle(d.data.month) + angle.bandwidth())\r\n            .padAngle(0.01)\r\n            .padRadius(0);\r\n\r\n        // 5) Stacked wedges\r\n        keys.forEach((key, ki) => {\r\n            node.append('g')\r\n                .attr('class', 'em-coxcomb-chart')\r\n                .attr('stroke', '#ffffff')\r\n                .attr('stroke-width', 0.3)\r\n                .selectAll('path')\r\n                .data(stackedData[ki])\r\n                .join('path')\r\n                .attr('fill', out.catColors_[key] || (key === 'other' ? '#FFCC80' : 'lightgray'))\r\n                .attr('code', key)\r\n                .attr('month', d => d.data.month)\r\n                .transition()\r\n                .delay((d, i) => i * 120)\r\n                .duration(out.transitionDuration_)\r\n                .attrTween('d', function (d) {\r\n                    const iInner = interpolate(0, out.classifierChartSize_(d[0], regionId));\r\n                    const iOuter = interpolate(0, out.classifierChartSize_(d[1], regionId));\r\n                    return t => arcGen.innerRadius(iInner(t)).outerRadius(iOuter(t))(d);\r\n                });\r\n        });\r\n    }\r\n\r\n    function addMouseEventsToRegions(map) {\r\n        const shouldOmit = (id) => map.tooltip_.omitRegions?.includes(id)\r\n        const selector = getRegionsSelector(map)\r\n        const regions = map.svg().selectAll(selector)\r\n        const symbols = map.svg().selectAll('g.em-centroid')\r\n        // ;[\r\n        //     // Merge selections so we apply handlers to both regions and charts\r\n        //     regions,\r\n        //     symbols,\r\n        // ].forEach((sel) => {\r\n        symbols.on('mouseover', function (e, rg) {\r\n            if (shouldOmit(rg.properties.id)) return\r\n            if (!getRegionTotal(rg.properties.id)) return\r\n            const sel = select(this)\r\n            sel.attr('fill___', sel.style('fill'))\r\n            sel.style('fill', out.hoverColor_)\r\n\r\n            const k = out._lastZoomK || 1;\r\n            if (out.coxcombRings_) {\r\n                //highlight ring\r\n                sel.select('circle.em-coxcomb-max-outline')\r\n                    .node()\r\n                    .style.setProperty('stroke-width', `${2 / k}px`, 'important');\r\n            } else {\r\n                //highlight chart\r\n                sel.selectAll('g.em-coxcomb-chart')\r\n                    .style('stroke', out.hoverColor_);\r\n            }\r\n\r\n            if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n        })\r\n            .on('mousemove', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                if (!getRegionTotal(rg.properties.id)) return\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            })\r\n            .on('mouseout', function (e, rg) {\r\n                if (shouldOmit(rg.properties.id)) return\r\n                if (!getRegionTotal(rg.properties.id)) return\r\n                const sel = select(this)\r\n                sel.style('fill', sel.attr('fill___') || '')\r\n                sel.attr('fill___', null)\r\n                // Thicken the first circle (outline) inside the symbol group\r\n                const k = out._lastZoomK || 1;\r\n                if (out.coxcombRings_) {\r\n                    //highlight ring\r\n                    sel.select('circle.em-coxcomb-max-outline')\r\n                        .node()\r\n                        .style.setProperty('stroke-width', `${0.3 / k}px`, 'important'); // restore base\r\n                } else {\r\n                    //highlight chart\r\n                    sel.selectAll('g.em-coxcomb-chart')\r\n                        .style('stroke', '#ffffff')\r\n                }\r\n                if (out._tooltip) out._tooltip.mouseout()\r\n            })\r\n    }\r\n\r\n    function getActiveKeys(monthData, causes) {\r\n        const keys = [...causes]\r\n        if (monthData.some((d) => (d['other'] || 0) > 0)) keys.push('other')\r\n        return keys\r\n    }\r\n\r\n    function buildMonthData(regionId, months, causes) {\r\n        const rows = months\r\n            .map((month) => {\r\n                const row = { month }\r\n                let sumCauses = 0\r\n\r\n                causes.forEach((cause) => {\r\n                    const s = out.statData(`${month}:${cause}`)?.get(regionId)\r\n                    const val = s?.value || 0\r\n                    row[cause] = val\r\n                    sumCauses += val\r\n                })\r\n\r\n                if (out.totalCode_) {\r\n                    const totalStat = out.statData(`${month}:${out.totalCode_}`)?.get(regionId)\r\n                    const totalVal = totalStat?.value || 0\r\n                    const otherVal = totalVal > sumCauses ? totalVal - sumCauses : 0\r\n                    if (otherVal > 0) row['other'] = otherVal\r\n                }\r\n\r\n                const hasData = Object.values(row).some((v) => v && v > 0)\r\n                return hasData ? row : null\r\n            })\r\n            .filter(Boolean)\r\n\r\n        // *** Remove \"other\" column if its zero for every row ***\r\n        const hasOther = rows.some((r) => (r['other'] || 0) > 0)\r\n        if (!hasOther) {\r\n            rows.forEach((r) => delete r['other'])\r\n            // Also drop the color & label entry for \"other\" so it won't appear in legend\r\n            delete out.catColors_?.other\r\n            delete out.catLabels_?.other\r\n        }\r\n\r\n        return rows\r\n    }\r\n\r\n    function createAngleScale(months) {\r\n        return scaleBand()\r\n            .domain(months)\r\n            .range([0, 2 * Math.PI])\r\n            .align(0)\r\n    }\r\n\r\n    out.getLegendConstructor = function () {\r\n        return CoxcombLegend.legend // Could implement a Coxcomb-specific legend later\r\n    }\r\n\r\n    out.tooltip_.textFunction = function (rg, map) {\r\n        const regionName = rg.properties.na || rg.properties.name\r\n        const regionId = rg.properties.id\r\n\r\n        const months = out._coxTimes || []\r\n        const causes = [...out._coxCategoryCodes]\r\n\r\n        // Add \"other\" if any month has TOTAL > sum of causes\r\n        const includeOther = months.some((month) => {\r\n            const totalVal = out.statData(`${month}:${out.totalCode_}`)?.get(regionId)?.value || 0\r\n            const sumCauses = out._coxCategoryCodes.reduce((a, c) => a + (out.statData(`${month}:${c}`)?.get(regionId)?.value || 0), 0)\r\n            return totalVal > sumCauses\r\n        })\r\n\r\n        if (includeOther) causes.push('other')\r\n\r\n        let html = `<div class=\"em-tooltip-bar\">${regionName}${regionId ? ` (${regionId})` : ''}</div>`\r\n\r\n        // Header row (with monthly totals column)\r\n        const headerCells = [`<th class=\"em-breakdown-label\">Month</th>`]\r\n        causes.forEach((cause) => {\r\n            const label = out.catLabels_[cause] || cause\r\n            const color = out.catColors_[cause] || (cause === 'other' ? '#FFCC80' : '#999')\r\n            headerCells.push(`<th class=\"em-breakdown-label\" style=\"color:${color}\">${label}</th>`)\r\n        })\r\n        headerCells.push(`<th class=\"em-breakdown-label\">Total</th>`) // totals column\r\n        const headerRow = `<tr>${headerCells.join('')}</tr>`\r\n\r\n        // Precomputed totals\r\n        const yearlyTotals = out.yearlyTotals || {}\r\n        const monthlyTotals = out.monthlyTotals || {}\r\n        const regionYearly = yearlyTotals[regionId] || 0\r\n\r\n        // Data rows for each month\r\n        const rows = months.map((month, i) => {\r\n            const cells = [`<td class=\"em-breakdown-label\">${out._coxTimeLabels ? out._coxTimeLabels[i] : month}</td>`]\r\n            let monthSum = monthlyTotals[regionId]?.[month] || 0\r\n\r\n            causes.forEach((cause) => {\r\n                let rawVal = 0\r\n                if (cause === 'other') {\r\n                    // Derive \"other\" from month-specific TOTAL, not monthSum\r\n                    const totalVal = out.statData(`${month}:${out.totalCode_}`)?.get(regionId)?.value || 0\r\n                    const sumCauses = causes\r\n                        .filter((c) => c !== 'other')\r\n                        .reduce((a, c) => a + (out.statData(`${month}:${c}`)?.get(regionId)?.value || 0), 0)\r\n                    rawVal = Math.max(totalVal - sumCauses, 0)\r\n                } else {\r\n                    rawVal = out.statData(`${month}:${cause}`)?.get(regionId)?.value || 0\r\n                }\r\n\r\n                cells.push(rawVal > 0 ? `<td><span class=\"em-breakdown-value\">${spaceAsThousandSeparator(rawVal)}</span></td>` : '<td></td>')\r\n            })\r\n\r\n            // Monthly total cell (directly from monthlyTotals)\r\n            cells.push(monthSum > 0 ? `<td><span class=\"em-breakdown-value\">${spaceAsThousandSeparator(monthSum)}</span></td>` : '<td></td>')\r\n\r\n            return `<tr>${cells.join('')}</tr>`\r\n        })\r\n\r\n        // Yearly total row (from yearlyTotals)\r\n        const unit = out.statData(out.statCodes_[0])?.unitText() || ''\r\n\r\n        html += `<div class=\"em-tooltip-breakdown em-tooltip-cx\"><table class=\"em-tooltip-cx-table\">`\r\n        html += headerRow + rows.join('')\r\n        if (regionYearly > 0) {\r\n            html += `\r\n      <tr class=\"em-total\">\r\n        <td class=\"em-breakdown-label\">Year total</td>\r\n        <td colspan=\"${causes.length}\"></td>\r\n        <td>\r\n          <span class=\"em-breakdown-value\">${spaceAsThousandSeparator(regionYearly)} ${unit}</span>\r\n        </td>\r\n      </tr>`\r\n        }\r\n        html += `</table></div>`\r\n\r\n        return html\r\n    }\r\n\r\n    return out\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { getRegionsSelector } from '../../../core/utils'\r\n\r\nexport function addMouseEvents(map, out) {\r\n    addMouseEventsToSymbols(map, out)\r\n    addMouseEventsToRegions(map, out)\r\n}\r\n\r\nfunction addMouseEventsToSymbols(map, out) {\r\n    const symbols = map.svg().selectAll('g.em-centroid')\r\n\r\n    symbols\r\n        .on('mouseover', function (e, rg) {\r\n            const sel = select(this)\r\n\r\n            // store original fills\r\n            sel.selectAll('path').each(function () {\r\n                const p = select(this)\r\n                p.attr('fill___', p.style('fill'))\r\n                p.attr('stroke___', p.style('stroke'))\r\n                p.attr('sw___', p.style('stroke-width'))\r\n                //set new\r\n                p.style('fill', out.hoverColor_)\r\n                p.style('stroke', 'black')\r\n                p.style('stroke-width', 1)\r\n            })\r\n\r\n            if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n        })\r\n        .on('mousemove', function (e, rg) {\r\n            if (out._tooltip) out._tooltip.mousemove(e)\r\n            if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n        })\r\n        .on('mouseout', function (e, rg) {\r\n            const sel = select(this)\r\n\r\n            // restore original fills\r\n            sel.selectAll('path').each(function () {\r\n                const p = select(this)\r\n                const original = p.attr('fill___')\r\n                if (original) p.style('fill', original)\r\n                const originalStrokeWidth = p.attr('sw___')\r\n                const originalStroke = p.attr('stroke___')\r\n                if (originalStroke) p.style('stroke', originalStroke)\r\n                if (originalStrokeWidth) p.style('stroke-width', originalStrokeWidth)\r\n            })\r\n\r\n            if (out._tooltip) out._tooltip.mouseout()\r\n            if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n        })\r\n}\r\n\r\nfunction addMouseEventsToRegions(map, out) {\r\n    const regions = map.svg().selectAll(getRegionsSelector(map))\r\n\r\n    regions\r\n        .on('mouseover', function (e, rg) {\r\n            select(this).style('fill', map.hoverColor_)\r\n            if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            if (out.onRegionMouseOver_) out.onRegionMouseOver_(e, rg, this, map)\r\n        })\r\n        .on('mousemove', function (e, rg) {\r\n            if (out._tooltip) out._tooltip.mousemove(e)\r\n            if (out.onRegionMouseMove_) out.onRegionMouseMove_(e, rg, this, map)\r\n        })\r\n        .on('mouseout', function (e, rg) {\r\n            const sel = select(this)\r\n            sel.style('fill', sel.attr('fill___'))\r\n            if (out._tooltip) out._tooltip.mouseout()\r\n            if (out.onRegionMouseOut_) out.onRegionMouseOut_(e, rg, this, map)\r\n        })\r\n}\r\n","import { select } from 'd3-selection'\r\nimport { arc } from 'd3-shape'\r\nimport * as Legend from './legend'\r\nimport { spaceAsThousandSeparator } from '../core/utils'\r\n\r\n/**\r\n * Legend for mushroom (dual semi-circle) proportional symbols\r\n */\r\nexport const legend = function (map, config) {\r\n    //build generic legend object for the map\r\n    const out = Legend.legend(map)\r\n\r\n    // -------------------------------\r\n    // Size legend config\r\n    // -------------------------------\r\n    out.sizeLegend = {\r\n        marginTop: 15,\r\n        values: undefined, // raw data values\r\n        valuesV1: undefined, // raw data values for v1 side\r\n        valuesV2: undefined, // raw data values for v2 side\r\n        labels: null, // optional labels\r\n        labelsV1: null, // optional labels for v1 side\r\n        labelsV2: null, // optional labels for v2 side\r\n        shapePadding: 2, // vertical spacing\r\n        labelOffsets: { x: 5, y: 0 },\r\n    }\r\n\r\n    out.colorLegend = {\r\n        marginTop: 5,\r\n        labelOffsets: { x: 5, y: 5 },\r\n    }\r\n\r\n    // override via config\r\n    if (config?.sizeLegend) {\r\n        Object.assign(out.sizeLegend, config.sizeLegend)\r\n    }\r\n    if (config?.colorLegend) {\r\n        Object.assign(out.colorLegend, config.colorLegend)\r\n    }\r\n\r\n    // -------------------------------\r\n    // Override update\r\n    // -------------------------------\r\n    out.update = function () {\r\n        out.updateConfig()\r\n        out.updateContainer()\r\n\r\n        if (!out.lgg.node()) return\r\n\r\n        // clear\r\n        out.lgg.selectAll('*').remove()\r\n\r\n        // background + title\r\n        out.makeBackgroundBox()\r\n        if (out.title) out.addTitle()\r\n        if (out.subtitle) out.addSubtitle()\r\n\r\n        const baseX = out.getBaseX()\r\n        let cursorY = out.getBaseY() + out.sizeLegend.marginTop\r\n        const legendSpacing = 8\r\n\r\n        // -----------------------------\r\n        // SIZE LEGEND\r\n        // -----------------------------\r\n        const hasIndependentScales = out.map.mushroomSizeScaleFunctionV1_ && out.map.mushroomSizeScaleFunctionV2_\r\n\r\n        if (hasIndependentScales) {\r\n            // --- v1 legend ---\r\n            const v1Box = drawMushroomSizeLegend(out, baseX, cursorY, 'v1')\r\n\r\n            // v1 label BELOW v1 legend\r\n            drawSideLabel(out, baseX, v1Box.bottom + 5, 'v1')\r\n\r\n            // move cursor directly to v1 legend bottom (NO extra spacing)\r\n            cursorY = v1Box.bottom\r\n\r\n            // --- v2 legend ---\r\n            const v2Box = drawMushroomSizeLegend(out, baseX, cursorY, 'v2')\r\n\r\n            // v2 label JUST ABOVE v2 legend\r\n            drawSideLabel(out, baseX, v2Box.top + 30, 'v2')\r\n        } else {\r\n            cursorY = drawMushroomSizeLegend(out, baseX, cursorY)\r\n        }\r\n\r\n        // -----------------------------\r\n        // COLOR KEY (only for shared scale)\r\n        // -----------------------------\r\n        if (!hasIndependentScales) {\r\n            drawColorKey(out, baseX, cursorY + out.colorLegend.marginTop)\r\n        }\r\n\r\n        out.setBoxDimension()\r\n    }\r\n\r\n    return out\r\n}\r\n\r\nfunction drawSideLabel(out, x, y, side) {\r\n    const map = out.map\r\n    const colors = map.mushroomColors()\r\n    const [c1, c2] = map.mushroomCodes()\r\n\r\n    const label = side === 'v1' ? map.statData(c1)?.label_ || c1 : map.statData(c2)?.label_ || c2\r\n\r\n    const color = side === 'v1' ? colors[0] : colors[1]\r\n\r\n    const text = out.lgg\r\n        .append('text')\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .style('fill', color)\r\n        .attr('font-weight', '600')\r\n        .attr('dominant-baseline', 'hanging') //  IMPORTANT\r\n        .attr('class', 'em-legend-label')\r\n        .text(label)\r\n\r\n    return text.node().getBBox()\r\n}\r\n\r\n/* ===================================================================== */\r\n/* ======================= Drawing helpers ============================== */\r\n/* ===================================================================== */\r\n\r\nfunction drawMushroomSizeLegend(out, x, y, side = null) {\r\n    const map = out.map\r\n    const cfg = out.sizeLegend\r\n\r\n    const scaleShared = map._mushroomScale_\r\n    const scaleV1 = map.mushroomSizeScaleFunctionV1_\r\n    const scaleV2 = map.mushroomSizeScaleFunctionV2_\r\n    const hasIndependentScales = scaleV1 && scaleV2\r\n\r\n    let scale\r\n    let sideIndex = null\r\n\r\n    if (side === 'v1') {\r\n        scale = scaleV1\r\n        sideIndex = 0\r\n    } else if (side === 'v2') {\r\n        scale = scaleV2\r\n        sideIndex = 1\r\n    } else {\r\n        scale = scaleShared\r\n    }\r\n\r\n    if (!scale) return y\r\n\r\n    // geometry + style\r\n    const orient = map.mushroomOrientation()\r\n    const arcGen = arc().innerRadius(0)\r\n    const arcDef = getSizeLegendArc(orient, sideIndex)\r\n\r\n    const labelOffsetX = cfg.labelOffsets?.x ?? 8\r\n    const leaderDash = '3,2'\r\n    const stroke = cfg.shapeStroke || '#000000'\r\n    const strokeWidth = cfg.shapeStrokeWidth ?? 1\r\n\r\n    const legendValuesRaw = getValues(cfg, scale, hasIndependentScales, side)\r\n    if (!legendValuesRaw) return y\r\n\r\n    const legendValues = [...legendValuesRaw].sort((a, b) => scale(b) - scale(a))\r\n\r\n    const radii = legendValues.map((v) => scale(v))\r\n    const maxR = Math.max(...radii)\r\n    if (!Number.isFinite(maxR) || maxR <= 0) return y\r\n\r\n    // labels (per side)\r\n    const labels = getLabels(cfg, legendValues, hasIndependentScales, side)\r\n\r\n    const g = out.lgg.append('g').attr('class', 'em-mushroom-size-legend').attr('transform', `translate(${x},${y})`)\r\n\r\n    const cx = maxR\r\n    const cy = maxR\r\n    const colors = map.mushroomColors()\r\n\r\n    const fillColor = hasIndependentScales && sideIndex != null ? colors[sideIndex] : 'none'\r\n\r\n    legendValues.forEach((v, i) => {\r\n        const r = scale(v)\r\n        if (!r || r <= 0) return\r\n\r\n        const row = g.append('g').attr('transform', `translate(${cx},${cy})`)\r\n\r\n        row.append('path')\r\n            .attr(\r\n                'd',\r\n                arcGen({\r\n                    startAngle: arcDef.start,\r\n                    endAngle: arcDef.end,\r\n                    outerRadius: r,\r\n                })\r\n            )\r\n            .style('fill', fillColor)\r\n            .attr('stroke', stroke)\r\n            .attr('stroke-width', strokeWidth)\r\n            .attr('data-mushroom-side', sideIndex)\r\n\r\n        const yLeader =\r\n            orient === 'vertical' && sideIndex === 1\r\n                ? r // bottom semi-circle\r\n                : -r // top (or default)\r\n        let xLabel = maxR + labelOffsetX\r\n        if (orient === 'horizontal') {\r\n            // left side\r\n            xLabel = 10 + labelOffsetX\r\n        }\r\n\r\n        row.append('line')\r\n            .attr('x1', 0)\r\n            .attr('x2', xLabel)\r\n            .attr('y1', yLeader)\r\n            .attr('y2', yLeader)\r\n            .attr('stroke', stroke)\r\n            .attr('stroke-width', 0.6)\r\n            .attr('stroke-dasharray', leaderDash)\r\n\r\n        row.append('text')\r\n            .attr('x', xLabel + 3)\r\n            .attr('y', yLeader)\r\n            .attr('dy', '0.35em')\r\n            .attr('dominant-baseline', 'middle')\r\n            .attr('class', 'em-legend-label')\r\n            .text(labels ? labels[i] : spaceAsThousandSeparator(v))\r\n    })\r\n\r\n    const bbox = g.node()?.getBBox()\r\n    return bbox ? { top: y, bottom: y + bbox.height } : { top: y, bottom: y }\r\n}\r\n\r\nfunction getValues(cfg, scale, hasIndependentScales, side) {\r\n    let values\r\n\r\n    if (hasIndependentScales) {\r\n        if (side === 'v1') values = cfg.valuesV1\r\n        else if (side === 'v2') values = cfg.valuesV2\r\n    } else {\r\n        values = cfg.values\r\n    }\r\n\r\n    // auto bounds from scale\r\n    if (!values || !values.length) {\r\n        const d = scale.domain?.()\r\n        if (!d || d.length < 2) return null\r\n        return [Math.min(d[0], d[d.length - 1]), Math.max(d[0], d[d.length - 1])]\r\n    }\r\n\r\n    // explicit values  bounds\r\n    const vMin = Math.min(...values)\r\n    const vMax = Math.max(...values)\r\n    return values.length > 1 ? [vMax, vMin] : [values[0]]\r\n}\r\n\r\nfunction getLabels(cfg, legendValues, hasIndependentScales, side) {\r\n    let labels\r\n\r\n    if (hasIndependentScales) {\r\n        if (side === 'v1') labels = cfg.labelsV1\r\n        else if (side === 'v2') labels = cfg.labelsV2\r\n    } else {\r\n        labels = cfg.labels\r\n    }\r\n\r\n    return labels && labels.length >= legendValues.length ? labels : null\r\n}\r\n\r\n/* ------------------------ Color key ---------------------------------- */\r\n\r\nfunction drawColorKey(out, x, y) {\r\n    const map = out.map\r\n    const colors = map.mushroomColors()\r\n    const [c1, c2] = map.mushroomCodes()\r\n\r\n    const labels = out.colorLegend.labels ?? [map.statData(c1)?.label_ || c1, map.statData(c2)?.label_ || c2]\r\n\r\n    const g = out.lgg.append('g').attr('class', 'em-mushroom-color-legend').attr('transform', `translate(${x}, ${y})`)\r\n\r\n    labels.forEach((lab, i) => {\r\n        const row = g\r\n            .append('g')\r\n            .attr('transform', `translate(0, ${i * out.shapeHeight})`)\r\n            .style('cursor', 'pointer')\r\n            .on('mouseover', () => {\r\n                highlightMushroomSide(map, i)\r\n\r\n                // apply to insets as well\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId_, highlightMushroomSide, i)\r\n                }\r\n            })\r\n            .on('mouseout', () => {\r\n                resetMushroomHighlight(map)\r\n\r\n                if (map.insetTemplates_) {\r\n                    executeForAllInsets(map.insetTemplates_, map.svgId_, resetMushroomHighlight)\r\n                }\r\n            })\r\n\r\n        row.append('rect').attr('width', out.shapeWidth).attr('height', out.shapeHeight).attr('fill', colors[i]).attr('class', 'em-legend-rect')\r\n\r\n        row.append('text')\r\n            .attr('x', out.shapeWidth + out.colorLegend.labelOffsets.x)\r\n            .attr('y', out.shapeHeight / 2 + out.colorLegend.labelOffsets.y)\r\n            .attr('class', 'em-legend-label')\r\n            .text(lab)\r\n    })\r\n}\r\n\r\n/* ------------------------ Geometry ----------------------------------- */\r\n\r\nfunction getSizeLegendArc(orientation, sideIndex = null) {\r\n    if (orientation === 'vertical') {\r\n        if (sideIndex === 0) {\r\n            // top\r\n            return { start: -Math.PI / 2, end: Math.PI / 2 }\r\n        }\r\n        if (sideIndex === 1) {\r\n            // bottom\r\n            return { start: Math.PI / 2, end: (3 * Math.PI) / 2 }\r\n        }\r\n        return { start: -Math.PI / 2, end: Math.PI / 2 }\r\n    }\r\n\r\n    // HORIZONTAL  vertical flat edges\r\n    if (sideIndex === 0) {\r\n        // v1  left\r\n        return { start: Math.PI, end: 2 * Math.PI }\r\n    }\r\n    if (sideIndex === 1) {\r\n        // v2  right\r\n        return { start: 0, end: Math.PI }\r\n    }\r\n\r\n    return { start: Math.PI, end: 2 * Math.PI }\r\n}\r\n\r\nfunction highlightMushroomSide(map, sideIndex) {\r\n    map.svg()\r\n        .selectAll('g.em-centroid path[data-mushroom-side]')\r\n        .style('opacity', function () {\r\n            return this.getAttribute('data-mushroom-side') === String(sideIndex) ? 1 : 0\r\n        })\r\n}\r\n\r\nfunction resetMushroomHighlight(map) {\r\n    map.svg().selectAll('g.em-centroid path[data-mushroom-side]').style('opacity', null)\r\n}\r\n","import { max } from 'd3-array'\r\nimport { scaleSqrt } from 'd3-scale'\r\nimport { arc } from 'd3-shape'\r\nimport { select } from 'd3-selection'\r\nimport * as StatMap from '../../../core/stat-map.js'\r\nimport { executeForAllInsets, spaceAsThousandSeparator } from '../../../core/utils.js'\r\nimport { runDorlingSimulation, stopDorlingSimulation } from '../../../core/dorling/dorling.js'\r\nimport { addMouseEvents } from './map-mushroom-interactions.js'\r\nimport * as MushroomLegend from '../../../legend/legend-mushroom.js'\r\n\r\n/**\r\n * Mushroom (dual semi-circle) proportional symbol map\r\n * v1 = left / top\r\n * v2 = right / bottom\r\n */\r\nexport const map = function (config) {\r\n    const out = StatMap.statMap(config, true, 'mushroom')\r\n\r\n    // ===============================\r\n    // Configuration\r\n    // ===============================\r\n\r\n    out.mushroomCodes_ = ['v1', 'v2']\r\n    out.mushroomMinSize_ = 4\r\n    out.mushroomMaxSize_ = 30\r\n    out.mushroomColors_ = ['#2c7bb6', '#d7191c']\r\n    out.mushroomOrientation_ = 'vertical' // 'horizontal' | 'vertical'\r\n    out.mushroomSizeScaleFunction_ = null // custom size scale function for both sides\r\n    out.mushroomSizeScaleFunctionV1_ = null // custom size scale function for v1 side\r\n    out.mushroomSizeScaleFunctionV2_ = null // custom size scale function for v2 side\r\n\r\n    out._mushroomScale_ = null\r\n\r\n    out.tooltip_.textFunction = tooltipTextFunctionMushroom\r\n\r\n    // ===============================\r\n    // Getters / setters\r\n    // ===============================\r\n\r\n    const paramNames = [\r\n        'mushroomCodes_',\r\n        'mushroomMinSize_',\r\n        'mushroomMaxSize_',\r\n        'mushroomColors_',\r\n        'mushroomOrientation_',\r\n        'mushroomSizeScaleFunction_',\r\n        'mushroomSizeScaleFunctionV1_',\r\n        'mushroomSizeScaleFunctionV2_',\r\n    ]\r\n\r\n    paramNames.forEach((att) => {\r\n        const name = att.slice(0, -1)\r\n        out[name] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    // override via config\r\n    if (config) {\r\n        paramNames.forEach((key) => {\r\n            const k = key.slice(0, -1)\r\n            if (config[k] !== undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    // ===============================\r\n    // Classification (shared size scale)\r\n    // ===============================\r\n    //@override\r\n    out.updateClassification = function () {\r\n        if (out.mushroomSizeScaleFunction_) {\r\n            //allow custom user scale function\r\n            out._mushroomScale_ = out.mushroomSizeScaleFunction_\r\n            return\r\n        }\r\n        if (out.mushroomSizeScaleFunctionV1_ && out.mushroomSizeScaleFunctionV2_) {\r\n            //both sides have custom user scale functions\r\n            return\r\n        }\r\n\r\n        out._mushroomScale_ = null\r\n\r\n        const [c1, c2] = out.mushroomCodes_\r\n        const stat1 = out.statData(c1)\r\n        const stat2 = out.statData(c2)\r\n\r\n        if (!stat1 && !stat2) return out\r\n\r\n        // Collect numeric values from BOTH stat datasets\r\n        const values = []\r\n\r\n        if (stat1?.getArray) {\r\n            stat1.getArray().forEach((v) => {\r\n                const n = +v\r\n                if (Number.isFinite(n)) values.push(n)\r\n            })\r\n        }\r\n\r\n        if (stat2?.getArray) {\r\n            stat2.getArray().forEach((v) => {\r\n                const n = +v\r\n                if (Number.isFinite(n)) values.push(n)\r\n            })\r\n        }\r\n\r\n        if (!values.length) return out\r\n\r\n        const maxVal = max(values) || 0\r\n\r\n        out._mushroomScale_ = scaleSqrt().domain([0, maxVal]).range([out.mushroomMinSize_, out.mushroomMaxSize_])\r\n\r\n        return out\r\n    }\r\n\r\n    // ===============================\r\n    // Styling\r\n    // ===============================\r\n    //@override\r\n    out.updateStyle = function () {\r\n        out.updateSymbolsDrawOrder(out)\r\n\r\n        applyStyleToMap(out)\r\n\r\n        if (out.insetTemplates_) {\r\n            executeForAllInsets(out.insetTemplates_, out.svgId_, applyStyleToMap)\r\n        }\r\n\r\n        // dorling cartogram\r\n        if (out.dorling_ && (out._mushroomScale_ || (out.mushroomSizeScaleFunctionV1_ && out.mushroomSizeScaleFunctionV2_))) {\r\n            const [c1, c2] = out.mushroomCodes()\r\n            const stat1 = out.statData(c1)\r\n            const stat2 = out.statData(c2)\r\n\r\n            runDorlingSimulation(out, (d) => {\r\n                const id = d.properties.id\r\n\r\n                const v1 = +stat1.get(id)?.value || 0\r\n                const v2 = +stat2.get(id)?.value || 0\r\n\r\n                let r1, r2\r\n                if (out.mushroomSizeScaleFunctionV1_ && out.mushroomSizeScaleFunctionV2_) {\r\n                    r1 = out.mushroomSizeScaleFunctionV1_(v1)\r\n                    r2 = out.mushroomSizeScaleFunctionV2_(v2)\r\n                } else {\r\n                    r1 = out._mushroomScale_(v1)\r\n                    r2 = out._mushroomScale_(v2)\r\n                }\r\n\r\n                return Math.sqrt((r1 * r1 + r2 * r2) / 2)\r\n            })\r\n        } else {\r\n            stopDorlingSimulation(out)\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    out.updateSymbolsDrawOrder = function (map) {\r\n        const gcp = out.getCentroidsGroup(map)\r\n        const [c1, c2] = out.mushroomCodes()\r\n\r\n        const stat1 = out.statData(c1)\r\n        const stat2 = out.statData(c2)\r\n\r\n        // Ensure centroidFeatures exists\r\n        if (!map.Geometries.centroidsFeatures || !map.Geometries.centroidsFeatures.length) {\r\n            map.Geometries.centroidsFeatures = map\r\n                .svg()\r\n                .selectAll('g.em-centroid')\r\n                .data()\r\n                .filter((d) => d?.properties?.centroid)\r\n        }\r\n\r\n        // Sort by visual size (largest first  drawn underneath)\r\n        const sorted = map.Geometries.centroidsFeatures\r\n            .map((d) => {\r\n                const id = d.properties.id\r\n                const v1 = +stat1.get(id)?.value || 0\r\n                const v2 = +stat2.get(id)?.value || 0\r\n                let r1, r2\r\n                if (out.mushroomSizeScaleFunctionV1_ && out.mushroomSizeScaleFunctionV2_) {\r\n                    r1 = out.mushroomSizeScaleFunctionV1_(v1)\r\n                    r2 = out.mushroomSizeScaleFunctionV2_(v2)\r\n                } else {\r\n                    r1 = out._mushroomScale_(v1)\r\n                    r2 = out._mushroomScale_(v2)\r\n                }\r\n                return { d, r: Math.max(r1, r2) }\r\n            })\r\n            .filter((o) => o.r > 0)\r\n            .sort((a, b) => b.r - a.r)\r\n            .map((o) => o.d)\r\n\r\n        // Clear old centroids\r\n        gcp.selectAll('g.em-centroid').remove()\r\n\r\n        // Recreate in sorted order\r\n        gcp.selectAll('g.em-centroid')\r\n            .data(sorted, (d) => d.properties.id)\r\n            .enter()\r\n            .append('g')\r\n            .attr('class', 'em-centroid')\r\n            .attr('id', (d) => 'mushroom-' + d.properties.id)\r\n            .attr('transform', (d) => `translate(${d.properties.centroid[0].toFixed(3)},${d.properties.centroid[1].toFixed(3)})`)\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return MushroomLegend.legend\r\n    }\r\n\r\n    return out\r\n}\r\n\r\n/**\r\n * Draw mushroom symbols\r\n */\r\nfunction applyStyleToMap(map) {\r\n    if (!map.svg() || (!map._mushroomScale_ && !map.mushroomSizeScaleFunctionV1_ && !map.mushroomSizeScaleFunctionV2_)) return\r\n    const hasIndependentScales = map.mushroomSizeScaleFunctionV1_ && map.mushroomSizeScaleFunctionV2_\r\n    const [c1, c2] = map.mushroomCodes()\r\n    const colors = map.mushroomColors()\r\n    const orient = map.mushroomOrientation_\r\n\r\n    const stat1 = map.statData(c1)\r\n    const stat2 = map.statData(c2)\r\n\r\n    const arcGen = arc().innerRadius(0)\r\n\r\n    const centroids = map.svg().selectAll('g.em-centroid')\r\n\r\n    centroids.selectAll('*').remove()\r\n\r\n    centroids.each(function (d) {\r\n        const id = d.properties.id\r\n\r\n        const v1 = +stat1.get(id)?.value || 0\r\n        const v2 = +stat2.get(id)?.value || 0\r\n\r\n        if (v1 === 0 && v2 === 0) return\r\n\r\n        let r1, r2\r\n        if (map.mushroomSizeScaleFunctionV1_ && map.mushroomSizeScaleFunctionV2_) {\r\n            r1 = map.mushroomSizeScaleFunctionV1_(v1)\r\n            r2 = map.mushroomSizeScaleFunctionV2_(v2)\r\n        } else {\r\n            r1 = map._mushroomScale_(v1)\r\n            r2 = map._mushroomScale_(v2)\r\n        }\r\n\r\n        const g = select(this)\r\n\r\n        if (orient === 'vertical') {\r\n            // TOP (v1): upper semi-circle, flat at bottom\r\n            g.append('path')\r\n                .attr(\r\n                    'd',\r\n                    arcGen({\r\n                        startAngle: -Math.PI / 2,\r\n                        endAngle: Math.PI / 2,\r\n                        outerRadius: r1,\r\n                    })\r\n                )\r\n                .attr('fill', colors[0])\r\n                .attr('class', 'em-mushroom-segment')\r\n                .attr('data-mushroom-side', '0')\r\n\r\n            // BOTTOM (v2): lower semi-circle, flat at top\r\n            g.append('path')\r\n                .attr(\r\n                    'd',\r\n                    arcGen({\r\n                        startAngle: Math.PI / 2,\r\n                        endAngle: (3 * Math.PI) / 2,\r\n                        outerRadius: r2,\r\n                    })\r\n                )\r\n                .attr('fill', colors[1])\r\n                .attr('class', 'em-mushroom-segment')\r\n                .attr('data-mushroom-side', '1')\r\n        } else {\r\n            // HORIZONTAL\r\n\r\n            // v1  LEFT (curves left, flat on right)\r\n            g.append('path')\r\n                .attr(\r\n                    'd',\r\n                    arcGen({\r\n                        startAngle: Math.PI,\r\n                        endAngle: 2 * Math.PI,\r\n                        outerRadius: r1,\r\n                    })\r\n                )\r\n                .attr('fill', colors[0])\r\n                .attr('class', 'em-mushroom-segment')\r\n                .attr('data-mushroom-side', '0')\r\n\r\n            // v2  RIGHT (curves right, flat on left)\r\n            g.append('path')\r\n                .attr(\r\n                    'd',\r\n                    arcGen({\r\n                        startAngle: 0,\r\n                        endAngle: Math.PI,\r\n                        outerRadius: r2,\r\n                    })\r\n                )\r\n                .attr('fill', colors[1])\r\n                .attr('class', 'em-mushroom-segment')\r\n                .attr('data-mushroom-side', '1')\r\n        }\r\n    })\r\n\r\n    addMouseEvents(map, map)\r\n}\r\n\r\n// ===============================\r\n// Tooltip\r\n// ===============================\r\nconst tooltipTextFunctionMushroom = function (rg, map) {\r\n    const [c1, c2] = map.mushroomCodes()\r\n    const id = rg.properties.id\r\n    const name = rg.properties.na || ''\r\n\r\n    const sv1 = map.statData(c1).get(id)\r\n    const sv2 = map.statData(c2).get(id)\r\n\r\n    const unit1 = map.statData(c1).unitText?.() || ''\r\n    const unit2 = map.statData(c2).unitText?.() || ''\r\n\r\n    const fmt = (v, u) => {\r\n        if (v === ':' || v == null) return map.noDataText_ || 'No data'\r\n        return spaceAsThousandSeparator(v) + (u ? ' ' + u : '')\r\n    }\r\n\r\n    return `\r\n        <div class=\"em-tooltip-bar\">\r\n            ${name}${id ? ` (${id})` : ''}\r\n        </div>\r\n        <div class=\"em-tooltip-text\">\r\n            <table class=\"em-tooltip-table\">\r\n                <tbody>\r\n                    <tr>\r\n                        <td>${map.statData(c1).label_ || ''}</td>\r\n                        <td>${fmt(sv1?.value, unit1)}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>${map.statData(c2).label_ || ''}</td>\r\n                        <td>${fmt(sv2?.value, unit2)}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    `.trim()\r\n}\r\n","import * as Choropleth from './map-types/choropleth/map-choropleth'\r\nimport * as ProportionalSymbol from './map-types/proportional-symbol/map-proportional-symbols'\r\nimport * as Categorical from './map-types/map-categorical'\r\nimport * as BivariateChoropleth from './map-types/choropleth/map-choropleth-bivariate'\r\nimport * as TrivariateChoropleth from './map-types/choropleth/map-choropleth-trivariate'\r\nimport * as StripeComposition from './map-types/map-stripe-composition'\r\nimport * as PieCharts from './map-types/map-piecharts'\r\nimport * as Sparklines from './map-types/map-sparklines'\r\nimport * as FlowMap from './map-types/flow/map-flow'\r\nimport * as Coxcomb from './map-types/map-coxcomb'\r\nimport * as ValueByAlpha from './map-types/choropleth/map-value-by-alpha'\r\nimport * as Mushroom from './map-types/proportional-symbol/mushrooms/map-mushroom.js'\r\nimport * as mt from './core/stat-map'\r\nimport { DEFAULTLABELS } from './core/labels'\r\n\r\n/**\r\n * Function returning a eurostat-map object.\r\n *\r\n * @param {*} type The type of map ('ch' for choropleth, etc.)\r\n * @param {*} config The configuration object. Ex.: { title: \"Map title\", geoCenter: [233,654], ...}\r\n */\r\nexport const map = function (type, config) {\r\n    try {\r\n        //choropleth map\r\n        if (type == 'choropleth' || type == 'ch') return Choropleth.map(config)\r\n        //categorical map\r\n        if (type == 'categorical' || type == 'ct') return Categorical.map(config)\r\n        //proportionnal symbols map\r\n        if (type == 'proportionalSymbol' || type == 'proportionalSymbols' || type == 'ps') return ProportionalSymbol.map(config)\r\n        //bivariate choropleth\r\n        if (type == 'bivariateChoropleth' || type == 'chbi') return BivariateChoropleth.map(config)\r\n        //trivariate choropleth\r\n        if (type == 'trivariateChoropleth' || type == 'ternary') return TrivariateChoropleth.map(config)\r\n        //stripes composition\r\n        if (type == 'stripeComposition' || type == 'scomp') return StripeComposition.map(config)\r\n        //proportional pie charts\r\n        if (type == 'pieChart' || type == 'pie') return PieCharts.map(config)\r\n        //sparkline maps\r\n        if (type == 'sparkline' || type == 'spark' || type == 'sparklines') return Sparklines.map(config)\r\n        //flow maps\r\n        if (type == 'flow' || type == 'flowmap') return FlowMap.map(config)\r\n        //coxcomb maps\r\n        if (type == 'coxcomb' || type == 'polar') return Coxcomb.map(config)\r\n        //value by alpha maps\r\n        if (type == 'alpha' || type == 'valueByAlpha') return ValueByAlpha.map(config)\r\n        //mushroom (Cheysson )\r\n        if (type == 'mushroom') return Mushroom.map(config)\r\n\r\n        //add new map types here\r\n        //if(type == \"XX\") return mapXX.map(config);\r\n\r\n        console.log('Unexpected map type: ' + type)\r\n        return mt.statMap(config, true, type)\r\n    } catch (e) {\r\n        console.error('Error in eurostat-map.map: ' + e.message)\r\n        console.error(e)\r\n    }\r\n}\r\n\r\n/**\r\n * Return a function which builds fill patterns style.\r\n * The returned function has for arguments the SVG element where to use the fill pattern, and the number of classes.\r\n *\r\n * @param {*} opts Various parameters on the fill pattern.\r\n * @returns {function}\r\n */\r\nexport const getFillPatternDefinitionFunction = function (opts) {\r\n    opts = opts || {}\r\n    opts.shape = opts.shape || 'circle'\r\n    const ps = opts.patternSize || 5\r\n    const smin = opts.minSize || 1\r\n    const smax = opts.maxSize || 5.5\r\n    opts.bckColor = opts.bckColor || 'white'\r\n    opts.symbColor = opts.symbColor || 'black'\r\n    return function (svg, numberOfClasses) {\r\n        //clear previous\r\n        svg.selectAll('.em-fill-pattern').remove()\r\n        for (let i = 0; i < numberOfClasses; i++) {\r\n            const si = smin + ((smax - smin) * i) / (numberOfClasses - 1)\r\n            const patt = svg\r\n                .append('pattern')\r\n                .attr('class', 'em-fill-pattern')\r\n                .attr('id', 'pattern_' + i)\r\n                .attr('x', '0')\r\n                .attr('y', '0')\r\n                .attr('width', ps)\r\n                .attr('height', ps)\r\n                .attr('patternUnits', 'userSpaceOnUse')\r\n            patt.append('rect').attr('x', 0).attr('y', 0).attr('width', ps).attr('height', ps).style('stroke', 'none').style('fill', opts.bckColor)\r\n            if (opts.shape == 'square')\r\n                patt.append('rect')\r\n                    .attr('x', 0)\r\n                    .attr('y', 0)\r\n                    .attr('width', si)\r\n                    .attr('height', si)\r\n                    .style('stroke', 'none')\r\n                    .style('fill', opts.symbColor)\r\n            else\r\n                patt.append('circle')\r\n                    .attr('cx', ps * 0.5)\r\n                    .attr('cy', ps * 0.5)\r\n                    .attr('r', si * 0.5)\r\n                    .style('stroke', 'none')\r\n                    .style('fill', opts.symbColor)\r\n        }\r\n    }\r\n}\r\n\r\n//support deprecated name\r\nexport const getFillPatternDefinitionFun = getFillPatternDefinitionFunction\r\n\r\nexport const getDefaultLabels = function () {\r\n    return DEFAULTLABELS\r\n}\r\n\r\nimport { version as pkgVersion } from '../package.json'\r\nexport const version = pkgVersion\r\n","import { select } from 'd3-selection'\r\nimport { arc, pie } from 'd3-shape'\r\nimport { schemeCategory10 } from 'd3-scale-chromatic'\r\n//schemeSet3 schemeDark2 schemePastel1 schemeTableau10\r\nimport * as StatMap from '../core/stat-map'\r\nimport * as StripeCompositionLegend from '../legend/legend-stripe-composition'\r\nimport { getCSSPropertyFromClass, getRegionsSelector } from '../core/utils'\r\n/**\r\n * Return a stripe composition map.\r\n *\r\n * @param {*} config\r\n */\r\nexport const map = function (config) {\r\n    //create map object to return, using the template\r\n    const out = StatMap.statMap(config, false, 'scomp')\r\n\r\n    //width of the stripes serie\r\n    out.stripeWidth_ = 50\r\n    //orientation - vertical by default\r\n    out.stripeOrientation_ = 0\r\n\r\n    //colors - indexed by category code\r\n    out.catColors_ = undefined\r\n    //labels - indexed by category code\r\n    out.catLabels_ = undefined\r\n\r\n    //show stripes only when data for all categories is complete.\r\n    //Otherwise, consider the regions as being with no data at all.\r\n    out.showOnlyWhenComplete_ = false\r\n\r\n    //tooltip pie chart\r\n    out.pieChartRadius_ = 40\r\n    out.pieChartInnerRadius_ = 15\r\n\r\n    /**\r\n     * Definition of getters/setters for all previously defined attributes.\r\n     * Each method follow the same pattern:\r\n     *  - There is a single method as getter/setter of each attribute. The name of this method is the attribute name, without the trailing \"_\" character.\r\n     *  - To get the attribute value, call the method without argument.\r\n     *  - To set the attribute value, call the same method with the new value as single argument.\r\n     */\r\n    const paramNames = [\r\n        'stripeWidth_',\r\n        'stripeOrientation_',\r\n        'catColors_',\r\n        'catLabels_',\r\n        'showOnlyWhenComplete_',\r\n        'noDataFillStyle_',\r\n        'pieChartRadius_',\r\n        'pieChartInnerRadius_',\r\n    ]\r\n    paramNames.forEach(function (att) {\r\n        out[att.substring(0, att.length - 1)] = function (v) {\r\n            if (!arguments.length) return out[att]\r\n            out[att] = v\r\n            return out\r\n        }\r\n    })\r\n\r\n    //override attribute values with config values\r\n    if (config) {\r\n        paramNames.forEach(function (key) {\r\n            let k = key.slice(0, -1) // remove trailing underscore\r\n            if (config[k] != undefined) out[k](config[k])\r\n        })\r\n    }\r\n\r\n    /**\r\n     * A function to define a stripe map easily, without repetition of information.\r\n     * Only for eurobase data sources.\r\n     *\r\n     * @param {*} stat A pattern for the stat data source\r\n     * @param {String} dim The dimension of the composition.\r\n     * @param {Array} codes The category codes of the composition\r\n     * @param {Array} labels Optional: The labels for the category codes\r\n     * @param {Array} colors Optional: The colors for the category\r\n     */\r\n    out.statComp = function (stat, dim, codes, labels, colors) {\r\n        //add one dataset config for each category\r\n        stat.filters = stat.filters || {}\r\n        for (let i = 0; i < codes.length; i++) {\r\n            //category code\r\n            const code = codes[i]\r\n            stat.filters[dim] = code\r\n            const sc_ = {}\r\n            for (let key in stat) sc_[key] = stat[key]\r\n            sc_.filters = {}\r\n            for (let key in stat.filters) sc_.filters[key] = stat.filters[key]\r\n            out.stat(code, sc_)\r\n\r\n            //if specified, retrieve and assign color\r\n            if (colors) {\r\n                out.catColors_ = out.catColors_ || {}\r\n                out.catColors_[code] = colors[i]\r\n            }\r\n            //if specified, retrieve and assign label\r\n            if (labels) {\r\n                out.catLabels_ = out.catLabels_ || {}\r\n                out.catLabels_[code] = labels[i]\r\n            }\r\n        }\r\n\r\n        //set statCodes\r\n        statCodes = codes\r\n\r\n        return out\r\n    }\r\n\r\n    /** The codes of the categories to consider for the composition. */\r\n    let statCodes = undefined\r\n\r\n    /**\r\n     * Function to compute composition for region id, for each category.\r\n     * Return an object with, for each category, the share [0,1] of the category.\r\n     * @param {*} id\r\n     */\r\n    const getComposition = function (id) {\r\n        let comp = {},\r\n            sum = 0\r\n        //get stat value for each category. Compute the sum.\r\n        for (let i = 0; i < statCodes.length; i++) {\r\n            //retrieve code and stat value\r\n            const sc = statCodes[i]\r\n            const s = out.statData(sc).get(id)\r\n\r\n            //case when some data is missing\r\n            if (!s || (s.value != 0 && !s.value) || isNaN(s.value)) {\r\n                if (out.showOnlyWhenComplete()) return undefined\r\n                else continue\r\n            }\r\n\r\n            comp[sc] = s.value\r\n            sum += s.value\r\n        }\r\n\r\n        //case when no data\r\n        if (sum == 0) return undefined\r\n\r\n        //compute ratios\r\n        for (let i = 0; i < statCodes.length; i++) comp[statCodes[i]] /= sum\r\n\r\n        return comp\r\n    }\r\n\r\n    //@override\r\n    out.updateClassification = function () {\r\n        //if not provided, get list of stat codes from the map stat data\r\n        if (!statCodes) {\r\n            //get list of stat codes.\r\n            statCodes = Object.keys(out.statData_)\r\n            //remove \"default\", if present\r\n            const index = statCodes.indexOf('default')\r\n            if (index > -1) statCodes.splice(index, 1)\r\n        }\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.updateStyle = function () {\r\n        //if not specified, build default color ramp\r\n        if (!out.catColors()) {\r\n            out.catColors({})\r\n            for (let i = 0; i < statCodes.length; i++) out.catColors()[statCodes[i]] = schemeCategory10[i % 10]\r\n        }\r\n\r\n        //if not specified, initialise category labels\r\n        out.catLabels_ = out.catLabels_ || {}\r\n\r\n        //build and assign texture to the regions\r\n        out.svg()\r\n            .selectAll(getRegionsSelector(out))\r\n            .style('fill', function (d) {\r\n                if (this.parentNode.classList.contains('em-cntrg')) return // Skip country regions\r\n                const id = d.properties.id\r\n\r\n                //compute composition\r\n                const composition = getComposition(id)\r\n\r\n                //case when no or missing data\r\n                if (!composition) return out.noDataFillStyle() || 'gray'\r\n\r\n                //make stripe pattern\r\n                const patt = out\r\n                    .svg()\r\n                    .append('pattern')\r\n                    .attr('id', 'pattern_' + id)\r\n                    .attr('x', '0')\r\n                    .attr('y', '0')\r\n                    .attr('width', out.stripeWidth())\r\n                    .attr('height', 1)\r\n                    .attr('patternUnits', 'userSpaceOnUse')\r\n                //use orientation, if specified\r\n                if (out.stripeOrientation()) patt.attr('patternTransform', 'rotate(' + out.stripeOrientation() + ')')\r\n\r\n                //background\r\n                patt.append('rect')\r\n                    .attr('x', 0)\r\n                    .attr('y', 0)\r\n                    .attr('width', out.stripeWidth())\r\n                    .attr('height', 1)\r\n                    .style('stroke', 'none')\r\n                    .style('fill', 'lightgray')\r\n\r\n                //make stripes, one per category\r\n                let x = 0\r\n                for (let code in composition) {\r\n                    //get stripe size\r\n                    let dx = composition[code]\r\n                    if (!dx) continue\r\n                    dx *= out.stripeWidth()\r\n\r\n                    //get stripe color\r\n                    const col = out.catColors()[code] || 'lightgray'\r\n\r\n                    //add stripe to pattern: a thin rectangle\r\n                    patt.append('rect')\r\n                        .attr('x', x)\r\n                        .attr('y', 0)\r\n                        .attr('height', 1)\r\n                        .style('stroke', 'none')\r\n                        .attr('code', code)\r\n                        .style('fill', col)\r\n                        //transition along x\r\n                        .style('pointer-events', 'none') // disable interaction during transition\r\n                        .transition()\r\n                        .duration(out.transitionDuration())\r\n                        .on('end', function () {\r\n                            // Re-enable after animation completes\r\n                            select(this).style('pointer-events', null)\r\n                        })\r\n                        .attr('width', dx)\r\n                    x += dx\r\n                }\r\n\r\n                //return pattern reference\r\n                return 'url(#pattern_' + id + ')'\r\n            })\r\n            .attr('nd', function (d) {\r\n                return !getComposition(d.properties.id) ? 'nd' : ''\r\n            })\r\n\r\n        // set region hover function\r\n        const selector = getRegionsSelector(out)\r\n        let regions = out.svg().selectAll(selector)\r\n        regions\r\n            .on('mouseover', function (e, rg) {\r\n                const sel = select(this)\r\n                sel.attr('fill___', sel.style('fill'))\r\n                sel.style('fill', out.hoverColor_)\r\n                if (out._tooltip) out._tooltip.mouseover(out.tooltip_.textFunction(rg, out))\r\n            })\r\n            .on('mousemove', function (e, rg) {\r\n                if (out._tooltip) out._tooltip.mousemove(e)\r\n            })\r\n            .on('mouseout', function () {\r\n                const sel = select(this)\r\n                let currentFill = sel.style('fill')\r\n                let newFill = sel.attr('fill___')\r\n                if (newFill) {\r\n                    sel.style('fill', sel.attr('fill___'))\r\n                    if (out._tooltip) out._tooltip.mouseout()\r\n                }\r\n            })\r\n\r\n        return out\r\n    }\r\n\r\n    //@override\r\n    out.getLegendConstructor = function () {\r\n        return StripeCompositionLegend.legend\r\n    }\r\n\r\n    //specific tooltip text function\r\n    const tooltipTextFunctionStripeComposition = function (rg, map) {\r\n        const regionName = rg.properties.na || rg.properties.name\r\n        const regionId = rg.properties.id\r\n        const comp = getComposition(regionId)\r\n        const data = []\r\n\r\n        for (const key in comp) data.push({ code: key, value: comp[key] })\r\n\r\n        let html = ''\r\n        // Header with region name and ID\r\n        html += `<div class=\"em-tooltip-bar\">\r\n        <b>${regionName}</b>${regionId ? ` (${regionId})` : ''}\r\n    </div>`\r\n\r\n        if (!data || data.length === 0) {\r\n            html += `<div>${out.noDataText()}</div>`\r\n            return html\r\n        }\r\n\r\n        // Build pie chart as SVG string\r\n        const r = out.pieChartRadius(),\r\n            ir = out.pieChartInnerRadius()\r\n\r\n        const pie_ = pie()\r\n            .sort(null)\r\n            .value((d) => d.value)\r\n        const arcGen = arc().innerRadius(ir).outerRadius(r)\r\n\r\n        const pieData = pie_(data)\r\n\r\n        let paths = ''\r\n        for (const d of pieData) {\r\n            const fill = out.catColors()[d.data.code] || 'lightgray'\r\n            const dPath = arcGen(d)\r\n            paths += `<path d=\"${dPath}\" fill=\"${fill}\" stroke=\"darkgray\"></path>`\r\n        }\r\n\r\n        const svg = `\r\n        <div style=\"display: flex; justify-content: center;\">\r\n            <svg viewBox=\"${-r} ${-r} ${2 * r} ${2 * r}\" width=\"${2 * r}\">\r\n                <g>${paths}</g>\r\n            </svg>\r\n        </div>\r\n    `\r\n\r\n        html += svg\r\n        return html\r\n    }\r\n    //specific tooltip text function\r\n    out.tooltip_.textFunction = tooltipTextFunctionStripeComposition\r\n\r\n    return out\r\n}\r\n","import { scaleLinear } from 'd3-scale'\r\nimport { min, max } from 'd3-array'\r\nimport * as Choropleth from './map-choropleth'\r\nimport { getRegionsSelector, spaceAsThousandSeparator } from '../../core/utils'\r\nimport * as ChoroplethLegend from '../../legend/choropleth/legend-choropleth'\r\nimport { select } from 'd3-selection'\r\n\r\nexport const map = function (config) {\r\n    // inherits and extends choropleth map\r\n    const out = Choropleth.map(config)\r\n\r\n    out.alphaData_ = null\r\n    out.opacityScale_ = null\r\n\r\n    out.opacityScale = function (v) {\r\n        if (!arguments.length) return out.opacityScale_\r\n        out.opacityScale_ = v\r\n        return out\r\n    }\r\n\r\n    const originalUpdateStatValues = out.updateStatValues\r\n    out.updateStatValues = function () {\r\n        //add extra alpha logic to choropleth-map.js code\r\n        const alpha = out.statData('alpha')\r\n        if (!alpha || !alpha.isReady()) {\r\n            out.alphaData_ = null\r\n            return out\r\n        }\r\n\r\n        out.alphaData_ = alpha\r\n        const values = alpha.getArray().filter((v) => v != null && v !== ':' && !isNaN(+v))\r\n\r\n        if (!out.opacityScale_) {\r\n            const minStat = min(values)\r\n            const maxStat = max(values)\r\n            out.opacityScale_ = values.length > 0 ? scaleLinear().domain([minStat, maxStat]).range([0.1, 1]) : null\r\n        }\r\n\r\n        //continue with map-choropleth.js code\r\n        originalUpdateStatValues.call(out)\r\n\r\n        return out.updateStyle()\r\n    }\r\n\r\n    const originalUpdateStyle = out.updateStyle\r\n    out.updateStyle = function () {\r\n        if (!out.svg_ || !out.opacityScale_) return out\r\n        //add mapType css class\r\n        out.svg_.classed('em--alpha', true)\r\n\r\n        const stats = out.statData()\r\n        if (!stats || !stats.isReady()) return out\r\n        const alphaData = out.statData('alpha')\r\n        if (!alphaData || !alphaData.isReady()) return out\r\n\r\n        const selector = getRegionsSelector(out)\r\n        const regions = out.svg().selectAll(selector)\r\n\r\n        regions.each(function (rg) {\r\n            const sel = select(this)\r\n            const statVal = stats.get(rg.properties.id)?.value\r\n            const alphaVal = alphaData.get(rg.properties.id)?.value\r\n\r\n            if (statVal === undefined || statVal === null || statVal === ':') {\r\n                return // skip regions with no main stat\r\n            }\r\n\r\n            if (alphaVal === 'nd' || alphaVal == null) {\r\n                const grey = out.noDataFillStyle_ || 'gray'\r\n                sel.attr('ecl', 'nd')\r\n                    .attr('force-grey', '1')\r\n                    .style('fill', grey)\r\n                    .attr('fill', 'grey')\r\n                    .attr('fill___', grey) // so hover-out reverts to grey\r\n                    .style('opacity', 1)\r\n                return\r\n            }\r\n\r\n            sel.style('opacity', out.opacityScale_(+alphaVal))\r\n        })\r\n\r\n        originalUpdateStyle.call(out)\r\n        return out\r\n    }\r\n\r\n    out.getLegendConstructor = function () {\r\n        return ChoroplethLegend.legend\r\n    }\r\n\r\n    out.tooltip_.textFunction = function (region, map) {\r\n        const buf = []\r\n        const regionName = region.properties.na || region.properties.name\r\n        const regionId = region.properties.id\r\n        buf.push(`<div class=\"em-tooltip-bar\"><b>${regionName}</b>${regionId ? ` (${regionId})` : ''}</div>`)\r\n\r\n        const statData = map.statData()\r\n        const alphaData = map.alphaData_ || map.statData('alpha')\r\n\r\n        const sv = statData.get(regionId)\r\n        const av = alphaData?.get(regionId)\r\n\r\n        const unit = statData.unitText?.() || ''\r\n        const alphaUnit = alphaData?.unitText?.() || ''\r\n\r\n        const datasetLabel = statData.label_ ? statData.label_ + ': ' : ''\r\n        const alphaDatasetLabel = alphaData?.label_ ? alphaData?.label_ + ': ' : ''\r\n\r\n        if (!sv || (sv.value !== 0 && !sv.value) || sv.value === ':') {\r\n            buf.push(`\r\n        <div class=\"em-tooltip-text no-data\">\r\n            <table class=\"em-tooltip-table\">\r\n                <tbody>\r\n                    <tr><td>${map.noDataText_}</td></tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    `)\r\n            return buf.join('')\r\n        }\r\n\r\n        // Build a single table for both dataset and alpha values\r\n        buf.push(`\r\n    <div class=\"em-tooltip-text\">\r\n        <table class=\"em-tooltip-table\">\r\n            <tbody>\r\n                <tr>\r\n                    <td>${datasetLabel}${spaceAsThousandSeparator(sv.value)} ${unit}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>${\r\n                        !av || av.value === ':' || av.value == null\r\n                            ? `${alphaDatasetLabel}${map.noDataText_}`\r\n                            : `${alphaDatasetLabel}${spaceAsThousandSeparator(av.value)} ${alphaUnit}`\r\n                    }</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n`)\r\n\r\n        return buf.join('')\r\n    }\r\n\r\n    return out\r\n}\r\n"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","self","___CSS_LOADER_EXPORT___","push","id","setAttributesWithoutAttributes","styleElement","nonce","setAttribute","stylesInDOM","getIndexByIdentifier","identifier","result","i","length","modulesToDom","list","options","idCountMap","identifiers","item","base","count","concat","indexByIdentifier","obj","css","media","sourceMap","supports","layer","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","styleTagTransform","styleSheet","cssText","firstChild","removeChild","appendChild","document","createTextNode","_OverloadYield","e","d","this","v","k","__esModule","regeneratorAsyncGen","_regeneratorAsync","n","r","t","o","a","next","then","done","value","cssWithMappingToString","toString","map","content","needLayer","join","modules","dedupe","undefined","alreadyImportedModules","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","_regeneratorKeys","Object","unshift","pop","insertStyleElement","element","createElement","setAttributes","attributes","insert","_regeneratorDefine","defineProperty","regeneratorDefine","_invoke","enumerable","configurable","writable","_typeof","_regeneratorValues","Symbol","iterator","call","isNaN","TypeError","OverloadYield","regenerator","regeneratorAsync","regeneratorAsyncIterator","regeneratorKeys","regeneratorValues","_regeneratorRuntime","m","getPrototypeOf","__proto__","constructor","displayName","name","stop","_catch","abrupt","delegateYield","resultName","finish","f","_t","p","prev","sent","wrap","w","reverse","isGeneratorFunction","mark","awrap","AsyncIterator","async","u","keys","values","memo","insertBySelector","style","target","getTarget","styleTarget","querySelector","window","HTMLIFrameElement","contentDocument","head","Error","prototype","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","c","resolve","asyncIterator","apply","removeStyleElement","parentNode","_regeneratorAsyncGen","Promise","_regenerator","toStringTag","Generator","create","y","G","bind","l","GeneratorFunction","GeneratorFunctionPrototype","setPrototypeOf","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","definition","key","get","chunkId","prop","hasOwnProperty","b","baseURI","location","href","nc","locals","_arrayLikeToArray","Array","_unsupportedIterableToArray","slice","from","test","_arrayWithHoles","isArray","_iterableToArrayLimit","_nonIterableRest","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","none","selector","array","x","empty","querySelectorAll","matches","childMatcher","node","find","childFirst","firstElementChild","filter","children","EnterNode","parent","datum","ownerDocument","namespaceURI","_next","_parent","__data__","bindIndex","group","enter","exit","groupLength","dataLength","bindKey","keyValue","nodeByKeyValue","Map","keyValues","has","set","delete","arraylike","ascending","NaN","child","insertBefore","xhtml","svg","xlink","xml","xmlns","prefix","indexOf","namespaces","space","local","attrRemove","removeAttribute","attrRemoveNS","fullname","removeAttributeNS","attrConstant","attrConstantNS","setAttributeNS","attrFunction","arguments","attrFunctionNS","defaultView","styleRemove","removeProperty","styleConstant","priority","setProperty","styleFunction","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","classArray","string","trim","split","classList","ClassList","_node","_names","getAttribute","classedAdd","names","add","classedRemove","classedTrue","classedFalse","classedFunction","textRemove","textContent","textConstant","textFunction","htmlRemove","innerHTML","htmlConstant","htmlFunction","raise","nextSibling","lower","previousSibling","creatorInherit","uri","documentElement","createElementNS","creatorFixed","namespace","constantNull","selection_cloneShallow","clone","cloneNode","selection_cloneDeep","onRemove","typename","on","__on","j","type","removeEventListener","listener","onAdd","contextListener","event","addEventListener","dispatchEvent","params","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","contains","groups","parents","_groups","_parents","selection","select","subgroups","subnode","subgroup","selectAll","arrayAll","selectorAll","selectChild","match","childFind","selectChildren","childrenFilter","matcher","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","sparse","onenter","onupdate","onexit","append","merge","order","context","groups0","groups1","m0","m1","Math","min","merges","group0","group1","selection_selection","compareDocumentPosition","sort","compare","compareNode","sortgroups","sortgroup","callback","nodes","size","each","attr","getAttributeNS","property","classed","text","html","before","deep","typenames","parseTypenames","dispatch","valueof","max","quantileSorted","floor","value0","bisector","compare1","compare2","delta","left","lo","hi","mid","zero","center","right","ascendingBisect","bisectRight","initRange","domain","range","unknown","thresholds","rescale","scale","bisect","invertExtent","_","quantiles","copy","e10","sqrt","e5","e2","tickSpec","start","step","power","log10","error","pow","factor","i2","inc","round","tickIncrement","extend","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","RegExp","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","format","toLowerCase","exec","parseInt","rgbn","Rgb","rgba","hsla","g","rgbConvert","opacity","rgb_formatHex","hex","rgb_formatRgb","clampa","clampi","h","s","Hsl","hslConvert","clamph","clampt","hsl2rgb","m2","basis","t1","v0","v1","v2","v3","t2","t3","channels","assign","displayable","formatHex8","color_formatHex8","formatHsl","color_formatHsl","clamp","rgb_formatHex8","hsl","linear","gamma","nogamma","exponential","rgbGamma","color","end","rgbSpline","spline","colors","rgbBasis","genericArray","nb","na","Date","setTime","reA","reB","source","am","bm","bs","bi","lastIndex","q","one","date","ArrayBuffer","isView","DataView","valueOf","object","unit","normalize","constants","bimap","interpolate","d0","d1","r0","r1","polymap","transformer","transform","untransform","piecewise","output","input","clamper","invert","rangeRound","continuous","prefixExponent","re","formatSpecifier","specifier","FormatSpecifier","fill","align","sign","symbol","width","comma","precision","formatDecimalParts","toExponential","coefficient","abs","exponent","toFixed","toLocaleString","replace","toPrecision","formatRounded","toUpperCase","formatPrefix","prefixes","locale","grouping","thousands","substring","formatGroup","Number","currencyPrefix","currency","currencySuffix","decimal","numerals","formatNumerals","String","percent","minus","nan","newFormat","formatTypes","suffix","formatType","maybeSuffix","valuePrefix","valueSuffix","valueNegative","out","formatTrim","charCodeAt","Infinity","padding","defaultLocale","tickFormat","tickStep","precisionPrefix","precisionRound","precisionFixed","linearish","ticks","nice","prestep","maxIter","ceil","quantize","x0","x1","threshold","scheme","ramp","PI","Xn","Zn","t0","labConvert","Lab","Hcl","hcl2lab","z","rgb2lrgb","xyz2lab","lab","lab2xyz","lrgb2rgb","hclConvert","atan2","cos","sin","asyncGeneratorStep","_asyncToGenerator","_throw","hcl","noop","Dispatch","T","types","that","args","taskHead","taskTail","timeout","interval","clockLast","clockNow","clockSkew","clock","performance","now","setFrame","requestAnimationFrame","setTimeout","clearNow","Timer","_call","_time","timer","delay","time","restart","wake","timerFlush","nap","sleep","poke","clearTimeout","clearInterval","setInterval","elapsed","emptyOn","emptyTween","timing","schedules","__transition","tween","schedule","state","tick","duration","ease","init","active","svgNode","translateX","translateY","rotate","skewX","scaleX","scaleY","atan","interpolateTransform","parse","pxComma","pxParen","degParen","translate","xa","ya","xb","yb","interpolateTransformCss","parseCss","DOMMatrix","WebKitCSSMatrix","isIdentity","decompose","interpolateTransformSvg","parseSvg","baseVal","consolidate","matrix","tweenRemove","tween0","tween1","tweenFunction","tweenValue","transition","_id","value1","string00","interpolate0","string1","string0","string10","attrTweenNS","attrInterpolateNS","_value","attrTween","attrInterpolate","delayFunction","delayConstant","durationFunction","durationConstant","Transition","_name","newId","selection_prototype","inherit","id0","id1","onFunction","on0","on1","sit","every","styleTween","styleNull","styleMaybeRemove","listener0","styleInterpolate","textTween","textInterpolate","removeFunction","easeConstant","easeVarying","reject","cancel","interrupt","defaultTiming","cubicInOut","number1","number2","nonpassivecapture","capture","passive","preventDefault","stopImmediatePropagation","cosh","exp","zoomRho","rho","rho2","rho4","zoom","p0","p1","S","ux0","uy0","w0","ux1","uy1","w1","dx","dy","d2","log","b0","b1","coshr0","tanh","sinh","SQRT2","_1","_2","sourceEvent","currentTarget","ownerSVGElement","createSVGPoint","point","clientX","clientY","matrixTransform","getScreenCTM","inverse","getBoundingClientRect","rect","clientLeft","top","clientTop","pageX","pageY","ZoomEvent","defineProperties","Transform","applyX","applyY","invertX","invertY","rescaleX","rescaleY","ctrlKey","button","SVGElement","hasAttribute","viewBox","height","clientWidth","clientHeight","defaultTransform","__zoom","defaultWheelDelta","deltaY","deltaMode","navigator","maxTouchPoints","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","touchstarting","touchfirst","touchending","constrain","wheelDelta","touchable","scaleExtent","listeners","clickDistance2","tapDistance","wheeled","mousedowned","dblclicked","touchstarted","touchmoved","touchended","centroid","gesture","clean","__zooming","Gesture","taps","wheel","mouse","wheelidled","view","mousemoved","moved","y0","mouseupped","yesdrag","noclick","MozUserSelect","__noselect","changedTouches","k1","shiftKey","started","touches","touch0","touch1","l0","l1","dp","dl","hypot","collection","scaleBy","scaleTo","translateBy","translateTo","emit","clickDistance","ensureGroup","container","className","updateCSSRule","startsWith","_styleSheets","styleSheets","_step","_iterator","_createForOfIteratorHelper","cssRules","rules","rule","selectorText","err","customSheet","getElementById","sheet","insertRule","console","getFontSizeFromClass","tempElement","position","visibility","lineHeight","fontSize","body","parseFloat","getCSSPropertyFromClass","propertyName","propertyValue","applyComputedStylesToSVG","PAINT_PROPS","Set","PROPS","_toConsumableArray","inlineComputedStyle","forEach","el","cs","tagName","fs","ensureSvgSize","spaceAsThousandSeparator","number","generateUniqueId","random","substr","executeForAllInsets","insets","mainSvgId","parameter","parameter2","geo","insetGroup","inset","nestedInset","svgId_","getParameterByName","results","search","decodeURIComponent","getTextColorForBackground","backgroundColor","tempDiv","computedColor","getRegionsSelector","Geometries","userGeometries","gridCartogram_","geo_","getLegendRegionsSelector","getApproxCurrentGeoBbox","halfWidth","position_","width_","halfHeight","height_","toPropertyKey","toPrimitive","_defineProperty","Adder","_partials","Float64Array","_n","epsilon","pi","halfPi","quarterPi","asin","streamGeometry","geometry","stream","streamGeometryType","W0","W1","X0","Y0","Z0","X1","Y1","Z1","X2","Y2","Z2","lambda00","phi00","z0","streamObjectType","Feature","FeatureCollection","features","Sphere","sphere","Point","coordinates","MultiPoint","LineString","streamLine","MultiLineString","Polygon","streamPolygon","MultiPolygon","GeometryCollection","geometries","closed","coordinate","lineStart","lineEnd","polygonStart","polygonEnd","centroidStream","centroidPoint","centroidLineStart","centroidLineEnd","centroidRingStart","centroidRingEnd","lambda","phi","cosPhi","centroidPointCartesian","centroidLinePointFirst","centroidLinePoint","centroidRingPointFirst","centroidRingPoint","cx","cy","cz","line","lines","rejoin","shift","Intersection","points","other","entry","segments","compareIntersection","startInside","subject","clip","segment","pointEqual","current","isSubject","arrays","flatten","clipMax","clipMin","clipRectangle","y1","visible","to","direction","a1","corner","comparePoint","ca","cb","polygon","ring","x__","y__","v__","x_","y_","v_","first","activeStream","bufferStream","clipStream","linePoint","polygonInside","winding","a0","cleanInside","ax","ay","methods","TransformStream","boundsStream","boundsPoint","bounds","fit","projection","fitBounds","clipExtent","fitExtent","fitSize","fitWidth","fitHeight","x00","y00","areaSum","areaRingSum","areaStream","areaRingStart","areaRingEnd","area","areaPointFirst","areaPoint","centroidPointFirstLine","centroidPointLine","centroidPointFirstRing","centroidPointRing","PathContext","_context","_radius","pointRadius","_line","_point","closePath","moveTo","lineTo","arc","lengthRing","lengthSum","lengthStream","lengthPointFirst","lengthPoint","cacheDigits","cacheAppend","cacheRadius","cacheCircle","PathString","digits","_append","appendRound","RangeError","strings","projectionStream","contextStream","path","measure","spherical","cartesian","cartesianDot","cartesianCross","cartesianAddInPlace","cartesianScale","vector","cartesianNormalizeInPlace","longitude","pointVisible","clipLine","sink","ringBuffer","ringSink","polygonStarted","pointRing","ringStart","ringEnd","sinPhi","normal","angle","sum","point0","lambda0","phi0","sinPhi0","cosPhi0","lambda1","sinPhi1","cosPhi1","point1","phi1","absDelta","antimeridian","intersection","phiArc","polygonContains","pointLine","ringSegments","validSegment","clipAntimeridianLine","sign0","sign1","clipAntimeridianIntersect","sinLambda0Lambda1","clipAntimeridianInterpolate","circleStream","radius","cosRadius","sinRadius","circleRadius","acos","compose","rotationIdentity","deltaLambda","deltaPhi","deltaGamma","rotationLambda","rotationPhiGamma","forwardRotationLambda","rotation","cosDeltaPhi","sinDeltaPhi","cosDeltaGamma","sinDeltaGamma","cosMinDistance","project","delta2","resampleLineTo","c0","c1","depth","phi2","lambda2","x2","y2","dx2","dy2","dz","a00","b00","c00","resampleStream","ringPoint","resampleNone","transformRadians","scaleTranslateRotate","sx","sy","alpha","scaleTranslate","cosAlpha","sinAlpha","ai","ci","fi","projectionMutator","projectAt","projectResample","projectTransform","projectRotateTransform","cache","cacheStream","theta","preclip","postclip","recenter","resample","reset","transformRotate","clipAngle","cr","smallRadius","notHemisphere","intersect","two","n1","n2","n2n2","n1n2","determinant","c2","n1xn2","A","uu","polar","q1","code","v00","point2","reflectX","reflectY","SQRT1_2","robinsonRaw","di","bx","by","yy","filterEvents","mouseenter","mouseleave","filterContextListener","related","relatedTarget","event1","event0","customEvent","nextId","Local","touch","DragEvent","defaultContainer","defaultSubject","mousedownx","mousedowny","mousemoving","gestures","drag","beforestart","sublisteners","tauEpsilon","Path","_x0","_y0","_x1","_y1","quadraticCurveTo","bezierCurveTo","arcTo","x21","y21","x01","y01","l01_2","x20","y20","l21_2","l20_2","l21","l01","t01","t21","ccw","cw","da","constant","arcInnerRadius","innerRadius","arcOuterRadius","outerRadius","arcStartAngle","startAngle","arcEndAngle","endAngle","arcPadAngle","padAngle","cornerTangents","rc","ox","oy","x11","y11","x10","y10","D","cx0","cy0","cx1","cy1","Linear","areaStart","areaEnd","curve","radial","Radial","_curve","kr","Basis","BasisClosed","BasisOpen","Bundle","beta","_basis","_beta","_x2","_x3","_x4","_y2","_y3","_y4","_x","_y","custom","bundle","Cardinal","tension","cardinal","CardinalClosed","_x5","_y5","CardinalOpen","_l01_a","_l01_2a","_l12_a","_l12_2a","_l23_a","_l23_2a","CatmullRom","_alpha","x23","y23","catmullRom","CatmullRomClosed","CatmullRomOpen","LinearClosed","slope3","h0","h1","s0","s1","slope2","MonotoneX","MonotoneY","ReflectContext","Natural","controlPoints","Step","_t0","px","py","classCallCheck","instance","Constructor","createClass","props","descriptor","protoProps","staticProps","_extends","receiver","desc","getOwnPropertyDescriptor","inherits","subClass","superClass","possibleConstructorReturn","ReferenceError","Annotation","_ref","_ref$x","_ref$y","nx","ny","_ref$dy","_ref$dx","_ref$color","connector","note","disable","_dx","_dy","_color","_className","_type","updatePosition","setPosition","redrawSubject","clearComponents","updateOffset","setOffset","redrawConnector","redrawNote","get$$1","set$$1","setClassName","_ref2","_ref3","json","AnnotationCollection","annotations","accessors","accessorsInverse","clearTypes","newSettings","setPositionWithAccessors","_this","editMode","_editMode","updateEditMode","updateDisable","updateTextWrap","textWrap","updateText","drawText","updateNotePadding","notePadding","_this2","getNoteBBoxOffset","positionX","positionY","leftRightDynamic","topBottomDynamic","orientationTopBottom","orientationLeftRight","lineBuilder","_ref$curve","canvasContext","classID","lineGen","defined","buffer","defined0","builder","pathMethods","attrs","arcBuilder","arcShape","cornerRadius","padRadius","a01","a11","a10","da0","da1","ap","rp","rc0","rc1","oc","x3","y3","x32","y32","kc","lc","lineSetup","subjectType","annotation","offset","subjectData","radiusPadding","connectorCurve","connectorData","createPoints","handles","cHandles","pointHandle","_ref$cx","_ref$cy","move","updatePoint","mapHandles","arr","arr2","toConsumableArray","components","anchors","diff","subjectCircle","circleHandles","_ref2$cx","_ref2$cy","r2","updateRadius","Type","dispatcher","noteContent","handler","addHandlers","component","offsetCornerX","offsetCornerY","mapX","mapY","drawOnSVG","builders","addHandles","_ref5","_ref5$r","newWithClass","addAttrs","removeAttrs","currentAttrs","getNoteBBox","bboxWithoutHandles","bbox","offsetX","offsetY","drawSubject","subjectParams","rHandles","updateWidth","updateHeight","subjectRect","subjectThreshold","_ref$subjectData","_ref$type","typeSettings","notCornerOffset","placement","xleftcorner","xrightcorner","ytopcorner","ybottomcorner","xleft","xright","ytop","ybottom","circlebg","circle","pointer","notCornerPointerXY","bHandles","dragBadge","stroke","subjectBadge","_subject","_subject$components","_subject$handles","dragSubject","drawConnector","_this3","connectorParams","diffY","diffX","xe","ye","opposite","_angle","connectorElbow","connectorLine","_connector","_connector$components","_connector$handles","line$$1","endType","_ref$scale","angleOffset","connectorArrow","endScale","dot","connectorDot","drawNote","_this4","noteData","noteParams","lineType","noteVertical","noteHorizontal","_note","_note$components","_note$handles","dragNote","dragging","dragstarted","dragended","drawNoteContent","orientation","_noteAlignment","_ref$padding","_ref$bbox","_ref$offset","noteAlignment","drawOnScreen","drawFunction","draw","stopPropagation","_this5","customType","initialType","_init","_initialType","settings","_this6","d3NoteText","_Type","_this7","titleBBox","label","wrapLength","wrapSplitter","bgPadding","bgPaddingFinal","bottom","title","getBBox","d3Label","d3Callout","d3CalloutCircle","d3CalloutRect","ThresholdMap","_d3Callout","d3XYThreshold","words","word","tspan","getComputedTextLength","reduce","yOffset","ids","annotationDispatcher","sel","translatedAnnotations","updatedAccessors","some","appendAnnotations","svg_","zoomGroup","annotationsConfig","annotations_","annotationTypeMap","annotationLabel","annotationCallout","annotationCalloutRect","annotationCalloutCircle","annotationXYThreshold","annotationsWithTypes","annotationType","_objectSpread","makeAnnotations","addLabelsToMap","zg","_map$labels_","_map$labels_2","labels_","config","DEFAULTLABELS","statLabelsPositions","DEFAULTSTATLABELPOSITIONS","_statLabelFormatter","valuesFormatter","existing","labelsContainer","_mapType","appendStatLabelCentroidsToMap","labelsArray","labels","proj_","_map$labels_3","shadowg","labelg","shadows","_projection","pos","updateValuesLabels","_map$labels_4","_map$labels_5","_map$labels_6","statLabels","filterFunction","statLabelsFilterFunction","defaultStatLabelFilter","statData","rg","labelText","statLabelsTextFunction","backgrounds","appendRect","paddingX","paddingY","labelWidth","labelHeight","warn","sv","properties","region","_map$labels_7","gsls","statLabelsGroup","statLabelRegions","getAllRegionFeatures","filteredRegions","findIndex","_pathFunction","processValueLabelCentroids","EUR_3035","cc","class","en","letterSpacing","fr","de","IC_32628","GP_32620","MQ_32620","GF_32622","RE_32740","YT_32738","MT_3035","PT20_32626","PT30_32628","LI_3035","IS_3035","SJ_SV_3035","SJ_JM_3035","CARIB_32620","WORLD_54030","AL","AT","BE","BG","HR","CY","CH","CZ","DK","EE","FI","FR","DE","EL","HU","IS","IE","IT","LV","LT","LU","MT","GE","UA","BA","MD","ME","MK","NL","NO","PL","PT","RO","RS","SK","SI","ES","SE","TR","UK","RU","responseJson","response","ok","status","statusText","fetch","topology","objects","transformPoint","kx","ky","arcs","kosovoBnFeatures","graticuleX","graticuleY","graticule","X","Y","DX","DY","outline","extentMajor","extentMinor","stepMajor","stepMinor","promisifyRequest","request","oncomplete","onsuccess","onabort","onerror","createStore","dbName","storeName","dbp","txMode","indexedDB","open","onupgradeneeded","createObjectStore","db","onclose","getDB","transaction","objectStore","defaultGetStoreFunc","defaultGetStore","customStore","store","put","memCache","TTL_MS","canUseIDB","isSecureContext","hostname","safeGetIDB","_safeGetIDB","_callee2","_context2","safeSetIDB","_safeSetIDB","_callee3","_t2","_context3","withCenterPoints","defaultGeoData","allNUTSGeoData","geoJSONs","mixed","rg0","rg1","rg2","rg3","cntbn","cntrg","nutsbn","nutsrg","gra","worldrg","worldbn","kosovo","statisticalRegions","centroidsData","centroidsFeatures","_allCentroidsFeatures","getRegionFeatures","nutsLevel_","getDefaultGeoData","filterGeometriesFunction","nutsLevel","promises","getDefaultGeoDataPromise","all","filtered","feature","CNTR_RG_20M_2020_4326","CNTR_BN_20M_2020_4326","NUTS_BN_20M_2021_RS_XK_border","geoGraticule","nutsLevels","buildUrl","year","proj","level","withCenter","fetchWithCache","_callee","url","cacheKey","mem","cached","record","timestamp","message","nuts2jsonBaseURL_","lvl","nutsYear_","scale_","worldMapTopojsonURL","includes","mainUrl","ptUrl","isGeoReady","allReady","insetTemplates_","setUserGeometries","addDefaultGeometriesToMap","drawGraticule","pathFunction","nutsYear","attachClickEventToRegions","addKosovoBorder","kosovoFeature","kosovoBn","bn","eu","efta","oth","co","bn1","bn2","POL_STAT","COAS_FLAG","addUserGeometriesToMap","elements","onEach","regions","_map$tooltip_$omitReg","_rg$properties","tooltip_","omitRegions","onRegionClick_","buildInset","mapType","mt","mapTemplate","_defaultCRS","insetScale_","footnote","showSourceLink","zoomExtent","insetZoomExtent_","insetBoxWidth_","insetTemplates","callback_","att","isInset","defaultInsetConfig","EUR","IC","GP","MQ","GF","RE","YT","PT20","PT30","LI","SJ_SV","SJ_JM","CARIB","WORLD","appendStamp","stampConfig","textColor","stampColor","strokeWidth","targetWidth","measureWidth","getLines","getWords","textRadius","getTextRadius","replaceAll","textElement","lineText1","lineWidth1","EOL","EOF","objectConverter","columns","inferColumns","rows","columnSet","row","column","pad","formatDate","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","milliseconds","getUTCMilliseconds","formatYear","getUTCFullYear","getUTCMonth","getUTCDate","delimiter","reFormat","DELIMITER","parseRows","N","I","eof","eol","token","preformatBody","formatValue","formatRow","convert","customConverter","formatBody","formatRows","csv","dsv","csvParse","csvParseRows","getGridLayout","gridCartogramPositions_","gridCartogramShape_","parseGridLayout","gridLayout","positionById","getGridData","_slicedToArray","_ref2$","col","drawSquareGrid","gridGroup","gridData","numCols","numRows","margins","gridCartogramMargins_","cellPadding","gridCartogramCellPadding_","cellWidth","cellHeight","cellSize","drawHexagonGrid","hexRadius","hexHeight","drawHexagon","centerGrid","svgWidth","svgHeight","orthographicRaw","azimuthalInvert","sc","SRS_WGS84_SEMIMAJOR","SRS_WGS84_ESQUARED","SEC_TO_RAD","HALF_PI","EPSLN","D2R","R2D","FORTPI","TWO_PI","SPI","primeMeridian","mm","to_meter","cm","ft","fath","kmi","km","mi","yd","ch","link","dm","in","ignoredChar","testkey","lkey","defData","paramName","paramVal","paramOutname","paramObj","rf","lat_0","lat0","lat_1","lat1","lat_2","lat2","lat_ts","lon_0","long0","lon_1","long1","lon_2","long2","rectified_grid_angle","lonc","longc","x_0","y_0","k_0","k0","r_a","R_A","zone","south","utmSouth","towgs84","datum_params","units","from_greenwich","pm","PrimeMeridian","nadgrids","datumCode","axis","legalAxis","approx","PROJJSONBuilderBase","getId","idNode","authority","convertUnit","conversion_factor","conversionFactor","convertAxis","abbreviationMatch","abbreviation","orderNode","unitNode","extractAxes","base_crs","conversion","csNode","coordinate_system","lengthUnitNode","datumOrEnsembleNode","datumOrEnsemble","datum_ensemble","primem","prime_meridian","ellipsoid","members","member","accuracyNode","accuracy","ellipsoidNode","semi_major_axis","inverse_flattening","method","parameters","param","sourceCrsNode","sourceCrsContent","source_crs","targetCrsNode","targetCrsContent","target_crs","transformationNode","transformation","scaleDifference","keyword","PROJJSONBuilder2015","super","subtype","usage","PROJJSONBuilder2019","usageNode","scope","buildPROJJSON","version","detectWKT2Version","parseString","txt","parser","Parser","NEUTRAL","whitespace","latin","endThings","digets","place","stack","currentObject","mapit","thing","sExpr","readCharicter","char","neutral","quoted","afterquote","afterItem","newObjects","d2r","applyProjectionDefaults","wkt","normalizedProjName","projName","processUnit","toValue","valueOrObject","calculateEllipsoid","semi_minor_axis","transformPROJJSON","projjson","srsCode","ellps","paramValue","latitude_of_false_origin","longitude_of_false_origin","latitude_of_standard_parallel","latitude_of_1st_standard_parallel","latitude_of_2nd_standard_parallel","latitude_of_projection_centre","longitude_of_projection_centre","easting_at_false_origin","northing_at_false_origin","latitude_of_natural_origin","longitude_of_natural_origin","longitude_of_origin","false_easting","easting_at_projection_centre","false_northing","northing_at_projection_centre","standard_parallel_1","standard_parallel_2","scale_factor_at_natural_origin","scale_factor_at_projection_centre","scale_factor_on_pseudo_standard_parallel","azimuth","azimuth_at_projection_centre","angle_from_rectified_to_skew_grid","knownTypes","cleanWKT","ii","setPropertiesFromWkt","AUTHORITY","PROJECTION","AXIS","axisOrder","UNIT","DATUM","SPHEROID","geogcs","GEOGCS","toMeter","TOWGS84","isFinite","rename","outName","inName","detectWKTVersion","normalizedWKT","lisp","defs","def","charAt","EPSG","ESRI","IAU2000","WGS84","GOOGLE","global","codes","testObj","testDef","testWKT","checkMercator","auth","maybeProjStr","checkProjStr","ext","testProj","destination","eccent","sinphi","cosphi","con","com","ts","dphi","eccnth","es","msfnz","forward","lon","lat","adjust_lon","tsfnz","phi2z","pt","projs","merc","projStore","len","getNormalizedProjName","MERIT","ellipseName","SGS85","GRS80","IAU76","airy","APL4","NWL9D","mod_airy","andrae","aust_SA","GRS67","bessel","bess_nam","clrk66","clrk80","clrk80ign","clrk58","CPM","delmbr","engelis","evrst30","evrst48","evrst56","evrst69","evrstSS","fschr60","fschr60m","fschr68","helmert","hough","intl","kaula","lerch","mprts","new_intl","plessis","krass","SEasia","walbeck","WGS60","WGS66","WGS7","Ellipsoid","datums","wgs84","ellipse","datumName","ch1903","ggrs87","nad83","nad27","potsdam","carthage","hermannskogel","mgi","osni52","ire65","rassadiran","nzgd49","osgb36","s_jtsk","beduaram","gunung_segara","rnb72","EPSG_5451","IGNF_LURESG","EPSG_4614","EPSG_4615","ESRI_37241","ESRI_37249","ESRI_37245","EPSG_4178","EPSG_4622","EPSG_4625","EPSG_5252","EPSG_4314","EPSG_4282","EPSG_4231","EPSG_4274","EPSG_4134","EPSG_4254","EPSG_4159","EPSG_4687","EPSG_4227","EPSG_4746","EPSG_4745","EPSG_6311","EPSG_4289","EPSG_4230","EPSG_4154","EPSG_4156","EPSG_4299","EPSG_4179","EPSG_4313","EPSG_4194","EPSG_4195","EPSG_4196","EPSG_4611","EPSG_4633","EPSG_4641","EPSG_4643","EPSG_4300","EPSG_4188","EPSG_4660","EPSG_4662","EPSG_3906","EPSG_4307","EPSG_6892","EPSG_4690","EPSG_4691","EPSG_4629","EPSG_4630","EPSG_4692","EPSG_9333","EPSG_9059","EPSG_4312","EPSG_4123","EPSG_4309","ESRI_104106","EPSG_4281","EPSG_4322","EPSG_4324","EPSG_4284","EPSG_4277","EPSG_4207","EPSG_4688","EPSG_4689","EPSG_4720","EPSG_4273","EPSG_4240","EPSG_4817","ESRI_104131","EPSG_4265","EPSG_4263","EPSG_4298","EPSG_4270","EPSG_4229","EPSG_4220","EPSG_4214","EPSG_4232","EPSG_4238","EPSG_4168","EPSG_4131","EPSG_4152","EPSG_5228","EPSG_8351","EPSG_4683","EPSG_4133","EPSG_7373","EPSG_9075","EPSG_9072","EPSG_9294","EPSG_4212","EPSG_4191","EPSG_4237","EPSG_4740","EPSG_4124","EPSG_5681","EPSG_4141","EPSG_4204","EPSG_4319","EPSG_4200","EPSG_4130","EPSG_4127","EPSG_4149","EPSG_4617","EPSG_4663","EPSG_4664","EPSG_4665","EPSG_4666","EPSG_4756","EPSG_4723","EPSG_4726","EPSG_4267","EPSG_5365","EPSG_4218","EPSG_4242","EPSG_4216","ESRI_104105","ESRI_104129","EPSG_4673","EPSG_4202","EPSG_4203","EPSG_3819","EPSG_8694","EPSG_4145","EPSG_4283","EPSG_4317","EPSG_4272","EPSG_4248","EPSG_5561","EPSG_5233","ESRI_104130","ESRI_104102","ESRI_37207","EPSG_4675","ESRI_104109","ESRI_104112","ESRI_104113","IGNF_WGS72G","IGNF_NTFG","IGNF_EFATE57G","IGNF_PGP50G","IGNF_REUN47G","IGNF_CSG67G","IGNF_GUAD48G","IGNF_TAHI51G","IGNF_TAHAAG","IGNF_NUKU72G","IGNF_PETRELS72G","IGNF_WALL78G","IGNF_MAYO50G","IGNF_TANNAG","IGNF_IGN72G","IGNF_ATIGG","IGNF_FANGA84G","IGNF_RUSAT84G","IGNF_KAUE70G","IGNF_MOP90G","IGNF_MHPF67G","IGNF_TAHI79G","IGNF_ANAA92G","IGNF_MARQUI72G","IGNF_APAT86G","IGNF_TUBU69G","IGNF_STPM50G","EPSG_4150","EPSG_4754","ESRI_104101","EPSG_4693","EPSG_6207","EPSG_4153","EPSG_4132","EPSG_4221","EPSG_4266","EPSG_4193","EPSG_5340","EPSG_4246","EPSG_4318","EPSG_4121","EPSG_4223","EPSG_4158","EPSG_4285","EPSG_4613","EPSG_4607","EPSG_4475","EPSG_4208","EPSG_4743","EPSG_4710","EPSG_7881","EPSG_4682","EPSG_4739","EPSG_4679","EPSG_4750","EPSG_4644","EPSG_4695","EPSG_4292","EPSG_4302","EPSG_4143","EPSG_4606","EPSG_4699","EPSG_4247","EPSG_4160","EPSG_4161","EPSG_9251","EPSG_9253","EPSG_4297","EPSG_4269","EPSG_4301","EPSG_4618","EPSG_4612","EPSG_4678","EPSG_4250","EPSG_4144","EPSG_4147","EPSG_4259","EPSG_4164","EPSG_4211","EPSG_4182","EPSG_4224","EPSG_4225","EPSG_5527","EPSG_4752","EPSG_4310","EPSG_9248","EPSG_4680","EPSG_4701","EPSG_4706","EPSG_4805","EPSG_4201","EPSG_4210","EPSG_4183","EPSG_4139","EPSG_4668","EPSG_4717","EPSG_4732","EPSG_4280","EPSG_4209","EPSG_4261","EPSG_4658","EPSG_4721","EPSG_4222","EPSG_4601","EPSG_4602","EPSG_4603","EPSG_4605","EPSG_4621","EPSG_4657","EPSG_4316","EPSG_4642","EPSG_4698","EPSG_4192","EPSG_4311","EPSG_4135","ESRI_104138","EPSG_4245","EPSG_4142","EPSG_4213","EPSG_4253","EPSG_4129","EPSG_4713","EPSG_4239","EPSG_4146","EPSG_4155","EPSG_4165","EPSG_4672","EPSG_4236","EPSG_4251","EPSG_4271","EPSG_4175","EPSG_4716","EPSG_4315","EPSG_4744","EPSG_4244","EPSG_4293","EPSG_4714","EPSG_4736","EPSG_6883","EPSG_6894","EPSG_4205","EPSG_4256","EPSG_4262","EPSG_4604","EPSG_4169","EPSG_4620","EPSG_4184","EPSG_4616","EPSG_9403","EPSG_4684","EPSG_4708","EPSG_4707","EPSG_4709","EPSG_4712","EPSG_4711","EPSG_4718","EPSG_4719","EPSG_4724","EPSG_4725","EPSG_4735","EPSG_4722","EPSG_4728","EPSG_4734","EPSG_4727","EPSG_4729","EPSG_4730","EPSG_4733","ESRI_37218","ESRI_37240","ESRI_37221","ESRI_4305","ESRI_104139","EPSG_4748","EPSG_4219","EPSG_4255","EPSG_4257","EPSG_4646","EPSG_6881","EPSG_6882","EPSG_4715","IGNF_RGF93GDD","IGNF_RGM04GDD","IGNF_RGSPM06GDD","IGNF_RGTAAF07GDD","IGNF_RGFG95GDD","IGNF_RGNCG","IGNF_RGPFGDD","IGNF_ETRS89G","IGNF_RGR92GDD","EPSG_4173","EPSG_4180","EPSG_4619","EPSG_4667","EPSG_4075","EPSG_6706","EPSG_7798","EPSG_4661","EPSG_4669","EPSG_8685","EPSG_4151","EPSG_9702","EPSG_4758","EPSG_4761","EPSG_4765","EPSG_8997","EPSG_4023","EPSG_4670","EPSG_4694","EPSG_4148","EPSG_4163","EPSG_4167","EPSG_4189","EPSG_4190","EPSG_4176","EPSG_4659","EPSG_3824","EPSG_3889","EPSG_4046","EPSG_4081","EPSG_4558","EPSG_4483","EPSG_5013","EPSG_5264","EPSG_5324","EPSG_5354","EPSG_5371","EPSG_5373","EPSG_5381","EPSG_5393","EPSG_5489","EPSG_5593","EPSG_6135","EPSG_6365","EPSG_5246","EPSG_7886","EPSG_8431","EPSG_8427","EPSG_8699","EPSG_8818","EPSG_4757","EPSG_9140","EPSG_8086","EPSG_4686","EPSG_4737","EPSG_4702","EPSG_4747","EPSG_4749","EPSG_4674","EPSG_4755","EPSG_4759","EPSG_4762","EPSG_4763","EPSG_4764","EPSG_4166","EPSG_4170","EPSG_5546","EPSG_7844","EPSG_4818","ep2","datum_type","grids","loadedNadgrids","readGeotiffGrid","tiff","subgrids","subGridCount","getImageCount","subgridIndex","image","getImage","readRasters","lim","getWidth","getHeight","imageBBoxRadians","getBoundingBox","degreesToRadians","del","fileDirectory","ModelPixelScale","maxX","minY","latitudeOffsetBand","longitudeOffsetBand","secondsToRadians","ll","cvs","tifGrid","header","nSubgrids","parseNadgridString","optional","mandatory","grid","isNull","degrees","decodeString","fromCharCode","Uint8Array","mapNodes","longitudeShift","latitudeShift","readGridHeader","isLittleEndian","lowerLatitude","getFloat64","upperLatitude","lowerLongitude","upperLongitude","latitudeInterval","longitudeInterval","gridNodeCount","getInt32","readGridNodes","gridHeader","includeErrorFields","nodesOffset","gridRecordLength","gridShiftRecords","getFloat32","latitudeAccuracy","longitudeAccuracy","Projection","parseCode","ourProj","projections","datumDef","Datum","sphere_","ecc","eccentricity","a2","b2","getNadgrids","datumObj","geodeticToGeocentric","Rn","Sin_Lat","Sin2_Lat","Cos_Lat","Longitude","Latitude","Height","geocentricToGeodetic","P","RR","CT","ST","RX","RK","RN","CPHI0","SPHI0","CPHI","SPHI","SDPHI","iter","genau","Z","checkParams","dest","compareDatums","source_a","source_es","applyGridShift","dest_a","dest_b","dest_es","geocentricToWgs84","Dx_BF","Dy_BF","Dz_BF","Rx_BF","Ry_BF","Rz_BF","M_BF","geocentricFromWgs84","x_tmp","y_tmp","z_tmp","attemptedGrids","outer","jj","subgrid","minX","maxY","applySubgridShift","pin","ct","val","tb","nadInterpolate","dif","inx","indx","frct","f00","f10","f11","f01","m11","m10","m00","m01","crs","denorm","xin","yin","zin","checkCoord","num","enforceAxis","hasZ","toPoint","checkSanity","checkNotWGS","adjust_axis","datum_transform","coords","transformedArray","checkProj","oProj","fromProjOrToProj","toProjOrCoord","coord","fromProj","toProj","single","SET_ORIGIN_COLUMN_LETTERS","SET_ORIGIN_ROW_LETTERS","O","V","mgrs","UTMtoLL","decode","encode","utm","seasting","easting","snorthing","northing","zoneNumber","zoneLetter","get100kID","setParm","get100kSetForZone","setColumn","setRow","getLetter100kID","parm","colOrigin","rowOrigin","colInt","rowInt","rollover","LLtoUTM","eccPrimeSquared","C","M","LongOriginRad","ZoneNumber","Lat","Long","eccSquared","LatRad","degToRad","LongRad","UTMEasting","UTMNorthing","getLetterDesignator","deg","radToDeg","rad","N1","T1","C1","R1","LongOrigin","mu","phi1Rad","e1","topRight","LetterDesignator","mgrsString","testChar","hunK","sb","east100k","getEastingFromChar","curCol","eastingValue","rewindMarker","north100k","getNorthingFromChar","curRow","northingValue","getMinNorthing","remainder","accuracyBonus","sepEastingString","sepNorthingString","sep","sepEasting","sepNorthing","fromMGRS","mgrsStr","toMGRS","C04","C06","C08","sphi","cphi","arg","pj_mlfn","pj_enfn","ml0","delta_lon","sin_phi","cos_phi","al","als","tq","ml","pj_inv_mlfn","tan_phi","ds","temp","log1py","pp","B","cos_2B","h2","arg_r","arg_i","hr2","hi2","sin_arg_r","cos_arg_r","sinh_arg_i","cosh_arg_i","hr","hi1","hr1","tmerc","cgb","cbg","utg","gtu","np","Qn","gatg","Zb","clens","Ce","Cn","sin_Cn","cos_Cn","sin_Ce","cos_Ce","asinhy","tmp","clens_cmplx","adjust_zone","etmerc","dependsOn","esinp","phic0","ratexp","K","srat","gauss","sinc0","cosc0","R2","sinc","cosc","cosl","ssfn_","phit","eccen","coslat0","sinlat0","cons","ms1","cosX0","sinX0","sinX","cosX","rh","sinlat","coslat","dlon","ce","Chi","phy0","sinPhy0","semiMajorAxis","flattening","R","k2","k3","Sa1","Sa2","rotI","rotB","phy","prevPhy","iteration","TOL","cosph0","F","H","L","sinph0","J","gamma0","lamc","lam1","lam2","alpha_c","no_off","isTypeA","typeAProjections","projectionName","no_rot","alp","gam","one_es","E","lam0","singam","cosgam","sinrot","cosrot","rB","ArB","BrA","u_0","v_pole_n","v_pole_s","U","W","Qp","Sp","Tp","Vp","Up","sin1","cos1","ts1","sin2","cos2","ms2","ts2","ts0","ns","f0","rh1","s45","s90","fi0","alfa","uq","u0","n0","ro0","ad","gfi","deltav","eps","ro","czech","fi1","e0","e3","e0fn","e1fn","e2fn","e3fn","mlfn","lam","nl","gN","tl","asq","cl","dd","imlfn","nl1","rl1","tl1","dsq","adjust_lat","P00","P01","P02","P10","P11","P20","mode","qp","qsfnz","mmf","apa","authset","APA","rq","xmf","ymf","sinb1","cosb1","coslam","sinlam","sinb","cosb","OBLIQ","EQUIT","N_POLE","S_POLE","cCe","sCe","ab","cosz","sinz","authlat","sin_po","cos_po","qs1","qs2","qs0","ns0","qs","phi1z","asinz","eccnts","sin_p14","cos_p14","infinity_dist","coslon","iqsfnz","dlat","bl","tanphi","mln","mlnp","ma","B_re","B_im","C_re","C_im","delta_lat","d_phi","d_lambda","d_phi_n","d_psi","th_n_im1","th_re","th_im","th_n_re","th_n_im","z_re","z_im","z_n_im1","delta_x","z_n_re","z_n_im","iterations","num_re","num_im","den_re","den_im","den2","d_psi_n","C_y","C_x","delta_theta","ml1","ml2","sinth","costh","gsq","msq","xx","xys","c3","th1","sin_p12","cos_p12","Mlp","Ml","kp","cos_c","vars","azi1","vincentyInverse","lon1","lon2","U1","U2","sinU1","cosU1","sinU2","cosU2","lambdaP","sinLambda","cosLambda","sinSigma","cosSigma","sigma","cos2Alpha","cos2SigmaM","uSq","deltaSigma","iterLimit","s12","vincentyDirect","sinAlpha1","cosAlpha1","sigma1","sigmaP","FACE_ENUM","AREA_ENUM","qsc_fwd_equat_face_theta","qsc_shift_lon_origin","slon","face","one_minus_f","one_minus_f_squared","xy","sinlon","nu","cosmu","tannu","tantheta","invert_sign","lp","COEFS_X","COEFS_Y","FXC","FYC","RC1","NODES","poly3_val","coefs","newton_rapshon","f_df","max_err","iters","upd","poly3_der","azi","tilt","pn1","pfact","omega","cg","sg","sw","yt","ba","bq","flip_axis","sweep","radius_g_1","radius_g","rone_es","radius_p","radius_p2","radius_p_inv2","shape","v_x","v_y","v_z","det","v_zp","A1","A2","A3","A4","paramLat","paramLatSq","paramLatPow6","EPS10","e_fwd","am1","e_inv","s_fwd","cphi1","s_inv","core","defaultDatum","Proj","nadgrid","readNTV2Grid","detectLittleEndian","nFields","readHeader","nSubgridFields","shiftType","fromSemiMajorAxis","fromSemiMinorAxis","toSemiMajorAxis","toSemiMinorAxis","readSubgrids","gridOffset","subHeader","lngColumnCount","latColumnCount","rowSize","ready","proj4","sterea","stere","somerc","omerc","lcc","krovak","cass","laea","aea","gnom","cea","eqc","poly","nzmg","mill","sinu","moll","eqdc","vandg","aeqd","ortho","qsc","robin","geocent","tpers","geos","eqearth","bonne","appendMinimap","_map$minimap_","minimap_","drawMinimap","topoData","CNTR_RG_60M_2024_4326","debounce","func","wait","_len","_key","onMiniUpdate","applyMinimapRotation","applyMinimapScale","_minimapGlobe","_minimapPath","normalizeLon","getLonLatFromMapPosition","_map$position_","_map$position_2","_proj2","_proj4","_coords","_minimapProjection","_map$__lastTransform","S0","_minimapBaseScale","_lastZoomK","__lastTransform","MIN","MAX","defineMinimapProjection","_map$minimap_2","geoOrthographic","geoPath","minimapConfig","_minimapContainer","addDefsToMinimap","addInnerShadowToDefs","innerShadow","highlightIds","targets","panHandler","_map$_projection$inve6","geoX","geoY","onZoom_","zoomHandler","previousT","_map$_projection$inve8","projectedX","projectedY","__programmaticZoom","__baseZ","scaleStrokeWidths","scaleLabelTexts","scaleLabelBackgrounds","zoomFactor","updates","originalWidth","originalHeight","originalX","originalY","targetHeight","targetX","targetY","computedStyle","inlineFontSize","cssFontSize","originalFontSize","targetFontSize","inlineStrokeWidth","cssStrokeWidth","originalStrokeWidth","targetStrokeWidth","tsv","tsvParse","responseText","dsvParse","projectToMap","PLACENAMESURL","loadPlacenames","_loadPlacenames","raw","_args","placenamesFilter_","_placenameLabels","_addPlacenameLabels","appendPlacenameLabels","updatePlacenameLabels","_out$__lastTransform","getFilteredPlacenames","screenX","screenY","sizeFactor","placenameGroup_","resolution","rs","_projectToMap2","_projection2","appendCoastalMargin","drawCoastalMargin_","ensureCoastalMarginFilter","_settings$opacity","standardDeviation","coastalMarginSettings_","drawPaths","predicate","cls","refIndex","childNodes","niceScaleBarLength","scaleBarLength","pow10","getScalebarLabel","valueM","numericSort","makeMatrix","ssq","sums","sumsOfSquares","sji","muji","fillMatrixColumn","iMin","iMax","cluster","backtrackMatrix","jlow","ssqjlow","ssqj","jhigh","ckmeans","nClusters","sorted","uniqueCount","uniqueCountSorted","lastSeenValue","uniqueValueCount","fillMatrices","nValues","shiftedValue","clusters","clusterRight","clusterLeft","jenks","nClasses","matrices","jenksMatrices","lowerClassLimits","varianceCombinations","variance","tmp1","tmp2","POSITIVE_INFINITY","sumSquares","i4","lowerClassLimit","jenksBreaks","kclass","countNum","BayesianClassifier","totalCount","train","category","score","odds","oddsSums","combination","PerceptronModel","weights","bias","predict","prediction","gradient","SQRT_2PI","cumulativeDistribution","standardNormalTable","formatDefaultLocale","initProj4","innerWidth","containerId_","projectionFunction_","filterGeometriesFunction_","placenames_","zoomExtent_","translateExtent_","lockPanUntilZoom_","onZoomEnd_","onRegionMouseOver_","onRegionMouseMove_","onRegionMouseOut_","geometries_","processCentroids_","dorling_","animateDorling_","dorlingStrength_","dorlingIterations_","onDorlingProgress_","dorlingWorker_","dorlingWorkerD3URL_","header_","footer_","footerPadding_","headerPadding_","title_","titlePosition_","subtitle_","subtitlePosition_","showScalebar_","scalebarPosition_","scalebarUnits_","scalebarTextOffset_","scalebarMaxWidth_","scalebarHeight_","scalebarStrokeWidth_","scalebarSegmentHeight_","scalebarTickHeight_","stamp_","zoomButtons_","insetsButton_","transitionDuration","xOffset","showFlags","hoverColor_","drawGraticule_","backgroundMap_","annotationsAdded","patternFill_","showSourceLink_","footnote_","footnoteTooltipText_","footnoteWrap_","footnotePosition_","showEstatLogo_","showEstatRibbon_","logoPosition_","ribbonPosition_","ribbonWidth_","ribbonHeight_","logoWidth_","logoHeight_","noDataFillStyle_","insets_","insetBoxPosition_","insetBoxPadding_","_loop","defineDeprecatedFunctions","showZoomButtons","showInsetsButton","seaFillStyle","cntrgFillStyle","nutsrgFillStyle","nutsbnStroke","nutsbnStrokeWidth","graticuleStroke","graticuleStrokeWidth","nutsrgSelFillSty","titleFontSize","subtitleFontSize","subtitleFontWeight","titleFill","subtitleFill","cntbnStroke","cntbnStrokeWidth","worldStroke","worldStrokeWidth","worldCoastStroke","worldCoastStrokeWidth","worldFillStyle","coastalMarginWidth","coastalMarginColor","coastalMarginStdDev","coastalMarginSettings","fontFamily","botTxtFontSize","botTxtFill","scalebarFontSize","frameStroke","frameStrokeWidth","psClassifMethod","psClassificationMethod_","geoCenter","pixelSize","pixSize","tooltipText","classifMethod","classificationMethod_","thresholds_","psThreshold","psThresholds_","clnb","numberOfClasses_","nutsLvl","lg","language_","bottomText","botTxtPadding","botTxtTooltipTxt","tooltipShowFlags","colorFun","colorFunction_","filtersDefinitionFun","filtersDefinitionFunction_","labelling","labelsConfig","labelsToShow","labelShadowsToShow","labelShadow","labelShadowWidth","labelFilterFunction","labelFill","labelStroke","labelStrokeWidth","labelOpacity","labelValuesFontSize","labelShadowColor","countriesToShow","bordersToShow","flowDonutSizeScale","flowDonutSizeScale_","flowDonuts","flowNodeType_","flowMapType","flowLineType_","flowGradient","flowColorGradient_","flowOverlayColors","flowRegionColors_","getFillPatternDefinitionFun","fillPatternDefinitionFunction_","subtitle","drawCoastalMargin","stamp","minimap","updateLabels","prevLabels","masterConfig","applyLabelsCallback","setMapView","__zoomBehavior","_map$_projection2","projX","projY","tx","ty","newTransform","zoomIdentity","updateGeoMapTemplate","buildMapTemplate","buildMapTemplateBase","createMapSVG","svgId","_wrapper_","wrapMapSvg","_parent$classList","wrapper","containerId","dg","removeInsets","template","buildInsets","insetsGroup","drawnInset","buildGridCartogramBase","defineDefaultPosition","getDefaultZ","defineProjection","definePathFunction","defineMapZoom","_map$panPadFactor_","panUnlocked","snappingBack","kmin","needsPad","panPadFactor","panPadFactor_","padX","padY","closest","_map$onZoomEnd_","centerY","geoLeftX","geoRightX","drawBackgroundMap","addCentroidsToMap","addPlacenameLabels","addTitle","cssClass","titlePosition","addSubtitle","cssSubtitleClass","cssTitleClass","subtitlePosition","addFootnote","foot","lineIndex","_tooltip","mw___","mouseover","mousemove","mouseout","addEurostatLogo","logoWidth","logoHeight","addEurostatRibbon","ribbonWidth","ribbonHeight","footer","addSourceLink","stat","eurostatDatasetCode","yPos","linkWidth","addScalebarToMap","maxLengthPix","textOffsetX","textOffsetY","pixelSizeM","niceLengthM","niceLengthPixel","scaleBarStartDigit","scalebarGroup","subdivisionNb","divisionWidth","midlineY","appendZoomButtons","buttonGroup","buttonSize","zoomInBtn","zoomOutBtn","zoomIn","zoomOut","appendInsetsButton","insetButton","comment","createComment","recalculateLayout","centroidFeatures","newFeature","geoCentroid","projectedCentroids","hasStatData","getCentroidsGroup","refreshCentroids","allCentroids","statCodes_","_map$statData","_out$position_$x","_out$position_$y","_out$position_$x2","_out$position_$y2","_out$Geometries$defau","defaultPosition","_defaultPosition","setViewFromURL","_out$Geometries$defau2","geoRobinson","sa","geoIdentity","getBBOXAsGeoJSON","bb","drawing","frame","clipRect","headerHeight","footerHeight","headerMapPadding","footerMapPadding","_header$node","_header$node$getBBox","hb","_footer$node","_footer$node$getBBox","fb","totalHeight","entries","__tree__","updated","extension","dimension","role","classification","Dimension","hierarchy","Item","follow","embedded","Dataset","Category","Dice","toTable","Slice","Data","field","vlabel","slabel","drop","meta","bylabel","cols","metric","categories","dimensions","it","rt","nt","Q","$","tt","et","lt","st","ot","at","ut","ht","dt","vt","Unflatten","nutsId","_data_","__data","dataObject","regionId","dateValueMap","hasData","ar","hasNumericData","acc","maxVal","maxRegion","minVal","minRegion","lang","eurostatDatasetCode_","updateEurobase","csvURL_","updateCSV","lastTimePeriod","getEurobasePromise","filters_","getEstatDataURL","datasetCode","filters","data___","_data___$error$","jsd","JSONstat","metadata","jsonstatToIndex","jsData","ind","getTime","geoCol_","valueCol_","getCSVPromise","csvToIndex","csvData","geoCol","valueCol","appendPatternFillLegend","cfg","legendLabel","shapeHeight","shapePadding","patternColor","shapeWidth","patternId","pattern","highlightPatternFillRegions","unhighlightPatternFillRegions","labelOffsets","targetFill","InternMap","keyof","_intern","intern_get","intern_set","intern_delete","implicit","ordinal","band","bandwidth","ordinalRange","paddingInner","paddingOuter","entering","__axis","orient","tickArguments","tickValues","tickSizeInner","tickSizeOuter","tickPadding","devicePixelRatio","spacing","range0","range1","tickExit","tickEnter","tickSize","axisBottom","axisLeft","createHistogramLegend","baseX","baseY","histogram","showCounts","showPercentages","labelRotation","margin","numberOfClasses","getNumberOfClasses","labelFormatter","getLabelFormatter","colorClassifier","getColorClassifier","counts","getData","getColors","colors_","classToFillStyle","getThresholds","classIndex","total","barGroup","lgg","handleMouseOver","ecl","reversedIndex","highlightRegions","handleMouseOut","unhighlightRegions","drawVerticalHistogram","reversedCounts","reversedPercentages","reversedThresholds","yScale","scaleBand","xScale","scaleLinear","axisGroup","labelType","positions","boundaryScale","drawHorizontalHistogram","reversedColors","bandIndex","createContinuousLegend","_continuousLegendContainer","colorLegend","isVertical","legendId","legendWidth","legendHeight","createLegendGradient","gradientId","_map$colorFunction_2","isD3Scale","steps","getTransformedDomain","valueTransform","valueTransform_","rawDomain","getUntransformedDomain","drawLegendRect","titlePadding","getTitlePadding","addMouseEvents","legendLength","valueUntransform_","highlightFunction","getHighlightFunction","highlightPsSymbols","unhighlightFunction","getUnHighlightFunction","unhighlightPsSymbols","rawVal","_pointer2","mx","my","along","clamped","norm","_domain","_domain2","getChoroplethLabelFormatter","hasTicks","drawLowHighLabels","titleOffset","low","lowLabel","high","highLabel","divergence","pointOfDivergenceLabel","barLength","xPos","barY","drawTickLabels","legendThickness","tickGroup","generateTickValues","_domain3","_domain4","computeNormalizedTickPosition","_domain5","tickLength","tickLabels","noData","pointOfDivergence","pointOfDivergencePadding","appendNoDataLegend","noDataText","_map$colorFunction_","domain_","getHighlightTolerance","_map$legend_$highligh","_map$legend_$colorLeg","legend_","highlightTolerance","tolerance","allRegions","psFillOpacity_","drawDiscreteLegend","_out$colorLegend","_out$colorLegend2","_discreteLegendContainer","createRangesLegend","getClassToFillStyle","_loop2","fillColor","itemContainer","sepLineLength","drawDivergingLine","createThresholdsLegend","globalMin","globalMax","globalMinRegionId","globalMaxRegionId","globalMinRegion","globalMaxRegion","classifier","getColorStats","maxMin","getMin","getMax","getMaxRegionId","getMinRegionId","_minFeature$propertie","_minFeature$propertie2","_maxFeature$propertie","_maxFeature$propertie2","allFeatures","minFeature","maxFeature","noDataText_","tickX1","tickX2","maxMinTickLength","labelX","maxLabel","maxMinLabels","minLabel","maxMinRegionLabels","maxMinGroup","yTop","highlightMaxRegion","yBottom","highlightMinRegion","_out$labelOffsets","_out$labelOffsets2","_out$colorLegend3","maxLabelLength","lineLength","divergingLineLength","directionLineLength","divergingArrowLength","directionLineX","markerHeight","legend","Legend","decimals","updateConfig","updateContainer","makeBackgroundBox","getBaseY","getBaseX","colorSchemeType_","opacityScale_","createAlphaLegend","_alphaData$unitText","alphaData","isReady","_alphaLegendContainer","unitText","patternContainer","boxPadding","setBoxDimension","labelDecNb","defaultLabeller","decimalFormatter","withPath","drawCircleSizeLegend","sizeScale","_out$sizeLegend","_out$nodeSizeLegend","_out$sizeLegend2","_out$nodeSizeLegend2","sizeLegendTitleFontSize","_sizeScale$_values","_values","maxRadius","sizeLegend","nodeSizeLegend","buildSpikeLegend","sizeDomain","classifierSize_","maxStat","minStat","maxSize","legendValues","labelFontSize","labelOffset","_sizeLegendContainer","currentY","formattedLabels","spikeSpacing","items","spike","psSpikeWidth_","psFill_","psStroke_","psStrokeWidth_","symbolsLibrary","cross","symbolCross","square","symbolSquare","diamond","symbolDiamond","triangle","symbolTriangle","star","symbolStar","wye","symbolWye","symbolCircle","buildD3SymbolItem","symbolSize","_cursorY","getShape","psCustomSVG_","psCustomShape_","psShape_","drawRectangle","psBarWidth_","symbolType","symbolPath","classifierColor_","shapeFill","psFillOpacity","shapeStroke","psStroke","shapeStrokeWidth","psStrokeWidth","symBBox","shapeOffsets","drawSizeLegend","customSymbols","nodeHeights","buildBarsItem","buildCustomSVGItem","addNoDataLegend","paddings","default","bar","noDataHeight","noDataShapeHeight","highlightPsRegions","unhighlightPsRegions","symbolColumnX","svgGroup","labelY","allSymbols","cellNb","_totalBarsHeight","_totalD3SymbolsHeight","marginTop","sepLineStroke","sepLineStrokeWidth","getPropSymbolColorLabelFormatter","getColorThresholds","psClasses_","deepMergeExistingKeys","seen","WeakSet","MAX_DEPTH","maxDepth","sourceVal","targetVal","isPlainObject","mergeArrays","boxOpacity","noDataPadding","noDataShapeWidth","build","legendSVG","_out$x","_out$y","titlesContainer","noDataFillStyle","psClassToFillStyle_","classToFillStyle_","classifier_","tooltip","_config$offset","_config$offset2","ensureTooltipOnScreen","eventX","eventY","parentWidth","parentHeight","offsetLeft","left2","offsetTop","OVERLAY_ID","showSpinner","overlay","createOverlay","lbl","statMap","MapTemplate","_geoDone_","_statDone_","_finalized_","tryFinalize","_renderScheduled","_loadingStatCount_","stat_","statData_","StatisticalData","transitionDuration_","legendObj_","legendObj","legendSvg","updateLegend","buildLegend","tp","updateGeoData","updateStatData","updateLoader","_out$svg","_svg$node$parentNode","_loadingGeo_","hideSpinner","getLegendConstructor","isStatDataReady","hasConfig","hasManualData","escapeHtml","str","updateStatValues","_out$statData$get","_out$statData","statKey","manualData","isRemote","retrieveFromRemote","language","updateClassification","updateStyle","setFromURL","opts","getURLParameters","exportMapToSVG","svgNodeClone","svgUrl","getDownloadURL","svgContent","outerHTML","svgBlob","Blob","URL","createObjectURL","downloadLink","download","click","exportMapToPNG","_w","_h","bg","serializer","svgString","img","cleanup","fonts","XMLSerializer","serializeToString","Image","crossOrigin","pngUrl","revokeObjectURL","onload","canvas","ctx","getContext","fillStyle","fillRect","drawImage","toBlob","pngBlob","write","src","ps","getURLParameterByName","applyPatternFill","configs","regionToPatternIds","_config$pattern","_config$regionIds","regionIds","_config$color","_config$strokeWidth","customPattern","idMatch","insertAdjacentHTML","colorKey","definePattern","patternName","CSS","escape","_d$properties","patternIds","original","StatMap","makeClassifNice_","paletteA","interpolateLab","choroplethTooltipFunction","pointOfDivergence_","paramNames","applyClassificationToMap","generateRange","dataArray","getArray","classifyRegions","regionData","setupClassifier","_out$colorFunction_","transformedValues","isDiverging","checkIfDiverging","_out$pointOfDivergenc","dataArrayNumeric","scaleQuantile","scaleQuantize","scaleThreshold","applyStyleToMap","getFillPatternLegend","getColorFunction","regionsFillFunction","addMouseEventsToRegions","cellColor","styleMixedNUTS","colorFunction","newFunction","filtersDefinitionFunction","ChoroplethLegend","isVisible","_out$Geometries","colorSchemeType","getContinuousColor","colorFn","transformed","_out$pointOfDivergenc2","divT","cntrgFillStyle_","shouldOmit","highlightRegion","scaledX","scaledY","mapRect","clearHighlight","colorArray","interpolateYlGnBu","buf","regionName","statusFlag","flagText","flags","initialAngle","simulation","alphaMin","alphaDecay","alphaTarget","velocityDecay","forces","stepper","lcg","force","fx","vx","fy","vy","initializeNodes","initializeForce","initialize","randomSource","strengths","xz","strength","yz","tree","xm","ym","xp","yp","_root","leaf","defaultX","defaultY","quadtree","Quadtree","addAll","leaf_copy","treeProto","radii","xi","yi","ri","ri2","visitAfter","prepare","visit","quad","rj","jiggle","_nodes","_random","runDorlingSimulation","radiusAccessor","runSim","singleMap","_singleMap$dorlingStr","_singleMap$dorlingStr2","_singleMap$dorlingStr3","_singleMap$dorlingStr4","_singleMap$dorlingIte","stopDorlingSimulation","strengthX","strengthY","useWorker","d3URL","_singleMap$_projectio","projected","containers","tickTransform","worker","Worker","postMessage","onmessage","_e$data","finalNodes","progress","updateDorlingProgress","terminate","sim","forceSimulation","forceX","forceY","forceCollide","nTicks","transformPow","transformSqrt","transformSquare","powish","createSqrtScale","minSize","positives","dataMax","dataMin","minR","scaleSqrt","baseScale","defineClassifiers","defineSizeClassifier","_out$statData$getArra","_out$statData2","rawData","isLinear","createLinearScale","psMaxSize_","psMinSize_","classifierSize","defineColorClassifier","getA","classifierColor","psClasses","psThresholds","colorData","updateBackgroundColor","symbolFill","d3color","hexColor","mapId","getBackgroundColor","brightenFactor","brightenHex","psBrightenFactor_","cover","quads","retainer","removeAll","sizeData","getSizeStatData","addMouseEventsToSymbols","newFill","appendSpikesToMap","spikes","psOffset_","psMaxValue_","psMinValue_","psSizeScale_","psStrokeOpacity_","psColors_","psColorFun_","interpolateOrRd","tooltipTextFunPs","psCodeLabels_","psClassToFillStyle","getColorLegend","_out$labels_","symb","updateSymbolsDrawOrder","appendCustomSymbolsToMap","appendBarsToMap","appendCirclesToMap","circles","appendD3SymbolsToMap","setRegionStyles","setSymbolStyles","psStrokeOpacity","appendLabelsToSymbols","psColorFun","styleMixedNUTSRegions","centroids","_out$labels_4","symbolContainers","_out$labels_2","_sizeData$get","_window$getComputedSt","_out$labels_3","_sizeData$get2","_window$getComputedSt2","gcp","_d$properties2","_sizeData$get3","ProportionalSymbolLegend","_v1$unitText","sv1","unit1","row1","row2","_v2$unitText","sv2","unit2","_categoricalContainer","createCategoricalLegend","ecls","ecl_","classToText","tooltipTextFunCat","classToText_","squareSize","label1","label2","axisTitleFontSize","breaks1","breaks2","showBreaks","yAxisLabelsOffset","xAxisLabelsOffset","yAxisTitleOffset","xAxisTitleOffset","noDataYOffset","axisArrows","arrowHeight","arrowWidth","arrowPadding","ecl1","ecl2","_horizontalOffset","addSquares","sz","xc","initialX","classifier1_","classifier2_","addBreakLabels","breakLabels","_xAxisArrowY","_yAxisArrowX","addAxisArrows","addAxisTitles","axisTitles","xAxisTitleY","xAxisTitleX","yAxisTitleY","yAxisTitleX","addNoDataElement","noDataY","scaleBivariate","startColor","color1","color2","endColor","rampS1","interpolateRgb","ramp2E","colFun","tooltipTextFunBiv","TernaryGeometry","ternaryMeshCentroids","p2","p3","ternaryMeshVertices","vertices","term1","term2","vertex","ternaryDistance","q2","q3","ternaryNearest","distances","minIndex","ternarySextantVertices","sextantPoints","ternarySurroundingSextant","isLarger","ternaryToCartesian","cartesianToTernary","ternaryLimits","upper","CompositionUtils","geometricMean","removeZeros","centre","g1","g2","g3","perturbe","powerScale","close","isValidTernary","validateTernaryPoints","colorMapTricolore","breaks","hue","chroma","lightness","contrast","spread","P_notrans","centered","im","cfactor","adjustedC","hclToHex","colorMapSextant","sextants","sextant","hRad","to8bit","toHex","nest","regroup","TricoloreViz","createContinuousPlot","_a","_b","showData","showCenter","showLines","labelPosition","colorTarget","plotWidth","plotHeight","drawContinuousTriangle","toDataURL","drawTriangleFrame","addDataPoints","dataPointHandlers","addCenterAnnotation","centerLabel","centerAnnotationOffsets","createDiscretePlot","centroidPoints","triangleVertices","ternaryToSvgCoords","handlers","triangleHandlers","pointColors","createSextantPlot","sextantVertices","colorIndex","imageData","createImageData","svgToTernaryCoords","pixelIndex","putImageData","svgCorners","labelPositions","rotateValues","majorGrid","minorGrid","drawGridLine","major","p1Edge","drawAxisTick","p2Edge","p3Edge","labelStride","computeLabelStride","labelGrid","tickEnd","centerSvg","centerValue","lineAngle","offsetDistance","offsets","curveX","curveY","drawTricoloreLegend","tricoloreContainer","viz","_ternaryCenter_","ternarySettings_","highlightRegionsByClass","_map$_tooltip","getRegionByClassIndex","_find","_map$Geometries$getRe","_ternaryIdByClass_","_ternaryClassById_","_map$_tooltip2","_map$_tooltip3","unhighlightRegionsByClass","highlightRegionsByColor","_ternaryData_","normalizeColor","ternaryCodes_","meanCentering","_ternaryColors_","tooltipTextFunctionTrivariate","_ternaryColorById_","styleRegions","_out$ternaryCodes_","statData1","statData2","statData3","id2","id3","tricolore","TrivariateLegend","_map$ternaryCodes_","sv3","unit_","label_","sortValues","pie","pa","originalFill","svgMap","scs","catColors","catLabels","hoverColor","_sizeLegendHeight","allSegments","buildColorLegend","_colorLegendContainer","sizeLegendHeight","dorling","pieMinRadius_","pieMaxRadius_","pieChartInnerRadius_","pieStrokeFill_","pieStrokeWidth_","tooltipPieRadius_","tooltipPieInnerRadius_","catColors_","catLabels_","pieOtherColor_","pieOtherText_","showOnlyWhenComplete_","statPie_","pieTotalCode_","statPie","dim","tCode","sc_","getDatasetMaxMin","totals","getRegionTotal","regionFeatures","getComposition","display","addPieChartsToMap","comp","ir","pie_","arcFunction","chartsnodes","pieData","_current","interpolater","schemeCategory10","showOnlyWhenComplete","totalEntry","totalVal","totalPerc","PiechartLegend","innerArc","outerArc","pieChartTooltipFunction","_step2","paths","polylines","_iterator2","dPath","posA","posB","posC","midangle","labelPos","anchor","_step3","breakdownData","Boolean","_iterator3","_item$value","sparkLineColor_","sparkAreaColor_","sparkLineWidth_","sparkLineHeight_","sparkLineStrokeWidth_","sparkLineOpacity_","sparkType_","sparkLineCircleRadius_","sparkTooltipChart_","sparkLineChartFunction_","statSpark_","sparkHeightClassifier_","sparklineData_","sparklineData","dates","_statDates","perDateValues","regionValues","setData","statSpark","previousValue","currentValue","percentageChange","nutsIds","addSparkLinesToMap","nutsid","createSparkLineChart","isForTooltip","minValue","maxValue","scaledData","scaledXValue","scaledYValue","zeroY","lineGenerator","x0z","y0z","arealine","lineX0","lineY0","lineY1","lineX1","totalLength","getTotalLength","maxs","regionMax","getRegionMax","widthClassifier_","heightClassifier_","chartHeight","chartWidth","totalWidth","lgch","fmt","d3format","drawFlowColorLegend","_out$_flowColorContai","_flowColorContainer","flowColorLegend","legendItems","flowColor_","_d$key","colorScale","topLocationColorScale","topLocationKeys","nodeNameMap","itemHeight","highlightLines","nodeId","unhighlightLines","flowWidthLegend","regionColorLegend","buildFlowLegend","drawVerticalFlowWidthLegend","_cfg$segments2","strokeWidthScale","_flowWidthContainer","sampleVals","maxFlowCount","minFlowCount","prevStrokeWidth","drawHorizontalFlowWidthLegend","_cfg$x","_cfg$segments","_cfg$labelOffset","_cfg$pad","innerStart","innerEnd","slabWidth","strokeWidths","maxStroke","lineY","texts","_cfg$color","_cfg$strokeOpacity","strokeOpacity","flowWidthNode","flowWidthLegendHeight","flowNodes_","_nodeSizeScale","_nodeLegendContainer","_nodeSizeContainer","flowColorLegendYOffset","importerRegionIds","exporterRegionIds","regionColorLegendYOffset","drawRegionColorLegend","_out$_regionColorCont","_regionColorContainer","ensureArrowMarkers","svgRoot","_opts$cacheKey","_opts$scale","_opts$markerUnits","markerUnits","_opts$hoverColor","_opts$outlineColor","outlineColor","_opts$idBase","idBase","uid","_opts$useContextStrok","useContextStroke","_arrowCache","_opts$out","ensureDefs","hover","createMarker","flowOutlineColor_","applyArrow","setHoverArrow","_ref$markerUnits","_ref$fill","VB","buildBidirectionalRouteMap","links","nodeById","routeMap","sourceId","targetId","sourceNode","targetNode","nodeA","nodeB","idA","idB","coordsA","coordsB","flowAB","flowBA","sampleAB","sampleBA","route","createSankeyFlowMap","sankeyContainer","baseGraph","flowGraph_","usesGradient","flowOpacityGradient_","_nodeById","sankeyInput","expandRoutesToSankeyMidpointGraph","newNodes","newLinks","midIndex","extraAB","extraBA","midId","midNode","isMidpoint","originId","destId","dir","_sankey","sankey","graph","cloneGraph","initGraphLinks","_step$value","sourceLinks","targetLinks","_step2$value","computeNodeValues","_ref11","_step17","_iterator17","computeNodeDepths","_ref8","_step4","_iterator4","computeNodeHeights","_ref9","visited","_node$height","_step5","maxHeight","_iterator5","_step6","_iterator6","_step7","minH","_n$height","_iterator7","_node$height2","computeNodeBreadths","_ref0","_step8","_iterator8","totalLinkWidth","reorderLinks","_step18","_iterator18","_step18$value","computeLinkBreadths","_ref1","_step9","_iterator9","_step0","_iterator0","_step1","_iterator1","flowStack_","_step12","_iterator12","otherY","_step13","_iterator13","totalLeft","totalRight","flowOrder_","yL","_i5","_left","yMid","yR","_i6","_right","span","_step10","_iterator10","_step11","_iterator11","adjustMidpointNodes","_ref10","_step14","_iterator14","incident","_step15","ends","_iterator15","midY","_step16","_iterator16","arrowIds","flowArrows_","flowArrowScale_","gradientIds","addFlowGradients","_d$source$x","_d$source","_d$target","_d$target$x","_d$target2","_d$source2","_d$y","_ref4","_d$y2","_out$flowRegionColors","_out$flowRegionColors2","getFlowStroke","startOpacity","endOpacity","addSankeyFlows","_baseCurvSettings$cur","flowsGroup","buildFlowsGroup","flowOpacity_","baseCurvSettings","flowCurvatureSettings_","baseCurv","curvature","linkPath","sankeyLinkAvoidingNodes","obstacles","_ref12","_ref12$gapX","gapX","_ref12$padX","_ref12$padY","_ref12$bumpY","bumpY","_ref12$curvature","_step19","rev","xA","yA","xB","yB","pts","yAt","_iterator19","_n$y","_n$y2","nodeTop","nodeBot","nodeMid","leftX","rightX","yline","isBelow","bot","bypassY","_step20","merged","_iterator20","seg","last","_i7","_merged","startX","endX","lastX","cubicSegment","dCenter","computeColorKey","_out$topLocationKeys$","_out$topLocationKeys","_link$target","_ref6","_link$target$id","_link$target2","_link$source","baseColor","paint","flowOutlines_","flowWidthGradient_","buildOutlinePath","outlineW","flowOutlineWidth_","_getBackoffAndDash","getBackoffAndDash","dashVis","dashGap","mainSel","buildTaperedMain","dPoly","taperedPolygonForLink","startRatio","flowWidthGradientSettings_","samples","minStartWidth","capEnd","dPolyOutline","buildSimpleMain","_getBackoffAndDash2","addNodeStems","visibleNodes","strokePx","backoff","arrowBackoffPxForStroke","arrowScale","arrowLenPx","_pathDashForBackoff2","pathDashForBackoff","backoffPx","pathLength","vis","gap","pathFn","_ref7","_ref7$startRatio","_ref7$samples","_ref7$minStartWidth","_ref7$capEnd","extraPad","samplePathByLength","getPointAtLength","normals","wStart","wEnd","half","_link$originId","_link$destId","fallback","colorByTopN","flowTopLocations_","flowTopLocationsType_","_p","_p2","c1x","c2x","drawEdgeBundleLines","lineGroup","_out$flowOpacity_","innerWidth_","innerHeight_","hypotenuse","scales","generateSegments","distance","xscale","yscale","tgt","_arrowIds","lineFunction","curveBundle","_out$flowGraph_$links","_out$flowGraph_$links2","iata","strokeW","_out$flowGraph_$links3","_out$flowGraph_$links4","dst","onFlowLineMouseOver","onFlowLineMouseOut","layout","flowBundleSettings_","distanceMin2","distanceMax2","theta2","accumulate","weight","distanceMin","distanceMax","forceManyBody","chargeStrength","defaultStrength","initializeStrength","initializeDistance","forceLink","linkStrength","linkIterations","createFlowMap","flowMapContainer","drawStraightLinesByFlow","buildSegments","_ref2$nodes","_ref2$links","segs","flowBidirectional_","midX","isHalf","_ref3$links","nodeMap","sid","idFor","tid","assignWidths","prepareGradients","gradientMap","gid","drawSegments","flowEdgeBundling_","_out$flowWidthGradien","_out$flowWidthGradien2","_out$flowWidthGradien3","_out$flowWidthGradien4","topStartX","topStartY","topEndX","topEndY","botEndX","botEndY","botStartX","botStartY","_out$flowOpacity_2","segLen","onFlowLineMouseMove","_v$id","halfValue","linkLike","flow","hoveredColor","linkObj","drawNodeDonuts","computeDonutValues","topKeys","valuesMap","internalFlowTotal","sourceKey","flowInternal_","targetKey","donutValues","getSegmentColor","computeDonutLocationStats","statsByLoc","incoming","outgoing","internal","srcKey","tgtKey","locationStats","donutContainer","flowNodeSizeScale_","arcGen","pieGen","locKey","stats","incomingBreakdown","getIncomingBreakdownByOrigin","outgoingBreakdown","getOutgoingBreakdownByDestination","allBreakdown","valuesByColor","mouseoverFunction","flowNodeMouseoverFunction_","donutMouseoverFunction","highlightDonut","unhighlightDonut","firstArcDatum","_statData$unitText","percentFormat","totalIncoming","incomingPercent","totalOutgoing","outgoingPercent","currentZoom","includeInternal","breakdown","sortBreakdown","_out$nodeNameMap","_out$nodeNameMap2","drawNodeCircles","computeCircleLocationStats","flowMaxNodeSize_","flowMinNodeSize_","circlesContainer","nodeFill","makeTooltip","_out$statData$unitTex","flowMapTooltipFunction","flowRegionLabels_","flowMaxWidth_","flowMinWidth_","flowLabelOffsets_","_b$link$value","_a$link$value","_a$link$id","_b$link$id","dv","localeCompare","curvatureFollow","prepareFlowGraph","addCoordinatesToGraph","_centroid$geometry$co","_out$Geometries$getRe","_feature$properties","_centroid2","projectAllNodeCoordinates","screenCoords","calculateNodeTotals","_out$flowGraph_","nodeTotals","computeNodeLinks","_step3$value","computeTopFlowLocations","topN","topType","topScore","topLocations","loc","scaleOrdinal","computeMaxMinFlowCounts","defineWidthScale","minW","maxW","flowContainer","_node$parentNode","addOverlayPolygons","importerIds","exporterIds","addFlowValueLabels","filteredNodes","labelElements","FlowLegend","originNode","destNode","originName","destName","squared","unsquare","series","stackSeries","timeLegend","buildCoxcombTimeLegend","_out$timeLegend","_out$_colorLegendCont","times","_coxTimes","angleStep","colorLegendWidth","centerX","labelRadius","timeAbbr","_coxTimeLabels","hoveredTime","month","coxcombMinRadius_","coxcombMaxRadius_","coxcombStrokeFill_","coxcombStrokeWidth_","coxcombRings_","getTotals","yearlyTotals","monthlyTotals","totalCode_","_stat$_data_$region","perRegionMonthSum","_coxCategoryCodes","cause","_stat$_data_$region2","computeCoxStatusMap","months","cats","useTotal","addIdsFrom","seenAny","seenND","seenNumeric","coxStatus_","defineSizeScales","yearlyValues","minRadius","outerScale","scaleRadial","classifierChartSize_","targetOuter","proportion","totalsByRegion","applyStyleToRegionPolygons","_status$get","symbols","addCoxcombChartsToMap","causes","createAngleScale","monthData","buildMonthData","sumCauses","_out$statData3","_out$statData4","totalStat","otherVal","hasOther","_out$catColors_","_out$catLabels_","getActiveKeys","stackGen","oz","drawCoxcomb","stackedData","yearlyTotal","ki","iInner","iOuter","statCoxcomb","categoryCodes","timeLabels","timeParameter","categoryParameter","categoryColors","categoryLabels","totalCode","scTotal","totalKey","CoxcombLegend","_out$statData0","includeOther","_out$statData5","_out$statData6","headerCells","headerRow","regionYearly","_monthlyTotals$region","cells","monthSum","_out$statData7","_out$statData8","_out$statData9","originalStroke","valuesV1","valuesV2","labelsV1","labelsV2","cursorY","hasIndependentScales","mushroomSizeScaleFunctionV1_","mushroomSizeScaleFunctionV2_","v1Box","drawMushroomSizeLegend","drawSideLabel","v2Box","drawColorKey","_out$colorLegend$labe","_map$statData3","_map$statData4","mushroomColors","_map$mushroomCodes3","mushroomCodes","_map$mushroomCodes4","highlightMushroomSide","resetMushroomHighlight","side","_map$statData2","_map$mushroomCodes2","_cfg$labelOffsets$x","_cfg$labelOffsets","_cfg$shapeStrokeWidth","_g$node","scaleShared","_mushroomScale_","scaleV1","scaleV2","sideIndex","mushroomOrientation","arcDef","getSizeLegendArc","labelOffsetX","legendValuesRaw","getValues","_scale$domain","vMin","vMax","maxR","getLabels","yLeader","xLabel","mushroomOrientation_","stat1","stat2","_stat1$get3","_stat2$get3","tooltipTextFunctionMushroom","_map$statData$unitTex","_map$statData$unitTex2","Choropleth","getUniqueValues","ctfs","dom","schemeSet3","CategoricalLegend","Categorical","ProportionalSymbol","startColor_","color1_","color2_","endColor_","breaks1_","breaks2_","setupClassifiers","classifier1","classifier2","_out$_tooltip","_out$_tooltip2","_out$_tooltip3","BivariateLegend","BivariateChoropleth","TrivariateChoropleth","stripeWidth_","stripeOrientation_","pieChartRadius_","statComp","statCodes","composition","patt","stripeWidth","stripeOrientation","StripeCompositionLegend","tooltipTextFunctionStripeComposition","pieChartRadius","pieChartInnerRadius","StripeComposition","PieCharts","Sparklines","FlowMap","Coxcomb","alphaData_","opacityScale","originalUpdateStatValues","originalUpdateStyle","_stats$get","_alphaData$get","statVal","alphaVal","av","alphaUnit","datasetLabel","alphaDatasetLabel","ValueByAlpha","mushroomCodes_","mushroomMinSize_","mushroomMaxSize_","mushroomColors_","mushroomSizeScaleFunction_","_out$mushroomCodes_","_out$mushroomCodes2","_stat1$get","_stat2$get","_out$mushroomCodes4","_stat1$get2","_stat2$get2","MushroomLegend","Mushroom","getFillPatternDefinitionFunction","patternSize","smin","smax","bckColor","symbColor","si","getDefaultLabels"],"sourceRoot":""}